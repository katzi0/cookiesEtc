webpackJsonp([1],{0:function(e,t,n){e.exports=n("cDNt")},"0l2a":function(e,t,n){"use strict";t.a=function(e){return Object(r.a)(e)(this)};var r=n("aqAJ")},"1j/l":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=Array.isArray||function(e){return e&&"number"==typeof e.length}},"2kLc":function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=Number.POSITIVE_INFINITY,s=null,l=e[e.length-1];return Object(o.a)(l)?(s=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof l&&(n=e.pop()),null===s&&1===e.length&&e[0]instanceof r.a?e[0]:Object(a.a)(n)(new i.a(e,s))};var r=n("AP4T"),i=n("Oryw"),o=n("3iOE"),a=n("bywS")},"3iOE":function(e,t,n){"use strict";t.a=function(e){return e&&"function"==typeof e.schedule}},"3k/+":function(e,t,n){"use strict";t.a=function(e,t){return arguments.length>=2?Object(r.a)(e,t)(this):Object(r.a)(e)(this)};var r=n("nAqi")},"3m71":function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=n("Ecq+").a.create},"5O0w":function(e,t,n){"use strict";t.a=function(e){return function(t){return t.lift(new a(e))}};var r=n("6Xbx"),i=n("lI6h"),o=n("qgI0"),a=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.notifier))},e}(),s=function(e){function t(t,n){e.call(this,t),this.notifier=n,this.add(Object(o.a)(this,n))}return Object(r.c)(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.complete()},t.prototype.notifyComplete=function(){},t}(i.a)},"5jKg":function(e,t,n){"use strict";t.a=function(e,t){return function(n){return n.lift(new a(e,t))}};var r=n("6Xbx"),i=n("lI6h"),o=n("qgI0"),a=function(){function e(e,t){this.project=e,this.resultSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.resultSelector))},e}(),s=function(e){function t(t,n,r){e.call(this,t),this.project=n,this.resultSelector=r,this.index=0}return Object(r.c)(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe(),this.add(this.innerSubscription=Object(o.a)(this,e,t,n))},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){this.innerSubscription=null},t.prototype.notifyComplete=function(t){this.remove(t),this.innerSubscription=null,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e,t,n,r,i){this.resultSelector?this._tryNotifyNext(e,t,n,r):this.destination.next(t)},t.prototype._tryNotifyNext=function(e,t,n,r){var i;try{i=this.resultSelector(e,t,n,r)}catch(e){return void this.destination.error(e)}this.destination.next(i)},t}(i.a)},"5q5V":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n("6Xbx"),i=n("TO51"),o=n("Gcw1"),a=n("qLnt"),s=n("YRqN"),l=n("Upor"),u=n("jaVc"),c=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY),e.call(this),this.scheduler=r,this._events=[],this._bufferSize=t<1?1:t,this._windowTime=n<1?1:n}return Object(r.c)(t,e),t.prototype.next=function(t){var n=this._getNow();this._events.push(new h(n,t)),this._trimBufferThenGetEvents(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._trimBufferThenGetEvents(),r=this.scheduler;if(this.closed)throw new l.a;this.hasError?t=a.a.EMPTY:this.isStopped?t=a.a.EMPTY:(this.observers.push(e),t=new u.a(this,e)),r&&e.add(e=new s.a(e,r));for(var i=n.length,o=0;o<i&&!e.closed;o++)e.next(n[o].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||o.a).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(e-r[o].time<n);)o++;return i>t&&(o=Math.max(o,i-t)),o>0&&r.splice(0,o),r},t}(i.a),h=function(e,t){this.time=e,this.value=t}},"6S6c":function(e,t,n){"use strict";t.a=function(e,t){return Object(r.a)(e,t)(this)};var r=n("LaOa")},"6Xbx":function(e,t,n){"use strict";t.c=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n.d(t,"a",function(){return i}),t.b=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},t.d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}},"8Gud":function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){return t.lift.call(r.a.apply(void 0,[t].concat(e)))}};var r=n("2kLc")},"8Ut3":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("6Xbx"),i=function(e){function t(t,n){e.call(this),this.value=t,this.scheduler=n,this._isScalar=!0,n&&(this._isScalar=!1)}return Object(r.c)(t,e),t.create=function(e,n){return new t(e,n)},t.dispatch=function(e){var t=e.value,n=e.subscriber;e.done?n.complete():(n.next(t),n.closed||(e.done=!0,this.schedule(e)))},t.prototype._subscribe=function(e){var n=this.value,r=this.scheduler;if(r)return r.schedule(t.dispatch,0,{done:!1,value:n,subscriber:e});e.next(n),e.closed||e.complete()},t}(n("AP4T").a)},"8ofh":function(e,t,n){"use strict";t.a=function(e){return r=e,o};var r,i=n("NePw");function o(){try{return r.apply(this,arguments)}catch(e){return i.a.e=e,i.a}}},ADVA:function(e,t,n){"use strict";var r=n("LMZF"),i=n("eoFs"),o=n("AP4T"),a=n("TO51"),s=n("Gcw1"),l=n("ozyc"),u=n("ThPn"),c=n("3k/+"),h=n("dmC+"),d=n("JHvW");function p(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return d.a.apply(void 0,e)(this)}var f=n("GI3C");n.d(t,"n",function(){return K}),n.d(t,"m",function(){return q}),n.d(t,"w",function(){return g}),n.d(t,"x",function(){return v}),n.d(t,"z",function(){return y}),n.d(t,"a",function(){return R}),n.d(t,"b",function(){return O}),n.d(t,"g",function(){return k}),n.d(t,"i",function(){return L}),n.d(t,"h",function(){return F}),n.d(t,"p",function(){return B}),n.d(t,"j",function(){return z}),n.d(t,"A",function(){return te}),n.d(t,"y",function(){return ne}),n.d(t,"k",function(){return W}),n.d(t,"l",function(){return G}),n.d(t,"d",function(){return w}),n.d(t,"s",function(){return E}),n.d(t,"f",function(){return b}),n.d(t,"q",function(){return x}),n.d(t,"c",function(){return S}),n.d(t,"r",function(){return C}),n.d(t,"e",function(){return T}),n.d(t,"t",function(){return P}),n.d(t,"o",function(){return X}),n.d(t,"v",function(){return $}),n.d(t,"u",function(){return Q});var m,_=this&&this.__extends||(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function g(e,t){void 0===t&&(t={});for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i];"function"==typeof e[o]&&(r[o]=e[o])}var a=Object.keys(r);return function(e,n){e=e||t;for(var i=!1,o={},s=0;s<a.length;s++){var l=a[s],u=e[l],c=(0,r[l])(u,n);o[l]=c,i=i||c!==u}return i?o:e}}function v(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){if(0===e.length)return t;var n=e[e.length-1];return e.slice(0,-1).reduceRight(function(e,t){return t(e)},n(t))}}function y(e,t){return Array.isArray(t)&&t.length>0?v.apply(null,t.concat([e])):e}var C=new r.o("@ngrx/store Internal Initial State"),w=new r.o("@ngrx/store Initial State"),b=new r.o("@ngrx/store Reducer Factory"),E=new r.o("@ngrx/store Reducer Factory Provider"),S=new r.o("@ngrx/store Initial Reducers"),x=new r.o("@ngrx/store Internal Initial Reducers"),T=new r.o("@ngrx/store Meta Reducers"),A=new r.o("@ngrx/store Store Features"),P=new r.o("@ngrx/store Internal Store Reducers"),D=new r.o("@ngrx/store Internal Feature Reducers"),M=new r.o("@ngrx/store Internal Feature Reducers Token"),I=new r.o("@ngrx/store Feature Reducers"),O="@ngrx/store/init",R=function(e){function t(){return e.call(this,{type:O})||this}return _(t,e),t.prototype.next=function(t){if("undefined"==typeof t)throw new TypeError("Actions must be objects");if("undefined"==typeof t.type)throw new TypeError("Actions must have a type property");e.prototype.next.call(this,t)},t.prototype.complete=function(){},t.prototype.ngOnDestroy=function(){e.prototype.complete.call(this)},t}(i.a),N=[R],L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(o.a),F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(R),B="@ngrx/store/update-reducers",k=function(e){function t(t,n,r,i){var o=e.call(this,i(r,n))||this;return o.dispatcher=t,o.initialState=n,o.reducers=r,o.reducerFactory=i,o}return _(t,e),t.prototype.addFeature=function(e){var t=e.reducers,n=e.initialState,r=e.key,i="function"==typeof t?function(e,r){return t(e||n,r)}:y(e.reducerFactory,e.metaReducers)(t,n);this.addReducer(r,i)},t.prototype.removeFeature=function(e){this.removeReducer(e.key)},t.prototype.addReducer=function(e,t){var n;this.reducers=Object.assign({},this.reducers,((n={})[e]=t,n)),this.updateReducers()},t.prototype.removeReducer=function(e){var t,n;this.reducers=(t=this.reducers,n=e,Object.keys(t).filter(function(e){return e!==n}).reduce(function(e,n){return Object.assign(e,((r={})[n]=t[n],r));var r},{})),this.updateReducers()},t.prototype.updateReducers=function(){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:B})},t.prototype.ngOnDestroy=function(){this.complete()},t}(i.a),V=[k,{provide:L,useExisting:k},{provide:F,useExisting:R}],z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t.prototype.ngOnDestroy=function(){this.complete()},t}(a.a),U=[z],G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),t}(o.a),W=function(e){function t(t,n,r,i){var o=e.call(this,i)||this,a=l.a.call(t,s.a),h=u.a.call(a,n),d=c.a.call(h,H,{state:i});return o.stateSubscription=d.subscribe({next:function(e){var t=e.action;o.next(e.state),r.next(t)}}),o}return _(t,e),t.prototype.ngOnDestroy=function(){this.stateSubscription.unsubscribe(),this.complete()},t}(i.a);function H(e,t){void 0===e&&(e={state:void 0});var n=t[0];return{state:(0,t[1])(e.state,n),action:n}}W.INIT=O;var j=[W,{provide:G,useExisting:W}],q=function(e){function t(t,n,r){var i=e.call(this)||this;return i.actionsObserver=n,i.reducerManager=r,i.source=t,i}return _(t,e),t.prototype.select=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if("string"==typeof e)t=p.call.apply(p,[this,e].concat(n));else{if("function"!=typeof e)throw new TypeError("Unexpected type '"+typeof e+"' in select operator, expected 'string' or 'function'");t=h.a.call(this,e)}return(function(e,t){return Object(f.a)(e,t)(this)}).call(t)},t.prototype.lift=function(e){var n=new t(this,this.actionsObserver,this.reducerManager);return n.operator=e,n},t.prototype.dispatch=function(e){this.actionsObserver.next(e)},t.prototype.next=function(e){this.actionsObserver.next(e)},t.prototype.error=function(e){this.actionsObserver.error(e)},t.prototype.complete=function(){this.actionsObserver.complete()},t.prototype.addReducer=function(e,t){this.reducerManager.addReducer(e,t)},t.prototype.removeReducer=function(e){this.reducerManager.removeReducer(e)},t}(o.a),Y=[q],X=function(e,t,n){},Z=function(){function e(e,t,n){this.features=e,this.featureReducers=t,this.reducerManager=n,e.map(function(e,n){var r=t.shift();return Object.assign({},e,{reducers:r[n],initialState:$(e.initialState)})}).forEach(function(e){return n.addFeature(e)})}return e.prototype.ngOnDestroy=function(){var e=this;this.features.forEach(function(t){return e.reducerManager.removeFeature(t)})},e}(),K=function(){function e(){}return e.forRoot=function(e,t){return void 0===t&&(t={}),{ngModule:X,providers:[{provide:C,useValue:t.initialState},{provide:w,useFactory:$,deps:[C]},{provide:x,useValue:e},{provide:P,useExisting:e instanceof r.o?e:x},{provide:S,deps:[r.p,x,[new r.n(P)]],useFactory:Q},{provide:T,useValue:t.metaReducers?t.metaReducers:[]},{provide:E,useValue:t.reducerFactory?t.reducerFactory:g},{provide:b,deps:[E,T],useFactory:y},N,V,U,j,Y]}},e.forFeature=function(e,t,n){return void 0===n&&(n={}),{ngModule:Z,providers:[{provide:A,multi:!0,useValue:{key:e,reducerFactory:n.reducerFactory?n.reducerFactory:g,metaReducers:n.metaReducers?n.metaReducers:[],initialState:n.initialState}},{provide:D,multi:!0,useValue:t},{provide:M,multi:!0,useExisting:t instanceof r.o?t:D},{provide:I,multi:!0,deps:[r.p,D,[new r.n(M)]],useFactory:J}]}},e}();function Q(e,t,n){return t instanceof r.o?e.get(t):t}function J(e,t,n){return t.map(function(t,n){return t instanceof r.o?e.get(t):t})}function $(e){return"function"==typeof e?e():e}function ee(e){var t=null,n=null;return{memoized:function(){if(!t)return n=e.apply(null,arguments),t=arguments,n;for(var r=0;r<arguments.length;r++)if(arguments[r]!==t[r])return n=e.apply(null,arguments),t=arguments,n;return n},reset:function(){t=null,n=null}}}function te(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e;if(Array.isArray(n[0])){var r=n[0],i=n.slice(1);n=r.concat(i)}var o=n.slice(0,n.length-1),a=n[n.length-1],s=o.filter(function(e){return e.release&&"function"==typeof e.release}),l=ee(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.apply(null,e)}),u=ee(function(e){var t=o.map(function(t){return t(e)});return l.memoized.apply(null,t)});return Object.assign(u.memoized,{release:function(){u.reset(),l.reset(),s.forEach(function(e){return e.release()})},projector:l.memoized})}function ne(e){var t=ee(function(t){return t[e]}),n=t.memoized;return Object.assign(n,{release:t.reset,projector:n})}},AP4T:function(e,t,n){"use strict";var r=n("xIGM"),i=n("E9/g"),o=n("V7AE"),a=n("grVA"),s=n("mz3w"),l=n("ExCY");n.d(t,"a",function(){return u});var u=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,s=function(e,t,n){if(e){if(e instanceof i.a)return e;if(e[o.a])return e[o.a]()}return e||t||n?new i.a(e,t,n):new i.a(a.a)}(e,t,n);if(r?r.call(s,this.source):s.add(this.source||!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.syncErrorThrown=!0,e.syncErrorValue=t,e.error(t)}},e.prototype.forEach=function(e,t){var n=this;if(t||(r.a.Rx&&r.a.Rx.config&&r.a.Rx.config.Promise?t=r.a.Rx.config.Promise:r.a.Promise&&(t=r.a.Promise)),!t)throw new Error("no Promise impl found");return new t(function(t,r){var i;i=n.subscribe(function(t){if(i)try{e(t)}catch(e){r(e),i.unsubscribe()}else e(t)},r,t)})},e.prototype._subscribe=function(e){return this.source.subscribe(e)},e.prototype[s.a]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return 0===e.length?this:Object(l.b)(e)(this)},e.prototype.toPromise=function(e){var t=this;if(e||(r.a.Rx&&r.a.Rx.config&&r.a.Rx.config.Promise?e=r.a.Rx.config.Promise:r.a.Promise&&(e=r.a.Promise)),!e)throw new Error("no Promise impl found");return new e(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}()},B1iP:function(e,t,n){"use strict";t.a=function(e){return"function"==typeof e}},BThc:function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r.a.apply(void 0,e)(this)};var r=n("8Gud")},Dxsx:function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){var n;return"function"==typeof e[e.length-1]&&(n=e.pop()),t.lift(new a(e,n))}};var r=n("6Xbx"),i=n("lI6h"),o=n("qgI0"),a=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.observables,this.project))},e}(),s=function(e){function t(t,n,r){e.call(this,t),this.observables=n,this.project=r,this.toRespond=[];var i=n.length;this.values=new Array(i);for(var a=0;a<i;a++)this.toRespond.push(a);for(a=0;a<i;a++){var s=n[a];this.add(Object(o.a)(this,s,s,a))}}return Object(r.c)(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values[n]=t;var o=this.toRespond;if(o.length>0){var a=o.indexOf(n);-1!==a&&o.splice(a,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(i.a)},"E9/g":function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("6Xbx"),i=n("B1iP"),o=n("qLnt"),a=n("grVA"),s=n("V7AE"),l=function(e){function t(n,r,i){switch(e.call(this),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a.a;break;case 1:if(!n){this.destination=a.a;break}if("object"==typeof n){n instanceof t?(this.syncErrorThrowable=n.syncErrorThrowable,this.destination=n,this.destination.add(this)):(this.syncErrorThrowable=!0,this.destination=new u(this,n));break}default:this.syncErrorThrowable=!0,this.destination=new u(this,n,r,i)}}return Object(r.c)(t,e),t.prototype[s.a]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parent,t=this._parents;return this._parent=null,this._parents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parent=e,this._parents=t,this},t}(o.a),u=function(e){function t(t,n,r,o){var s;e.call(this),this._parentSubscriber=t;var l=this;Object(i.a)(n)?s=n:n&&(s=n.next,r=n.error,o=n.complete,n!==a.a&&(l=Object.create(n),Object(i.a)(l.unsubscribe)&&this.add(l.unsubscribe.bind(l)),l.unsubscribe=this.unsubscribe.bind(this))),this._context=l,this._next=s,this._error=r,this._complete=o}return Object(r.c)(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber;if(this._error)t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else{if(!t.syncErrorThrowable)throw this.unsubscribe(),e;t.syncErrorValue=e,t.syncErrorThrown=!0,this.unsubscribe()}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){throw this.unsubscribe(),e}},t.prototype.__tryOrSetError=function(e,t,n){try{t.call(this._context,n)}catch(t){return e.syncErrorValue=t,e.syncErrorThrown=!0,!0}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(l)},"Ecq+":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("6Xbx"),i=function(e){function t(t){e.call(this),this.scheduler=t}return Object(r.c)(t,e),t.create=function(e){return new t(e)},t.dispatch=function(e){e.subscriber.complete()},t.prototype._subscribe=function(e){var n=this.scheduler;if(n)return n.schedule(t.dispatch,0,{subscriber:e});e.complete()},t}(n("AP4T").a)},ExCY:function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return i(e)},t.b=i;var r=n("PR+T");function i(e){return e?1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)}:r.a}},GI3C:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return n.lift(new s(e,t))}};var r=n("6Xbx"),i=n("E9/g"),o=n("8ofh"),a=n("NePw"),s=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new l(e,this.compare,this.keySelector))},e}(),l=function(e){function t(t,n,r){e.call(this,t),this.keySelector=r,this.hasKey=!1,"function"==typeof n&&(this.compare=n)}return Object(r.c)(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t=e;if(this.keySelector&&(t=Object(o.a)(this.keySelector)(e))===a.a)return this.destination.error(a.a.e);var n=!1;if(this.hasKey){if((n=Object(o.a)(this.compare)(this.key,t))===a.a)return this.destination.error(a.a.e)}else this.hasKey=!0;!1===Boolean(n)&&(this.key=t,this.destination.next(e))},t}(i.a)},GTlS:function(e,t,n){"use strict";var r=n("6Xbx"),i=n("xIGM"),o=function(e){function t(t,n){e.call(this)}return Object(r.c)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n("qLnt").a);n.d(t,"a",function(){return a});var a=function(e){function t(t,n){e.call(this,t,n),this.scheduler=t,this.work=n,this.pending=!1}return Object(r.c)(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e,this.pending=!0;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),i.a.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;i.a.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(o)},Gcw1:function(e,t,n){"use strict";var r=n("6Xbx"),i=function(e){function t(t,n){e.call(this,t,n),this.scheduler=t,this.work=n}return Object(r.c)(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n("GTlS").a),o=function(e){function t(){e.apply(this,arguments)}return Object(r.c)(t,e),t}(n("wclm").a);n.d(t,"a",function(){return a});var a=new o(i)},GpNi:function(e,t,n){"use strict";t.a=function(e,t){return Object(r.a)(e,t)(this)};var r=n("5jKg")},JHvW:function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var n=e.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(t){return Object(r.a)((i=e,o=n,function(e){for(var t=e,n=0;n<o;n++){var r=t[i[n]];if("undefined"==typeof r)return;t=r}return t}))(t);var i,o}};var r=n("qqDE")},LHF8:function(e,t,n){"use strict";var r=n("6Xbx"),i=n("TO51"),o=n("AP4T"),a=(n("E9/g"),n("qLnt")),s=n("RWQz"),l=function(e){function t(t,n){e.call(this),this.source=t,this.subjectFactory=n,this._refCount=0,this._isComplete=!1}return Object(r.c)(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new a.a).add(this.source.subscribe(new c(this.getSubject(),this))),e.closed?(this._connection=null,e=a.a.EMPTY):this._connection=e),e},t.prototype.refCount=function(){return Object(s.a)()(this)},t}(o.a).prototype,u={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:l._subscribe},_isComplete:{value:l._isComplete,writable:!0},getSubject:{value:l.getSubject},connect:{value:l.connect},refCount:{value:l.refCount}},c=function(e){function t(t,n){e.call(this,t),this.connectable=n}return Object(r.c)(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(i.b);t.a=function(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new h(r,t));var i=Object.create(n,u);return i.source=n,i.subjectFactory=r,i}};var h=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}()},LMZF:function(e,t,n){"use strict";(function(e){n.d(t,"g",function(){return Qe}),n.d(t,"Q",function(){return He}),n.d(t,"T",function(){return je}),n.d(t,"P",function(){return Ye}),n.d(t,"w",function(){return qe}),n.d(t,"c",function(){return re}),n.d(t,"A",function(){return ae}),n.d(t,"z",function(){return se}),n.d(t,"b",function(){return le}),n.d(t,"d",function(){return te}),n.d(t,"e",function(){return ne}),n.d(t,"S",function(){return mt}),n.d(t,"K",function(){return Fe}),n.d(t,"V",function(){return ke}),n.d(t,"s",function(){return kt}),n.d(t,"f",function(){return Gt}),n.d(t,"m",function(){return Pe}),n.d(t,"l",function(){return J}),n.d(t,"E",function(){return Ht}),n.d(t,"F",function(){return Wt}),n.d(t,"a",function(){return h}),n.d(t,"N",function(){return d}),n.d(t,"L",function(){return p}),n.d(t,"R",function(){return A}),n.d(t,"p",function(){return I}),n.d(t,"o",function(){return l}),n.d(t,"n",function(){return m}),n.d(t,"y",function(){return _}),n.d(t,"G",function(){return v}),n.d(t,"x",function(){return De}),n.d(t,"B",function(){return tt}),n.d(t,"C",function(){return $e}),n.d(t,"D",function(){return et}),n.d(t,"i",function(){return he}),n.d(t,"j",function(){return ye}),n.d(t,"k",function(){return nt}),n.d(t,"t",function(){return Ee}),n.d(t,"v",function(){return be}),n.d(t,"u",function(){return rt}),n.d(t,"H",function(){return st}),n.d(t,"I",function(){return ot}),n.d(t,"J",function(){return ut}),n.d(t,"M",function(){return ct}),n.d(t,"h",function(){return ht}),n.d(t,"q",function(){return Ot}),n.d(t,"r",function(){return Rt}),n.d(t,"O",function(){return vt}),n.d(t,"U",function(){return Bt}),n.d(t,"_7",function(){return Ct}),n.d(t,"X",function(){return ue}),n.d(t,"W",function(){return Ce}),n.d(t,"_5",function(){return w}),n.d(t,"_12",function(){return x}),n.d(t,"_22",function(){return T}),n.d(t,"_8",function(){return ee}),n.d(t,"_9",function(){return $}),n.d(t,"Y",function(){return Bn}),n.d(t,"Z",function(){return nr}),n.d(t,"_0",function(){return eo}),n.d(t,"_1",function(){return un}),n.d(t,"_2",function(){return wr}),n.d(t,"_3",function(){return kn}),n.d(t,"_6",function(){return Ln}),n.d(t,"_14",function(){return Yn}),n.d(t,"_15",function(){return qn}),n.d(t,"_16",function(){return cr}),n.d(t,"_17",function(){return br}),n.d(t,"_20",function(){return Er}),n.d(t,"_18",function(){return Wr}),n.d(t,"_19",function(){return Gr}),n.d(t,"_21",function(){return Br}),n.d(t,"_23",function(){return jr}),n.d(t,"_24",function(){return an}),n.d(t,"_25",function(){return Xr}),n.d(t,"_10",function(){return Vt}),n.d(t,"_11",function(){return zt}),n.d(t,"_13",function(){return Ut}),n.d(t,"_4",function(){return ie});var r=n("6Xbx"),i=n("AP4T"),o=n("2kLc"),a=n("URbD"),s=n("TO51"),l=function(){function e(e){this._desc=e,this.ngMetadataName="InjectionToken"}return e.prototype.toString=function(){return"InjectionToken "+this._desc},e}(),u="__paramaters__";function c(e,t,n){var r,i=(r=t,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(r){var n=r.apply(void 0,e);for(var i in n)this[i]=n[i]}});function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this instanceof o)return i.apply(this,e),this;var n,r=new((n=o).bind.apply(n,[void 0].concat(e)));return a.annotation=r,a;function a(e,t,n){for(var i=e.hasOwnProperty(u)?e[u]:Object.defineProperty(e,u,{value:[]})[u];i.length<=n;)i.push(null);return(i[n]=i[n]||[]).push(r),e}}return n&&(o.prototype=Object.create(n.prototype)),o.prototype.ngMetadataName=e,o.annotationCls=o,o}var h=new l("AnalyzeForEntryComponents"),d=function(){var e={Emulated:0,Native:1,None:2};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e}(),p=function(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")},f=new p("5.1.3"),m=c("Inject",function(e){return{token:e}}),_=c("Optional"),g=c("Self"),v=c("SkipSelf"),y="undefined"!=typeof window&&window,C="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,w=y||"undefined"!=typeof e&&e||C,b=null;function E(){if(!b){var e=w.Symbol;if(e&&e.iterator)b=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(b=r)}}return b}function S(e){Zone.current.scheduleMicroTask("scheduleMicrotask",e)}function x(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}function T(e){if("string"==typeof e)return e;if(e instanceof Array)return"["+e.map(T).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return""+e.overriddenName;if(e.name)return""+e.name;var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function A(e){return e.__forward_ref__=A,e.toString=function(){return T(this())},e}function P(e){return"function"==typeof e&&e.hasOwnProperty("__forward_ref__")&&e.__forward_ref__===A?e():e}var D=new Object,M=function(){function e(){}return e.prototype.get=function(e,t){if(void 0===t&&(t=D),t===D)throw new Error("NullInjectorError: No provider for "+T(e)+"!");return t},e}(),I=function(){function e(){}return e.create=function(e,t){return new G(e,t)},e.THROW_IF_NOT_FOUND=D,e.NULL=new M,e}(),O=function(e){return e},R=[],N=O,L=function(){return Array.prototype.slice.call(arguments)},F={},B=function(e){for(var t in e)if(e[t]===F)return t;throw Error("!prop")}({provide:String,useValue:F}),k="ngTempTokenPath",V=I.NULL,z=/\n/gm,U="\u0275",G=function(){function e(e,t){void 0===t&&(t=V),this.parent=t;var n=this._records=new Map;n.set(I,{token:I,fn:O,deps:R,value:this,useNew:!1}),function e(t,n){if(n)if((n=P(n))instanceof Array)for(var r=0;r<n.length;r++)e(t,n[r]);else{if("function"==typeof n)throw j("Function/Class not supported",n);if(!n||"object"!=typeof n||!n.provide)throw j("Unexpected provider",n);var i=P(n.provide),o=function(e){var t=function(e){var t=R,n=e.deps;if(n&&n.length){t=[];for(var r=0;r<n.length;r++){var i=6;if((l=P(n[r]))instanceof Array)for(var o=0,a=l;o<a.length;o++){var s=a[o];s instanceof _||s==_?i|=1:s instanceof v||s==v?i&=-3:s instanceof g||s==g?i&=-5:l=s instanceof m?s.token:P(s)}t.push({token:l,options:i})}}else if(e.useExisting){var l;t=[{token:l=P(e.useExisting),options:6}]}else if(!(n||B in e))throw j("'deps' required",e);return t}(e),n=O,r=R,i=!1,o=P(e.provide);if(B in e)r=e.useValue;else if(e.useFactory)n=e.useFactory;else if(e.useExisting);else if(e.useClass)i=!0,n=P(e.useClass);else{if("function"!=typeof o)throw j("StaticProvider does not have [useValue|useFactory|useExisting|useClass] or [provide] is not newable",e);i=!0,n=o}return{deps:t,fn:n,useNew:i,value:r}}(n);if(!0===n.multi){var a=t.get(i);if(a){if(a.fn!==L)throw W(i)}else t.set(i,a={token:n.provide,deps:[],useNew:!1,fn:L,value:R});a.deps.push({token:i=n,options:6})}var s=t.get(i);if(s&&s.fn==L)throw W(i);t.set(i,o)}}(n,e)}return e.prototype.get=function(e,t){var n=this._records.get(e);try{return function e(t,n,r,i,o){try{return function(t,n,r,i,o){var a,s;if(n){if((a=n.value)==N)throw Error(U+"Circular dependency");if(a===R){n.value=N;var l=n.useNew,u=n.fn,c=n.deps,h=R;if(c.length){h=[];for(var d=0;d<c.length;d++){var p=c[d],f=p.options,m=2&f?r.get(p.token):void 0;h.push(e(p.token,m,r,m||4&f?i:V,1&f?null:I.THROW_IF_NOT_FOUND))}}n.value=a=l?new((s=u).bind.apply(s,[void 0].concat(h))):u.apply(void 0,h)}}else a=i.get(t,o);return a}(t,n,r,i,o)}catch(e){throw e instanceof Error||(e=new Error(e)),(e[k]=e[k]||[]).unshift(t),n&&n.value==N&&(n.value=R),e}}(e,n,this._records,this.parent,t)}catch(e){var r=e[k];throw e.message=H("\n"+e.message,r),e.ngTokenPath=r,e[k]=null,e}},e.prototype.toString=function(){var e=[];return this._records.forEach(function(t,n){return e.push(T(n))}),"StaticInjector["+e.join(", ")+"]"},e}();function W(e){return j("Cannot mix multi providers and regular providers",e)}function H(e,t){e=e&&"\n"===e.charAt(0)&&e.charAt(1)==U?e.substr(2):e;var n=T(t);if(t instanceof Array)n=t.map(T).join(" -> ");else if("object"==typeof t){var r=[];for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];r.push(i+":"+("string"==typeof o?JSON.stringify(o):T(o)))}n="{"+r.join(", ")+"}"}return"StaticInjectorError["+n+"]: "+e.replace(z,"\n  ")}function j(e,t){return new Error(H(e,t))}var q="ngDebugContext",Y="ngOriginalError",X="ngErrorLogger";function Z(e){return e[q]}function K(e){return e[Y]}function Q(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e.error.apply(e,t)}var J=function(){function e(){this._console=console}return e.prototype.handleError=function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=e[X]||Q;r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)},e.prototype._findContext=function(e){return e?Z(e)?Z(e):this._findContext(K(e)):null},e.prototype._findOriginalError=function(e){for(var t=K(e);t&&K(t);)t=K(t);return t},e}();function $(e){return!!e&&"function"==typeof e.then}function ee(e){return!!e&&"function"==typeof e.subscribe}Function;var te=new l("Application Initializer"),ne=function(){function e(e){var t=this;this.appInits=e,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return e.prototype.runInitializers=function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var i=this.appInits[r]();$(i)&&t.push(i)}Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}},e}(),re=new l("AppId");function ie(){return""+oe()+oe()+oe()}function oe(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var ae=new l("Platform Initializer"),se=new l("Platform ID"),le=new l("appBootstrapListener"),ue=function(){function e(){}return e.prototype.log=function(e){console.log(e)},e.prototype.warn=function(e){console.warn(e)},e.ctorParameters=function(){return[]},e}();function ce(){throw new Error("Runtime compiler is not loaded")}var he=function(){function e(){}return e.prototype.compileModuleSync=function(e){throw ce()},e.prototype.compileModuleAsync=function(e){throw ce()},e.prototype.compileModuleAndAllComponentsSync=function(e){throw ce()},e.prototype.compileModuleAndAllComponentsAsync=function(e){throw ce()},e.prototype.clearCache=function(){},e.prototype.clearCacheFor=function(e){},e}(),de=function(){},pe=function(){};function fe(e){var t=Error("No component factory found for "+T(e)+". Did you add it to @NgModule.entryComponents?");return t[ge]=e,t}var me,_e,ge="ngComponent",ve=function(){function e(){}return e.prototype.resolveComponentFactory=function(e){throw fe(e)},e}(),ye=function(){function e(){}return e.NULL=new ve,e}(),Ce=function(){function e(e,t,n){this._parent=t,this._ngModule=n,this._factories=new Map;for(var r=0;r<e.length;r++){var i=e[r];this._factories.set(i.componentType,i)}}return e.prototype.resolveComponentFactory=function(e){var t=this._factories.get(e);if(!t&&this._parent&&(t=this._parent.resolveComponentFactory(e)),!t)throw fe(e);return new we(t,this._ngModule)},e}(),we=function(e){function t(t,n){var r=e.call(this)||this;return r.factory=t,r.ngModule=n,r}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"selector",{get:function(){return this.factory.selector},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentType",{get:function(){return this.factory.componentType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ngContentSelectors",{get:function(){return this.factory.ngContentSelectors},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inputs",{get:function(){return this.factory.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){return this.factory.outputs},enumerable:!0,configurable:!0}),t.prototype.create=function(e,t,n,r){return this.factory.create(e,t,n,r||this.ngModule)},t}(pe),be=function(){},Ee=function(){},Se=function(){var e=w.wtf;return!(!e||!(me=e.trace)||(_e=me.events,0))}();function xe(e,t){return null}var Te=Se?function(e,t){return void 0===t&&(t=null),_e.createScope(e,t)}:function(e,t){return xe},Ae=Se?function(e,t){return me.leaveScope(e,t),t}:function(e,t){return t},Pe=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n.__isAsync=t,n}return Object(r.c)(t,e),t.prototype.emit=function(t){e.prototype.next.call(this,t)},t.prototype.subscribe=function(t,n,r){var i,o=function(e){return null},a=function(){return null};return t&&"object"==typeof t?(i=this.__isAsync?function(e){setTimeout(function(){return t.next(e)})}:function(e){t.next(e)},t.error&&(o=this.__isAsync?function(e){setTimeout(function(){return t.error(e)})}:function(e){t.error(e)}),t.complete&&(a=this.__isAsync?function(){setTimeout(function(){return t.complete()})}:function(){t.complete()})):(i=this.__isAsync?function(e){setTimeout(function(){return t(e)})}:function(e){t(e)},n&&(o=this.__isAsync?function(e){setTimeout(function(){return n(e)})}:function(e){n(e)}),r&&(a=this.__isAsync?function(){setTimeout(function(){return r()})}:function(){r()})),e.prototype.subscribe.call(this,i,o,a)},t}(s.a),De=function(){function e(e){var t,n=e.enableLongStackTrace,r=void 0!==n&&n;if(this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pe(!1),this.onMicrotaskEmpty=new Pe(!1),this.onStable=new Pe(!1),this.onError=new Pe(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),(t=this)._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,n,r,i,o,a){try{return Re(t),e.invokeTask(r,i,o,a)}finally{Ne(t)}},onInvoke:function(e,n,r,i,o,a,s){try{return Re(t),e.invoke(r,i,o,a,s)}finally{Ne(t)}},onHasTask:function(e,n,r,i){e.hasTask(r,i),n===r&&("microTask"==i.change?(t.hasPendingMicrotasks=i.microTask,Oe(t)):"macroTask"==i.change&&(t.hasPendingMacrotasks=i.macroTask))},onHandleError:function(e,n,r,i){return e.handleError(r,i),t.runOutsideAngular(function(){return t.onError.emit(i)}),!1}})}return e.isInAngularZone=function(){return!0===Zone.current.get("isAngularZone")},e.assertInAngularZone=function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")},e.assertNotInAngularZone=function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")},e.prototype.run=function(e,t,n){return this._inner.run(e,t,n)},e.prototype.runTask=function(e,t,n,r){var i=this._inner,o=i.scheduleEventTask("NgZoneEvent: "+r,e,Ie,Me,Me);try{return i.runTask(o,t,n)}finally{i.cancelTask(o)}},e.prototype.runGuarded=function(e,t,n){return this._inner.runGuarded(e,t,n)},e.prototype.runOutsideAngular=function(e){return this._outer.run(e)},e}();function Me(){}var Ie={};function Oe(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function Re(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Ne(e){e._nesting--,Oe(e)}var Le=function(){function e(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pe,this.onMicrotaskEmpty=new Pe,this.onStable=new Pe,this.onError=new Pe}return e.prototype.run=function(e){return e()},e.prototype.runGuarded=function(e){return e()},e.prototype.runOutsideAngular=function(e){return e()},e.prototype.runTask=function(e){return e()},e}(),Fe=function(){function e(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this._watchAngularEvents()}return e.prototype._watchAngularEvents=function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){De.assertNotInAngularZone(),S(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})},e.prototype.increasePendingRequestCount=function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount},e.prototype.decreasePendingRequestCount=function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount},e.prototype.isStable=function(){return this._isZoneStable&&0==this._pendingCount&&!this._ngZone.hasPendingMacrotasks},e.prototype._runCallbacksIfReady=function(){var e=this;this.isStable()?S(function(){for(;0!==e._callbacks.length;)e._callbacks.pop()(e._didWork);e._didWork=!1}):this._didWork=!0},e.prototype.whenStable=function(e){this._callbacks.push(e),this._runCallbacksIfReady()},e.prototype.getPendingRequestCount=function(){return this._pendingCount},e.prototype.findProviders=function(e,t,n){return[]},e}(),Be=function(){function e(){this._applications=new Map,ze.addToWindow(this)}return e.prototype.registerApplication=function(e,t){this._applications.set(e,t)},e.prototype.unregisterApplication=function(e){this._applications.delete(e)},e.prototype.unregisterAllApplications=function(){this._applications.clear()},e.prototype.getTestability=function(e){return this._applications.get(e)||null},e.prototype.getAllTestabilities=function(){return Array.from(this._applications.values())},e.prototype.getAllRootElements=function(){return Array.from(this._applications.keys())},e.prototype.findTestabilityInTree=function(e,t){return void 0===t&&(t=!0),ze.findTestabilityInTree(this,e,t)},e.ctorParameters=function(){return[]},e}();function ke(e){ze=e}var Ve,ze=new(function(){function e(){}return e.prototype.addToWindow=function(e){},e.prototype.findTestabilityInTree=function(e,t,n){return null},e}()),Ue=!0,Ge=!1,We=new l("AllowMultipleToken");function He(){if(Ge)throw new Error("Cannot enable prod mode after platform setup.");Ue=!1}function je(){return Ge=!0,Ue}var qe=function(e,t){this.name=e,this.token=t};function Ye(e,t,n){void 0===n&&(n=[]);var r=new l("Platform: "+t);return function(t){void 0===t&&(t=[]);var i=Xe();return i&&!i.injector.get(We,!1)||(e?e(n.concat(t).concat({provide:r,useValue:!0})):function(e){if(Ve&&!Ve.destroyed&&!Ve.injector.get(We,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Ve=e.get(Ze);var t=e.get(ae,null);t&&t.forEach(function(e){return e()})}(I.create(n.concat(t).concat({provide:r,useValue:!0})))),function(e){var t=Xe();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function Xe(){return Ve&&!Ve.destroyed?Ve:null}var Ze=function(){function e(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return e.prototype.bootstrapModuleFactory=function(e,t){var n,r=this,i="noop"===(n=t?t.ngZone:void 0)?new Le:("zone.js"===n?void 0:n)||new De({enableLongStackTrace:je()});return i.run(function(){var t=I.create([{provide:De,useValue:i}],r.injector),n=e.create(t),o=n.injector.get(J,null);if(!o)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy(function(){return Je(r._modules,n)}),i.runOutsideAngular(function(){return i.onError.subscribe({next:function(e){o.handleError(e)}})}),function(e,t,i){try{var o=((a=n.injector.get(ne)).runInitializers(),a.donePromise.then(function(){return r._moduleDoBootstrap(n),n}));return $(o)?o.catch(function(n){throw t.runOutsideAngular(function(){return e.handleError(n)}),n}):o}catch(n){throw t.runOutsideAngular(function(){return e.handleError(n)}),n}var a}(o,i)})},e.prototype.bootstrapModule=function(e,t){var n=this;void 0===t&&(t=[]);var r=this.injector.get(de),i=Ke({},t);return r.createCompiler([i]).compileModuleAsync(e).then(function(e){return n.bootstrapModuleFactory(e,i)})},e.prototype._moduleDoBootstrap=function(e){var t=e.injector.get(Qe);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module "+T(e.instance.constructor)+' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.');e.instance.ngDoBootstrap(t)}this._modules.push(e)},e.prototype.onDestroy=function(e){this._destroyListeners.push(e)},Object.defineProperty(e.prototype,"injector",{get:function(){return this._injector},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!0,configurable:!0}),e}();function Ke(e,t){return Array.isArray(t)?t.reduce(Ke,e):Object(r.a)({},e,t)}var Qe=function(){function e(e,t,n,r,s,l){var u=this;this._zone=e,this._console=t,this._injector=n,this._exceptionHandler=r,this._componentFactoryResolver=s,this._initStatus=l,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=je(),this._zone.onMicrotaskEmpty.subscribe({next:function(){u._zone.run(function(){u.tick()})}});var c=new i.a(function(e){u._stable=u._zone.isStable&&!u._zone.hasPendingMacrotasks&&!u._zone.hasPendingMicrotasks,u._zone.runOutsideAngular(function(){e.next(u._stable),e.complete()})}),h=new i.a(function(e){var t;u._zone.runOutsideAngular(function(){t=u._zone.onStable.subscribe(function(){De.assertNotInAngularZone(),S(function(){u._stable||u._zone.hasPendingMacrotasks||u._zone.hasPendingMicrotasks||(u._stable=!0,e.next(!0))})})});var n=u._zone.onUnstable.subscribe(function(){De.assertInAngularZone(),u._stable&&(u._stable=!1,u._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=Object(o.a)(c,a.a.call(h))}return e.prototype.bootstrap=function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof pe?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var i=n instanceof we?null:this._injector.get(be),o=n.create(I.NULL,[],t||n.selector,i);o.onDestroy(function(){r._unloadComponent(o)});var a=o.injector.get(Fe,null);return a&&o.injector.get(Be).registerApplication(o.location.nativeElement,a),this._loadComponent(o),je()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),o},e.prototype.tick=function(){var t=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");var n=e._tickScope();try{this._runningTick=!0,this._views.forEach(function(e){return e.detectChanges()}),this._enforceNoNewChanges&&this._views.forEach(function(e){return e.checkNoChanges()})}catch(e){this._zone.runOutsideAngular(function(){return t._exceptionHandler.handleError(e)})}finally{this._runningTick=!1,Ae(n)}},e.prototype.attachView=function(e){var t=e;this._views.push(t),t.attachToAppRef(this)},e.prototype.detachView=function(e){var t=e;Je(this._views,t),t.detachFromAppRef()},e.prototype._loadComponent=function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(le,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})},e.prototype._unloadComponent=function(e){this.detachView(e.hostView),Je(this.components,e)},e.prototype.ngOnDestroy=function(){this._views.slice().forEach(function(e){return e.destroy()})},Object.defineProperty(e.prototype,"viewCount",{get:function(){return this._views.length},enumerable:!0,configurable:!0}),e._tickScope=Te("ApplicationRef#tick()"),e}();function Je(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var $e=function(){},et=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),tt=function(){},nt=function(e){this.nativeElement=e},rt=function(){},it=function(){function e(){this.dirty=!0,this._results=[],this.changes=new Pe}return Object.defineProperty(e.prototype,"length",{get:function(){return this._results.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this._results[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this._results[this.length-1]},enumerable:!0,configurable:!0}),e.prototype.map=function(e){return this._results.map(e)},e.prototype.filter=function(e){return this._results.filter(e)},e.prototype.find=function(e){return this._results.find(e)},e.prototype.reduce=function(e,t){return this._results.reduce(e,t)},e.prototype.forEach=function(e){this._results.forEach(e)},e.prototype.some=function(e){return this._results.some(e)},e.prototype.toArray=function(){return this._results.slice()},e.prototype[E()]=function(){return this._results[E()]()},e.prototype.toString=function(){return this._results.toString()},e.prototype.reset=function(e){this._results=function e(t){return t.reduce(function(t,n){var r=Array.isArray(n)?e(n):n;return t.concat(r)},[])}(e),this.dirty=!1},e.prototype.notifyOnChanges=function(){this.changes.emit(this)},e.prototype.setDirty=function(){this.dirty=!0},e.prototype.destroy=function(){this.changes.complete(),this.changes.unsubscribe()},e}(),ot=function(){},at={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},st=function(){function e(e,t){this._compiler=e,this._config=t||at}return e.prototype.load=function(e){return this._compiler instanceof he?this.loadFactory(e):this.loadAndCompile(e)},e.prototype.loadAndCompile=function(e){var t=this,r=e.split("#"),i=r[0],o=r[1];return void 0===o&&(o="default"),n("YuZA")(i).then(function(e){return e[o]}).then(function(e){return lt(e,i,o)}).then(function(e){return t._compiler.compileModuleAsync(e)})},e.prototype.loadFactory=function(e){var t=e.split("#"),r=t[0],i=t[1],o="NgFactory";return void 0===i&&(i="default",o=""),n("YuZA")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then(function(e){return e[i+o]}).then(function(e){return lt(e,r,i)})},e}();function lt(e,t,n){if(!e)throw new Error("Cannot find '"+n+"' in '"+t+"'");return e}var ut=function(){},ct=function(){},ht=function(){},dt=function(){function e(e,t,n){this._debugContext=n,this.nativeNode=e,t&&t instanceof pt?t.addChild(this):this.parent=null,this.listeners=[]}return Object.defineProperty(e.prototype,"injector",{get:function(){return this._debugContext.injector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentInstance",{get:function(){return this._debugContext.component},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._debugContext.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"references",{get:function(){return this._debugContext.references},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"providerTokens",{get:function(){return this._debugContext.providerTokens},enumerable:!0,configurable:!0}),e}(),pt=function(e){function t(t,n,r){var i=e.call(this,t,n,r)||this;return i.properties={},i.attributes={},i.classes={},i.styles={},i.childNodes=[],i.nativeElement=t,i}return Object(r.c)(t,e),t.prototype.addChild=function(e){e&&(this.childNodes.push(e),e.parent=this)},t.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);-1!==t&&(e.parent=null,this.childNodes.splice(t,1))},t.prototype.insertChildrenAfter=function(e,t){var n,r=this,i=this.childNodes.indexOf(e);-1!==i&&((n=this.childNodes).splice.apply(n,[i+1,0].concat(t)),t.forEach(function(e){e.parent&&e.parent.removeChild(e),e.parent=r}))},t.prototype.insertBefore=function(e,t){var n=this.childNodes.indexOf(e);-1===n?this.addChild(t):(t.parent&&t.parent.removeChild(t),t.parent=this,this.childNodes.splice(n,0,t))},t.prototype.query=function(e){return this.queryAll(e)[0]||null},t.prototype.queryAll=function(e){var t=[];return function e(t,n,r){t.childNodes.forEach(function(t){t instanceof pt&&(n(t)&&r.push(t),e(t,n,r))})}(this,e,t),t},t.prototype.queryAllNodes=function(e){var t=[];return function e(t,n,r){t instanceof pt&&t.childNodes.forEach(function(t){n(t)&&r.push(t),t instanceof pt&&e(t,n,r)})}(this,e,t),t},Object.defineProperty(t.prototype,"children",{get:function(){return this.childNodes.filter(function(e){return e instanceof t})},enumerable:!0,configurable:!0}),t.prototype.triggerEventHandler=function(e,t){this.listeners.forEach(function(n){n.name==e&&n.callback(t)})},t}(dt),ft=new Map;function mt(e){return ft.get(e)||null}function _t(e){ft.set(e.nativeNode,e)}function gt(e,t){var n=Ct(e),r=Ct(t);return n&&r?function(t,n,r){for(var i=e[E()](),o=n[E()]();;){var a=i.next(),s=o.next();if(a.done&&s.done)return!0;if(a.done||s.done)return!1;if(!r(a.value,s.value))return!1}}(0,t,gt):!(n||!e||"object"!=typeof e&&"function"!=typeof e||r||!t||"object"!=typeof t&&"function"!=typeof t)||x(e,t)}var vt=function(){function e(e){this.wrapped=e}return e.wrap=function(t){return new e(t)},e}(),yt=function(){function e(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}return e.prototype.isFirstChange=function(){return this.firstChange},e}();function Ct(e){return!!wt(e)&&(Array.isArray(e)||!(e instanceof Map)&&E()in e)}function wt(e){return null!==e&&("function"==typeof e||"object"==typeof e)}var bt=function(){function e(){}return e.prototype.supports=function(e){return Ct(e)},e.prototype.create=function(e){return new St(e)},e}(),Et=function(e,t){return t},St=function(){function e(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Et}return e.prototype.forEachItem=function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)},e.prototype.forEachOperation=function(e){for(var t=this._itHead,n=this._removalsHead,r=0,i=null;t||n;){var o=!n||t&&t.currentIndex<Pt(n,r,i)?t:n,a=Pt(o,r,i),s=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,null==o.previousIndex)r++;else{i||(i=[]);var l=a-r,u=s-r;if(l!=u){for(var c=0;c<l;c++){var h=c<i.length?i[c]:i[c]=0,d=h+c;u<=d&&d<l&&(i[c]=h+1)}i[o.previousIndex]=u-l}}a!==s&&e(o,a,s)}},e.prototype.forEachPreviousItem=function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)},e.prototype.forEachAddedItem=function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)},e.prototype.forEachMovedItem=function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)},e.prototype.forEachRemovedItem=function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)},e.prototype.forEachIdentityChange=function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)},e.prototype.diff=function(e){if(null==e&&(e=[]),!Ct(e))throw new Error("Error trying to diff '"+T(e)+"'. Only arrays and iterables are allowed");return this.check(e)?this:null},e.prototype.onDestroy=function(){},e.prototype.check=function(e){var t=this;this._reset();var n,r,i,o=this._itHead,a=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)i=this._trackByFn(s,r=e[s]),null!==o&&x(o.trackById,i)?(a&&(o=this._verifyReinsertion(o,r,i,s)),x(o.item,r)||this._addIdentityChange(o,r)):(o=this._mismatch(o,r,i,s),a=!0),o=o._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r=e[E()](),i=void 0;!(i=r.next()).done;)t(i.value)}(e,function(e){i=t._trackByFn(n,e),null!==o&&x(o.trackById,i)?(a&&(o=t._verifyReinsertion(o,e,i,n)),x(o.item,e)||t._addIdentityChange(o,e)):(o=t._mismatch(o,e,i,n),a=!0),o=o._next,n++}),this.length=n;return this._truncate(o),this.collection=e,this.isDirty},Object.defineProperty(e.prototype,"isDirty",{get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead},enumerable:!0,configurable:!0}),e.prototype._reset=function(){if(this.isDirty){var e=void 0,t=void 0;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}},e.prototype._mismatch=function(e,t,n,r){var i;return null===e?i=this._itTail:(i=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(x(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,i,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(x(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,i,r)):e=this._addAfter(new xt(t,n),i,r),e},e.prototype._verifyReinsertion=function(e,t,n,r){var i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==i?e=this._reinsertAfter(i,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e},e.prototype._truncate=function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)},e.prototype._reinsertAfter=function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,i=e._nextRemoved;return null===r?this._removalsHead=i:r._nextRemoved=i,null===i?this._removalsTail=r:i._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e},e.prototype._moveAfter=function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e},e.prototype._addAfter=function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e},e.prototype._insertAfter=function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new At),this._linkedRecords.put(e),e.currentIndex=n,e},e.prototype._remove=function(e){return this._addToRemovals(this._unlink(e))},e.prototype._unlink=function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e},e.prototype._addToMoves=function(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)},e.prototype._addToRemovals=function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new At),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e},e.prototype._addIdentityChange=function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e},e}(),xt=function(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},Tt=function(){function e(){this._head=null,this._tail=null}return e.prototype.add=function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)},e.prototype.get=function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&x(n.trackById,e))return n;return null},e.prototype.remove=function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head},e}(),At=function(){function e(){this.map=new Map}return e.prototype.put=function(e){var t=e.trackById,n=this.map.get(t);n||(n=new Tt,this.map.set(t,n)),n.add(e)},e.prototype.get=function(e,t){var n=this.map.get(e);return n?n.get(e,t):null},e.prototype.remove=function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e},Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.map.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this.map.clear()},e}();function Pt(e,t,n){var r=e.previousIndex;if(null===r)return r;var i=0;return n&&r<n.length&&(i=n[r]),r+t+i}var Dt=function(){function e(){}return e.prototype.supports=function(e){return e instanceof Map||wt(e)},e.prototype.create=function(){return new Mt},e}(),Mt=function(){function e(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead},enumerable:!0,configurable:!0}),e.prototype.forEachItem=function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)},e.prototype.forEachPreviousItem=function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)},e.prototype.forEachChangedItem=function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)},e.prototype.forEachAddedItem=function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)},e.prototype.forEachRemovedItem=function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)},e.prototype.diff=function(e){if(e){if(!(e instanceof Map||wt(e)))throw new Error("Error trying to diff '"+T(e)+"'. Only maps and objects are allowed")}else e=new Map;return this.check(e)?this:null},e.prototype.onDestroy=function(){},e.prototype.check=function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var i=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,i)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty},e.prototype._insertBeforeOrAppend=function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null},e.prototype._getOrCreateRecordForKey=function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,i=n._next;return r&&(r._next=i),i&&(i._prev=r),n._next=null,n._prev=null,n}var o=new It(e);return this._records.set(e,o),o.currentValue=t,this._addToAdditions(o),o},e.prototype._reset=function(){if(this.isDirty){var e=void 0;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}},e.prototype._maybeAddToChanges=function(e,t){x(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))},e.prototype._addToAdditions=function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)},e.prototype._addToChanges=function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)},e.prototype._forEach=function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})},e}(),It=function(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},Ot=function(){function e(e){this.factories=e}return e.create=function(t,n){if(null!=n){var r=n.factories.slice();return new e(t=t.concat(r))}return new e(t)},e.extend=function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new v,new _]]}},e.prototype.find=function(e){var t,n=this.factories.find(function(t){return t.supports(e)});if(null!=n)return n;throw new Error("Cannot find a differ supporting object '"+e+"' of type '"+((t=e).name||typeof t)+"'")},e}(),Rt=function(){function e(e){this.factories=e}return e.create=function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)},e.extend=function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new v,new _]]}},e.prototype.find=function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '"+e+"'")},e}(),Nt=[new Dt],Lt=new Ot([new bt]),Ft=new Rt(Nt),Bt=Ye(null,"core",[{provide:se,useValue:"unknown"},{provide:Ze,deps:[I]},{provide:Be,deps:[]},{provide:ue,deps:[]}]),kt=new l("LocaleId");function Vt(){return Lt}function zt(){return Ft}function Ut(e){return e||"en-US"}var Gt=function(e){},Wt=function(){var e={NONE:0,HTML:1,STYLE:2,SCRIPT:3,URL:4,RESOURCE_URL:5};return e[e.NONE]="NONE",e[e.HTML]="HTML",e[e.STYLE]="STYLE",e[e.SCRIPT]="SCRIPT",e[e.URL]="URL",e[e.RESOURCE_URL]="RESOURCE_URL",e}(),Ht=function(){};function jt(e,t,n){var r=e.state,i=1792&r;return i===t?(e.state=-1793&r|n,e.initIndex=-1,!0):i===n}function qt(e,t,n){return(1792&e.state)===t&&e.initIndex<=n&&(e.initIndex=n+1,!0)}function Yt(e,t){return e.nodes[t]}function Xt(e,t){return e.nodes[t]}function Zt(e,t){return e.nodes[t]}function Kt(e,t){return e.nodes[t]}function Qt(e,t){return e.nodes[t]}var Jt={setCurrentNode:void 0,createRootView:void 0,createEmbeddedView:void 0,createComponentView:void 0,createNgModuleRef:void 0,overrideProvider:void 0,overrideComponentView:void 0,clearOverrides:void 0,checkAndUpdateView:void 0,checkNoChangesView:void 0,destroyView:void 0,resolveDep:void 0,createDebugContext:void 0,handleEvent:void 0,updateDirectives:void 0,updateRenderer:void 0,dirtyParentQueries:void 0};function $t(e,t,n,r){var i,o,a="ExpressionChangedAfterItHasBeenCheckedError: Expression has changed after it was checked. Previous value: '"+t+"'. Current value: '"+n+"'.";return r&&(a+=" It seems like the view has been created after its parent and its children have been dirty checked. Has it been created in a change detection hook ?"),i=e,en(o=new Error(a),i),o}function en(e,t){e[q]=t,e[X]=t.logError.bind(t)}function tn(e){return new Error("ViewDestroyedError: Attempt to use a destroyed view: "+e)}var nn=function(){},rn=new Map;function on(e){var t=rn.get(e);return t||(t=T(e)+"_"+rn.size,rn.set(e,t)),t}function an(e,t,n,r){if(r instanceof vt){r=r.wrapped;var i=e.def.nodes[t].bindingIndex+n,o=e.oldValues[i];o instanceof vt&&(o=o.wrapped),e.oldValues[i]=new vt(o)}return r}var sn="$$undefined",ln="$$empty";function un(e){return{id:sn,styles:e.styles,encapsulation:e.encapsulation,data:e.data}}var cn=0;function hn(e,t,n,r){return!(!(2&e.state)&&x(e.oldValues[t.bindingIndex+n],r))}function dn(e,t,n,r){return!!hn(e,t,n,r)&&(e.oldValues[t.bindingIndex+n]=r,!0)}function pn(e,t,n,r){var i=e.oldValues[t.bindingIndex+n];if(1&e.state||!gt(i,r))throw $t(Jt.createDebugContext(e,t.nodeIndex),i,r,0!=(1&e.state))}function fn(e){for(var t=e;t;)2&t.def.flags&&(t.state|=8),t=t.viewContainerParent||t.parent}function mn(e,t){for(var n=e;n&&n!==t;)n.state|=64,n=n.viewContainerParent||n.parent}function _n(e,t,n,r){try{return fn(33554432&e.def.nodes[t].flags?Xt(e,t).componentView:e),Jt.handleEvent(e,t,n,r)}catch(t){e.root.errorHandler.handleError(t)}}function gn(e){return e.parent?Xt(e.parent,e.parentNodeDef.nodeIndex):null}function vn(e){return e.parent?e.parentNodeDef.parent:null}function yn(e,t){switch(201347067&t.flags){case 1:return Xt(e,t.nodeIndex).renderElement;case 2:return Yt(e,t.nodeIndex).renderText}}function Cn(e){return!!e.parent&&!!(32768&e.parentNodeDef.flags)}function wn(e){return 1<<e%32}function bn(e){var t={},n=0,r={};return e&&e.forEach(function(e){var i=e[0],o=e[1];"number"==typeof i?(t[i]=o,n|=wn(i)):r[i]=o}),{matchedQueries:t,references:r,matchedQueryIds:n}}function En(e){return e.map(function(e){var t,n;return Array.isArray(e)?(n=e[0],t=e[1]):(n=0,t=e),{flags:n,token:t,tokenKey:on(t)}})}function Sn(e,t,n){var r=n.renderParent;return r?0==(1&r.flags)||0==(33554432&r.flags)||r.element.componentRendererType&&r.element.componentRendererType.encapsulation===d.Native?Xt(e,n.renderParent.nodeIndex).renderElement:void 0:t}var xn=new WeakMap;function Tn(e){var t=xn.get(e);return t||((t=e(function(){return nn})).factory=e,xn.set(e,t)),t}function An(e,t,n,r,i){3===t&&(n=e.renderer.parentNode(yn(e,e.def.lastRenderRootNode))),Pn(e,t,0,e.def.nodes.length-1,n,r,i)}function Pn(e,t,n,r,i,o,a){for(var s=n;s<=r;s++){var l=e.def.nodes[s];11&l.flags&&Mn(e,l,t,i,o,a),s+=l.childCount}}function Dn(e,t,n,r,i,o){for(var a=e;a&&!Cn(a);)a=a.parent;for(var s=a.parent,l=vn(a),u=l.nodeIndex+l.childCount,c=l.nodeIndex+1;c<=u;c++){var h=s.def.nodes[c];h.ngContentIndex===t&&Mn(s,h,n,r,i,o),c+=h.childCount}if(!s.parent){var d=e.root.projectableNodes[t];if(d)for(c=0;c<d.length;c++)In(e,d[c],n,r,i,o)}}function Mn(e,t,n,r,i,o){if(8&t.flags)Dn(e,t.ngContent.index,n,r,i,o);else{var a=yn(e,t);if(3===n&&33554432&t.flags&&48&t.bindingFlags?(16&t.bindingFlags&&In(e,a,n,r,i,o),32&t.bindingFlags&&In(Xt(e,t.nodeIndex).componentView,a,n,r,i,o)):In(e,a,n,r,i,o),16777216&t.flags)for(var s=Xt(e,t.nodeIndex).viewContainer._embeddedViews,l=0;l<s.length;l++)An(s[l],n,r,i,o);1&t.flags&&!t.element.name&&Pn(e,n,t.nodeIndex+1,t.nodeIndex+t.childCount,r,i,o)}}function In(e,t,n,r,i,o){var a=e.renderer;switch(n){case 1:a.appendChild(r,t);break;case 2:a.insertBefore(r,t,i);break;case 3:a.removeChild(r,t);break;case 0:o.push(t)}}var On=/^:([^:]+):(.+)$/;function Rn(e){if(":"===e[0]){var t=e.match(On);return[t[1],t[2]]}return["",e]}function Nn(e){for(var t=0,n=0;n<e.length;n++)t|=e[n].flags;return t}function Ln(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y){switch(e){case 1:return t+Fn(n)+r;case 2:return t+Fn(n)+r+Fn(i)+o;case 3:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s;case 4:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u;case 5:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u+Fn(c)+h;case 6:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u+Fn(c)+h+Fn(d)+p;case 7:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u+Fn(c)+h+Fn(d)+p+Fn(f)+m;case 8:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u+Fn(c)+h+Fn(d)+p+Fn(f)+m+Fn(_)+g;case 9:return t+Fn(n)+r+Fn(i)+o+Fn(a)+s+Fn(l)+u+Fn(c)+h+Fn(d)+p+Fn(f)+m+Fn(_)+g+Fn(v)+y;default:throw new Error("Does not support more than 9 expressions")}}function Fn(e){return null!=e?e.toString():""}function Bn(e,t,n,r,i,o){e|=1;var a=bn(t);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,flags:e,checkIndex:-1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:a.matchedQueries,matchedQueryIds:a.matchedQueryIds,references:a.references,ngContentIndex:n,childCount:r,bindings:[],bindingFlags:0,outputs:[],element:{ns:null,name:null,attrs:null,template:o?Tn(o):null,componentProvider:null,componentView:null,componentRendererType:null,publicProviders:null,allProviders:null,handleEvent:i||nn},provider:null,text:null,query:null,ngContent:null}}function kn(e,t,n,r,i,o,a,s,l,u,c,h){void 0===a&&(a=[]),u||(u=nn);var p=bn(n),f=p.matchedQueries,m=p.references,_=p.matchedQueryIds,g=null,v=null;o&&(g=(I=Rn(o))[0],v=I[1]),s=s||[];for(var y=new Array(s.length),C=0;C<s.length;C++){var w=s[C],b=w[0],E=w[2],S=Rn(w[1]),x=S[0],T=S[1],A=void 0,P=void 0;switch(15&b){case 4:P=E;break;case 1:case 8:A=E}y[C]={flags:b,ns:x,name:T,nonMinifiedName:T,securityContext:A,suffix:P}}l=l||[];var D=new Array(l.length);for(C=0;C<l.length;C++){var M=l[C];D[C]={type:0,target:M[0],eventName:M[1],propName:null}}var I,O=(a=a||[]).map(function(e){var t=e[1],n=Rn(e[0]);return[n[0],n[1],t]});return h=function(e){if(e&&e.id===sn){var t=null!=e.encapsulation&&e.encapsulation!==d.None||e.styles.length||Object.keys(e.data).length;e.id=t?"c"+cn++:ln}return e&&e.id===ln&&(e=null),e||null}(h),c&&(t|=33554432),{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t|=1,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:f,matchedQueryIds:_,references:m,ngContentIndex:r,childCount:i,bindings:y,bindingFlags:Nn(y),outputs:D,element:{ns:g,name:v,attrs:O,template:null,componentProvider:null,componentView:c||null,componentRendererType:h,publicProviders:null,allProviders:null,handleEvent:u||nn},provider:null,text:null,query:null,ngContent:null}}function Vn(e,t,n){var r,i=n.element,o=e.root.selectorOrNode,a=e.renderer;if(e.parent||!o){r=i.name?a.createElement(i.name,i.ns):a.createComment("");var s=Sn(e,t,n);s&&a.appendChild(s,r)}else r=a.selectRootElement(o);if(i.attrs)for(var l=0;l<i.attrs.length;l++){var u=i.attrs[l];a.setAttribute(r,u[1],u[2],u[0])}return r}function zn(e,t,n,r){for(var i=0;i<n.outputs.length;i++){var o=n.outputs[i],a=Un(e,n.nodeIndex,(h=o.eventName,(c=o.target)?c+":"+h:h)),s=o.target,l=e;"component"===o.target&&(s=null,l=t);var u=l.renderer.listen(s||r,o.eventName,a);e.disposables[n.outputIndex+i]=u}var c,h}function Un(e,t,n){return function(r){return _n(e,t,n,r)}}function Gn(e,t,n,r){if(!dn(e,t,n,r))return!1;var i,o,a,s,l,u,c,h,d,p=t.bindings[n],f=Xt(e,t.nodeIndex),m=f.renderElement,_=p.name;switch(15&p.flags){case 1:!function(e,t,n,r,i,o){var a=p.securityContext,s=a?e.root.sanitizer.sanitize(a,o):o;s=null!=s?s.toString():null;var l=e.renderer;null!=o?l.setAttribute(n,i,s,r):l.removeAttribute(n,i,r)}(e,0,m,p.ns,_,r);break;case 2:c=m,h=_,d=e.renderer,r?d.addClass(c,h):d.removeClass(c,h);break;case 4:!function(e,t,n,i,o){var a=e.root.sanitizer.sanitize(Wt.STYLE,r);if(null!=a){a=a.toString();var s=t.suffix;null!=s&&(a+=s)}else a=null;var l=e.renderer;null!=a?l.setStyle(n,i,a):l.removeStyle(n,i)}(e,p,m,_);break;case 8:i=33554432&t.flags&&32&p.flags?f.componentView:e,o=m,a=_,s=r,u=(l=p.securityContext)?i.root.sanitizer.sanitize(l,s):s,i.renderer.setProperty(o,a,u)}return!0}var Wn=new Object,Hn=on(I),jn=on(be);function qn(e,t,n,r){return n=P(n),{index:-1,deps:En(r),flags:e,token:t,value:n}}function Yn(e){for(var t={},n=0;n<e.length;n++){var r=e[n];r.index=n,t[on(r.token)]=r}return{factory:null,providersByKey:t,providers:e}}function Xn(e,t,n){if(void 0===n&&(n=I.THROW_IF_NOT_FOUND),8&t.flags)return t.token;if(2&t.flags&&(n=null),1&t.flags)return e._parent.get(t.token,n);var r=t.tokenKey;switch(r){case Hn:case jn:return e}var i=e._def.providersByKey[r];if(i){var o=e._providers[i.index];return void 0===o&&(o=e._providers[i.index]=Zn(e,i)),o===Wn?void 0:o}return e._parent.get(t.token,n)}function Zn(e,t){var n;switch(201347067&t.flags){case 512:n=function(e,t,n){var r=n.length;switch(r){case 0:return new t;case 1:return new t(Xn(e,n[0]));case 2:return new t(Xn(e,n[0]),Xn(e,n[1]));case 3:return new t(Xn(e,n[0]),Xn(e,n[1]),Xn(e,n[2]));default:for(var i=new Array(r),o=0;o<r;o++)i[o]=Xn(e,n[o]);return new(t.bind.apply(t,[void 0].concat(i)))}}(e,t.value,t.deps);break;case 1024:n=function(e,t,n){var r=n.length;switch(r){case 0:return t();case 1:return t(Xn(e,n[0]));case 2:return t(Xn(e,n[0]),Xn(e,n[1]));case 3:return t(Xn(e,n[0]),Xn(e,n[1]),Xn(e,n[2]));default:for(var i=Array(r),o=0;o<r;o++)i[o]=Xn(e,n[o]);return t.apply(void 0,i)}}(e,t.value,t.deps);break;case 2048:n=Xn(e,t.deps[0]);break;case 256:n=t.value}return void 0===n?Wn:n}function Kn(e,t){var n=e.viewContainer._embeddedViews;if((null==t||t>=n.length)&&(t=n.length-1),t<0)return null;var r=n[t];return r.viewContainerParent=null,er(n,t),Jt.dirtyParentQueries(r),Jn(r),r}function Qn(e,t,n){var r=t?yn(t,t.def.lastRenderRootNode):e.renderElement;An(n,2,n.renderer.parentNode(r),n.renderer.nextSibling(r),void 0)}function Jn(e){An(e,3,null,null,void 0)}function $n(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function er(e,t){t>=e.length-1?e.pop():e.splice(t,1)}var tr=new Object;function nr(e,t,n,r,i,o){return new rr(e,t,n,r,i,o)}var rr=function(e){function t(t,n,r,i,o,a){var s=e.call(this)||this;return s.selector=t,s.componentType=n,s._inputs=i,s._outputs=o,s.ngContentSelectors=a,s.viewDefFactory=r,s}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"inputs",{get:function(){var e=[],t=this._inputs;for(var n in t)e.push({propName:n,templateName:t[n]});return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outputs",{get:function(){var e=[];for(var t in this._outputs)e.push({propName:t,templateName:this._outputs[t]});return e},enumerable:!0,configurable:!0}),t.prototype.create=function(e,t,n,r){if(!r)throw new Error("ngModule should be provided");var i=Tn(this.viewDefFactory),o=i.nodes[0].element.componentProvider.nodeIndex,a=Jt.createRootView(e,t||[],n,i,r,tr),s=Zt(a,o).instance;return n&&a.renderer.setAttribute(Xt(a,0).renderElement,"ng-version",f.full),new ir(a,new ar(a),s)},t}(pe),ir=function(e){function t(t,n,r){var i=e.call(this)||this;return i._view=t,i._viewRef=n,i._component=r,i._elDef=i._view.def.nodes[0],i.hostView=n,i.changeDetectorRef=n,i.instance=r,i}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"location",{get:function(){return new nt(Xt(this._view,this._elDef.nodeIndex).renderElement)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"injector",{get:function(){return new ur(this._view,this._elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"componentType",{get:function(){return this._component.constructor},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this._viewRef.destroy()},t.prototype.onDestroy=function(e){this._viewRef.onDestroy(e)},t}(function(){}),or=function(){function e(e,t,n){this._view=e,this._elDef=t,this._data=n,this._embeddedViews=[]}return Object.defineProperty(e.prototype,"element",{get:function(){return new nt(this._data.renderElement)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"injector",{get:function(){return new ur(this._view,this._elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentInjector",{get:function(){for(var e=this._view,t=this._elDef.parent;!t&&e;)t=vn(e),e=e.parent;return e?new ur(e,t):new ur(this._view,null)},enumerable:!0,configurable:!0}),e.prototype.clear=function(){for(var e=this._embeddedViews.length-1;e>=0;e--){var t=Kn(this._data,e);Jt.destroyView(t)}},e.prototype.get=function(e){var t=this._embeddedViews[e];if(t){var n=new ar(t);return n.attachToViewContainerRef(this),n}return null},Object.defineProperty(e.prototype,"length",{get:function(){return this._embeddedViews.length},enumerable:!0,configurable:!0}),e.prototype.createEmbeddedView=function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r},e.prototype.createComponent=function(e,t,n,r,i){var o=n||this.parentInjector;i||e instanceof we||(i=o.get(be));var a=e.create(o,r,void 0,i);return this.insert(a.hostView,t),a},e.prototype.insert=function(e,t){if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");var n,r,i,o,a=e;return i=a._view,o=(n=this._data).viewContainer._embeddedViews,null!==(r=t)&&void 0!==r||(r=o.length),i.viewContainerParent=this._view,$n(o,r,i),function(e,t){var n=gn(t);if(n&&n!==e&&!(16&t.state)){t.state|=16;var r=n.template._projectedViews;r||(r=n.template._projectedViews=[]),r.push(t),function(e,n){if(!(4&n.flags)){t.parent.def.nodeFlags|=4,n.flags|=4;for(var r=n.parent;r;)r.childFlags|=4,r=r.parent}}(0,t.parentNodeDef)}}(n,i),Jt.dirtyParentQueries(i),Qn(n,r>0?o[r-1]:null,i),a.attachToViewContainerRef(this),e},e.prototype.move=function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");var n,r,i,o,a,s=this._embeddedViews.indexOf(e._view);return i=t,a=(o=(n=this._data).viewContainer._embeddedViews)[r=s],er(o,r),null==i&&(i=o.length),$n(o,i,a),Jt.dirtyParentQueries(a),Jn(a),Qn(n,i>0?o[i-1]:null,a),e},e.prototype.indexOf=function(e){return this._embeddedViews.indexOf(e._view)},e.prototype.remove=function(e){var t=Kn(this._data,e);t&&Jt.destroyView(t)},e.prototype.detach=function(e){var t=Kn(this._data,e);return t?new ar(t):null},e}(),ar=function(){function e(e){this._view=e,this._viewContainerRef=null,this._appRef=null}return Object.defineProperty(e.prototype,"rootNodes",{get:function(){return An(this._view,0,void 0,void 0,e=[]),e;var e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._view.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"destroyed",{get:function(){return 0!=(128&this._view.state)},enumerable:!0,configurable:!0}),e.prototype.markForCheck=function(){fn(this._view)},e.prototype.detach=function(){this._view.state&=-5},e.prototype.detectChanges=function(){var e=this._view.root.rendererFactory;e.begin&&e.begin();try{Jt.checkAndUpdateView(this._view)}finally{e.end&&e.end()}},e.prototype.checkNoChanges=function(){Jt.checkNoChangesView(this._view)},e.prototype.reattach=function(){this._view.state|=4},e.prototype.onDestroy=function(e){this._view.disposables||(this._view.disposables=[]),this._view.disposables.push(e)},e.prototype.destroy=function(){this._appRef?this._appRef.detachView(this):this._viewContainerRef&&this._viewContainerRef.detach(this._viewContainerRef.indexOf(this)),Jt.destroyView(this._view)},e.prototype.detachFromAppRef=function(){this._appRef=null,Jn(this._view),Jt.dirtyParentQueries(this._view)},e.prototype.attachToAppRef=function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e},e.prototype.attachToViewContainerRef=function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e},e}(),sr=function(e){function t(t,n){var r=e.call(this)||this;return r._parentView=t,r._def=n,r}return Object(r.c)(t,e),t.prototype.createEmbeddedView=function(e){return new ar(Jt.createEmbeddedView(this._parentView,this._def,this._def.element.template,e))},Object.defineProperty(t.prototype,"elementRef",{get:function(){return new nt(Xt(this._parentView,this._def.nodeIndex).renderElement)},enumerable:!0,configurable:!0}),t}(ut);function lr(e,t){return new ur(e,t)}var ur=function(){function e(e,t){this.view=e,this.elDef=t}return e.prototype.get=function(e,t){return void 0===t&&(t=I.THROW_IF_NOT_FOUND),Jt.resolveDep(this.view,this.elDef,!!this.elDef&&0!=(33554432&this.elDef.flags),{flags:0,token:e,tokenKey:on(e)},t)},e}();function cr(e,t){var n=e.def.nodes[t];if(1&n.flags){var r=Xt(e,n.nodeIndex);return n.element.template?r.template:r.renderElement}if(2&n.flags)return Yt(e,n.nodeIndex).renderText;if(20240&n.flags)return Zt(e,n.nodeIndex).instance;throw new Error("Illegal state: read nodeValue for node index "+t)}var hr=function(){function e(e){this.delegate=e}return e.prototype.selectRootElement=function(e){return this.delegate.selectRootElement(e)},e.prototype.createElement=function(e,t){var n=Rn(t),r=this.delegate.createElement(n[1],n[0]);return e&&this.delegate.appendChild(e,r),r},e.prototype.createViewRoot=function(e){return e},e.prototype.createTemplateAnchor=function(e){var t=this.delegate.createComment("");return e&&this.delegate.appendChild(e,t),t},e.prototype.createText=function(e,t){var n=this.delegate.createText(t);return e&&this.delegate.appendChild(e,n),n},e.prototype.projectNodes=function(e,t){for(var n=0;n<t.length;n++)this.delegate.appendChild(e,t[n])},e.prototype.attachViewAfter=function(e,t){for(var n=this.delegate.parentNode(e),r=this.delegate.nextSibling(e),i=0;i<t.length;i++)this.delegate.insertBefore(n,t[i],r)},e.prototype.detachView=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.delegate.parentNode(n);this.delegate.removeChild(r,n)}},e.prototype.destroyView=function(e,t){for(var n=0;n<t.length;n++)this.delegate.destroyNode(t[n])},e.prototype.listen=function(e,t,n){return this.delegate.listen(e,t,n)},e.prototype.listenGlobal=function(e,t,n){return this.delegate.listen(e,t,n)},e.prototype.setElementProperty=function(e,t,n){this.delegate.setProperty(e,t,n)},e.prototype.setElementAttribute=function(e,t,n){var r=Rn(t),i=r[0],o=r[1];null!=n?this.delegate.setAttribute(e,o,n,i):this.delegate.removeAttribute(e,o,i)},e.prototype.setBindingDebugInfo=function(e,t,n){},e.prototype.setElementClass=function(e,t,n){n?this.delegate.addClass(e,t):this.delegate.removeClass(e,t)},e.prototype.setElementStyle=function(e,t,n){null!=n?this.delegate.setStyle(e,t,n):this.delegate.removeStyle(e,t)},e.prototype.invokeElementMethod=function(e,t,n){e[t].apply(e,n)},e.prototype.setText=function(e,t){this.delegate.setValue(e,t)},e.prototype.animate=function(){throw new Error("Renderer.animate is no longer supported!")},e}();function dr(e,t,n,r){return new pr(e,t,n,r)}var pr=function(){function e(e,t,n,r){this._moduleType=e,this._parent=t,this._bootstrapComponents=n,this._def=r,this._destroyListeners=[],this._destroyed=!1,function(e){for(var t=e._def,n=e._providers=new Array(t.providers.length),r=0;r<t.providers.length;r++){var i=t.providers[r];4096&i.flags||(n[r]=Zn(e,i))}}(this)}return e.prototype.get=function(e,t){return void 0===t&&(t=I.THROW_IF_NOT_FOUND),Xn(this,{token:e,tokenKey:on(e),flags:0},t)},Object.defineProperty(e.prototype,"instance",{get:function(){return this.get(this._moduleType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentFactoryResolver",{get:function(){return this.get(ye)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"injector",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(this._destroyed)throw new Error("The ng module "+T(this.instance.constructor)+" has already been destroyed.");this._destroyed=!0,function(e,t){for(var n=e._def,r=0;r<n.providers.length;r++)if(131072&n.providers[r].flags){var i=e._providers[r];i&&i!==Wn&&i.ngOnDestroy()}}(this),this._destroyListeners.forEach(function(e){return e()})},e.prototype.onDestroy=function(e){this._destroyListeners.push(e)},e}(),fr=on(function(){}),mr=on(tt),_r=on(nt),gr=on(ct),vr=on(ut),yr=on(ht),Cr=on(I);function wr(e,t,n,r,i,o,a,s){var l=[];if(a)for(var u in a){var c=a[u];l[c[0]]={flags:8,name:u,nonMinifiedName:c[1],ns:null,securityContext:null,suffix:null}}var h=[];if(s)for(var d in s)h.push({type:1,propName:d,target:null,eventName:s[d]});return Sr(e,t|=16384,n,r,i,i,o,l,h)}function br(e,t,n){return Sr(-1,e|=16,null,0,t,t,n)}function Er(e,t,n,r,i){return Sr(-1,e,t,0,n,r,i)}function Sr(e,t,n,r,i,o,a,s,l){var u=bn(n),c=u.matchedQueries,h=u.references,d=u.matchedQueryIds;l||(l=[]),s||(s=[]),o=P(o);var p=En(a);return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:t,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:c,matchedQueryIds:d,references:h,ngContentIndex:-1,childCount:r,bindings:s,bindingFlags:Nn(s),outputs:l,element:null,provider:{token:i,value:o,deps:p},text:null,query:null,ngContent:null}}function xr(e,t){for(var n=e;n.parent&&!Cn(n);)n=n.parent;return Dr(n.parent,vn(n),!0,t.provider.value,t.provider.deps)}function Tr(e,t){var n=Dr(e,t.parent,(32768&t.flags)>0,t.provider.value,t.provider.deps);if(t.outputs.length)for(var r=0;r<t.outputs.length;r++){var i=t.outputs[r],o=n[i.propName].subscribe(Ar(e,t.parent.nodeIndex,i.eventName));e.disposables[t.outputIndex+r]=o.unsubscribe.bind(o)}return n}function Ar(e,t,n){return function(r){return _n(e,t,n,r)}}function Pr(e,t){var n=(8192&t.flags)>0,r=t.provider;switch(201347067&t.flags){case 512:return Dr(e,t.parent,n,r.value,r.deps);case 1024:return function(e,t,n,r,i){var o=i.length;switch(o){case 0:return r();case 1:return r(Ir(e,t,n,i[0]));case 2:return r(Ir(e,t,n,i[0]),Ir(e,t,n,i[1]));case 3:return r(Ir(e,t,n,i[0]),Ir(e,t,n,i[1]),Ir(e,t,n,i[2]));default:for(var a=Array(o),s=0;s<o;s++)a[s]=Ir(e,t,n,i[s]);return r.apply(void 0,a)}}(e,t.parent,n,r.value,r.deps);case 2048:return Ir(e,t.parent,n,r.deps[0]);case 256:return r.value}}function Dr(e,t,n,r,i){var o=i.length;switch(o){case 0:return new r;case 1:return new r(Ir(e,t,n,i[0]));case 2:return new r(Ir(e,t,n,i[0]),Ir(e,t,n,i[1]));case 3:return new r(Ir(e,t,n,i[0]),Ir(e,t,n,i[1]),Ir(e,t,n,i[2]));default:for(var a=new Array(o),s=0;s<o;s++)a[s]=Ir(e,t,n,i[s]);return new(r.bind.apply(r,[void 0].concat(a)))}}var Mr={};function Ir(e,t,n,r,i){if(void 0===i&&(i=I.THROW_IF_NOT_FOUND),8&r.flags)return r.token;var o=e;2&r.flags&&(i=null);var a=r.tokenKey;for(a===yr&&(n=!(!t||!t.element.componentView)),t&&1&r.flags&&(n=!1,t=t.parent);e;){if(t)switch(a){case fr:var s=Or(e,t,n);return new hr(s.renderer);case mr:return(s=Or(e,t,n)).renderer;case _r:return new nt(Xt(e,t.nodeIndex).renderElement);case gr:return Xt(e,t.nodeIndex).viewContainer;case vr:if(t.element.template)return Xt(e,t.nodeIndex).template;break;case yr:var l=Or(e,t,n);return new ar(l);case Cr:return lr(e,t);default:var u=(n?t.element.allProviders:t.element.publicProviders)[a];if(u){var c=Zt(e,u.nodeIndex);return c||(c={instance:Pr(e,u)},e.nodes[u.nodeIndex]=c),c.instance}}n=Cn(e),t=vn(e),e=e.parent}var h=o.root.injector.get(r.token,Mr);return h!==Mr||i===Mr?h:o.root.ngModule.injector.get(r.token,i)}function Or(e,t,n){var r;if(n)r=Xt(e,t.nodeIndex).componentView;else for(r=e;r.parent&&!Cn(r);)r=r.parent;return r}function Rr(e,t,n,r,i,o){if(32768&n.flags){var a=Xt(e,n.parent.nodeIndex).componentView;2&a.def.flags&&(a.state|=8)}if(t.instance[n.bindings[r].name]=i,524288&n.flags){o=o||{};var s=e.oldValues[n.bindingIndex+r];s instanceof vt&&(s=s.wrapped),o[n.bindings[r].nonMinifiedName]=new yt(s,i,0!=(2&e.state))}return e.oldValues[n.bindingIndex+r]=i,o}function Nr(e,t){if(e.def.nodeFlags&t)for(var n=e.def.nodes,r=0,i=0;i<n.length;i++){var o=n[i],a=o.parent;for(!a&&o.flags&t&&Fr(e,i,o.flags&t,r++),0==(o.childFlags&t)&&(i+=o.childCount);a&&1&a.flags&&i===a.nodeIndex+a.childCount;)a.directChildFlags&t&&(r=Lr(e,a,t,r)),a=a.parent}}function Lr(e,t,n,r){for(var i=t.nodeIndex+1;i<=t.nodeIndex+t.childCount;i++){var o=e.def.nodes[i];o.flags&n&&Fr(e,i,o.flags&n,r++),i+=o.childCount}return r}function Fr(e,t,n,r){var i=Zt(e,t);if(i){var o=i.instance;o&&(Jt.setCurrentNode(e,t),1048576&n&&qt(e,512,r)&&o.ngAfterContentInit(),2097152&n&&o.ngAfterContentChecked(),4194304&n&&qt(e,768,r)&&o.ngAfterViewInit(),8388608&n&&o.ngAfterViewChecked(),131072&n&&o.ngOnDestroy())}}function Br(e,t,n){var r=[];for(var i in n)r.push({propName:i,bindingType:n[i]});return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:-1,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,ngContentIndex:-1,matchedQueries:{},matchedQueryIds:0,references:{},childCount:0,bindings:[],bindingFlags:0,outputs:[],element:null,provider:null,text:null,query:{id:t,filterId:wn(t),bindings:r},ngContent:null}}function kr(e){for(var t,n=e.def.nodeMatchedQueries;e.parent&&(t=e).parent&&!(32768&t.parentNodeDef.flags);){var r=e.parentNodeDef;e=e.parent;for(var i=r.nodeIndex+r.childCount,o=0;o<=i;o++)67108864&(a=e.def.nodes[o]).flags&&536870912&a.flags&&(a.query.filterId&n)===a.query.filterId&&Qt(e,o).setDirty(),!(1&a.flags&&o+a.childCount<r.nodeIndex)&&67108864&a.childFlags&&536870912&a.childFlags||(o+=a.childCount)}if(134217728&e.def.nodeFlags)for(o=0;o<e.def.nodes.length;o++){var a;134217728&(a=e.def.nodes[o]).flags&&536870912&a.flags&&Qt(e,o).setDirty(),o+=a.childCount}}function Vr(e,t){var n=Qt(e,t.nodeIndex);if(n.dirty){var r,i=void 0;if(67108864&t.flags){var o=t.parent.parent;i=zr(e,o.nodeIndex,o.nodeIndex+o.childCount,t.query,[]),r=Zt(e,t.parent.nodeIndex).instance}else 134217728&t.flags&&(i=zr(e,0,e.def.nodes.length-1,t.query,[]),r=e.component);n.reset(i);for(var a=t.query.bindings,s=!1,l=0;l<a.length;l++){var u=a[l],c=void 0;switch(u.bindingType){case 0:c=n.first;break;case 1:c=n,s=!0}r[u.propName]=c}s&&n.notifyOnChanges()}}function zr(e,t,n,r,i){for(var o=t;o<=n;o++){var a=e.def.nodes[o],s=a.matchedQueries[r.id];if(null!=s&&i.push(Ur(e,a,s)),1&a.flags&&a.element.template&&(a.element.template.nodeMatchedQueries&r.filterId)===r.filterId){var l=Xt(e,o);if((a.childMatchedQueries&r.filterId)===r.filterId&&(zr(e,o+1,o+a.childCount,r,i),o+=a.childCount),16777216&a.flags)for(var u=l.viewContainer._embeddedViews,c=0;c<u.length;c++){var h=u[c],d=gn(h);d&&d===l&&zr(h,0,h.def.nodes.length-1,r,i)}var p=l.template._projectedViews;if(p)for(c=0;c<p.length;c++){var f=p[c];zr(f,0,f.def.nodes.length-1,r,i)}}(a.childMatchedQueries&r.filterId)!==r.filterId&&(o+=a.childCount)}return i}function Ur(e,t,n){if(null!=n)switch(n){case 1:return Xt(e,t.nodeIndex).renderElement;case 0:return new nt(Xt(e,t.nodeIndex).renderElement);case 2:return Xt(e,t.nodeIndex).template;case 3:return Xt(e,t.nodeIndex).viewContainer;case 4:return Zt(e,t.nodeIndex).instance}}function Gr(e,t){return Hr(128,e,new Array(t+1))}function Wr(e,t){for(var n=Object.keys(t),r=n.length,i=new Array(r),o=0;o<r;o++){var a=n[o];i[t[a]]=a}return Hr(64,e,i)}function Hr(e,t,n){for(var r=new Array(n.length),i=0;i<n.length;i++){var o=n[i];r[i]={flags:8,name:o,ns:null,nonMinifiedName:o,securityContext:null,suffix:null}}return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:t,flags:e,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:-1,childCount:0,bindings:r,bindingFlags:Nn(r),outputs:[],element:null,provider:null,text:null,query:null,ngContent:null}}function jr(e,t,n){for(var r=new Array(n.length-1),i=1;i<n.length;i++)r[i-1]={flags:8,name:null,ns:null,nonMinifiedName:null,securityContext:null,suffix:n[i]};return{nodeIndex:-1,parent:null,renderParent:null,bindingIndex:-1,outputIndex:-1,checkIndex:e,flags:2,childFlags:0,directChildFlags:0,childMatchedQueries:0,matchedQueries:{},matchedQueryIds:0,references:{},ngContentIndex:t,childCount:0,bindings:r,bindingFlags:8,outputs:[],element:null,provider:null,text:{prefix:n[0]},query:null,ngContent:null}}function qr(e,t,n){var r,i=e.renderer;r=i.createText(n.text.prefix);var o=Sn(e,t,n);return o&&i.appendChild(o,r),{renderText:r}}function Yr(e,t){return(null!=e?e.toString():"")+t.suffix}function Xr(e,t,n,r){for(var i=0,o=0,a=0,s=0,l=0,u=null,c=null,h=!1,d=!1,p=null,f=0;f<t.length;f++){var m=t[f];if(m.nodeIndex=f,m.parent=u,m.bindingIndex=i,m.outputIndex=o,m.renderParent=c,a|=m.flags,l|=m.matchedQueryIds,m.element){var _=m.element;_.publicProviders=u?u.element.publicProviders:Object.create(null),_.allProviders=_.publicProviders,h=!1,d=!1,m.element.template&&(l|=m.element.template.nodeMatchedQueries)}if(Kr(u,m,t.length),i+=m.bindings.length,o+=m.outputs.length,!c&&3&m.flags&&(p=m),20224&m.flags){h||(h=!0,u.element.publicProviders=Object.create(u.element.publicProviders),u.element.allProviders=u.element.publicProviders);var g=0!=(32768&m.flags);0==(8192&m.flags)||g?u.element.publicProviders[on(m.provider.token)]=m:(d||(d=!0,u.element.allProviders=Object.create(u.element.publicProviders)),u.element.allProviders[on(m.provider.token)]=m),g&&(u.element.componentProvider=m)}if(u?(u.childFlags|=m.flags,u.directChildFlags|=m.flags,u.childMatchedQueries|=m.matchedQueryIds,m.element&&m.element.template&&(u.childMatchedQueries|=m.element.template.nodeMatchedQueries)):s|=m.flags,m.childCount>0)u=m,Zr(m)||(c=m);else for(;u&&f===u.nodeIndex+u.childCount;){var v=u.parent;v&&(v.childFlags|=u.childFlags,v.childMatchedQueries|=u.childMatchedQueries),c=(u=v)&&Zr(u)?u.renderParent:u}}return{factory:null,nodeFlags:a,rootNodeFlags:s,nodeMatchedQueries:l,flags:e,nodes:t,updateDirectives:n||nn,updateRenderer:r||nn,handleEvent:function(e,n,r,i){return t[n].element.handleEvent(e,r,i)},bindingCount:i,outputCount:o,lastRenderRootNode:p}}function Zr(e){return 0!=(1&e.flags)&&null===e.element.name}function Kr(e,t,n){var r=t.element&&t.element.template;if(r){if(!r.lastRenderRootNode)throw new Error("Illegal State: Embedded templates without nodes are not allowed!");if(r.lastRenderRootNode&&16777216&r.lastRenderRootNode.flags)throw new Error("Illegal State: Last root node of a template can't have embedded views, at index "+t.nodeIndex+"!")}if(20224&t.flags&&0==(1&(e?e.flags:0)))throw new Error("Illegal State: StaticProvider/Directive nodes need to be children of elements or anchors, at index "+t.nodeIndex+"!");if(t.query){if(67108864&t.flags&&(!e||0==(16384&e.flags)))throw new Error("Illegal State: Content Query nodes need to be children of directives, at index "+t.nodeIndex+"!");if(134217728&t.flags&&e)throw new Error("Illegal State: View Query nodes have to be top level nodes, at index "+t.nodeIndex+"!")}if(t.childCount){var i=e?e.nodeIndex+e.childCount:n-1;if(t.nodeIndex<=i&&t.nodeIndex+t.childCount>i)throw new Error("Illegal State: childCount of node leads outside of parent, at index "+t.nodeIndex+"!")}}function Qr(e,t,n,r){var i=ei(e.root,e.renderer,e,t,n);return ti(i,e.component,r),ni(i),i}function Jr(e,t,n){var r=ei(e,e.renderer,null,null,t);return ti(r,n,n),ni(r),r}function $r(e,t,n,r){var i,o=t.element.componentRendererType;return i=o?e.root.rendererFactory.createRenderer(r,o):e.root.renderer,ei(e.root,i,e,t.element.componentProvider,n)}function ei(e,t,n,r,i){var o=new Array(i.nodes.length),a=i.outputCount?new Array(i.outputCount):null;return{def:i,parent:n,viewContainerParent:null,parentNodeDef:r,context:null,component:null,nodes:o,state:13,root:e,renderer:t,oldValues:new Array(i.bindingCount),disposables:a,initIndex:-1}}function ti(e,t,n){e.component=t,e.context=n}function ni(e){var t;Cn(e)&&(t=Xt(e.parent,e.parentNodeDef.parent.nodeIndex).renderElement);for(var n,r,i,o,a,s=e.def,l=e.nodes,u=0;u<s.nodes.length;u++){var c=s.nodes[u];Jt.setCurrentNode(e,u);var h=void 0;switch(201347067&c.flags){case 1:var d=Vn(e,t,c),p=void 0;if(33554432&c.flags){var f=Tn(c.element.componentView);p=Jt.createComponentView(e,c,f,d)}zn(e,p,c,d),h={renderElement:d,componentView:p,viewContainer:null,template:c.element.template?(o=e,a=c,new sr(o,a)):void 0},16777216&c.flags&&(h.viewContainer=new or(e,c,h));break;case 2:h=qr(e,t,c);break;case 512:case 1024:case 2048:case 256:(h=l[u])||4096&c.flags||(h={instance:Pr(e,c)});break;case 16:h={instance:xr(e,c)};break;case 16384:(h=l[u])||(h={instance:Tr(e,c)}),32768&c.flags&&ti(Xt(e,c.parent.nodeIndex).componentView,h.instance,h.instance);break;case 32:case 64:case 128:h={value:void 0};break;case 67108864:case 134217728:h=new it;break;case 8:(i=Sn(n=e,t,r=c))&&Dn(n,r.ngContent.index,1,i,null,void 0),h=void 0}l[u]=h}hi(e,ci.CreateViewNodes),mi(e,201326592,268435456,0)}function ri(e){ai(e),Jt.updateDirectives(e,1),di(e,ci.CheckNoChanges),Jt.updateRenderer(e,1),hi(e,ci.CheckNoChanges),e.state&=-97}function ii(e){1&e.state?(e.state&=-2,e.state|=2):e.state&=-3,jt(e,0,256),ai(e),Jt.updateDirectives(e,0),di(e,ci.CheckAndUpdate),mi(e,67108864,536870912,0);var t=jt(e,256,512);Nr(e,2097152|(t?1048576:0)),Jt.updateRenderer(e,0),hi(e,ci.CheckAndUpdate),mi(e,134217728,536870912,0),Nr(e,8388608|((t=jt(e,512,768))?4194304:0)),2&e.def.flags&&(e.state&=-9),e.state&=-97,jt(e,768,1024)}function oi(e,t,n,r,i,o,a,s,l,u,c,h,d){return 0===n?function(e,t,n,r,i,o,a,s,l,u,c,h){switch(201347067&t.flags){case 1:return D=e,I=r,O=i,R=o,N=a,L=s,F=l,B=u,k=c,V=h,U=!1,(z=(M=t).bindings.length)>0&&Gn(D,M,0,n)&&(U=!0),z>1&&Gn(D,M,1,I)&&(U=!0),z>2&&Gn(D,M,2,O)&&(U=!0),z>3&&Gn(D,M,3,R)&&(U=!0),z>4&&Gn(D,M,4,N)&&(U=!0),z>5&&Gn(D,M,5,L)&&(U=!0),z>6&&Gn(D,M,6,F)&&(U=!0),z>7&&Gn(D,M,7,B)&&(U=!0),z>8&&Gn(D,M,8,k)&&(U=!0),z>9&&Gn(D,M,9,V)&&(U=!0),U;case 2:return function(e,t,n,r,i,o,a,s,l,u,c,h){var d=!1,p=t.bindings,f=p.length;if(f>0&&dn(e,t,0,n)&&(d=!0),f>1&&dn(e,t,1,r)&&(d=!0),f>2&&dn(e,t,2,i)&&(d=!0),f>3&&dn(e,t,3,o)&&(d=!0),f>4&&dn(e,t,4,a)&&(d=!0),f>5&&dn(e,t,5,s)&&(d=!0),f>6&&dn(e,t,6,l)&&(d=!0),f>7&&dn(e,t,7,u)&&(d=!0),f>8&&dn(e,t,8,c)&&(d=!0),f>9&&dn(e,t,9,h)&&(d=!0),d){var m=t.text.prefix;f>0&&(m+=Yr(n,p[0])),f>1&&(m+=Yr(r,p[1])),f>2&&(m+=Yr(i,p[2])),f>3&&(m+=Yr(o,p[3])),f>4&&(m+=Yr(a,p[4])),f>5&&(m+=Yr(s,p[5])),f>6&&(m+=Yr(l,p[6])),f>7&&(m+=Yr(u,p[7])),f>8&&(m+=Yr(c,p[8])),f>9&&(m+=Yr(h,p[9]));var _=Yt(e,t.nodeIndex).renderText;e.renderer.setValue(_,m)}return d}(e,t,n,r,i,o,a,s,l,u,c,h);case 16384:return f=n,m=r,_=i,g=o,v=a,y=s,C=l,w=u,b=c,E=h,x=(S=Zt(d=e,(p=t).nodeIndex)).instance,T=!1,A=void 0,(P=p.bindings.length)>0&&hn(d,p,0,f)&&(T=!0,A=Rr(d,S,p,0,f,A)),P>1&&hn(d,p,1,m)&&(T=!0,A=Rr(d,S,p,1,m,A)),P>2&&hn(d,p,2,_)&&(T=!0,A=Rr(d,S,p,2,_,A)),P>3&&hn(d,p,3,g)&&(T=!0,A=Rr(d,S,p,3,g,A)),P>4&&hn(d,p,4,v)&&(T=!0,A=Rr(d,S,p,4,v,A)),P>5&&hn(d,p,5,y)&&(T=!0,A=Rr(d,S,p,5,y,A)),P>6&&hn(d,p,6,C)&&(T=!0,A=Rr(d,S,p,6,C,A)),P>7&&hn(d,p,7,w)&&(T=!0,A=Rr(d,S,p,7,w,A)),P>8&&hn(d,p,8,b)&&(T=!0,A=Rr(d,S,p,8,b,A)),P>9&&hn(d,p,9,E)&&(T=!0,A=Rr(d,S,p,9,E,A)),A&&x.ngOnChanges(A),65536&p.flags&&qt(d,256,p.nodeIndex)&&x.ngOnInit(),262144&p.flags&&x.ngDoCheck(),T;case 32:case 64:case 128:return function(e,t,n,r,i,o,a,s,l,u,c,h){var d=t.bindings,p=!1,f=d.length;if(f>0&&dn(e,t,0,n)&&(p=!0),f>1&&dn(e,t,1,r)&&(p=!0),f>2&&dn(e,t,2,i)&&(p=!0),f>3&&dn(e,t,3,o)&&(p=!0),f>4&&dn(e,t,4,a)&&(p=!0),f>5&&dn(e,t,5,s)&&(p=!0),f>6&&dn(e,t,6,l)&&(p=!0),f>7&&dn(e,t,7,u)&&(p=!0),f>8&&dn(e,t,8,c)&&(p=!0),f>9&&dn(e,t,9,h)&&(p=!0),p){var m=Kt(e,t.nodeIndex),_=void 0;switch(201347067&t.flags){case 32:_=new Array(d.length),f>0&&(_[0]=n),f>1&&(_[1]=r),f>2&&(_[2]=i),f>3&&(_[3]=o),f>4&&(_[4]=a),f>5&&(_[5]=s),f>6&&(_[6]=l),f>7&&(_[7]=u),f>8&&(_[8]=c),f>9&&(_[9]=h);break;case 64:_={},f>0&&(_[d[0].name]=n),f>1&&(_[d[1].name]=r),f>2&&(_[d[2].name]=i),f>3&&(_[d[3].name]=o),f>4&&(_[d[4].name]=a),f>5&&(_[d[5].name]=s),f>6&&(_[d[6].name]=l),f>7&&(_[d[7].name]=u),f>8&&(_[d[8].name]=c),f>9&&(_[d[9].name]=h);break;case 128:var g=n;switch(f){case 1:_=g.transform(n);break;case 2:_=g.transform(r);break;case 3:_=g.transform(r,i);break;case 4:_=g.transform(r,i,o);break;case 5:_=g.transform(r,i,o,a);break;case 6:_=g.transform(r,i,o,a,s);break;case 7:_=g.transform(r,i,o,a,s,l);break;case 8:_=g.transform(r,i,o,a,s,l,u);break;case 9:_=g.transform(r,i,o,a,s,l,u,c);break;case 10:_=g.transform(r,i,o,a,s,l,u,c,h)}}m.value=_}return p}(e,t,n,r,i,o,a,s,l,u,c,h);default:throw"unreachable"}var d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U}(e,t,r,i,o,a,s,l,u,c,h,d):function(e,t,n){switch(201347067&t.flags){case 1:return function(e,t,n){for(var r=!1,i=0;i<n.length;i++)Gn(e,t,i,n[i])&&(r=!0);return r}(e,t,n);case 2:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)dn(e,t,o,n[o])&&(i=!0);if(i){var a="";for(o=0;o<n.length;o++)a+=Yr(n[o],r[o]);a=t.text.prefix+a;var s=Yt(e,t.nodeIndex).renderText;e.renderer.setValue(s,a)}return i}(e,t,n);case 16384:return function(e,t,n){for(var r=Zt(e,t.nodeIndex),i=r.instance,o=!1,a=void 0,s=0;s<n.length;s++)hn(e,t,s,n[s])&&(o=!0,a=Rr(e,r,t,s,n[s],a));return a&&i.ngOnChanges(a),65536&t.flags&&qt(e,256,t.nodeIndex)&&i.ngOnInit(),262144&t.flags&&i.ngDoCheck(),o}(e,t,n);case 32:case 64:case 128:return function(e,t,n){for(var r=t.bindings,i=!1,o=0;o<n.length;o++)dn(e,t,o,n[o])&&(i=!0);if(i){var a=Kt(e,t.nodeIndex),s=void 0;switch(201347067&t.flags){case 32:s=n;break;case 64:for(s={},o=0;o<n.length;o++)s[r[o].name]=n[o];break;case 128:var l=n[0],u=n.slice(1);s=l.transform.apply(l,u)}a.value=s}return i}(e,t,n);default:throw"unreachable"}}(e,t,r)}function ai(e){var t=e.def;if(4&t.nodeFlags)for(var n=0;n<t.nodes.length;n++){var r=t.nodes[n];if(4&r.flags){var i=Xt(e,n).template._projectedViews;if(i)for(var o=0;o<i.length;o++){var a=i[o];a.state|=32,mn(a,e)}}else 0==(4&r.childFlags)&&(n+=r.childCount)}}function si(e,t,n,r,i,o,a,s,l,u,c,h,d){return 0===n?(p=e,m=i,_=o,g=a,v=s,y=l,C=u,w=c,b=h,E=d,(S=(f=t).bindings.length)>0&&pn(p,f,0,r),S>1&&pn(p,f,1,m),S>2&&pn(p,f,2,_),S>3&&pn(p,f,3,g),S>4&&pn(p,f,4,v),S>5&&pn(p,f,5,y),S>6&&pn(p,f,6,C),S>7&&pn(p,f,7,w),S>8&&pn(p,f,8,b),S>9&&pn(p,f,9,E)):function(e,t,n){for(var r=0;r<n.length;r++)pn(e,t,r,n[r])}(e,t,r),!1;var p,f,m,_,g,v,y,C,w,b,E,S}function li(e,t){if(Qt(e,t.nodeIndex).dirty)throw $t(Jt.createDebugContext(e,t.nodeIndex),"Query "+t.query.id+" not dirty","Query "+t.query.id+" dirty",0!=(1&e.state))}function ui(e){if(!(128&e.state)){if(di(e,ci.Destroy),hi(e,ci.Destroy),Nr(e,131072),e.disposables)for(var t=0;t<e.disposables.length;t++)e.disposables[t]();!function(e){if(16&e.state){var t=gn(e);if(t){var n=t.template._projectedViews;n&&(er(n,n.indexOf(e)),Jt.dirtyParentQueries(e))}}}(e),e.renderer.destroyNode&&function(e){for(var t=e.def.nodes.length,n=0;n<t;n++){var r=e.def.nodes[n];1&r.flags?e.renderer.destroyNode(Xt(e,n).renderElement):2&r.flags?e.renderer.destroyNode(Yt(e,n).renderText):(67108864&r.flags||134217728&r.flags)&&Qt(e,n).destroy()}}(e),Cn(e)&&e.renderer.destroy(),e.state|=128}}var ci=function(){var e={CreateViewNodes:0,CheckNoChanges:1,CheckNoChangesProjectedViews:2,CheckAndUpdate:3,CheckAndUpdateProjectedViews:4,Destroy:5};return e[e.CreateViewNodes]="CreateViewNodes",e[e.CheckNoChanges]="CheckNoChanges",e[e.CheckNoChangesProjectedViews]="CheckNoChangesProjectedViews",e[e.CheckAndUpdate]="CheckAndUpdate",e[e.CheckAndUpdateProjectedViews]="CheckAndUpdateProjectedViews",e[e.Destroy]="Destroy",e}();function hi(e,t){var n=e.def;if(33554432&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];33554432&i.flags?pi(Xt(e,r).componentView,t):0==(33554432&i.childFlags)&&(r+=i.childCount)}}function di(e,t){var n=e.def;if(16777216&n.nodeFlags)for(var r=0;r<n.nodes.length;r++){var i=n.nodes[r];if(16777216&i.flags)for(var o=Xt(e,r).viewContainer._embeddedViews,a=0;a<o.length;a++)pi(o[a],t);else 0==(16777216&i.childFlags)&&(r+=i.childCount)}}function pi(e,t){var n=e.state;switch(t){case ci.CheckNoChanges:0==(128&n)&&(12==(12&n)?ri(e):64&n&&fi(e,ci.CheckNoChangesProjectedViews));break;case ci.CheckNoChangesProjectedViews:0==(128&n)&&(32&n?ri(e):64&n&&fi(e,t));break;case ci.CheckAndUpdate:0==(128&n)&&(12==(12&n)?ii(e):64&n&&fi(e,ci.CheckAndUpdateProjectedViews));break;case ci.CheckAndUpdateProjectedViews:0==(128&n)&&(32&n?ii(e):64&n&&fi(e,t));break;case ci.Destroy:ui(e);break;case ci.CreateViewNodes:ni(e)}}function fi(e,t){di(e,t),hi(e,t)}function mi(e,t,n,r){if(e.def.nodeFlags&t&&e.def.nodeFlags&n)for(var i=e.def.nodes.length,o=0;o<i;o++){var a=e.def.nodes[o];if(a.flags&t&&a.flags&n)switch(Jt.setCurrentNode(e,a.nodeIndex),r){case 0:Vr(e,a);break;case 1:li(e,a)}a.childFlags&t&&a.childFlags&n||(o+=a.childCount)}}var _i=!1;function gi(e,t,n,r,i,o){return Jr(yi(e,i,i.injector.get($e),t,n),r,o)}function vi(e,t,n,r,i,o){var a=i.injector.get($e),s=yi(e,i,new Ji(a),t,n),l=Pi(r);return Ki(Bi.create,Jr,null,[s,l,o])}function yi(e,t,n,r,i){var o=t.injector.get(Ht),a=t.injector.get(J);return{ngModule:t,injector:e,projectableNodes:r,selectorOrNode:i,sanitizer:o,rendererFactory:n,renderer:n.createRenderer(null,null),errorHandler:a}}function Ci(e,t,n,r){var i=Pi(n);return Ki(Bi.create,Qr,null,[e,t,i,r])}function wi(e,t,n,r){return n=Si.get(t.element.componentProvider.provider.token)||Pi(n),Ki(Bi.create,$r,null,[e,t,n,r])}function bi(e,t,n,r){return dr(e,t,n,(i=r,o=!1,a=!1,s=0===Ei.size?{hasOverrides:o,hasDeprecatedOverrides:a}:(i.providers.forEach(function(e){var t=Ei.get(e.token);3840&e.flags&&t&&(o=!0,a=a||t.deprecatedBehavior)}),{hasOverrides:o,hasDeprecatedOverrides:a}),l=s.hasDeprecatedOverrides,s.hasOverrides?(function(e){for(var t=0;t<e.providers.length;t++){var n=e.providers[t];l&&(n.flags|=4096);var r=Ei.get(n.token);r&&(n.flags=-3841&n.flags|r.flags,n.deps=En(r.deps),n.value=r.value)}}(i=i.factory(function(){return nn})),i):i));var i,o,a,s,l}var Ei=new Map,Si=new Map;function xi(e){Ei.set(e.token,e)}function Ti(e,t){var n=Tn(Tn(t.viewDefFactory).nodes[0].element.componentView);Si.set(e,n)}function Ai(){Ei.clear(),Si.clear()}function Pi(e){if(0===Ei.size)return e;var t=function(e){for(var t=[],n=null,r=0;r<e.nodes.length;r++){var i=e.nodes[r];1&i.flags&&(n=i),n&&3840&i.flags&&Ei.has(i.provider.token)&&(t.push(n.nodeIndex),n=null)}return t}(e);if(0===t.length)return e;e=e.factory(function(){return nn});for(var n=0;n<t.length;n++)r(e,t[n]);return e;function r(e,t){for(var n=t+1;n<e.nodes.length;n++){var r=e.nodes[n];if(1&r.flags)return;if(3840&r.flags){var i=r.provider,o=Ei.get(i.token);o&&(r.flags=-3841&r.flags|o.flags,i.deps=En(o.deps),i.value=o.value)}}}}function Di(e,t,n,r,i,o,a,s,l,u,c,h,d){var p=e.def.nodes[t];return oi(e,p,n,r,i,o,a,s,l,u,c,h,d),224&p.flags?Kt(e,t).value:void 0}function Mi(e,t,n,r,i,o,a,s,l,u,c,h,d){var p=e.def.nodes[t];return si(e,p,n,r,i,o,a,s,l,u,c,h,d),224&p.flags?Kt(e,t).value:void 0}function Ii(e){return Ki(Bi.detectChanges,ii,null,[e])}function Oi(e){return Ki(Bi.checkNoChanges,ri,null,[e])}function Ri(e){return Ki(Bi.destroy,ui,null,[e])}var Ni,Li,Fi,Bi=function(){var e={create:0,detectChanges:1,checkNoChanges:2,destroy:3,handleEvent:4};return e[e.create]="create",e[e.detectChanges]="detectChanges",e[e.checkNoChanges]="checkNoChanges",e[e.destroy]="destroy",e[e.handleEvent]="handleEvent",e}();function ki(e,t){Li=e,Fi=t}function Vi(e,t,n,r){return ki(e,t),Ki(Bi.handleEvent,e.def.handleEvent,null,[e,t,n,r])}function zi(e,t){if(128&e.state)throw tn(Bi[Ni]);return ki(e,qi(e,0)),e.def.updateDirectives(function(e,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.def.nodes[n];return 0===t?Gi(e,a,r,i):Wi(e,a,r,i),16384&a.flags&&ki(e,qi(e,n)),224&a.flags?Kt(e,a.nodeIndex).value:void 0},e)}function Ui(e,t){if(128&e.state)throw tn(Bi[Ni]);return ki(e,Yi(e,0)),e.def.updateRenderer(function(e,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.def.nodes[n];return 0===t?Gi(e,a,r,i):Wi(e,a,r,i),3&a.flags&&ki(e,Yi(e,n)),224&a.flags?Kt(e,a.nodeIndex).value:void 0},e)}function Gi(e,t,n,r){if(oi.apply(void 0,[e,t,n].concat(r))){var i=1===n?r[0]:r;if(16384&t.flags){for(var o={},a=0;a<t.bindings.length;a++){var s=t.bindings[a],l=i[a];8&s.flags&&(o[(d=s.nonMinifiedName,"ng-reflect-"+(d=d.replace(/[$@]/g,"_").replace(Hi,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"-"+e[1].toLowerCase()})))]=ji(l))}var u=t.parent,c=Xt(e,u.nodeIndex).renderElement;if(u.element.name)for(var h in o)null!=(l=o[h])?e.renderer.setAttribute(c,h,l):e.renderer.removeAttribute(c,h);else e.renderer.setValue(c,"bindings="+JSON.stringify(o,null,2))}}var d}function Wi(e,t,n,r){si.apply(void 0,[e,t,n].concat(r))}var Hi=/([A-Z])/g;function ji(e){try{return null!=e?e.toString().slice(0,30):e}catch(e){return"[ERROR] Exception while trying to serialize the value"}}function qi(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(16384&r.flags&&r.bindings&&r.bindings.length)return n}return null}function Yi(e,t){for(var n=t;n<e.def.nodes.length;n++){var r=e.def.nodes[n];if(3&r.flags&&r.bindings&&r.bindings.length)return n}return null}var Xi=function(){function e(e,t){this.view=e,this.nodeIndex=t,null==t&&(this.nodeIndex=t=0),this.nodeDef=e.def.nodes[t];for(var n=this.nodeDef,r=e;n&&0==(1&n.flags);)n=n.parent;if(!n)for(;!n&&r;)n=vn(r),r=r.parent;this.elDef=n,this.elView=r}return Object.defineProperty(e.prototype,"elOrCompView",{get:function(){return Xt(this.elView,this.elDef.nodeIndex).componentView||this.view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"injector",{get:function(){return lr(this.elView,this.elDef)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"component",{get:function(){return this.elOrCompView.component},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.elOrCompView.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"providerTokens",{get:function(){var e=[];if(this.elDef)for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&e.push(n.provider.token),t+=n.childCount}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"references",{get:function(){var e={};if(this.elDef){Zi(this.elView,this.elDef,e);for(var t=this.elDef.nodeIndex+1;t<=this.elDef.nodeIndex+this.elDef.childCount;t++){var n=this.elView.def.nodes[t];20224&n.flags&&Zi(this.elView,n,e),t+=n.childCount}}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"componentRenderElement",{get:function(){var e=function(e){for(;e&&!Cn(e);)e=e.parent;return e.parent?Xt(e.parent,vn(e).nodeIndex):null}(this.elOrCompView);return e?e.renderElement:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderNode",{get:function(){return 2&this.nodeDef.flags?yn(this.view,this.nodeDef):yn(this.elView,this.elDef)},enumerable:!0,configurable:!0}),e.prototype.logError=function(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];2&this.nodeDef.flags?(t=this.view.def,n=this.nodeDef.nodeIndex):(t=this.elView.def,n=this.elDef.nodeIndex);var o=function(e,t){for(var n=-1,r=0;r<=t;r++)3&e.nodes[r].flags&&n++;return n}(t,n),a=-1;t.factory(function(){return++a===o?(t=e.error).bind.apply(t,[e].concat(r)):nn;var t}),a<o&&(e.error("Illegal state: the ViewDefinitionFactory did not call the logger!"),e.error.apply(e,r))},e}();function Zi(e,t,n){for(var r in t.references)n[r]=Ur(e,t,t.references[r])}function Ki(e,t,n,r){var i,o,a=Ni,s=Li,l=Fi;try{Ni=e;var u=t.apply(n,r);return Li=s,Fi=l,Ni=a,u}catch(e){if(Z(e)||!Li)throw e;throw i=e,o=Qi(),i instanceof Error||(i=new Error(i.toString())),en(i,o),i}}function Qi(){return Li?new Xi(Li,Fi):null}var Ji=function(){function e(e){this.delegate=e}return e.prototype.createRenderer=function(e,t){return new $i(this.delegate.createRenderer(e,t))},e.prototype.begin=function(){this.delegate.begin&&this.delegate.begin()},e.prototype.end=function(){this.delegate.end&&this.delegate.end()},e.prototype.whenRenderingDone=function(){return this.delegate.whenRenderingDone?this.delegate.whenRenderingDone():Promise.resolve(null)},e}(),$i=function(){function e(e){this.delegate=e}return Object.defineProperty(e.prototype,"data",{get:function(){return this.delegate.data},enumerable:!0,configurable:!0}),e.prototype.destroyNode=function(e){var t;t=mt(e),ft.delete(t.nativeNode),this.delegate.destroyNode&&this.delegate.destroyNode(e)},e.prototype.destroy=function(){this.delegate.destroy()},e.prototype.createElement=function(e,t){var n=this.delegate.createElement(e,t),r=Qi();if(r){var i=new pt(n,null,r);i.name=e,_t(i)}return n},e.prototype.createComment=function(e){var t=this.delegate.createComment(e),n=Qi();return n&&_t(new dt(t,null,n)),t},e.prototype.createText=function(e){var t=this.delegate.createText(e),n=Qi();return n&&_t(new dt(t,null,n)),t},e.prototype.appendChild=function(e,t){var n=mt(e),r=mt(t);n&&r&&n instanceof pt&&n.addChild(r),this.delegate.appendChild(e,t)},e.prototype.insertBefore=function(e,t,n){var r=mt(e),i=mt(t),o=mt(n);r&&i&&r instanceof pt&&r.insertBefore(o,i),this.delegate.insertBefore(e,t,n)},e.prototype.removeChild=function(e,t){var n=mt(e),r=mt(t);n&&r&&n instanceof pt&&n.removeChild(r),this.delegate.removeChild(e,t)},e.prototype.selectRootElement=function(e){var t=this.delegate.selectRootElement(e),n=Qi();return n&&_t(new pt(t,null,n)),t},e.prototype.setAttribute=function(e,t,n,r){var i=mt(e);i&&i instanceof pt&&(i.attributes[r?r+":"+t:t]=n),this.delegate.setAttribute(e,t,n,r)},e.prototype.removeAttribute=function(e,t,n){var r=mt(e);r&&r instanceof pt&&(r.attributes[n?n+":"+t:t]=null),this.delegate.removeAttribute(e,t,n)},e.prototype.addClass=function(e,t){var n=mt(e);n&&n instanceof pt&&(n.classes[t]=!0),this.delegate.addClass(e,t)},e.prototype.removeClass=function(e,t){var n=mt(e);n&&n instanceof pt&&(n.classes[t]=!1),this.delegate.removeClass(e,t)},e.prototype.setStyle=function(e,t,n,r){var i=mt(e);i&&i instanceof pt&&(i.styles[t]=n),this.delegate.setStyle(e,t,n,r)},e.prototype.removeStyle=function(e,t,n){var r=mt(e);r&&r instanceof pt&&(r.styles[t]=null),this.delegate.removeStyle(e,t,n)},e.prototype.setProperty=function(e,t,n){var r=mt(e);r&&r instanceof pt&&(r.properties[t]=n),this.delegate.setProperty(e,t,n)},e.prototype.listen=function(e,t,n){if("string"!=typeof e){var r=mt(e);r&&r.listeners.push(new function(e,t){this.name=e,this.callback=t}(t,n))}return this.delegate.listen(e,t,n)},e.prototype.parentNode=function(e){return this.delegate.parentNode(e)},e.prototype.nextSibling=function(e){return this.delegate.nextSibling(e)},e.prototype.setValue=function(e,t){return this.delegate.setValue(e,t)},e}();function eo(e,t,n){return new to(e,t,n)}var to=function(e){function t(t,n,r){var i=e.call(this)||this;return i.moduleType=t,i._bootstrapComponents=n,i._ngModuleDefFactory=r,i}return Object(r.c)(t,e),t.prototype.create=function(e){!function(){if(!_i){_i=!0;var e=je()?{setCurrentNode:ki,createRootView:vi,createEmbeddedView:Ci,createComponentView:wi,createNgModuleRef:bi,overrideProvider:xi,overrideComponentView:Ti,clearOverrides:Ai,checkAndUpdateView:Ii,checkNoChangesView:Oi,destroyView:Ri,createDebugContext:function(e,t){return new Xi(e,t)},handleEvent:Vi,updateDirectives:zi,updateRenderer:Ui}:{setCurrentNode:function(){},createRootView:gi,createEmbeddedView:Qr,createComponentView:$r,createNgModuleRef:dr,overrideProvider:nn,overrideComponentView:nn,clearOverrides:nn,checkAndUpdateView:ii,checkNoChangesView:ri,destroyView:ui,createDebugContext:function(e,t){return new Xi(e,t)},handleEvent:function(e,t,n,r){return e.def.handleEvent(e,t,n,r)},updateDirectives:function(e,t){return e.def.updateDirectives(0===t?Di:Mi,e)},updateRenderer:function(e,t){return e.def.updateRenderer(0===t?Di:Mi,e)}};Jt.setCurrentNode=e.setCurrentNode,Jt.createRootView=e.createRootView,Jt.createEmbeddedView=e.createEmbeddedView,Jt.createComponentView=e.createComponentView,Jt.createNgModuleRef=e.createNgModuleRef,Jt.overrideProvider=e.overrideProvider,Jt.overrideComponentView=e.overrideComponentView,Jt.clearOverrides=e.clearOverrides,Jt.checkAndUpdateView=e.checkAndUpdateView,Jt.checkNoChangesView=e.checkNoChangesView,Jt.destroyView=e.destroyView,Jt.resolveDep=Ir,Jt.createDebugContext=e.createDebugContext,Jt.handleEvent=e.handleEvent,Jt.updateDirectives=e.updateDirectives,Jt.updateRenderer=e.updateRenderer,Jt.dirtyParentQueries=kr}}();var t=Tn(this._ngModuleDefFactory);return Jt.createNgModuleRef(this.moduleType,e||I.NULL,this._bootstrapComponents,t)},t}(Ee)}).call(t,n("fRUx"))},LaOa:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return n.lift(new o(e,t))}};var r=n("6Xbx"),i=n("E9/g"),o=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.predicate,this.thisArg))},e}(),a=function(e){function t(t,n,r){e.call(this,t),this.predicate=n,this.thisArg=r,this.count=0}return Object(r.c)(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(i.a)},NGRF:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},NePw:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={e:{}}},Oryw:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n("6Xbx"),i=n("AP4T"),o=n("8Ut3"),a=n("Ecq+"),s=n("3iOE"),l=function(e){function t(t,n){e.call(this),this.array=t,this.scheduler=n,n||1!==t.length||(this._isScalar=!0,this.value=t[0])}return Object(r.c)(t,e),t.create=function(e,n){return new t(e,n)},t.of=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var r=e[e.length-1];Object(s.a)(r)?e.pop():r=null;var i=e.length;return i>1?new t(e,r):1===i?new o.a(e[0],r):new a.a(r)},t.dispatch=function(e){var t=e.array,n=e.index,r=e.subscriber;n>=e.count?r.complete():(r.next(t[n]),r.closed||(e.index=n+1,this.schedule(e)))},t.prototype._subscribe=function(e){var n=this.array,r=n.length,i=this.scheduler;if(i)return i.schedule(t.dispatch,0,{array:n,index:0,count:r,subscriber:e});for(var o=0;o<r&&!e.closed;o++)e.next(n[o]);e.complete()},t}(i.a)},PAZ8:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("AP4T"),i=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return r.a.of(this.value);case"E":return r.a.throw(this.error);case"C":return r.a.empty()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return"undefined"!=typeof t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}()},"PR+T":function(e,t,n){"use strict";t.a=function(){}},RWQz:function(e,t,n){"use strict";t.a=function(){return function(e){return e.lift(new o(e))}};var r=n("6Xbx"),i=n("E9/g"),o=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new a(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),a=function(e){function t(t,n){e.call(this,t),this.connectable=n}return Object(r.c)(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(i.a)},TO51:function(e,t,n){"use strict";n.d(t,"b",function(){return c}),n.d(t,"a",function(){return h});var r=n("6Xbx"),i=n("AP4T"),o=n("E9/g"),a=n("qLnt"),s=n("Upor"),l=n("jaVc"),u=n("V7AE"),c=function(e){function t(t){e.call(this,t),this.destination=t}return Object(r.c)(t,e),t}(o.a),h=function(e){function t(){e.call(this),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}return Object(r.c)(t,e),t.prototype[u.a]=function(){return new c(this)},t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new s.a;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new s.a;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.a;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new s.a;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new s.a;return this.hasError?(e.error(this.thrownError),a.a.EMPTY):this.isStopped?(e.complete(),a.a.EMPTY):(this.observers.push(e),new l.a(this,e))},t.prototype.asObservable=function(){var e=new i.a;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(i.a),d=function(e){function t(t,n){e.call(this),this.destination=t,this.source=n}return Object(r.c)(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):a.a.EMPTY},t}(h)},ThPn:function(e,t,n){"use strict";t.a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return r.a.apply(void 0,e)(this)};var r=n("Dxsx")},URbD:function(e,t,n){"use strict";t.a=function(){return Object(r.a)()(this)};var r=n("eIqN")},Upor:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("6Xbx"),i=function(e){function t(){var t=e.call(this,"object unsubscribed");this.name=t.name="ObjectUnsubscribedError",this.stack=t.stack,this.message=t.message}return Object(r.c)(t,e),t}(Error)},V7AE:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("xIGM").a.Symbol,i="function"==typeof r&&"function"==typeof r.for?r.for("rxSubscriber"):"@@rxSubscriber"},X3fp:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t=e.Symbol;if("function"==typeof t)return t.iterator||(t.iterator=t("iterator polyfill")),t.iterator;var n=e.Set;if(n&&"function"==typeof(new n)["@@iterator"])return"@@iterator";var r=e.Map;if(r)for(var i=Object.getOwnPropertyNames(r.prototype),o=0;o<i.length;++o){var a=i[o];if("entries"!==a&&"size"!==a&&r.prototype[a]===r.prototype.entries)return a}return"@@iterator"}(n("xIGM").a)},YRqN:function(e,t,n){"use strict";t.b=function(e,t){return void 0===t&&(t=0),function(n){return n.lift(new a(e,t))}},n.d(t,"a",function(){return s});var r=n("6Xbx"),i=n("E9/g"),o=n("PAZ8"),a=function(){function e(e,t){void 0===t&&(t=0),this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.scheduler,this.delay))},e}(),s=function(e){function t(t,n,r){void 0===r&&(r=0),e.call(this,t),this.scheduler=n,this.delay=r}return Object(r.c)(t,e),t.dispatch=function(e){e.notification.observe(e.destination),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.add(this.scheduler.schedule(t.dispatch,this.delay,new l(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(o.a.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(o.a.createError(e))},t.prototype._complete=function(){this.scheduleMessage(o.a.createComplete())},t}(i.a),l=function(e,t){this.notification=e,this.destination=t}},YuZA:function(e,t){function n(e){return Promise.resolve().then(function(){throw new Error("Cannot find module '"+e+"'.")})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="YuZA"},aqAJ:function(e,t,n){"use strict";t.a=function(e){return function(t){return t.lift(new o(e))}};var r=n("6Xbx"),i=n("E9/g"),o=function(){function e(e){this.total=e}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.total))},e}(),a=function(e){function t(t,n){e.call(this,t),this.total=n,this.count=0}return Object(r.c)(t,e),t.prototype._next=function(e){++this.count>this.total&&this.destination.next(e)},t}(i.a)},bywS:function(e,t,n){"use strict";t.a=function(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),Object(r.a)(i.a,null,e)};var r=n("wP3s"),i=n("ltvI")},cDNt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("LMZF"),i=function(){},o=function(){this.title="app"},a=n("6Xbx"),s=function(){},l=new r.o("Location Initialized"),u=function(){},c=new r.o("appBaseHref"),h=function(){function e(t){var n=this;this._subject=new r.m,this._platformStrategy=t;var i=this._platformStrategy.getBaseHref();this._baseHref=e.stripTrailingSlash(d(i)),this._platformStrategy.onPopState(function(e){n._subject.emit({url:n.path(!0),pop:!0,type:e.type})})}return e.prototype.path=function(e){return void 0===e&&(e=!1),this.normalize(this._platformStrategy.path(e))},e.prototype.isCurrentPathEqualTo=function(t,n){return void 0===n&&(n=""),this.path()==this.normalize(t+e.normalizeQueryParams(n))},e.prototype.normalize=function(t){return e.stripTrailingSlash((n=this._baseHref,r=d(t),n&&r.startsWith(n)?r.substring(n.length):r));var n,r},e.prototype.prepareExternalUrl=function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)},e.prototype.go=function(e,t){void 0===t&&(t=""),this._platformStrategy.pushState(null,"",e,t)},e.prototype.replaceState=function(e,t){void 0===t&&(t=""),this._platformStrategy.replaceState(null,"",e,t)},e.prototype.forward=function(){this._platformStrategy.forward()},e.prototype.back=function(){this._platformStrategy.back()},e.prototype.subscribe=function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})},e.normalizeQueryParams=function(e){return e&&"?"!==e[0]?"?"+e:e},e.joinWithSlash=function(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t},e.stripTrailingSlash=function(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)},e}();function d(e){return e.replace(/\/index.html$/,"")}var p=function(e){function t(t,n){var r=e.call(this)||this;return r._platformLocation=t,r._baseHref="",null!=n&&(r._baseHref=n),r}return Object(a.c)(t,e),t.prototype.onPopState=function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)},t.prototype.getBaseHref=function(){return this._baseHref},t.prototype.path=function(e){void 0===e&&(e=!1);var t=this._platformLocation.hash;return null==t&&(t="#"),t.length>0?t.substring(1):t},t.prototype.prepareExternalUrl=function(e){var t=h.joinWithSlash(this._baseHref,e);return t.length>0?"#"+t:t},t.prototype.pushState=function(e,t,n,r){var i=this.prepareExternalUrl(n+h.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.pushState(e,t,i)},t.prototype.replaceState=function(e,t,n,r){var i=this.prepareExternalUrl(n+h.normalizeQueryParams(r));0==i.length&&(i=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,i)},t.prototype.forward=function(){this._platformLocation.forward()},t.prototype.back=function(){this._platformLocation.back()},t}(u),f=function(e){function t(t,n){var r=e.call(this)||this;if(r._platformLocation=t,null==n&&(n=r._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return r._baseHref=n,r}return Object(a.c)(t,e),t.prototype.onPopState=function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)},t.prototype.getBaseHref=function(){return this._baseHref},t.prototype.prepareExternalUrl=function(e){return h.joinWithSlash(this._baseHref,e)},t.prototype.path=function(e){void 0===e&&(e=!1);var t=this._platformLocation.pathname+h.normalizeQueryParams(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?""+t+n:t},t.prototype.pushState=function(e,t,n,r){var i=this.prepareExternalUrl(n+h.normalizeQueryParams(r));this._platformLocation.pushState(e,t,i)},t.prototype.replaceState=function(e,t,n,r){var i=this.prepareExternalUrl(n+h.normalizeQueryParams(r));this._platformLocation.replaceState(e,t,i)},t.prototype.forward=function(){this._platformLocation.forward()},t.prototype.back=function(){this._platformLocation.back()},t}(u),m=["en",[["a","p"],["AM","PM"]],[["AM","PM"],,],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",,"{1} 'at' {0}"],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"$","US Dollar",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],_={},g=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),v=new r.o("UseV4Plurals"),y=function(){},C=function(e){function t(t,n){var r=e.call(this)||this;return r.locale=t,r.deprecatedPluralFn=n,r}return Object(a.c)(t,e),t.prototype.getPluralCategory=function(e,t){switch(this.deprecatedPluralFn?this.deprecatedPluralFn(t||this.locale,e):function(e){var t=e.toLowerCase().replace(/_/g,"-"),n=_[t];if(n)return n;var r=t.split("-")[0];if(n=_[r])return n;if("en"===r)return m;throw new Error('Missing locale data for the locale "'+e+'".')}(t||this.locale)[17](e)){case g.Zero:return"zero";case g.One:return"one";case g.Two:return"two";case g.Few:return"few";case g.Many:return"many";default:return"other"}},t}(y);function w(e,t){t=encodeURIComponent(t);for(var n=0,r=e.split(";");n<r.length;n++){var i=r[n],o=i.indexOf("="),a=-1==o?[i,""]:[i.slice(0,o),i.slice(o+1)],s=a[1];if(a[0].trim()===t)return decodeURIComponent(s)}return null}var b=function(){function e(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}return Object.defineProperty(e.prototype,"first",{get:function(){return 0===this.index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.index===this.count-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"even",{get:function(){return this.index%2==0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"odd",{get:function(){return!this.even},enumerable:!0,configurable:!0}),e}(),E=function(){function e(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._differ=null}return Object.defineProperty(e.prototype,"ngForTrackBy",{get:function(){return this._trackByFn},set:function(e){Object(r.T)()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received "+JSON.stringify(e)+". See https://angular.io/docs/ts/latest/api/common/index/NgFor-directive.html#!#change-propagation for more information."),this._trackByFn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngForTemplate",{set:function(e){e&&(this._template=e)},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){if("ngForOf"in e){var t=e.ngForOf.currentValue;if(!this._differ&&t)try{this._differ=this._differs.find(t).create(this.ngForTrackBy)}catch(e){throw new Error("Cannot find a differ supporting object '"+t+"' of type '"+((n=t).name||typeof n)+"'. NgFor only supports binding to Iterables such as Arrays.")}}var n},e.prototype.ngDoCheck=function(){if(this._differ){var e=this._differ.diff(this.ngForOf);e&&this._applyChanges(e)}},e.prototype._applyChanges=function(e){var t=this,n=[];e.forEachOperation(function(e,r,i){if(null==e.previousIndex){var o=t._viewContainer.createEmbeddedView(t._template,new b(null,t.ngForOf,-1,-1),i),a=new S(e,o);n.push(a)}else null==i?t._viewContainer.remove(r):(o=t._viewContainer.get(r),t._viewContainer.move(o,i),a=new S(e,o),n.push(a))});for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);r=0;for(var i=this._viewContainer.length;r<i;r++){var o=this._viewContainer.get(r);o.context.index=r,o.context.count=i}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})},e.prototype._perViewChange=function(e,t){e.context.$implicit=t.item},e}(),S=function(e,t){this.record=e,this.view=t},x=function(){function e(e,t){this._viewContainer=e,this._context=new T,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}return Object.defineProperty(e.prototype,"ngIf",{set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngIfThen",{set:function(e){this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngIfElse",{set:function(e){this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()},enumerable:!0,configurable:!0}),e.prototype._updateView=function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))},e}(),T=function(){this.$implicit=null,this.ngIf=null},A=function(){function e(e,t,n){this._differs=e,this._ngEl=t,this._renderer=n}return Object.defineProperty(e.prototype,"ngStyle",{set:function(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())},enumerable:!0,configurable:!0}),e.prototype.ngDoCheck=function(){if(this._differ){var e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}},e.prototype._applyChanges=function(e){var t=this;e.forEachRemovedItem(function(e){return t._setStyle(e.key,null)}),e.forEachAddedItem(function(e){return t._setStyle(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._setStyle(e.key,e.currentValue)})},e.prototype._setStyle=function(e,t){var n=e.split("."),r=n[1];this._renderer.setStyle(this._ngEl.nativeElement,n[0],t=null!=t&&r?""+t+r:t)},e}();function P(e,t){return Error("InvalidPipeArgument: '"+t+"' for pipe '"+Object(r._22)(e)+"'")}var D=function(){function e(){}return e.prototype.createSubscription=function(e,t){return e.subscribe({next:t,error:function(e){throw e}})},e.prototype.dispose=function(e){e.unsubscribe()},e.prototype.onDestroy=function(e){e.unsubscribe()},e}(),M=new(function(){function e(){}return e.prototype.createSubscription=function(e,t){return e.then(t,function(e){throw e})},e.prototype.dispose=function(e){},e.prototype.onDestroy=function(e){},e}()),I=new D,O=function(){function e(e){this._ref=e,this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null,this._strategy=null}return e.prototype.ngOnDestroy=function(){this._subscription&&this._dispose()},e.prototype.transform=function(e){return this._obj?e!==this._obj?(this._dispose(),this.transform(e)):this._latestValue===this._latestReturnedValue?this._latestReturnedValue:(this._latestReturnedValue=this._latestValue,r.O.wrap(this._latestValue)):(e&&this._subscribe(e),this._latestReturnedValue=this._latestValue,this._latestValue)},e.prototype._subscribe=function(e){var t=this;this._obj=e,this._strategy=this._selectStrategy(e),this._subscription=this._strategy.createSubscription(e,function(n){return t._updateLatestValue(e,n)})},e.prototype._selectStrategy=function(t){if(Object(r._9)(t))return M;if(Object(r._8)(t))return I;throw P(e,t)},e.prototype._dispose=function(){this._strategy.dispose(this._subscription),this._latestValue=null,this._latestReturnedValue=null,this._subscription=null,this._obj=null},e.prototype._updateLatestValue=function(e,t){e===this._obj&&(this._latestValue=t,this._ref.markForCheck())},e}(),R=function(){function e(){}return e.prototype.transform=function(t){if(!t)return t;if("string"!=typeof t)throw P(e,t);return t.toUpperCase()},e}(),N=function(){},L=new r.o("DocumentToken"),F=n("eoFs"),B=n("TO51"),k=n("Oryw"),V=k.a.of,z=n("wP3s");function U(e,t){return(n=e,r=t,Object(z.a)(n,r,1))(this);var n,r}var G=n("dmC+");function W(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),Object(z.a)(e,t,n)(this)}var H=n("AP4T"),j=n("1j/l"),q=n("kQVV"),Y=n("mHG6"),X=n("xIGM"),Z=function(e){function t(t,n){e.call(this),this.promise=t,this.scheduler=n}return Object(a.c)(t,e),t.create=function(e,n){return new t(e,n)},t.prototype._subscribe=function(e){var t=this,n=this.promise,r=this.scheduler;if(null==r)this._isScalar?e.closed||(e.next(this.value),e.complete()):n.then(function(n){t.value=n,t._isScalar=!0,e.closed||(e.next(n),e.complete())},function(t){e.closed||e.error(t)}).then(null,function(e){X.a.setTimeout(function(){throw e})});else if(this._isScalar){if(!e.closed)return r.schedule(K,0,{value:this.value,subscriber:e})}else n.then(function(n){t.value=n,t._isScalar=!0,e.closed||e.add(r.schedule(K,0,{value:n,subscriber:e}))},function(t){e.closed||e.add(r.schedule(Q,0,{err:t,subscriber:e}))}).then(null,function(e){X.a.setTimeout(function(){throw e})})},t}(H.a);function K(e){var t=e.subscriber;t.closed||(t.next(e.value),t.complete())}function Q(e){var t=e.subscriber;t.closed||t.error(e.err)}var J=n("X3fp"),$=function(e){function t(t,n){if(e.call(this),this.scheduler=n,null==t)throw new Error("iterator cannot be null.");this.iterator=function(e){var t=e[J.a];if(!t&&"string"==typeof e)return new ee(e);if(!t&&void 0!==e.length)return new te(e);if(!t)throw new TypeError("object is not iterable");return e[J.a]()}(t)}return Object(a.c)(t,e),t.create=function(e,n){return new t(e,n)},t.dispatch=function(e){var t=e.index,n=e.iterator,r=e.subscriber;if(e.hasError)r.error(e.error);else{var i=n.next();i.done?r.complete():(r.next(i.value),e.index=t+1,r.closed?"function"==typeof n.return&&n.return():this.schedule(e))}},t.prototype._subscribe=function(e){var n=this.iterator,r=this.scheduler;if(r)return r.schedule(t.dispatch,0,{index:0,iterator:n,subscriber:e});for(;;){var i=n.next();if(i.done){e.complete();break}if(e.next(i.value),e.closed){"function"==typeof n.return&&n.return();break}}},t}(H.a),ee=function(){function e(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length),this.str=e,this.idx=t,this.len=n}return e.prototype[J.a]=function(){return this},e.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.str.charAt(this.idx++)}:{done:!0,value:void 0}},e}(),te=function(){function e(e,t,n){var r,i,o;void 0===t&&(t=0),void 0===n&&(o=+e.length,n=isNaN(o)?0:0!==o&&"number"==typeof(r=o)&&X.a.isFinite(r)?(o=(0==(i=+o)?i:isNaN(i)?i:i<0?-1:1)*Math.floor(Math.abs(o)))<=0?0:o>ne?ne:o:o),this.arr=e,this.idx=t,this.len=n}return e.prototype[J.a]=function(){return this},e.prototype.next=function(){return this.idx<this.len?{done:!1,value:this.arr[this.idx++]}:{done:!0,value:void 0}},e}(),ne=Math.pow(2,53)-1,re=n("8Ut3"),ie=n("Ecq+"),oe=function(e){function t(t,n){e.call(this),this.arrayLike=t,this.scheduler=n,n||1!==t.length||(this._isScalar=!0,this.value=t[0])}return Object(a.c)(t,e),t.create=function(e,n){var r=e.length;return 0===r?new ie.a:1===r?new re.a(e[0],n):new t(e,n)},t.dispatch=function(e){var t=e.arrayLike,n=e.index,r=e.subscriber;r.closed||(n>=e.length?r.complete():(r.next(t[n]),e.index=n+1,this.schedule(e)))},t.prototype._subscribe=function(e){var n=this.arrayLike,r=this.scheduler,i=n.length;if(r)return r.schedule(t.dispatch,0,{arrayLike:n,index:0,length:i,subscriber:e});for(var o=0;o<i&&!e.closed;o++)e.next(n[o]);e.complete()},t}(H.a),ae=n("YRqN"),se=n("mz3w"),le=function(e){function t(t,n){e.call(this,null),this.ish=t,this.scheduler=n}return Object(a.c)(t,e),t.create=function(e,n){if(null!=e){if("function"==typeof e[se.a])return e instanceof H.a&&!n?e:new t(e,n);if(Object(j.a)(e))return new k.a(e,n);if(Object(Y.a)(e))return new Z(e,n);if("function"==typeof e[J.a]||"string"==typeof e)return new $(e,n);if(Object(q.a)(e))return new oe(e,n)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")},t.prototype._subscribe=function(e){var t=this.ish,n=this.scheduler;return null==n?t[se.a]().subscribe(e):t[se.a]().subscribe(new ae.a(e,n,0))},t}(H.a).create,ue=n("lI6h"),ce=n("qgI0");function he(e){return function(t){var n=new de(e),r=t.lift(n);return n.caught=r}}var de=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new pe(e,this.selector,this.caught))},e}(),pe=function(e){function t(t,n,r){e.call(this,t),this.selector=n,this.caught=r}return Object(a.c)(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle(),this.add(Object(ce.a)(this,n))}},t}(ue.a);function fe(e){return he(e)(this)}var me=n("bywS");function _e(){return Object(me.a)(1)(this)}var ge=n("E9/g"),ve=function(e){function t(){var t=e.call(this,"no elements in sequence");this.name=t.name="EmptyError",this.stack=t.stack,this.message=t.message}return Object(a.c)(t,e),t}(Error),ye=function(){function e(e,t,n,r){this.predicate=e,this.resultSelector=t,this.defaultValue=n,this.source=r}return e.prototype.call=function(e,t){return t.subscribe(new Ce(e,this.predicate,this.resultSelector,this.defaultValue,this.source))},e}(),Ce=function(e){function t(t,n,r,i,o){e.call(this,t),this.predicate=n,this.resultSelector=r,this.defaultValue=i,this.source=o,this.index=0,this.hasCompleted=!1,this._emitted=!1}return Object(a.c)(t,e),t.prototype._next=function(e){var t=this.index++;this.predicate?this._tryPredicate(e,t):this._emit(e,t)},t.prototype._tryPredicate=function(e,t){var n;try{n=this.predicate(e,t,this.source)}catch(e){return void this.destination.error(e)}n&&this._emit(e,t)},t.prototype._emit=function(e,t){this.resultSelector?this._tryResultSelector(e,t):this._emitFinal(e)},t.prototype._tryResultSelector=function(e,t){var n;try{n=this.resultSelector(e,t)}catch(e){return void this.destination.error(e)}this._emitFinal(n)},t.prototype._emitFinal=function(e){var t=this.destination;this._emitted||(this._emitted=!0,t.next(e),t.complete(),this.hasCompleted=!0)},t.prototype._complete=function(){var e=this.destination;this.hasCompleted||"undefined"==typeof this.defaultValue?this.hasCompleted||e.error(new ve):(e.next(this.defaultValue),e.complete())},t}(ge.a);function we(e,t,n){return(r=e,i=t,o=n,function(e){return e.lift(new ye(r,i,o,e))})(this);var r,i,o}var be=Z.create,Ee=function(){function e(e,t,n){this.predicate=e,this.thisArg=t,this.source=n}return e.prototype.call=function(e,t){return t.subscribe(new Se(e,this.predicate,this.thisArg,this.source))},e}(),Se=function(e){function t(t,n,r,i){e.call(this,t),this.predicate=n,this.thisArg=r,this.source=i,this.index=0,this.thisArg=r||this}return Object(a.c)(t,e),t.prototype.notifyComplete=function(e){this.destination.next(e),this.destination.complete()},t.prototype._next=function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(e){return void this.destination.error(e)}t||this.notifyComplete(!1)},t.prototype._complete=function(){this.notifyComplete(!0)},t}(ge.a);function xe(e,t){return(n=e,r=t,function(e){return e.lift(new Ee(n,r,e))})(this);var n,r}var Te=function(){function e(e,t,n,r){this.predicate=e,this.resultSelector=t,this.defaultValue=n,this.source=r}return e.prototype.call=function(e,t){return t.subscribe(new Ae(e,this.predicate,this.resultSelector,this.defaultValue,this.source))},e}(),Ae=function(e){function t(t,n,r,i,o){e.call(this,t),this.predicate=n,this.resultSelector=r,this.defaultValue=i,this.source=o,this.hasValue=!1,this.index=0,"undefined"!=typeof i&&(this.lastValue=i,this.hasValue=!0)}return Object(a.c)(t,e),t.prototype._next=function(e){var t=this.index++;if(this.predicate)this._tryPredicate(e,t);else{if(this.resultSelector)return void this._tryResultSelector(e,t);this.lastValue=e,this.hasValue=!0}},t.prototype._tryPredicate=function(e,t){var n;try{n=this.predicate(e,t,this.source)}catch(e){return void this.destination.error(e)}if(n){if(this.resultSelector)return void this._tryResultSelector(e,t);this.lastValue=e,this.hasValue=!0}},t.prototype._tryResultSelector=function(e,t){var n;try{n=this.resultSelector(e,t)}catch(e){return void this.destination.error(e)}this.lastValue=n,this.hasValue=!0},t.prototype._complete=function(){var e=this.destination;this.hasValue?(e.next(this.lastValue),e.complete()):e.error(new ve)},t}(ge.a);function Pe(e,t,n){return(r=e,i=t,o=n,function(e){return e.lift(new Te(r,i,o,e))})(this);var r,i,o}function De(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),Object(me.a)(e)(this)}var Me=n("nAqi"),Ie=function(e){function t(){var t=e.call(this,"argument out of range");this.name=t.name="ArgumentOutOfRangeError",this.stack=t.stack,this.message=t.message}return Object(a.c)(t,e),t}(Error);function Oe(e){return function(t){return 0===e?new ie.a:t.lift(new Re(e))}}var Re=function(){function e(e){if(this.total=e,this.total<0)throw new Ie}return e.prototype.call=function(e,t){return t.subscribe(new Ne(e,this.total))},e}(),Ne=function(e){function t(t,n){e.call(this,t),this.total=n,this.ring=new Array,this.count=0}return Object(a.c)(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var o=t++%n;e.next(r[o])}e.complete()},t}(ge.a),Le=function(){function e(e){this.defaultValue=e}return e.prototype.call=function(e,t){return t.subscribe(new Fe(e,this.defaultValue))},e}(),Fe=function(e){function t(t,n){e.call(this,t),this.defaultValue=n,this.isEmpty=!0}return Object(a.c)(t,e),t.prototype._next=function(e){this.isEmpty=!1,this.destination.next(e)},t.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},t}(ge.a),Be=n("ExCY");function ke(e,t){return arguments.length>=2?function(n){return Object(Be.a)(Object(Me.a)(e,t),Oe(1),(void 0===(r=t)&&(r=null),function(e){return e.lift(new Le(r))}))(n);var r}:function(t){return Object(Be.a)(Object(Me.a)(function(t,n,r){return e(t,n,r+1)}),Oe(1))(t)}}var Ve=null;function ze(){return Ve}var Ue,Ge={class:"className",innerHtml:"innerHTML",readonly:"readOnly",tabindex:"tabIndex"},We={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},He={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"};r._5.Node&&(Ue=r._5.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))});var je,qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.parse=function(e){throw new Error("parse not implemented")},t.makeCurrent=function(){var e;e=new t,Ve||(Ve=e)},t.prototype.hasProperty=function(e,t){return t in e},t.prototype.setProperty=function(e,t,n){e[t]=n},t.prototype.getProperty=function(e,t){return e[t]},t.prototype.invoke=function(e,t,n){var r;(r=e)[t].apply(r,n)},t.prototype.logError=function(e){window.console&&(console.error?console.error(e):console.log(e))},t.prototype.log=function(e){window.console&&window.console.log&&window.console.log(e)},t.prototype.logGroup=function(e){window.console&&window.console.group&&window.console.group(e)},t.prototype.logGroupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},Object.defineProperty(t.prototype,"attrToPropMap",{get:function(){return Ge},enumerable:!0,configurable:!0}),t.prototype.contains=function(e,t){return Ue.call(e,t)},t.prototype.querySelector=function(e,t){return e.querySelector(t)},t.prototype.querySelectorAll=function(e,t){return e.querySelectorAll(t)},t.prototype.on=function(e,t,n){e.addEventListener(t,n,!1)},t.prototype.onAndCancel=function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}},t.prototype.dispatchEvent=function(e,t){e.dispatchEvent(t)},t.prototype.createMouseEvent=function(e){var t=this.getDefaultDocument().createEvent("MouseEvent");return t.initEvent(e,!0,!0),t},t.prototype.createEvent=function(e){var t=this.getDefaultDocument().createEvent("Event");return t.initEvent(e,!0,!0),t},t.prototype.preventDefault=function(e){e.preventDefault(),e.returnValue=!1},t.prototype.isPrevented=function(e){return e.defaultPrevented||null!=e.returnValue&&!e.returnValue},t.prototype.getInnerHTML=function(e){return e.innerHTML},t.prototype.getTemplateContent=function(e){return"content"in e&&this.isTemplateElement(e)?e.content:null},t.prototype.getOuterHTML=function(e){return e.outerHTML},t.prototype.nodeName=function(e){return e.nodeName},t.prototype.nodeValue=function(e){return e.nodeValue},t.prototype.type=function(e){return e.type},t.prototype.content=function(e){return this.hasProperty(e,"content")?e.content:e},t.prototype.firstChild=function(e){return e.firstChild},t.prototype.nextSibling=function(e){return e.nextSibling},t.prototype.parentElement=function(e){return e.parentNode},t.prototype.childNodes=function(e){return e.childNodes},t.prototype.childNodesAsList=function(e){for(var t=e.childNodes,n=new Array(t.length),r=0;r<t.length;r++)n[r]=t[r];return n},t.prototype.clearNodes=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},t.prototype.appendChild=function(e,t){e.appendChild(t)},t.prototype.removeChild=function(e,t){e.removeChild(t)},t.prototype.replaceChild=function(e,t,n){e.replaceChild(t,n)},t.prototype.remove=function(e){return e.parentNode&&e.parentNode.removeChild(e),e},t.prototype.insertBefore=function(e,t,n){e.insertBefore(n,t)},t.prototype.insertAllBefore=function(e,t,n){n.forEach(function(n){return e.insertBefore(n,t)})},t.prototype.insertAfter=function(e,t,n){e.insertBefore(n,t.nextSibling)},t.prototype.setInnerHTML=function(e,t){e.innerHTML=t},t.prototype.getText=function(e){return e.textContent},t.prototype.setText=function(e,t){e.textContent=t},t.prototype.getValue=function(e){return e.value},t.prototype.setValue=function(e,t){e.value=t},t.prototype.getChecked=function(e){return e.checked},t.prototype.setChecked=function(e,t){e.checked=t},t.prototype.createComment=function(e){return this.getDefaultDocument().createComment(e)},t.prototype.createTemplate=function(e){var t=this.getDefaultDocument().createElement("template");return t.innerHTML=e,t},t.prototype.createElement=function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)},t.prototype.createElementNS=function(e,t,n){return(n=n||this.getDefaultDocument()).createElementNS(e,t)},t.prototype.createTextNode=function(e,t){return(t=t||this.getDefaultDocument()).createTextNode(e)},t.prototype.createScriptTag=function(e,t,n){var r=(n=n||this.getDefaultDocument()).createElement("SCRIPT");return r.setAttribute(e,t),r},t.prototype.createStyleElement=function(e,t){var n=(t=t||this.getDefaultDocument()).createElement("style");return this.appendChild(n,this.createTextNode(e,t)),n},t.prototype.createShadowRoot=function(e){return e.createShadowRoot()},t.prototype.getShadowRoot=function(e){return e.shadowRoot},t.prototype.getHost=function(e){return e.host},t.prototype.clone=function(e){return e.cloneNode(!0)},t.prototype.getElementsByClassName=function(e,t){return e.getElementsByClassName(t)},t.prototype.getElementsByTagName=function(e,t){return e.getElementsByTagName(t)},t.prototype.classList=function(e){return Array.prototype.slice.call(e.classList,0)},t.prototype.addClass=function(e,t){e.classList.add(t)},t.prototype.removeClass=function(e,t){e.classList.remove(t)},t.prototype.hasClass=function(e,t){return e.classList.contains(t)},t.prototype.setStyle=function(e,t,n){e.style[t]=n},t.prototype.removeStyle=function(e,t){e.style[t]=""},t.prototype.getStyle=function(e,t){return e.style[t]},t.prototype.hasStyle=function(e,t,n){var r=this.getStyle(e,t)||"";return n?r==n:r.length>0},t.prototype.tagName=function(e){return e.tagName},t.prototype.attributeMap=function(e){for(var t=new Map,n=e.attributes,r=0;r<n.length;r++){var i=n.item(r);t.set(i.name,i.value)}return t},t.prototype.hasAttribute=function(e,t){return e.hasAttribute(t)},t.prototype.hasAttributeNS=function(e,t,n){return e.hasAttributeNS(t,n)},t.prototype.getAttribute=function(e,t){return e.getAttribute(t)},t.prototype.getAttributeNS=function(e,t,n){return e.getAttributeNS(t,n)},t.prototype.setAttribute=function(e,t,n){e.setAttribute(t,n)},t.prototype.setAttributeNS=function(e,t,n,r){e.setAttributeNS(t,n,r)},t.prototype.removeAttribute=function(e,t){e.removeAttribute(t)},t.prototype.removeAttributeNS=function(e,t,n){e.removeAttributeNS(t,n)},t.prototype.templateAwareRoot=function(e){return this.isTemplateElement(e)?this.content(e):e},t.prototype.createHtmlDocument=function(){return document.implementation.createHTMLDocument("fakeTitle")},t.prototype.getDefaultDocument=function(){return document},t.prototype.getBoundingClientRect=function(e){try{return e.getBoundingClientRect()}catch(e){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}},t.prototype.getTitle=function(e){return e.title},t.prototype.setTitle=function(e,t){e.title=t||""},t.prototype.elementMatches=function(e,t){return!!this.isElementNode(e)&&(e.matches&&e.matches(t)||e.msMatchesSelector&&e.msMatchesSelector(t)||e.webkitMatchesSelector&&e.webkitMatchesSelector(t))},t.prototype.isTemplateElement=function(e){return this.isElementNode(e)&&"TEMPLATE"===e.nodeName},t.prototype.isTextNode=function(e){return e.nodeType===Node.TEXT_NODE},t.prototype.isCommentNode=function(e){return e.nodeType===Node.COMMENT_NODE},t.prototype.isElementNode=function(e){return e.nodeType===Node.ELEMENT_NODE},t.prototype.hasShadowRoot=function(e){return null!=e.shadowRoot&&e instanceof HTMLElement},t.prototype.isShadowRoot=function(e){return e instanceof DocumentFragment},t.prototype.importIntoDoc=function(e){return document.importNode(this.templateAwareRoot(e),!0)},t.prototype.adoptNode=function(e){return document.adoptNode(e)},t.prototype.getHref=function(e){return e.getAttribute("href")},t.prototype.getEventKey=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&He.hasOwnProperty(t)&&(t=He[t]))}return We[t]||t},t.prototype.getGlobalEventTarget=function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null},t.prototype.getHistory=function(){return window.history},t.prototype.getLocation=function(){return window.location},t.prototype.getBaseHref=function(e){var t,n=Ye||(Ye=document.querySelector("base"))?Ye.getAttribute("href"):null;return null==n?null:(t=n,je||(je=document.createElement("a")),je.setAttribute("href",t),"/"===je.pathname.charAt(0)?je.pathname:"/"+je.pathname)},t.prototype.resetBaseElement=function(){Ye=null},t.prototype.getUserAgent=function(){return window.navigator.userAgent},t.prototype.setData=function(e,t,n){this.setAttribute(e,"data-"+t,n)},t.prototype.getData=function(e,t){return this.getAttribute(e,"data-"+t)},t.prototype.getComputedStyle=function(e){return getComputedStyle(e)},t.prototype.supportsWebAnimation=function(){return"function"==typeof Element.prototype.animate},t.prototype.performanceNow=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()},t.prototype.supportsCookies=function(){return!0},t.prototype.getCookie=function(e){return w(document.cookie,e)},t.prototype.setCookie=function(e,t){document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)},t}(function(e){function t(){var t=e.call(this)||this;t._animationPrefix=null,t._transitionEnd=null;try{var n=t.createElement("div",document);if(null!=t.getStyle(n,"animationName"))t._animationPrefix="";else for(var r=["Webkit","Moz","O","ms"],i=0;i<r.length;i++)if(null!=t.getStyle(n,r[i]+"AnimationName")){t._animationPrefix="-"+r[i].toLowerCase()+"-";break}var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};Object.keys(o).forEach(function(e){null!=t.getStyle(n,e)&&(t._transitionEnd=o[e])})}catch(e){t._animationPrefix=null,t._transitionEnd=null}return t}return Object(a.c)(t,e),t.prototype.getDistributedNodes=function(e){return e.getDistributedNodes()},t.prototype.resolveAndSetHref=function(e,t,n){e.href=null==n?t:t+"/../"+n},t.prototype.supportsDOMEvents=function(){return!0},t.prototype.supportsNativeShadowDOM=function(){return"function"==typeof document.body.createShadowRoot},t.prototype.getAnimationPrefix=function(){return this._animationPrefix?this._animationPrefix:""},t.prototype.getTransitionEnd=function(){return this._transitionEnd?this._transitionEnd:""},t.prototype.supportsAnimation=function(){return null!=this._animationPrefix&&null!=this._transitionEnd},t}(function(){function e(){this.resourceLoaderType=null}return Object.defineProperty(e.prototype,"attrToPropMap",{get:function(){return this._attrToPropMap},set:function(e){this._attrToPropMap=e},enumerable:!0,configurable:!0}),e}())),Ye=null,Xe=L;function Ze(){return!!window.history.pushState}var Ke=function(e){function t(t){var n=e.call(this)||this;return n._doc=t,n._init(),n}return Object(a.c)(t,e),t.prototype._init=function(){this.location=ze().getLocation(),this._history=ze().getHistory()},t.prototype.getBaseHrefFromDOM=function(){return ze().getBaseHref(this._doc)},t.prototype.onPopState=function(e){ze().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)},t.prototype.onHashChange=function(e){ze().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)},Object.defineProperty(t.prototype,"pathname",{get:function(){return this.location.pathname},set:function(e){this.location.pathname=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"search",{get:function(){return this.location.search},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hash",{get:function(){return this.location.hash},enumerable:!0,configurable:!0}),t.prototype.pushState=function(e,t,n){Ze()?this._history.pushState(e,t,n):this.location.hash=n},t.prototype.replaceState=function(e,t,n){Ze()?this._history.replaceState(e,t,n):this.location.hash=n},t.prototype.forward=function(){this._history.forward()},t.prototype.back=function(){this._history.back()},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.n,args:[Xe]}]}]},t}(s),Qe=function(){function e(e){this._doc=e,this._dom=ze()}return e.prototype.addTag=function(e,t){return void 0===t&&(t=!1),e?this._getOrCreateElement(e,t):null},e.prototype.addTags=function(e,t){var n=this;return void 0===t&&(t=!1),e?e.reduce(function(e,r){return r&&e.push(n._getOrCreateElement(r,t)),e},[]):[]},e.prototype.getTag=function(e){return e?this._dom.querySelector(this._doc,"meta["+e+"]")||null:null},e.prototype.getTags=function(e){if(!e)return[];var t=this._dom.querySelectorAll(this._doc,"meta["+e+"]");return t?[].slice.call(t):[]},e.prototype.updateTag=function(e,t){if(!e)return null;t=t||this._parseSelector(e);var n=this.getTag(t);return n?this._setMetaElementAttributes(e,n):this._getOrCreateElement(e,!0)},e.prototype.removeTag=function(e){this.removeTagElement(this.getTag(e))},e.prototype.removeTagElement=function(e){e&&this._dom.remove(e)},e.prototype._getOrCreateElement=function(e,t){if(void 0===t&&(t=!1),!t){var n=this._parseSelector(e),r=this.getTag(n);if(r&&this._containsAttributes(e,r))return r}var i=this._dom.createElement("meta");this._setMetaElementAttributes(e,i);var o=this._dom.getElementsByTagName(this._doc,"head")[0];return this._dom.appendChild(o,i),i},e.prototype._setMetaElementAttributes=function(e,t){var n=this;return Object.keys(e).forEach(function(r){return n._dom.setAttribute(t,r,e[r])}),t},e.prototype._parseSelector=function(e){var t=e.name?"name":"property";return t+'="'+e[t]+'"'},e.prototype._containsAttributes=function(e,t){var n=this;return Object.keys(e).every(function(r){return n._dom.getAttribute(t,r)===e[r]})},e}(),Je=new r.o("TRANSITION_ID"),$e=[{provide:r.d,useFactory:function(e,t,n){return function(){n.get(r.e).donePromise.then(function(){var n=ze();Array.prototype.slice.apply(n.querySelectorAll(t,"style[ng-transition]")).filter(function(t){return n.getAttribute(t,"ng-transition")===e}).forEach(function(e){return n.remove(e)})})}},deps:[Je,Xe,r.p],multi:!0}],et=function(){function e(){}return e.init=function(){Object(r.V)(new e)},e.prototype.addToWindow=function(e){r._5.getAngularTestability=function(t,n){void 0===n&&(n=!0);var r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},r._5.getAllAngularTestabilities=function(){return e.getAllTestabilities()},r._5.getAllAngularRootElements=function(){return e.getAllRootElements()},r._5.frameworkStabilizers||(r._5.frameworkStabilizers=[]),r._5.frameworkStabilizers.push(function(e){var t=r._5.getAllAngularTestabilities(),n=t.length,i=!1,o=function(t){i=i||t,0==--n&&e(i)};t.forEach(function(e){e.whenStable(o)})})},e.prototype.findTestabilityInTree=function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?ze().isShadowRoot(t)?this.findTestabilityInTree(e,ze().getHost(t),!0):this.findTestabilityInTree(e,ze().parentElement(t),!0):null},e}(),tt=function(){function e(e){this._doc=e}return e.prototype.getTitle=function(){return ze().getTitle(this._doc)},e.prototype.setTitle=function(e){ze().setTitle(this._doc,e)},e}();function nt(e,t){"undefined"!=typeof COMPILED&&COMPILED||((r._5.ng=r._5.ng||{})[e]=t)}var rt={ApplicationRef:r.g,NgZone:r.x};function it(e){return Object(r.S)(e)}var ot=new r.o("EventManagerPlugins"),at=function(){function e(e,t){var n=this;this._zone=t,this._eventNameToPlugin=new Map,e.forEach(function(e){return e.manager=n}),this._plugins=e.slice().reverse()}return e.prototype.addEventListener=function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)},e.prototype.addGlobalEventListener=function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)},e.prototype.getZone=function(){return this._zone},e.prototype._findPluginFor=function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var i=n[r];if(i.supports(e))return this._eventNameToPlugin.set(e,i),i}throw new Error("No event manager plugin found for event "+e)},e}(),st=function(){function e(e){this._doc=e}return e.prototype.addGlobalEventListener=function(e,t,n){var r=ze().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target "+r+" for event "+t);return this.addEventListener(r,t,n)},e}(),lt=function(){function e(){this._stylesSet=new Set}return e.prototype.addStyles=function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)},e.prototype.onStylesAdded=function(e){},e.prototype.getAllStyles=function(){return Array.from(this._stylesSet)},e}(),ut=function(e){function t(t){var n=e.call(this)||this;return n._doc=t,n._hostNodes=new Set,n._styleNodes=new Set,n._hostNodes.add(t.head),n}return Object(a.c)(t,e),t.prototype._addStylesToHost=function(e,t){var n=this;e.forEach(function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))})},t.prototype.addHost=function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)},t.prototype.removeHost=function(e){this._hostNodes.delete(e)},t.prototype.onStylesAdded=function(e){var t=this;this._hostNodes.forEach(function(n){return t._addStylesToHost(e,n)})},t.prototype.ngOnDestroy=function(){this._styleNodes.forEach(function(e){return ze().remove(e)})},t}(lt),ct={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},ht=/%COMP%/g,dt="_nghost-%COMP%",pt="_ngcontent-%COMP%";function ft(e,t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?ft(e,i,n):(i=i.replace(ht,e),n.push(i))}return n}function mt(e){return function(t){!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var _t=function(){function e(e,t){this.eventManager=e,this.sharedStylesHost=t,this.rendererByCompId=new Map,this.defaultRenderer=new gt(e)}return e.prototype.createRenderer=function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case r.N.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new wt(this.eventManager,this.sharedStylesHost,t),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case r.N.Native:return new bt(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var i=ft(t.id,t.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}},e.prototype.begin=function(){},e.prototype.end=function(){},e}(),gt=function(){function e(e){this.eventManager=e,this.data=Object.create(null)}return e.prototype.destroy=function(){},e.prototype.createElement=function(e,t){return t?document.createElementNS(ct[t],e):document.createElement(e)},e.prototype.createComment=function(e){return document.createComment(e)},e.prototype.createText=function(e){return document.createTextNode(e)},e.prototype.appendChild=function(e,t){e.appendChild(t)},e.prototype.insertBefore=function(e,t,n){e&&e.insertBefore(t,n)},e.prototype.removeChild=function(e,t){e&&e.removeChild(t)},e.prototype.selectRootElement=function(e){var t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error('The selector "'+e+'" did not match any elements');return t.textContent="",t},e.prototype.parentNode=function(e){return e.parentNode},e.prototype.nextSibling=function(e){return e.nextSibling},e.prototype.setAttribute=function(e,t,n,r){if(r){t=r+":"+t;var i=ct[r];i?e.setAttributeNS(i,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)},e.prototype.removeAttribute=function(e,t,n){if(n){var r=ct[n];r?e.removeAttributeNS(r,t):e.removeAttribute(n+":"+t)}else e.removeAttribute(t)},e.prototype.addClass=function(e,t){e.classList.add(t)},e.prototype.removeClass=function(e,t){e.classList.remove(t)},e.prototype.setStyle=function(e,t,n,i){i&r.D.DashCase?e.style.setProperty(t,n,i&r.D.Important?"important":""):e.style[t]=n},e.prototype.removeStyle=function(e,t,n){n&r.D.DashCase?e.style.removeProperty(t):e.style[t]=""},e.prototype.setProperty=function(e,t,n){yt(t,"property"),e[t]=n},e.prototype.setValue=function(e,t){e.nodeValue=t},e.prototype.listen=function(e,t,n){return yt(t,"listener"),"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,mt(n)):this.eventManager.addEventListener(e,t,mt(n))},e}(),vt="@".charCodeAt(0);function yt(e,t){if(e.charCodeAt(0)===vt)throw new Error("Found the synthetic "+t+" "+e+'. Please include either "BrowserAnimationsModule" or "NoopAnimationsModule" in your application.')}var Ct,wt=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.component=r;var o=ft(r.id,r.styles,[]);return n.addStyles(o),i.contentAttr=pt.replace(ht,r.id),i.hostAttr=dt.replace(ht,r.id),i}return Object(a.c)(t,e),t.prototype.applyToHost=function(t){e.prototype.setAttribute.call(this,t,this.hostAttr,"")},t.prototype.createElement=function(t,n){var r=e.prototype.createElement.call(this,t,n);return e.prototype.setAttribute.call(this,r,this.contentAttr,""),r},t}(gt),bt=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;o.sharedStylesHost=n,o.hostEl=r,o.component=i,o.shadowRoot=r.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var a=ft(i.id,i.styles,[]),s=0;s<a.length;s++){var l=document.createElement("style");l.textContent=a[s],o.shadowRoot.appendChild(l)}return o}return Object(a.c)(t,e),t.prototype.nodeOrShadowRoot=function(e){return e===this.hostEl?this.shadowRoot:e},t.prototype.destroy=function(){this.sharedStylesHost.removeHost(this.shadowRoot)},t.prototype.appendChild=function(t,n){return e.prototype.appendChild.call(this,this.nodeOrShadowRoot(t),n)},t.prototype.insertBefore=function(t,n,r){return e.prototype.insertBefore.call(this,this.nodeOrShadowRoot(t),n,r)},t.prototype.removeChild=function(t,n){return e.prototype.removeChild.call(this,this.nodeOrShadowRoot(t),n)},t.prototype.parentNode=function(t){return this.nodeOrShadowRoot(e.prototype.parentNode.call(this,this.nodeOrShadowRoot(t)))},t}(gt),Et="undefined"!=typeof Zone&&Zone.__symbol__||function(e){return"__zone_symbol__"+e},St=Et("addEventListener"),xt=Et("removeEventListener"),Tt={},At="removeEventListener",Pt="__zone_symbol__propagationStopped",Dt="__zone_symbol__stopImmediatePropagation";"undefined"!=typeof Zone&&Zone[Et("BLACK_LISTED_EVENTS")]&&(Ct={});var Mt=function(e){return!!Ct&&Ct.hasOwnProperty(e)},It=function(e){var t=Tt[e.type];if(t){var n=this[t];if(n){var r=[e];if(1===n.length)return(a=n[0]).zone!==Zone.current?a.zone.run(a.handler,this,r):a.handler.apply(this,r);for(var i=n.slice(),o=0;o<i.length&&!0!==e[Pt];o++){var a;(a=i[o]).zone!==Zone.current?a.zone.run(a.handler,this,r):a.handler.apply(this,r)}}}},Ot=function(e){function t(t,n){var r=e.call(this,t)||this;return r.ngZone=n,r.patchEvent(),r}return Object(a.c)(t,e),t.prototype.patchEvent=function(){if(Event&&Event.prototype&&!Event.prototype[Dt]){var e=Event.prototype[Dt]=Event.prototype.stopImmediatePropagation;Event.prototype.stopImmediatePropagation=function(){this&&(this[Pt]=!0),e&&e.apply(this,arguments)}}},t.prototype.supports=function(e){return!0},t.prototype.addEventListener=function(e,t,n){var i=this,o=n;if(!e[St]||r.x.isInAngularZone()&&!Mt(t))e.addEventListener(t,o,!1);else{var a=Tt[t];a||(a=Tt[t]=Et("ANGULAR"+t+"FALSE"));var s=e[a],l=s&&s.length>0;s||(s=e[a]=[]);var u=Mt(t)?Zone.root:Zone.current;if(0===s.length)s.push({zone:u,handler:o});else{for(var c=!1,h=0;h<s.length;h++)if(s[h].handler===o){c=!0;break}c||s.push({zone:u,handler:o})}l||e[St](t,It,!1)}return function(){return i.removeEventListener(e,t,o)}},t.prototype.removeEventListener=function(e,t,n){var r=e[xt];if(!r)return e[At].apply(e,[t,n,!1]);var i=Tt[t],o=i&&e[i];if(!o)return e[At].apply(e,[t,n,!1]);for(var a=!1,s=0;s<o.length;s++)if(o[s].handler===n){a=!0,o.splice(s,1);break}a?0===o.length&&r.apply(e,[t,It,!1]):e[At].apply(e,[t,n,!1])},t}(st),Rt={pan:!0,panstart:!0,panmove:!0,panend:!0,pancancel:!0,panleft:!0,panright:!0,panup:!0,pandown:!0,pinch:!0,pinchstart:!0,pinchmove:!0,pinchend:!0,pinchcancel:!0,pinchin:!0,pinchout:!0,press:!0,pressup:!0,rotate:!0,rotatestart:!0,rotatemove:!0,rotateend:!0,rotatecancel:!0,swipe:!0,swipeleft:!0,swiperight:!0,swipeup:!0,swipedown:!0,tap:!0},Nt=new r.o("HammerGestureConfig"),Lt=function(){function e(){this.events=[],this.overrides={}}return e.prototype.buildHammer=function(e){var t=new Hammer(e);t.get("pinch").set({enable:!0}),t.get("rotate").set({enable:!0});for(var n in this.overrides)t.get(n).set(this.overrides[n]);return t},e}(),Ft=function(e){function t(t,n){var r=e.call(this,t)||this;return r._config=n,r}return Object(a.c)(t,e),t.prototype.supports=function(e){if(!Rt.hasOwnProperty(e.toLowerCase())&&!this.isCustomEvent(e))return!1;if(!window.Hammer)throw new Error("Hammer.js is not loaded, can not bind "+e+" event");return!0},t.prototype.addEventListener=function(e,t,n){var r=this,i=this.manager.getZone();return t=t.toLowerCase(),i.runOutsideAngular(function(){var o=r._config.buildHammer(e),a=function(e){i.runGuarded(function(){n(e)})};return o.on(t,a),function(){return o.off(t,a)}})},t.prototype.isCustomEvent=function(e){return this._config.events.indexOf(e)>-1},t}(st),Bt=["alt","control","meta","shift"],kt={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},Vt=function(e){function t(t){return e.call(this,t)||this}return Object(a.c)(t,e),t.prototype.supports=function(e){return null!=t.parseEventName(e)},t.prototype.addEventListener=function(e,n,r){var i=t.parseEventName(n),o=t.eventCallback(i.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return ze().onAndCancel(e,i.domEventName,o)})},t.parseEventName=function(e){var n=e.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;var i=t._normalizeKey(n.pop()),o="";if(Bt.forEach(function(e){var t=n.indexOf(e);t>-1&&(n.splice(t,1),o+=e+".")}),o+=i,0!=n.length||0===i.length)return null;var a={};return a.domEventName=r,a.fullKey=o,a},t.getEventFullKey=function(e){var t="",n=ze().getEventKey(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Bt.forEach(function(r){r!=n&&(0,kt[r])(e)&&(t+=r+".")}),t+=n},t.eventCallback=function(e,n,r){return function(i){t.getEventFullKey(i)===e&&r.runGuarded(function(){return n(i)})}},t._normalizeKey=function(e){switch(e){case"esc":return"escape";default:return e}},t}(st),zt=/^(?:(?:https?|mailto|ftp|tel|file):|[^&:/?#]*(?:[/?#]|$))/gi,Ut=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Gt(e){return(e=String(e)).match(zt)||e.match(Ut)?e:(Object(r.T)()&&ze().log("WARNING: sanitizing unsafe URL value "+e+" (see http://g.co/ng/security#xss)"),"unsafe:"+e)}var Wt=null,Ht=null;function jt(e){for(var t={},n=0,r=e.split(",");n<r.length;n++)t[r[n]]=!0;return t}function qt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,i=e;r<i.length;r++){var o=i[r];for(var a in o)o.hasOwnProperty(a)&&(n[a]=!0)}return n}var Yt=jt("area,br,col,hr,img,wbr"),Xt=jt("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Zt=jt("rp,rt"),Kt=qt(Zt,Xt),Qt=qt(Yt,qt(Xt,jt("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),qt(Zt,jt("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Kt),Jt=jt("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),$t=jt("srcset"),en=qt(Jt,$t,jt("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width")),tn=function(){function e(){this.sanitizedSomething=!1,this.buf=[]}return e.prototype.sanitizeChildren=function(e){for(var t=e.firstChild;t;)if(Ht.isElementNode(t)?this.startElement(t):Ht.isTextNode(t)?this.chars(Ht.nodeValue(t)):this.sanitizedSomething=!0,Ht.firstChild(t))t=Ht.firstChild(t);else for(;t;){Ht.isElementNode(t)&&this.endElement(t);var n=nn(t,Ht.nextSibling(t));if(n){t=n;break}t=nn(t,Ht.parentElement(t))}return this.buf.join("")},e.prototype.startElement=function(e){var t=this,n=Ht.nodeName(e).toLowerCase();Qt.hasOwnProperty(n)?(this.buf.push("<"),this.buf.push(n),Ht.attributeMap(e).forEach(function(e,n){var r,i=n.toLowerCase();en.hasOwnProperty(i)?(Jt[i]&&(e=Gt(e)),$t[i]&&(r=e,e=(r=String(r)).split(",").map(function(e){return Gt(e.trim())}).join(", ")),t.buf.push(" "),t.buf.push(n),t.buf.push('="'),t.buf.push(an(e)),t.buf.push('"')):t.sanitizedSomething=!0}),this.buf.push(">")):this.sanitizedSomething=!0},e.prototype.endElement=function(e){var t=Ht.nodeName(e).toLowerCase();Qt.hasOwnProperty(t)&&!Yt.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))},e.prototype.chars=function(e){this.buf.push(an(e))},e}();function nn(e,t){if(t&&Ht.contains(e,t))throw new Error("Failed to sanitize html because the element is clobbered: "+Ht.getOuterHTML(e));return t}var rn=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,on=/([^\#-~ |!])/g;function an(e){return e.replace(/&/g,"&amp;").replace(rn,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(on,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function sn(e){Ht.attributeMap(e).forEach(function(t,n){"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||Ht.removeAttribute(e,n)});for(var t=0,n=Ht.childNodesAsList(e);t<n.length;t++){var r=n[t];Ht.isElementNode(r)&&sn(r)}}var ln=new RegExp("^([-,.\"'%_!# a-zA-Z0-9]+|(?:(?:matrix|translate|scale|rotate|skew|perspective)(?:X|Y|3d)?|(?:rgb|hsl)a?|(?:repeating-)?(?:linear|radial)-gradient|(?:calc|attr))\\([-0-9.%, #a-zA-Z]+\\))$","g"),un=/^url\(([^)]+)\)$/,cn=function(){},hn=function(e){function t(t){var n=e.call(this)||this;return n._doc=t,n}return Object(a.c)(t,e),t.prototype.sanitize=function(e,t){if(null==t)return null;switch(e){case r.F.NONE:return t;case r.F.HTML:return t instanceof pn?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"HTML"),function(e,t){try{var n=function(){if(Wt)return Wt;var e=(Ht=ze()).createElement("template");if("content"in e)return e;var t=Ht.createHtmlDocument();if(null==(Wt=Ht.querySelector(t,"body"))){var n=Ht.createElement("html",t);Wt=Ht.createElement("body",t),Ht.appendChild(n,Wt),Ht.appendChild(t,n)}return Wt}(),i=t?String(t):"",o=5,a=i;do{if(0===o)throw new Error("Failed to sanitize html because the input is unstable");o--,Ht.setInnerHTML(n,i=a),e.documentMode&&sn(n),a=Ht.getInnerHTML(n)}while(i!==a);for(var s=new tn,l=s.sanitizeChildren(Ht.getTemplateContent(n)||n),u=Ht.getTemplateContent(n)||n,c=0,h=Ht.childNodesAsList(u);c<h.length;c++)Ht.removeChild(u,h[c]);return Object(r.T)()&&s.sanitizedSomething&&Ht.log("WARNING: sanitizing HTML stripped some content (see http://g.co/ng/security#xss)."),l}catch(e){throw Wt=null,e}}(this._doc,String(t)));case r.F.STYLE:return t instanceof fn?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"Style"),function(e){if(!(e=String(e).trim()))return"";var t=e.match(un);return t&&Gt(t[1])===t[1]||e.match(ln)&&function(e){for(var t=!0,n=!0,r=0;r<e.length;r++){var i=e.charAt(r);"'"===i&&n?t=!t:'"'===i&&t&&(n=!n)}return t&&n}(e)?e:(Object(r.T)()&&ze().log("WARNING: sanitizing unsafe style value "+e+" (see http://g.co/ng/security#xss)."),"unsafe")}(t));case r.F.SCRIPT:if(t instanceof mn)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"Script"),new Error("unsafe value used in a script context");case r.F.URL:return t instanceof gn||t instanceof _n?t.changingThisBreaksApplicationSecurity:(this.checkNotSafeValue(t,"URL"),Gt(String(t)));case r.F.RESOURCE_URL:if(t instanceof gn)return t.changingThisBreaksApplicationSecurity;throw this.checkNotSafeValue(t,"ResourceURL"),new Error("unsafe value used in a resource URL context (see http://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext "+e+" (see http://g.co/ng/security#xss)")}},t.prototype.checkNotSafeValue=function(e,t){if(e instanceof dn)throw new Error("Required a safe "+t+", got a "+e.getTypeName()+" (see http://g.co/ng/security#xss)")},t.prototype.bypassSecurityTrustHtml=function(e){return new pn(e)},t.prototype.bypassSecurityTrustStyle=function(e){return new fn(e)},t.prototype.bypassSecurityTrustScript=function(e){return new mn(e)},t.prototype.bypassSecurityTrustUrl=function(e){return new _n(e)},t.prototype.bypassSecurityTrustResourceUrl=function(e){return new gn(e)},t}(cn),dn=function(){function e(e){this.changingThisBreaksApplicationSecurity=e}return e.prototype.toString=function(){return"SafeValue must use [property]=binding: "+this.changingThisBreaksApplicationSecurity+" (see http://g.co/ng/security#xss)"},e}(),pn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.getTypeName=function(){return"HTML"},t}(dn),fn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.getTypeName=function(){return"Style"},t}(dn),mn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.getTypeName=function(){return"Script"},t}(dn),_n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.getTypeName=function(){return"URL"},t}(dn),gn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.getTypeName=function(){return"ResourceURL"},t}(dn),vn=[{provide:r.z,useValue:"browser"},{provide:r.A,useValue:function(){qe.makeCurrent(),et.init()},multi:!0},{provide:s,useClass:Ke,deps:[Xe]},{provide:Xe,useFactory:function(){return document},deps:[]}],yn=Object(r.P)(r.U,"browser",vn);function Cn(){return new r.l}var wn=function(){function e(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return e.withServerTransition=function(t){return{ngModule:e,providers:[{provide:r.c,useValue:t.appId},{provide:Je,useExisting:r.c},$e]}},e}();"undefined"!=typeof window&&window;var bn=n("6S6c"),En=function(e,t){this.id=e,this.url=t},Sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.toString=function(){return"NavigationStart(id: "+this.id+", url: '"+this.url+"')"},t}(En),xn=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.urlAfterRedirects=r,i}return Object(a.c)(t,e),t.prototype.toString=function(){return"NavigationEnd(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"')"},t}(En),Tn=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.reason=r,i}return Object(a.c)(t,e),t.prototype.toString=function(){return"NavigationCancel(id: "+this.id+", url: '"+this.url+"')"},t}(En),An=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.error=r,i}return Object(a.c)(t,e),t.prototype.toString=function(){return"NavigationError(id: "+this.id+", url: '"+this.url+"', error: "+this.error+")"},t}(En),Pn=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.urlAfterRedirects=r,o.state=i,o}return Object(a.c)(t,e),t.prototype.toString=function(){return"RoutesRecognized(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+")"},t}(En),Dn=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.urlAfterRedirects=r,o.state=i,o}return Object(a.c)(t,e),t.prototype.toString=function(){return"GuardsCheckStart(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+")"},t}(En),Mn=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n)||this;return a.urlAfterRedirects=r,a.state=i,a.shouldActivate=o,a}return Object(a.c)(t,e),t.prototype.toString=function(){return"GuardsCheckEnd(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+", shouldActivate: "+this.shouldActivate+")"},t}(En),In=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.urlAfterRedirects=r,o.state=i,o}return Object(a.c)(t,e),t.prototype.toString=function(){return"ResolveStart(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+")"},t}(En),On=function(e){function t(t,n,r,i){var o=e.call(this,t,n)||this;return o.urlAfterRedirects=r,o.state=i,o}return Object(a.c)(t,e),t.prototype.toString=function(){return"ResolveEnd(id: "+this.id+", url: '"+this.url+"', urlAfterRedirects: '"+this.urlAfterRedirects+"', state: "+this.state+")"},t}(En),Rn=function(){function e(e){this.route=e}return e.prototype.toString=function(){return"RouteConfigLoadStart(path: "+this.route.path+")"},e}(),Nn=function(){function e(e){this.route=e}return e.prototype.toString=function(){return"RouteConfigLoadEnd(path: "+this.route.path+")"},e}(),Ln=function(){function e(e){this.snapshot=e}return e.prototype.toString=function(){return"ChildActivationStart(path: '"+(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"")+"')"},e}(),Fn=function(){function e(e){this.snapshot=e}return e.prototype.toString=function(){return"ChildActivationEnd(path: '"+(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"")+"')"},e}(),Bn=function(){function e(e){this.snapshot=e}return e.prototype.toString=function(){return"ActivationStart(path: '"+(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"")+"')"},e}(),kn=function(){function e(e){this.snapshot=e}return e.prototype.toString=function(){return"ActivationEnd(path: '"+(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"")+"')"},e}(),Vn="primary",zn=function(){function e(e){this.params=e||{}}return e.prototype.has=function(e){return this.params.hasOwnProperty(e)},e.prototype.get=function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null},e.prototype.getAll=function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]},Object.defineProperty(e.prototype,"keys",{get:function(){return Object.keys(this.params)},enumerable:!0,configurable:!0}),e}();function Un(e){return new zn(e)}var Gn="ngNavigationCancelingError";function Wn(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var i={},o=0;o<r.length;o++){var a=r[o],s=e[o];if(a.startsWith(":"))i[a.substring(1)]=s;else if(a!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}var Hn=function(e,t){this.routes=e,this.module=t};function jn(e,t){void 0===t&&(t="");for(var n=0;n<e.length;n++){var r=e[n];qn(r,(i=t,(o=r)?i||o.path?i&&!o.path?i+"/":!i&&o.path?o.path:i+"/"+o.path:"":i))}var i,o}function qn(e,t){if(!e)throw new Error("\n      Invalid configuration of route '"+t+"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    ");if(Array.isArray(e))throw new Error("Invalid configuration of route '"+t+"': Array cannot be specified");if(!e.component&&e.outlet&&e.outlet!==Vn)throw new Error("Invalid configuration of route '"+t+"': a componentless route cannot have a named outlet set");if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '"+t+"': redirectTo and children cannot be used together");if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '"+t+"': redirectTo and loadChildren cannot be used together");if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '"+t+"': children and loadChildren cannot be used together");if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '"+t+"': redirectTo and component cannot be used together");if(e.path&&e.matcher)throw new Error("Invalid configuration of route '"+t+"': path and matcher cannot be used together");if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '"+t+"'. One of the following must be provided: component, redirectTo, children or loadChildren");if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '"+t+"': routes must have either a path or a matcher specified");if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '"+t+"': path cannot start with a slash");if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \""+t+'", redirectTo: "'+e.redirectTo+"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'.");if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '"+t+"': pathMatch can only be set to 'prefix' or 'full'");e.children&&jn(e.children,t)}function Yn(e,t){var n,r=Object.keys(e),i=Object.keys(t);if(r.length!=i.length)return!1;for(var o=0;o<r.length;o++)if(e[n=r[o]]!==t[n])return!1;return!0}function Xn(e){return Array.prototype.concat.apply([],e)}function Zn(e){return e.length>0?e[e.length-1]:null}function Kn(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Qn(e){var t=De.call(e);return xe.call(t,function(e){return!0===e})}function Jn(e){return Object(r._8)(e)?e:Object(r._9)(e)?be(Promise.resolve(e)):V(e)}function $n(e,t,n){return n?Yn(e.queryParams,t.queryParams)&&function e(t,n){if(!rr(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!t.children[r])return!1;if(!e(t.children[r],n.children[r]))return!1}return!0}(e.root,t.root):(r=e.queryParams,i=t.queryParams,Object.keys(i).length<=Object.keys(r).length&&Object.keys(i).every(function(e){return i[e]===r[e]})&&function e(t,n){return function t(n,r,i){if(n.segments.length>i.length)return!!rr(a=n.segments.slice(0,i.length),i)&&!r.hasChildren();if(n.segments.length===i.length){if(!rr(n.segments,i))return!1;for(var o in r.children){if(!n.children[o])return!1;if(!e(n.children[o],r.children[o]))return!1}return!0}var a=i.slice(0,n.segments.length),s=i.slice(n.segments.length);return!!rr(n.segments,a)&&!!n.children[Vn]&&t(n.children[Vn],r,s)}(t,n,n.segments)}(e.root,t.root));var r,i}var er=function(){function e(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}return Object.defineProperty(e.prototype,"queryParamMap",{get:function(){return this._queryParamMap||(this._queryParamMap=Un(this.queryParams)),this._queryParamMap},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return sr.serialize(this)},e}(),tr=function(){function e(e,t){var n=this;this.segments=e,this.children=t,this.parent=null,Kn(t,function(e,t){return e.parent=n})}return e.prototype.hasChildren=function(){return this.numberOfChildren>0},Object.defineProperty(e.prototype,"numberOfChildren",{get:function(){return Object.keys(this.children).length},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return lr(this)},e}(),nr=function(){function e(e,t){this.path=e,this.parameters=t}return Object.defineProperty(e.prototype,"parameterMap",{get:function(){return this._parameterMap||(this._parameterMap=Un(this.parameters)),this._parameterMap},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return hr(this)},e}();function rr(e,t){return e.length===t.length&&e.every(function(e,n){return e.path===t[n].path})}function ir(e,t){var n=[];return Kn(e.children,function(e,r){r===Vn&&(n=n.concat(t(e,r)))}),Kn(e.children,function(e,r){r!==Vn&&(n=n.concat(t(e,r)))}),n}var or=function(){},ar=function(){function e(){}return e.prototype.parse=function(e){var t=new _r(e);return new er(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())},e.prototype.serialize=function(e){var t,n;return"/"+function e(t,n){if(!t.hasChildren())return lr(t);if(n){var r=t.children[Vn]?e(t.children[Vn],!1):"",i=[];return Kn(t.children,function(t,n){n!==Vn&&i.push(n+":"+e(t,!1))}),i.length>0?r+"("+i.join("//")+")":r}var o=ir(t,function(n,r){return r===Vn?[e(t.children[Vn],!1)]:[r+":"+e(n,!1)]});return lr(t)+"/("+o.join("//")+")"}(e.root,!0)+(t=e.queryParams,(n=Object.keys(t).map(function(e){var n=t[e];return Array.isArray(n)?n.map(function(t){return ur(e)+"="+ur(t)}).join("&"):ur(e)+"="+ur(n)})).length?"?"+n.join("&"):"")+("string"==typeof e.fragment?"#"+encodeURI(e.fragment):"")},e}(),sr=new ar;function lr(e){return e.segments.map(function(e){return hr(e)}).join("/")}function ur(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";")}function cr(e){return decodeURIComponent(e)}function hr(e){return""+ur(e.path)+(t=e.parameters,Object.keys(t).map(function(e){return";"+ur(e)+"="+ur(t[e])}).join(""));var t}var dr=/^[^\/()?;=&#]+/;function pr(e){var t=e.match(dr);return t?t[0]:""}var fr=/^[^=?&#]+/,mr=/^[^?&#]+/,_r=function(){function e(e){this.url=e,this.remaining=e}return e.prototype.parseRootSegment=function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new tr([],{}):new tr([],this.parseChildren())},e.prototype.parseQueryParams=function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e},e.prototype.parseFragment=function(){return this.consumeOptional("#")?decodeURI(this.remaining):null},e.prototype.parseChildren=function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Vn]=new tr(e,t)),n},e.prototype.parseSegment=function(){var e=pr(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '"+this.remaining+"'.");return this.capture(e),new nr(cr(e),this.parseMatrixParams())},e.prototype.parseMatrixParams=function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e},e.prototype.parseParam=function(e){var t=pr(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=pr(this.remaining);r&&this.capture(n=r)}e[cr(t)]=cr(n)}},e.prototype.parseQueryParam=function(e){var t,n=(t=this.remaining.match(fr))?t[0]:"";if(n){this.capture(n);var r,i="";if(this.consumeOptional("=")){var o=(r=this.remaining.match(mr))?r[0]:"";o&&this.capture(i=o)}var a=cr(n),s=cr(i);if(e.hasOwnProperty(a)){var l=e[a];Array.isArray(l)||(e[a]=l=[l]),l.push(s)}else e[a]=s}},e.prototype.parseParens=function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=pr(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '"+this.url+"'");var i=void 0;n.indexOf(":")>-1?(i=n.substr(0,n.indexOf(":")),this.capture(i),this.capture(":")):e&&(i=Vn);var o=this.parseChildren();t[i]=1===Object.keys(o).length?o[Vn]:new tr([],o),this.consumeOptional("//")}return t},e.prototype.peekStartsWith=function(e){return this.remaining.startsWith(e)},e.prototype.consumeOptional=function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)},e.prototype.capture=function(e){if(!this.consumeOptional(e))throw new Error('Expected "'+e+'".')},e}(),gr=function(e){this.segmentGroup=e||null},vr=function(e){this.urlTree=e};function yr(e){return new H.a(function(t){return t.error(new gr(e))})}function Cr(e){return new H.a(function(t){return t.error(new vr(e))})}function wr(e){return new H.a(function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '"+e+"'"))})}var br=function(){function e(e,t,n,i,o){this.configLoader=t,this.urlSerializer=n,this.urlTree=i,this.config=o,this.allowRedirects=!0,this.ngModule=e.get(r.v)}return e.prototype.apply=function(){var e=this,t=this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,Vn),n=G.a.call(t,function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)});return fe.call(n,function(t){if(t instanceof vr)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof gr)throw e.noMatchError(t);throw t})},e.prototype.match=function(e){var t=this,n=this.expandSegmentGroup(this.ngModule,this.config,e.root,Vn),r=G.a.call(n,function(n){return t.createUrlTree(n,e.queryParams,e.fragment)});return fe.call(r,function(e){if(e instanceof gr)throw t.noMatchError(e);throw e})},e.prototype.noMatchError=function(e){return new Error("Cannot match any routes. URL Segment: '"+e.segmentGroup+"'")},e.prototype.createUrlTree=function(e,t,n){var r,i=e.segments.length>0?new tr([],((r={})[Vn]=e,r)):e;return new er(i,t,n)},e.prototype.expandSegmentGroup=function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?G.a.call(this.expandChildren(e,t,n),function(e){return new tr([],e)}):this.expandSegment(e,n,t,n.segments,r,!0)},e.prototype.expandChildren=function(e,t,n){var r=this;return function(n,i){if(0===Object.keys(n).length)return V({});var o=[],a=[],s={};Kn(n,function(n,i){var l=G.a.call(r.expandSegmentGroup(e,t,n,i),function(e){return s[i]=e});i===Vn?o.push(l):a.push(l)});var l=_e.call(V.apply(void 0,o.concat(a))),u=Pe.call(l);return G.a.call(u,function(){return s})}(n.children)},e.prototype.expandSegment=function(e,t,n,r,i,o){var a=this,s=V.apply(void 0,n),l=G.a.call(s,function(s){var l=a.expandSegmentAgainstRoute(e,t,n,s,r,i,o);return fe.call(l,function(e){if(e instanceof gr)return V(null);throw e})}),u=_e.call(l),c=we.call(u,function(e){return!!e});return fe.call(c,function(e,n){if(e instanceof ve){if(a.noLeftoversInUrl(t,r,i))return V(new tr([],{}));throw new gr(t)}throw e})},e.prototype.noLeftoversInUrl=function(e,t,n){return 0===t.length&&!e.children[n]},e.prototype.expandSegmentAgainstRoute=function(e,t,n,r,i,o,a){return Tr(r)!==o?yr(t):void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,i):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o):yr(t)},e.prototype.expandSegmentAgainstRouteUsingRedirect=function(e,t,n,r,i,o){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,i,o)},e.prototype.expandWildCardWithParamsAgainstRouteUsingRedirect=function(e,t,n,r){var i=this,o=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?Cr(o):W.call(this.lineralizeSegments(n,o),function(n){var o=new tr(n,{});return i.expandSegment(e,o,t,n,r,!1)})},e.prototype.expandRegularSegmentAgainstRouteUsingRedirect=function(e,t,n,r,i,o){var a=this,s=Er(t,r,i),l=s.consumedSegments,u=s.lastChild,c=s.positionalParamSegments;if(!s.matched)return yr(t);var h=this.applyRedirectCommands(l,r.redirectTo,c);return r.redirectTo.startsWith("/")?Cr(h):W.call(this.lineralizeSegments(r,h),function(r){return a.expandSegment(e,t,n,r.concat(i.slice(u)),o,!1)})},e.prototype.matchSegmentAgainstRoute=function(e,t,n,r){var i=this;if("**"===n.path)return n.loadChildren?G.a.call(this.configLoader.load(e.injector,n),function(e){return n._loadedConfig=e,new tr(r,{})}):V(new tr(r,{}));var o=Er(t,n,r),s=o.consumedSegments,l=o.lastChild;if(!o.matched)return yr(t);var u=r.slice(l),c=this.getChildConfig(e,n);return W.call(c,function(e){var n,r,o,l,c,h,d,p,f=e.module,m=e.routes,_=(n=t,r=s,l=m,(o=u).length>0&&(c=n,h=o,l.some(function(e){return xr(c,h,e)&&Tr(e)!==Vn}))?{segmentGroup:Sr(new tr(r,function(e,t){var n={};n[Vn]=t;for(var r=0,i=e;r<i.length;r++){var o=i[r];""===o.path&&Tr(o)!==Vn&&(n[Tr(o)]=new tr([],{}))}return n}(l,new tr(o,n.children)))),slicedSegments:[]}:0===o.length&&(d=n,p=o,l.some(function(e){return xr(d,p,e)}))?{segmentGroup:Sr(new tr(n.segments,function(e,t,n,r){for(var i={},o=0,s=l;o<s.length;o++){var u=s[o];xr(e,t,u)&&!r[Tr(u)]&&(i[Tr(u)]=new tr([],{}))}return Object(a.a)({},r,i)}(n,o,0,n.children))),slicedSegments:o}:{segmentGroup:n,slicedSegments:o}),g=_.segmentGroup,v=_.slicedSegments;if(0===v.length&&g.hasChildren()){var y=i.expandChildren(f,m,g);return G.a.call(y,function(e){return new tr(s,e)})}if(0===m.length&&0===v.length)return V(new tr(s,{}));var C=i.expandSegment(f,g,m,v,Vn,!0);return G.a.call(C,function(e){return new tr(s.concat(e.segments),e.children)})})},e.prototype.getChildConfig=function(e,t){var n,r,i,o=this;return t.children?V(new Hn(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?V(t._loadedConfig):W.call((n=e.injector,(i=(r=t).canLoad)&&0!==i.length?Qn(G.a.call(le(i),function(e){var t=n.get(e);return Jn(t.canLoad?t.canLoad(r):t(r))})):V(!0)),function(n){return n?G.a.call(o.configLoader.load(e.injector,t),function(e){return t._loadedConfig=e,e}):(r=t,new H.a(function(e){return e.error(((t=Error("NavigationCancelingError: Cannot load children because the guard of the route \"path: '"+r.path+"'\" returned false"))[Gn]=!0,t));var t}));var r}):V(new Hn([],e))},e.prototype.lineralizeSegments=function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return V(n);if(r.numberOfChildren>1||!r.children[Vn])return wr(e.redirectTo);r=r.children[Vn]}},e.prototype.applyRedirectCommands=function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)},e.prototype.applyRedirectCreatreUrlTree=function(e,t,n,r){var i=this.createSegmentGroup(e,t.root,n,r);return new er(i,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)},e.prototype.createQueryParams=function(e,t){var n={};return Kn(e,function(e,r){if("string"==typeof e&&e.startsWith(":")){var i=e.substring(1);n[r]=t[i]}else n[r]=e}),n},e.prototype.createSegmentGroup=function(e,t,n,r){var i=this,o=this.createSegments(e,t.segments,n,r),a={};return Kn(t.children,function(t,o){a[o]=i.createSegmentGroup(e,t,n,r)}),new tr(o,a)},e.prototype.createSegments=function(e,t,n,r){var i=this;return t.map(function(t){return t.path.startsWith(":")?i.findPosParam(e,t,r):i.findOrReturn(t,n)})},e.prototype.findPosParam=function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '"+e+"'. Cannot find '"+t.path+"'.");return r},e.prototype.findOrReturn=function(e,t){for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r];if(o.path===e.path)return t.splice(n),o;n++}return e},e}();function Er(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(t.matcher||Wn)(n,e,t);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Sr(e){if(1===e.numberOfChildren&&e.children[Vn]){var t=e.children[Vn];return new tr(e.segments.concat(t.segments),t.children)}return e}function xr(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Tr(e){return e.outlet||Vn}var Ar=function(){function e(e){this._root=e}return Object.defineProperty(e.prototype,"root",{get:function(){return this._root.value},enumerable:!0,configurable:!0}),e.prototype.parent=function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null},e.prototype.children=function(e){var t=Pr(e,this._root);return t?t.children.map(function(e){return e.value}):[]},e.prototype.firstChild=function(e){var t=Pr(e,this._root);return t&&t.children.length>0?t.children[0].value:null},e.prototype.siblings=function(e){var t=Dr(e,this._root);return t.length<2?[]:t[t.length-2].children.map(function(e){return e.value}).filter(function(t){return t!==e})},e.prototype.pathFromRoot=function(e){return Dr(e,this._root).map(function(e){return e.value})},e}();function Pr(e,t){if(e===t.value)return t;for(var n=0,r=t.children;n<r.length;n++){var i=Pr(e,r[n]);if(i)return i}return null}function Dr(e,t){if(e===t.value)return[t];for(var n=0,r=t.children;n<r.length;n++){var i=Dr(e,r[n]);if(i.length)return i.unshift(t),i}return[]}var Mr=function(){function e(e,t){this.value=e,this.children=t}return e.prototype.toString=function(){return"TreeNode("+this.value+")"},e}();function Ir(e){var t={};return e&&e.children.forEach(function(e){return t[e.value.outlet]=e}),t}var Or=function(e){function t(t,n){var r=e.call(this,t)||this;return r.snapshot=n,kr(r,t),r}return Object(a.c)(t,e),t.prototype.toString=function(){return this.snapshot.toString()},t}(Ar);function Rr(e,t){var n,r=(n=new Fr([],{},{},"",{},Vn,t,null,e.root,-1,{}),new Br("",new Mr(n,[]))),i=new F.a([new nr("",{})]),o=new F.a({}),a=new F.a({}),s=new F.a({}),l=new F.a(""),u=new Nr(i,o,s,l,a,Vn,t,r.root);return u.snapshot=r.root,new Or(new Mr(u,[]),r)}var Nr=function(){function e(e,t,n,r,i,o,a,s){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this._futureSnapshot=s}return Object.defineProperty(e.prototype,"routeConfig",{get:function(){return this._futureSnapshot.routeConfig},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._routerState.root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._routerState.parent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this._routerState.firstChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._routerState.children(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pathFromRoot",{get:function(){return this._routerState.pathFromRoot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMap",{get:function(){return this._paramMap||(this._paramMap=G.a.call(this.params,function(e){return Un(e)})),this._paramMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queryParamMap",{get:function(){return this._queryParamMap||(this._queryParamMap=G.a.call(this.queryParams,function(e){return Un(e)})),this._queryParamMap},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return this.snapshot?this.snapshot.toString():"Future("+this._futureSnapshot+")"},e}();function Lr(e){for(var t=e.pathFromRoot,n=t.length-1;n>=1;){var r=t[n],i=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(i.component)break;n--}}return t.slice(n).reduce(function(e,t){return{params:Object(a.a)({},e.params,t.params),data:Object(a.a)({},e.data,t.data),resolve:Object(a.a)({},e.resolve,t._resolvedData)}},{params:{},data:{},resolve:{}})}var Fr=function(){function e(e,t,n,r,i,o,a,s,l,u,c){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=i,this.outlet=o,this.component=a,this.routeConfig=s,this._urlSegment=l,this._lastPathIndex=u,this._resolve=c}return Object.defineProperty(e.prototype,"root",{get:function(){return this._routerState.root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._routerState.parent(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this._routerState.firstChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._routerState.children(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pathFromRoot",{get:function(){return this._routerState.pathFromRoot(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMap",{get:function(){return this._paramMap||(this._paramMap=Un(this.params)),this._paramMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"queryParamMap",{get:function(){return this._queryParamMap||(this._queryParamMap=Un(this.queryParams)),this._queryParamMap},enumerable:!0,configurable:!0}),e.prototype.toString=function(){return"Route(url:'"+this.url.map(function(e){return e.toString()}).join("/")+"', path:'"+(this.routeConfig?this.routeConfig.path:"")+"')"},e}(),Br=function(e){function t(t,n){var r=e.call(this,n)||this;return r.url=t,kr(r,n),r}return Object(a.c)(t,e),t.prototype.toString=function(){return Vr(this._root)},t}(Ar);function kr(e,t){t.value._routerState=e,t.children.forEach(function(t){return kr(e,t)})}function Vr(e){var t=e.children.length>0?" { "+e.children.map(Vr).join(", ")+" } ":"";return""+e.value+t}function zr(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Yn(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),Yn(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!Yn(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),Yn(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Ur(e,t){var n,r;return Yn(e.params,t.params)&&rr(n=e.url,r=t.url)&&n.every(function(e,t){return Yn(e.parameters,r[t].parameters)})&&!(!e.parent!=!t.parent)&&(!e.parent||Ur(e.parent,t.parent))}function Gr(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Wr(e,t,n,r,i){var o={};return r&&Kn(r,function(e,t){o[t]=Array.isArray(e)?e.map(function(e){return""+e}):""+e}),new er(n.root===e?t:function e(t,n,r){var i={};return Kn(t.children,function(t,o){i[o]=t===n?r:e(t,n,r)}),new tr(t.segments,i)}(n.root,e,t),o,i)}var Hr=function(){function e(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Gr(n[0]))throw new Error("Root segment cannot have matrix parameters");var r=n.find(function(e){return"object"==typeof e&&null!=e&&e.outlets});if(r&&r!==Zn(n))throw new Error("{outlets:{}} has to be the last command")}return e.prototype.toRoot=function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]},e}(),jr=function(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n};function qr(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets[Vn]:""+e}function Yr(e,t,n){if(e||(e=new tr([],{})),0===e.segments.length&&e.hasChildren())return Xr(e,t,n);var r=function(e,n,r){for(var i=0,o=t,a={match:!1,pathIndex:0,commandIndex:0};o<e.segments.length;){if(i>=r.length)return a;var s=e.segments[o],l=qr(r[i]),u=i<r.length-1?r[i+1]:null;if(o>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!Jr(l,u,s))return a;i+=2}else{if(!Jr(l,{},s))return a;i++}o++}return{match:!0,pathIndex:o,commandIndex:i}}(e,0,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var o=new tr(e.segments.slice(0,r.pathIndex),{});return o.children[Vn]=new tr(e.segments.slice(r.pathIndex),e.children),Xr(o,0,i)}return r.match&&0===i.length?new tr(e.segments,{}):r.match&&!e.hasChildren()?Zr(e,t,n):r.match?Xr(e,0,i):Zr(e,t,n)}function Xr(e,t,n){if(0===n.length)return new tr(e.segments,{});var r,i,o,a="object"!=typeof(r=n)[0]?((i={})[Vn]=r,i):void 0===r[0].outlets?((o={})[Vn]=r,o):r[0].outlets,s={};return Kn(a,function(n,r){null!==n&&(s[r]=Yr(e.children[r],t,n))}),Kn(e.children,function(e,t){void 0===a[t]&&(s[t]=e)}),new tr(e.segments,s)}function Zr(e,t,n){for(var r=e.segments.slice(0,t),i=0;i<n.length;){if("object"==typeof n[i]&&void 0!==n[i].outlets){var o=Kr(n[i].outlets);return new tr(r,o)}if(0===i&&Gr(n[0]))r.push(new nr(e.segments[t].path,n[0])),i++;else{var a=qr(n[i]),s=i<n.length-1?n[i+1]:null;a&&s&&Gr(s)?(r.push(new nr(a,Qr(s))),i+=2):(r.push(new nr(a,{})),i++)}}return new tr(r,{})}function Kr(e){var t={};return Kn(e,function(e,n){null!==e&&(t[n]=Zr(new tr([],{}),0,e))}),t}function Qr(e){var t={};return Kn(e,function(e,n){return t[n]=""+e}),t}function Jr(e,t,n){return e==n.path&&Yn(t,n.parameters)}var $r=function(){function e(e){this.path=e}return Object.defineProperty(e.prototype,"route",{get:function(){return this.path[this.path.length-1]},enumerable:!0,configurable:!0}),e}(),ei=function(e,t){this.component=e,this.route=t},ti=function(){function e(e,t,n,r){this.future=e,this.curr=t,this.moduleInjector=n,this.forwardEvent=r,this.canActivateChecks=[],this.canDeactivateChecks=[]}return e.prototype.initialize=function(e){var t=this.future._root;this.setupChildRouteGuards(t,this.curr?this.curr._root:null,e,[t.value])},e.prototype.checkGuards=function(){var e=this;if(!this.isDeactivating()&&!this.isActivating())return V(!0);var t=this.runCanDeactivateChecks();return W.call(t,function(t){return t?e.runCanActivateChecks():V(!1)})},e.prototype.resolveData=function(){var e=this;if(!this.isActivating())return V(null);var t=le(this.canActivateChecks),n=U.call(t,function(t){return e.runResolve(t.route)});return(function(e,t){return arguments.length>=2?ke(e,t)(this):ke(e)(this)}).call(n,function(e,t){return e})},e.prototype.isDeactivating=function(){return 0!==this.canDeactivateChecks.length},e.prototype.isActivating=function(){return 0!==this.canActivateChecks.length},e.prototype.setupChildRouteGuards=function(e,t,n,r){var i=this,o=Ir(t);e.children.forEach(function(e){i.setupRouteGuards(e,o[e.value.outlet],n,r.concat([e.value])),delete o[e.value.outlet]}),Kn(o,function(e,t){return i.deactivateRouteAndItsChildren(e,n.getContext(t))})},e.prototype.setupRouteGuards=function(e,t,n,r){var i=e.value,o=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(o&&i.routeConfig===o.routeConfig){var s=this.shouldRunGuardsAndResolvers(o,i,i.routeConfig.runGuardsAndResolvers);s?this.canActivateChecks.push(new $r(r)):(i.data=o.data,i._resolvedData=o._resolvedData),this.setupChildRouteGuards(e,t,i.component?a?a.children:null:n,r),s&&this.canDeactivateChecks.push(new ei(a.outlet.component,o))}else o&&this.deactivateRouteAndItsChildren(t,a),this.canActivateChecks.push(new $r(r)),this.setupChildRouteGuards(e,null,i.component?a?a.children:null:n,r)},e.prototype.shouldRunGuardsAndResolvers=function(e,t,n){switch(n){case"always":return!0;case"paramsOrQueryParamsChange":return!Ur(e,t)||!Yn(e.queryParams,t.queryParams);case"paramsChange":default:return!Ur(e,t)}},e.prototype.deactivateRouteAndItsChildren=function(e,t){var n=this,r=Ir(e),i=e.value;Kn(r,function(e,r){n.deactivateRouteAndItsChildren(e,i.component?t?t.children.getContext(r):null:t)}),this.canDeactivateChecks.push(new ei(i.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,i))},e.prototype.runCanDeactivateChecks=function(){var e=this,t=le(this.canDeactivateChecks),n=W.call(t,function(t){return e.runCanDeactivate(t.component,t.route)});return xe.call(n,function(e){return!0===e})},e.prototype.runCanActivateChecks=function(){var e=this,t=le(this.canActivateChecks),n=U.call(t,function(t){return Qn(le([e.fireChildActivationStart(t.route.parent),e.fireActivationStart(t.route),e.runCanActivateChild(t.path),e.runCanActivate(t.route)]))});return xe.call(n,function(e){return!0===e})},e.prototype.fireActivationStart=function(e){return null!==e&&this.forwardEvent&&this.forwardEvent(new Bn(e)),V(!0)},e.prototype.fireChildActivationStart=function(e){return null!==e&&this.forwardEvent&&this.forwardEvent(new Ln(e)),V(!0)},e.prototype.runCanActivate=function(e){var t=this,n=e.routeConfig?e.routeConfig.canActivate:null;return n&&0!==n.length?Qn(G.a.call(le(n),function(n){var r,i=t.getToken(n,e);return r=Jn(i.canActivate?i.canActivate(e,t.future):i(e,t.future)),we.call(r)})):V(!0)},e.prototype.runCanActivateChild=function(e){var t=this,n=e[e.length-1],r=e.slice(0,e.length-1).reverse().map(function(e){return t.extractCanActivateChild(e)}).filter(function(e){return null!==e});return Qn(G.a.call(le(r),function(e){return Qn(G.a.call(le(e.guards),function(r){var i,o=t.getToken(r,e.node);return i=Jn(o.canActivateChild?o.canActivateChild(n,t.future):o(n,t.future)),we.call(i)}))}))},e.prototype.extractCanActivateChild=function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null},e.prototype.runCanDeactivate=function(e,t){var n=this,r=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!r||0===r.length)return V(!0);var i=W.call(le(r),function(r){var i,o=n.getToken(r,t);return i=Jn(o.canDeactivate?o.canDeactivate(e,t,n.curr,n.future):o(e,t,n.curr,n.future)),we.call(i)});return xe.call(i,function(e){return!0===e})},e.prototype.runResolve=function(e){return G.a.call(this.resolveNode(e._resolve,e),function(t){return e._resolvedData=t,e.data=Object(a.a)({},e.data,Lr(e).resolve),null})},e.prototype.resolveNode=function(e,t){var n=this,r=Object.keys(e);if(0===r.length)return V({});if(1===r.length){var i=r[0];return G.a.call(this.getResolver(e[i],t),function(e){return(t={})[i]=e,t;var t})}var o={},a=W.call(le(r),function(r){return G.a.call(n.getResolver(e[r],t),function(e){return o[r]=e,e})});return G.a.call(Pe.call(a),function(){return o})},e.prototype.getResolver=function(e,t){var n=this.getToken(e,t);return Jn(n.resolve?n.resolve(t,this.future):n(t,this.future))},e.prototype.getToken=function(e,t){var n=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(n?n.module.injector:this.moduleInjector).get(e)},e}(),ni=function(){},ri=function(){function e(e,t,n,r){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r}return e.prototype.recognize=function(){try{var e=ai(this.urlTree.root,[],[],this.config).segmentGroup,t=this.processSegmentGroup(this.config,e,Vn),n=new Fr([],Object.freeze({}),Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,{},Vn,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Mr(n,t),i=new Br(this.url,r);return this.inheritParamsAndData(i._root),V(i)}catch(e){return new H.a(function(t){return t.error(e)})}},e.prototype.inheritParamsAndData=function(e){var t=this,n=e.value,r=Lr(n);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(function(e){return t.inheritParamsAndData(e)})},e.prototype.processSegmentGroup=function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)},e.prototype.processChildren=function(e,t){var n,r=this,i=ir(t,function(t,n){return r.processSegmentGroup(e,t,n)});return n={},i.forEach(function(e){var t=n[e.value.outlet];if(t){var r=t.url.map(function(e){return e.toString()}).join("/"),i=e.value.url.map(function(e){return e.toString()}).join("/");throw new Error("Two segments cannot have the same outlet name: '"+r+"' and '"+i+"'.")}n[e.value.outlet]=e.value}),i.sort(function(e,t){return e.value.outlet===Vn?-1:t.value.outlet===Vn?1:e.value.outlet.localeCompare(t.value.outlet)}),i},e.prototype.processSegment=function(e,t,n,r){for(var i=0,o=e;i<o.length;i++){var a=o[i];try{return this.processSegmentAgainstRoute(a,t,n,r)}catch(e){if(!(e instanceof ni))throw e}}if(this.noLeftoversInUrl(t,n,r))return[];throw new ni},e.prototype.noLeftoversInUrl=function(e,t,n){return 0===t.length&&!e.children[n]},e.prototype.processSegmentAgainstRoute=function(e,t,n,r){if(e.redirectTo)throw new ni;if((e.outlet||Vn)!==r)throw new ni;var i,o=[],s=[];if("**"===e.path){var l=n.length>0?Zn(n).parameters:{};i=new Fr(n,l,Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,ui(e),r,e.component,e,ii(t),oi(t)+n.length,ci(e))}else{var u=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new ni;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(t.matcher||Wn)(n,e,t);if(!r)throw new ni;var i={};Kn(r.posParams,function(e,t){i[t]=e.path});var o=r.consumed.length>0?Object(a.a)({},i,r.consumed[r.consumed.length-1].parameters):i;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:o}}(t,e,n);o=u.consumedSegments,s=n.slice(u.lastChild),i=new Fr(o,u.parameters,Object.freeze(this.urlTree.queryParams),this.urlTree.fragment,ui(e),r,e.component,e,ii(t),oi(t)+o.length,ci(e))}var c=e.children?e.children:e.loadChildren?e._loadedConfig.routes:[],h=ai(t,o,s,c),d=h.segmentGroup,p=h.slicedSegments;if(0===p.length&&d.hasChildren()){var f=this.processChildren(c,d);return[new Mr(i,f)]}if(0===c.length&&0===p.length)return[new Mr(i,[])];var m=this.processSegment(c,d,p,Vn);return[new Mr(i,m)]},e}();function ii(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function oi(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function ai(e,t,n,r){if(n.length>0&&(o=e,s=n,r.some(function(e){return si(o,s,e)&&li(e)!==Vn}))){var i=new tr(t,function(e,t,n,r){var i={};i[Vn]=r,r._sourceSegment=e,r._segmentIndexShift=t.length;for(var o=0,a=n;o<a.length;o++){var s=a[o];if(""===s.path&&li(s)!==Vn){var l=new tr([],{});l._sourceSegment=e,l._segmentIndexShift=t.length,i[li(s)]=l}}return i}(e,t,r,new tr(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}var o,s,l,u;if(0===n.length&&(l=e,u=n,r.some(function(e){return si(l,u,e)}))){var c=new tr(e.segments,function(e,t,n,i){for(var o={},s=0,l=r;s<l.length;s++){var u=l[s];if(si(e,t,u)&&!i[li(u)]){var c=new tr([],{});c._sourceSegment=e,c._segmentIndexShift=e.segments.length,o[li(u)]=c}}return Object(a.a)({},i,o)}(e,n,0,e.children));return c._sourceSegment=e,c._segmentIndexShift=t.length,{segmentGroup:c,slicedSegments:n}}var h=new tr(e.segments,e.children);return h._sourceSegment=e,h._segmentIndexShift=t.length,{segmentGroup:h,slicedSegments:n}}function si(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function li(e){return e.outlet||Vn}function ui(e){return e.data||{}}function ci(e){return e.resolve||{}}var hi=function(){},di=function(){function e(){}return e.prototype.shouldDetach=function(e){return!1},e.prototype.store=function(e,t){},e.prototype.shouldAttach=function(e){return!1},e.prototype.retrieve=function(e){return null},e.prototype.shouldReuseRoute=function(e,t){return e.routeConfig===t.routeConfig},e}(),pi=new r.o("ROUTES"),fi=function(){function e(e,t,n,r){this.loader=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}return e.prototype.load=function(e,t){var n=this;this.onLoadStartListener&&this.onLoadStartListener(t);var r=this.loadModuleFactory(t.loadChildren);return G.a.call(r,function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var i=r.create(e);return new Hn(Xn(i.injector.get(pi)),i)})},e.prototype.loadModuleFactory=function(e){var t=this;return"string"==typeof e?be(this.loader.load(e)):W.call(Jn(e()),function(e){return e instanceof r.t?V(e):be(t.compiler.compileModuleAsync(e))})},e}(),mi=function(){},_i=function(){function e(){}return e.prototype.shouldProcessUrl=function(e){return!0},e.prototype.extract=function(e){return e},e.prototype.merge=function(e,t){return e},e}();function gi(e){throw e}function vi(e){return V(null)}var yi=function(){function e(e,t,n,i,o,a,s,l){var u=this;this.rootComponentType=e,this.urlSerializer=t,this.rootContexts=n,this.location=i,this.config=l,this.navigations=new F.a(null),this.navigationId=0,this.events=new B.a,this.errorHandler=gi,this.navigated=!1,this.hooks={beforePreactivation:vi,afterPreactivation:vi},this.urlHandlingStrategy=new _i,this.routeReuseStrategy=new di,this.onSameUrlNavigation="ignore",this.ngModule=o.get(r.v),this.resetConfig(l),this.currentUrlTree=new er(new tr([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.configLoader=new fi(a,s,function(e){return u.triggerEvent(new Rn(e))},function(e){return u.triggerEvent(new Nn(e))}),this.routerState=Rr(this.currentUrlTree,this.rootComponentType),this.processNavigations()}return e.prototype.resetRootComponentType=function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType},e.prototype.initialNavigation=function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})},e.prototype.setUpLocationChangeListener=function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(Zone.current.wrap(function(t){var n=e.urlSerializer.parse(t.url),r="popstate"===t.type?"popstate":"hashchange";setTimeout(function(){e.scheduleNavigation(n,r,{replaceUrl:!0})},0)})))},Object.defineProperty(e.prototype,"url",{get:function(){return this.serializeUrl(this.currentUrlTree)},enumerable:!0,configurable:!0}),e.prototype.triggerEvent=function(e){this.events.next(e)},e.prototype.resetConfig=function(e){jn(e),this.config=e,this.navigated=!1},e.prototype.ngOnDestroy=function(){this.dispose()},e.prototype.dispose=function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)},e.prototype.createUrlTree=function(e,t){void 0===t&&(t={});var n=t.relativeTo,i=t.queryParams,o=t.fragment,s=t.preserveQueryParams,l=t.queryParamsHandling,u=t.preserveFragment;Object(r.T)()&&s&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var c=n||this.routerState.root,h=u?this.currentUrlTree.fragment:o,d=null;if(l)switch(l){case"merge":d=Object(a.a)({},this.currentUrlTree.queryParams,i);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=i||null}else d=s?this.currentUrlTree.queryParams:i||null;return null!==d&&(d=this.removeEmptyProps(d)),function(e,t,n,r,i){if(0===n.length)return Wr(t.root,t.root,t,r,i);var o=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Hr(!0,0,e);var t=0,n=!1,r=e.reduce(function(e,r,i){if("object"==typeof r&&null!=r){if(r.outlets){var o={};return Kn(r.outlets,function(e,t){o[t]="string"==typeof e?e.split("/"):e}),e.concat([{outlets:o}])}if(r.segmentPath)return e.concat([r.segmentPath])}return"string"!=typeof r?e.concat([r]):0===i?(r.split("/").forEach(function(r,i){0==i&&"."===r||(0==i&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))}),e):e.concat([r])},[]);return new Hr(n,t,r)}(n);if(o.toRoot())return Wr(t.root,new tr([],{}),t,r,i);var a=function(e,n,r){if(e.isAbsolute)return new jr(t.root,!0,0);if(-1===r.snapshot._lastPathIndex)return new jr(r.snapshot._urlSegment,!0,0);var i=Gr(e.commands[0])?0:1;return function(t,n,o){for(var a=r.snapshot._urlSegment,s=r.snapshot._lastPathIndex+i,l=e.numberOfDoubleDots;l>s;){if(l-=s,!(a=a.parent))throw new Error("Invalid number of '../'");s=a.segments.length}return new jr(a,!1,s-l)}()}(o,0,e),s=a.processChildren?Xr(a.segmentGroup,a.index,o.commands):Yr(a.segmentGroup,a.index,o.commands);return Wr(a.segmentGroup,s,t,r,i)}(c,this.currentUrlTree,e,d,h)},e.prototype.navigateByUrl=function(e,t){void 0===t&&(t={skipLocationChange:!1});var n=e instanceof er?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",t)},e.prototype.navigate=function(e,t){return void 0===t&&(t={skipLocationChange:!1}),function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains "+n+" segment at index "+t)}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)},e.prototype.serializeUrl=function(e){return this.urlSerializer.serialize(e)},e.prototype.parseUrl=function(e){return this.urlSerializer.parse(e)},e.prototype.isActive=function(e,t){if(e instanceof er)return $n(this.currentUrlTree,e,t);var n=this.urlSerializer.parse(e);return $n(this.currentUrlTree,n,t)},e.prototype.removeEmptyProps=function(e){return Object.keys(e).reduce(function(t,n){var r=e[n];return null!==r&&void 0!==r&&(t[n]=r),t},{})},e.prototype.processNavigations=function(){var e=this;U.call(this.navigations,function(t){return t?(e.executeScheduledNavigation(t),t.promise.catch(function(){})):V(null)}).subscribe(function(){})},e.prototype.scheduleNavigation=function(e,t,n){var r=this.navigations.value;if(r&&"imperative"!==t&&"imperative"===r.source&&r.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(r&&"hashchange"==t&&"popstate"===r.source&&r.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(r&&"popstate"==t&&"hashchange"===r.source&&r.rawUrl.toString()===e.toString())return Promise.resolve(!0);var i=null,o=null,a=new Promise(function(e,t){i=e,o=t}),s=++this.navigationId;return this.navigations.next({id:s,source:t,rawUrl:e,extras:n,resolve:i,reject:o,promise:a}),a.catch(function(e){return Promise.reject(e)})},e.prototype.executeScheduledNavigation=function(e){var t=this,n=e.id,r=e.rawUrl,i=e.extras,o=e.resolve,a=e.reject,s=this.urlHandlingStrategy.extract(r),l=!this.navigated||s.toString()!==this.currentUrlTree.toString();("reload"===this.onSameUrlNavigation||l)&&this.urlHandlingStrategy.shouldProcessUrl(r)?(this.events.next(new Sn(n,this.serializeUrl(s))),Promise.resolve().then(function(e){return t.runNavigate(s,r,!!i.skipLocationChange,!!i.replaceUrl,n,null)}).then(o,a)):l&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)?(this.events.next(new Sn(n,this.serializeUrl(s))),Promise.resolve().then(function(e){return t.runNavigate(s,r,!1,!1,n,Rr(s,t.rootComponentType).snapshot)}).then(o,a)):(this.rawUrlTree=r,o(null))},e.prototype.runNavigate=function(e,t,n,r,i,o){var a=this;return i!==this.navigationId?(this.events.next(new Tn(i,this.serializeUrl(e),"Navigation ID "+i+" is not equal to the current navigation id "+this.navigationId)),Promise.resolve(!1)):new Promise(function(s,l){var u;if(o)u=V({appliedUrl:e,snapshot:o});else{var c=new br(a.ngModule.injector,a.configLoader,a.urlSerializer,e,a.config).apply();u=W.call(c,function(t){return G.a.call((n=a.rootComponentType,r=a.config,o=t,s=a.serializeUrl(t),new ri(n,r,o,s).recognize()),function(n){return a.events.next(new Pn(i,a.serializeUrl(e),a.serializeUrl(t),n)),{appliedUrl:t,snapshot:n}});var n,r,o,s})}var h,d,p=W.call(u,function(e){return G.a.call(a.hooks.beforePreactivation(e.snapshot),function(){return e})}),f=G.a.call(p,function(e){var t=e.appliedUrl,n=e.snapshot;return(h=new ti(n,a.routerState.snapshot,a.ngModule.injector,function(e){return a.triggerEvent(e)})).initialize(a.rootContexts),{appliedUrl:t,snapshot:n}}),m=W.call(f,function(t){var n=t.appliedUrl,r=t.snapshot;return a.navigationId!==i?V(!1):(a.triggerEvent(new Dn(i,a.serializeUrl(e),n,r)),G.a.call(h.checkGuards(),function(t){return a.triggerEvent(new Mn(i,a.serializeUrl(e),n,r,t)),{appliedUrl:n,snapshot:r,shouldActivate:t}}))}),_=W.call(m,function(t){return a.navigationId!==i?V(!1):t.shouldActivate&&h.isActivating()?(a.triggerEvent(new In(i,a.serializeUrl(e),t.appliedUrl,t.snapshot)),G.a.call(h.resolveData(),function(){return a.triggerEvent(new On(i,a.serializeUrl(e),t.appliedUrl,t.snapshot)),t})):V(t)}),g=W.call(_,function(e){return G.a.call(a.hooks.afterPreactivation(e.snapshot),function(){return e})}),v=G.a.call(g,function(e){var t,n,r,i=e.appliedUrl,o=e.shouldActivate;return o?{appliedUrl:i,state:(r=function e(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){(u=r.value)._futureSnapshot=n.value;var i=(s=t,l=r,n.children.map(function(t){for(var n=0,r=l.children;n<r.length;n++){var i=r[n];if(s.shouldReuseRoute(i.value.snapshot,t.value))return e(s,t,i)}return e(s,t)}));return new Mr(u,i)}if(t.retrieve(n.value)){var o=t.retrieve(n.value).route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var r=0;r<t.children.length;++r)e(t.children[r],n.children[r])}(n,o),o}var a,s,l,u=new Nr(new F.a((a=n.value).url),new F.a(a.params),new F.a(a.queryParams),new F.a(a.fragment),new F.a(a.data),a.outlet,a.component,a);return i=n.children.map(function(n){return e(t,n)}),new Mr(u,i)}(a.routeReuseStrategy,(t=e.snapshot)._root,(n=a.routerState)?n._root:void 0),new Or(r,t)),shouldActivate:o}:{appliedUrl:i,state:null,shouldActivate:o}}),y=a.routerState,C=a.currentUrlTree;v.forEach(function(e){var o=e.state;if(e.shouldActivate&&i===a.navigationId){if(a.currentUrlTree=e.appliedUrl,a.rawUrlTree=a.urlHandlingStrategy.merge(a.currentUrlTree,t),a.routerState=o,!n){var s=a.urlSerializer.serialize(a.rawUrlTree);a.location.isCurrentPathEqualTo(s)||r?a.location.replaceState(s):a.location.go(s)}new Ci(a.routeReuseStrategy,o,y,function(e){return a.triggerEvent(e)}).activate(a.rootContexts),d=!0}else d=!1}).then(function(){d?(a.navigated=!0,a.events.next(new xn(i,a.serializeUrl(e),a.serializeUrl(a.currentUrlTree))),s(!0)):(a.resetUrlToCurrentUrlTree(),a.events.next(new Tn(i,a.serializeUrl(e),"")),s(!1))},function(n){if((r=n)&&r[Gn])a.navigated=!0,a.resetStateAndUrl(y,C,t),a.events.next(new Tn(i,a.serializeUrl(e),n.message)),s(!1);else{a.resetStateAndUrl(y,C,t),a.events.next(new An(i,a.serializeUrl(e),n));try{s(a.errorHandler(n))}catch(e){l(e)}}var r})})},e.prototype.resetStateAndUrl=function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()},e.prototype.resetUrlToCurrentUrlTree=function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree))},e}(),Ci=function(){function e(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}return e.prototype.activate=function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),zr(this.futureState.root),this.activateChildRoutes(t,n,e)},e.prototype.deactivateChildRoutes=function(e,t,n){var r=this,i=Ir(t);e.children.forEach(function(e){var t=e.value.outlet;r.deactivateRoutes(e,i[t],n),delete i[t]}),Kn(i,function(e,t){r.deactivateRouteAndItsChildren(e,n)})},e.prototype.deactivateRoutes=function(e,t,n){var r=e.value,i=t?t.value:null;if(r===i)if(r.component){var o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else i&&this.deactivateRouteAndItsChildren(t,n)},e.prototype.deactivateRouteAndItsChildren=function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)},e.prototype.detachAndStoreRouteSubtree=function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),i=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:i})}},e.prototype.deactivateRouteAndOutlet=function(e,t){var n=this,r=t.getContext(e.value.outlet);if(r){var i=Ir(e),o=e.value.component?r.children:t;Kn(i,function(e,t){return n.deactivateRouteAndItsChildren(e,o)}),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}},e.prototype.activateChildRoutes=function(e,t,n){var r=this,i=Ir(t);e.children.forEach(function(e){r.activateRoutes(e,i[e.value.outlet],n),r.forwardEvent(new kn(e.value.snapshot))}),e.children.length&&this.forwardEvent(new Fn(e.value.snapshot))},e.prototype.activateRoutes=function(e,t,n){var r=e.value,i=t?t.value:null;if(zr(r),r===i)if(r.component){var o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component)if(o=n.getOrCreateContext(r.outlet),this.routeReuseStrategy.shouldAttach(r.snapshot)){var a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),wi(a.route)}else{var s=function(e){for(var t=r.snapshot.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(),l=s?s.module.componentFactoryResolver:null;o.route=r,o.resolver=l,o.outlet&&o.outlet.activateWith(r,l),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,n)},e}();function wi(e){zr(e.value),e.children.forEach(wi)}var bi=function(){function e(e,t,n){var r=this;this.router=e,this.route=t,this.locationStrategy=n,this.commands=[],this.subscription=e.events.subscribe(function(e){e instanceof xn&&r.updateTargetUrlAndHref()})}return Object.defineProperty(e.prototype,"routerLink",{set:function(e){this.commands=null!=e?Array.isArray(e)?e:[e]:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preserveQueryParams",{set:function(e){Object(r.T)()&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead."),this.preserve=e},enumerable:!0,configurable:!0}),e.prototype.ngOnChanges=function(e){this.updateTargetUrlAndHref()},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.onClick=function(e,t,n,r){if(0!==e||t||n||r)return!0;if("string"==typeof this.target&&"_self"!=this.target)return!0;var i={skipLocationChange:Ei(this.skipLocationChange),replaceUrl:Ei(this.replaceUrl)};return this.router.navigateByUrl(this.urlTree,i),!1},e.prototype.updateTargetUrlAndHref=function(){this.href=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree))},Object.defineProperty(e.prototype,"urlTree",{get:function(){return this.router.createUrlTree(this.commands,{relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,preserveQueryParams:Ei(this.preserve),queryParamsHandling:this.queryParamsHandling,preserveFragment:Ei(this.preserveFragment)})},enumerable:!0,configurable:!0}),e}();function Ei(e){return""===e||!!e}var Si=function(){return function(){this.outlet=null,this.route=null,this.resolver=null,this.children=new xi,this.attachRef=null}}(),xi=function(){function e(){this.contexts=new Map}return e.prototype.onChildOutletCreated=function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)},e.prototype.onChildOutletDestroyed=function(e){var t=this.getContext(e);t&&(t.outlet=null)},e.prototype.onOutletDeactivated=function(){var e=this.contexts;return this.contexts=new Map,e},e.prototype.onOutletReAttached=function(e){this.contexts=e},e.prototype.getOrCreateContext=function(e){var t=this.getContext(e);return t||(t=new Si,this.contexts.set(e,t)),t},e.prototype.getContext=function(e){return this.contexts.get(e)||null},e}(),Ti=function(){function e(e,t,n,i,o){this.parentContexts=e,this.location=t,this.resolver=n,this.changeDetector=o,this.activated=null,this._activatedRoute=null,this.activateEvents=new r.m,this.deactivateEvents=new r.m,this.name=i||Vn,e.onChildOutletCreated(this.name,this)}return e.prototype.ngOnDestroy=function(){this.parentContexts.onChildOutletDestroyed(this.name)},e.prototype.ngOnInit=function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}},Object.defineProperty(e.prototype,"isActivated",{get:function(){return!!this.activated},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"component",{get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activatedRoute",{get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activatedRouteData",{get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}},enumerable:!0,configurable:!0}),e.prototype.detach=function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e},e.prototype.attach=function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)},e.prototype.deactivate=function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}},e.prototype.activateWith=function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,i=new Ai(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,i),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)},e}(),Ai=function(){function e(e,t,n){this.route=e,this.childContexts=t,this.parent=n}return e.prototype.get=function(e,t){return e===Nr?this.route:e===xi?this.childContexts:this.parent.get(e,t)},e}(),Pi=function(){},Di=function(){function e(){}return e.prototype.preload=function(e,t){return fe.call(t(),function(){return V(null)})},e}(),Mi=function(){function e(){}return e.prototype.preload=function(e,t){return V(null)},e}(),Ii=function(){function e(e,t,n,r,i){this.router=e,this.injector=r,this.preloadingStrategy=i,this.loader=new fi(t,n,function(t){return e.triggerEvent(new Rn(t))},function(t){return e.triggerEvent(new Nn(t))})}return e.prototype.setUpPreloading=function(){var e=this,t=bn.a.call(this.router.events,function(e){return e instanceof xn});this.subscription=U.call(t,function(){return e.preload()}).subscribe(function(){})},e.prototype.preload=function(){var e=this.injector.get(r.v);return this.processRoutes(e,this.router.config)},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.processRoutes=function(e,t){for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(o.loadChildren&&!o.canLoad&&o._loadedConfig){var a=o._loadedConfig;n.push(this.processRoutes(a.module,a.routes))}else o.loadChildren&&!o.canLoad?n.push(this.preloadConfig(e,o)):o.children&&n.push(this.processRoutes(e,o.children))}return De.call(le(n))},e.prototype.preloadConfig=function(e,t){var n=this;return this.preloadingStrategy.preload(t,function(){var r=n.loader.load(e.injector,t);return W.call(r,function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)})})},e}(),Oi=new r.o("ROUTER_CONFIGURATION"),Ri=new r.o("ROUTER_FORROOT_GUARD"),Ni=[h,{provide:or,useClass:ar},{provide:yi,useFactory:zi,deps:[r.g,or,xi,h,r.p,r.u,r.i,pi,Oi,[mi,new r.y],[hi,new r.y]]},xi,{provide:Nr,useFactory:Ui,deps:[yi]},{provide:r.u,useClass:r.H},Ii,Mi,Di,{provide:Oi,useValue:{enableTracing:!1}}];function Li(){return new r.w("Router",yi)}var Fi=function(){function e(e,t){}return e.forRoot=function(t,n){return{ngModule:e,providers:[Ni,Vi(t),{provide:Ri,useFactory:ki,deps:[[yi,new r.y,new r.G]]},{provide:Oi,useValue:n||{}},{provide:u,useFactory:Bi,deps:[s,[new r.n(c),new r.y],Oi]},{provide:Pi,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Mi},{provide:r.w,multi:!0,useFactory:Li},[Gi,{provide:r.d,multi:!0,useFactory:Wi,deps:[Gi]},{provide:ji,useFactory:Hi,deps:[Gi]},{provide:r.b,multi:!0,useExisting:ji}]]}},e.forChild=function(t){return{ngModule:e,providers:[Vi(t)]}},e}();function Bi(e,t,n){return void 0===n&&(n={}),n.useHash?new p(e,t):new f(e,t)}function ki(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function Vi(e){return[{provide:r.a,multi:!0,useValue:e},{provide:pi,multi:!0,useValue:e}]}function zi(e,t,n,r,i,o,a,s,l,u,c){void 0===l&&(l={});var h=new yi(null,t,n,r,i,o,a,Xn(s));if(u&&(h.urlHandlingStrategy=u),c&&(h.routeReuseStrategy=c),l.errorHandler&&(h.errorHandler=l.errorHandler),l.enableTracing){var d=ze();h.events.subscribe(function(e){d.logGroup("Router Event: "+e.constructor.name),d.log(e.toString()),d.log(e),d.logGroupEnd()})}return l.onSameUrlNavigation&&(h.onSameUrlNavigation=l.onSameUrlNavigation),h}function Ui(e){return e.routerState.root}var Gi=function(){function e(e){this.injector=e,this.initNavigation=!1,this.resultOfPreactivationDone=new B.a}return e.prototype.appInitializer=function(){var e=this;return this.injector.get(l,Promise.resolve(null)).then(function(){var t=null,n=new Promise(function(e){return t=e}),r=e.injector.get(yi),i=e.injector.get(Oi);if(e.isLegacyDisabled(i)||e.isLegacyEnabled(i))t(!0);else if("disabled"===i.initialNavigation)r.setUpLocationChangeListener(),t(!0);else{if("enabled"!==i.initialNavigation)throw new Error("Invalid initialNavigation options: '"+i.initialNavigation+"'");r.hooks.afterPreactivation=function(){return e.initNavigation?V(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()}return n})},e.prototype.bootstrapListener=function(e){var t=this.injector.get(Oi),n=this.injector.get(Ii),i=this.injector.get(yi),o=this.injector.get(r.g);e===o.components[0]&&(this.isLegacyEnabled(t)?i.initialNavigation():this.isLegacyDisabled(t)&&i.setUpLocationChangeListener(),n.setUpPreloading(),i.resetRootComponentType(o.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())},e.prototype.isLegacyEnabled=function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation},e.prototype.isLegacyDisabled=function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation},e}();function Wi(e){return e.appInitializer.bind(e)}function Hi(e){return e.bootstrapListener.bind(e)}var ji=new r.o("Router Initializer"),qi="[Developers] Get",Yi="[Developers] Fetch success",Xi="[Developers] Add",Zi=function(){return function(){this.type=qi,this.payload=null}}(),Ki=function(){return function(e){this.type=Xi,this.payload=e}}();n("8ofh"),n("NePw");var Qi=n("GTlS"),Ji=new(n("wclm").a)(Qi.a);n("3iOE");var $i=n("qLnt"),eo=function(){function e(e,t){this.dueTime=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new to(e,this.dueTime,this.scheduler))},e}(),to=function(e){function t(t,n,r){e.call(this,t),this.dueTime=n,this.scheduler=r,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}return Object(a.c)(t,e),t.prototype._next=function(e){this.clearDebounce(),this.lastValue=e,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(no,this.dueTime,this))},t.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},t.prototype.debouncedNext=function(){this.clearDebounce(),this.hasValue&&(this.destination.next(this.lastValue),this.lastValue=null,this.hasValue=!1)},t.prototype.clearDebounce=function(){var e=this.debouncedSubscription;null!==e&&(this.remove(e),e.unsubscribe(),this.debouncedSubscription=null)},t}(ge.a);function no(e){e.debouncedNext()}var ro=n("PAZ8"),io=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new oo(e))},e}(),oo=function(e){function t(t){e.call(this,t)}return Object(a.c)(t,e),t.prototype._next=function(e){e.observe(this.destination)},t}(ge.a),ao=n("GI3C"),so=function(){function e(e,t){this.project=e,this.resultSelector=t}return e.prototype.call=function(e,t){return t.subscribe(new lo(e,this.project,this.resultSelector))},e}(),lo=function(e){function t(t,n,r){e.call(this,t),this.project=n,this.resultSelector=r,this.hasSubscription=!1,this.hasCompleted=!1,this.index=0}return Object(a.c)(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t=this.index++,n=this.destination;try{var r=this.project(e,t);this.hasSubscription=!0,this.add(Object(ce.a)(this,r,e,t))}catch(e){n.error(e)}},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){var o=this.destination;this.resultSelector?this.trySelectResult(e,t,n,r):o.next(t)},t.prototype.trySelectResult=function(e,t,n,r){var i=this.resultSelector,o=this.destination;try{var a=i(e,t,n,r);o.next(a)}catch(e){o.error(e)}},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.remove(e),this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(ue.a);n("LaOa");var uo=function(){function e(){this.size=0,this._values=[],this._keys=[]}return e.prototype.get=function(e){var t=this._keys.indexOf(e);return-1===t?void 0:this._values[t]},e.prototype.set=function(e,t){var n=this._keys.indexOf(e);return-1===n?(this._keys.push(e),this._values.push(t),this.size++):this._values[n]=t,this},e.prototype.delete=function(e){var t=this._keys.indexOf(e);return-1!==t&&(this._values.splice(t,1),this._keys.splice(t,1),this.size--,!0)},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this.size=0},e.prototype.forEach=function(e,t){for(var n=0;n<this.size;n++)e.call(t,this._values[n],this._keys[n])},e}(),co=X.a.Map||function(){return uo}(),ho=function(){function e(){this.values={}}return e.prototype.delete=function(e){return this.values[e]=null,!0},e.prototype.set=function(e,t){return this.values[e]=t,this},e.prototype.get=function(e){return this.values[e]},e.prototype.forEach=function(e,t){var n=this.values;for(var r in n)n.hasOwnProperty(r)&&null!==n[r]&&e.call(t,n[r],r)},e.prototype.clear=function(){this.values={}},e}(),po=function(){function e(e,t,n,r){this.keySelector=e,this.elementSelector=t,this.durationSelector=n,this.subjectSelector=r}return e.prototype.call=function(e,t){return t.subscribe(new fo(e,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},e}(),fo=function(e){function t(t,n,r,i,o){e.call(this,t),this.keySelector=n,this.elementSelector=r,this.durationSelector=i,this.subjectSelector=o,this.groups=null,this.attemptedToUnsubscribe=!1,this.count=0}return Object(a.c)(t,e),t.prototype._next=function(e){var t;try{t=this.keySelector(e)}catch(e){return void this.error(e)}this._group(e,t)},t.prototype._group=function(e,t){var n=this.groups;n||(n=this.groups="string"==typeof t?new ho:new co);var r,i=n.get(t);if(this.elementSelector)try{r=this.elementSelector(e)}catch(e){this.error(e)}else r=e;if(!i){i=this.subjectSelector?this.subjectSelector():new B.a,n.set(t,i);var o=new _o(t,i,this);if(this.destination.next(o),this.durationSelector){var a=void 0;try{a=this.durationSelector(new _o(t,i))}catch(e){return void this.error(e)}this.add(a.subscribe(new mo(t,i,this)))}}i.closed||i.next(r)},t.prototype._error=function(e){var t=this.groups;t&&(t.forEach(function(t,n){t.error(e)}),t.clear()),this.destination.error(e)},t.prototype._complete=function(){var e=this.groups;e&&(e.forEach(function(e,t){e.complete()}),e.clear()),this.destination.complete()},t.prototype.removeGroup=function(e){this.groups.delete(e)},t.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&e.prototype.unsubscribe.call(this))},t}(ge.a),mo=function(e){function t(t,n,r){e.call(this,n),this.key=t,this.group=n,this.parent=r}return Object(a.c)(t,e),t.prototype._next=function(e){this.complete()},t.prototype._unsubscribe=function(){var e=this.parent,t=this.key;this.key=this.parent=null,e&&e.removeGroup(t)},t}(ge.a),_o=function(e){function t(t,n,r){e.call(this),this.key=t,this.groupSubject=n,this.refCountSubscription=r}return Object(a.c)(t,e),t.prototype._subscribe=function(e){var t=new $i.a,n=this.refCountSubscription,r=this.groupSubject;return n&&!n.closed&&t.add(new go(n)),t.add(r.subscribe(e)),t},t}(H.a),go=function(e){function t(t){e.call(this),this.parent=t,t.count++}return Object(a.c)(t,e),t.prototype.unsubscribe=function(){var t=this.parent;t.closed||this.closed||(e.prototype.unsubscribe.call(this),t.count-=1,0===t.count&&t.attemptedToUnsubscribe&&t.unsubscribe())},t}($i.a),vo=n("PR+T"),yo=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new Co(e))},e}(),Co=function(e){function t(){e.apply(this,arguments)}return Object(a.c)(t,e),t.prototype._next=function(e){Object(vo.a)()},t}(ge.a);n("qqDE");var wo=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new bo(e))},e}(),bo=function(e){function t(t){e.call(this,t)}return Object(a.c)(t,e),t.prototype._next=function(e){this.destination.next(ro.a.createNext(e))},t.prototype._error=function(e){var t=this.destination;t.next(ro.a.createError(e)),t.complete()},t.prototype._complete=function(){var e=this.destination;e.next(ro.a.createComplete()),e.complete()},t}(ge.a);n("8Gud"),n("LHF8"),n("JHvW"),n("5q5V"),n("RWQz"),n("eIqN"),n("aqAJ");var Eo=n("5jKg");n("ltvI");var So=n("5O0w"),xo=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new To(e,this.nextOrObserver,this.error,this.complete))},e}(),To=function(e){function t(t,n,r,i){e.call(this,t);var o=new ge.a(n,r,i);o.syncErrorThrowable=!0,this.add(o),this.safeSubscriber=o}return Object(a.c)(t,e),t.prototype._next=function(e){var t=this.safeSubscriber;t.next(e),t.syncErrorThrown?this.destination.error(t.syncErrorValue):this.destination.next(e)},t.prototype._error=function(e){var t=this.safeSubscriber;t.error(e),this.destination.error(t.syncErrorThrown?t.syncErrorValue:e)},t.prototype._complete=function(){var e=this.safeSubscriber;e.complete(),e.syncErrorThrown?this.destination.error(e.syncErrorValue):this.destination.complete()},t}(ge.a);Error,n("Dxsx");var Ao=function(){function e(e,t,n){var r=this;this.developerService=e,this.messeagesService=t,this.store=n,this.unsubscribe=new B.a,this.message$=this.store.select("developers"),this.message$.subscribe(function(e){r.res=e.status,console.log(e)})}return e.prototype.ngOnInit=function(){var e=this;this.store.dispatch(new Zi),this.developerService.getDevelopers().pipe(Object(So.a)(this.unsubscribe)).subscribe(function(t){return e.developers=t})},e.prototype.add=function(e){(e=e.trim())&&(this.developerToAdd={name:e,location:{name:"Tel Aviv",latitude:32.0852999,longitude:34.78176759999997}},this.store.dispatch(new Ki(this.developerToAdd)),this.developerService.addDeveloper(this.developerToAdd).subscribe(function(e){console.log(e)}))},e.prototype.delete=function(e){this.developers=this.developers.filter(function(t){return t!==e}),this.developerService.deleteDeveloper(e).subscribe()},e.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},e}(),Po=[{id:1,name:"Shai",location:{name:"Paris Office",longitude:2.3522219000000177,latitude:48.856614}},{id:2,name:"Shai2",location:{name:"Madrid Office",longitude:-3.7037901999999576,latitude:40.4167754}},{id:3,name:"Shai3",location:{name:"London's Office",longitude:-.12775829999998223,latitude:51.5073509}},{id:4,name:"shai4",location:{name:"Tel Aviv's Office",longitude:34.78176759999997,latitude:32.0852999}},{id:5,name:"shai5",location:{name:"Rome's Office",longitude:12.496365500000024,latitude:41.9027835}},{id:6,name:"shai6",location:{name:"Moscow's Office",longitude:37.617299900000035,latitude:55.755826}},{id:7,name:"shai7",location:{name:"Manchester's Office",longitude:-2.2426305000000184,latitude:53.4807593}},{id:8,name:"shai8",location:{name:"Barcelona's Office",longitude:2.1734034999999494,latitude:41.3850639}}],Do=function(){function e(e){this.messeagesService=e,this.developersUrl="api/heroes"}return e.prototype.getDevelopers=function(){return this.log("getDevelopers"),V(Po)},e.prototype.getDeveloper=function(e){var t,n=this;return V(Po.find(function(t){return t.id===e})).pipe((t=function(t){return n.log("updated developer id = "+e)},function(e){return e.lift(new xo(t,void 0,void 0))}))},e.prototype.updateDeveloper=function(e){this.log("updateDeveloper with id="+e.id);var t=Po.findIndex(function(t){return t.id===e.id});return Po.splice(t,1,e),V(Po)},e.prototype.addDeveloper=function(e){var t=Math.max.apply(Math,Po.map(function(e){return e.id}))+1;return console.log("id:"+t),this.log("addDeveloper with id="+t),e.id=t,Po.push(e),V(e)},e.prototype.deleteDeveloper=function(e){this.log("deleteDeveloper with id="+e.id);var t=Po.findIndex(function(t){return t.id===e.id});return Po.splice(t,1),V(e)},e.prototype.searchDevelopers=function(e){var t;return t=Po.filter(function(t){return t.name.includes(e)}),V(t)},e.prototype.log=function(e){this.messeagesService.add("DeveloperService"+e)},e.prototype.handleError=function(e,t){var n=this;return void 0===e&&(e="operation"),function(r){return console.error(r),n.log(e+" failed: "+r.message),V(t)}},e}(),Mo=function(){function e(){this.messages=[]}return e.prototype.add=function(e){this.messages.push({title:e})},e.prototype.clear=function(){this.messages=[]},e}(),Io=n("ADVA"),Oo=r._1({encapsulation:0,styles:[[".selected[_ngcontent-%COMP%]{background-color:#eee!important;color:#fff}.developers[_ngcontent-%COMP%]{margin:1em 0 2em 0;list-style-type:none;padding:0;width:15em}#developers[_ngcontent-%COMP%]{display:inline-block;border:2px solid #eee;\n  width:48%;position:absolute;top:10em;left:0;min-height:30%;padding:3px;margin-left:5px;background-color:#ddd}#developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#cfd8dc;cursor:pointer}#developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:3px;height:30px;border-color:transparent;background:transparent}#developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}#developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], #developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, #developers[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}#developers[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{display:inline-block;line-height:1em;position:relative;left:-1px;top:0;font-size:15px;padding-right:10px;font-weight:700}#developers[_ngcontent-%COMP%]   .developer-name[_ngcontent-%COMP%]{display:inline-block;min-width:90px}"]],data:{}});function Ro(e){return r._25(0,[(e()(),r._3(0,0,null,null,19,"li",[],[[2,"selected",null]],null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(2,0,null,null,11,"span",[["class","developer-name"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n       "])),(e()(),r._3(4,0,null,null,8,"button",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(6,0,null,null,5,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==r._16(e,7).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&i),i},null,null)),r._2(7,671744,null,0,bi,[yi,Nr,u],{routerLink:[0,"routerLink"]},null),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(9,0,null,null,1,"span",[["class","badge"]],null,null,null,null,null)),(e()(),r._23(10,null,["",""])),(e()(),r._23(11,null,["","\n    "])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(15,0,null,null,3,"button",[["class","delete"],["title","delete developer"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.delete(e.context.$implicit)&&r),r},null,null)),(e()(),r._3(16,0,null,null,2,"span",[],null,null,null,null,null)),(e()(),r._3(17,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-trash-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n    "]))],function(e,t){e(t,7,0,r._6(1,"/detail/",t.context.$implicit.id,""))},function(e,t){e(t,0,0,t.context.$implicit===t.component.selectedDeveloper),e(t,6,0,r._16(t,7).target,r._16(t,7).href),e(t,10,0,t.context.$implicit.id),e(t,11,0,t.context.$implicit.name)})}function No(e){return r._25(0,[(e()(),r._3(0,0,null,null,23,"div",[["id","developers"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(2,0,null,null,4,"ul",[["class","developers"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r.Y(16777216,null,null,1,null,Ro)),r._2(5,802816,null,0,E,[r.M,r.J,r.q],{ngForOf:[0,"ngForOf"]},null),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n\n  "])),(e()(),r._3(8,0,null,null,12,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(10,0,null,null,2,"label",[],null,null,null,null,null)),(e()(),r._23(-1,null,["add developer "])),(e()(),r._3(12,0,[["developerName",1]],null,0,"input",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(14,0,null,null,5,"button",[["type","button"]],null,[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(e.component.add(r._16(e,12).value),i=!1!==(r._16(e,12).value="")&&i),i},null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(16,0,null,null,2,"span",[],[[4,"color",null]],null,null,null,null)),(e()(),r._3(17,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-plus-square"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n\n\n"]))],function(e,t){e(t,5,0,t.component.developers)},function(e,t){e(t,16,0,"blue")})}var Lo=r.Z("app-developers",Ao,function(e){return r._25(0,[(e()(),r._3(0,0,null,null,1,"app-developers",[],null,null,null,No,Oo)),r._2(1,245760,null,0,Ao,[Do,Mo,Io.m],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),Fo=function(){function e(e){this.developerService=e,this.searchTerms=new B.a}return e.prototype.search=function(e){this.searchTerms.next(e)},e.prototype.ngOnInit=function(){var e,t=this;this.developers$=this.searchTerms.pipe((void 0===e&&(e=Ji),function(t){return t.lift(new eo(300,e))}),Object(ao.a)(),Object(Eo.a)(function(e){return t.developerService.searchDevelopers(e)}))},e}(),Bo=r._1({encapsulation:0,styles:[[".search-result[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{border-bottom:1px solid gray;border-left:1px solid gray;border-right:1px solid gray;width:195px;height:16px;padding:5px;background-color:#fff;cursor:pointer;list-style-type:none}.search-result[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#607d8b}.search-result[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#888;display:block;text-decoration:none}.search-result[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, .search-result[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#fff}#search-box[_ngcontent-%COMP%]{width:200px;height:20px}ul.search-result[_ngcontent-%COMP%]{margin-top:0;padding-left:0}"]],data:{}});function ko(e){return r._25(0,[(e()(),r._3(0,0,null,null,5,"li",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(2,0,null,null,2,"a",[],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==r._16(e,3).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&i),i},null,null)),r._2(3,671744,null,0,bi,[yi,Nr,u],{routerLink:[0,"routerLink"]},null),(e()(),r._23(4,null,["\n        ","\n      "])),(e()(),r._23(-1,null,["\n    "]))],function(e,t){e(t,3,0,r._6(1,"/detail/",t.context.$implicit.id,""))},function(e,t){e(t,2,0,r._16(t,3).target,r._16(t,3).href),e(t,4,0,t.context.$implicit.name)})}function Vo(e){return r._25(0,[(e()(),r._3(0,0,null,null,13,"div",[["id","search-component"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(2,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),r._23(-1,null,["Hero Search"])),(e()(),r._23(-1,null,["\n\n  "])),(e()(),r._3(5,0,[["searchBox",1]],null,0,"input",[["id","search-box"]],null,[[null,"keyup"]],function(e,t,n){var i=!0;return"keyup"===t&&(i=!1!==e.component.search(r._16(e,5).value)&&i),i},null,null)),(e()(),r._23(-1,null,["\n\n  "])),(e()(),r._3(7,0,null,null,5,"ul",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r.Y(16777216,null,null,2,null,ko)),r._2(10,802816,null,0,E,[r.M,r.J,r.q],{ngForOf:[0,"ngForOf"]},null),r._17(131072,O,[r.h]),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,10,0,r._24(t,10,0,r._16(t,11).transform(n.developers$)))},null)}var zo=function(){function e(e){this.developerService=e,this.developers=[],this.unSubscribe=new B.a}return e.prototype.ngOnInit=function(){this.getHeroes()},e.prototype.getHeroes=function(){var e=this;this.developerService.getDevelopers().pipe(Object(So.a)(this.unSubscribe)).subscribe(function(t){return e.developers=t.slice(1,5)})},e.prototype.search=function(e){var t=this;this.developerService.searchDevelopers(e).subscribe(function(e){return t.developers=e})},e.prototype.ngOnDestroy=function(){this.unSubscribe.next(),this.unSubscribe.complete()},e}(),Uo=r._1({encapsulation:0,styles:[["#dashboard[_ngcontent-%COMP%]{display:inline-block;border:2px solid #eee;\n  width:48%;position:absolute;top:10em;left:0;height:30%;padding:3px;margin-left:5px;background-color:#ddd}#dashboard[_ngcontent-%COMP%]   .developer-box[_ngcontent-%COMP%]{padding:20px;\n    color:#eee;\n    min-width:55px;background-color:#607d8b;border-radius:2px;height:0;width:10px;margin-right:5px;display:inline-block;text-align:center}#dashboard[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}"]],data:{}});function Go(e){return r._25(0,[(e()(),r._3(0,0,null,null,8,"a",[["class","developer-link col-1-4"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==r._16(e,1).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&i),i},null,null)),r._2(1,671744,null,0,bi,[yi,Nr,u],{routerLink:[0,"routerLink"]},null),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(3,0,null,null,4,"div",[["class","developer-box"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(5,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r._23(6,null,["",""])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "]))],function(e,t){e(t,1,0,r._6(1,"/detail/",t.context.$implicit.id,""))},function(e,t){e(t,0,0,r._16(t,1).target,r._16(t,1).href),e(t,6,0,t.context.$implicit.name)})}function Wo(e){return r._25(2,[(e()(),r._3(0,0,null,null,10,"div",[["class","content"],["id","dashboard"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(2,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),r._23(-1,null,["Top Developer"])),(e()(),r._23(-1,null,["\n  "])),(e()(),r.Y(16777216,null,null,1,null,Go)),r._2(6,802816,null,0,E,[r.M,r.J,r.q],{ngForOf:[0,"ngForOf"]},null),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(8,0,null,null,1,"app-developer-search",[],null,null,null,Vo,Bo)),r._2(9,114688,null,0,Fo,[Do],null,null),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n\n\n"]))],function(e,t){e(t,6,0,t.component.developers),e(t,9,0)},null)}var Ho=r.Z("app-dashboard",zo,function(e){return r._25(0,[(e()(),r._3(0,0,null,null,2,"app-dashboard",[],null,null,null,Wo,Uo)),r._20(512,null,Do,Do,[Mo]),r._2(2,245760,null,0,zo,[Do],null,null)],function(e,t){e(t,2,0)},null)},{},{},[]),jo=function(e){function t(t,n){e.call(this),this.sources=t,this.resultSelector=n}return Object(a.c)(t,e),t.create=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];if(null===e||0===arguments.length)return new ie.a;var r=null;return"function"==typeof e[e.length-1]&&(r=e.pop()),1===e.length&&Object(j.a)(e[0])&&(e=e[0]),0===e.length?new ie.a:new t(e,r)},t.prototype._subscribe=function(e){return new qo(e,this.sources,this.resultSelector)},t}(H.a),qo=function(e){function t(t,n,r){e.call(this,t),this.sources=n,this.resultSelector=r,this.completed=0,this.haveValues=0;var i=n.length;this.total=i,this.values=new Array(i);for(var o=0;o<i;o++){var a=n[o],s=Object(ce.a)(this,a,null,o);s&&(s.outerIndex=o,this.add(s))}}return Object(a.c)(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.values[n]=t,i._hasValue||(i._hasValue=!0,this.haveValues++)},t.prototype.notifyComplete=function(e){var t=this.destination,n=this.haveValues,r=this.resultSelector,i=this.values,o=i.length;if(e._hasValue){if(this.completed++,this.completed===o){if(n===o){var a=r?r.apply(this,i):i;t.next(a)}t.complete()}}else t.complete()},t}(ue.a),Yo=jo.create,Xo=function(){function e(){}return Object.defineProperty(e.prototype,"value",{get:function(){return this.control?this.control.value:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valid",{get:function(){return this.control?this.control.valid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"invalid",{get:function(){return this.control?this.control.invalid:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pending",{get:function(){return this.control?this.control.pending:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.control?this.control.disabled:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.control?this.control.enabled:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errors",{get:function(){return this.control?this.control.errors:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pristine",{get:function(){return this.control?this.control.pristine:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dirty",{get:function(){return this.control?this.control.dirty:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"touched",{get:function(){return this.control?this.control.touched:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.control?this.control.status:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"untouched",{get:function(){return this.control?this.control.untouched:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"statusChanges",{get:function(){return this.control?this.control.statusChanges:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueChanges",{get:function(){return this.control?this.control.valueChanges:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.reset=function(e){void 0===e&&(e=void 0),this.control&&this.control.reset(e)},e.prototype.hasError=function(e,t){return!!this.control&&this.control.hasError(e,t)},e.prototype.getError=function(e,t){return this.control?this.control.getError(e,t):null},e}(),Zo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),Object.defineProperty(t.prototype,"formDirective",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return null},enumerable:!0,configurable:!0}),t}(Xo);function Ko(e){return null==e||0===e.length}var Qo=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,Jo=function(){function e(){}return e.min=function(e){return function(t){if(Ko(t.value)||Ko(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}},e.max=function(e){return function(t){if(Ko(t.value)||Ko(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}},e.required=function(e){return Ko(e.value)?{required:!0}:null},e.requiredTrue=function(e){return!0===e.value?null:{required:!0}},e.email=function(e){return Qo.test(e.value)?null:{email:!0}},e.minLength=function(e){return function(t){if(Ko(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}},e.maxLength=function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}},e.pattern=function(t){return t?("string"==typeof t?(r="^"+t+"$",n=new RegExp(r)):(r=t.toString(),n=t),function(e){if(Ko(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:r,actualValue:t}}}):e.nullValidator;var n,r},e.nullValidator=function(e){return null},e.compose=function(e){if(!e)return null;var t=e.filter($o);return 0==t.length?null:function(e){return ta((n=e,t.map(function(e){return e(n)})));var n}},e.composeAsync=function(e){if(!e)return null;var t=e.filter($o);return 0==t.length?null:function(e){var n,r,i=(n=e,r=t,r.map(function(e){return e(n)})).map(ea);return G.a.call(Yo(i),ta)}},e}();function $o(e){return null!=e}function ea(e){var t=Object(r._9)(e)?be(e):e;if(!Object(r._8)(t))throw new Error("Expected validator to return Promise or Observable.");return t}function ta(e){var t=e.reduce(function(e,t){return null!=t?Object(a.a)({},e,t):e},{});return 0===Object.keys(t).length?null:t}var na=new r.o("NgValueAccessor"),ra=function(){function e(e,t){this._renderer=e,this._elementRef=t,this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.writeValue=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e}(),ia=new r.o("CompositionEventMode"),oa=function(){function e(e,t,n){var r;this._renderer=e,this._elementRef=t,this._compositionMode=n,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(r=ze()?ze().getUserAgent():"",!/android (\d+)/.test(r.toLowerCase())))}return e.prototype.writeValue=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e.prototype._handleInput=function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)},e.prototype._compositionStart=function(){this._composing=!0},e.prototype._compositionEnd=function(e){this._composing=!1,this._compositionMode&&this.onChange(e)},e}();function aa(e){return e.validate?function(t){return e.validate(t)}:e}function sa(e){return e.validate?function(t){return e.validate(t)}:e}var la=function(){function e(e,t){this._renderer=e,this._elementRef=t,this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.writeValue=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)},e.prototype.registerOnChange=function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e}();function ua(){throw new Error("unimplemented")}var ca=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._parent=null,t.name=null,t.valueAccessor=null,t._rawValidators=[],t._rawAsyncValidators=[],t}return Object(a.c)(t,e),Object.defineProperty(t.prototype,"validator",{get:function(){return ua()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"asyncValidator",{get:function(){return ua()},enumerable:!0,configurable:!0}),t}(Xo),ha=function(){function e(){this._accessors=[]}return e.prototype.add=function(e,t){this._accessors.push([e,t])},e.prototype.remove=function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)},e.prototype.select=function(e){var t=this;this._accessors.forEach(function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)})},e.prototype._isSameGroup=function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name},e}(),da=function(){function e(e,t,n,r){this._renderer=e,this._elementRef=t,this._registry=n,this._injector=r,this.onChange=function(){},this.onTouched=function(){}}return e.prototype.ngOnInit=function(){this._control=this._injector.get(ca),this._checkName(),this._registry.add(this._control,this)},e.prototype.ngOnDestroy=function(){this._registry.remove(this)},e.prototype.writeValue=function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)},e.prototype.registerOnChange=function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}},e.prototype.fireUncheck=function(e){this.writeValue(e)},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e.prototype._checkName=function(){this.name&&this.formControlName&&this.name!==this.formControlName&&this._throwNameError(),!this.name&&this.formControlName&&(this.name=this.formControlName)},e.prototype._throwNameError=function(){throw new Error('\n      If you define both a name and a formControlName attribute on your radio button, their values\n      must match. Ex: <input type="radio" formControlName="food" name="food">\n    ')},e}();function pa(e,t){return t.path.concat([e])}function fa(e,t){var n,r,i,o,a;e||_a(t,"Cannot find control with"),t.valueAccessor||_a(t,"No value accessor for form control with"),e.validator=Jo.compose([e.validator,t.validator]),e.asyncValidator=Jo.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),n=e,(r=t).valueAccessor.registerOnChange(function(e){n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&ma(n,r)}),i=t,e.registerOnChange(function(e,t){i.valueAccessor.writeValue(e),t&&i.viewToModelUpdate(e)}),o=e,(a=t).valueAccessor.registerOnTouched(function(){o._pendingTouched=!0,"blur"===o.updateOn&&o._pendingChange&&ma(o,a),"submit"!==o.updateOn&&o.markAsTouched()}),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange(function(e){t.valueAccessor.setDisabledState(e)}),t._rawValidators.forEach(function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(function(){return e.updateValueAndValidity()})}),t._rawAsyncValidators.forEach(function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange(function(){return e.updateValueAndValidity()})})}function ma(e,t){t.viewToModelUpdate(e._pendingValue),e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),e._pendingChange=!1}function _a(e,t){var n;throw n=e.path.length>1?"path: '"+e.path.join(" -> ")+"'":e.path[0]?"name: '"+e.path+"'":"unspecified name attribute",new Error(t+" "+n)}function ga(e){return null!=e?Jo.compose(e.map(aa)):null}function va(e){return null!=e?Jo.composeAsync(e.map(sa)):null}var ya=[ra,function(){function e(e,t){this._renderer=e,this._elementRef=t,this.onChange=function(e){},this.onTouched=function(){}}return e.prototype.writeValue=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))},e.prototype.registerOnChange=function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e}(),la,function(){function e(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=r._12}return Object.defineProperty(e.prototype,"compareWith",{set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n,r,i=(r=e,null==(n=t)?""+r:(r&&"object"==typeof r&&(r="Object"),(n+": "+r).slice(0,50)));this._renderer.setProperty(this._elementRef.nativeElement,"value",i)},e.prototype.registerOnChange=function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e.prototype._registerOption=function(){return(this._idCounter++).toString()},e.prototype._getOptionId=function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r),e))return r}return null},e.prototype._getOptionValue=function(e){var t=e.split(":")[0];return this._optionMap.has(t)?this._optionMap.get(t):e},e}(),function(){function e(e,t){this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=function(e){},this.onTouched=function(){},this._compareWith=r._12}return Object.defineProperty(e.prototype,"compareWith",{set:function(e){if("function"!=typeof e)throw new Error("compareWith must be a function, but received "+JSON.stringify(e));this._compareWith=e},enumerable:!0,configurable:!0}),e.prototype.writeValue=function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var r=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(r.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)},e.prototype.registerOnChange=function(e){var t=this;this.onChange=function(n){var r=[];if(n.hasOwnProperty("selectedOptions"))for(var i=n.selectedOptions,o=0;o<i.length;o++){var a=i.item(o),s=t._getOptionValue(a.value);r.push(s)}else for(i=n.options,o=0;o<i.length;o++)(a=i.item(o)).selected&&(s=t._getOptionValue(a.value),r.push(s));t.value=r,e(r)}},e.prototype.registerOnTouched=function(e){this.onTouched=e},e.prototype.setDisabledState=function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)},e.prototype._registerOption=function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t},e.prototype._getOptionId=function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var r=n[t];if(this._compareWith(this._optionMap.get(r)._value,e))return r}return null},e.prototype._getOptionValue=function(e){var t=e.split(":")[0];return this._optionMap.has(t)?this._optionMap.get(t)._value:e},e}(),da],Ca=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.c)(t,e),t.prototype.ngOnInit=function(){this._checkParentType(),this.formDirective.addFormGroup(this)},t.prototype.ngOnDestroy=function(){this.formDirective&&this.formDirective.removeFormGroup(this)},Object.defineProperty(t.prototype,"control",{get:function(){return this.formDirective.getFormGroup(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return pa(this.name,this._parent)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formDirective",{get:function(){return this._parent?this._parent.formDirective:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validator",{get:function(){return ga(this._validators)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"asyncValidator",{get:function(){return va(this._asyncValidators)},enumerable:!0,configurable:!0}),t.prototype._checkParentType=function(){},t}(Zo),wa=function(e){function t(t){return e.call(this,t)||this}return Object(a.c)(t,e),t}(function(){function e(e){this._cd=e}return Object.defineProperty(e.prototype,"ngClassUntouched",{get:function(){return!!this._cd.control&&this._cd.control.untouched},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassTouched",{get:function(){return!!this._cd.control&&this._cd.control.touched},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassPristine",{get:function(){return!!this._cd.control&&this._cd.control.pristine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassDirty",{get:function(){return!!this._cd.control&&this._cd.control.dirty},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassValid",{get:function(){return!!this._cd.control&&this._cd.control.valid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassInvalid",{get:function(){return!!this._cd.control&&this._cd.control.invalid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ngClassPending",{get:function(){return!!this._cd.control&&this._cd.control.pending},enumerable:!0,configurable:!0}),e}()),ba="PENDING",Ea="DISABLED";function Sa(e){var t=Ta(e)?e.validators:e;return Array.isArray(t)?ga(t):t||null}function xa(e,t){var n=Ta(t)?t.asyncValidators:e;return Array.isArray(n)?va(n):n||null}function Ta(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var Aa=function(){function e(e,t){this.validator=e,this.asyncValidator=t,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valid",{get:function(){return"VALID"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"invalid",{get:function(){return"INVALID"===this.status},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pending",{get:function(){return this.status==ba},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this.status===Ea},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this.status!==Ea},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dirty",{get:function(){return!this.pristine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"untouched",{get:function(){return!this.touched},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updateOn",{get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"},enumerable:!0,configurable:!0}),e.prototype.setValidators=function(e){this.validator=Sa(e)},e.prototype.setAsyncValidators=function(e){this.asyncValidator=xa(e)},e.prototype.clearValidators=function(){this.validator=null},e.prototype.clearAsyncValidators=function(){this.asyncValidator=null},e.prototype.markAsTouched=function(e){void 0===e&&(e={}),this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)},e.prototype.markAsUntouched=function(e){void 0===e&&(e={}),this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)},e.prototype.markAsDirty=function(e){void 0===e&&(e={}),this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)},e.prototype.markAsPristine=function(e){void 0===e&&(e={}),this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)},e.prototype.markAsPending=function(e){void 0===e&&(e={}),this.status=ba,this._parent&&!e.onlySelf&&this._parent.markAsPending(e)},e.prototype.disable=function(e){void 0===e&&(e={}),this.status=Ea,this.errors=null,this._forEachChild(function(e){e.disable({onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(!!e.onlySelf),this._onDisabledChange.forEach(function(e){return e(!0)})},e.prototype.enable=function(e){void 0===e&&(e={}),this.status="VALID",this._forEachChild(function(e){e.enable({onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(!!e.onlySelf),this._onDisabledChange.forEach(function(e){return e(!1)})},e.prototype._updateAncestors=function(e){this._parent&&!e&&(this._parent.updateValueAndValidity(),this._parent._updatePristine(),this._parent._updateTouched())},e.prototype.setParent=function(e){this._parent=e},e.prototype.updateValueAndValidity=function(e){void 0===e&&(e={}),this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&this.status!==ba||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)},e.prototype._updateTreeValidity=function(e){void 0===e&&(e={emitEvent:!0}),this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})},e.prototype._setInitialStatus=function(){this.status=this._allControlsDisabled()?Ea:"VALID"},e.prototype._runValidator=function(){return this.validator?this.validator(this):null},e.prototype._runAsyncValidator=function(e){var t=this;if(this.asyncValidator){this.status=ba;var n=ea(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){return t.setErrors(n,{emitEvent:e})})}},e.prototype._cancelExistingSubscription=function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()},e.prototype.setErrors=function(e,t){void 0===t&&(t={}),this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)},e.prototype.get=function(e){return null==(t=e)?null:(t instanceof Array||(t=t.split(".")),t instanceof Array&&0===t.length?null:t.reduce(function(e,t){return e instanceof Da?e.controls[t]||null:e instanceof Ma?e.at(t)||null:null},this));var t},e.prototype.getError=function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null},e.prototype.hasError=function(e,t){return!!this.getError(e,t)},Object.defineProperty(e.prototype,"root",{get:function(){for(var e=this;e._parent;)e=e._parent;return e},enumerable:!0,configurable:!0}),e.prototype._updateControlsErrors=function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)},e.prototype._initObservables=function(){this.valueChanges=new r.m,this.statusChanges=new r.m},e.prototype._calculateStatus=function(){return this._allControlsDisabled()?Ea:this.errors?"INVALID":this._anyControlsHaveStatus(ba)?ba:this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"},e.prototype._anyControlsHaveStatus=function(e){return this._anyControls(function(t){return t.status===e})},e.prototype._anyControlsDirty=function(){return this._anyControls(function(e){return e.dirty})},e.prototype._anyControlsTouched=function(){return this._anyControls(function(e){return e.touched})},e.prototype._updatePristine=function(e){void 0===e&&(e={}),this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)},e.prototype._updateTouched=function(e){void 0===e&&(e={}),this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)},e.prototype._isBoxedValue=function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e},e.prototype._registerOnCollectionChange=function(e){this._onCollectionChange=e},e.prototype._setUpdateStrategy=function(e){Ta(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)},e}(),Pa=function(e){function t(t,n,r){void 0===t&&(t=null);var i=e.call(this,Sa(n),xa(r,n))||this;return i._onChange=[],i._applyFormState(t),i._setUpdateStrategy(n),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i._initObservables(),i}return Object(a.c)(t,e),t.prototype.setValue=function(e,t){var n=this;void 0===t&&(t={}),this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(function(e){return e(n.value,!1!==t.emitViewToModelChange)}),this.updateValueAndValidity(t)},t.prototype.patchValue=function(e,t){void 0===t&&(t={}),this.setValue(e,t)},t.prototype.reset=function(e,t){void 0===e&&(e=null),void 0===t&&(t={}),this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1},t.prototype._updateValue=function(){},t.prototype._anyControls=function(e){return!1},t.prototype._allControlsDisabled=function(){return this.disabled},t.prototype.registerOnChange=function(e){this._onChange.push(e)},t.prototype._clearChangeFns=function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}},t.prototype.registerOnDisabledChange=function(e){this._onDisabledChange.push(e)},t.prototype._forEachChild=function(e){},t.prototype._syncPendingControls=function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))},t.prototype._applyFormState=function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e},t}(Aa),Da=function(e){function t(t,n,r){var i=e.call(this,Sa(n),xa(r,n))||this;return i.controls=t,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return Object(a.c)(t,e),t.prototype.registerControl=function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)},t.prototype.addControl=function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.removeControl=function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.setControl=function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.contains=function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled},t.prototype.setValue=function(e,t){var n=this;void 0===t&&(t={}),this._checkAllValuesPresent(e),Object.keys(e).forEach(function(r){n._throwIfControlMissing(r),n.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)},t.prototype.patchValue=function(e,t){var n=this;void 0===t&&(t={}),Object.keys(e).forEach(function(r){n.controls[r]&&n.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)},t.prototype.reset=function(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t),this._updatePristine(t),this._updateTouched(t)},t.prototype.getRawValue=function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof Pa?t.value:t.getRawValue(),e})},t.prototype._syncPendingControls=function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e},t.prototype._throwIfControlMissing=function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: "+e+".")},t.prototype._forEachChild=function(e){var t=this;Object.keys(this.controls).forEach(function(n){return e(t.controls[n],n)})},t.prototype._setUpControls=function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})},t.prototype._updateValue=function(){this.value=this._reduceValue()},t.prototype._anyControls=function(e){var t=this,n=!1;return this._forEachChild(function(r,i){n=n||t.contains(i)&&e(r)}),n},t.prototype._reduceValue=function(){var e=this;return this._reduceChildren({},function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t})},t.prototype._reduceChildren=function(e,t){var n=e;return this._forEachChild(function(e,r){n=t(n,e,r)}),n},t.prototype._allControlsDisabled=function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++)if(this.controls[t[e]].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled},t.prototype._checkAllValuesPresent=function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '"+n+"'.")})},t}(Aa),Ma=function(e){function t(t,n,r){var i=e.call(this,Sa(n),xa(r,n))||this;return i.controls=t,i._initObservables(),i._setUpdateStrategy(n),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return Object(a.c)(t,e),t.prototype.at=function(e){return this.controls[e]},t.prototype.push=function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.insert=function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.removeAt=function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity(),this._onCollectionChange()},t.prototype.setControl=function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()},Object.defineProperty(t.prototype,"length",{get:function(){return this.controls.length},enumerable:!0,configurable:!0}),t.prototype.setValue=function(e,t){var n=this;void 0===t&&(t={}),this._checkAllValuesPresent(e),e.forEach(function(e,r){n._throwIfControlMissing(r),n.at(r).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)},t.prototype.patchValue=function(e,t){var n=this;void 0===t&&(t={}),e.forEach(function(e,r){n.at(r)&&n.at(r).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)},t.prototype.reset=function(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this._forEachChild(function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t),this._updatePristine(t),this._updateTouched(t)},t.prototype.getRawValue=function(){return this.controls.map(function(e){return e instanceof Pa?e.value:e.getRawValue()})},t.prototype._syncPendingControls=function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e},t.prototype._throwIfControlMissing=function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index "+e)},t.prototype._forEachChild=function(e){this.controls.forEach(function(t,n){e(t,n)})},t.prototype._updateValue=function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})},t.prototype._anyControls=function(e){return this.controls.some(function(t){return t.enabled&&e(t)})},t.prototype._setUpControls=function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})},t.prototype._checkAllValuesPresent=function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: "+n+".")})},t.prototype._allControlsDisabled=function(){for(var e=0,t=this.controls;e<t.length;e++)if(t[e].enabled)return!1;return this.controls.length>0||this.disabled},t.prototype._registerControl=function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)},t}(Aa),Ia=Promise.resolve(null),Oa=function(e){function t(t,n){var i=e.call(this)||this;return i.submitted=!1,i._directives=[],i.ngSubmit=new r.m,i.form=new Da({},ga(t),va(n)),i}return Object(a.c)(t,e),t.prototype.ngAfterViewInit=function(){this._setUpdateStrategy()},Object.defineProperty(t.prototype,"formDirective",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"control",{get:function(){return this.form},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"controls",{get:function(){return this.form.controls},enumerable:!0,configurable:!0}),t.prototype.addControl=function(e){var t=this;Ia.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),fa(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})},t.prototype.getControl=function(e){return this.form.get(e.path)},t.prototype.removeControl=function(e){var t=this;Ia.then(function(){var n,r,i=t._findContainer(e.path);i&&i.removeControl(e.name),(r=(n=t._directives).indexOf(e))>-1&&n.splice(r,1)})},t.prototype.addFormGroup=function(e){var t=this;Ia.then(function(){var n,r,i=t._findContainer(e.path),o=new Da({});r=e,null==(n=o)&&_a(r,"Cannot find control with"),n.validator=Jo.compose([n.validator,r.validator]),n.asyncValidator=Jo.composeAsync([n.asyncValidator,r.asyncValidator]),i.registerControl(e.name,o),o.updateValueAndValidity({emitEvent:!1})})},t.prototype.removeFormGroup=function(e){var t=this;Ia.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})},t.prototype.getFormGroup=function(e){return this.form.get(e.path)},t.prototype.updateModel=function(e,t){var n=this;Ia.then(function(){n.form.get(e.path).setValue(t)})},t.prototype.setValue=function(e){this.control.setValue(e)},t.prototype.onSubmit=function(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}),this.ngSubmit.emit(e),!1;var t},t.prototype.onReset=function(){this.resetForm()},t.prototype.resetForm=function(e){void 0===e&&(e=void 0),this.form.reset(e),this.submitted=!1},t.prototype._setUpdateStrategy=function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)},t.prototype._findContainer=function(e){return e.pop(),e.length?this.form.get(e):this.form},t}(Zo),Ra='\n    <div [formGroup]="myGroup">\n       <div formGroupName="person">\n          <input formControlName="firstName">\n       </div>\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       person: new FormGroup({ firstName: new FormControl() })\n    });',Na='\n    <form>\n       <div ngModelGroup="person">\n          <input [(ngModel)]="person.name" name="firstName">\n       </div>\n    </form>',La=function(){function e(){}return e.modelParentException=function(){throw new Error('\n      ngModel cannot be used to register form controls with a parent formGroup directive.  Try using\n      formGroup\'s partner directive "formControlName" instead.  Example:\n\n      \n    <div [formGroup]="myGroup">\n      <input formControlName="firstName">\n    </div>\n\n    In your class:\n\n    this.myGroup = new FormGroup({\n       firstName: new FormControl()\n    });\n\n      Or, if you\'d like to avoid registering this form control, indicate that it\'s standalone in ngModelOptions:\n\n      Example:\n\n      \n    <div [formGroup]="myGroup">\n       <input formControlName="firstName">\n       <input [(ngModel)]="showMoreControls" [ngModelOptions]="{standalone: true}">\n    </div>\n  ')},e.formGroupNameException=function(){throw new Error("\n      ngModel cannot be used to register form controls with a parent formGroupName or formArrayName directive.\n\n      Option 1: Use formControlName instead of ngModel (reactive strategy):\n\n      "+Ra+"\n\n      Option 2:  Update ngModel's parent be ngModelGroup (template-driven strategy):\n\n      "+Na)},e.missingNameException=function(){throw new Error('If ngModel is used within a form tag, either the name attribute must be set or the form\n      control must be defined as \'standalone\' in ngModelOptions.\n\n      Example 1: <input [(ngModel)]="person.firstName" name="first">\n      Example 2: <input [(ngModel)]="person.firstName" [ngModelOptions]="{standalone: true}">')},e.modelGroupParentException=function(){throw new Error("\n      ngModelGroup cannot be used with a parent formGroup directive.\n\n      Option 1: Use formGroupName instead of ngModelGroup (reactive strategy):\n\n      "+Ra+"\n\n      Option 2:  Use a regular form tag instead of the formGroup directive (template-driven strategy):\n\n      "+Na)},e}(),Fa=function(e){function t(t,n,r){var i=e.call(this)||this;return i._parent=t,i._validators=n,i._asyncValidators=r,i}return Object(a.c)(t,e),t.prototype._checkParentType=function(){this._parent instanceof t||this._parent instanceof Oa||La.modelGroupParentException()},t}(Ca),Ba=Promise.resolve(null),ka=function(e){function t(t,n,i,o){var a=e.call(this)||this;return a.control=new Pa,a._registered=!1,a.update=new r.m,a._parent=t,a._rawValidators=n||[],a._rawAsyncValidators=i||[],a.valueAccessor=function(e,t){if(!t)return null;var n=void 0,r=void 0,i=void 0;return t.forEach(function(t){var o;t.constructor===oa?n=t:(o=t,ya.some(function(e){return o.constructor===e})?(r&&_a(e,"More than one built-in value accessor matches form control with"),r=t):(i&&_a(e,"More than one custom value accessor matches form control with"),i=t))}),i||r||n||(_a(e,"No valid value accessor for form control with"),null)}(a,o),a}return Object(a.c)(t,e),t.prototype.ngOnChanges=function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object(r._12)(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)},t.prototype.ngOnDestroy=function(){this.formDirective&&this.formDirective.removeControl(this)},Object.defineProperty(t.prototype,"path",{get:function(){return this._parent?pa(this.name,this._parent):[this.name]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"formDirective",{get:function(){return this._parent?this._parent.formDirective:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validator",{get:function(){return ga(this._rawValidators)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"asyncValidator",{get:function(){return va(this._rawAsyncValidators)},enumerable:!0,configurable:!0}),t.prototype.viewToModelUpdate=function(e){this.viewModel=e,this.update.emit(e)},t.prototype._setUpControl=function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0},t.prototype._setUpdateStrategy=function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)},t.prototype._isStandalone=function(){return!this._parent||!(!this.options||!this.options.standalone)},t.prototype._setUpStandalone=function(){fa(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})},t.prototype._checkForErrors=function(){this._isStandalone()||this._checkParentType(),this._checkName()},t.prototype._checkParentType=function(){!(this._parent instanceof Fa)&&this._parent instanceof Ca?La.formGroupNameException():this._parent instanceof Fa||this._parent instanceof Oa||La.modelParentException()},t.prototype._checkName=function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()||this.name||La.missingNameException()},t.prototype._updateValue=function(e){var t=this;Ba.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})},t.prototype._updateDisabled=function(e){var t=this,n=e.isDisabled.currentValue,r=""===n||n&&"false"!==n;Ba.then(function(){r&&!t.control.disabled?t.control.disable():!r&&t.control.disabled&&t.control.enable()})},t}(ca),Va=function(){},za=function(){};H.a.prototype.map=G.a;var Ua=function(){function e(e){this.http=e}return e.prototype.getWeather=function(e){return this.http.get("http://api.openweathermap.org/data/2.5/weather?lat="+e.latitude+"&lon="+e.longitude+"&units=metric&APPID=6e178146447d4c49019dcd861505369d").pipe(he(this.handleError("getWeather",[])))},e.prototype.handleError=function(e,t){return void 0===e&&(e="operation"),function(e){return console.error(e),V(t)}},e}(),Ga=function(){},Wa=function(){},Ha=function(){function e(e){var t=this;this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?function(){t.headers=new Map,e.split("\n").forEach(function(e){var n=e.indexOf(":");if(n>0){var r=e.slice(0,n),i=r.toLowerCase(),o=e.slice(n+1).trim();t.maybeSetNormalizedName(r,i),t.headers.has(i)?t.headers.get(i).push(o):t.headers.set(i,[o])}})}:function(){t.headers=new Map,Object.keys(e).forEach(function(n){var r=e[n],i=n.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(t.headers.set(i,r),t.maybeSetNormalizedName(n,i))})}:this.headers=new Map}return e.prototype.has=function(e){return this.init(),this.headers.has(e.toLowerCase())},e.prototype.get=function(e){this.init();var t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null},e.prototype.keys=function(){return this.init(),Array.from(this.normalizedNames.values())},e.prototype.getAll=function(e){return this.init(),this.headers.get(e.toLowerCase())||null},e.prototype.append=function(e,t){return this.clone({name:e,value:t,op:"a"})},e.prototype.set=function(e,t){return this.clone({name:e,value:t,op:"s"})},e.prototype.delete=function(e,t){return this.clone({name:e,value:t,op:"d"})},e.prototype.maybeSetNormalizedName=function(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)},e.prototype.init=function(){var t=this;this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(e){return t.applyUpdate(e)}),this.lazyUpdate=null))},e.prototype.copyFrom=function(e){var t=this;e.init(),Array.from(e.headers.keys()).forEach(function(n){t.headers.set(n,e.headers.get(n)),t.normalizedNames.set(n,e.normalizedNames.get(n))})},e.prototype.clone=function(t){var n=new e;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([t]),n},e.prototype.applyUpdate=function(e){var t=e.name.toLowerCase();switch(e.op){case"a":case"s":var n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);var r=("a"===e.op?this.headers.get(t):void 0)||[];r.push.apply(r,n),this.headers.set(t,r);break;case"d":var i=e.value;if(i){var o=this.headers.get(t);if(!o)return;0===(o=o.filter(function(e){return-1===i.indexOf(e)})).length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}},e.prototype.forEach=function(e){var t=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(n){return e(t.normalizedNames.get(n),t.headers.get(n))})},e}(),ja=function(){function e(){}return e.prototype.encodeKey=function(e){return qa(e)},e.prototype.encodeValue=function(e){return qa(e)},e.prototype.decodeKey=function(e){return decodeURIComponent(e)},e.prototype.decodeValue=function(e){return decodeURIComponent(e)},e}();function qa(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/gi,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%2B/gi,"+").replace(/%3D/gi,"=").replace(/%3F/gi,"?").replace(/%2F/gi,"/")}var Ya=function(){function e(e){void 0===e&&(e={});var t,n,r,i=this;if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ja,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=(t=e.fromString,n=this.encoder,r=new Map,t.length>0&&t.split("&").forEach(function(e){var t=e.indexOf("="),i=-1==t?[n.decodeKey(e),""]:[n.decodeKey(e.slice(0,t)),n.decodeValue(e.slice(t+1))],o=i[0],a=i[1],s=r.get(o)||[];s.push(a),r.set(o,s)}),r)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(function(t){var n=e.fromObject[t];i.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}return e.prototype.has=function(e){return this.init(),this.map.has(e)},e.prototype.get=function(e){this.init();var t=this.map.get(e);return t?t[0]:null},e.prototype.getAll=function(e){return this.init(),this.map.get(e)||null},e.prototype.keys=function(){return this.init(),Array.from(this.map.keys())},e.prototype.append=function(e,t){return this.clone({param:e,value:t,op:"a"})},e.prototype.set=function(e,t){return this.clone({param:e,value:t,op:"s"})},e.prototype.delete=function(e,t){return this.clone({param:e,value:t,op:"d"})},e.prototype.toString=function(){var e=this;return this.init(),this.keys().map(function(t){var n=e.encoder.encodeKey(t);return e.map.get(t).map(function(t){return n+"="+e.encoder.encodeValue(t)}).join("&")}).join("&")},e.prototype.clone=function(t){var n=new e({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat([t]),n},e.prototype.init=function(){var e=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(t){return e.map.set(t,e.cloneFrom.map.get(t))}),this.updates.forEach(function(t){switch(t.op){case"a":case"s":var n=("a"===t.op?e.map.get(t.param):void 0)||[];n.push(t.value),e.map.set(t.param,n);break;case"d":if(void 0===t.value){e.map.delete(t.param);break}var r=e.map.get(t.param)||[],i=r.indexOf(t.value);-1!==i&&r.splice(i,1),r.length>0?e.map.set(t.param,r):e.map.delete(t.param)}}),this.cloneFrom=null)},e}();function Xa(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer}function Za(e){return"undefined"!=typeof Blob&&e instanceof Blob}function Ka(e){return"undefined"!=typeof FormData&&e instanceof FormData}var Qa=function(){function e(e,t,n,r){var i;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,i=r):i=n,i&&(this.reportProgress=!!i.reportProgress,this.withCredentials=!!i.withCredentials,i.responseType&&(this.responseType=i.responseType),i.headers&&(this.headers=i.headers),i.params&&(this.params=i.params)),this.headers||(this.headers=new Ha),this.params){var o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{var a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new Ya,this.urlWithParams=t}return e.prototype.serializeBody=function(){return null===this.body?null:Xa(this.body)||Za(this.body)||Ka(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ya?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()},e.prototype.detectContentTypeHeader=function(){return null===this.body?null:Ka(this.body)?null:Za(this.body)?this.body.type||null:Xa(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ya?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||Array.isArray(this.body)?"application/json":null},e.prototype.clone=function(t){void 0===t&&(t={});var n=t.method||this.method,r=t.url||this.url,i=t.responseType||this.responseType,o=void 0!==t.body?t.body:this.body,a=void 0!==t.withCredentials?t.withCredentials:this.withCredentials,s=void 0!==t.reportProgress?t.reportProgress:this.reportProgress,l=t.headers||this.headers,u=t.params||this.params;return void 0!==t.setHeaders&&(l=Object.keys(t.setHeaders).reduce(function(e,n){return e.set(n,t.setHeaders[n])},l)),t.setParams&&(u=Object.keys(t.setParams).reduce(function(e,n){return e.set(n,t.setParams[n])},u)),new e(n,r,o,{params:u,headers:l,reportProgress:s,responseType:i,withCredentials:a})},e}(),Ja=function(){var e={Sent:0,UploadProgress:1,ResponseHeader:2,DownloadProgress:3,Response:4,User:5};return e[e.Sent]="Sent",e[e.UploadProgress]="UploadProgress",e[e.ResponseHeader]="ResponseHeader",e[e.DownloadProgress]="DownloadProgress",e[e.Response]="Response",e[e.User]="User",e}(),$a=function(){return function(e,t,n){void 0===t&&(t=200),void 0===n&&(n="OK"),this.headers=e.headers||new Ha,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}(),es=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.type=Ja.ResponseHeader,n}return Object(a.c)(t,e),t.prototype.clone=function(e){return void 0===e&&(e={}),new t({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})},t}($a),ts=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.type=Ja.Response,n.body=void 0!==t.body?t.body:null,n}return Object(a.c)(t,e),t.prototype.clone=function(e){return void 0===e&&(e={}),new t({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})},t}($a),ns=function(e){function t(t){var n=e.call(this,t,0,"Unknown Error")||this;return n.name="HttpErrorResponse",n.ok=!1,n.message=n.status>=200&&n.status<300?"Http failure during parsing for "+(t.url||"(unknown url)"):"Http failure response for "+(t.url||"(unknown url)")+": "+t.status+" "+t.statusText,n.error=t.error||null,n}return Object(a.c)(t,e),t}($a);function rs(e,t){return{body:t,headers:e.headers,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}var is=function(){function e(e){this.handler=e}return e.prototype.request=function(e,t,n){var r,i=this;if(void 0===n&&(n={}),e instanceof Qa)r=e;else{var o;o=n.headers instanceof Ha?n.headers:new Ha(n.headers);var a=void 0;n.params&&(a=n.params instanceof Ya?n.params:new Ya({fromObject:n.params})),r=new Qa(e,t,void 0!==n.body?n.body:null,{headers:o,params:a,reportProgress:n.reportProgress,responseType:n.responseType||"json",withCredentials:n.withCredentials})}var s=U.call(V(r),function(e){return i.handler.handle(e)});if(e instanceof Qa||"events"===n.observe)return s;var l=bn.a.call(s,function(e){return e instanceof ts});switch(n.observe||"body"){case"body":switch(r.responseType){case"arraybuffer":return G.a.call(l,function(e){if(null!==e.body&&!(e.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return e.body});case"blob":return G.a.call(l,function(e){if(null!==e.body&&!(e.body instanceof Blob))throw new Error("Response is not a Blob.");return e.body});case"text":return G.a.call(l,function(e){if(null!==e.body&&"string"!=typeof e.body)throw new Error("Response is not a string.");return e.body});case"json":default:return G.a.call(l,function(e){return e.body})}case"response":return l;default:throw new Error("Unreachable: unhandled observe type "+n.observe+"}")}},e.prototype.delete=function(e,t){return void 0===t&&(t={}),this.request("DELETE",e,t)},e.prototype.get=function(e,t){return void 0===t&&(t={}),this.request("GET",e,t)},e.prototype.head=function(e,t){return void 0===t&&(t={}),this.request("HEAD",e,t)},e.prototype.jsonp=function(e,t){return this.request("JSONP",e,{params:(new Ya).append(t,"JSONP_CALLBACK"),observe:"body",responseType:"json"})},e.prototype.options=function(e,t){return void 0===t&&(t={}),this.request("OPTIONS",e,t)},e.prototype.patch=function(e,t,n){return void 0===n&&(n={}),this.request("PATCH",e,rs(n,t))},e.prototype.post=function(e,t,n){return void 0===n&&(n={}),this.request("POST",e,rs(n,t))},e.prototype.put=function(e,t,n){return void 0===n&&(n={}),this.request("PUT",e,rs(n,t))},e}(),os=function(){function e(e,t){this.next=e,this.interceptor=t}return e.prototype.handle=function(e){return this.interceptor.intercept(e,this.next)},e}(),as=new r.o("HTTP_INTERCEPTORS"),ss=function(){function e(){}return e.prototype.intercept=function(e,t){return t.handle(e)},e}(),ls=/^\)\]\}',?\n/,us=function(){},cs=function(){function e(){}return e.prototype.build=function(){return new XMLHttpRequest},e}(),hs=function(){function e(e){this.xhrFactory=e}return e.prototype.handle=function(e){var t=this;if("JSONP"===e.method)throw new Error("Attempted to construct Jsonp request without JsonpClientModule installed.");return new H.a(function(n){var r=t.xhrFactory.build();if(r.open(e.method,e.urlWithParams),e.withCredentials&&(r.withCredentials=!0),e.headers.forEach(function(e,t){return r.setRequestHeader(e,t.join(","))}),e.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!e.headers.has("Content-Type")){var i=e.detectContentTypeHeader();null!==i&&r.setRequestHeader("Content-Type",i)}if(e.responseType){var o=e.responseType.toLowerCase();r.responseType="json"!==o?o:"text"}var a=e.serializeBody(),s=null,l=function(){if(null!==s)return s;var t,n=1223===r.status?204:r.status,i=r.statusText||"OK",o=new Ha(r.getAllResponseHeaders()),a=("responseURL"in(t=r)&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null)||e.url;return s=new es({headers:o,status:n,statusText:i,url:a})},u=function(){var t=l(),i=t.headers,o=t.status,a=t.statusText,s=t.url,u=null;204!==o&&(u="undefined"==typeof r.response?r.responseText:r.response),0===o&&(o=u?200:0);var c=o>=200&&o<300;if("json"===e.responseType&&"string"==typeof u){var h=u;u=u.replace(ls,"");try{u=""!==u?JSON.parse(u):null}catch(e){u=h,c&&(c=!1,u={error:e,text:u})}}c?(n.next(new ts({body:u,headers:i,status:o,statusText:a,url:s||void 0})),n.complete()):n.error(new ns({error:u,headers:i,status:o,statusText:a,url:s||void 0}))},c=function(e){var t=new ns({error:e,status:r.status||0,statusText:r.statusText||"Unknown Error"});n.error(t)},h=!1,d=function(t){h||(n.next(l()),h=!0);var i={type:Ja.DownloadProgress,loaded:t.loaded};t.lengthComputable&&(i.total=t.total),"text"===e.responseType&&r.responseText&&(i.partialText=r.responseText),n.next(i)},p=function(e){var t={type:Ja.UploadProgress,loaded:e.loaded};e.lengthComputable&&(t.total=e.total),n.next(t)};return r.addEventListener("load",u),r.addEventListener("error",c),e.reportProgress&&(r.addEventListener("progress",d),null!==a&&r.upload&&r.upload.addEventListener("progress",p)),r.send(a),n.next({type:Ja.Sent}),function(){r.removeEventListener("error",c),r.removeEventListener("load",u),e.reportProgress&&(r.removeEventListener("progress",d),null!==a&&r.upload&&r.upload.removeEventListener("progress",p)),r.abort()}})},e}(),ds=new r.o("XSRF_COOKIE_NAME"),ps=new r.o("XSRF_HEADER_NAME"),fs=function(){},ms=function(){function e(e,t,n){this.doc=e,this.platform=t,this.cookieName=n,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return e.prototype.getToken=function(){if("server"===this.platform)return null;var e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=w(e,this.cookieName),this.lastCookieString=e),this.lastToken},e}(),_s=function(){function e(e,t){this.tokenService=e,this.headerName=t}return e.prototype.intercept=function(e,t){var n=e.url.toLowerCase();if("GET"===e.method||"HEAD"===e.method||n.startsWith("http://")||n.startsWith("https://"))return t.handle(e);var r=this.tokenService.getToken();return null===r||e.headers.has(this.headerName)||(e=e.clone({headers:e.headers.set(this.headerName,r)})),t.handle(e)},e}();function gs(e,t){return void 0===t&&(t=[]),t?t.reduceRight(function(e,t){return new os(e,t)},e):e}var vs=function(){function e(){}return e.disable=function(){return{ngModule:e,providers:[{provide:_s,useClass:ss}]}},e.withOptions=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[t.cookieName?{provide:ds,useValue:t.cookieName}:[],t.headerName?{provide:ps,useValue:t.headerName}:[]]}},e}(),ys=function(){};H.a.prototype.mergeMap=W,H.a.prototype.flatMap=W;var Cs=function(){function e(e,t,n){this.route=e,this.developerService=t,this.weatherService=n}return e.prototype.ngOnInit=function(){var e=this,t=+this.route.snapshot.paramMap.get("id");this.developerService.getDeveloper(t).subscribe(function(t){return e.location=t.location})},e.prototype.getWeather=function(){var e=this;this.location&&this.weatherService.getWeather(this.location).subscribe(function(t){return e.results=t,e.temperature=t.main.temp,e.weatherStatus=t.weather[0].description})},e}(),ws=r._1({encapsulation:0,styles:[[".weather-widget[_ngcontent-%COMP%]{position:absolute;top:-7px;right:10px;padding:10px;width:40%}button[_ngcontent-%COMP%]:hover{background:#cfd8dc;cursor:pointer}button[_ngcontent-%COMP%]{border-radius:3px;height:30px;border-color:transparent;background:transparent}button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}"]],data:{}});function bs(e){return r._25(0,[(e()(),r._3(0,0,null,null,10,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(2,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),r._23(-1,null,["Weather Widget"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(5,0,null,null,1,"h5",[],null,null,null,null,null)),(e()(),r._23(6,null,["Temperature: ",""])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(8,0,null,null,1,"h5",[],null,null,null,null,null)),(e()(),r._23(9,null,["Weather Status: ",""])),(e()(),r._23(-1,null,["\n  "]))],null,function(e,t){var n=t.component;e(t,6,0,n.temperature),e(t,9,0,n.weatherStatus)})}function Es(e){return r._25(0,[(e()(),r._3(0,0,null,null,11,"div",[["class","weather-widget"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(2,0,null,null,5,"button",[],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.getWeather()&&r),r},null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(4,0,null,null,2,"span",[],null,null,null,null,null)),(e()(),r._3(5,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-sun-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r.Y(16777216,null,null,1,null,bs)),r._2(10,16384,null,0,x,[r.M,r.J],{ngIf:[0,"ngIf"]},null),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n\n\n\n\n"]))],function(e,t){e(t,10,0,t.component.results)},null)}n("lfIl");var Ss=function(){function e(e,t){this.developerService=e,this.route=t,this.isMapTriggerd="none",this.beforeMapTriggerd="block",this.pinBuilder=new Cesium.PinBuilder,Cesium.BingMapsApi.defaultKey="AroazdWsTmTcIx4ZE3SIicDXX00yEp9vuRZyn6pagjyjgS-VdRBfBNAVkvrucbqr",window.CESIUM_BASE_URL="/assets/Cesium"}return e.prototype.ngOnInit=function(){var e=this,t=+this.route.snapshot.paramMap.get("id");this.developerService.getDeveloper(t).subscribe(function(t){return e.developer=t})},e.prototype.ngAfterViewInit=function(){this.cesiumViewer=new Cesium.Viewer(this.cesiumContainer.nativeElement,{fullscreenButton:!1,baseLayerPicker:!1,vrButton:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,navigationHelpButton:!1,animation:!1,timeline:!1,projectionPicker:!1,geocoder:!1,bottom:!1}),this.cesiumViewer.forceResize()},e.prototype.markLocation=function(){this.isMapTriggerd="block",this.beforeMapTriggerd="none",this.cesiumViewer.entities.add({name:"test",position:Cesium.Cartesian3.fromDegrees(this.developer.location.longitude,this.developer.location.latitude),billboard:{image:this.pinBuilder.fromText(this.developer.name,Cesium.Color.BLACK,90).toDataURL(),verticalOrigin:Cesium.VerticalOrigin.BOTTOM}}),this.flyTo()},e.prototype.flyTo=function(){this.cesiumViewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(this.developer.location.longitude,this.developer.location.latitude,1e5)})},e.prototype.ngOnDestroy=function(){this.isMapTriggerd="none"},e}(),xs=function(){function e(e,t,n){this.route=e,this.developerService=t,this.resolver=n,this.unsubsbcribe=new B.a}return e.prototype.ngOnInit=function(){var e=this,t=+this.route.snapshot.paramMap.get("id");this.developerService.getDeveloper(t).pipe(Object(So.a)(this.unsubsbcribe)).subscribe(function(t){return e.developer=t}),this.createCesiumMapComponent()},e.prototype.createCesiumMapComponent=function(){this.container.clear();var e=this.resolver.resolveComponentFactory(Ss);this.componentRef=this.container.createComponent(e)},e.prototype.ngOnDestroy=function(){this.unsubsbcribe.next(),this.unsubsbcribe.complete(),this.unsubsbcribe.unsubscribe(),this.container=null},e}(),Ts=r._1({encapsulation:0,styles:[[".developer-location[_ngcontent-%COMP%]{position:absolute;top:10rem;display:inline-block;height:66%;width:48%;right:0;max-height:80%;margin-right:5px;border:2px solid #eee;background-color:#ddd;padding-left:5px;border-radius:5px}"]],data:{}});function As(e){return r._25(0,[(e()(),r._3(0,0,null,null,14,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(2,0,null,null,2,"h2",[],null,null,null,null,null)),(e()(),r._23(3,null,[""," Location"])),r._19(4,1),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(6,0,null,null,1,"h3",[],null,null,null,null,null)),(e()(),r._23(7,null,["",""])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(9,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),r._23(10,null,["longitude: ",""])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(12,0,null,null,1,"h4",[],null,null,null,null,null)),(e()(),r._23(13,null,["latitude: ",""])),(e()(),r._23(-1,null,["\n  "]))],null,function(e,t){var n=t.component;e(t,3,0,r._24(t,3,0,e(t,4,0,r._16(t.parent,0),n.developer.name))),e(t,7,0,n.developer.location.name),e(t,10,0,n.developer.location.longitude),e(t,13,0,n.developer.location.latitude)})}function Ps(e){return r._25(0,[r._17(0,R,[]),r._21(402653184,1,{container:0}),(e()(),r._3(2,0,null,null,8,"div",[["class","developer-location"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r.Y(16777216,null,null,1,null,As)),r._2(5,16384,null,0,x,[r.M,r.J],{ngIf:[0,"ngIf"]},null),(e()(),r._23(-1,null,["\n\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(9,16777216,[[1,3],["cesiumContainer",1]],null,0,"template",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n\n\n"]))],function(e,t){e(t,5,0,t.component.developer)},null)}var Ds=function(){function e(e,t,n){this.route=e,this.developerService=t,this.location=n,this.welcomeMsg="--not initalized yet--",this.unsubscribe=new B.a}return e.prototype.ngOnInit=function(){this.getDeveloper(),this.welcomeMsg=this.developer?"welcome, "+this.developer.name:"welcome unknown"},e.prototype.getDeveloper=function(){var e=this,t=+this.route.snapshot.paramMap.get("id");this.developerService.getDeveloper(t).pipe(Object(So.a)(this.unsubscribe)).subscribe(function(t){return e.developer=t}),this.getCurrectUrl()},e.prototype.goBack=function(){this.location.back()},e.prototype.saveDeveloper=function(){var e=this;this.developerService.updateDeveloper(this.developer).subscribe(function(){return e.goBack()})},e.prototype.getCurrectUrl=function(){return console.log("Url:"+this.route.url),this.route.url},e.prototype.ngOnDestroy=function(){this.unsubscribe.next(),this.unsubscribe.complete()},e}(),Ms=r._1({encapsulation:0,styles:[["#developer-detail[_ngcontent-%COMP%]{display:inline-block;border:2px solid #eee;\n  width:48%;position:absolute;top:10em;left:0;height:30%;padding:3px;margin-left:5px;background-color:#ddd}#developer-detail[_ngcontent-%COMP%]   .edit-field[_ngcontent-%COMP%]{display:inline-block;margin:0}#developer-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin:1em}#developer-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:150px}#developer-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:transparent;background:transparent}#developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#cfd8dc;cursor:pointer}#developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:3px;height:30px;border-color:transparent;background:transparent}#developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}#developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], #developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, #developer-detail[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}"]],data:{}});function Is(e){return r._25(0,[(e()(),r._3(0,0,null,null,88,"div",[["id","developer-detail"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(2,0,null,null,3,"button",[["type","button"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.goBack()&&r),r},null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(4,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-arrow-circle-left"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(7,0,null,null,3,"button",[["type","button"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.saveDeveloper()&&r),r},null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(9,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-floppy-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(12,0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),r._23(13,null,["",""])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(15,0,null,null,3,"div",[],null,null,null,null,null)),(e()(),r._3(16,0,null,null,1,"span",[],null,null,null,null,null)),(e()(),r._23(-1,null,["id: "])),(e()(),r._23(18,null,["",""])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(20,0,null,null,19,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(22,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),r._23(-1,null,["name:"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(25,0,null,null,13,"div",[["class","edit-field"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(27,0,null,null,3,"span",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(29,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-pencil-square-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(32,0,null,null,5,"input",[["placeholder","name"],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],function(e,t,n){var i=!0,o=e.component;return"input"===t&&(i=!1!==r._16(e,33)._handleInput(n.target.value)&&i),"blur"===t&&(i=!1!==r._16(e,33).onTouched()&&i),"compositionstart"===t&&(i=!1!==r._16(e,33)._compositionStart()&&i),"compositionend"===t&&(i=!1!==r._16(e,33)._compositionEnd(n.target.value)&&i),"ngModelChange"===t&&(i=!1!==(o.developer.name=n)&&i),i},null,null)),r._2(33,16384,null,0,oa,[r.B,r.k,[2,ia]],null,null),r._20(1024,null,na,function(e){return[e]},[oa]),r._2(35,671744,null,0,ka,[[8,null],[8,null],[8,null],[2,na]],{model:[0,"model"]},{update:"ngModelChange"}),r._20(2048,null,ca,null,[ka]),r._2(37,16384,null,0,wa,[ca],null,null),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(41,0,null,null,20,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(43,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),r._23(-1,null,["location latitude"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(46,0,null,null,14,"div",[["class","edit-field"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(48,0,null,null,3,"span",[["class","edit-field-icon"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(50,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-pencil-square-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(53,0,null,null,6,"input",[["placeholder","name"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(e,t,n){var i=!0,o=e.component;return"input"===t&&(i=!1!==r._16(e,54)._handleInput(n.target.value)&&i),"blur"===t&&(i=!1!==r._16(e,54).onTouched()&&i),"compositionstart"===t&&(i=!1!==r._16(e,54)._compositionStart()&&i),"compositionend"===t&&(i=!1!==r._16(e,54)._compositionEnd(n.target.value)&&i),"change"===t&&(i=!1!==r._16(e,55).onChange(n.target.value)&&i),"input"===t&&(i=!1!==r._16(e,55).onChange(n.target.value)&&i),"blur"===t&&(i=!1!==r._16(e,55).onTouched()&&i),"ngModelChange"===t&&(i=!1!==(o.developer.location.latitude=n)&&i),i},null,null)),r._2(54,16384,null,0,oa,[r.B,r.k,[2,ia]],null,null),r._2(55,16384,null,0,la,[r.B,r.k],null,null),r._20(1024,null,na,function(e,t){return[e,t]},[oa,la]),r._2(57,671744,null,0,ka,[[8,null],[8,null],[8,null],[2,na]],{model:[0,"model"]},{update:"ngModelChange"}),r._20(2048,null,ca,null,[ka]),r._2(59,16384,null,0,wa,[ca],null,null),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(63,0,null,null,20,"div",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(65,0,null,null,1,"label",[],null,null,null,null,null)),(e()(),r._23(-1,null,["location longitude:"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(68,0,null,null,14,"div",[["class","edit-field"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n     "])),(e()(),r._3(70,0,null,null,3,"span",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(72,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-pencil-square-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n      "])),(e()(),r._3(75,0,null,null,6,"input",[["placeholder","name"],["type","number"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"],[null,"change"]],function(e,t,n){var i=!0,o=e.component;return"input"===t&&(i=!1!==r._16(e,76)._handleInput(n.target.value)&&i),"blur"===t&&(i=!1!==r._16(e,76).onTouched()&&i),"compositionstart"===t&&(i=!1!==r._16(e,76)._compositionStart()&&i),"compositionend"===t&&(i=!1!==r._16(e,76)._compositionEnd(n.target.value)&&i),"change"===t&&(i=!1!==r._16(e,77).onChange(n.target.value)&&i),"input"===t&&(i=!1!==r._16(e,77).onChange(n.target.value)&&i),"blur"===t&&(i=!1!==r._16(e,77).onTouched()&&i),"ngModelChange"===t&&(i=!1!==(o.developer.location.longitude=n)&&i),i},null,null)),r._2(76,16384,null,0,oa,[r.B,r.k,[2,ia]],null,null),r._2(77,16384,null,0,la,[r.B,r.k],null,null),r._20(1024,null,na,function(e,t){return[e,t]},[oa,la]),r._2(79,671744,null,0,ka,[[8,null],[8,null],[8,null],[2,na]],{model:[0,"model"]},{update:"ngModelChange"}),r._20(2048,null,ca,null,[ka]),r._2(81,16384,null,0,wa,[ca],null,null),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(85,0,null,null,2,"app-weather-widget",[],null,null,null,Es,ws)),r._20(512,null,Ua,Ua,[is]),r._2(87,114688,null,0,Cs,[Nr,Do,Ua],null,null),(e()(),r._23(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,35,0,n.developer.name),e(t,57,0,n.developer.location.latitude),e(t,79,0,n.developer.location.longitude),e(t,87,0)},function(e,t){var n=t.component;e(t,13,0,n.welcomeMsg),e(t,18,0,n.developer.id),e(t,32,0,r._16(t,37).ngClassUntouched,r._16(t,37).ngClassTouched,r._16(t,37).ngClassPristine,r._16(t,37).ngClassDirty,r._16(t,37).ngClassValid,r._16(t,37).ngClassInvalid,r._16(t,37).ngClassPending),e(t,53,0,r._16(t,59).ngClassUntouched,r._16(t,59).ngClassTouched,r._16(t,59).ngClassPristine,r._16(t,59).ngClassDirty,r._16(t,59).ngClassValid,r._16(t,59).ngClassInvalid,r._16(t,59).ngClassPending),e(t,75,0,r._16(t,81).ngClassUntouched,r._16(t,81).ngClassTouched,r._16(t,81).ngClassPristine,r._16(t,81).ngClassDirty,r._16(t,81).ngClassValid,r._16(t,81).ngClassInvalid,r._16(t,81).ngClassPending)})}function Os(e){return r._25(2,[(e()(),r.Y(16777216,null,null,1,null,Is)),r._2(1,16384,null,0,x,[r.M,r.J],{ngIf:[0,"ngIf"]},null),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(3,0,null,null,1,"app-developer-location",[],null,null,null,Ps,Ts)),r._2(4,245760,null,0,xs,[Nr,Do,r.j],null,null),(e()(),r._23(-1,null,["\n\n"]))],function(e,t){e(t,1,0,t.component.developer),e(t,4,0)},null)}var Rs=r.Z("app-developer-detail",Ds,function(e){return r._25(0,[(e()(),r._3(0,0,null,null,1,"app-developer-detail",[],null,null,null,Os,Ms)),r._2(1,245760,null,0,Ds,[Nr,Do,h],null,null)],function(e,t){e(t,1,0)},null)},{developer:"developer"},{},[]),Ns=r._1({encapsulation:0,styles:[[".cesium-container[_ngcontent-%COMP%]{width:100%;height:55%;margin-top:61px;background-image:url(http://cdn.cnn.com/cnnnext/dam/assets/160614135229-01-kepler-1647b-super-169.jpg)}button[_ngcontent-%COMP%]:hover{background:#cfd8dc;cursor:pointer}button[_ngcontent-%COMP%]{color:green;border-radius:3px;height:30px;border-color:transparent;background:transparent}button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}"]],data:{}});function Ls(e){return r._25(0,[r._21(402653184,1,{cesiumContainer:0}),(e()(),r._3(1,0,null,null,5,"button",[["type","button"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.markLocation()&&r),r},null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(3,0,null,null,2,"span",[],null,null,null,null,null)),(e()(),r._3(4,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-thumb-tack"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(9,0,null,null,2,"div",[["class","cesium-container"]],null,null,null,null,null)),r._2(10,278528,null,0,A,[r.r,r.k,r.B],{ngStyle:[0,"ngStyle"]},null),r._18(11,{display:0}),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(13,0,[[1,0],["cesiumContainer",1]],null,2,"div",[["class","cesium-container"]],null,null,null,null,null)),r._2(14,278528,null,0,A,[r.r,r.k,r.B],{ngStyle:[0,"ngStyle"]},null),r._18(15,{display:0}),(e()(),r._23(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,10,0,e(t,11,0,n.beforeMapTriggerd)),e(t,14,0,e(t,15,0,n.isMapTriggerd))},null)}var Fs=r.Z("app-cesium",Ss,function(e){return r._25(0,[(e()(),r._3(0,0,null,null,2,"app-cesium",[],null,null,null,Ls,Ns)),r._20(512,null,Do,Do,[Mo]),r._2(2,4440064,null,0,Ss,[Do,Nr],null,null)],function(e,t){e(t,2,0)},null)},{},{},[]),Bs=function(){function e(){}return e.prototype.ngOnInit=function(){},e}(),ks=r._1({encapsulation:0,styles:[["#header-navbar[_ngcontent-%COMP%]{height:9rem;background:#eee}#header-navbar[_ngcontent-%COMP%], #header-navbar[_ngcontent-%COMP%]   .header-panel[_ngcontent-%COMP%]{position:absolute;top:0;display:block;width:100%}#header-navbar[_ngcontent-%COMP%]   .header-panel[_ngcontent-%COMP%]{height:30px;background:#000}#header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#cfd8dc}#header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:3px;height:30px;border-color:transparent;background:#fff}#header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}#header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], #header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, #header-navbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}"]],data:{}});function Vs(e){return r._25(0,[(e()(),r._3(0,0,null,null,19,"div",[["class","header"],["id","header-navbar"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(4,0,null,null,1,"h1",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    Cookies Etc...\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(7,0,null,null,11,"nav",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(9,0,null,null,3,"button",[["type","button"]],null,null,null,null,null)),(e()(),r._3(10,0,null,null,2,"a",[["routerLink","/developers"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==r._16(e,11).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&i),i},null,null)),r._2(11,671744,null,0,bi,[yi,Nr,u],{routerLink:[0,"routerLink"]},null),(e()(),r._23(-1,null,["Developers"])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(14,0,null,null,3,"button",[["type","button"]],null,null,null,null,null)),(e()(),r._3(15,0,null,null,2,"a",[["routerLink","/dashboard"]],[[1,"target",0],[8,"href",4]],[[null,"click"]],function(e,t,n){var i=!0;return"click"===t&&(i=!1!==r._16(e,16).onClick(n.button,n.ctrlKey,n.metaKey,n.shiftKey)&&i),i},null,null)),r._2(16,671744,null,0,bi,[yi,Nr,u],{routerLink:[0,"routerLink"]},null),(e()(),r._23(-1,null,["dashboard"])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"]))],function(e,t){e(t,11,0,"/developers"),e(t,16,0,"/dashboard")},function(e,t){e(t,10,0,r._16(t,11).target,r._16(t,11).href),e(t,15,0,r._16(t,16).target,r._16(t,16).href)})}var zs=function(){function e(e,t){this.messeagesService=e,this.store=t,this.unSubscribe=new B.a,this.messages$=this.store.select("messages").pipe(Object(So.a)(this.unSubscribe))}return e.prototype.ngOnDestroy=function(){this.unSubscribe.next(),this.unSubscribe.complete()},e}(),Us=r._1({encapsulation:0,styles:[[".messages[_ngcontent-%COMP%]{display:inline-block;border:2px solid #eee;\n  width:48%;position:absolute;top:31em;left:0;min-height:30%;padding:3px;margin-left:5px;background-color:#ddd;z-index:-1}.messages[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;width:150px}.messages[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-color:transparent;background:transparent}.messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#cfd8dc;cursor:pointer}.messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-radius:3px;height:30px;border-color:transparent;background:transparent}.messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;font-size:16px}.messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .messages[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{color:#369}"]],data:{}});function Gs(e){return r._25(0,[(e()(),r._3(0,0,null,null,1,"li",[],null,null,null,null,null)),(e()(),r._23(1,null,["\n      ","\n    "]))],null,function(e,t){e(t,1,0,t.context.$implicit.title)})}function Ws(e){return r._25(0,[(e()(),r._3(0,0,null,null,16,"div",[["class","messages"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(2,0,null,null,1,"h2",[],null,null,null,null,null)),(e()(),r._23(-1,null,["messages:"])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(5,0,null,null,3,"button",[["type","button"]],null,[[null,"click"]],function(e,t,n){var r=!0;return"click"===t&&(r=!1!==e.component.messeagesService.clear()&&r),r},null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r._3(7,0,null,null,0,"i",[["aria-hidden","true"],["class","fa fa-2x fa-trash-o"]],null,null,null,null,null)),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._3(10,0,null,null,5,"ul",[],null,null,null,null,null)),(e()(),r._23(-1,null,["\n    "])),(e()(),r.Y(16777216,null,null,2,null,Gs)),r._2(13,802816,null,0,E,[r.M,r.J,r.q],{ngForOf:[0,"ngForOf"]},null),r._17(131072,O,[r.h]),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"]))],function(e,t){var n=t.component;e(t,13,0,r._24(t,13,0,r._16(t,14).transform(n.messages$)))},null)}function Hs(e){return r._25(0,[(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n      "])),(e()(),r._23(-1,null,["\n    "])),(e()(),r._23(-1,null,["\n  "])),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n\n"])),(e()(),r.Y(16777216,null,null,2,null,Ws)),r._2(12,16384,null,0,x,[r.M,r.J],{ngIf:[0,"ngIf"]},null),r._17(131072,O,[r.h]),(e()(),r._23(-1,null,["\n\n"]))],function(e,t){var n=t.component;e(t,12,0,r._24(t,12,0,r._16(t,13).transform(n.messages$)))},null)}var js=r._1({encapsulation:0,styles:[[""]],data:{}});function qs(e){return r._25(0,[(e()(),r._3(0,0,null,null,1,"app-header-nav",[],null,null,null,Vs,ks)),r._2(1,114688,null,0,Bs,[],null,null),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(4,16777216,null,null,1,"router-outlet",[],null,null,null,null,null)),r._2(5,212992,null,0,Ti,[xi,r.M,r.j,[8,null],r.h],null,null),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"])),(e()(),r._3(8,0,null,null,1,"app-messages",[],null,null,null,Hs,Us)),r._2(9,180224,null,0,zs,[Mo,Io.m],null,null),(e()(),r._23(-1,null,["\n"])),(e()(),r._23(-1,null,["\n"]))],function(e,t){e(t,1,0),e(t,5,0)},null)}var Ys,Xs=r.Z("app-root",o,function(e){return r._25(0,[(e()(),r._3(0,0,null,null,1,"app-root",[],null,null,null,qs,js)),r._2(1,49152,null,0,o,[],null,null)],null,null)},{},{},[]),Zs=n("uIf7"),Ks=function(){},Qs=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},Js={showLoader:!0,status:"none"};function $s(e,t){switch(void 0===e&&(e=Js),console.log(e,t),t.type){case qi:return Qs({},e);case Yi:case Xi:return Qs({},e,{loading:!1});default:return e}}(Ys||(Ys={})).LoadMessages="[Messages] Get";var el=function(){return function(e){console.log(e),this.type=Ys.LoadMessages,this.payload=e}}(),tl=[];function nl(e,t){switch(void 0===e&&(e=tl),t.type){case Ys.LoadMessages:return t.payload.slice()}}var rl,il=Object(Io.y)("messages"),ol=(Object(Io.A)(il,function(e){return e.messages}),n("2kLc")),al=this&&this.__extends||(rl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}rl(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),sl="__@ngrx/effects__";function ll(e){var t=(void 0===e?{dispatch:!0}:e).dispatch;return function(e,n){var r,i,o;r=[{propertyName:n,dispatch:t}],o=(i=e.constructor).hasOwnProperty(sl)?i[sl]:Object.defineProperty(i,sl,{value:[]})[sl],Array.prototype.push.apply(o,r)}}function ul(e){return Object.getPrototypeOf(e)}var cl=Object(Io.x)(function(e){return e.constructor[sl]||[]},ul),hl="ngrxOnRunEffects";function dl(e){var t,n,r,i,o=(n=ul(t=e).constructor.name,r=cl(t).map(function(e){var r=e.propertyName,i=e.dispatch,o="function"==typeof t[r]?t[r]():t[r];if(!1===i)return(function(){return this.lift(new yo)}).call(o);var a=(function(){return this.lift(new wo)}).call(o);return G.a.call(a,function(e){return{effect:t[r],notification:e,propertyName:r,sourceName:n,sourceInstance:t}})}),ol.a.apply(void 0,r));return i=ul(e),hl in i&&"function"==typeof i[hl]?e.ngrxOnRunEffects(o):o}var pl=function(e){function t(t){var n=e.call(this)||this;return t&&(n.source=t),n}return al(t,e),t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.ofType=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return bn.a.call(this,function(t){return e.some(function(e){return e===t.type})})},t}(H.a);function fl(e){var t=e.propertyName;return'"'+e.sourceName+"."+t+("function"==typeof e.sourceInstance[t]?"()":"")+'"'}new r.o("ngrx/effects: Immediate Effects");var ml=new r.o("ngrx/effects: Root Effects"),_l=(new r.o("ngrx/effects: Feature Effects"),new r.o("Browser Console")),gl=function(){function e(e){this.console=e}return e.prototype.report=function(e,t){this.console.group(e);for(var n in t)this.console.error(n+":",t[n]);this.console.groupEnd()},e}(),vl=function(e){function t(t){var n=e.call(this)||this;return n.errorReporter=t,n}return al(t,e),t.prototype.addEffects=function(e){this.next(e)},t.prototype.toActions=function(){var e=this;return W.call((function(e,t,n,r){return(i=e,o=t,a=n,s=r,function(e){return e.lift(new po(i,o,a,s))})(this);var i,o,a,s}).call(this,ul),function(t){return(function(){return this.lift(new io)}).call(bn.a.call(G.a.call((function(e,t){return(n=e,r=t,function(e){return e.lift(new so(n,r))})(this);var n,r}).call(t,dl),function(t){return function(e,t){if("E"===e.notification.kind){var n="Effect "+fl(e)+" threw an error";t.report(n,{Source:e.sourceInstance,Effect:e.effect,Error:e.notification.error,Notification:e.notification})}}(n=t,r=e.errorReporter),function(e,t){if("N"===e.notification.kind){var n=e.notification.value;if(!(i=n)||!i.type||"string"!=typeof i.type){var r="Effect "+fl(e)+" dispatched an invalid action";t.report(r,{Source:e.sourceInstance,Effect:e.effect,Dispatched:n,Notification:e.notification})}}var i}(n,r),t.notification;var n,r}),function(e){return"N"===e.kind}))})},t}(B.a),yl=function(){function e(e,t){this.effectSources=e,this.store=t,this.effectsSubscription=null}return e.prototype.start=function(){this.effectsSubscription||(this.effectsSubscription=this.effectSources.toActions().subscribe(this.store))},e.prototype.ngOnDestroy=function(){this.effectsSubscription&&(this.effectsSubscription.unsubscribe(),this.effectsSubscription=null)},e}(),Cl="@ngrx/effects/init",wl=function(){function e(e,t,n,r,i){this.sources=e,t.start(),r.forEach(function(t){return e.addEffects(t)}),n.dispatch({type:Cl})}return e.prototype.addEffects=function(e){this.sources.addEffects(e)},e}();function bl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}function El(){return console}H.a.prototype.catch=fe,H.a.prototype._catch=fe;var Sl=function(){function e(e,t,n){var r=this;this.http=e,this.actions$=t,this.messeagesService=n,this.addDeveloper=this.actions$.ofType(Xi).mergeMap(function(){return V(r.messeagesService.messages)}).map(function(e){return new el(e)}),this.loadDevelopers=this.actions$.ofType(qi).mergeMap(function(){return V(r.messeagesService.messages)}).map(function(e){return new el(e)})}return Object(a.b)([ll(),Object(a.d)("design:type",Object)],e.prototype,"addDeveloper",void 0),Object(a.b)([ll(),Object(a.d)("design:type",Object)],e.prototype,"loadDevelopers",void 0),e}(),xl=r._0(i,[o],function(e){return r._14([r._15(512,r.j,r.W,[[8,[Lo,Ho,Rs,Fs,Xs]],[3,r.j],r.v]),r._15(5120,r.s,r._13,[[3,r.s]]),r._15(4608,y,C,[r.s,[2,v]]),r._15(5120,r.c,r._4,[]),r._15(5120,r.q,r._10,[]),r._15(5120,r.r,r._11,[]),r._15(4608,cn,hn,[L]),r._15(6144,r.E,null,[cn]),r._15(4608,Nt,Lt,[]),r._15(5120,ot,function(e,t,n,r,i){return[new Ot(e,t),new Vt(n),new Ft(r,i)]},[L,r.x,L,L,Nt]),r._15(4608,at,at,[ot,r.x]),r._15(135680,ut,ut,[L]),r._15(4608,_t,_t,[at,ut]),r._15(6144,r.C,null,[_t]),r._15(6144,lt,null,[ut]),r._15(4608,r.K,r.K,[r.x]),r._15(4608,Qe,Qe,[L]),r._15(4608,tt,tt,[L]),r._15(4608,ha,ha,[]),r._15(5120,Nr,Ui,[yi]),r._15(4608,Mi,Mi,[]),r._15(6144,Pi,null,[Mi]),r._15(135680,Ii,Ii,[yi,r.u,r.i,r.p,Pi]),r._15(4608,Di,Di,[]),r._15(5120,ji,Hi,[Gi]),r._15(5120,r.b,function(e){return[e]},[ji]),r._15(135680,Io.k,Io.k,[Io.a,Io.i,Io.j,Io.d]),r._15(5120,Zs.c,Zs.d,[Zs.k,Zs.i]),r._15(4608,Do,Do,[Mo]),r._15(4608,Ua,Ua,[is]),r._15(512,N,N,[]),r._15(1024,r.l,Cn,[]),r._15(1024,r.w,function(){return[Li()]},[]),r._15(512,Gi,Gi,[r.p]),r._15(1024,r.d,function(e,t){return[(n=e,nt("probe",it),nt("coreTokens",Object(a.a)({},rt,(n||[]).reduce(function(e,t){return e[t.name]=t.token,e},{}))),function(){return it}),Wi(t)];var n},[[2,r.w],Gi]),r._15(512,r.e,r.e,[[2,r.d]]),r._15(131584,r.g,r.g,[r.x,r.X,r.p,r.l,r.j,r.e]),r._15(512,r.f,r.f,[r.g]),r._15(512,wn,wn,[[3,wn]]),r._15(512,Va,Va,[]),r._15(512,za,za,[]),r._15(512,vs,vs,[]),r._15(512,ys,ys,[]),r._15(1024,Ri,ki,[[3,yi]]),r._15(512,or,ar,[]),r._15(512,xi,xi,[]),r._15(256,Oi,{},[]),r._15(1024,u,Bi,[s,[2,c],Oi]),r._15(512,h,h,[u]),r._15(512,r.i,r.i,[]),r._15(512,r.u,r.H,[r.i,[2,r.I]]),r._15(1024,pi,function(){return[[{path:"developers",component:Ao},{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"dashboard",component:zo},{path:"detail/:id",component:Ds}]]},[]),r._15(1024,yi,zi,[r.g,or,xi,h,r.p,r.u,r.i,pi,Oi,[2,mi],[2,hi]]),r._15(512,Fi,Fi,[[2,Ri],[2,yi]]),r._15(512,Ks,Ks,[]),r._15(131584,Io.a,Io.a,[]),r._15(131584,Zs.h,Zs.h,[]),r._15(2048,Io.h,null,[Zs.h]),r._15(256,Io.r,void 0,[]),r._15(1024,Io.d,Io.v,[Io.r]),r._15(256,Io.q,{developers:$s,messages:nl},[]),r._15(2048,Io.t,null,[Io.q]),r._15(1024,Io.c,Io.u,[r.p,Io.q,Io.t]),r._15(256,Io.s,Io.w,[]),r._15(256,Io.e,[],[]),r._15(1024,Io.f,Io.z,[Io.s,Io.e]),r._15(131584,Io.g,Io.g,[Io.h,Io.d,Io.c,Io.f]),r._15(2048,Io.i,null,[Io.g]),r._15(131584,Io.j,Io.j,[]),r._15(512,Io.o,Io.o,[Io.a,Io.i,Io.j]),r._15(1024,_l,El,[]),r._15(512,gl,gl,[_l]),r._15(512,vl,vl,[gl]),r._15(1024,Zs.k,Zs.e,[]),r._15(512,Zs.l,Zs.l,[Zs.k]),r._15(256,Zs.j,{maxAge:25},[]),r._15(1024,Zs.i,Zs.g,[Zs.j]),r._15(512,Zs.a,Zs.a,[Zs.h,Io.a,Io.i,Zs.l,Io.j,Io.d,Zs.i]),r._15(1024,Io.l,Zs.f,[Zs.a]),r._15(512,Io.m,Io.m,[Io.l,Io.a,Io.g]),r._15(131584,yl,yl,[vl,Io.m]),r._15(512,cs,cs,[]),r._15(2048,us,null,[cs]),r._15(512,hs,hs,[us]),r._15(2048,Wa,null,[hs]),r._15(256,ds,"XSRF-TOKEN",[]),r._15(512,fs,ms,[L,r.z,ds]),r._15(256,ps,"X-XSRF-TOKEN",[]),r._15(512,_s,_s,[fs,ps]),r._15(1024,as,function(e){return[e]},[_s]),r._15(1024,Ga,gs,[Wa,[2,as]]),r._15(512,is,is,[Ga]),r._15(512,pl,pl,[Io.j]),r._15(512,Mo,Mo,[]),r._15(512,Sl,Sl,[is,pl,Mo]),r._15(1024,ml,bl,[Sl]),r._15(512,wl,wl,[vl,yl,Io.m,ml,[2,Io.n]]),r._15(512,Zs.b,Zs.b,[]),r._15(512,i,i,[])])});Object(r.Q)(),yn().bootstrapModuleFactory(xl).catch(function(e){return console.log(e)})},"dmC+":function(e,t,n){"use strict";t.a=function(e,t){return Object(r.a)(e,t)(this)};var r=n("qqDE")},eIqN:function(e,t,n){"use strict";t.a=function(){return function(e){return Object(i.a)()(Object(r.a)(a)(e))}};var r=n("LHF8"),i=n("RWQz"),o=n("TO51");function a(){return new o.a}},eoFs:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n("6Xbx"),i=n("TO51"),o=n("Upor"),a=function(e){function t(t){e.call(this),this._value=t}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new o.a;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(i.a)},fRUx:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},grVA:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r={closed:!0,next:function(e){},error:function(e){throw e},complete:function(){}}},gy58:function(e,t,n){"use strict";t.a=function(e){return Object(r.a)(e)(this)};var r=n("5O0w")},jaVc:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("6Xbx"),i=function(e){function t(t,n){e.call(this),this.subject=t,this.subscriber=n,this.closed=!1}return Object(r.c)(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n("qLnt").a)},kQVV:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){return e&&"number"==typeof e.length}},lI6h:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n("6Xbx"),i=function(e){function t(){e.apply(this,arguments)}return Object(r.c)(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(n("E9/g").a)},lfIl:function(e,t,r){!function(){var r,i,o,a,s;!function(e){function t(e,t){return y.call(e,t)}function n(e,t){var n,r,i,o,a,s,l,u,c,h,d,p=t&&t.split("/"),f=g.map,m=f&&f["*"]||{};if(e){for(a=(e=e.split("/")).length-1,g.nodeIdCompat&&w.test(e[a])&&(e[a]=e[a].replace(w,"")),"."===e[0].charAt(0)&&p&&(e=p.slice(0,p.length-1).concat(e)),c=0;c<e.length;c++)if(d=e[c],"."===d)e.splice(c,1),c-=1;else if(".."===d){if(0===c||1===c&&".."===e[2]||".."===e[c-1])continue;c>0&&(e.splice(c-1,2),c-=2)}e=e.join("/")}if((p||m)&&f){for(c=(n=e.split("/")).length;c>0;c-=1){if(r=n.slice(0,c).join("/"),p)for(h=p.length;h>0;h-=1)if(i=f[p.slice(0,h).join("/")],i&&(i=i[r])){o=i,s=c;break}if(o)break;!l&&m&&m[r]&&(l=m[r],u=c)}!o&&l&&(o=l,s=u),o&&(n.splice(0,s,o),e=n.join("/"))}return e}function a(t,n){return function(){var r=C.call(arguments,0);return"string"!=typeof r[0]&&1===r.length&&r.push(null),d.apply(e,r.concat([t,n]))}}function s(e){return function(t){m[e]=t}}function l(n){if(t(_,n)){var r=_[n];delete _[n],v[n]=!0,h.apply(e,r)}if(!t(m,n)&&!t(v,n))throw new Error("No "+n);return m[n]}function u(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return e?u(e):[]}var h,d,p,f,m={},_={},g={},v={},y=Object.prototype.hasOwnProperty,C=[].slice,w=/\.js$/;p=function(e,t){var r,i,o=u(e),a=o[0],s=t[1];return e=o[1],a&&(r=l(a=n(a,s))),a?e=r&&r.normalize?r.normalize(e,(i=s,function(e){return n(e,i)})):n(e,s):(e=(o=u(e=n(e,s)))[1],(a=o[0])&&(r=l(a))),{f:a?a+"!"+e:e,n:e,pr:a,p:r}},f={require:function(e){return a(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:(t=e,function(){return g&&g.config&&g.config[t]||{}})};var t}},h=function(n,r,i,o){var u,h,d,g,y,C,w,b=[],E=typeof i;if(C=c(o=o||n),"undefined"===E||"function"===E){for(r=!r.length&&i.length?["require","exports","module"]:r,y=0;y<r.length;y+=1)if(g=p(r[y],C),h=g.f,"require"===h)b[y]=f.require(n);else if("exports"===h)b[y]=f.exports(n),w=!0;else if("module"===h)u=b[y]=f.module(n);else if(t(m,h)||t(_,h)||t(v,h))b[y]=l(h);else{if(!g.p)throw new Error(n+" missing "+h);g.p.load(g.n,a(o,!0),s(h),{}),b[y]=m[h]}d=i?i.apply(m[n],b):void 0,n&&(u&&u.exports!==e&&u.exports!==m[n]?m[n]=u.exports:d===e&&w||(m[n]=d))}else n&&(m[n]=i)},r=i=d=function(t,n,r,i,o){if("string"==typeof t)return f[t]?f[t](n):l(p(t,c(n)).f);if(!t.splice){if((g=t).deps&&d(g.deps,g.callback),!n)return;n.splice?(t=n,n=r,r=null):t=e}return n=n||function(){},"function"==typeof r&&(r=i,i=o),i?h(e,t,n,r):setTimeout(function(){h(e,t,n,r)},4),d},d.config=function(e){return d(e)},r._defined=m,(o=function(e,n,r){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");n.splice||(r=n,n=[]),t(m,e)||t(_,e)||(_[e]=[e,n,r])}).amd={jQuery:!0}}(),o("Core/appendForwardSlash",[],function(){"use strict";return function(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}}),function(t){"use strict";("function"==typeof o&&o.amd?o:function(t){e.exports=t()})("ThirdParty/when",[],function(){function e(e,n,r,i){return t(e).then(n,r,i)}function t(e){var a,s,l;return e instanceof n?a=e:o(e)?(s=i(),e.then(function(e){s.resolve(e)},function(e){s.reject(e)},function(e){s.progress(e)}),a=s.promise):(l=e,a=new n(function(e){try{return t(e?e(l):l)}catch(e){return r(e)}})),a}function n(e){this.then=e}function r(e){return new n(function(n,i){try{return i?t(i(e)):r(e)}catch(e){return r(e)}})}function i(){function e(e,t,n){return p(e,t,n)}function o(e){return _(e)}function a(e){return _(r(e))}function s(e){return f(e)}var l,c,d,p,f,_;return l=new n(e),c=[],d=[],p=function(e,t,n){var r,o;return r=i(),o="function"==typeof n?function(e){try{r.progress(n(e))}catch(e){r.progress(e)}}:function(e){r.progress(e)},c.push(function(n){n.then(e,t).then(r.resolve,r.reject,o)}),d.push(o),r.promise},f=function(e){return u(d,e),e},_=function(e){return e=t(e),p=e.then,_=t,f=h,u(c,e),d=c=m,e},{then:e,resolve:o,reject:a,progress:s,promise:l,resolver:{resolve:o,reject:a,progress:s}}}function o(e){return e&&"function"==typeof e.then}function a(t,n,r,o,a){return c(2,arguments),e(t,function(t){function s(e){_(e)}function l(e){m(e)}var u,c,d,p,f,m,_,g,v,y;if(v=t.length>>>0,u=Math.max(0,Math.min(n,v)),d=[],c=v-u+1,p=[],f=i(),u)for(g=f.progress,_=function(e){p.push(e),--c||(m=_=h,f.reject(p))},m=function(e){d.push(e),--u||(m=_=h,f.resolve(d))},y=0;y<v;++y)y in t&&e(t[y],l,s,g);else f.resolve(d);return f.then(r,o,a)})}function s(e,t,n,r){return c(1,arguments),l(e,d).then(t,n,r)}function l(t,n){return e(t,function(t){var r,o,a,s,l,u;if(a=o=t.length>>>0,r=[],u=i(),a)for(s=function(t,i){e(t,n).then(function(e){r[i]=e,--a||u.resolve(r)},u.reject)},l=0;l<o;l++)l in t?s(t[l],l):--a;else u.resolve(r);return u.promise})}function u(e,t){for(var n,r=0;n=e[r++];)n(t)}function c(e,t){for(var n,r=t.length;r>e;)if(n=t[--r],null!=n&&"function"!=typeof n)throw new Error("arg "+r+" must be a function")}function h(){}function d(e){return e}var p,f,m;return e.defer=i,e.resolve=t,e.reject=function(t){return e(t,r)},e.join=function(){return l(arguments,d)},e.all=s,e.map=l,e.reduce=function(t,n){var r=f.call(arguments,1);return e(t,function(t){var i;return i=t.length,r[0]=function(t,r,o){return e(t,function(t){return e(r,function(e){return n(t,e,o,i)})})},p.apply(t,r)})},e.any=function(e,t,n,r){return a(e,1,function(e){return t?t(e[0]):e[0]},n,r)},e.some=a,e.chain=function(t,n,i){var o=arguments.length>2;return e(t,function(e){return n.resolve(e=o?i:e),e},function(e){return n.reject(e),r(e)},n.progress)},e.isPromise=o,n.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(m,e)},yield:function(e){return this.then(function(){return e})},spread:function(e){return this.then(function(t){return s(t,function(t){return e.apply(m,t)})})}},f=[].slice,p=[].reduce||function(e){var t,n,r,i,o;if(o=0,i=(t=Object(this)).length>>>0,(n=arguments).length<=1)for(;;){if(o in t){r=t[o++];break}if(++o>=i)throw new TypeError}else r=n[1];for(;o<i;++o)o in t&&(r=e(r,t[o],o,t));return r},e})}(),o("Core/defined",[],function(){"use strict";return function(e){return void 0!==e&&null!==e}}),o("Core/defineProperties",["./defined"],function(e){"use strict";var t=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),n=Object.defineProperties;return t&&e(n)||(n=function(e){return e}),n}),o("Core/DeveloperError",["./defined"],function(e){"use strict";function t(e){var t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&((t.prototype=Object.create(Error.prototype)).constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t.throwInstantiationError=function(){throw new t("This function defines an interface and should not be called directly.")},t}),o("Core/Credit",["./defined","./defineProperties","./DeveloperError"],function(e,t,n){"use strict";function r(t,n,r){var a=e(r),s=e(n);e(t)||s||(t=r),this._text=t,this._imageUrl=n,this._link=r,this._hasLink=a,this._hasImage=s;var l,u=JSON.stringify([t,n,r]);e(o[u])?l=o[u]:(l=i++,o[u]=l),this._id=l}var i=0,o={};return t(r.prototype,{text:{get:function(){return this._text}},imageUrl:{get:function(){return this._imageUrl}},link:{get:function(){return this._link}},id:{get:function(){return this._id}}}),r.prototype.hasImage=function(){return this._hasImage},r.prototype.hasLink=function(){return this._hasLink},r.equals=function(t,n){return t===n||e(t)&&e(n)&&t._id===n._id},r.prototype.equals=function(e){return r.equals(this,e)},r}),o("Core/freezeObject",["./defined"],function(e){"use strict";var t=Object.freeze;return e(t)||(t=function(e){return e}),t}),o("Core/defaultValue",["./freezeObject"],function(e){"use strict";function t(e,t){return void 0!==e?e:t}return t.EMPTY_OBJECT=e({}),t}),o("ThirdParty/mersenne-twister",[],function(){var e=function(e){void 0==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};return e.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++)this.mt[this.mti]=(1812433253*((4294901760&(e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30))>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0},e.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var n;for(this.mti==this.N+1&&this.init_genrand(5489),n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UPPER_MASK|this.mt[n+1]&this.LOWER_MASK,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];this.mt[this.N-1]=this.mt[this.M-1]^(e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK)>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},e.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},e}),o("Core/Math",["../ThirdParty/mersenne-twister","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";var i={};i.EPSILON1=.1,i.EPSILON2=.01,i.EPSILON3=.001,i.EPSILON4=1e-4,i.EPSILON5=1e-5,i.EPSILON6=1e-6,i.EPSILON7=1e-7,i.EPSILON8=1e-8,i.EPSILON9=1e-9,i.EPSILON10=1e-10,i.EPSILON11=1e-11,i.EPSILON12=1e-12,i.EPSILON13=1e-13,i.EPSILON14=1e-14,i.EPSILON15=1e-15,i.EPSILON16=1e-16,i.EPSILON17=1e-17,i.EPSILON18=1e-18,i.EPSILON19=1e-19,i.EPSILON20=1e-20,i.GRAVITATIONALPARAMETER=3986004418e5,i.SOLAR_RADIUS=6955e5,i.LUNAR_RADIUS=1737400,i.SIXTY_FOUR_KILOBYTES=65536,i.sign=function(e){return e>0?1:e<0?-1:0},i.signNotZero=function(e){return e<0?-1:1},i.toSNorm=function(e,n){return n=t(n,255),Math.round((.5*i.clamp(e,-1,1)+.5)*n)},i.fromSNorm=function(e,n){return n=t(n,255),i.clamp(e,0,n)/n*2-1},i.sinh=function(e){return.5*(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))},i.cosh=function(e){return.5*(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))},i.lerp=function(e,t,n){return(1-n)*e+n*t},i.PI=Math.PI,i.ONE_OVER_PI=1/Math.PI,i.PI_OVER_TWO=.5*Math.PI,i.PI_OVER_THREE=Math.PI/3,i.PI_OVER_FOUR=Math.PI/4,i.PI_OVER_SIX=Math.PI/6,i.THREE_PI_OVER_TWO=3*Math.PI*.5,i.TWO_PI=2*Math.PI,i.ONE_OVER_TWO_PI=1/(2*Math.PI),i.RADIANS_PER_DEGREE=Math.PI/180,i.DEGREES_PER_RADIAN=180/Math.PI,i.RADIANS_PER_ARCSECOND=i.RADIANS_PER_DEGREE/3600,i.toRadians=function(e){return e*i.RADIANS_PER_DEGREE},i.toDegrees=function(e){return e*i.DEGREES_PER_RADIAN},i.convertLongitudeRange=function(e){var t=i.TWO_PI,n=e-Math.floor(e/t)*t;return n<-Math.PI?n+t:n>=Math.PI?n-t:n},i.clampToLatitudeRange=function(e){return i.clamp(e,-1*i.PI_OVER_TWO,i.PI_OVER_TWO)},i.negativePiToPi=function(e){return i.zeroToTwoPi(e+i.PI)-i.PI},i.zeroToTwoPi=function(e){var t=i.mod(e,i.TWO_PI);return Math.abs(t)<i.EPSILON14&&Math.abs(e)>i.EPSILON14?i.TWO_PI:t},i.mod=function(e,t){return(e%t+t)%t},i.equalsEpsilon=function(e,n,r,i){i=t(i,r);var o=Math.abs(e-n);return o<=i||o<=r*Math.max(Math.abs(e),Math.abs(n))};var o=[1];i.factorial=function(e){var t=o.length;if(e>=t)for(var n=o[t-1],r=t;r<=e;r++)o.push(n*r);return o[e]},i.incrementWrap=function(e,n,r){return r=t(r,0),++e>n&&(e=r),e},i.isPowerOfTwo=function(e){return 0!==e&&0==(e&e-1)},i.nextPowerOfTwo=function(e){return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},i.clamp=function(e,t,n){return e<t?t:e>n?n:e};var a=new e;return i.setRandomNumberSeed=function(t){a=new e(t)},i.nextRandomNumber=function(){return a.random()},i.acosClamped=function(e){return Math.acos(i.clamp(e,-1,1))},i.asinClamped=function(e){return Math.asin(i.clamp(e,-1,1))},i.chordLength=function(e,t){return 2*t*Math.sin(.5*e)},i.logBase=function(e,t){return Math.log(e)/Math.log(t)},i.fog=function(e,t){var n=e*t;return 1-Math.exp(-n*n)},i}),o("Core/Cartesian3",["./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i){"use strict";function o(t,n,r){this.x=e(t,0),this.y=e(n,0),this.z=e(r,0)}o.fromSpherical=function(n,r){t(r)||(r=new o);var i=n.clock,a=n.cone,s=e(n.magnitude,1),l=s*Math.sin(a);return r.x=l*Math.cos(i),r.y=l*Math.sin(i),r.z=s*Math.cos(a),r},o.fromElements=function(e,n,r,i){return t(i)?(i.x=e,i.y=n,i.z=r,i):new o(e,n,r)},o.fromCartesian4=o.clone=function(e,n){if(t(e))return t(n)?(n.x=e.x,n.y=e.y,n.z=e.z,n):new o(e.x,e.y,e.z)},o.packedLength=3,o.pack=function(t,n,r){return r=e(r,0),n[r++]=t.x,n[r++]=t.y,n[r]=t.z,n},o.unpack=function(n,r,i){return r=e(r,0),t(i)||(i=new o),i.x=n[r++],i.y=n[r++],i.z=n[r],i},o.packArray=function(e,n){var r=e.length;t(n)?n.length=3*r:n=new Array(3*r);for(var i=0;i<r;++i)o.pack(e[i],n,3*i);return n},o.unpackArray=function(e,n){var r=e.length;t(n)?n.length=r/3:n=new Array(r/3);for(var i=0;i<r;i+=3){var a=i/3;n[a]=o.unpack(e,i,n[a])}return n},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y,e.z)},o.minimumComponent=function(e){return Math.min(e.x,e.y,e.z)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var a=new o;o.distance=function(e,t){return o.subtract(e,t,a),o.magnitude(a)},o.distanceSquared=function(e,t){return o.subtract(e,t,a),o.magnitudeSquared(a)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var s=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,s),r=o.multiplyByScalar(e,1-n,r),o.add(s,r,r)};var l=new o,u=new o;o.angleBetween=function(e,t){o.normalize(e,l),o.normalize(t,u);var n=o.dot(l,u),r=o.magnitude(o.cross(l,u,l));return Math.atan2(r,n)};var c=new o;o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,c);return o.abs(n,n),o.clone(n.x<=n.y?n.x<=n.z?o.UNIT_X:o.UNIT_Z:n.y<=n.z?o.UNIT_Y:o.UNIT_Z,t)},o.equals=function(e,n){return e===n||t(e)&&t(n)&&e.x===n.x&&e.y===n.y&&e.z===n.z},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]},o.equalsEpsilon=function(e,n,r,o){return e===n||t(e)&&t(n)&&i.equalsEpsilon(e.x,n.x,r,o)&&i.equalsEpsilon(e.y,n.y,r,o)&&i.equalsEpsilon(e.z,n.z,r,o)},o.cross=function(e,t,n){var r=e.x,i=e.y,o=e.z,a=t.x,s=t.y,l=t.z,u=o*a-r*l,c=r*s-i*a;return n.x=i*l-o*s,n.y=u,n.z=c,n},o.fromDegrees=function(e,t,n,r,a){return e=i.toRadians(e),t=i.toRadians(t),o.fromRadians(e,t,n,r,a)};var h=new o,d=new o,p=new o(40680631590769,40680631590769,40408299984661.445);return o.fromRadians=function(n,r,i,a,s){i=e(i,0);var l=t(a)?a.radiiSquared:p,u=Math.cos(r);h.x=u*Math.cos(n),h.y=u*Math.sin(n),h.z=Math.sin(r),h=o.normalize(h,h),o.multiplyComponents(l,h,d);var c=Math.sqrt(o.dot(h,d));return d=o.divideByScalar(d,c,d),h=o.multiplyByScalar(h,i,h),t(s)||(s=new o),o.add(d,h,s)},o.fromDegreesArray=function(e,n,r){var i=e.length;t(r)?r.length=i/2:r=new Array(i/2);for(var a=0;a<i;a+=2){var s=a/2;r[s]=o.fromDegrees(e[a],e[a+1],0,n,r[s])}return r},o.fromRadiansArray=function(e,n,r){var i=e.length;t(r)?r.length=i/2:r=new Array(i/2);for(var a=0;a<i;a+=2){var s=a/2;r[s]=o.fromRadians(e[a],e[a+1],0,n,r[s])}return r},o.fromDegreesArrayHeights=function(e,n,r){var i=e.length;t(r)?r.length=i/3:r=new Array(i/3);for(var a=0;a<i;a+=3){var s=a/3;r[s]=o.fromDegrees(e[a],e[a+1],e[a+2],n,r[s])}return r},o.fromRadiansArrayHeights=function(e,n,r){var i=e.length;t(r)?r.length=i/3:r=new Array(i/3);for(var a=0;a<i;a+=3){var s=a/3;r[s]=o.fromRadians(e[a],e[a+1],e[a+2],n,r[s])}return r},o.ZERO=r(new o(0,0,0)),o.UNIT_X=r(new o(1,0,0)),o.UNIT_Y=r(new o(0,1,0)),o.UNIT_Z=r(new o(0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},o}),o("Core/scaleToGeodeticSurface",["./Cartesian3","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";var i=new e,o=new e;return function(n,a,s,l,u){var c=n.x,h=n.y,d=n.z,p=a.x,f=a.y,m=a.z,_=c*c*p*p,g=h*h*f*f,v=d*d*m*m,y=_+g+v,C=Math.sqrt(1/y),w=e.multiplyByScalar(n,C,i);if(y<l)return isFinite(C)?e.clone(w,u):void 0;var b=s.x,E=s.y,S=s.z,x=o;x.x=w.x*b*2,x.y=w.y*E*2,x.z=w.z*S*2;var T,A,P,D,M,I,O,R=(1-C)*e.magnitude(n)/(.5*e.magnitude(x)),N=0;do{N=(T=_*(M=(A=1/(1+(R-=N)*b))*A)+g*(I=(P=1/(1+R*E))*P)+v*(O=(D=1/(1+R*S))*D)-1)/(-2*(_*(M*A)*b+g*(I*P)*E+v*(O*D)*S))}while(Math.abs(T)>r.EPSILON12);return t(u)?(u.x=c*A,u.y=h*P,u.z=d*D,u):new e(c*A,h*P,d*D)}}),o("Core/Cartographic",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,o,a){"use strict";function s(e,n,r){this.longitude=t(e,0),this.latitude=t(n,0),this.height=t(r,0)}s.fromRadians=function(e,r,i,o){return i=t(i,0),n(o)?(o.longitude=e,o.latitude=r,o.height=i,o):new s(e,r,i)},s.fromDegrees=function(e,t,n,r){return e=o.toRadians(e),t=o.toRadians(t),s.fromRadians(e,t,n,r)};var l=new e,u=new e,c=new e,h=new e(1/6378137,1/6378137,1/6356752.314245179),d=new e(1/40680631590769,1/40680631590769,1/40408299984661.445),p=o.EPSILON1;return s.fromCartesian=function(t,r,i){var f=n(r)?r.oneOverRadii:h,m=n(r)?r.oneOverRadiiSquared:d,_=n(r)?r._centerToleranceSquared:p,g=a(t,f,m,_,u);if(n(g)){var v=e.multiplyComponents(t,m,l);v=e.normalize(v,v);var y=e.subtract(t,g,c),C=Math.atan2(v.y,v.x),w=Math.asin(v.z),b=o.sign(e.dot(y,t))*e.magnitude(y);return n(i)?(i.longitude=C,i.latitude=w,i.height=b,i):new s(C,w,b)}},s.clone=function(e,t){if(n(e))return n(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new s(e.longitude,e.latitude,e.height)},s.equals=function(e,t){return e===t||n(e)&&n(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},s.equalsEpsilon=function(e,t,r){return e===t||n(e)&&n(t)&&Math.abs(e.longitude-t.longitude)<=r&&Math.abs(e.latitude-t.latitude)<=r&&Math.abs(e.height-t.height)<=r},s.ZERO=i(new s(0,0,0)),s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,t){return s.equalsEpsilon(this,e,t)},s.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},s}),o("Core/Ellipsoid",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./scaleToGeodeticSurface"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t,r,i,o){r=n(r,0),i=n(i,0),o=n(o,0),t._radii=new e(r,i,o),t._radiiSquared=new e(r*r,i*i,o*o),t._radiiToTheFourth=new e(r*r*r*r,i*i*i*i,o*o*o*o),t._oneOverRadii=new e(0===r?0:1/r,0===i?0:1/i,0===o?0:1/o),t._oneOverRadiiSquared=new e(0===r?0:1/(r*r),0===i?0:1/(i*i),0===o?0:1/(o*o)),t._minimumRadius=Math.min(r,i,o),t._maximumRadius=Math.max(r,i,o),t._centerToleranceSquared=s.EPSILON1}function c(e,t,n){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,u(this,e,t,n)}i(c.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),c.clone=function(t,n){if(r(t)){var i=t._radii;return r(n)?(e.clone(i,n._radii),e.clone(t._radiiSquared,n._radiiSquared),e.clone(t._radiiToTheFourth,n._radiiToTheFourth),e.clone(t._oneOverRadii,n._oneOverRadii),e.clone(t._oneOverRadiiSquared,n._oneOverRadiiSquared),n._minimumRadius=t._minimumRadius,n._maximumRadius=t._maximumRadius,n._centerToleranceSquared=t._centerToleranceSquared,n):new c(i.x,i.y,i.z)}},c.fromCartesian3=function(e,t){return r(t)||(t=new c),r(e)?(u(t,e.x,e.y,e.z),t):t},c.WGS84=a(new c(6378137,6378137,6356752.314245179)),c.UNIT_SPHERE=a(new c(1,1,1)),c.MOON=a(new c(s.LUNAR_RADIUS,s.LUNAR_RADIUS,s.LUNAR_RADIUS)),c.prototype.clone=function(e){return c.clone(this,e)},c.packedLength=e.packedLength,c.pack=function(t,r,i){return i=n(i,0),e.pack(t._radii,r,i),r},c.unpack=function(t,r,i){r=n(r,0);var o=e.unpack(t,r);return c.fromCartesian3(o,i)},c.prototype.geocentricSurfaceNormal=e.normalize,c.prototype.geodeticSurfaceNormalCartographic=function(t,n){var i=t.longitude,o=t.latitude,a=Math.cos(o),s=a*Math.cos(i),l=a*Math.sin(i),u=Math.sin(o);return r(n)||(n=new e),n.x=s,n.y=l,n.z=u,e.normalize(n,n)},c.prototype.geodeticSurfaceNormal=function(t,n){return r(n)||(n=new e),n=e.multiplyComponents(t,this._oneOverRadiiSquared,n),e.normalize(n,n)};var h=new e,d=new e;c.prototype.cartographicToCartesian=function(t,n){var i=h,o=d;this.geodeticSurfaceNormalCartographic(t,i),e.multiplyComponents(this._radiiSquared,i,o);var a=Math.sqrt(e.dot(i,o));return e.divideByScalar(o,a,o),e.multiplyByScalar(i,t.height,i),r(n)||(n=new e),e.add(o,i,n)},c.prototype.cartographicArrayToCartesianArray=function(e,t){var n=e.length;r(t)?t.length=n:t=new Array(n);for(var i=0;i<n;i++)t[i]=this.cartographicToCartesian(e[i],t[i]);return t};var p=new e,f=new e,m=new e;return c.prototype.cartesianToCartographic=function(n,i){var o=this.scaleToGeodeticSurface(n,f);if(r(o)){var a=this.geodeticSurfaceNormal(o,p),l=e.subtract(n,o,m),u=Math.atan2(a.y,a.x),c=Math.asin(a.z),h=s.sign(e.dot(l,n))*e.magnitude(l);return r(i)?(i.longitude=u,i.latitude=c,i.height=h,i):new t(u,c,h)}},c.prototype.cartesianArrayToCartographicArray=function(e,t){var n=e.length;r(t)?t.length=n:t=new Array(n);for(var i=0;i<n;++i)t[i]=this.cartesianToCartographic(e[i],t[i]);return t},c.prototype.scaleToGeodeticSurface=function(e,t){return l(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},c.prototype.scaleToGeocentricSurface=function(t,n){r(n)||(n=new e);var i=t.x,o=t.y,a=t.z,s=this._oneOverRadiiSquared,l=1/Math.sqrt(i*i*s.x+o*o*s.y+a*a*s.z);return e.multiplyByScalar(t,l,n)},c.prototype.transformPositionToScaledSpace=function(t,n){return r(n)||(n=new e),e.multiplyComponents(t,this._oneOverRadii,n)},c.prototype.transformPositionFromScaledSpace=function(t,n){return r(n)||(n=new e),e.multiplyComponents(t,this._radii,n)},c.prototype.equals=function(t){return this===t||r(t)&&e.equals(this._radii,t._radii)},c.prototype.toString=function(){return this._radii.toString()},c}),o("Core/Event",["./defined","./defineProperties","./DeveloperError"],function(e,t,n){"use strict";function r(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}return t(r.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),r.prototype.addEventListener=function(e,t){this._listeners.push(e),this._scopes.push(t);var n=this;return function(){n.removeEventListener(e,t)}},r.prototype.removeEventListener=function(e,t){for(var n=this._listeners,r=this._scopes,i=-1,o=0;o<n.length;o++)if(n[o]===e&&r[o]===t){i=o;break}return-1!==i&&(this._insideRaiseEvent?(this._toRemove.push(i),n[i]=void 0,r[i]=void 0):(n.splice(i,1),r.splice(i,1)),!0)},r.prototype.raiseEvent=function(){this._insideRaiseEvent=!0;var t,n=this._listeners,r=this._scopes,i=n.length;for(t=0;t<i;t++)e(n[t])&&n[t].apply(r[t],arguments);var o=this._toRemove;for(i=o.length,t=0;t<i;t++){var a=o[t];n.splice(a,1),r.splice(a,1)}o.length=0,this._insideRaiseEvent=!1},r}),o("Core/Cartesian2",["./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i){"use strict";function o(t,n){this.x=e(t,0),this.y=e(n,0)}o.fromElements=function(e,n,r){return t(r)?(r.x=e,r.y=n,r):new o(e,n)},o.fromCartesian3=o.clone=function(e,n){if(t(e))return t(n)?(n.x=e.x,n.y=e.y,n):new o(e.x,e.y)},o.fromCartesian4=o.clone,o.packedLength=2,o.pack=function(t,n,r){return r=e(r,0),n[r++]=t.x,n[r]=t.y,n},o.unpack=function(n,r,i){return r=e(r,0),t(i)||(i=new o),i.x=n[r++],i.y=n[r],i},o.packArray=function(e,n){var r=e.length;t(n)?n.length=2*r:n=new Array(2*r);for(var i=0;i<r;++i)o.pack(e[i],n,2*i);return n},o.unpackArray=function(e,n){var r=e.length;t(n)?n.length=r/2:n=new Array(r/2);for(var i=0;i<r;i+=2){var a=i/2;n[a]=o.unpack(e,i,n[a])}return n},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y)},o.minimumComponent=function(e){return Math.min(e.x,e.y)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var a=new o;o.distance=function(e,t){return o.subtract(e,t,a),o.magnitude(a)},o.distanceSquared=function(e,t){return o.subtract(e,t,a),o.magnitudeSquared(a)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var s=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,s),r=o.multiplyByScalar(e,1-n,r),o.add(s,r,r)};var l=new o,u=new o;o.angleBetween=function(e,t){return o.normalize(e,l),o.normalize(t,u),i.acosClamped(o.dot(l,u))};var c=new o;return o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,c);return o.abs(n,n),o.clone(n.x<=n.y?o.UNIT_X:o.UNIT_Y,t)},o.equals=function(e,n){return e===n||t(e)&&t(n)&&e.x===n.x&&e.y===n.y},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]},o.equalsEpsilon=function(e,n,r,o){return e===n||t(e)&&t(n)&&i.equalsEpsilon(e.x,n.x,r,o)&&i.equalsEpsilon(e.y,n.y,r,o)},o.ZERO=r(new o(0,0)),o.UNIT_X=r(new o(1,0)),o.UNIT_Y=r(new o(0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+")"},o}),o("Core/GeographicProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid"],function(e,t,n,r,i,o,a){"use strict";function s(e){this._ellipsoid=n(e,a.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),s.prototype.project=function(t,n){var i=this._semimajorAxis,o=t.longitude*i,a=t.latitude*i,s=t.height;return r(n)?(n.x=o,n.y=a,n.z=s,n):new e(o,a,s)},s.prototype.unproject=function(e,n){var i=this._oneOverSemimajorAxis,o=e.x*i,a=e.y*i,s=e.z;return r(n)?(n.longitude=o,n.latitude=a,n.height=s,n):new t(o,a,s)},s}),o("Core/Rectangle",["./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./freezeObject","./Math"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,n,r,i){this.west=t(e,0),this.south=t(n,0),this.east=t(r,0),this.north=t(i,0)}r(l.prototype,{width:{get:function(){return l.computeWidth(this)}},height:{get:function(){return l.computeHeight(this)}}}),l.packedLength=4,l.pack=function(e,n,r){return r=t(r,0),n[r++]=e.west,n[r++]=e.south,n[r++]=e.east,n[r]=e.north,n},l.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new l),i.west=e[r++],i.south=e[r++],i.east=e[r++],i.north=e[r],i},l.computeWidth=function(e){var t=e.east,n=e.west;return t<n&&(t+=s.TWO_PI),t-n},l.computeHeight=function(e){return e.north-e.south},l.fromDegrees=function(e,r,i,o,a){return e=s.toRadians(t(e,0)),r=s.toRadians(t(r,0)),i=s.toRadians(t(i,0)),o=s.toRadians(t(o,0)),n(a)?(a.west=e,a.south=r,a.east=i,a.north=o,a):new l(e,r,i,o)},l.fromCartographicArray=function(e,t){for(var r=Number.MAX_VALUE,i=-Number.MAX_VALUE,o=Number.MAX_VALUE,a=-Number.MAX_VALUE,u=Number.MAX_VALUE,c=-Number.MAX_VALUE,h=0,d=e.length;h<d;h++){var p=e[h];r=Math.min(r,p.longitude),i=Math.max(i,p.longitude),u=Math.min(u,p.latitude),c=Math.max(c,p.latitude);var f=p.longitude>=0?p.longitude:p.longitude+s.TWO_PI;o=Math.min(o,f),a=Math.max(a,f)}return i-r>a-o&&(r=o,(i=a)>s.PI&&(i-=s.TWO_PI),r>s.PI&&(r-=s.TWO_PI)),n(t)?(t.west=r,t.south=u,t.east=i,t.north=c,t):new l(r,u,i,c)},l.fromCartesianArray=function(e,t,r){for(var i=Number.MAX_VALUE,o=-Number.MAX_VALUE,a=Number.MAX_VALUE,u=-Number.MAX_VALUE,c=Number.MAX_VALUE,h=-Number.MAX_VALUE,d=0,p=e.length;d<p;d++){var f=t.cartesianToCartographic(e[d]);i=Math.min(i,f.longitude),o=Math.max(o,f.longitude),c=Math.min(c,f.latitude),h=Math.max(h,f.latitude);var m=f.longitude>=0?f.longitude:f.longitude+s.TWO_PI;a=Math.min(a,m),u=Math.max(u,m)}return o-i>u-a&&(i=a,(o=u)>s.PI&&(o-=s.TWO_PI),i>s.PI&&(i-=s.TWO_PI)),n(r)?(r.west=i,r.south=c,r.east=o,r.north=h,r):new l(i,c,o,h)},l.clone=function(e,t){if(n(e))return n(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new l(e.west,e.south,e.east,e.north)},l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.equals=function(e,t){return e===t||n(e)&&n(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},l.prototype.equalsEpsilon=function(e,t){return n(e)&&Math.abs(this.west-e.west)<=t&&Math.abs(this.south-e.south)<=t&&Math.abs(this.east-e.east)<=t&&Math.abs(this.north-e.north)<=t},l.validate=function(e){},l.southwest=function(t,r){return n(r)?(r.longitude=t.west,r.latitude=t.south,r.height=0,r):new e(t.west,t.south)},l.northwest=function(t,r){return n(r)?(r.longitude=t.west,r.latitude=t.north,r.height=0,r):new e(t.west,t.north)},l.northeast=function(t,r){return n(r)?(r.longitude=t.east,r.latitude=t.north,r.height=0,r):new e(t.east,t.north)},l.southeast=function(t,r){return n(r)?(r.longitude=t.east,r.latitude=t.south,r.height=0,r):new e(t.east,t.south)},l.center=function(t,r){var i=t.east,o=t.west;i<o&&(i+=s.TWO_PI);var a=s.negativePiToPi(.5*(o+i)),l=.5*(t.south+t.north);return n(r)?(r.longitude=a,r.latitude=l,r.height=0,r):new e(a,l)},l.intersection=function(e,t,r){var i=e.east,o=e.west,a=t.east,u=t.west;i<o&&a>0?i+=s.TWO_PI:a<u&&i>0&&(a+=s.TWO_PI),i<o&&u<0?u+=s.TWO_PI:a<u&&o<0&&(o+=s.TWO_PI);var c=s.negativePiToPi(Math.max(o,u)),h=s.negativePiToPi(Math.min(i,a));if(!((e.west<e.east||t.west<t.east)&&h<=c)){var d=Math.max(e.south,t.south),p=Math.min(e.north,t.north);if(!(d>=p))return n(r)?(r.west=c,r.south=d,r.east=h,r.north=p,r):new l(c,d,h,p)}},l.simpleIntersection=function(e,t,r){var i=Math.max(e.west,t.west),o=Math.max(e.south,t.south),a=Math.min(e.east,t.east),s=Math.min(e.north,t.north);if(!(o>=s||i>=a))return n(r)?(r.west=i,r.south=o,r.east=a,r.north=s,r):new l(i,o,a,s)},l.union=function(e,t,r){return n(r)||(r=new l),r.west=Math.min(e.west,t.west),r.south=Math.min(e.south,t.south),r.east=Math.max(e.east,t.east),r.north=Math.max(e.north,t.north),r},l.expand=function(e,t,r){return n(r)||(r=new l),r.west=Math.min(e.west,t.longitude),r.south=Math.min(e.south,t.latitude),r.east=Math.max(e.east,t.longitude),r.north=Math.max(e.north,t.latitude),r},l.contains=function(e,t){var n=t.longitude,r=t.latitude,i=e.west,o=e.east;return o<i&&(o+=s.TWO_PI,n<0&&(n+=s.TWO_PI)),(n>i||s.equalsEpsilon(n,i,s.EPSILON14))&&(n<o||s.equalsEpsilon(n,o,s.EPSILON14))&&r>=e.south&&r<=e.north};var u=new e;return l.subsample=function(e,r,i,a){r=t(r,o.WGS84),i=t(i,0),n(a)||(a=[]);var c=0,h=e.north,d=e.south,p=e.east,f=e.west,m=u;m.height=i,m.longitude=f,m.latitude=h,a[c]=r.cartographicToCartesian(m,a[c]),c++,m.longitude=p,a[c]=r.cartographicToCartesian(m,a[c]),c++,m.latitude=d,a[c]=r.cartographicToCartesian(m,a[c]),c++,m.longitude=f,a[c]=r.cartographicToCartesian(m,a[c]),c++,m.latitude=h<0?h:d>0?d:0;for(var _=1;_<8;++_)m.longitude=-Math.PI+_*s.PI_OVER_TWO,l.contains(e,m)&&(a[c]=r.cartographicToCartesian(m,a[c]),c++);return 0===m.latitude&&(m.longitude=f,a[c]=r.cartographicToCartesian(m,a[c]),c++,m.longitude=p,a[c]=r.cartographicToCartesian(m,a[c]),c++),a.length=c,a},l.MAX_VALUE=a(new l(-Math.PI,-s.PI_OVER_TWO,Math.PI,s.PI_OVER_TWO)),l}),o("Core/GeographicTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./GeographicProjection","./Math","./Rectangle"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(e){e=t(e,{}),this._ellipsoid=t(e.ellipsoid,o.WGS84),this._rectangle=t(e.rectangle,l.MAX_VALUE),this._projection=new a(this._ellipsoid),this._numberOfLevelZeroTilesX=t(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=t(e.numberOfLevelZeroTilesY,1)}return r(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),u.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},u.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},u.prototype.rectangleToNativeRectangle=function(e,t){var r=s.toDegrees(e.west),i=s.toDegrees(e.south),o=s.toDegrees(e.east),a=s.toDegrees(e.north);return n(t)?(t.west=r,t.south=i,t.east=o,t.north=a,t):new l(r,i,o,a)},u.prototype.tileXYToNativeRectangle=function(e,t,n,r){var i=this.tileXYToRectangle(e,t,n,r);return i.west=s.toDegrees(i.west),i.south=s.toDegrees(i.south),i.east=s.toDegrees(i.east),i.north=s.toDegrees(i.north),i},u.prototype.tileXYToRectangle=function(e,t,r,i){var o=this._rectangle,a=this.getNumberOfXTilesAtLevel(r),s=this.getNumberOfYTilesAtLevel(r),u=o.width/a,c=e*u+o.west,h=(e+1)*u+o.west,d=o.height/s,p=o.north-t*d,f=o.north-(t+1)*d;return n(i)||(i=new l(c,f,h,p)),i.west=c,i.south=f,i.east=h,i.north=p,i},u.prototype.positionToTileXY=function(t,r,i){var o=this._rectangle;if(l.contains(o,t)){var a=this.getNumberOfXTilesAtLevel(r),u=this.getNumberOfYTilesAtLevel(r),c=t.longitude;o.east<o.west&&(c+=s.TWO_PI);var h=(c-o.west)/(o.width/a)|0;h>=a&&(h=a-1);var d=(o.north-t.latitude)/(o.height/u)|0;return d>=u&&(d=u-1),n(i)?(i.x=h,i.y=d,i):new e(h,d)}},u}),o("Core/getImagePixels",["./defined"],function(e){"use strict";var t={};return function(n,r,i){e(r)||(r=n.width),e(i)||(i=n.height);var o=t[r];e(o)||(t[r]=o={});var a=o[i];if(!e(a)){var s=document.createElement("canvas");s.width=r,s.height=i,(a=s.getContext("2d")).globalCompositeOperation="copy",o[i]=a}return a.drawImage(n,0,0,r,i),a.getImageData(0,0,r,i).data}}),o("Core/Intersect",["./freezeObject"],function(e){"use strict";return e({OUTSIDE:-1,INTERSECTING:0,INSIDE:1})}),o("Core/AxisAlignedBoundingBox",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./Intersect"],function(e,t,n,r,i){"use strict";function o(r,i,o){this.minimum=e.clone(t(r,e.ZERO)),this.maximum=e.clone(t(i,e.ZERO)),n(o)?o=e.clone(o):(o=e.add(this.minimum,this.maximum,new e),e.multiplyByScalar(o,.5,o)),this.center=o}o.fromPoints=function(t,r){if(n(r)||(r=new o),!n(t)||0===t.length)return r.minimum=e.clone(e.ZERO,r.minimum),r.maximum=e.clone(e.ZERO,r.maximum),r.center=e.clone(e.ZERO,r.center),r;for(var i=t[0].x,a=t[0].y,s=t[0].z,l=t[0].x,u=t[0].y,c=t[0].z,h=t.length,d=1;d<h;d++){var p=t[d],f=p.x,m=p.y,_=p.z;i=Math.min(f,i),l=Math.max(f,l),a=Math.min(m,a),u=Math.max(m,u),s=Math.min(_,s),c=Math.max(_,c)}var g=r.minimum;g.x=i,g.y=a,g.z=s;var v=r.maximum;v.x=l,v.y=u,v.z=c;var y=e.add(g,v,r.center);return e.multiplyByScalar(y,.5,y),r},o.clone=function(t,r){if(n(t))return n(r)?(r.minimum=e.clone(t.minimum,r.minimum),r.maximum=e.clone(t.maximum,r.maximum),r.center=e.clone(t.center,r.center),r):new o(t.minimum,t.maximum)},o.equals=function(t,r){return t===r||n(t)&&n(r)&&e.equals(t.center,r.center)&&e.equals(t.minimum,r.minimum)&&e.equals(t.maximum,r.maximum)};var a=new e;return o.intersectPlane=function(t,n){a=e.subtract(t.maximum,t.minimum,a);var r=e.multiplyByScalar(a,.5,a),o=n.normal,s=r.x*Math.abs(o.x)+r.y*Math.abs(o.y)+r.z*Math.abs(o.z),l=e.dot(t.center,o)+n.distance;return l-s>0?i.INSIDE:l+s<0?i.OUTSIDE:i.INTERSECTING},o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.intersectPlane=function(e){return o.intersectPlane(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o}),o("Core/Interval",["./defaultValue"],function(e){"use strict";return function(t,n){this.start=e(t,0),this.stop=e(n,0)}}),o("Core/HeadingPitchRoll",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";function i(t,n,r){this.heading=e(t,0),this.pitch=e(n,0),this.roll=e(r,0)}return i.fromQuaternion=function(e,n){t(n)||(n=new i);var r=2*(e.w*e.y-e.z*e.x),o=1-2*(e.x*e.x+e.y*e.y),a=2*(e.w*e.x+e.y*e.z);return n.heading=-Math.atan2(2*(e.w*e.z+e.x*e.y),1-2*(e.y*e.y+e.z*e.z)),n.roll=Math.atan2(a,o),n.pitch=-Math.asin(r),n},i.fromDegrees=function(e,n,o,a){return t(a)||(a=new i),a.heading=e*r.RADIANS_PER_DEGREE,a.pitch=n*r.RADIANS_PER_DEGREE,a.roll=o*r.RADIANS_PER_DEGREE,a},i.clone=function(e,n){if(t(e))return t(n)?(n.heading=e.heading,n.pitch=e.pitch,n.roll=e.roll,n):new i(e.heading,e.pitch,e.roll)},i.equals=function(e,n){return e===n||t(e)&&t(n)&&e.heading===n.heading&&e.pitch===n.pitch&&e.roll===n.roll},i.equalsEpsilon=function(e,n,i,o){return e===n||t(e)&&t(n)&&r.equalsEpsilon(e.heading,n.heading,i,o)&&r.equalsEpsilon(e.pitch,n.pitch,i,o)&&r.equalsEpsilon(e.roll,n.roll,i,o)},i.prototype.clone=function(e){return i.clone(this,e)},i.prototype.equals=function(e){return i.equals(this,e)},i.prototype.equalsEpsilon=function(e,t,n){return i.equalsEpsilon(this,e,t,n)},i.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"},i}),o("Core/Matrix3",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./HeadingPitchRoll","./Math"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,n,r,i,o,a,s,l,u){this[0]=t(e,0),this[1]=t(i,0),this[2]=t(s,0),this[3]=t(n,0),this[4]=t(o,0),this[5]=t(l,0),this[6]=t(r,0),this[7]=t(a,0),this[8]=t(u,0)}function u(e){for(var t=0,n=0;n<3;++n){var r=e[l.getElementIndex(f[n],p[n])];t+=2*r*r}return Math.sqrt(t)}function c(e,t){for(var n=s.EPSILON15,r=0,i=1,o=0;o<3;++o){var a=Math.abs(e[l.getElementIndex(f[o],p[o])]);a>r&&(i=o,r=a)}var u=1,c=0,h=p[i],d=f[i];if(Math.abs(e[l.getElementIndex(d,h)])>n){var m,_=(e[l.getElementIndex(d,d)]-e[l.getElementIndex(h,h)])/2/e[l.getElementIndex(d,h)];c=(m=_<0?-1/(-_+Math.sqrt(1+_*_)):1/(_+Math.sqrt(1+_*_)))*(u=1/Math.sqrt(1+m*m))}return(t=l.clone(l.IDENTITY,t))[l.getElementIndex(h,h)]=t[l.getElementIndex(d,d)]=u,t[l.getElementIndex(d,h)]=c,t[l.getElementIndex(h,d)]=-c,t}l.packedLength=9,l.pack=function(e,n,r){return r=t(r,0),n[r++]=e[0],n[r++]=e[1],n[r++]=e[2],n[r++]=e[3],n[r++]=e[4],n[r++]=e[5],n[r++]=e[6],n[r++]=e[7],n[r++]=e[8],n},l.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new l),i[0]=e[r++],i[1]=e[r++],i[2]=e[r++],i[3]=e[r++],i[4]=e[r++],i[5]=e[r++],i[6]=e[r++],i[7]=e[r++],i[8]=e[r++],i},l.clone=function(e,t){if(n(e))return n(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new l(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},l.fromArray=function(e,r,i){return r=t(r,0),n(i)||(i=new l),i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],i[4]=e[r+4],i[5]=e[r+5],i[6]=e[r+6],i[7]=e[r+7],i[8]=e[r+8],i},l.fromColumnMajorArray=function(e,t){return l.clone(e,t)},l.fromRowMajorArray=function(e,t){return n(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new l(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},l.fromQuaternion=function(e,t){var r=e.x*e.x,i=e.x*e.y,o=e.x*e.z,a=e.x*e.w,s=e.y*e.y,u=e.y*e.z,c=e.y*e.w,h=e.z*e.z,d=e.z*e.w,p=e.w*e.w,f=r-s-h+p,m=2*(i-d),_=2*(o+c),g=2*(i+d),v=-r+s-h+p,y=2*(u-a),C=2*(o-c),w=2*(u+a),b=-r-s+h+p;return n(t)?(t[0]=f,t[1]=g,t[2]=C,t[3]=m,t[4]=v,t[5]=w,t[6]=_,t[7]=y,t[8]=b,t):new l(f,m,_,g,v,y,C,w,b)},l.fromHeadingPitchRoll=function(e,t){var r=Math.cos(-e.pitch),i=Math.cos(-e.heading),o=Math.cos(e.roll),a=Math.sin(-e.pitch),s=Math.sin(-e.heading),u=Math.sin(e.roll),c=r*i,h=-o*s+u*a*i,d=u*s+o*a*i,p=r*s,f=o*i+u*a*s,m=-a*o+o*a*s,_=-a,g=u*r,v=o*r;return n(t)?(t[0]=c,t[1]=p,t[2]=_,t[3]=h,t[4]=f,t[5]=g,t[6]=d,t[7]=m,t[8]=v,t):new l(c,h,d,p,f,m,_,g,v)},l.fromScale=function(e,t){return n(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new l(e.x,0,0,0,e.y,0,0,0,e.z)},l.fromUniformScale=function(e,t){return n(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new l(e,0,0,0,e,0,0,0,e)},l.fromCrossProduct=function(e,t){return n(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new l(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},l.fromRotationX=function(e,t){var r=Math.cos(e),i=Math.sin(e);return n(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=r,t[5]=i,t[6]=0,t[7]=-i,t[8]=r,t):new l(1,0,0,0,r,-i,0,i,r)},l.fromRotationY=function(e,t){var r=Math.cos(e),i=Math.sin(e);return n(t)?(t[0]=r,t[1]=0,t[2]=-i,t[3]=0,t[4]=1,t[5]=0,t[6]=i,t[7]=0,t[8]=r,t):new l(r,0,i,0,1,0,-i,0,r)},l.fromRotationZ=function(e,t){var r=Math.cos(e),i=Math.sin(e);return n(t)?(t[0]=r,t[1]=i,t[2]=0,t[3]=-i,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new l(r,-i,0,i,r,0,0,0,1)},l.toArray=function(e,t){return n(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},l.getElementIndex=function(e,t){return 3*e+t},l.getColumn=function(e,t,n){var r=3*t,i=e[r+1],o=e[r+2];return n.x=e[r],n.y=i,n.z=o,n},l.setColumn=function(e,t,n,r){var i=3*t;return(r=l.clone(e,r))[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r},l.getRow=function(e,t,n){var r=e[t+3],i=e[t+6];return n.x=e[t],n.y=r,n.z=i,n},l.setRow=function(e,t,n,r){return(r=l.clone(e,r))[t]=n.x,r[t+3]=n.y,r[t+6]=n.z,r};var h=new e;l.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],t[2],h)),n.y=e.magnitude(e.fromElements(t[3],t[4],t[5],h)),n.z=e.magnitude(e.fromElements(t[6],t[7],t[8],h)),n};var d=new e;l.getMaximumScale=function(t){return l.getScale(t,d),e.maximumComponent(d)},l.multiply=function(e,t,n){var r=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],i=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],o=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],a=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],s=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],l=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],u=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],c=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return n[0]=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],n[1]=r,n[2]=i,n[3]=o,n[4]=a,n[5]=s,n[6]=l,n[7]=u,n[8]=c,n},l.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n},l.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n},l.multiplyByVector=function(e,t,n){var r=t.x,i=t.y,o=t.z,a=e[1]*r+e[4]*i+e[7]*o,s=e[2]*r+e[5]*i+e[8]*o;return n.x=e[0]*r+e[3]*i+e[6]*o,n.y=a,n.z=s,n},l.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n},l.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.x,n[3]=e[3]*t.y,n[4]=e[4]*t.y,n[5]=e[5]*t.y,n[6]=e[6]*t.z,n[7]=e[7]*t.z,n[8]=e[8]*t.z,n},l.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},l.transpose=function(e,t){var n=e[3],r=e[6],i=e[1],o=e[4],a=e[7],s=e[2],l=e[5],u=e[8];return t[0]=e[0],t[1]=n,t[2]=r,t[3]=i,t[4]=o,t[5]=a,t[6]=s,t[7]=l,t[8]=u,t};var p=[1,0,0],f=[2,2,1],m=new l,_=new l;return l.computeEigenDecomposition=function(e,t){var r=s.EPSILON20,i=0,o=0;n(t)||(t={});for(var a=t.unitary=l.clone(l.IDENTITY,t.unitary),h=t.diagonal=l.clone(e,t.diagonal),d=r*function(e){for(var t=0,n=0;n<9;++n){var r=e[n];t+=r*r}return Math.sqrt(t)}(h);o<10&&u(h)>d;)c(h,m),l.transpose(m,_),l.multiply(h,m,h),l.multiply(_,h,h),l.multiply(a,m,a),++i>2&&(++o,i=0);return t},l.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},l.determinant=function(e){var t=e[3],n=e[6],r=e[4],i=e[7],o=e[5],a=e[8];return e[0]*(r*a-o*i)+e[1]*(o*n-t*a)+e[2]*(t*i-r*n)},l.inverse=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],c=e[7],h=e[8],d=l.determinant(e);return t[0]=a*h-c*s,t[1]=c*i-r*h,t[2]=r*s-a*i,t[3]=u*s-o*h,t[4]=n*h-u*i,t[5]=o*i-n*s,t[6]=o*c-u*a,t[7]=u*r-n*c,t[8]=n*a-o*r,l.multiplyByScalar(t,1/d,t)},l.equals=function(e,t){return e===t||n(e)&&n(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},l.equalsEpsilon=function(e,t,r){return e===t||n(e)&&n(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r&&Math.abs(e[4]-t[4])<=r&&Math.abs(e[5]-t[5])<=r&&Math.abs(e[6]-t[6])<=r&&Math.abs(e[7]-t[7])<=r&&Math.abs(e[8]-t[8])<=r},l.IDENTITY=o(new l(1,0,0,0,1,0,0,0,1)),l.ZERO=o(new l(0,0,0,0,0,0,0,0,0)),l.COLUMN0ROW0=0,l.COLUMN0ROW1=1,l.COLUMN0ROW2=2,l.COLUMN1ROW0=3,l.COLUMN1ROW1=4,l.COLUMN1ROW2=5,l.COLUMN2ROW0=6,l.COLUMN2ROW1=7,l.COLUMN2ROW2=8,r(l.prototype,{length:{get:function(){return l.packedLength}}}),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]},l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)},l.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"},l}),o("Core/Cartesian4",["./defaultValue","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i){"use strict";function o(t,n,r,i){this.x=e(t,0),this.y=e(n,0),this.z=e(r,0),this.w=e(i,0)}o.fromElements=function(e,n,r,i,a){return t(a)?(a.x=e,a.y=n,a.z=r,a.w=i,a):new o(e,n,r,i)},o.fromColor=function(e,n){return t(n)?(n.x=e.red,n.y=e.green,n.z=e.blue,n.w=e.alpha,n):new o(e.red,e.green,e.blue,e.alpha)},o.clone=function(e,n){if(t(e))return t(n)?(n.x=e.x,n.y=e.y,n.z=e.z,n.w=e.w,n):new o(e.x,e.y,e.z,e.w)},o.packedLength=4,o.pack=function(t,n,r){return r=e(r,0),n[r++]=t.x,n[r++]=t.y,n[r++]=t.z,n[r]=t.w,n},o.unpack=function(n,r,i){return r=e(r,0),t(i)||(i=new o),i.x=n[r++],i.y=n[r++],i.z=n[r++],i.w=n[r],i},o.packArray=function(e,n){var r=e.length;t(n)?n.length=4*r:n=new Array(4*r);for(var i=0;i<r;++i)o.pack(e[i],n,4*i);return n},o.unpackArray=function(e,n){var r=e.length;t(n)?n.length=r/4:n=new Array(r/4);for(var i=0;i<r;i+=4){var a=i/4;n[a]=o.unpack(e,i,n[a])}return n},o.fromArray=o.unpack,o.maximumComponent=function(e){return Math.max(e.x,e.y,e.z,e.w)},o.minimumComponent=function(e){return Math.min(e.x,e.y,e.z,e.w)},o.minimumByComponent=function(e,t,n){return n.x=Math.min(e.x,t.x),n.y=Math.min(e.y,t.y),n.z=Math.min(e.z,t.z),n.w=Math.min(e.w,t.w),n},o.maximumByComponent=function(e,t,n){return n.x=Math.max(e.x,t.x),n.y=Math.max(e.y,t.y),n.z=Math.max(e.z,t.z),n.w=Math.max(e.w,t.w),n},o.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},o.magnitude=function(e){return Math.sqrt(o.magnitudeSquared(e))};var a=new o;o.distance=function(e,t){return o.subtract(e,t,a),o.magnitude(a)},o.distanceSquared=function(e,t){return o.subtract(e,t,a),o.magnitudeSquared(a)},o.normalize=function(e,t){var n=o.magnitude(e);return t.x=e.x/n,t.y=e.y/n,t.z=e.z/n,t.w=e.w/n,t},o.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},o.multiplyComponents=function(e,t,n){return n.x=e.x*t.x,n.y=e.y*t.y,n.z=e.z*t.z,n.w=e.w*t.w,n},o.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},o.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},o.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},o.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},o.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},o.abs=function(e,t){return t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var s=new o;o.lerp=function(e,t,n,r){return o.multiplyByScalar(t,n,s),r=o.multiplyByScalar(e,1-n,r),o.add(s,r,r)};var l=new o;return o.mostOrthogonalAxis=function(e,t){var n=o.normalize(e,l);return o.abs(n,n),o.clone(n.x<=n.y?n.x<=n.z?n.x<=n.w?o.UNIT_X:o.UNIT_W:n.z<=n.w?o.UNIT_Z:o.UNIT_W:n.y<=n.z?n.y<=n.w?o.UNIT_Y:o.UNIT_W:n.z<=n.w?o.UNIT_Z:o.UNIT_W,t)},o.equals=function(e,n){return e===n||t(e)&&t(n)&&e.x===n.x&&e.y===n.y&&e.z===n.z&&e.w===n.w},o.equalsArray=function(e,t,n){return e.x===t[n]&&e.y===t[n+1]&&e.z===t[n+2]&&e.w===t[n+3]},o.equalsEpsilon=function(e,n,r,o){return e===n||t(e)&&t(n)&&i.equalsEpsilon(e.x,n.x,r,o)&&i.equalsEpsilon(e.y,n.y,r,o)&&i.equalsEpsilon(e.z,n.z,r,o)&&i.equalsEpsilon(e.w,n.w,r,o)},o.ZERO=r(new o(0,0,0,0)),o.UNIT_X=r(new o(1,0,0,0)),o.UNIT_Y=r(new o(0,1,0,0)),o.UNIT_Z=r(new o(0,0,1,0)),o.UNIT_W=r(new o(0,0,0,1)),o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.equalsEpsilon=function(e,t,n){return o.equalsEpsilon(this,e,t,n)},o.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},o}),o("Core/RuntimeError",["./defined"],function(e){"use strict";function t(e){var t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}return e(Object.create)&&((t.prototype=Object.create(Error.prototype)).constructor=t),t.prototype.toString=function(){var t=this.name+": "+this.message;return e(this.stack)&&(t+="\n"+this.stack.toString()),t},t}),o("Core/Matrix4",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./Math","./Matrix3","./RuntimeError"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,t,r,i,o,a,s,l,u,c,h,d,p,f,m,_){this[0]=n(e,0),this[1]=n(o,0),this[2]=n(u,0),this[3]=n(p,0),this[4]=n(t,0),this[5]=n(a,0),this[6]=n(c,0),this[7]=n(f,0),this[8]=n(r,0),this[9]=n(s,0),this[10]=n(h,0),this[11]=n(m,0),this[12]=n(i,0),this[13]=n(l,0),this[14]=n(d,0),this[15]=n(_,0)}c.packedLength=16,c.pack=function(e,t,r){return r=n(r,0),t[r++]=e[0],t[r++]=e[1],t[r++]=e[2],t[r++]=e[3],t[r++]=e[4],t[r++]=e[5],t[r++]=e[6],t[r++]=e[7],t[r++]=e[8],t[r++]=e[9],t[r++]=e[10],t[r++]=e[11],t[r++]=e[12],t[r++]=e[13],t[r++]=e[14],t[r]=e[15],t},c.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new c),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i[9]=e[t++],i[10]=e[t++],i[11]=e[t++],i[12]=e[t++],i[13]=e[t++],i[14]=e[t++],i[15]=e[t],i},c.clone=function(e,t){if(r(e))return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new c(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},c.fromArray=c.unpack,c.fromColumnMajorArray=function(e,t){return c.clone(e,t)},c.fromRowMajorArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new c(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},c.fromRotationTranslation=function(t,i,o){return i=n(i,e.ZERO),r(o)?(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=0,o[4]=t[3],o[5]=t[4],o[6]=t[5],o[7]=0,o[8]=t[6],o[9]=t[7],o[10]=t[8],o[11]=0,o[12]=i.x,o[13]=i.y,o[14]=i.z,o[15]=1,o):new c(t[0],t[3],t[6],i.x,t[1],t[4],t[7],i.y,t[2],t[5],t[8],i.z,0,0,0,1)},c.fromTranslationQuaternionRotationScale=function(e,t,n,i){r(i)||(i=new c);var o=n.x,a=n.y,s=n.z,l=t.x*t.x,u=t.x*t.y,h=t.x*t.z,d=t.x*t.w,p=t.y*t.y,f=t.y*t.z,m=t.y*t.w,_=t.z*t.z,g=t.z*t.w,v=t.w*t.w,y=2*(u-g),C=2*(h+m),w=2*(u+g),b=-l+p-_+v,E=2*(f-d),S=2*(h-m),x=2*(f+d),T=-l-p+_+v;return i[0]=(l-p-_+v)*o,i[1]=w*o,i[2]=S*o,i[3]=0,i[4]=y*a,i[5]=b*a,i[6]=x*a,i[7]=0,i[8]=C*s,i[9]=E*s,i[10]=T*s,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,i},c.fromTranslationRotationScale=function(e,t){return c.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},c.fromTranslation=function(e,t){return c.fromRotationTranslation(l.IDENTITY,e,t)},c.fromScale=function(e,t){return r(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new c(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},c.fromUniformScale=function(e,t){return r(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new c(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var h=new e,d=new e,p=new e;c.fromCamera=function(t,n){var i=t.position,o=t.up;e.normalize(t.direction,h),e.normalize(e.cross(h,o,d),d),e.normalize(e.cross(d,h,p),p);var a=d.x,s=d.y,l=d.z,u=h.x,f=h.y,m=h.z,_=p.x,g=p.y,v=p.z,y=i.x,C=i.y,w=i.z,b=a*-y+s*-C+l*-w,E=_*-y+g*-C+v*-w,S=u*y+f*C+m*w;return r(n)?(n[0]=a,n[1]=_,n[2]=-u,n[3]=0,n[4]=s,n[5]=g,n[6]=-f,n[7]=0,n[8]=l,n[9]=v,n[10]=-m,n[11]=0,n[12]=b,n[13]=E,n[14]=S,n[15]=1,n):new c(a,s,l,b,_,g,v,E,-u,-f,-m,S,0,0,0,1)},c.computePerspectiveFieldOfView=function(e,t,n,r,i){var o=1/Math.tan(.5*e),a=(r+n)/(n-r),s=2*r*n/(n-r);return i[0]=o/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=a,i[11]=-1,i[12]=0,i[13]=0,i[14]=s,i[15]=0,i},c.computeOrthographicOffCenter=function(e,t,n,r,i,o,a){var s=1/(t-e),l=1/(r-n),u=1/(o-i),c=-(t+e)*s,h=-(r+n)*l,d=-(o+i)*u;return l*=2,u*=-2,a[0]=s*=2,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=l,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=u,a[11]=0,a[12]=c,a[13]=h,a[14]=d,a[15]=1,a},c.computePerspectiveOffCenter=function(e,t,n,r,i,o,a){var s=2*i/(r-n),l=(t+e)/(t-e),u=(r+n)/(r-n),c=-(o+i)/(o-i),h=-2*o*i/(o-i);return a[0]=2*i/(t-e),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=l,a[9]=u,a[10]=c,a[11]=-1,a[12]=0,a[13]=0,a[14]=h,a[15]=0,a},c.computeInfinitePerspectiveOffCenter=function(e,t,n,r,i,o){var a=2*i/(r-n),s=(t+e)/(t-e),l=(r+n)/(r-n),u=-2*i;return o[0]=2*i/(t-e),o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=a,o[6]=0,o[7]=0,o[8]=s,o[9]=l,o[10]=-1,o[11]=-1,o[12]=0,o[13]=0,o[14]=u,o[15]=0,o},c.computeViewportTransformation=function(e,t,r,i){e=n(e,n.EMPTY_OBJECT);var o=n(e.x,0),a=n(e.y,0),s=n(e.width,0),l=n(e.height,0);t=n(t,0);var u=.5*s,c=.5*l,h=.5*((r=n(r,1))-t),d=c,p=h,f=o+u,m=a+c,_=t+h;return i[0]=u,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=d,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=p,i[11]=0,i[12]=f,i[13]=m,i[14]=_,i[15]=1,i},c.computeView=function(t,n,r,i,o){return o[0]=i.x,o[1]=r.x,o[2]=-n.x,o[3]=0,o[4]=i.y,o[5]=r.y,o[6]=-n.y,o[7]=0,o[8]=i.z,o[9]=r.z,o[10]=-n.z,o[11]=0,o[12]=-e.dot(i,t),o[13]=-e.dot(r,t),o[14]=e.dot(n,t),o[15]=1,o},c.toArray=function(e,t){return r(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},c.getElementIndex=function(e,t){return 4*e+t},c.getColumn=function(e,t,n){var r=4*t,i=e[r+1],o=e[r+2],a=e[r+3];return n.x=e[r],n.y=i,n.z=o,n.w=a,n},c.setColumn=function(e,t,n,r){var i=4*t;return(r=c.clone(e,r))[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r[i+3]=n.w,r},c.setTranslation=function(e,t,n){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=e[15],n},c.getRow=function(e,t,n){var r=e[t+4],i=e[t+8],o=e[t+12];return n.x=e[t],n.y=r,n.z=i,n.w=o,n},c.setRow=function(e,t,n,r){return(r=c.clone(e,r))[t]=n.x,r[t+4]=n.y,r[t+8]=n.z,r[t+12]=n.w,r};var f=new e;c.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],t[2],f)),n.y=e.magnitude(e.fromElements(t[4],t[5],t[6],f)),n.z=e.magnitude(e.fromElements(t[8],t[9],t[10],f)),n};var m=new e;c.getMaximumScale=function(t){return c.getScale(t,m),e.maximumComponent(m)},c.multiply=function(e,t,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],_=e[13],g=e[14],v=e[15],y=t[0],C=t[1],w=t[2],b=t[3],E=t[4],S=t[5],x=t[6],T=t[7],A=t[8],P=t[9],D=t[10],M=t[11],I=t[12],O=t[13],R=t[14],N=t[15],L=i*y+l*C+d*w+_*b,F=o*y+u*C+p*w+g*b,B=a*y+c*C+f*w+v*b,k=r*E+s*S+h*x+m*T,V=i*E+l*S+d*x+_*T,z=o*E+u*S+p*x+g*T,U=a*E+c*S+f*x+v*T,G=r*A+s*P+h*D+m*M,W=i*A+l*P+d*D+_*M,H=o*A+u*P+p*D+g*M,j=a*A+c*P+f*D+v*M,q=r*I+s*O+h*R+m*N,Y=i*I+l*O+d*R+_*N,X=o*I+u*O+p*R+g*N,Z=a*I+c*O+f*R+v*N;return n[0]=r*y+s*C+h*w+m*b,n[1]=L,n[2]=F,n[3]=B,n[4]=k,n[5]=V,n[6]=z,n[7]=U,n[8]=G,n[9]=W,n[10]=H,n[11]=j,n[12]=q,n[13]=Y,n[14]=X,n[15]=Z,n},c.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n[4]=e[4]+t[4],n[5]=e[5]+t[5],n[6]=e[6]+t[6],n[7]=e[7]+t[7],n[8]=e[8]+t[8],n[9]=e[9]+t[9],n[10]=e[10]+t[10],n[11]=e[11]+t[11],n[12]=e[12]+t[12],n[13]=e[13]+t[13],n[14]=e[14]+t[14],n[15]=e[15]+t[15],n},c.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n[4]=e[4]-t[4],n[5]=e[5]-t[5],n[6]=e[6]-t[6],n[7]=e[7]-t[7],n[8]=e[8]-t[8],n[9]=e[9]-t[9],n[10]=e[10]-t[10],n[11]=e[11]-t[11],n[12]=e[12]-t[12],n[13]=e[13]-t[13],n[14]=e[14]-t[14],n[15]=e[15]-t[15],n},c.multiplyTransformation=function(e,t,n){var r=e[0],i=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=t[0],p=t[1],f=t[2],m=t[4],_=t[5],g=t[6],v=t[8],y=t[9],C=t[10],w=t[12],b=t[13],E=t[14],S=i*d+s*p+c*f,x=o*d+l*p+h*f,T=r*m+a*_+u*g,A=i*m+s*_+c*g,P=o*m+l*_+h*g,D=r*v+a*y+u*C,M=i*v+s*y+c*C,I=o*v+l*y+h*C,O=r*w+a*b+u*E+e[12],R=i*w+s*b+c*E+e[13],N=o*w+l*b+h*E+e[14];return n[0]=r*d+a*p+u*f,n[1]=S,n[2]=x,n[3]=0,n[4]=T,n[5]=A,n[6]=P,n[7]=0,n[8]=D,n[9]=M,n[10]=I,n[11]=0,n[12]=O,n[13]=R,n[14]=N,n[15]=1,n},c.multiplyByMatrix3=function(e,t,n){var r=e[0],i=e[1],o=e[2],a=e[4],s=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=t[0],p=t[1],f=t[2],m=t[3],_=t[4],g=t[5],v=t[6],y=t[7],C=t[8],w=i*d+s*p+c*f,b=o*d+l*p+h*f,E=r*m+a*_+u*g,S=i*m+s*_+c*g,x=o*m+l*_+h*g,T=r*v+a*y+u*C,A=i*v+s*y+c*C,P=o*v+l*y+h*C;return n[0]=r*d+a*p+u*f,n[1]=w,n[2]=b,n[3]=0,n[4]=E,n[5]=S,n[6]=x,n[7]=0,n[8]=T,n[9]=A,n[10]=P,n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},c.multiplyByTranslation=function(e,t,n){var r=t.x,i=t.y,o=t.z,a=r*e[0]+i*e[4]+o*e[8]+e[12],s=r*e[1]+i*e[5]+o*e[9]+e[13],l=r*e[2]+i*e[6]+o*e[10]+e[14];return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=a,n[13]=s,n[14]=l,n[15]=e[15],n};var _=new e;c.multiplyByUniformScale=function(e,t,n){return _.x=t,_.y=t,_.z=t,c.multiplyByScale(e,_,n)},c.multiplyByScale=function(e,t,n){var r=t.x,i=t.y,o=t.z;return 1===r&&1===i&&1===o?c.clone(e,n):(n[0]=r*e[0],n[1]=r*e[1],n[2]=r*e[2],n[3]=0,n[4]=i*e[4],n[5]=i*e[5],n[6]=i*e[6],n[7]=0,n[8]=o*e[8],n[9]=o*e[9],n[10]=o*e[10],n[11]=0,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=1,n)},c.multiplyByVector=function(e,t,n){var r=t.x,i=t.y,o=t.z,a=t.w,s=e[1]*r+e[5]*i+e[9]*o+e[13]*a,l=e[2]*r+e[6]*i+e[10]*o+e[14]*a,u=e[3]*r+e[7]*i+e[11]*o+e[15]*a;return n.x=e[0]*r+e[4]*i+e[8]*o+e[12]*a,n.y=s,n.z=l,n.w=u,n},c.multiplyByPointAsVector=function(e,t,n){var r=t.x,i=t.y,o=t.z,a=e[1]*r+e[5]*i+e[9]*o,s=e[2]*r+e[6]*i+e[10]*o;return n.x=e[0]*r+e[4]*i+e[8]*o,n.y=a,n.z=s,n},c.multiplyByPoint=function(e,t,n){var r=t.x,i=t.y,o=t.z,a=e[1]*r+e[5]*i+e[9]*o+e[13],s=e[2]*r+e[6]*i+e[10]*o+e[14];return n.x=e[0]*r+e[4]*i+e[8]*o+e[12],n.y=a,n.z=s,n},c.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n[4]=e[4]*t,n[5]=e[5]*t,n[6]=e[6]*t,n[7]=e[7]*t,n[8]=e[8]*t,n[9]=e[9]*t,n[10]=e[10]*t,n[11]=e[11]*t,n[12]=e[12]*t,n[13]=e[13]*t,n[14]=e[14]*t,n[15]=e[15]*t,n},c.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},c.transpose=function(e,t){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[10]=e[10],t[11]=e[14],t[12]=i,t[13]=a,t[14]=s,t[15]=e[15],t},c.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},c.equals=function(e,t){return e===t||r(e)&&r(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},c.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(e[0]-t[0])<=n&&Math.abs(e[1]-t[1])<=n&&Math.abs(e[2]-t[2])<=n&&Math.abs(e[3]-t[3])<=n&&Math.abs(e[4]-t[4])<=n&&Math.abs(e[5]-t[5])<=n&&Math.abs(e[6]-t[6])<=n&&Math.abs(e[7]-t[7])<=n&&Math.abs(e[8]-t[8])<=n&&Math.abs(e[9]-t[9])<=n&&Math.abs(e[10]-t[10])<=n&&Math.abs(e[11]-t[11])<=n&&Math.abs(e[12]-t[12])<=n&&Math.abs(e[13]-t[13])<=n&&Math.abs(e[14]-t[14])<=n&&Math.abs(e[15]-t[15])<=n},c.getTranslation=function(e,t){return t.x=e[12],t.y=e[13],t.z=e[14],t},c.getRotation=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var g=new l,v=new l,y=new t,C=new t(0,0,0,1);return c.inverse=function(e,n){if(l.equalsEpsilon(c.getRotation(e,g),v,s.EPSILON7)&&t.equals(c.getRow(e,3,y),C))return n[0]=0,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=0,n[11]=0,n[12]=-e[12],n[13]=-e[13],n[14]=-e[14],n[15]=1,n;var r=e[0],i=e[4],o=e[8],a=e[12],h=e[1],d=e[5],p=e[9],f=e[13],m=e[2],_=e[6],w=e[10],b=e[14],E=e[3],S=e[7],x=e[11],T=e[15],A=w*T,P=b*x,D=_*T,M=b*S,I=_*x,O=w*S,R=m*T,N=b*E,L=m*x,F=w*E,B=m*S,k=_*E,V=A*d+M*p+I*f-(P*d+D*p+O*f),z=P*h+R*p+F*f-(A*h+N*p+L*f),U=D*h+N*d+B*f-(M*h+R*d+k*f),G=O*h+L*d+k*p-(I*h+F*d+B*p),W=P*i+D*o+O*a-(A*i+M*o+I*a),H=A*r+N*o+L*a-(P*r+R*o+F*a),j=M*r+R*i+k*a-(D*r+N*i+B*a),q=I*r+F*i+B*o-(O*r+L*i+k*o),Y=(A=o*f)*S+(M=a*d)*x+(I=i*p)*T-((P=a*p)*S+(D=i*f)*x+(O=o*d)*T),X=P*E+(R=r*f)*x+(F=o*h)*T-(A*E+(N=a*h)*x+(L=r*p)*T),Z=D*E+N*S+(B=r*d)*T-(M*E+R*S+(k=i*h)*T),K=O*E+L*S+k*x-(I*E+F*S+B*x),Q=D*w+O*b+P*_-(I*b+A*_+M*w),J=L*b+A*m+N*w-(R*w+F*b+P*m),$=R*_+k*b+M*m-(B*b+D*m+N*_),ee=B*w+I*m+F*_-(L*_+k*w+O*m),te=r*V+i*z+o*U+a*G;if(Math.abs(te)<s.EPSILON20)throw new u("matrix is not invertible because its determinate is zero.");return n[0]=V*(te=1/te),n[1]=z*te,n[2]=U*te,n[3]=G*te,n[4]=W*te,n[5]=H*te,n[6]=j*te,n[7]=q*te,n[8]=Y*te,n[9]=X*te,n[10]=Z*te,n[11]=K*te,n[12]=Q*te,n[13]=J*te,n[14]=$*te,n[15]=ee*te,n},c.inverseTransformation=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],l=e[8],u=e[9],c=e[10],h=e[12],d=e[13],p=e[14],f=-n*h-r*d-i*p,m=-o*h-a*d-s*p,_=-l*h-u*d-c*p;return t[0]=n,t[1]=o,t[2]=l,t[3]=0,t[4]=r,t[5]=a,t[6]=u,t[7]=0,t[8]=i,t[9]=s,t[10]=c,t[11]=0,t[12]=f,t[13]=m,t[14]=_,t[15]=1,t},c.IDENTITY=a(new c(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),c.ZERO=a(new c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),c.COLUMN0ROW0=0,c.COLUMN0ROW1=1,c.COLUMN0ROW2=2,c.COLUMN0ROW3=3,c.COLUMN1ROW0=4,c.COLUMN1ROW1=5,c.COLUMN1ROW2=6,c.COLUMN1ROW3=7,c.COLUMN2ROW0=8,c.COLUMN2ROW1=9,c.COLUMN2ROW2=10,c.COLUMN2ROW3=11,c.COLUMN3ROW0=12,c.COLUMN3ROW1=13,c.COLUMN3ROW2=14,c.COLUMN3ROW3=15,i(c.prototype,{length:{get:function(){return c.packedLength}}}),c.prototype.clone=function(e){return c.clone(this,e)},c.prototype.equals=function(e){return c.equals(this,e)},c.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]&&e[4]===t[n+4]&&e[5]===t[n+5]&&e[6]===t[n+6]&&e[7]===t[n+7]&&e[8]===t[n+8]&&e[9]===t[n+9]&&e[10]===t[n+10]&&e[11]===t[n+11]&&e[12]===t[n+12]&&e[13]===t[n+13]&&e[14]===t[n+14]&&e[15]===t[n+15]},c.prototype.equalsEpsilon=function(e,t){return c.equalsEpsilon(this,e,t)},c.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"},c}),o("Core/Plane",["./Cartesian3","./defined","./DeveloperError","./freezeObject"],function(e,t,n,r){"use strict";function i(t,n){this.normal=e.clone(t),this.distance=n}i.fromPointNormal=function(n,r,o){var a=-e.dot(r,n);return t(o)?(e.clone(r,o.normal),o.distance=a,o):new i(r,a)};var o=new e;return i.fromCartesian4=function(n,r){var a=e.fromCartesian4(n,o),s=n.w;return t(r)?(e.clone(a,r.normal),r.distance=s,r):new i(a,s)},i.getPointDistance=function(t,n){return e.dot(t.normal,n)+t.distance},i.ORIGIN_XY_PLANE=r(new i(e.UNIT_Z,0)),i.ORIGIN_YZ_PLANE=r(new i(e.UNIT_X,0)),i.ORIGIN_ZX_PLANE=r(new i(e.UNIT_Y,0)),i}),o("Core/BoundingSphere",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./GeographicProjection","./Intersect","./Interval","./Matrix3","./Matrix4","./Plane","./Rectangle"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(t,r){this.center=e.clone(n(t,e.ZERO)),this.radius=n(r,0)}var f=new e,m=new e,_=new e,g=new e,v=new e,y=new e,C=new e,w=new e,b=new e,E=new e,S=new e,x=new e;p.fromPoints=function(t,n){if(r(n)||(n=new p),!r(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;for(var i=e.clone(t[0],C),o=e.clone(i,f),a=e.clone(i,m),s=e.clone(i,_),l=e.clone(i,g),u=e.clone(i,v),c=e.clone(i,y),h=t.length,d=1;d<h;d++){e.clone(t[d],i);var T=i.x,A=i.y,P=i.z;T<o.x&&e.clone(i,o),T>l.x&&e.clone(i,l),A<a.y&&e.clone(i,a),A>u.y&&e.clone(i,u),P<s.z&&e.clone(i,s),P>c.z&&e.clone(i,c)}var D=e.magnitudeSquared(e.subtract(l,o,w)),M=e.magnitudeSquared(e.subtract(u,a,w)),I=e.magnitudeSquared(e.subtract(c,s,w)),O=o,R=l,N=D;M>N&&(N=M,O=a,R=u),I>N&&(N=I,O=s,R=c);var L=b;L.x=.5*(O.x+R.x),L.y=.5*(O.y+R.y),L.z=.5*(O.z+R.z);var F=e.magnitudeSquared(e.subtract(R,L,w)),B=Math.sqrt(F),k=E;k.x=o.x,k.y=a.y,k.z=s.z;var V=S;V.x=l.x,V.y=u.y,V.z=c.z;var z=e.multiplyByScalar(e.add(k,V,w),.5,x),U=0;for(d=0;d<h;d++){e.clone(t[d],i);var G=e.magnitude(e.subtract(i,z,w));G>U&&(U=G);var W=e.magnitudeSquared(e.subtract(i,L,w));if(W>F){var H=Math.sqrt(W);F=(B=.5*(B+H))*B;var j=H-B;L.x=(B*L.x+j*i.x)/H,L.y=(B*L.y+j*i.y)/H,L.z=(B*L.z+j*i.z)/H}}return B<U?(e.clone(L,n.center),n.radius=B):(e.clone(z,n.center),n.radius=U),n};var T=new a,A=new e,P=new e,D=new t,M=new t;p.fromRectangle2D=function(e,t,n){return p.fromRectangleWithHeights2D(e,t,0,0,n)},p.fromRectangleWithHeights2D=function(t,i,o,a,s){if(r(s)||(s=new p),!r(t))return s.center=e.clone(e.ZERO,s.center),s.radius=0,s;i=n(i,T),d.southwest(t,D),D.height=o,d.northeast(t,M),M.height=a;var l=i.project(D,A),u=i.project(M,P),c=u.x-l.x,h=u.y-l.y,f=u.z-l.z;s.radius=.5*Math.sqrt(c*c+h*h+f*f);var m=s.center;return m.x=l.x+.5*c,m.y=l.y+.5*h,m.z=l.z+.5*f,s};var I=[];p.fromRectangle3D=function(e,t,i,a){var s;return t=n(t,o.WGS84),i=n(i,0),r(e)&&(s=d.subsample(e,t,i,I)),p.fromPoints(s,a)},p.fromVertices=function(t,i,o,a){if(r(a)||(a=new p),!r(t)||0===t.length)return a.center=e.clone(e.ZERO,a.center),a.radius=0,a;i=n(i,e.ZERO),o=n(o,3);var s=C;s.x=t[0]+i.x,s.y=t[1]+i.y,s.z=t[2]+i.z;for(var l=e.clone(s,f),u=e.clone(s,m),c=e.clone(s,_),h=e.clone(s,g),d=e.clone(s,v),T=e.clone(s,y),A=t.length,P=0;P<A;P+=o){var D=t[P]+i.x,M=t[P+1]+i.y,I=t[P+2]+i.z;s.x=D,s.y=M,s.z=I,D<l.x&&e.clone(s,l),D>h.x&&e.clone(s,h),M<u.y&&e.clone(s,u),M>d.y&&e.clone(s,d),I<c.z&&e.clone(s,c),I>T.z&&e.clone(s,T)}var O=e.magnitudeSquared(e.subtract(h,l,w)),R=e.magnitudeSquared(e.subtract(d,u,w)),N=e.magnitudeSquared(e.subtract(T,c,w)),L=l,F=h,B=O;R>B&&(B=R,L=u,F=d),N>B&&(B=N,L=c,F=T);var k=b;k.x=.5*(L.x+F.x),k.y=.5*(L.y+F.y),k.z=.5*(L.z+F.z);var V=e.magnitudeSquared(e.subtract(F,k,w)),z=Math.sqrt(V),U=E;U.x=l.x,U.y=u.y,U.z=c.z;var G=S;G.x=h.x,G.y=d.y,G.z=T.z;var W=e.multiplyByScalar(e.add(U,G,w),.5,x),H=0;for(P=0;P<A;P+=o){s.x=t[P]+i.x,s.y=t[P+1]+i.y,s.z=t[P+2]+i.z;var j=e.magnitude(e.subtract(s,W,w));j>H&&(H=j);var q=e.magnitudeSquared(e.subtract(s,k,w));if(q>V){var Y=Math.sqrt(q);V=(z=.5*(z+Y))*z;var X=Y-z;k.x=(z*k.x+X*s.x)/Y,k.y=(z*k.y+X*s.y)/Y,k.z=(z*k.z+X*s.z)/Y}}return z<H?(e.clone(k,a.center),a.radius=z):(e.clone(W,a.center),a.radius=H),a},p.fromEncodedCartesianVertices=function(t,n,i){if(r(i)||(i=new p),!r(t)||!r(n)||t.length!==n.length||0===t.length)return i.center=e.clone(e.ZERO,i.center),i.radius=0,i;var o=C;o.x=t[0]+n[0],o.y=t[1]+n[1],o.z=t[2]+n[2];for(var a=e.clone(o,f),s=e.clone(o,m),l=e.clone(o,_),u=e.clone(o,g),c=e.clone(o,v),h=e.clone(o,y),d=t.length,T=0;T<d;T+=3){var A=t[T]+n[T],P=t[T+1]+n[T+1],D=t[T+2]+n[T+2];o.x=A,o.y=P,o.z=D,A<a.x&&e.clone(o,a),A>u.x&&e.clone(o,u),P<s.y&&e.clone(o,s),P>c.y&&e.clone(o,c),D<l.z&&e.clone(o,l),D>h.z&&e.clone(o,h)}var M=e.magnitudeSquared(e.subtract(u,a,w)),I=e.magnitudeSquared(e.subtract(c,s,w)),O=e.magnitudeSquared(e.subtract(h,l,w)),R=a,N=u,L=M;I>L&&(L=I,R=s,N=c),O>L&&(L=O,R=l,N=h);var F=b;F.x=.5*(R.x+N.x),F.y=.5*(R.y+N.y),F.z=.5*(R.z+N.z);var B=e.magnitudeSquared(e.subtract(N,F,w)),k=Math.sqrt(B),V=E;V.x=a.x,V.y=s.y,V.z=l.z;var z=S;z.x=u.x,z.y=c.y,z.z=h.z;var U=e.multiplyByScalar(e.add(V,z,w),.5,x),G=0;for(T=0;T<d;T+=3){o.x=t[T]+n[T],o.y=t[T+1]+n[T+1],o.z=t[T+2]+n[T+2];var W=e.magnitude(e.subtract(o,U,w));W>G&&(G=W);var H=e.magnitudeSquared(e.subtract(o,F,w));if(H>B){var j=Math.sqrt(H);B=(k=.5*(k+j))*k;var q=j-k;F.x=(k*F.x+q*o.x)/j,F.y=(k*F.y+q*o.y)/j,F.z=(k*F.z+q*o.z)/j}}return k<G?(e.clone(F,i.center),i.radius=k):(e.clone(U,i.center),i.radius=G),i},p.fromCornerPoints=function(t,n,i){r(i)||(i=new p);var o=i.center;return e.add(t,n,o),e.multiplyByScalar(o,.5,o),i.radius=e.distance(o,n),i},p.fromEllipsoid=function(t,n){return r(n)||(n=new p),e.clone(e.ZERO,n.center),n.radius=t.maximumRadius,n};var O=new e;p.fromBoundingSpheres=function(t,n){if(r(n)||(n=new p),!r(t)||0===t.length)return n.center=e.clone(e.ZERO,n.center),n.radius=0,n;var i=t.length;if(1===i)return p.clone(t[0],n);if(2===i)return p.union(t[0],t[1],n);for(var o=[],a=0;a<i;a++)o.push(t[a].center);var s=(n=p.fromPoints(o,n)).center,l=n.radius;for(a=0;a<i;a++){var u=t[a];l=Math.max(l,e.distance(s,u.center,O)+u.radius)}return n.radius=l,n};var R=new e,N=new e,L=new e;p.fromOrientedBoundingBox=function(t,n){r(n)||(n=new p);var i=t.halfAxes,o=u.getColumn(i,0,R),a=u.getColumn(i,1,N),s=u.getColumn(i,2,L),l=e.magnitude(o),c=e.magnitude(a),h=e.magnitude(s);return n.center=e.clone(t.center,n.center),n.radius=Math.max(l,c,h),n},p.clone=function(t,n){if(r(t))return r(n)?(n.center=e.clone(t.center,n.center),n.radius=t.radius,n):new p(t.center,t.radius)},p.packedLength=4,p.pack=function(e,t,r){r=n(r,0);var i=e.center;return t[r++]=i.x,t[r++]=i.y,t[r++]=i.z,t[r]=e.radius,t},p.unpack=function(e,t,i){t=n(t,0),r(i)||(i=new p);var o=i.center;return o.x=e[t++],o.y=e[t++],o.z=e[t++],i.radius=e[t],i};var F=new e,B=new e;p.union=function(t,n,i){r(i)||(i=new p);var o=t.center,a=t.radius,s=n.radius,l=e.subtract(n.center,o,F),u=e.magnitude(l);if(a>=u+s)return t.clone(i),i;if(s>=u+a)return n.clone(i),i;var c=.5*(a+u+s),h=e.multiplyByScalar(l,(-a+c)/u,B);return e.add(h,o,h),e.clone(h,i.center),i.radius=c,i};var k=new e;p.expand=function(t,n,r){r=p.clone(t,r);var i=e.magnitude(e.subtract(n,r.center,k));return i>r.radius&&(r.radius=i),r},p.intersectPlane=function(t,n){var r=t.radius,i=e.dot(n.normal,t.center)+n.distance;return i<-r?s.OUTSIDE:i<r?s.INTERSECTING:s.INSIDE},p.transform=function(e,t,n){return r(n)||(n=new p),n.center=c.multiplyByPoint(t,e.center,n.center),n.radius=c.getMaximumScale(t)*e.radius,n};var V=new e;p.distanceSquaredTo=function(t,n){var r=e.subtract(t.center,n,V);return e.magnitudeSquared(r)-t.radius*t.radius},p.transformWithoutScale=function(e,t,n){return r(n)||(n=new p),n.center=c.multiplyByPoint(t,e.center,n.center),n.radius=e.radius,n};var z=new e;p.computePlaneDistances=function(t,n,i,o){r(o)||(o=new l);var a=e.subtract(t.center,n,z),s=e.dot(i,a);return o.start=s-t.radius,o.stop=s+t.radius,o};for(var U=new e,G=new e,W=new e,H=new e,j=new e,q=new t,Y=new Array(8),X=0;X<8;++X)Y[X]=new e;var Z=new a;return p.projectTo2D=function(t,r,i){var o=(r=n(r,Z)).ellipsoid,a=t.center,s=t.radius,l=o.geodeticSurfaceNormal(a,U),u=e.cross(e.UNIT_Z,l,G);e.normalize(u,u);var c=e.cross(l,u,W);e.normalize(c,c),e.multiplyByScalar(l,s,l),e.multiplyByScalar(c,s,c),e.multiplyByScalar(u,s,u);var h=e.negate(c,j),d=e.negate(u,H),f=Y,m=f[0];e.add(l,c,m),e.add(m,u,m),e.add(l,c,m=f[1]),e.add(m,d,m),e.add(l,h,m=f[2]),e.add(m,d,m),e.add(l,h,m=f[3]),e.add(m,u,m),e.negate(l,l),e.add(l,c,m=f[4]),e.add(m,u,m),e.add(l,c,m=f[5]),e.add(m,d,m),e.add(l,h,m=f[6]),e.add(m,d,m),e.add(l,h,m=f[7]),e.add(m,u,m);for(var _=f.length,g=0;g<_;++g){var v=f[g];e.add(a,v,v);var y=o.cartesianToCartographic(v,q);r.project(y,v)}var C=(a=(i=p.fromPoints(f,i)).center).x,w=a.y;return a.x=a.z,a.y=C,a.z=w,i},p.isOccluded=function(e,t){return!t.isBoundingSphereVisible(e)},p.equals=function(t,n){return t===n||r(t)&&r(n)&&e.equals(t.center,n.center)&&t.radius===n.radius},p.prototype.intersectPlane=function(e){return p.intersectPlane(this,e)},p.prototype.distanceSquaredTo=function(e){return p.distanceSquaredTo(this,e)},p.prototype.computePlaneDistances=function(e,t,n){return p.computePlaneDistances(this,e,t,n)},p.prototype.isOccluded=function(e){return p.isOccluded(this,e)},p.prototype.equals=function(e){return p.equals(this,e)},p.prototype.clone=function(e){return p.clone(this,e)},p}),o("Core/EllipsoidalOccluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Rectangle"],function(e,t,n,r,i,o,a){"use strict";function s(e,n){this._ellipsoid=e,this._cameraPosition=new t,this._cameraPositionInScaledSpace=new t,this._distanceToLimbInScaledSpaceSquared=0,r(n)&&(this.cameraPosition=n)}function l(e,n,r){var i=e.transformPositionToScaledSpace(n,f),o=t.magnitudeSquared(i),a=Math.sqrt(o),s=t.divideByScalar(i,a,m);o=Math.max(1,o);var l=1/(a=Math.max(1,a));return 1/(t.dot(s,r)*l-t.magnitude(t.cross(s,r,s))*(Math.sqrt(o-1)*l))}function u(e,n,r){if(!(n<=0||n===1/0||n!=n))return t.multiplyByScalar(e,n,r)}function c(e,n){return t.equals(n,t.ZERO)?n:(e.transformPositionToScaledSpace(n,_),t.normalize(_,_))}i(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){var n=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),r=t.magnitudeSquared(n)-1;t.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=n,this._distanceToLimbInScaledSpaceSquared=r}}});var h=new t;s.prototype.isPointVisible=function(e){var t=this._ellipsoid.transformPositionToScaledSpace(e,h);return this.isScaledSpacePointVisible(t)},s.prototype.isScaledSpacePointVisible=function(e){var n=this._cameraPositionInScaledSpace,r=this._distanceToLimbInScaledSpaceSquared,i=t.subtract(e,n,h),o=-t.dot(i,n);return!(r<0?o>0:o>r&&o*o/t.magnitudeSquared(i)>r)},s.prototype.computeHorizonCullingPoint=function(e,n,i){r(i)||(i=new t);for(var o=this._ellipsoid,a=c(o,e),s=0,h=0,d=n.length;h<d;++h){var p=l(o,n[h],a);s=Math.max(s,p)}return u(a,s,i)};var d=new t;s.prototype.computeHorizonCullingPointFromVertices=function(e,i,o,a,s){r(s)||(s=new t),a=n(a,t.ZERO);for(var h=this._ellipsoid,p=c(h,e),f=0,m=0,_=i.length;m<_;m+=o){d.x=i[m]+a.x,d.y=i[m+1]+a.y,d.z=i[m+2]+a.z;var g=l(h,d,p);f=Math.max(f,g)}return u(p,f,s)};var p=[];s.prototype.computeHorizonCullingPointFromRectangle=function(n,r,i){var o=a.subsample(n,r,0,p),s=e.fromPoints(o);if(!(t.magnitude(s.center)<.1*r.minimumRadius))return this.computeHorizonCullingPoint(s.center,o,i)};var f=new t,m=new t,_=new t;return s}),o("Core/QuadraticRealPolynomial",["./DeveloperError","./Math"],function(e,t){"use strict";function n(e,n,r){var i=e+n;return t.sign(e)!==t.sign(n)&&Math.abs(i/Math.max(Math.abs(e),Math.abs(n)))<r?0:i}var r={};return r.computeDiscriminant=function(e,t,n){return t*t-4*e*n},r.computeRealRoots=function(e,r,i){var o;if(0===e)return 0===r?[]:[-i/r];if(0===r){if(0===i)return[0,0];var a=Math.abs(i),s=Math.abs(e);if(a<s&&a/s<t.EPSILON14)return[0,0];if(a>s&&s/a<t.EPSILON14)return[];if((o=-i/e)<0)return[];var l=Math.sqrt(o);return[-l,l]}if(0===i)return o=-r/e,o<0?[o,0]:[0,o];var u=n(r*r,-4*e*i,t.EPSILON14);if(u<0)return[];var c=-.5*n(r,t.sign(r)*Math.sqrt(u),t.EPSILON14);return r>0?[c/e,i/c]:[i/c,c/e]},r}),o("Core/CubicRealPolynomial",["./DeveloperError","./QuadraticRealPolynomial"],function(e,t){"use strict";function n(e,t,n,r){var i,o,a=e,s=t/3,l=n/3,u=r,c=a*l,h=s*u,d=s*s,p=l*l,f=a*l-d,m=a*u-s*l,_=s*u-p,g=4*f*_-m*m;if(g<0){var v,y,C;d*h>=c*p?(v=a,y=f,C=-2*s*f+a*m):(v=u,y=_,C=-u*m+2*l*_);var w=-(C<0?-1:1)*Math.abs(v)*Math.sqrt(-g),b=(o=-C+w)/2,E=b<0?-Math.pow(-b,1/3):Math.pow(b,1/3),S=o===w?-E:-y/E;return i=y<=0?E+S:-C/(E*E+S*S+y),d*h>=c*p?[(i-s)/a]:[-u/(i+l)]}var x=f,T=-2*s*f+a*m,A=_,P=-u*m+2*l*_,D=Math.sqrt(g),M=Math.sqrt(3)/2,I=Math.abs(Math.atan2(a*D,-T)/3);i=2*Math.sqrt(-x);var O=Math.cos(I);o=i*O;var R=i*(-O/2-M*Math.sin(I)),N=o+R>2*s?o-s:R-s,L=a,F=N/L;I=Math.abs(Math.atan2(u*D,-P)/3);var B=-u,k=(o=(i=2*Math.sqrt(-A))*(O=Math.cos(I)))+(R=i*(-O/2-M*Math.sin(I)))<2*l?o+l:R+l,V=B/k,z=-N*k-L*B,U=(l*z-s*(N*B))/(-s*z+l*(L*k));return F<=U?F<=V?U<=V?[F,U,V]:[F,V,U]:[V,F,U]:F<=V?[U,F,V]:U<=V?[U,V,F]:[V,U,F]}var r={};return r.computeDiscriminant=function(e,t,n,r){var i=t*t,o=n*n;return 18*e*t*n*r+i*o-e*e*27*(r*r)-4*(e*o*n+i*t*r)},r.computeRealRoots=function(e,r,i,o){var a,s;if(0===e)return t.computeRealRoots(r,i,o);if(0===r){if(0===i){if(0===o)return[0,0,0];var l=(s=-o/e)<0?-Math.pow(-s,1/3):Math.pow(s,1/3);return[l,l,l]}return 0===o?0===(a=t.computeRealRoots(e,0,i)).Length?[0]:[a[0],0,a[1]]:n(e,0,i,o)}return 0===i?0===o?(s=-r/e)<0?[s,0,0]:[0,0,s]:n(e,r,0,o):0===o?0===(a=t.computeRealRoots(e,r,i)).length?[0]:a[1]<=0?[a[0],a[1],0]:a[0]>=0?[0,a[0],a[1]]:[a[0],0,a[1]]:n(e,r,i,o)},r}),o("Core/QuarticRealPolynomial",["./CubicRealPolynomial","./DeveloperError","./Math","./QuadraticRealPolynomial"],function(e,t,n,r){"use strict";function i(t,i,o,a){var s=t*t,l=i-3*s/8,u=o-i*t/2+s*t/8,c=a-o*t/4+i*s/16-3*s*s/256,h=e.computeRealRoots(1,2*l,l*l-4*c,-u*u);if(h.length>0){var d=-t/4,p=h[h.length-1];if(Math.abs(p)<n.EPSILON14){var f=r.computeRealRoots(1,l,c);if(2===f.length){var m,_=f[0],g=f[1];if(_>=0&&g>=0){var v=Math.sqrt(_),y=Math.sqrt(g);return[d-y,d-v,d+v,d+y]}if(_>=0&&g<0)return m=Math.sqrt(_),[d-m,d+m];if(_<0&&g>=0)return m=Math.sqrt(g),[d-m,d+m]}return[]}if(p>0){var C=Math.sqrt(p),w=(l+p+u/C)/2,b=r.computeRealRoots(1,C,(l+p-u/C)/2),E=r.computeRealRoots(1,-C,w);return 0!==b.length?(b[0]+=d,b[1]+=d,0!==E.length?(E[0]+=d,E[1]+=d,b[1]<=E[0]?[b[0],b[1],E[0],E[1]]:E[1]<=b[0]?[E[0],E[1],b[0],b[1]]:b[0]>=E[0]&&b[1]<=E[1]?[E[0],b[0],b[1],E[1]]:E[0]>=b[0]&&E[1]<=b[1]?[b[0],E[0],E[1],b[1]]:b[0]>E[0]&&b[0]<E[1]?[E[0],b[0],E[1],b[1]]:[b[0],E[0],b[1],E[1]]):b):0!==E.length?(E[0]+=d,E[1]+=d,E):[]}}return[]}function o(t,i,o,a){var s=t*t,l=e.computeRealRoots(1,-2*i,o*t+i*i-4*a,s*a-o*i*t+o*o);if(l.length>0){var u,c,h,d,p,f,m=l[0],_=i-m,g=_*_,v=t/2,y=_/2,C=g-4*a,w=g+4*Math.abs(a),b=s-4*m,E=s+4*Math.abs(m);if(m<0||C*E<b*w){var S=Math.sqrt(b);u=S/2,c=0===S?0:(t*y-o)/S}else{var x=Math.sqrt(C);u=0===x?0:(t*y-o)/x,c=x/2}0===v&&0===u?(h=0,d=0):n.sign(v)===n.sign(u)?d=m/(h=v+u):h=m/(d=v-u),0===y&&0===c?(p=0,f=0):n.sign(y)===n.sign(c)?f=a/(p=y+c):p=a/(f=y-c);var T=r.computeRealRoots(1,h,p),A=r.computeRealRoots(1,d,f);if(0!==T.length)return 0!==A.length?T[1]<=A[0]?[T[0],T[1],A[0],A[1]]:A[1]<=T[0]?[A[0],A[1],T[0],T[1]]:T[0]>=A[0]&&T[1]<=A[1]?[A[0],T[0],T[1],A[1]]:A[0]>=T[0]&&A[1]<=T[1]?[T[0],A[0],A[1],T[1]]:T[0]>A[0]&&T[0]<A[1]?[A[0],T[0],A[1],T[1]]:[T[0],A[0],T[1],A[1]]:T;if(0!==A.length)return A}return[]}var a={};return a.computeDiscriminant=function(e,t,n,r,i){var o=e*e,a=t*t,s=a*t,l=n*n,u=l*n,c=r*r,h=c*r,d=i*i;return a*l*c-4*s*h-4*e*u*c+18*e*t*n*h-27*o*c*c+o*e*256*(d*i)+i*(18*s*n*r-4*a*u+16*e*l*l-80*e*t*l*r-6*e*a*c+144*o*n*c)+d*(144*e*a*n-27*a*a-128*o*l-192*o*t*r)},a.computeRealRoots=function(t,r,a,s,l){if(Math.abs(t)<n.EPSILON15)return e.computeRealRoots(r,a,s,l);var u=r/t,c=a/t,h=s/t,d=l/t,p=u<0?1:0;switch(p+=c<0?p+1:p,p+=h<0?p+1:p,p+=d<0?p+1:p){case 0:return i(u,c,h,d);case 1:case 2:return o(u,c,h,d);case 3:case 4:return i(u,c,h,d);case 5:return o(u,c,h,d);case 6:case 7:return i(u,c,h,d);case 8:return o(u,c,h,d);case 9:case 10:return i(u,c,h,d);case 11:return o(u,c,h,d);case 12:case 13:case 14:case 15:return i(u,c,h,d);default:return}},a}),o("Core/Ray",["./Cartesian3","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";function i(n,r){r=e.clone(t(r,e.ZERO)),e.equals(r,e.ZERO)||e.normalize(r,r),this.origin=e.clone(t(n,e.ZERO)),this.direction=r}return i.getPoint=function(t,r,i){return n(i)||(i=new e),i=e.multiplyByScalar(t.direction,r,i),e.add(t.origin,i,i)},i}),o("Core/IntersectionTests",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Math","./Matrix3","./QuadraticRealPolynomial","./QuarticRealPolynomial","./Ray"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(t,n,i){r(i)||(i={});var o=t.direction,a=n.radius*n.radius,s=e.subtract(t.origin,n.center,m),l=function(e,t,n,r){var i=t*t-4*e*n;if(!(i<0)){if(i>0){var o=1/(2*e),a=Math.sqrt(i),s=(-t+a)*o,l=(-t-a)*o;return s<l?(r.root0=s,r.root1=l):(r.root0=l,r.root1=s),r}var u=-t/(2*e);if(0!==u)return r.root0=r.root1=u,r}}(e.dot(o,o),2*e.dot(o,s),e.magnitudeSquared(s)-a,y);if(r(l))return i.start=l.root0,i.stop=l.root1,i}function h(e,t,n){var r=e+t;return o.sign(e)!==o.sign(t)&&Math.abs(r/Math.max(Math.abs(e),Math.abs(t)))<n?0:r}var d={};d.rayPlane=function(t,n,i){r(i)||(i=new e);var a=t.origin,s=t.direction,l=n.normal,u=e.dot(l,s);if(!(Math.abs(u)<o.EPSILON15)){var c=(-n.distance-e.dot(l,a))/u;if(!(c<0))return i=e.multiplyByScalar(s,c,i),e.add(a,i,i)}};var p=new e,f=new e,m=new e,_=new e,g=new e;d.rayTriangleParametric=function(t,r,i,a,s){s=n(s,!1);var l,u,c,h,d,v=t.origin,y=t.direction,C=e.subtract(i,r,p),w=e.subtract(a,r,f),b=e.cross(y,w,m),E=e.dot(C,b);if(s){if(E<o.EPSILON6)return;if(l=e.subtract(v,r,_),(c=e.dot(l,b))<0||c>E)return;if(u=e.cross(l,C,g),(h=e.dot(y,u))<0||c+h>E)return;d=e.dot(w,u)/E}else{if(Math.abs(E)<o.EPSILON6)return;var S=1/E;if(l=e.subtract(v,r,_),(c=e.dot(l,b)*S)<0||c>1)return;if(u=e.cross(l,C,g),(h=e.dot(y,u)*S)<0||c+h>1)return;d=e.dot(w,u)*S}return d},d.rayTriangle=function(t,n,i,o,a,s){var l=d.rayTriangleParametric(t,n,i,o,a);if(r(l)&&!(l<0))return r(s)||(s=new e),e.multiplyByScalar(t.direction,l,s),e.add(t.origin,s,s)};var v=new u;d.lineSegmentTriangle=function(t,n,i,o,a,s,l){var u=v;e.clone(t,u.origin),e.subtract(n,t,u.direction),e.normalize(u.direction,u.direction);var c=d.rayTriangleParametric(u,i,o,a,s);if(!(!r(c)||c<0||c>e.distance(t,n)))return r(l)||(l=new e),e.multiplyByScalar(u.direction,c,l),e.add(u.origin,l,l)};var y={root0:0,root1:0};d.raySphere=function(e,t,n){if(n=c(e,t,n),r(n)&&!(n.stop<0))return n.start=Math.max(n.start,0),n};var C=new u;d.lineSegmentSphere=function(t,n,i,o){var a=C;e.clone(t,a.origin);var s=e.subtract(n,t,a.direction),l=e.magnitude(s);if(e.normalize(s,s),o=c(a,i,o),!(!r(o)||o.stop<0||o.start>l))return o.start=Math.max(o.start,0),o.stop=Math.min(o.stop,l),o};var w=new e,b=new e;d.rayEllipsoid=function(t,n){var r,i,o,a,s,l=n.oneOverRadii,u=e.multiplyComponents(l,t.origin,w),c=e.multiplyComponents(l,t.direction,b),h=e.magnitudeSquared(u),d=e.dot(u,c);if(h>1){if(d>=0)return;var p=d*d;if(r=h-1,p<(o=(i=e.magnitudeSquared(c))*r))return;if(p>o){a=d*d-o;var f=(s=-d+Math.sqrt(a))/i,m=r/s;return f<m?{start:f,stop:m}:{start:m,stop:f}}var _=Math.sqrt(r/i);return{start:_,stop:_}}return h<1?(r=h-1,a=d*d-(o=(i=e.magnitudeSquared(c))*r),{start:0,stop:(s=-d+Math.sqrt(a))/i}):d<0?{start:0,stop:-d/(i=e.magnitudeSquared(c))}:void 0};var E=new e,S=new e,x=new e,T=new e,A=new e,P=new a,D=new a,M=new a,I=new a,O=new a,R=new a,N=new a,L=new e,F=new e,B=new t;d.grazingAltitudeLocation=function(t,n){var i=t.origin,u=t.direction;if(!e.equals(i,e.ZERO)){var c=n.geodeticSurfaceNormal(i,E);if(e.dot(u,c)>=0)return i}var d=r(this.rayEllipsoid(t,n)),p=n.transformPositionToScaledSpace(u,E),f=e.normalize(p,p),m=e.mostOrthogonalAxis(p,T),_=e.normalize(e.cross(m,f,S),S),g=e.normalize(e.cross(f,_,x),x),v=P;v[0]=f.x,v[1]=f.y,v[2]=f.z,v[3]=_.x,v[4]=_.y,v[5]=_.z,v[6]=g.x,v[7]=g.y,v[8]=g.z;var y=a.transpose(v,D),C=a.fromScale(n.radii,M),w=a.fromScale(n.oneOverRadii,I),b=O;b[0]=0,b[1]=-u.z,b[2]=u.y,b[3]=u.z,b[4]=0,b[5]=-u.x,b[6]=-u.y,b[7]=u.x,b[8]=0;var k,V,z=a.multiply(a.multiply(y,w,R),b,R),U=a.multiply(a.multiply(z,C,N),v,N),G=a.multiplyByVector(z,i,A),W=function(t,n,r,i,u){var c,d=1*(t[a.COLUMN1ROW1]-t[a.COLUMN2ROW2]),p=1*(0*h(t[a.COLUMN1ROW0],t[a.COLUMN0ROW1],o.EPSILON15)+n.y),f=0*t[a.COLUMN0ROW0]+1*t[a.COLUMN2ROW2]+0*n.x+0,m=1*h(t[a.COLUMN2ROW1],t[a.COLUMN1ROW2],o.EPSILON15),_=1*(0*h(t[a.COLUMN2ROW0],t[a.COLUMN0ROW2])+n.z),g=[];if(0===_&&0===m){if(0===(c=s.computeRealRoots(d,p,f)).length)return g;var v=c[0],y=Math.sqrt(Math.max(1-v*v,0));if(g.push(new e(0,1*v,1*-y)),g.push(new e(0,1*v,1*y)),2===c.length){var C=c[1],w=Math.sqrt(Math.max(1-C*C,0));g.push(new e(0,1*C,1*-w)),g.push(new e(0,1*C,1*w))}return g}var b=_*_,E=m*m,S=_*m,x=d*d+E,T=2*(p*d+S),A=2*f*d+p*p-E+b,P=2*(f*p-S),D=f*f-b;if(0===x&&0===T&&0===A&&0===P)return g;var M=(c=l.computeRealRoots(x,T,A,P,D)).length;if(0===M)return g;for(var I=0;I<M;++I){var O=c[I],R=O*O,N=Math.max(1-R,0),L=Math.sqrt(N),F=(o.sign(d)===o.sign(f)?h(d*R+f,p*O,o.EPSILON12):o.sign(f)===o.sign(p*O)?h(d*R,p*O+f,o.EPSILON12):h(d*R+p*O,f,o.EPSILON12))*h(m*O,_,o.EPSILON15);F<0?g.push(new e(0,1*O,1*L)):F>0?g.push(new e(0,1*O,1*-L)):0!==L?(g.push(new e(0,1*O,1*-L)),g.push(new e(0,1*O,1*L)),++I):g.push(new e(0,1*O,1*L))}return g}(U,e.negate(G,E)),H=W.length;if(H>0){for(var j=e.clone(e.ZERO,F),q=Number.NEGATIVE_INFINITY,Y=0;Y<H;++Y){k=a.multiplyByVector(C,a.multiplyByVector(v,W[Y],L),L);var X=e.normalize(e.subtract(k,i,T),T),Z=e.dot(X,u);Z>q&&(q=Z,j=e.clone(k,j))}var K=n.cartesianToCartographic(j,B);return q=o.clamp(q,0,1),V=e.magnitude(e.subtract(j,i,T))*Math.sqrt(1-q*q),K.height=V=d?-V:V,n.cartographicToCartesian(K,new e)}};var k=new e;return d.lineSegmentPlane=function(t,n,i,a){r(a)||(a=new e);var s=e.subtract(n,t,k),l=i.normal,u=e.dot(l,s);if(!(Math.abs(u)<o.EPSILON6)){var c=e.dot(l,t),h=-(i.distance+c)/u;if(!(h<0||h>1))return e.multiplyByScalar(s,h,a),e.add(t,a,a),a}},d.trianglePlaneIntersection=function(t,n,r,i){var o,a,s=i.normal,l=i.distance,u=e.dot(s,t)+l<0,c=e.dot(s,n)+l<0,h=e.dot(s,r)+l<0,p=0;if(p+=u?1:0,p+=c?1:0,1!==(p+=h?1:0)&&2!==p||(o=new e,a=new e),1===p){if(u)return d.lineSegmentPlane(t,n,i,o),d.lineSegmentPlane(t,r,i,a),{positions:[t,n,r,o,a],indices:[0,3,4,1,2,4,1,4,3]};if(c)return d.lineSegmentPlane(n,r,i,o),d.lineSegmentPlane(n,t,i,a),{positions:[t,n,r,o,a],indices:[1,3,4,2,0,4,2,4,3]};if(h)return d.lineSegmentPlane(r,t,i,o),d.lineSegmentPlane(r,n,i,a),{positions:[t,n,r,o,a],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===p){if(!u)return d.lineSegmentPlane(n,t,i,o),d.lineSegmentPlane(r,t,i,a),{positions:[t,n,r,o,a],indices:[1,2,4,1,4,3,0,3,4]};if(!c)return d.lineSegmentPlane(r,n,i,o),d.lineSegmentPlane(t,n,i,a),{positions:[t,n,r,o,a],indices:[2,0,4,2,4,3,1,3,4]};if(!h)return d.lineSegmentPlane(t,r,i,o),d.lineSegmentPlane(n,r,i,a),{positions:[t,n,r,o,a],indices:[0,1,4,0,4,3,2,3,4]}}},d}),o("Core/oneTimeWarning",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(n,r){t(i[n])||(i[n]=!0,console.log(e(r,n)))}var i={};return r.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",r}),o("Core/deprecationWarning",["./defined","./DeveloperError","./oneTimeWarning"],function(e,t,n){"use strict";return function(e,t){n(e,t)}}),o("Core/binarySearch",["./defined","./DeveloperError"],function(e,t){"use strict";return function(e,t,n){for(var r,i,o=0,a=e.length-1;o<=a;)if(r=~~((o+a)/2),i=n(e[r],t),i<0)o=r+1;else{if(!(i>0))return r;a=r-1}return~(a+1)}}),o("Core/EarthOrientationParametersSample",[],function(){"use strict";return function(e,t,n,r,i){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=n,this.yPoleOffset=r,this.ut1MinusUtc=i}}),o("ThirdParty/sprintf",[],function(){return function(){var e=arguments,t=0,n=function(e,t,n,r){n||(n=" ");var i=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return r?e+i:i+e},r=function(e,t,r,i,o,a){var s=i-e.length;return s>0&&(e=r||!o?n(e,i,a,r):e.slice(0,t.length)+n("",s,"0",!0)+e.slice(t.length)),e},i=function(e,t,i,o,a,s,l){var u=e>>>0;return e=(i=i&&u&&{2:"0b",8:"0",16:"0x"}[t]||"")+n(u.toString(t),s||0,"0",!1),r(e,i,o,a,l)},o=function(e,t,n,i,o,a){return null!=i&&(e=e.slice(0,i)),r(e,"",t,n,o,a)};return e[t++].replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,function(a,s,l,u,c,h,d){var p,f,m,_,g;if("%%"==a)return"%";for(var v=!1,y="",C=!1,w=!1,b=" ",E=l.length,S=0;l&&S<E;S++)switch(l.charAt(S)){case" ":y=" ";break;case"+":y="+";break;case"-":v=!0;break;case"'":b=l.charAt(S+1);break;case"0":C=!0;break;case"#":w=!0}if((u=u?"*"==u?+e[t++]:"*"==u.charAt(0)?+e[u.slice(1,-1)]:+u:0)<0&&(u=-u,v=!0),!isFinite(u))throw new Error("sprintf: (minimum-)width must be finite");switch(h=h?"*"==h?+e[t++]:"*"==h.charAt(0)?+e[h.slice(1,-1)]:+h:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,g=s?e[s.slice(0,-1)]:e[t++],d){case"s":return o(String(g),v,u,h,C,b);case"c":return o(String.fromCharCode(+g),v,u,h,C);case"b":return i(g,2,w,v,u,h,C);case"o":return i(g,8,w,v,u,h,C);case"x":return i(g,16,w,v,u,h,C);case"X":return i(g,16,w,v,u,h,C).toUpperCase();case"u":return i(g,10,w,v,u,h,C);case"i":case"d":return p=+g||0,g=(f=(p=Math.round(p-p%1))<0?"-":y)+n(String(Math.abs(p)),h,"0",!1),r(g,f,v,u,C);case"e":case"E":case"f":case"F":case"g":case"G":return f=(p=+g)<0?"-":y,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],_=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],g=f+Math.abs(p)[m](h),r(g,f,v,u,C)[_]();default:return a}})}}),o("Core/GregorianDate",[],function(){"use strict";return function(e,t,n,r,i,o,a,s){this.year=e,this.month=t,this.day=n,this.hour=r,this.minute=i,this.second=o,this.millisecond=a,this.isLeapSecond=s}}),o("Core/isLeapYear",["./DeveloperError"],function(e){"use strict";return function(e){return e%4==0&&e%100!=0||e%400==0}}),o("Core/LeapSecond",[],function(){"use strict";return function(e,t){this.julianDate=e,this.offset=t}}),o("Core/TimeConstants",["./freezeObject"],function(e){"use strict";return e({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5})}),o("Core/TimeStandard",["./freezeObject"],function(e){"use strict";return e({UTC:0,TAI:1})}),o("Core/JulianDate",["../ThirdParty/sprintf","./binarySearch","./defaultValue","./defined","./DeveloperError","./GregorianDate","./isLeapYear","./LeapSecond","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,t){return m.compare(e.julianDate,t.julianDate)}function h(e){v.julianDate=e;var n=m.leapSeconds,r=t(n,v,c);r<0&&(r=~r),r>=n.length&&(r=n.length-1);var i=n[r].offset;r>0&&m.secondsDifference(n[r].julianDate,e)>i&&(i=n[--r].offset),m.addSeconds(e,i,e)}function d(e,n){v.julianDate=e;var r=m.leapSeconds,i=t(r,v,c);if(i<0&&(i=~i),0===i)return m.addSeconds(e,-r[0].offset,n);if(i>=r.length)return m.addSeconds(e,-r[i-1].offset,n);var o=m.secondsDifference(r[i].julianDate,e);return 0===o?m.addSeconds(e,-r[i].offset,n):o<=1?void 0:m.addSeconds(e,-r[--i].offset,n)}function p(e,t,n){var r=t/l.SECONDS_PER_DAY|0;return e+=r,(t-=l.SECONDS_PER_DAY*r)<0&&(e--,t+=l.SECONDS_PER_DAY),n.dayNumber=e,n.secondsOfDay=t,n}function f(e,t,n,r,i,o,a){var s=(t-14)/12|0,u=e+4800+s,c=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+n-32075;(r-=12)<0&&(r+=24);var h=o+(r*l.SECONDS_PER_HOUR+i*l.SECONDS_PER_MINUTE+a*l.SECONDS_PER_MILLISECOND);return h>=43200&&(c-=1),[c,h]}function m(e,t,r){this.dayNumber=void 0,this.secondsOfDay=void 0,e=n(e,0),t=n(t,0),r=n(r,u.UTC);var i=0|e;p(i,t+=(e-i)*l.SECONDS_PER_DAY,this),r===u.UTC&&h(this)}var _=new o,g=[31,28,31,30,31,30,31,31,30,31,30,31],v=new s,y=/^(\d{4})$/,C=/^(\d{4})-(\d{2})$/,w=/^(\d{4})-?(\d{3})$/,b=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,E=/^(\d{4})-?(\d{2})-?(\d{2})$/,S=/([Z+\-])?(\d{2})?:?(\d{2})?$/,x=/^(\d{2})(\.\d+)?/.source+S.source,T=/^(\d{2}):?(\d{2})(\.\d+)?/.source+S.source,A=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+S.source;m.fromDate=function(e,t){var n=f(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return r(t)?(p(n[0],n[1],t),h(t),t):new m(n[0],n[1],u.UTC)},m.fromIso8601=function(e,t){var n,i,o,s,l=(e=e.replace(",",".")).split("T"),c=1,d=1,_=0,v=0,S=0,P=0,D=l[0],M=l[1];if(null!==(l=D.match(E)))n=+l[1],c=+l[2],d=+l[3];else if(l=D.match(C),null!==l)n=+l[1],c=+l[2];else if(l=D.match(y),null!==l)n=+l[1];else{var I;null!==(l=D.match(w))?(I=+l[2],o=a(n=+l[1])):null!==(l=D.match(b))&&(n=+l[1],I=7*+l[2]+(+l[3]||0)-new Date(Date.UTC(n,0,4)).getUTCDay()-3),(i=new Date(Date.UTC(n,0,1))).setUTCDate(I),c=i.getUTCMonth()+1,d=i.getUTCDate()}if(o=a(n),r(M)){null!==(l=M.match(A))?(_=+l[1],v=+l[2],S=+l[3],P=1e3*+(l[4]||0),s=5):null!==(l=M.match(T))?(_=+l[1],v=+l[2],S=60*+(l[3]||0),s=4):null!==(l=M.match(x))&&(_=+l[1],v=60*+(l[2]||0),s=3);var O=+l[s+1],R=+(l[s+2]||0);switch(l[s]){case"+":_-=O,v-=R;break;case"-":_+=O,v+=R;break;case"Z":break;default:v+=new Date(Date.UTC(n,c-1,d,_,v)).getTimezoneOffset()}}else v+=new Date(n,c-1,d).getTimezoneOffset();var N=60===S;for(N&&S--;v>=60;)v-=60,_++;for(;_>=24;)_-=24,d++;for(i=o&&2===c?29:g[c-1];d>i;)d-=i,c++,c>12&&(c-=12,n++),i=o&&2===c?29:g[c-1];for(;v<0;)v+=60,_--;for(;_<0;)_+=24,d--;for(;d<1;)c--,c<1&&(c+=12,n--),i=o&&2===c?29:g[c-1],d+=i;var L=f(n,c,d,_,v,S,P);return r(t)?(p(L[0],L[1],t),h(t)):t=new m(L[0],L[1],u.UTC),N&&m.addSeconds(t,1,t),t},m.now=function(e){return m.fromDate(new Date,e)};var P=new m(0,0,u.TAI);return m.toGregorianDate=function(e,t){var n=!1,i=d(e,P);r(i)||(m.addSeconds(e,-1,P),i=d(P,P),n=!0);var a=i.dayNumber,s=i.secondsOfDay;s>=43200&&(a+=1);var u=a+68569|0,c=4*u/146097|0,h=4e3*(1+(u=u-((146097*c+3)/4|0)|0))/1461001|0,p=80*(u=u-(1461*h/4|0)+31|0)/2447|0,f=u-(2447*p/80|0)|0,_=p+2-12*(u=p/11|0)|0,g=100*(c-49)+h+u|0,v=s/l.SECONDS_PER_HOUR|0,y=s-v*l.SECONDS_PER_HOUR,C=y/l.SECONDS_PER_MINUTE|0,w=0|(y-=C*l.SECONDS_PER_MINUTE),b=(y-w)/l.SECONDS_PER_MILLISECOND;return(v+=12)>23&&(v-=24),n&&(w+=1),r(t)?(t.year=g,t.month=_,t.day=f,t.hour=v,t.minute=C,t.second=w,t.millisecond=b,t.isLeapSecond=n,t):new o(g,_,f,v,C,w,b,n)},m.toDate=function(e){var t=m.toGregorianDate(e,_),n=t.second;return t.isLeapSecond&&(n-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,n,t.millisecond))},m.toIso8601=function(t,n){var i,o=m.toGregorianDate(t,o);return r(n)||0===o.millisecond?r(n)&&0!==n?(i=(.01*o.millisecond).toFixed(n).replace(".","").slice(0,n),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o.year,o.month,o.day,o.hour,o.minute,o.second,i)):e("%04d-%02d-%02dT%02d:%02d:%02dZ",o.year,o.month,o.day,o.hour,o.minute,o.second):(i=(.01*o.millisecond).toString().replace(".",""),e("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",o.year,o.month,o.day,o.hour,o.minute,o.second,i))},m.clone=function(e,t){if(r(e))return r(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new m(e.dayNumber,e.secondsOfDay,u.TAI)},m.compare=function(e,t){var n=e.dayNumber-t.dayNumber;return 0!==n?n:e.secondsOfDay-t.secondsOfDay},m.equals=function(e,t){return e===t||r(e)&&r(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},m.equalsEpsilon=function(e,t,n){return e===t||r(e)&&r(t)&&Math.abs(m.secondsDifference(e,t))<=n},m.totalDays=function(e){return e.dayNumber+e.secondsOfDay/l.SECONDS_PER_DAY},m.secondsDifference=function(e,t){return(e.dayNumber-t.dayNumber)*l.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},m.daysDifference=function(e,t){return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/l.SECONDS_PER_DAY},m.computeTaiMinusUtc=function(e){v.julianDate=e;var n=m.leapSeconds,r=t(n,v,c);return r<0&&(r=~r,--r<0&&(r=0)),n[r].offset},m.addSeconds=function(e,t,n){return p(e.dayNumber,e.secondsOfDay+t,n)},m.addMinutes=function(e,t,n){return p(e.dayNumber,e.secondsOfDay+t*l.SECONDS_PER_MINUTE,n)},m.addHours=function(e,t,n){return p(e.dayNumber,e.secondsOfDay+t*l.SECONDS_PER_HOUR,n)},m.addDays=function(e,t,n){return p(e.dayNumber+t,e.secondsOfDay,n)},m.lessThan=function(e,t){return m.compare(e,t)<0},m.lessThanOrEquals=function(e,t){return m.compare(e,t)<=0},m.greaterThan=function(e,t){return m.compare(e,t)>0},m.greaterThanOrEquals=function(e,t){return m.compare(e,t)>=0},m.prototype.clone=function(e){return m.clone(this,e)},m.prototype.equals=function(e){return m.equals(this,e)},m.prototype.equalsEpsilon=function(e,t){return m.equalsEpsilon(this,e,t)},m.prototype.toString=function(){return m.toIso8601(this)},m.leapSeconds=[new s(new m(2441317,43210,u.TAI),10),new s(new m(2441499,43211,u.TAI),11),new s(new m(2441683,43212,u.TAI),12),new s(new m(2442048,43213,u.TAI),13),new s(new m(2442413,43214,u.TAI),14),new s(new m(2442778,43215,u.TAI),15),new s(new m(2443144,43216,u.TAI),16),new s(new m(2443509,43217,u.TAI),17),new s(new m(2443874,43218,u.TAI),18),new s(new m(2444239,43219,u.TAI),19),new s(new m(2444786,43220,u.TAI),20),new s(new m(2445151,43221,u.TAI),21),new s(new m(2445516,43222,u.TAI),22),new s(new m(2446247,43223,u.TAI),23),new s(new m(2447161,43224,u.TAI),24),new s(new m(2447892,43225,u.TAI),25),new s(new m(2448257,43226,u.TAI),26),new s(new m(2448804,43227,u.TAI),27),new s(new m(2449169,43228,u.TAI),28),new s(new m(2449534,43229,u.TAI),29),new s(new m(2450083,43230,u.TAI),30),new s(new m(2450630,43231,u.TAI),31),new s(new m(2451179,43232,u.TAI),32),new s(new m(2453736,43233,u.TAI),33),new s(new m(2454832,43234,u.TAI),34),new s(new m(2456109,43235,u.TAI),35),new s(new m(2457204,43236,u.TAI),36),new s(new m(2457754,43237,u.TAI),37)],m}),o("Core/clone",["./defaultValue"],function(e){"use strict";return function t(n,r){if(null===n||"object"!=typeof n)return n;r=e(r,!1);var i=new n.constructor;for(var o in n)if(n.hasOwnProperty(o)){var a=n[o];r&&(a=t(a,r)),i[o]=a}return i}}),o("ThirdParty/Uri",[],function(){function e(t){if(t instanceof e)this.scheme=t.scheme,this.authority=t.authority,this.path=t.path,this.query=t.query,this.fragment=t.fragment;else if(t){var n=r.exec(t);this.scheme=n[1],this.authority=n[2],this.path=n[3],this.query=n[4],this.fragment=n[5]}}function t(e){var t=unescape(e);return o.test(t)?t:e.toUpperCase()}function n(e,t,n,r){return(t||"")+n.toLowerCase()+(r||"")}e.prototype.scheme=null,e.prototype.authority=null,e.prototype.path="",e.prototype.query=null,e.prototype.fragment=null;var r=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");e.prototype.getScheme=function(){return this.scheme},e.prototype.getAuthority=function(){return this.authority},e.prototype.getPath=function(){return this.path},e.prototype.getQuery=function(){return this.query},e.prototype.getFragment=function(){return this.fragment},e.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},e.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},e.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},e.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(a,n).replace(i,t)),this.path&&(this.path=this.path.replace(i,t)),this.query&&(this.query=this.query.replace(i,t)),this.fragment&&(this.fragment=this.fragment.replace(i,t))};var i=/%[0-9a-z]{2}/gi,o=/[a-zA-Z0-9\-\._~]/,a=/(.*@)?([^@:]*)(:.*)?/;return e.prototype.resolve=function(t){var n=new e;return this.scheme?(n.scheme=this.scheme,n.authority=this.authority,n.path=this.path,n.query=this.query):(n.scheme=t.scheme,this.authority?(n.authority=this.authority,n.path=this.path,n.query=this.query):(n.authority=t.authority,""==this.path?(n.path=t.path,n.query=this.query||t.query):("/"==this.path.charAt(0)?(n.path=this.path,n.removeDotSegments()):(n.path=t.authority&&""==t.path?"/"+this.path:t.path.substring(0,t.path.lastIndexOf("/")+1)+this.path,n.removeDotSegments()),n.query=this.query))),n.fragment=this.fragment,n},e.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),n=[],r=""==t[0];for(r&&t.shift(),""==t[0]&&t.shift();t.length;)e=t.shift(),".."==e?n.pop():"."!=e&&n.push(e);"."!=e&&".."!=e||n.push(""),r&&n.unshift(""),this.path=n.join("/")},e.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},e}),o("Core/TrustedServers",["./defined","./defineProperties","./DeveloperError","../ThirdParty/Uri"],function(e,t,n,r){"use strict";var i={},o={};return i.add=function(t,n){var r=t.toLowerCase()+":"+n;e(o[r])||(o[r]=!0)},i.remove=function(t,n){var r=t.toLowerCase()+":"+n;e(o[r])&&delete o[r]},i.contains=function(t){var n=function(n){var i=new r(t);i.normalize();var o=i.getAuthority();if(e(o)){if(-1!==o.indexOf("@")&&(o=o.split("@")[1]),-1===o.indexOf(":")){var a=i.getScheme();if(e(a)||(a=(a=window.location.protocol).substring(0,a.length-1)),"http"===a)o+=":80";else{if("https"!==a)return;o+=":443"}}return o}}();return!(!e(n)||!e(o[n]))},i.clear=function(){o={}},i}),o("Core/parseResponseHeaders",[],function(){"use strict";return function(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0;r<n.length;++r){var i=n[r],o=i.indexOf(": ");if(o>0){var a=i.substring(0,o),s=i.substring(o+2);t[a]=s}}return t}}),o("Core/RequestErrorEvent",["./defined","./parseResponseHeaders"],function(e,t){"use strict";function n(e,n,r){this.statusCode=e,this.response=n,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=t(this.responseHeaders))}return n.prototype.toString=function(){var t="Request has failed.";return e(this.statusCode)&&(t+=" Status Code: "+this.statusCode),t},n}),o("Core/loadWithXhr",["../ThirdParty/when","./TrustedServers","./defaultValue","./defined","./DeveloperError","./RequestErrorEvent","./RuntimeError"],function(e,t,n,r,i,o,a){"use strict";function s(t){var r=(t=n(t,n.EMPTY_OBJECT)).responseType,i=n(t.method,"GET"),o=t.data,a=t.headers,l=t.overrideMimeType;return e(t.url,function(t){var n=e.defer();return s.load(t,r,i,o,a,n,l),n.promise})}function l(e,t){var n=decodeURIComponent(t);return e?atob(n):n}function u(e,t){for(var n=l(e,t),r=new ArrayBuffer(n.length),i=new Uint8Array(r),o=0;o<n.length;o++)i[o]=n.charCodeAt(o);return r}var c=/^data:(.*?)(;base64)?,(.*)$/;return s.defaultLoad=s.load=function(e,i,s,h,d,p,f){var m=c.exec(e);if(null===m){var _=new XMLHttpRequest;if(t.contains(e)&&(_.withCredentials=!0),r(f)&&r(_.overrideMimeType)&&_.overrideMimeType(f),_.open(s,e,!0),r(d))for(var g in d)d.hasOwnProperty(g)&&_.setRequestHeader(g,d[g]);r(i)&&(_.responseType=i),_.onload=function(){if(_.status<200||_.status>=300)p.reject(new o(_.status,_.response,_.getAllResponseHeaders()));else{var e=_.response,t=_.responseType;if(!r(e)||r(i)&&t!==i)if("json"===i&&"string"==typeof e)try{p.resolve(JSON.parse(e))}catch(e){p.reject(e)}else(""===t||"document"===t)&&r(_.responseXML)&&_.responseXML.hasChildNodes()?p.resolve(_.responseXML):""!==t&&"text"!==t||!r(_.responseText)?p.reject(new a("Invalid XMLHttpRequest response type.")):p.resolve(_.responseText);else p.resolve(e)}},_.onerror=function(e){p.reject(new o)},_.send(h)}else p.resolve(function(e,t){t=n(t,"");var r=e[1],i=!!e[2],o=e[3];switch(t){case"":case"text":return l(i,o);case"arraybuffer":return u(i,o);case"blob":var a=u(i,o);return new Blob([a],{type:r});case"document":return(new DOMParser).parseFromString(l(i,o),r);case"json":return JSON.parse(l(i,o))}}(m,i))},s}),o("Core/loadText",["./loadWithXhr"],function(e){"use strict";return function(t,n){return e({url:t,headers:n})}}),o("Core/loadJson",["./clone","./defined","./DeveloperError","./loadText"],function(e,t,n,r){"use strict";var i={Accept:"application/json,*/*;q=0.01"};return function(n,o){return t(o)?t(o.Accept)||((o=e(o)).Accept=i.Accept):o=i,r(n,o).then(function(e){return JSON.parse(e)})}}),o("Core/EarthOrientationParameters",["../ThirdParty/when","./binarySearch","./defaultValue","./defined","./EarthOrientationParametersSample","./freezeObject","./JulianDate","./LeapSecond","./loadJson","./RuntimeError","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(t){if(t=n(t,n.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=n(t.addNewLeapSeconds,!0),r(t.data))f(this,t.data);else if(r(t.url)){var i=this;this._downloadPromise=e(l(t.url),function(e){f(i,e)},function(){i._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."})}else f(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function p(e,t){return a.compare(e.julianDate,t)}function f(e,n){if(r(n.columnNames))if(r(n.samples)){var i=n.columnNames.indexOf("modifiedJulianDateUtc"),o=n.columnNames.indexOf("xPoleWanderRadians"),l=n.columnNames.indexOf("yPoleWanderRadians"),u=n.columnNames.indexOf("ut1MinusUtcSeconds"),d=n.columnNames.indexOf("xCelestialPoleOffsetRadians"),f=n.columnNames.indexOf("yCelestialPoleOffsetRadians"),m=n.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||o<0||l<0||u<0||d<0||f<0||m<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var _=e._samples=n.samples,g=e._dates=[];e._dateColumn=i,e._xPoleWanderRadiansColumn=o,e._yPoleWanderRadiansColumn=l,e._ut1MinusUtcSecondsColumn=u,e._xCelestialPoleOffsetRadiansColumn=d,e._yCelestialPoleOffsetRadiansColumn=f,e._taiMinusUtcSecondsColumn=m,e._columnCount=n.columnNames.length,e._lastIndex=void 0;for(var v,y=e._addNewLeapSeconds,C=0,w=_.length;C<w;C+=e._columnCount){var b=_[C+m],E=new a(_[C+i]+c.MODIFIED_JULIAN_DATE_DIFFERENCE,b,h.TAI);if(g.push(E),y){if(b!==v&&r(v)){var S=a.leapSeconds,x=t(S,E,p);if(x<0){var T=new s(E,b);S.splice(~x,0,T)}}v=b}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function m(e,t,n,r,i){var o=n*r;i.xPoleWander=t[o+e._xPoleWanderRadiansColumn],i.yPoleWander=t[o+e._yPoleWanderRadiansColumn],i.xPoleOffset=t[o+e._xCelestialPoleOffsetRadiansColumn],i.yPoleOffset=t[o+e._yCelestialPoleOffsetRadiansColumn],i.ut1MinusUtc=t[o+e._ut1MinusUtcSecondsColumn]}function _(e,t,n){return t+e*(n-t)}function g(e,t,n,r,i,o,s){var l=e._columnCount;if(o>t.length-1)return s.xPoleWander=0,s.yPoleWander=0,s.xPoleOffset=0,s.yPoleOffset=0,s.ut1MinusUtc=0,s;var u=t[i],c=t[o];if(u.equals(c)||r.equals(u))return m(e,n,i,l,s),s;if(r.equals(c))return m(e,n,o,l,s),s;var h=a.secondsDifference(r,u)/a.secondsDifference(c,u),d=i*l,p=o*l,f=n[d+e._ut1MinusUtcSecondsColumn],g=n[p+e._ut1MinusUtcSecondsColumn],v=g-f;if(v>.5||v<-.5){var y=n[d+e._taiMinusUtcSecondsColumn],C=n[p+e._taiMinusUtcSecondsColumn];y!==C&&(c.equals(r)?f=g:g-=C-y)}return s.xPoleWander=_(h,n[d+e._xPoleWanderRadiansColumn],n[p+e._xPoleWanderRadiansColumn]),s.yPoleWander=_(h,n[d+e._yPoleWanderRadiansColumn],n[p+e._yPoleWanderRadiansColumn]),s.xPoleOffset=_(h,n[d+e._xCelestialPoleOffsetRadiansColumn],n[p+e._xCelestialPoleOffsetRadiansColumn]),s.yPoleOffset=_(h,n[d+e._yCelestialPoleOffsetRadiansColumn],n[p+e._yCelestialPoleOffsetRadiansColumn]),s.ut1MinusUtc=_(h,f,g),s}return d.NONE=o({getPromiseToLoad:function(){return e()},compute:function(e,t){return r(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new i(0,0,0,0,0),t}}),d.prototype.getPromiseToLoad=function(){return e(this._downloadPromise)},d.prototype.compute=function(e,n){if(r(this._samples)){if(r(n)||(n=new i(0,0,0,0,0)),0===this._samples.length)return n.xPoleWander=0,n.yPoleWander=0,n.xPoleOffset=0,n.yPoleOffset=0,n.ut1MinusUtc=0,n;var o=this._dates,s=this._lastIndex,l=0,c=0;if(r(s)){var h=o[s+1],d=a.lessThanOrEquals(o[s],e),p=!r(h),f=p||a.greaterThanOrEquals(h,e);if(d&&f)return l=s,!p&&h.equals(e)&&++l,c=l+1,g(this,o,this._samples,e,l,c,n),n}var m=t(o,e,a.compare,this._dateColumn);return m>=0?(m<o.length-1&&o[m+1].equals(e)&&++m,l=m,c=m):(l=(c=~m)-1)<0&&(l=0),this._lastIndex=l,g(this,o,this._samples,e,l,c,n),n}if(r(this._dataError))throw new u(this._dataError)},d}),o("Core/getAbsoluteUri",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";return function(n,r){r=t(r,document.location.href);var i=new e(r);return new e(n).resolve(i).toString()}}),o("Core/joinUrls",["../ThirdParty/Uri","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r){"use strict";return function(r,i,o){o=t(o,!0),r instanceof e||(r=new e(r)),i instanceof e||(i=new e(i)),n(i.authority)&&!n(i.scheme)&&(i.scheme="undefined"!=typeof document&&n(document.location)&&n(document.location.href)?new e(document.location.href).scheme:r.scheme);var a=r;i.isAbsolute()&&(a=i);var s="";n(a.scheme)&&(s+=a.scheme+":"),n(a.authority)&&(s+="//"+a.authority,""!==a.path&&"/"!==a.path&&(s=s.replace(/\/?$/,"/"),a.path=a.path.replace(/^\/?/g,""))),s+=a===r?o?r.path.replace(/\/?$/,"/")+i.path.replace(/^\/?/g,""):r.path+i.path:i.path;var l=n(r.query),u=n(i.query);l&&u?s+="?"+r.query+"&"+i.query:l&&!u?s+="?"+r.query:!l&&u&&(s+="?"+i.query);var c=n(i.fragment);return n(r.fragment)&&!c?s+="#"+r.fragment:c&&(s+="#"+i.fragment),s}}),o("Core/buildModuleUrl",["../ThirdParty/Uri","./defined","./DeveloperError","./getAbsoluteUri","./joinUrls","require"],function(e,t,n,r,i,o){"use strict";function a(e){return o.toUrl("../"+e)}function s(n){return i(t(u)?u:(o="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:function(){for(var e=document.getElementsByTagName("script"),t=0,n=e.length;t<n;++t){var r=e[t].getAttribute("src"),i=d.exec(r);if(null!==i)return i[1]}}(),u=new e(r(o))),n);var o}function l(e){t(c)||(c=t(o.toUrl)?a:s),t(h)||(h=document.createElement("a"));var n=c(e);return h.href=n,h.href=h.href,h.href}var u,c,h,d=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;return l._cesiumScriptRegex=d,l.setBaseUrl=function(t){u=new e(t).resolve(new e(document.location.href))},l}),o("Core/Iau2006XysSample",[],function(){"use strict";return function(e,t,n){this.x=e,this.y=t,this.s=n}}),o("Core/Iau2006XysData",["../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./Iau2006XysSample","./JulianDate","./loadJson","./TimeStandard"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){e=n(e,n.EMPTY_OBJECT),this._xysFileUrlTemplate=e.xysFileUrlTemplate,this._interpolationOrder=n(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=n(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new o(this._sampleZeroJulianEphemerisDate,0,s.TAI),this._stepSizeDays=n(e.stepSizeDays,1),this._samplesPerXysFile=n(e.samplesPerXysFile,1e3),this._totalSamples=n(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,r=this._denominators=new Array(t+1),i=this._xTable=new Array(t+1),a=Math.pow(this._stepSizeDays,t),l=0;l<=t;++l){r[l]=a,i[l]=l*this._stepSizeDays;for(var u=0;u<=t;++u)u!==l&&(r[l]*=l-u);r[l]=1/r[l]}this._work=new Array(t+1),this._coef=new Array(t+1)}function u(e,t,n){var r=h;return r.dayNumber=t,r.secondsOfDay=n,o.daysDifference(r,e._sampleZeroDateTT)}function c(n,i){if(n._chunkDownloadsInProgress[i])return n._chunkDownloadsInProgress[i];var o=e.defer();n._chunkDownloadsInProgress[i]=o;var s,l=n._xysFileUrlTemplate;return s=r(l)?l.replace("{0}",i):t("Assets/IAU2006_XYS/IAU2006_XYS_"+i+".json"),e(a(s),function(e){n._chunkDownloadsInProgress[i]=!1;for(var t=n._samples,r=e.samples,a=i*n._samplesPerXysFile*3,s=0,l=r.length;s<l;++s)t[a+s]=r[s];o.resolve()}),o.promise}var h=new o(0,0,s.TAI);return l.prototype.preload=function(t,n,r,i){var o=u(this,t,n),a=u(this,r,i),s=o/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var l=a/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;l>=this._totalSamples&&(l=this._totalSamples-1);for(var h=l/this._samplesPerXysFile|0,d=[],p=s/this._samplesPerXysFile|0;p<=h;++p)d.push(c(this,p));return e.all(d)},l.prototype.computeXysRadians=function(e,t,n){var o=u(this,e,t);if(!(o<0)){var a=o/this._stepSizeDays|0;if(!(a>=this._totalSamples)){var s=this._interpolationOrder,l=a-(s/2|0);l<0&&(l=0);var h=l+s;h>=this._totalSamples&&(l=(h=this._totalSamples-1)-s)<0&&(l=0);var d=!1,p=this._samples;if(r(p[3*l])||(c(this,l/this._samplesPerXysFile|0),d=!0),r(p[3*h])||(c(this,h/this._samplesPerXysFile|0),d=!0),!d){r(n)?(n.x=0,n.y=0,n.s=0):n=new i(0,0,0);var f,m,_=o-l*this._stepSizeDays,g=this._work,v=this._denominators,y=this._coef,C=this._xTable;for(f=0;f<=s;++f)g[f]=_-C[f];for(f=0;f<=s;++f){for(y[f]=1,m=0;m<=s;++m)m!==f&&(y[f]*=g[m]);y[f]*=v[f];var w=3*(l+f);n.x+=y[f]*p[w++],n.y+=y[f]*p[w++],n.s+=y[f]*p[w]}return n}}}},l}),o("Core/Fullscreen",["./defined","./defineProperties"],function(e,t){"use strict";var n,r={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},i={};return t(i,{element:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenElement]}},changeEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenchange}},errorEventName:{get:function(){if(i.supportsFullscreen())return r.fullscreenerror}},enabled:{get:function(){if(i.supportsFullscreen())return document[r.fullscreenEnabled]}},fullscreen:{get:function(){if(i.supportsFullscreen())return null!==i.element}}}),i.supportsFullscreen=function(){if(e(n))return n;n=!1;var t=document.body;if("function"==typeof t.requestFullscreen)return r.requestFullscreen="requestFullscreen",r.exitFullscreen="exitFullscreen",r.fullscreenEnabled="fullscreenEnabled",r.fullscreenElement="fullscreenElement",r.fullscreenchange="fullscreenchange",r.fullscreenerror="fullscreenerror",n=!0;for(var i,o=["webkit","moz","o","ms","khtml"],a=0,s=o.length;a<s;++a){var l=o[a];"function"==typeof t[i=l+"RequestFullscreen"]?(r.requestFullscreen=i,n=!0):"function"==typeof t[i=l+"RequestFullScreen"]&&(r.requestFullscreen=i,n=!0),i=l+"ExitFullscreen","function"==typeof document[i]?r.exitFullscreen=i:(i=l+"CancelFullScreen","function"==typeof document[i]&&(r.exitFullscreen=i)),i=l+"FullscreenEnabled",void 0!==document[i]?r.fullscreenEnabled=i:(i=l+"FullScreenEnabled",void 0!==document[i]&&(r.fullscreenEnabled=i)),i=l+"FullscreenElement",void 0!==document[i]?r.fullscreenElement=i:(i=l+"FullScreenElement",void 0!==document[i]&&(r.fullscreenElement=i)),i=l+"fullscreenchange",void 0!==document["on"+i]&&("ms"===l&&(i="MSFullscreenChange"),r.fullscreenchange=i),i=l+"fullscreenerror",void 0!==document["on"+i]&&("ms"===l&&(i="MSFullscreenError"),r.fullscreenerror=i)}return n},i.requestFullscreen=function(e,t){i.supportsFullscreen()&&e[r.requestFullscreen]({vrDisplay:t})},i.exitFullscreen=function(){i.supportsFullscreen()&&document[r.exitFullscreen]()},i}),o("Core/FeatureDetection",["./defaultValue","./defined","./Fullscreen"],function(e,t,n){"use strict";function r(e){for(var t=e.split("."),n=0,r=t.length;n<r;++n)t[n]=parseInt(t[n],10);return t}function i(){if(!t(h)){h=!1;var e=/ Chrome\/([\.0-9]+)/.exec(c.userAgent);null!==e&&(h=!0,d=r(e[1]))}return h}function o(){if(!t(p)&&(p=!1,!i()&&/ Safari\/[\.0-9]+/.test(c.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(c.userAgent);null!==e&&(p=!0,f=r(e[1]))}return p}function a(){if(!t(m)){m=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(c.userAgent);null!==e&&(m=!0,(_=r(e[1])).isNightly=!!e[2])}return m}function s(){var e;return t(g)||(g=!1,"Microsoft Internet Explorer"===c.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(c.userAgent))&&(g=!0,v=r(e[1])):"Netscape"===c.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(c.userAgent))&&(g=!0,v=r(e[1]))),g}function l(){if(!t(y)){y=!1;var e=/Firefox\/([\.0-9]+)/.exec(c.userAgent);null!==e&&(y=!0,C=r(e[1]))}return y}function u(){if(!t(S)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var n=e.style.imageRendering;(S=t(n)&&""!==n)&&(E=n)}return S}var c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x={isChrome:i,chromeVersion:function(){return i()&&d},isSafari:o,safariVersion:function(){return o()&&f},isWebkit:a,webkitVersion:function(){return a()&&_},isInternetExplorer:s,internetExplorerVersion:function(){return s()&&v},isFirefox:l,firefoxVersion:function(){return l()&&C},isWindows:function(){return t(w)||(w=/Windows/i.test(c.appVersion)),w},hardwareConcurrency:e((c="undefined"!=typeof navigator?navigator:{}).hardwareConcurrency,3),supportsPointerEvents:function(){return t(b)||(b="undefined"!=typeof PointerEvent&&(!t(c.pointerEnabled)||c.pointerEnabled)),b},supportsImageRenderingPixelated:u,imageRenderingValue:function(){return u()?E:void 0}};return x.supportsFullscreen=function(){return n.supportsFullscreen()},x.supportsTypedArrays=function(){return"undefined"!=typeof ArrayBuffer},x.supportsWebWorkers=function(){return"undefined"!=typeof Worker},x}),o("Core/Quaternion",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./Math","./Matrix3"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,n,r,i){this.x=t(e,0),this.y=t(n,0),this.z=t(r,0),this.w=t(i,0)}var u=new e;l.fromAxisAngle=function(t,r,i){var o=r/2,a=Math.sin(o),s=(u=e.normalize(t,u)).x*a,c=u.y*a,h=u.z*a,d=Math.cos(o);return n(i)?(i.x=s,i.y=c,i.z=h,i.w=d,i):new l(s,c,h,d)};var c=[1,2,0],h=new Array(3);l.fromRotationMatrix=function(e,t){var r,i,o,a,u,d=e[s.COLUMN0ROW0],p=e[s.COLUMN1ROW1],f=e[s.COLUMN2ROW2],m=d+p+f;if(m>0)r=Math.sqrt(m+1),u=.5*r,r=.5/r,i=(e[s.COLUMN1ROW2]-e[s.COLUMN2ROW1])*r,o=(e[s.COLUMN2ROW0]-e[s.COLUMN0ROW2])*r,a=(e[s.COLUMN0ROW1]-e[s.COLUMN1ROW0])*r;else{var _=0;p>d&&(_=1),f>d&&f>p&&(_=2);var g=c[_],v=c[g];r=Math.sqrt(e[s.getElementIndex(_,_)]-e[s.getElementIndex(g,g)]-e[s.getElementIndex(v,v)]+1);var y=h;y[_]=.5*r,r=.5/r,u=(e[s.getElementIndex(v,g)]-e[s.getElementIndex(g,v)])*r,y[g]=(e[s.getElementIndex(g,_)]+e[s.getElementIndex(_,g)])*r,y[v]=(e[s.getElementIndex(v,_)]+e[s.getElementIndex(_,v)])*r,i=-y[0],o=-y[1],a=-y[2]}return n(t)?(t.x=i,t.y=o,t.z=a,t.w=u,t):new l(i,o,a,u)};var d=new l;l.fromHeadingPitchRoll=function(t,n,r,i){var o=l.fromAxisAngle(e.UNIT_X,r,d),a=l.fromAxisAngle(e.UNIT_Y,-n,i);i=l.multiply(a,o,a);var s=l.fromAxisAngle(e.UNIT_Z,-t,d);return l.multiply(s,i,i)};var p=new e,f=new e,m=new l,_=new l,g=new l;l.packedLength=4,l.pack=function(e,n,r){return r=t(r,0),n[r++]=e.x,n[r++]=e.y,n[r++]=e.z,n[r]=e.w,n},l.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new l),i.x=e[r],i.y=e[r+1],i.z=e[r+2],i.w=e[r+3],i},l.packedInterpolationLength=3,l.convertPackedArrayForInterpolation=function(e,t,n,r){l.unpack(e,4*n,g),l.conjugate(g,g);for(var i=0,o=n-t+1;i<o;i++){var a=3*i;l.unpack(e,4*(t+i),m),l.multiply(m,g,m),m.w<0&&l.negate(m,m),l.computeAxis(m,p);var s=l.computeAngle(m);r[a]=p.x*s,r[a+1]=p.y*s,r[a+2]=p.z*s}},l.unpackInterpolationResult=function(t,r,i,o,a){n(a)||(a=new l),e.fromArray(t,0,f);var s=e.magnitude(f);return l.unpack(r,4*o,_),0===s?l.clone(l.IDENTITY,m):l.fromAxisAngle(f,s,m),l.multiply(m,_,a)},l.clone=function(e,t){if(n(e))return n(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new l(e.x,e.y,e.z,e.w)},l.conjugate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},l.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},l.magnitude=function(e){return Math.sqrt(l.magnitudeSquared(e))},l.normalize=function(e,t){var n=1/l.magnitude(e),r=e.y*n,i=e.z*n,o=e.w*n;return t.x=e.x*n,t.y=r,t.z=i,t.w=o,t},l.inverse=function(e,t){var n=l.magnitudeSquared(e);return t=l.conjugate(e,t),l.multiplyByScalar(t,1/n,t)},l.add=function(e,t,n){return n.x=e.x+t.x,n.y=e.y+t.y,n.z=e.z+t.z,n.w=e.w+t.w,n},l.subtract=function(e,t,n){return n.x=e.x-t.x,n.y=e.y-t.y,n.z=e.z-t.z,n.w=e.w-t.w,n},l.negate=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},l.dot=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},l.multiply=function(e,t,n){var r=e.x,i=e.y,o=e.z,a=e.w,s=t.x,l=t.y,u=t.z,c=t.w,h=a*l-r*u+i*c+o*s,d=a*u+r*l-i*s+o*c,p=a*c-r*s-i*l-o*u;return n.x=a*s+r*c+i*u-o*l,n.y=h,n.z=d,n.w=p,n},l.multiplyByScalar=function(e,t,n){return n.x=e.x*t,n.y=e.y*t,n.z=e.z*t,n.w=e.w*t,n},l.divideByScalar=function(e,t,n){return n.x=e.x/t,n.y=e.y/t,n.z=e.z/t,n.w=e.w/t,n},l.computeAxis=function(e,t){var n=e.w;if(Math.abs(n-1)<a.EPSILON6)return t.x=t.y=t.z=0,t;var r=1/Math.sqrt(1-n*n);return t.x=e.x*r,t.y=e.y*r,t.z=e.z*r,t},l.computeAngle=function(e){return Math.abs(e.w-1)<a.EPSILON6?0:2*Math.acos(e.w)};var v=new l;l.lerp=function(e,t,n,r){return v=l.multiplyByScalar(t,n,v),r=l.multiplyByScalar(e,1-n,r),l.add(v,r,r)};var y=new l,C=new l,w=new l;l.slerp=function(e,t,n,r){var i=l.dot(e,t),o=t;if(i<0&&(i=-i,o=y=l.negate(t,y)),1-i<a.EPSILON6)return l.lerp(e,o,n,r);var s=Math.acos(i);return C=l.multiplyByScalar(e,Math.sin((1-n)*s),C),w=l.multiplyByScalar(o,Math.sin(n*s),w),r=l.add(C,w,r),l.multiplyByScalar(r,1/Math.sin(s),r)},l.log=function(t,n){var r=a.acosClamped(t.w),i=0;return 0!==r&&(i=r/Math.sin(r)),e.multiplyByScalar(t,i,n)},l.exp=function(t,n){var r=e.magnitude(t),i=0;return 0!==r&&(i=Math.sin(r)/r),n.x=t.x*i,n.y=t.y*i,n.z=t.z*i,n.w=Math.cos(r),n};var b=new e,E=new e,S=new l,x=new l;l.computeInnerQuadrangle=function(t,n,r,i){var o=l.conjugate(n,S);l.multiply(o,r,x);var a=l.log(x,b);l.multiply(o,t,x);var s=l.log(x,E);return e.add(a,s,a),e.multiplyByScalar(a,.25,a),e.negate(a,a),l.exp(a,S),l.multiply(n,S,i)},l.squad=function(e,t,n,r,i,o){var a=l.slerp(e,t,i,S),s=l.slerp(n,r,i,x);return l.slerp(a,s,2*i*(1-i),o)};for(var T=new l,A=i.supportsTypedArrays()?new Float32Array(8):[],P=i.supportsTypedArrays()?new Float32Array(8):[],D=i.supportsTypedArrays()?new Float32Array(8):[],M=i.supportsTypedArrays()?new Float32Array(8):[],I=0;I<7;++I){var O=I+1,R=2*O+1;A[I]=1/(O*R),P[I]=O/R}return A[7]=.013978731275862502,P[7]=.8946388016552002,l.fastSlerp=function(e,t,n,r){var i,o=l.dot(e,t);o>=0?i=1:(i=-1,o=-o);for(var a=o-1,s=1-n,u=n*n,c=s*s,h=7;h>=0;--h)D[h]=(A[h]*u-P[h])*a,M[h]=(A[h]*c-P[h])*a;var d=i*n*(1+D[0]*(1+D[1]*(1+D[2]*(1+D[3]*(1+D[4]*(1+D[5]*(1+D[6]*(1+D[7])))))))),p=l.multiplyByScalar(e,s*(1+M[0]*(1+M[1]*(1+M[2]*(1+M[3]*(1+M[4]*(1+M[5]*(1+M[6]*(1+M[7])))))))),T);return l.multiplyByScalar(t,d,r),l.add(p,r,r)},l.fastSquad=function(e,t,n,r,i,o){var a=l.fastSlerp(e,t,i,S),s=l.fastSlerp(n,r,i,x);return l.fastSlerp(a,s,2*i*(1-i),o)},l.equals=function(e,t){return e===t||n(e)&&n(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},l.equalsEpsilon=function(e,t,r){return e===t||n(e)&&n(t)&&Math.abs(e.x-t.x)<=r&&Math.abs(e.y-t.y)<=r&&Math.abs(e.z-t.z)<=r&&Math.abs(e.w-t.w)<=r},l.ZERO=o(new l(0,0,0,0)),l.IDENTITY=o(new l(0,0,0,1)),l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l.prototype.equalsEpsilon=function(e,t){return l.equalsEpsilon(this,e,t)},l.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},l}),o("Core/Transforms",["../ThirdParty/when","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./defaultValue","./defined","./deprecationWarning","./DeveloperError","./EarthOrientationParameters","./EarthOrientationParametersSample","./Ellipsoid","./HeadingPitchRoll","./Iau2006XysData","./Iau2006XysSample","./JulianDate","./Math","./Matrix3","./Matrix4","./Quaternion","./TimeConstants"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C){"use strict";var w={},b=new n,E=new n,S=new n;w.eastNorthUpToFixedFrame=function(e,t,r){if(_.equalsEpsilon(e.x,0,_.EPSILON14)&&_.equalsEpsilon(e.y,0,_.EPSILON14)){var i=_.sign(e.z);return a(r)?(r[0]=0,r[1]=1,r[2]=0,r[3]=0,r[4]=-i,r[5]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=i,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(0,-i,0,e.x,1,0,0,e.y,0,0,i,e.z,0,0,0,1)}var s=b,l=E,u=S;return(t=o(t,h.WGS84)).geodeticSurfaceNormal(e,s),l.x=-e.y,l.y=e.x,l.z=0,n.normalize(l,l),n.cross(s,l,u),a(r)?(r[0]=l.x,r[1]=l.y,r[2]=l.z,r[3]=0,r[4]=u.x,r[5]=u.y,r[6]=u.z,r[7]=0,r[8]=s.x,r[9]=s.y,r[10]=s.z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(l.x,u.x,s.x,e.x,l.y,u.y,s.y,e.y,l.z,u.z,s.z,e.z,0,0,0,1)};var x=new n,T=new n,A=new n;w.northEastDownToFixedFrame=function(e,t,r){if(_.equalsEpsilon(e.x,0,_.EPSILON14)&&_.equalsEpsilon(e.y,0,_.EPSILON14)){var i=_.sign(e.z);return a(r)?(r[0]=-i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=-i,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(-i,0,0,e.x,0,1,0,e.y,0,0,-i,e.z,0,0,0,1)}var s=x,l=T,u=A;return(t=o(t,h.WGS84)).geodeticSurfaceNormal(e,s),l.x=-e.y,l.y=e.x,l.z=0,n.normalize(l,l),n.cross(s,l,u),a(r)?(r[0]=u.x,r[1]=u.y,r[2]=u.z,r[3]=0,r[4]=l.x,r[5]=l.y,r[6]=l.z,r[7]=0,r[8]=-s.x,r[9]=-s.y,r[10]=-s.z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(u.x,l.x,-s.x,e.x,u.y,l.y,-s.y,e.y,u.z,l.z,-s.z,e.z,0,0,0,1)},w.northUpEastToFixedFrame=function(e,t,r){if(_.equalsEpsilon(e.x,0,_.EPSILON14)&&_.equalsEpsilon(e.y,0,_.EPSILON14)){var i=_.sign(e.z);return a(r)?(r[0]=-i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=i,r[7]=0,r[8]=0,r[9]=1,r[10]=0,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(-i,0,0,e.x,0,0,1,e.y,0,i,0,e.z,0,0,0,1)}var s=b,l=E,u=S;return(t=o(t,h.WGS84)).geodeticSurfaceNormal(e,s),l.x=-e.y,l.y=e.x,l.z=0,n.normalize(l,l),n.cross(s,l,u),a(r)?(r[0]=u.x,r[1]=u.y,r[2]=u.z,r[3]=0,r[4]=s.x,r[5]=s.y,r[6]=s.z,r[7]=0,r[8]=l.x,r[9]=l.y,r[10]=l.z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(u.x,s.x,l.x,e.x,u.y,s.y,l.y,e.y,u.z,s.z,l.z,e.z,0,0,0,1)},w.northWestUpToFixedFrame=function(e,t,r){if(_.equalsEpsilon(e.x,0,_.EPSILON14)&&_.equalsEpsilon(e.y,0,_.EPSILON14)){var i=_.sign(e.z);return a(r)?(r[0]=-i,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=i,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(-i,0,0,e.x,0,-1,0,e.y,0,0,i,e.z,0,0,0,1)}var s=b,l=E,u=S;return(t=o(t,h.WGS84)).geodeticSurfaceNormal(e,s),l.x=-e.y,l.y=e.x,l.z=0,n.normalize(l,l),n.cross(s,l,u),a(r)?(r[0]=u.x,r[1]=u.y,r[2]=u.z,r[3]=0,r[4]=-l.x,r[5]=-l.y,r[6]=-l.z,r[7]=0,r[8]=s.x,r[9]=s.y,r[10]=s.z,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,r):new v(u.x,-l.x,s.x,e.x,u.y,-l.y,s.y,e.y,u.z,-l.z,s.z,e.z,0,0,0,1)};var P=new y,D=new n(1,1,1),M=new v;w.headingPitchRollToFixedFrame=function(e,t,r,i,o,a){var l;"object"==typeof t?(o=r,a=i,l=t.heading,r=t.pitch,i=t.roll):(s("headingPitchRollToFixedFrame","headingPitchRollToFixedFrame with separate heading, pitch, and roll arguments was deprecated in 1.27.  It will be removed in 1.30.  Use a HeadingPitchRoll object."),l=t);var u=y.fromHeadingPitchRoll(l,r,i,P),c=v.fromTranslationQuaternionRotationScale(n.ZERO,u,D,M);return a=w.eastNorthUpToFixedFrame(e,o,a),v.multiply(a,c,a)};var I=new d,O=new v,R=new g;w.headingPitchRollQuaternion=function(e,t,n,r,i,o){var a;"object"==typeof t?(a=t,i=n,o=r):(s("headingPitchRollQuaternion","headingPitchRollQuaternion with separate heading, pitch, and roll arguments was deprecated in 1.27.  It will be removed in 1.30.  Use a HeadingPitchRoll object."),I.heading=t,I.pitch=n,I.roll=r,a=I);var l=w.headingPitchRollToFixedFrame(e,a,i,O),u=v.getRotation(l,R);return y.fromRotationMatrix(u,o)};var N=_.TWO_PI/86400,L=new m;w.computeTemeToPseudoFixedMatrix=function(e,t){var n,r=(L=m.addSeconds(e,-m.computeTaiMinusUtc(e),L)).dayNumber,i=L.secondsOfDay,o=r-2451545,s=(24110.54841+(n=i>=43200?(o+.5)/C.DAYS_PER_JULIAN_CENTURY:(o-.5)/C.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+n*(.093104+-62e-7*n)))*N%_.TWO_PI+(i+.5*C.SECONDS_PER_DAY)%C.SECONDS_PER_DAY*(72921158553e-15+1.1772758384668e-19*(r-2451545.5)),l=Math.cos(s),u=Math.sin(s);return a(t)?(t[0]=l,t[1]=-u,t[2]=0,t[3]=u,t[4]=l,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new g(l,u,0,-u,l,0,0,0,1)},w.iau2006XysData=new p,w.earthOrientationParameters=u.NONE,w.preloadIcrfFixed=function(t){var n=w.iau2006XysData.preload(t.start.dayNumber,t.start.secondsOfDay+32.184,t.stop.dayNumber,t.stop.secondsOfDay+32.184),r=w.earthOrientationParameters.getPromiseToLoad();return e.all([n,r])},w.computeIcrfToFixedMatrix=function(e,t){a(t)||(t=new g);var n=w.computeFixedToIcrfMatrix(e,t);if(a(n))return g.transpose(n,t)};var F=new f(0,0,0),B=new c(0,0,0,0,0,0),k=new g,V=new g;w.computeFixedToIcrfMatrix=function(e,t){a(t)||(t=new g);var n=w.earthOrientationParameters.compute(e,B);if(a(n)){var r=e.dayNumber,i=e.secondsOfDay+32.184,o=w.iau2006XysData.computeXysRadians(r,i,F);if(a(o)){var s=o.x+n.xPoleOffset,l=o.y+n.yPoleOffset,u=1/(1+Math.sqrt(1-s*s-l*l)),c=k;c[0]=1-u*s*s,c[3]=-u*s*l,c[6]=s,c[1]=-u*s*l,c[4]=1-u*l*l,c[7]=l,c[2]=-s,c[5]=-l,c[8]=1-u*(s*s+l*l);var h=g.fromRotationZ(-o.s,V),d=g.multiply(c,h,k),p=e.dayNumber,f=(e.secondsOfDay-m.computeTaiMinusUtc(e)+n.ut1MinusUtc)/C.SECONDS_PER_DAY,v=.779057273264+f+.00273781191135448*(p-2451545+f),y=g.fromRotationZ(v=v%1*_.TWO_PI,V),b=g.multiply(d,y,k),E=Math.cos(n.xPoleWander),S=Math.cos(n.yPoleWander),x=Math.sin(n.xPoleWander),T=Math.sin(n.yPoleWander),A=r-2451545+i/C.SECONDS_PER_DAY,P=-47e-6*(A/=36525)*_.RADIANS_PER_DEGREE/3600,D=Math.cos(P),M=Math.sin(P),I=V;return I[0]=E*D,I[1]=E*M,I[2]=x,I[3]=-S*M+T*x*D,I[4]=S*D+T*x*M,I[5]=-T*E,I[6]=-T*M-S*x*D,I[7]=T*D-S*x*M,I[8]=S*E,g.multiply(b,I,t)}}};var z=new r;w.pointToWindowCoordinates=function(e,t,n,r){return(r=w.pointToGLWindowCoordinates(e,t,n,r)).y=2*t[5]-r.y,r},w.pointToGLWindowCoordinates=function(e,n,i,o){a(o)||(o=new t);var s=z;return v.multiplyByVector(e,r.fromElements(i.x,i.y,i.z,1,s),s),r.multiplyByScalar(s,1/s.w,s),v.multiplyByVector(n,s,s),t.fromCartesian4(s,o)};var U=new n,G=new n,W=new n;w.rotationMatrixFromPositionVelocity=function(e,t,r,i){var s=o(r,h.WGS84).geodeticSurfaceNormal(e,U),l=n.cross(t,s,G);n.equalsEpsilon(l,n.ZERO,_.EPSILON6)&&(l=n.clone(n.UNIT_X,l));var u=n.cross(l,t,W);return n.cross(t,u,l),n.negate(l,l),a(i)||(i=new g),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=l.x,i[4]=l.y,i[5]=l.z,i[6]=u.x,i[7]=u.y,i[8]=u.z,i};var H=new i,j=new n,q=new n,Y=new r,X=new r,Z=new r,K=new r,Q=new r,J=new v,$=new v;return w.basisTo2D=function(e,t,i){var o=e.ellipsoid,a=v.getColumn(t,3,Y),s=o.cartesianToCartographic(a,H),l=w.eastNorthUpToFixedFrame(a,o,J),u=v.inverseTransformation(l,$),c=e.project(s,j),h=X;h.x=c.z,h.y=c.x,h.z=c.y,h.w=1;var d=v.getColumn(t,0,q),p=n.magnitude(d),f=v.multiplyByVector(u,d,Z);r.fromElements(f.z,f.x,f.y,0,f);var m=v.getColumn(t,1,q),_=n.magnitude(m),g=v.multiplyByVector(u,m,K);r.fromElements(g.z,g.x,g.y,0,g);var y=v.getColumn(t,2,q),C=n.magnitude(y),b=Q;return n.cross(f,g,b),n.normalize(b,b),n.cross(g,b,f),n.normalize(f,f),n.cross(b,f,g),n.normalize(g,g),n.multiplyByScalar(f,p,f),n.multiplyByScalar(g,_,g),n.multiplyByScalar(b,C,b),v.setColumn(i,0,f,i),v.setColumn(i,1,g,i),v.setColumn(i,2,b,i),v.setColumn(i,3,h,i),i},w}),o("Core/EllipsoidTangentPlane",["./AxisAlignedBoundingBox","./Cartesian2","./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./IntersectionTests","./Matrix3","./Matrix4","./Plane","./Ray","./Transforms"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e,t){e=(t=i(t,l.WGS84)).scaleToGeodeticSurface(e);var r=f.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=n.fromCartesian4(h.getColumn(r,0,_)),this._yAxis=n.fromCartesian4(h.getColumn(r,1,_));var o=n.fromCartesian4(h.getColumn(r,2,_));this._plane=d.fromPointNormal(e,o)}var _=new r;a(m.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var g=new e;m.fromPoints=function(t,n){return new m(e.fromPoints(t,g).center,n)};var v=new p,y=new n;m.prototype.projectPointOntoPlane=function(e,r){var i=v;i.origin=e,n.normalize(e,i.direction);var a=u.rayPlane(i,this._plane,y);if(o(a)||(n.negate(i.direction,i.direction),a=u.rayPlane(i,this._plane,y)),o(a)){var s=n.subtract(a,this._origin,a),l=n.dot(this._xAxis,s),c=n.dot(this._yAxis,s);return o(r)?(r.x=l,r.y=c,r):new t(l,c)}},m.prototype.projectPointsOntoPlane=function(e,t){o(t)||(t=[]);for(var n=0,r=e.length,i=0;i<r;i++){var a=this.projectPointOntoPlane(e[i],t[n]);o(a)&&(t[n]=a,n++)}return t.length=n,t},m.prototype.projectPointToNearestOnPlane=function(e,r){o(r)||(r=new t);var i=v;i.origin=e,n.clone(this._plane.normal,i.direction);var a=u.rayPlane(i,this._plane,y);o(a)||(n.negate(i.direction,i.direction),a=u.rayPlane(i,this._plane,y));var s=n.subtract(a,this._origin,a),l=n.dot(this._xAxis,s),c=n.dot(this._yAxis,s);return r.x=l,r.y=c,r},m.prototype.projectPointsToNearestOnPlane=function(e,t){o(t)||(t=[]);var n=e.length;t.length=n;for(var r=0;r<n;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};var C=new n;return m.prototype.projectPointsOntoEllipsoid=function(e,t){var r=e.length;o(t)?t.length=r:t=new Array(r);for(var i=this._ellipsoid,a=this._origin,s=this._xAxis,l=this._yAxis,u=C,c=0;c<r;++c){var h=e[c];n.multiplyByScalar(s,h.x,u),o(t[c])||(t[c]=new n);var d=n.add(a,u,t[c]);n.multiplyByScalar(l,h.y,u),n.add(d,u,d),i.scaleToGeocentricSurface(d,d)}return t},m}),o("Core/OrientedBoundingBox",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Intersect","./Interval","./Math","./Matrix3","./Plane","./Rectangle"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e,t){this.center=n.clone(i(e,n.ZERO)),this.halfAxes=d.clone(i(t,d.ZERO))}var _=new n,g=new n,v=new n,y=new n,C=new n,w=new n,b=new d,E={unitary:new d,diagonal:new d};m.fromPoints=function(e,t){if(o(t)||(t=new m),!o(e)||0===e.length)return t.halfAxes=d.ZERO,t.center=n.ZERO,t;var r,i=e.length,a=n.clone(e[0],_);for(r=1;r<i;r++)n.add(a,e[r],a);var s=1/i;n.multiplyByScalar(a,s,a);var l,u=0,c=0,h=0,p=0,f=0,S=0;for(r=0;r<i;r++)l=n.subtract(e[r],a,g),u+=l.x*l.x,c+=l.x*l.y,h+=l.x*l.z,p+=l.y*l.y,f+=l.y*l.z,S+=l.z*l.z;c*=s,h*=s,p*=s,f*=s,S*=s;var x=b;x[0]=u*=s,x[1]=c,x[2]=h,x[3]=c,x[4]=p,x[5]=f,x[6]=h,x[7]=f,x[8]=S;var T=d.computeEigenDecomposition(x,E),A=d.clone(T.unitary,t.halfAxes),P=d.getColumn(A,0,y),D=d.getColumn(A,1,C),M=d.getColumn(A,2,w),I=-Number.MAX_VALUE,O=-Number.MAX_VALUE,R=-Number.MAX_VALUE,N=Number.MAX_VALUE,L=Number.MAX_VALUE,F=Number.MAX_VALUE;for(r=0;r<i;r++)l=e[r],I=Math.max(n.dot(P,l),I),O=Math.max(n.dot(D,l),O),R=Math.max(n.dot(M,l),R),N=Math.min(n.dot(P,l),N),L=Math.min(n.dot(D,l),L),F=Math.min(n.dot(M,l),F);P=n.multiplyByScalar(P,.5*(N+I),P),D=n.multiplyByScalar(D,.5*(L+O),D),M=n.multiplyByScalar(M,.5*(F+R),M);var B=n.add(P,D,t.center);B=n.add(B,M,B);var k=v;return k.x=I-N,k.y=O-L,k.z=R-F,n.multiplyByScalar(k,.5,k),d.multiplyByScale(t.halfAxes,k,t.halfAxes),t};var S=new n,x=new n,T=new r,A=new n,P=[new r,new r,new r,new r,new r,new r,new r,new r],D=[new n,new n,new n,new n,new n,new n,new n,new n],M=[new t,new t,new t,new t,new t,new t,new t,new t];m.fromRectangle=function(e,t,r,a,u){t=i(t,0),r=i(r,0),a=i(a,s.WGS84);var c=f.center(e,T),h=a.cartographicToCartesian(c,A),_=new l(h,a),g=_.plane,v=P[0],y=P[1],C=P[2],w=P[3],b=P[4],E=P[5],I=P[6],O=P[7],R=c.longitude,N=e.south<0&&e.north>0?0:c.latitude;I.latitude=E.latitude=b.latitude=e.south,O.latitude=w.latitude=N,v.latitude=y.latitude=C.latitude=e.north,I.longitude=O.longitude=v.longitude=e.west,E.longitude=y.longitude=R,b.longitude=w.longitude=C.longitude=e.east,C.height=y.height=v.height=O.height=I.height=E.height=b.height=w.height=r,a.cartographicArrayToCartesianArray(P,D),_.projectPointsToNearestOnPlane(D,M);var L=Math.min(M[6].x,M[7].x,M[0].x),F=Math.max(M[2].x,M[3].x,M[4].x),B=Math.min(M[4].y,M[5].y,M[6].y),k=Math.max(M[0].y,M[1].y,M[2].y);return C.height=v.height=b.height=I.height=t,a.cartographicArrayToCartesianArray(P,D),function(e,t,r,i,a,s,l,u){o(u)||(u=new m);var c=u.halfAxes;d.setColumn(c,0,e.xAxis,c),d.setColumn(c,1,e.yAxis,c),d.setColumn(c,2,e.zAxis,c);var h=S;h.x=(t+r)/2,h.y=(i+a)/2,h.z=(s+l)/2;var p=x;p.x=(r-t)/2,p.y=(a-i)/2,p.z=(l-s)/2;var f=u.center;return h=d.multiplyByVector(c,h,h),n.add(e.origin,h,f),d.multiplyByScale(c,p,c),u}(_,L,F,B,k,Math.min(p.getPointDistance(g,D[0]),p.getPointDistance(g,D[2]),p.getPointDistance(g,D[4]),p.getPointDistance(g,D[6])),r,u)},m.clone=function(e,t){if(o(e))return o(t)?(n.clone(e.center,t.center),d.clone(e.halfAxes,t.halfAxes),t):new m(e.center,e.halfAxes)},m.intersectPlane=function(e,t){var r=e.center,i=t.normal,o=e.halfAxes,a=i.x,s=i.y,l=i.z,c=Math.abs(a*o[d.COLUMN0ROW0]+s*o[d.COLUMN0ROW1]+l*o[d.COLUMN0ROW2])+Math.abs(a*o[d.COLUMN1ROW0]+s*o[d.COLUMN1ROW1]+l*o[d.COLUMN1ROW2])+Math.abs(a*o[d.COLUMN2ROW0]+s*o[d.COLUMN2ROW1]+l*o[d.COLUMN2ROW2]),h=n.dot(i,r)+t.distance;return h<=-c?u.OUTSIDE:h>=c?u.INSIDE:u.INTERSECTING};var I=new n,O=new n,R=new n,N=new n;m.distanceSquaredTo=function(e,t){var r=n.subtract(t,e.center,S),i=e.halfAxes,o=d.getColumn(i,0,I),a=d.getColumn(i,1,O),s=d.getColumn(i,2,R),l=n.magnitude(o),u=n.magnitude(a),c=n.magnitude(s);n.normalize(o,o),n.normalize(a,a),n.normalize(s,s);var h=N;h.x=n.dot(r,o),h.y=n.dot(r,a),h.z=n.dot(r,s);var p,f=0;return h.x<-l?f+=(p=h.x+l)*p:h.x>l&&(f+=(p=h.x-l)*p),h.y<-u?f+=(p=h.y+u)*p:h.y>u&&(f+=(p=h.y-u)*p),h.z<-c?f+=(p=h.z+c)*p:h.z>c&&(f+=(p=h.z-c)*p),f};var L=new n,F=new n;m.computePlaneDistances=function(e,t,r,i){o(i)||(i=new c);var a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,l=e.center,u=e.halfAxes,h=d.getColumn(u,0,I),p=d.getColumn(u,1,O),f=d.getColumn(u,2,R),m=n.add(h,p,L);n.add(m,f,m),n.add(m,l,m);var _=n.subtract(m,t,F),g=n.dot(r,_);return a=Math.min(g,a),s=Math.max(g,s),n.add(l,h,m),n.add(m,p,m),n.subtract(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.add(l,h,m),n.subtract(m,p,m),n.add(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.add(l,h,m),n.subtract(m,p,m),n.subtract(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.subtract(l,h,m),n.add(m,p,m),n.add(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.subtract(l,h,m),n.add(m,p,m),n.subtract(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.subtract(l,h,m),n.subtract(m,p,m),n.add(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),n.subtract(l,h,m),n.subtract(m,p,m),n.subtract(m,f,m),n.subtract(m,t,_),g=n.dot(r,_),a=Math.min(g,a),s=Math.max(g,s),i.start=a,i.stop=s,i};var B=new e;return m.isOccluded=function(t,n){var r=e.fromOrientedBoundingBox(t,B);return!n.isBoundingSphereVisible(r)},m.prototype.intersectPlane=function(e){return m.intersectPlane(this,e)},m.prototype.distanceSquaredTo=function(e){return m.distanceSquaredTo(this,e)},m.prototype.computePlaneDistances=function(e,t,n){return m.computePlaneDistances(this,e,t,n)},m.prototype.isOccluded=function(e){return m.isOccluded(this,e)},m.equals=function(e,t){return e===t||o(e)&&o(t)&&n.equals(e.center,t.center)&&d.equals(e.halfAxes,t.halfAxes)},m.prototype.clone=function(e){return m.clone(this,e)},m.prototype.equals=function(e){return m.equals(this,e)},m}),o("Core/AttributeCompression",["./Cartesian2","./Cartesian3","./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,n,r,i,o){"use strict";var a={};a.octEncodeInRange=function(e,t,n){if(n.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),n.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){var r=n.x,i=n.y;n.x=(1-Math.abs(i))*o.signNotZero(r),n.y=(1-Math.abs(r))*o.signNotZero(i)}return n.x=o.toSNorm(n.x,t),n.y=o.toSNorm(n.y,t),n},a.octEncode=function(e,t){return a.octEncodeInRange(e,255,t)},a.octDecodeInRange=function(e,n,r,i){if(i.x=o.fromSNorm(e,r),i.y=o.fromSNorm(n,r),i.z=1-(Math.abs(i.x)+Math.abs(i.y)),i.z<0){var a=i.x;i.x=(1-Math.abs(i.y))*o.signNotZero(a),i.y=(1-Math.abs(a))*o.signNotZero(i.y)}return t.normalize(i,i)},a.octDecode=function(e,t,n){return a.octDecodeInRange(e,t,255,n)},a.octPackFloat=function(e){return 256*e.x+e.y};var s=new e;return a.octEncodeFloat=function(e){return a.octEncode(e,s),a.octPackFloat(s)},a.octDecodeFloat=function(e,t){var n=e/256,r=Math.floor(n);return a.octDecode(r,256*(n-r),t)},a.octPack=function(e,t,n,r){var i=a.octEncodeFloat(e),o=a.octEncodeFloat(t),l=a.octEncode(n,s);return r.x=65536*l.x+i,r.y=65536*l.y+o,r},a.octUnpack=function(e,t,n,r){var i=e.x/65536,o=Math.floor(i),s=65536*(i-o);i=e.y/65536;var l=Math.floor(i),u=65536*(i-l);a.octDecodeFloat(s,t),a.octDecodeFloat(u,n),a.octDecode(o,l,r)},a.compressTextureCoordinates=function(e){return 4096*(4095*e.x|0)+(4095*e.y|0)},a.decompressTextureCoordinates=function(e,t){var n=Math.floor(e/4096);return t.x=n/4095,t.y=(e-4096*n)/4095,t},a}),o("Renderer/WebGLConstants",["../Core/freezeObject"],function(e){"use strict";return e({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503})}),o("Core/ComponentDatatype",["../Renderer/WebGLConstants","./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject"],function(e,t,n,r,i,o){"use strict";if(!i.supportsTypedArrays())return{};var a={BYTE:e.BYTE,UNSIGNED_BYTE:e.UNSIGNED_BYTE,SHORT:e.SHORT,UNSIGNED_SHORT:e.UNSIGNED_SHORT,INT:e.INT,UNSIGNED_INT:e.UNSIGNED_INT,FLOAT:e.FLOAT,DOUBLE:e.DOUBLE};return a.getSizeInBytes=function(e){switch(e){case a.BYTE:return Int8Array.BYTES_PER_ELEMENT;case a.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case a.SHORT:return Int16Array.BYTES_PER_ELEMENT;case a.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case a.INT:return Int32Array.BYTES_PER_ELEMENT;case a.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case a.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case a.DOUBLE:return Float64Array.BYTES_PER_ELEMENT}},a.fromTypedArray=function(e){return e instanceof Int8Array?a.BYTE:e instanceof Uint8Array?a.UNSIGNED_BYTE:e instanceof Int16Array?a.SHORT:e instanceof Uint16Array?a.UNSIGNED_SHORT:e instanceof Int32Array?a.INT:e instanceof Uint32Array?a.UNSIGNED_INT:e instanceof Float32Array?a.FLOAT:e instanceof Float64Array?a.DOUBLE:void 0},a.validate=function(e){return n(e)&&(e===a.BYTE||e===a.UNSIGNED_BYTE||e===a.SHORT||e===a.UNSIGNED_SHORT||e===a.INT||e===a.UNSIGNED_INT||e===a.FLOAT||e===a.DOUBLE)},a.createTypedArray=function(e,t){switch(e){case a.BYTE:return new Int8Array(t);case a.UNSIGNED_BYTE:return new Uint8Array(t);case a.SHORT:return new Int16Array(t);case a.UNSIGNED_SHORT:return new Uint16Array(t);case a.INT:return new Int32Array(t);case a.UNSIGNED_INT:return new Uint32Array(t);case a.FLOAT:return new Float32Array(t);case a.DOUBLE:return new Float64Array(t)}},a.createArrayBufferView=function(e,n,r,i){switch(r=t(r,0),i=t(i,(n.byteLength-r)/a.getSizeInBytes(e)),e){case a.BYTE:return new Int8Array(n,r,i);case a.UNSIGNED_BYTE:return new Uint8Array(n,r,i);case a.SHORT:return new Int16Array(n,r,i);case a.UNSIGNED_SHORT:return new Uint16Array(n,r,i);case a.INT:return new Int32Array(n,r,i);case a.UNSIGNED_INT:return new Uint32Array(n,r,i);case a.FLOAT:return new Float32Array(n,r,i);case a.DOUBLE:return new Float64Array(n,r,i)}},a.fromName=function(e){switch(e){case"BYTE":return a.BYTE;case"UNSIGNED_BYTE":return a.UNSIGNED_BYTE;case"SHORT":return a.SHORT;case"UNSIGNED_SHORT":return a.UNSIGNED_SHORT;case"INT":return a.INT;case"UNSIGNED_INT":return a.UNSIGNED_INT;case"FLOAT":return a.FLOAT;case"DOUBLE":return a.DOUBLE}},o(a)}),o("Core/TerrainQuantization",["./freezeObject"],function(e){"use strict";return e({NONE:0,BITS12:1})}),o("Core/TerrainEncoding",["./AttributeCompression","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Math","./Matrix3","./Matrix4","./TerrainQuantization"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,t,r,a,s,c){var p,g,v,y;if(o(e)&&o(t)&&o(r)&&o(a)){var C=e.minimum,w=n.subtract(e.maximum,C,d),b=r-t;p=Math.max(n.maximumComponent(w),b)<_-1?u.BITS12:u.NONE,g=e.center,v=l.inverseTransformation(a,new l);var E=n.negate(C,h);l.multiply(l.fromTranslation(E,f),v,v);var S=h;S.x=1/w.x,S.y=1/w.y,S.z=1/w.z,l.multiply(l.fromScale(S,f),v,v),y=l.clone(a),l.setTranslation(y,n.ZERO,y),a=l.clone(a,new l);var x=l.fromTranslation(C,f),T=l.fromScale(w,m),A=l.multiply(x,T,f);l.multiply(a,A,a),l.multiply(y,A,y)}this.quantization=p,this.minimumHeight=t,this.maximumHeight=r,this.center=g,this.toScaledENU=v,this.fromScaledENU=a,this.matrix=y,this.hasVertexNormals=s,this.hasWebMercatorT=i(c,!1)}var h=new n,d=new n,p=new t,f=new l,m=new l,_=Math.pow(2,12);c.prototype.encode=function(r,i,o,s,c,d,f){var m=s.x,_=s.y;if(this.quantization===u.BITS12){(o=l.multiplyByPoint(this.toScaledENU,o,h)).x=a.clamp(o.x,0,1),o.y=a.clamp(o.y,0,1),o.z=a.clamp(o.z,0,1);var g=a.clamp((c-this.minimumHeight)/(this.maximumHeight-this.minimumHeight),0,1);t.fromElements(o.x,o.y,p);var v=e.compressTextureCoordinates(p);t.fromElements(o.z,g,p);var y=e.compressTextureCoordinates(p);t.fromElements(m,_,p);var C=e.compressTextureCoordinates(p);if(r[i++]=v,r[i++]=y,r[i++]=C,this.hasWebMercatorT){t.fromElements(f,0,p);var w=e.compressTextureCoordinates(p);r[i++]=w}}else n.subtract(o,this.center,h),r[i++]=h.x,r[i++]=h.y,r[i++]=h.z,r[i++]=c,r[i++]=m,r[i++]=_,this.hasWebMercatorT&&(r[i++]=f);return this.hasVertexNormals&&(r[i++]=e.octPackFloat(d)),i},c.prototype.decodePosition=function(t,r,i){if(o(i)||(i=new n),r*=this.getStride(),this.quantization===u.BITS12){var a=e.decompressTextureCoordinates(t[r],p);i.x=a.x,i.y=a.y;var s=e.decompressTextureCoordinates(t[r+1],p);return i.z=s.x,l.multiplyByPoint(this.fromScaledENU,i,i)}return i.x=t[r],i.y=t[r+1],i.z=t[r+2],n.add(i,this.center,i)},c.prototype.decodeTextureCoordinates=function(n,r,i){return o(i)||(i=new t),r*=this.getStride(),this.quantization===u.BITS12?e.decompressTextureCoordinates(n[r+2],i):t.fromElements(n[r+4],n[r+5],i)},c.prototype.decodeHeight=function(t,n){return n*=this.getStride(),this.quantization===u.BITS12?e.decompressTextureCoordinates(t[n+1],p).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:t[n+3]},c.prototype.getOctEncodedNormal=function(e,n,r){var i=e[n=(n+1)*this.getStride()-1]/256,o=Math.floor(i);return t.fromElements(o,256*(i-o),r)},c.prototype.getStride=function(){var e;switch(this.quantization){case u.BITS12:e=3;break;default:e=6}return this.hasWebMercatorT&&++e,this.hasVertexNormals&&++e,e};var g={position3DAndHeight:0,textureCoordAndEncodedNormals:1},v={compressed0:0,compressed1:1};return c.prototype.getAttributes=function(e){var t,n=r.FLOAT,i=r.getSizeInBytes(n);if(this.quantization===u.NONE){var o=2;return this.hasWebMercatorT&&++o,this.hasVertexNormals&&++o,[{index:g.position3DAndHeight,vertexBuffer:e,componentDatatype:n,componentsPerAttribute:4,offsetInBytes:0,strideInBytes:t=(4+o)*i},{index:g.textureCoordAndEncodedNormals,vertexBuffer:e,componentDatatype:n,componentsPerAttribute:o,offsetInBytes:4*i,strideInBytes:t}]}var a=3,s=0;return(this.hasWebMercatorT||this.hasVertexNormals)&&++a,this.hasWebMercatorT&&this.hasVertexNormals?[{index:v.compressed0,vertexBuffer:e,componentDatatype:n,componentsPerAttribute:a,offsetInBytes:0,strideInBytes:t=(a+ ++s)*i},{index:v.compressed1,vertexBuffer:e,componentDatatype:n,componentsPerAttribute:s,offsetInBytes:a*i,strideInBytes:t}]:[{index:v.compressed0,vertexBuffer:e,componentDatatype:n,componentsPerAttribute:a}]},c.prototype.getAttributeLocations=function(){return this.quantization===u.NONE?g:v},c.clone=function(e,t){return o(t)||(t=new c),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=n.clone(e.center),t.toScaledENU=l.clone(e.toScaledENU),t.fromScaledENU=l.clone(e.fromScaledENU),t.matrix=l.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t},c}),o("Core/WebMercatorProjection",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){this._ellipsoid=n(e,a.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}return i(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),l.mercatorAngleToGeodeticLatitude=function(e){return s.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},l.geodeticLatitudeToMercatorAngle=function(e){e>l.MaximumLatitude?e=l.MaximumLatitude:e<-l.MaximumLatitude&&(e=-l.MaximumLatitude);var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},l.MaximumLatitude=l.mercatorAngleToGeodeticLatitude(Math.PI),l.prototype.project=function(t,n){var i=this._semimajorAxis,o=t.longitude*i,a=l.geodeticLatitudeToMercatorAngle(t.latitude)*i,s=t.height;return r(n)?(n.x=o,n.y=a,n.z=s,n):new e(o,a,s)},l.prototype.unproject=function(e,n){var i=this._oneOverSemimajorAxis,o=e.x*i,a=l.mercatorAngleToGeodeticLatitude(e.y*i),s=e.z;return r(n)?(n.longitude=o,n.latitude=a,n.height=s,n):new t(o,a,s)},l}),o("Core/HeightmapTessellator",["./AxisAlignedBoundingBox","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidalOccluder","./freezeObject","./Math","./Matrix4","./OrientedBoundingBox","./Rectangle","./TerrainEncoding","./Transforms","./WebMercatorProjection"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";var g={};g.DEFAULT_STRUCTURE=u({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var v=new r,y=new h,C=new r,w=new r;return g.computeVertices=function(a){var u,b,E,S,x=Math.cos,T=Math.sin,A=Math.sqrt,P=Math.atan,D=Math.exp,M=c.PI_OVER_TWO,I=c.toRadians,O=a.heightmap,R=a.width,N=a.height,L=a.skirtHeight,F=i(a.isGeographic,!0),B=i(a.ellipsoid,s.WGS84),k=1/B.maximumRadius,V=a.nativeRectangle,z=a.rectangle;o(z)?(u=z.west,b=z.south,E=z.east,S=z.north):F?(u=I(V.west),b=I(V.south),E=I(V.east),S=I(V.north)):(u=V.west*k,b=M-2*P(D(-V.south*k)),E=V.east*k,S=M-2*P(D(-V.north*k)));var U,G,W=i(a.relativeToCenter,r.ZERO),H=i(a.exaggeration,1),j=i(a.includeWebMercatorT,!1),q=i(a.structure,g.DEFAULT_STRUCTURE),Y=i(q.heightScale,g.DEFAULT_STRUCTURE.heightScale),X=i(q.heightOffset,g.DEFAULT_STRUCTURE.heightOffset),Z=i(q.elementsPerHeight,g.DEFAULT_STRUCTURE.elementsPerHeight),K=i(q.stride,g.DEFAULT_STRUCTURE.stride),Q=i(q.elementMultiplier,g.DEFAULT_STRUCTURE.elementMultiplier),J=i(q.isBigEndian,g.DEFAULT_STRUCTURE.isBigEndian),$=p.computeWidth(V)/(R-1),ee=p.computeHeight(V)/(N-1),te=B.radiiSquared,ne=te.x,re=te.y,ie=te.z,oe=65536,ae=-65536,se=m.eastNorthUpToFixedFrame(W,B),le=h.inverseTransformation(se,y);j&&(U=_.geodeticLatitudeToMercatorAngle(b),G=1/(_.geodeticLatitudeToMercatorAngle(S)-U));var ue=C;ue.x=Number.POSITIVE_INFINITY,ue.y=Number.POSITIVE_INFINITY,ue.z=Number.POSITIVE_INFINITY;var ce=w;ce.x=Number.NEGATIVE_INFINITY,ce.y=Number.NEGATIVE_INFINITY,ce.z=Number.NEGATIVE_INFINITY;var he=Number.POSITIVE_INFINITY,de=(R+(L>0?2:0))*(N+(L>0?2:0)),pe=new Array(de),fe=new Array(de),me=new Array(de),_e=j?new Array(de):[],ge=0,ve=N,ye=0,Ce=R;L>0&&(--ge,++ve,--ye,++Ce);for(var we=0,be=ge;be<ve;++be){var Ee=be;Ee<0&&(Ee=0),Ee>=N&&(Ee=N-1);var Se,xe=V.north-ee*Ee,Te=x(xe=F?I(xe):M-2*P(D(-xe*k))),Ae=T(xe),Pe=ie*Ae,De=(xe-b)/(S-b);De=c.clamp(De,0,1),j&&(Se=(_.geodeticLatitudeToMercatorAngle(xe)-U)*G);for(var Me=ye;Me<Ce;++Me){var Ie=Me;Ie<0&&(Ie=0),Ie>=R&&(Ie=R-1);var Oe=V.west+$*Ie;F?Oe=I(Oe):Oe*=k;var Re,Ne,Le=Ee*(R*K)+Ie*K;if(1===Z)Re=O[Le];else if(Re=0,J)for(Ne=0;Ne<Z;++Ne)Re=Re*Q+O[Le+Ne];else for(Ne=Z-1;Ne>=0;--Ne)Re=Re*Q+O[Le+Ne];Re=(Re*Y+X)*H,ae=Math.max(ae,Re),oe=Math.min(oe,Re),Me===Ie&&be===Ee||(Re-=L);var Fe=Te*x(Oe),Be=Te*T(Oe),ke=ne*Fe,Ve=re*Be,ze=1/A(ke*Fe+Ve*Be+Pe*Ae),Ue=ke*ze,Ge=Ve*ze,We=Pe*ze,He=new r;He.x=Ue+Fe*Re,He.y=Ge+Be*Re,He.z=We+Ae*Re,pe[we]=He,fe[we]=Re;var je=(Oe-u)/(E-u);je=c.clamp(je,0,1),me[we]=new n(je,De),j&&(_e[we]=Se),we++,h.multiplyByPoint(le,He,v),r.minimumByComponent(v,ue,ue),r.maximumByComponent(v,ce,ce),he=Math.min(he,Re)}}var qe,Ye=t.fromPoints(pe);o(z)&&z.width<c.PI_OVER_TWO+c.EPSILON5&&(qe=d.fromRectangle(z,oe,ae,B));var Xe,Ze=a.relativetoCenter;o(Ze)&&(Xe=new l(B).computeHorizonCullingPoint(Ze,pe));for(var Ke=new e(ue,ce,W),Qe=new f(Ke,he,ae,se,!1,j),Je=new Float32Array(de*Qe.getStride()),$e=0,et=0;et<de;++et)$e=Qe.encode(Je,$e,pe[et],me[et],fe[et],void 0,_e[et]);return{vertices:Je,maximumHeight:ae,minimumHeight:oe,encoding:Qe,boundingSphere3D:Ye,orientedBoundingBox:qe,occludeePointInScaledSpace:Xe}},g}),o("Core/destroyObject",["./defaultValue","./DeveloperError"],function(e,t){"use strict";function n(){return!0}return function(t,r){function i(){}r=e(r,"This object was destroyed, i.e., destroy() was called.");for(var o in t)"function"==typeof t[o]&&(t[o]=i);t.isDestroyed=n}}),o("Core/isCrossOriginUrl",["./defined"],function(e){"use strict";var t;return function(n){e(t)||(t=document.createElement("a")),t.href=window.location.href;var r=t.host,i=t.protocol;return t.href=n,t.href=t.href,i!==t.protocol||r!==t.host}}),o("Core/TaskProcessor",["../ThirdParty/Uri","../ThirdParty/when","./buildModuleUrl","./defaultValue","./defined","./destroyObject","./DeveloperError","./getAbsoluteUri","./isCrossOriginUrl","./RuntimeError","require"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e){var t=n(e);if(l(t)){var r,i='importScripts("'+t+'");';try{r=new Blob([i],{type:"application/javascript"})}catch(e){var o=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);o.append(i),r=o.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(r)}return t}function d(e,t){this._workerName=e,this._maximumActiveTasks=r(t,5),this._activeTasks=0,this._deferreds={},this._nextID=0}var p,f=[];return d.prototype.scheduleTask=function(e,o){if(i(this._worker)||(this._worker=function(e){var t=new Worker((i(p)||(p=h("Workers/cesiumWorkerBootstrapper.js")),p));t.postMessage=r(t.webkitPostMessage,t.postMessage);var o={loaderConfig:{},workerModule:d._workerModulePrefix+e._workerName};return i(d._loaderConfig)?o.loaderConfig=d._loaderConfig:i(c.toUrl)?o.loaderConfig.baseUrl=s("..",n("Workers/cesiumWorkerBootstrapper.js")):o.loaderConfig.paths={Workers:n("Workers")},t.postMessage(o),t.onmessage=function(t){!function(e,t){--e._activeTasks;var n=t.id;if(i(n)){var r=e._deferreds,o=r[n];if(i(t.error)){var s=t.error;"RuntimeError"===s.name?(s=new u(t.error.message)).stack=t.error.stack:"DeveloperError"===s.name&&((s=new a(t.error.message)).stack=t.error.stack),o.reject(s)}else o.resolve(t.result);delete r[n]}}(e,t.data)},t}(this)),!(this._activeTasks>=this._maximumActiveTasks)){++this._activeTasks;var l=this;return t(function(){if(!i(d._canTransferArrayBuffer)){var e=new Worker(h("Workers/transferTypedArrayTest.js"));e.postMessage=r(e.webkitPostMessage,e.postMessage);var n=new Int8Array([99]);try{e.postMessage({array:n},[n.buffer])}catch(e){return d._canTransferArrayBuffer=!1}var o=t.defer();e.onmessage=function(t){var n=t.data.array,r=i(n)&&99===n[0];o.resolve(r),e.terminate(),d._canTransferArrayBuffer=r},d._canTransferArrayBuffer=o.promise}return d._canTransferArrayBuffer}(),function(n){i(o)?n||(o.length=0):o=f;var r=l._nextID++,a=t.defer();return l._deferreds[r]=a,l._worker.postMessage({id:r,parameters:e,canTransferArrayBuffer:n},o),a.promise})}},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){return i(this._worker)&&this._worker.terminate(),o(this)},d._workerModulePrefix=d._defaultWorkerModulePrefix="Workers/",d._loaderConfig=void 0,d._canTransferArrayBuffer=void 0,d}),o("Core/TerrainMesh",["../Core/defaultValue"],function(e){"use strict";return function(t,n,r,i,o,a,s,l,u,c,h){this.center=t,this.vertices=n,this.stride=e(l,6),this.indices=r,this.minimumHeight=i,this.maximumHeight=o,this.boundingSphere3D=a,this.occludeePointInScaledSpace=s,this.orientedBoundingBox=u,this.encoding=c,this.exaggeration=h}}),o("Core/TerrainProvider",["./defined","./defineProperties","./DeveloperError","./Math"],function(e,t,n,r){"use strict";function i(){n.throwInstantiationError()}t(i.prototype,{errorEvent:{get:n.throwInstantiationError},credit:{get:n.throwInstantiationError},tilingScheme:{get:n.throwInstantiationError},ready:{get:n.throwInstantiationError},readyPromise:{get:n.throwInstantiationError},hasWaterMask:{get:n.throwInstantiationError},hasVertexNormals:{get:n.throwInstantiationError}});var o=[];return i.getRegularGridIndices=function(t,n){var r=o[t];e(r)||(o[t]=r=[]);var i=r[n];if(!e(i)){i=r[n]=new Uint16Array((t-1)*(n-1)*6);for(var a=0,s=0,l=0;l<n-1;++l){for(var u=0;u<t-1;++u){var c=a+t,h=c+1,d=a+1;i[s++]=a,i[s++]=c,i[s++]=d,i[s++]=d,i[s++]=c,i[s++]=h,++a}++a}}return i},i.heightmapTerrainQuality=.25,i.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,n){return 2*e.maximumRadius*Math.PI*i.heightmapTerrainQuality/(t*n)},i.prototype.requestTileGeometry=n.throwInstantiationError,i.prototype.getLevelMaximumGeometricError=n.throwInstantiationError,i.prototype.getTileDataAvailable=n.throwInstantiationError,i}),o("Core/HeightmapTerrainData",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./DeveloperError","./GeographicTilingScheme","./HeightmapTessellator","./Math","./Rectangle","./TaskProcessor","./TerrainEncoding","./TerrainMesh","./TerrainProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(e){this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=t(e.childTileMask,15);var r=a.DEFAULT_STRUCTURE,i=e.structure;n(i)?i!==r&&(i.heightScale=t(i.heightScale,r.heightScale),i.heightOffset=t(i.heightOffset,r.heightOffset),i.elementsPerHeight=t(i.elementsPerHeight,r.elementsPerHeight),i.stride=t(i.stride,r.stride),i.elementMultiplier=t(i.elementMultiplier,r.elementMultiplier),i.isBigEndian=t(i.isBigEndian,r.isBigEndian)):i=r,this._structure=i,this._createdByUpsampling=t(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0}function f(e,t,n,r,i,o,a,s,l,u,c){var h=(l-o.west)*(a-1)/(o.east-o.west),d=(u-o.south)*(s-1)/(o.north-o.south);i>0&&(h+=1,d+=1,a+=2,s+=2);var p=0|h,f=p+1;f>=(i>0?a-1:a)&&(f=a-1,p=a-2);var _=0|d,g=_+1;return g>=(i>0?s-1:s)&&(g=s-1,_=s-2),g=s-1-g,m(h-p,d-_,(t.decodeHeight(e,(_=s-1-_)*a+p)/c-n)/r,(t.decodeHeight(e,_*a+f)/c-n)/r,(t.decodeHeight(e,g*a+p)/c-n)/r,(t.decodeHeight(e,g*a+f)/c-n)/r)}function m(e,t,n,r,i,o){return t<e?n+e*(r-n)+t*(o-r):n+e*(o-i)+t*(i-n)}function _(e,t,n,r,i,o){o*=r;var a,s=0;if(i)for(a=0;a<t;++a)s=s*n+e[o+a];else for(a=t-1;a>=0;--a)s=s*n+e[o+a];return s}function g(e,t,n,r,i,o,a,s){var l;if(a*=i,o)for(l=0;l<t-1;++l)e[a+l]=s/r|0,s-=e[a+l]*r,r/=n;else for(l=t-1;l>0;--l)e[a+l]=s/r|0,s-=e[a+l]*r,r/=n;e[a+l]=s}r(p.prototype,{waterMask:{get:function(){return this._waterMask}}});var v=new u("createVerticesFromHeightmap");return p.prototype.createMesh=function(r,i,a,s,u){var p=r.ellipsoid,f=r.tileXYToNativeRectangle(i,a,s),m=r.tileXYToRectangle(i,a,s);u=t(u,1);var _=p.cartographicToCartesian(l.center(m)),g=this._structure,y=d.getEstimatedLevelZeroGeometricErrorForAHeightmap(p,this._width,r.getNumberOfXTilesAtLevel(0));this._skirtHeight=Math.min(y/(1<<s)*4,1e3);var C=v.scheduleTask({heightmap:this._buffer,structure:g,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:f,rectangle:m,relativeToCenter:_,ellipsoid:p,skirtHeight:this._skirtHeight,isGeographic:r instanceof o,exaggeration:u});if(n(C)){var w=this;return e(C,function(e){return w._mesh=new h(_,new Float32Array(e.vertices),d.getRegularGridIndices(e.gridWidth,e.gridHeight),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,c.clone(e.encoding),u),w._buffer=void 0,w._mesh})}},p.prototype.interpolateHeight=function(e,t,r){var i=this._width,o=this._height,a=this._structure,s=a.stride,l=a.elementsPerHeight,u=a.elementMultiplier,c=a.isBigEndian,h=a.heightOffset,d=a.heightScale;return n(this._mesh)?f(this._mesh.vertices,this._mesh.encoding,h,d,this._skirtHeight,e,i,o,t,r,this._mesh.exaggeration):function(n,i,a,s,l,u,c,h,d,p){var f=(t-e.west)*(c-1)/(e.east-e.west),g=(r-e.south)*(o-1)/(e.north-e.south),v=0|f,y=v+1;y>=c&&(y=c-1,v=c-2);var C=0|g,w=C+1;return w>=o&&(w=o-1,C=o-2),w=o-1-w,m(f-v,g-C,_(n,i,a,s,l,(C=o-1-C)*c+v),_(n,i,a,s,l,C*c+y),_(n,i,a,s,l,w*c+v),_(n,i,a,s,l,w*c+y))}(this._buffer,l,u,s,c,0,i)*d+h},p.prototype.upsample=function(e,t,r,i,o,a,l){var u=this._width,c=this._height,h=this._structure,d=this._skirtHeight,m=h.stride,_=new this._bufferType(u*c*m),v=this._mesh;if(n(v)){for(var y=v.vertices,C=v.encoding,w=e.tileXYToRectangle(t,r,i),b=e.tileXYToRectangle(o,a,l),E=h.heightOffset,S=h.heightScale,x=v.exaggeration,T=h.elementsPerHeight,A=h.elementMultiplier,P=h.isBigEndian,D=Math.pow(A,T-1),M=0;M<c;++M)for(var I=s.lerp(b.north,b.south,M/(c-1)),O=0;O<u;++O){var R=f(y,C,E,S,d,w,u,c,s.lerp(b.west,b.east,O/(u-1)),I,x);g(_,T,A,D,m,P,M*u+O,R=(R=R<h.lowestEncodedHeight?h.lowestEncodedHeight:R)>h.highestEncodedHeight?h.highestEncodedHeight:R)}return new p({buffer:_,width:u,height:c,childTileMask:0,structure:this._structure,createdByUpsampling:!0})}},p.prototype.isChildAvailable=function(e,t,n,r){var i=2;return n!==2*e&&++i,r!==2*t&&(i-=2),0!=(this._childTileMask&1<<i)},p.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling},p}),o("Core/loadImage",["../ThirdParty/when","./TrustedServers","./defaultValue","./defined","./DeveloperError","./isCrossOriginUrl"],function(e,t,n,r,i,o){"use strict";function a(t,r){return r=n(r,!0),e(t,function(t){var n;n=!(s.test(t)||!r)&&o(t);var i=e.defer();return a.createImage(t,n,i),i.promise})}var s=/^data:/;return a.defaultCreateImage=a.createImage=function(e,n,r){var i=new Image;i.onload=function(){r.resolve(i)},i.onerror=function(e){r.reject(e)},n&&(i.crossOrigin=t.contains(e)?"use-credentials":""),i.src=e},a}),o("Core/throttleRequestByServer",["../ThirdParty/Uri","../ThirdParty/when","./defaultValue"],function(e,t,n){"use strict";function r(a,s){var l=function(t){var n=new e(a).resolve(o);n.normalize();var r=n.authority;return/:/.test(r)||(r=r+":"+("https"===n.scheme?"443":"80")),r}(),u=n(i[l],0);if(!(u>=r.maximumRequestsPerServer))return i[l]=u+1,t(s(a),function(e){return i[l]--,e}).otherwise(function(e){return i[l]--,t.reject(e)})}var i={},o="undefined"!=typeof document?new e(document.location.href):new e;return r.maximumRequestsPerServer=6,r}),o("Core/ArcGisImageServerTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Event","./GeographicTilingScheme","./getImagePixels","./HeightmapTerrainData","./loadImage","./Math","./TerrainProvider","./throttleRequestByServer"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(i){this._url=i.url,this._token=i.token,this._tilingScheme=i.tilingScheme,r(this._tilingScheme)||(this._tilingScheme=new l({ellipsoid:n(i.ellipsoid,a.WGS84)})),this._heightmapWidth=65,this._levelZeroMaximumGeometricError=p.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._proxy=i.proxy,this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215},this._errorEvent=new s;var o=i.credit;"string"==typeof o&&(o=new t(o)),this._credit=o,this._readyPromise=e.resolve(!0)}return i(m.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),m.prototype.requestTileGeometry=function(t,n,i){var o=this._tilingScheme.tileXYToRectangle(t,n,i),a=(o.east-o.west)/(this._heightmapWidth-1),s=(o.north-o.south)/(this._heightmapWidth-1);o.west-=.5*a,o.east+=.5*a,o.south-=.5*s,o.north+=.5*s;var l=d.toDegrees(o.west)+"%2C"+d.toDegrees(o.south)+"%2C"+d.toDegrees(o.east)+"%2C"+d.toDegrees(o.north),p=this._url+"/exportImage?interpolation=RSP_BilinearInterpolation&format=tiff&f=image&size="+this._heightmapWidth+"%2C"+this._heightmapWidth+"&bboxSR=4326&imageSR=4326&bbox="+l;this._token&&(p+="&token="+this._token);var m=this._proxy;r(m)&&(p=m.getURL(p));var _=f(p,h);if(r(_)){var g=this;return e(_,function(e){return new c({buffer:u(e),width:g._heightmapWidth,height:g._heightmapWidth,childTileMask:15,structure:g._terrainDataStructure})})}},m.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},m.prototype.getTileDataAvailable=function(e,t,n){},m}),o("Core/arrayRemoveDuplicates",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";var i=r.EPSILON10;return function(n,r,o){if(t(n)){o=e(o,!1);var a,s,l,u=n.length;if(u<2)return n;for(a=1;a<u&&!r(s=n[a-1],l=n[a],i);++a);if(a===u)return o&&r(n[0],n[n.length-1],i)?n.slice(1):n;for(var c=n.slice(0,a);a<u;++a)l=n[a],r(s,l,i)||(c.push(l),s=l);return o&&c.length>1&&r(c[0],c[c.length-1],i)&&c.shift(),c}}}),o("Core/AssociativeArray",["./defined","./defineProperties","./DeveloperError"],function(e,t,n){"use strict";function r(){this._array=[],this._hash={}}return t(r.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}}),r.prototype.contains=function(t){return e(this._hash[t])},r.prototype.set=function(e,t){t!==this._hash[e]&&(this.remove(e),this._hash[e]=t,this._array.push(t))},r.prototype.get=function(e){return this._hash[e]},r.prototype.remove=function(t){var n=this._hash[t],r=e(n);if(r){var i=this._array;i.splice(i.indexOf(n),1),delete this._hash[t]}return r},r.prototype.removeAll=function(){var e=this._array;e.length>0&&(this._hash={},e.length=0)},r}),o("Core/barycentricCoordinates",["./Cartesian2","./Cartesian3","./defined","./DeveloperError"],function(e,t,n,r){"use strict";var i=new t,o=new t,a=new t;return function(r,s,l,u,c){var h,d,p,f,m,_,g,v;n(c)||(c=new t),n(s.z)?(h=t.subtract(l,s,i),d=t.subtract(u,s,o),p=t.subtract(r,s,a),f=t.dot(h,h),m=t.dot(h,d),_=t.dot(h,p),g=t.dot(d,d),v=t.dot(d,p)):(h=e.subtract(l,s,i),d=e.subtract(u,s,o),p=e.subtract(r,s,a),f=e.dot(h,h),m=e.dot(h,d),_=e.dot(h,p),g=e.dot(d,d),v=e.dot(d,p));var y=1/(f*g-m*m);return c.y=(g*_-m*v)*y,c.z=(f*v-m*_)*y,c.x=1-c.y-c.z,c}}),o("Core/BingMapsApi",["./Credit","./defined"],function(e,t){"use strict";var n={};n.defaultKey=void 0;var r,i=!1,o="This application is using Cesium's default Bing Maps key.  Please create a new key for the application as soon as possible and prior to deployment by visiting https://www.bingmapsportal.com/, and provide your key to Cesium by setting the Cesium.BingMapsApi.defaultKey property before constructing the CesiumWidget or any other object that uses the Bing Maps API.";return n.getKey=function(e){return t(e)?e:t(n.defaultKey)?n.defaultKey:(i||(console.log(o),i=!0),"AhiQlDaPOwKbStA_3nJIdimUj4PRYkp0yHwcNpvxVlLNPRo5ZJWY5oX_h6B_dMbm")},n.getErrorCredit=function(i){if(!t(i)&&!t(n.defaultKey))return t(r)||(r=new e(o)),r},n}),o("Core/BoundingRectangle",["./Cartesian2","./Cartographic","./defaultValue","./defined","./DeveloperError","./GeographicProjection","./Intersect","./Rectangle"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t,r,i){this.x=n(e,0),this.y=n(t,0),this.width=n(r,0),this.height=n(i,0)}l.packedLength=4,l.pack=function(e,t,r){return r=n(r,0),t[r++]=e.x,t[r++]=e.y,t[r++]=e.width,t[r]=e.height,t},l.unpack=function(e,t,i){return t=n(t,0),r(i)||(i=new l),i.x=e[t++],i.y=e[t++],i.width=e[t++],i.height=e[t],i},l.fromPoints=function(e,t){if(r(t)||(t=new l),!r(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var n=e.length,i=e[0].x,o=e[0].y,a=e[0].x,s=e[0].y,u=1;u<n;u++){var c=e[u],h=c.x,d=c.y;i=Math.min(h,i),a=Math.max(h,a),o=Math.min(d,o),s=Math.max(d,s)}return t.x=i,t.y=o,t.width=a-i,t.height=s-o,t};var u=new o,c=new t,h=new t;return l.fromRectangle=function(t,i,o){if(r(o)||(o=new l),!r(t))return o.x=0,o.y=0,o.width=0,o.height=0,o;var a=(i=n(i,u)).project(s.southwest(t,c)),d=i.project(s.northeast(t,h));return e.subtract(d,a,d),o.x=a.x,o.y=a.y,o.width=d.x,o.height=d.y,o},l.clone=function(e,t){if(r(e))return r(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new l(e.x,e.y,e.width,e.height)},l.union=function(e,t,n){r(n)||(n=new l);var i=Math.min(e.x,t.x),o=Math.min(e.y,t.y),a=Math.max(e.x+e.width,t.x+t.width),s=Math.max(e.y+e.height,t.y+t.height);return n.x=i,n.y=o,n.width=a-i,n.height=s-o,n},l.expand=function(e,t,n){n=l.clone(e,n);var r=t.x-n.x,i=t.y-n.y;return r>n.width?n.width=r:r<0&&(n.width-=r,n.x=t.x),i>n.height?n.height=i:i<0&&(n.height-=i,n.y=t.y),n},l.intersect=function(e,t){var n=e.x,r=e.y,i=t.x,o=t.y;return n>i+t.width||n+e.width<i||r+e.height<o||r>o+t.height?a.OUTSIDE:a.INTERSECTING},l.equals=function(e,t){return e===t||r(e)&&r(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},l.prototype.clone=function(e){return l.clone(this,e)},l.prototype.intersect=function(e){return l.intersect(this,e)},l.prototype.equals=function(e){return l.equals(this,e)},l}),o("Core/GeometryType",["./freezeObject"],function(e){"use strict";return e({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3})}),o("Core/PrimitiveType",["../Renderer/WebGLConstants","./freezeObject"],function(e,t){"use strict";var n={POINTS:e.POINTS,LINES:e.LINES,LINE_LOOP:e.LINE_LOOP,LINE_STRIP:e.LINE_STRIP,TRIANGLES:e.TRIANGLES,TRIANGLE_STRIP:e.TRIANGLE_STRIP,TRIANGLE_FAN:e.TRIANGLE_FAN,validate:function(e){return e===n.POINTS||e===n.LINES||e===n.LINE_LOOP||e===n.LINE_STRIP||e===n.TRIANGLES||e===n.TRIANGLE_STRIP||e===n.TRIANGLE_FAN}};return t(n)}),o("Core/Geometry",["./defaultValue","./defined","./DeveloperError","./GeometryType","./PrimitiveType"],function(e,t,n,r,i){"use strict";function o(t){t=e(t,e.EMPTY_OBJECT),this.attributes=t.attributes,this.indices=t.indices,this.primitiveType=e(t.primitiveType,i.TRIANGLES),this.boundingSphere=t.boundingSphere,this.geometryType=e(t.geometryType,r.NONE),this.boundingSphereCV=t.boundingSphereCV}return o.computeNumberOfVertices=function(e){var n=-1;for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)&&t(e.attributes[r])&&t(e.attributes[r].values)){var i=e.attributes[r];n=i.values.length/i.componentsPerAttribute}return n},o}),o("Core/GeometryAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";return function(t){t=e(t,e.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=e(t.normalize,!1),this.values=t.values}}),o("Core/GeometryAttributes",["./defaultValue"],function(e){"use strict";return function(t){t=e(t,e.EMPTY_OBJECT),this.position=t.position,this.normal=t.normal,this.st=t.st,this.binormal=t.binormal,this.tangent=t.tangent,this.color=t.color}}),o("Core/VertexFormat",["./defaultValue","./defined","./DeveloperError","./freezeObject"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this.position=e(t.position,!1),this.normal=e(t.normal,!1),this.st=e(t.st,!1),this.binormal=e(t.binormal,!1),this.tangent=e(t.tangent,!1),this.color=e(t.color,!1)}return i.POSITION_ONLY=r(new i({position:!0})),i.POSITION_AND_NORMAL=r(new i({position:!0,normal:!0})),i.POSITION_NORMAL_AND_ST=r(new i({position:!0,normal:!0,st:!0})),i.POSITION_AND_ST=r(new i({position:!0,st:!0})),i.POSITION_AND_COLOR=r(new i({position:!0,color:!0})),i.ALL=r(new i({position:!0,normal:!0,st:!0,binormal:!0,tangent:!0})),i.DEFAULT=i.POSITION_NORMAL_AND_ST,i.packedLength=6,i.pack=function(t,n,r){return r=e(r,0),n[r++]=t.position?1:0,n[r++]=t.normal?1:0,n[r++]=t.st?1:0,n[r++]=t.binormal?1:0,n[r++]=t.tangent?1:0,n[r++]=t.color?1:0,n},i.unpack=function(n,r,o){return r=e(r,0),t(o)||(o=new i),o.position=1===n[r++],o.normal=1===n[r++],o.st=1===n[r++],o.binormal=1===n[r++],o.tangent=1===n[r++],o.color=1===n[r++],o},i.clone=function(e,n){if(t(e))return t(n)||(n=new i),n.position=e.position,n.normal=e.normal,n.st=e.st,n.binormal=e.binormal,n.tangent=e.tangent,n.color=e.color,n},i}),o("Core/BoxGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e){var n=(e=r(e,r.EMPTY_OBJECT)).minimum,i=e.maximum,o=r(e.vertexFormat,c.DEFAULT);this._minimum=t.clone(n),this._maximum=t.clone(i),this._vertexFormat=o,this._workerName="createBoxGeometry"}var d=new t;h.fromDimensions=function(e){e=r(e,r.EMPTY_OBJECT);var n=t.multiplyByScalar(e.dimensions,.5,new t);return new h({minimum:t.negate(n,new t),maximum:n,vertexFormat:e.vertexFormat})},h.fromAxisAlignedBoundingBox=function(e){return new h({minimum:e.minimum,maximum:e.maximum})},h.packedLength=2*t.packedLength+c.packedLength,h.pack=function(e,n,i){return i=r(i,0),t.pack(e._minimum,n,i),t.pack(e._maximum,n,i+t.packedLength),c.pack(e._vertexFormat,n,i+2*t.packedLength),n};var p=new t,f=new t,m=new c,_={minimum:p,maximum:f,vertexFormat:m};return h.unpack=function(e,n,o){n=r(n,0);var a=t.unpack(e,n,p),s=t.unpack(e,n+t.packedLength,f),l=c.unpack(e,n+2*t.packedLength,m);return i(o)?(o._minimum=t.clone(a,o._minimum),o._maximum=t.clone(s,o._maximum),o._vertexFormat=c.clone(l,o._vertexFormat),o):new h(_)},h.createGeometry=function(r){var i=r._minimum,o=r._maximum,c=r._vertexFormat;if(!t.equals(i,o)){var h,p,f=new l;if(c.position&&(c.st||c.normal||c.binormal||c.tangent)){if(c.position&&((p=new Float64Array(72))[0]=i.x,p[1]=i.y,p[2]=o.z,p[3]=o.x,p[4]=i.y,p[5]=o.z,p[6]=o.x,p[7]=o.y,p[8]=o.z,p[9]=i.x,p[10]=o.y,p[11]=o.z,p[12]=i.x,p[13]=i.y,p[14]=i.z,p[15]=o.x,p[16]=i.y,p[17]=i.z,p[18]=o.x,p[19]=o.y,p[20]=i.z,p[21]=i.x,p[22]=o.y,p[23]=i.z,p[24]=o.x,p[25]=i.y,p[26]=i.z,p[27]=o.x,p[28]=o.y,p[29]=i.z,p[30]=o.x,p[31]=o.y,p[32]=o.z,p[33]=o.x,p[34]=i.y,p[35]=o.z,p[36]=i.x,p[37]=i.y,p[38]=i.z,p[39]=i.x,p[40]=o.y,p[41]=i.z,p[42]=i.x,p[43]=o.y,p[44]=o.z,p[45]=i.x,p[46]=i.y,p[47]=o.z,p[48]=i.x,p[49]=o.y,p[50]=i.z,p[51]=o.x,p[52]=o.y,p[53]=i.z,p[54]=o.x,p[55]=o.y,p[56]=o.z,p[57]=i.x,p[58]=o.y,p[59]=o.z,p[60]=i.x,p[61]=i.y,p[62]=i.z,p[63]=o.x,p[64]=i.y,p[65]=i.z,p[66]=o.x,p[67]=i.y,p[68]=o.z,p[69]=i.x,p[70]=i.y,p[71]=o.z,f.position=new s({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:p})),c.normal){var m=new Float32Array(72);m[0]=0,m[1]=0,m[2]=1,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=1,m[9]=0,m[10]=0,m[11]=1,m[12]=0,m[13]=0,m[14]=-1,m[15]=0,m[16]=0,m[17]=-1,m[18]=0,m[19]=0,m[20]=-1,m[21]=0,m[22]=0,m[23]=-1,m[24]=1,m[25]=0,m[26]=0,m[27]=1,m[28]=0,m[29]=0,m[30]=1,m[31]=0,m[32]=0,m[33]=1,m[34]=0,m[35]=0,m[36]=-1,m[37]=0,m[38]=0,m[39]=-1,m[40]=0,m[41]=0,m[42]=-1,m[43]=0,m[44]=0,m[45]=-1,m[46]=0,m[47]=0,m[48]=0,m[49]=1,m[50]=0,m[51]=0,m[52]=1,m[53]=0,m[54]=0,m[55]=1,m[56]=0,m[57]=0,m[58]=1,m[59]=0,m[60]=0,m[61]=-1,m[62]=0,m[63]=0,m[64]=-1,m[65]=0,m[66]=0,m[67]=-1,m[68]=0,m[69]=0,m[70]=-1,m[71]=0,f.normal=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:m})}if(c.st){var _=new Float32Array(48);_[0]=0,_[1]=0,_[2]=1,_[3]=0,_[4]=1,_[5]=1,_[6]=0,_[7]=1,_[8]=1,_[9]=0,_[10]=0,_[11]=0,_[12]=0,_[13]=1,_[14]=1,_[15]=1,_[16]=0,_[17]=0,_[18]=1,_[19]=0,_[20]=1,_[21]=1,_[22]=0,_[23]=1,_[24]=1,_[25]=0,_[26]=0,_[27]=0,_[28]=0,_[29]=1,_[30]=1,_[31]=1,_[32]=1,_[33]=0,_[34]=0,_[35]=0,_[36]=0,_[37]=1,_[38]=1,_[39]=1,_[40]=0,_[41]=0,_[42]=1,_[43]=0,_[44]=1,_[45]=1,_[46]=0,_[47]=1,f.st=new s({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:_})}if(c.tangent){var g=new Float32Array(72);g[0]=1,g[1]=0,g[2]=0,g[3]=1,g[4]=0,g[5]=0,g[6]=1,g[7]=0,g[8]=0,g[9]=1,g[10]=0,g[11]=0,g[12]=-1,g[13]=0,g[14]=0,g[15]=-1,g[16]=0,g[17]=0,g[18]=-1,g[19]=0,g[20]=0,g[21]=-1,g[22]=0,g[23]=0,g[24]=0,g[25]=1,g[26]=0,g[27]=0,g[28]=1,g[29]=0,g[30]=0,g[31]=1,g[32]=0,g[33]=0,g[34]=1,g[35]=0,g[36]=0,g[37]=-1,g[38]=0,g[39]=0,g[40]=-1,g[41]=0,g[42]=0,g[43]=-1,g[44]=0,g[45]=0,g[46]=-1,g[47]=0,g[48]=-1,g[49]=0,g[50]=0,g[51]=-1,g[52]=0,g[53]=0,g[54]=-1,g[55]=0,g[56]=0,g[57]=-1,g[58]=0,g[59]=0,g[60]=1,g[61]=0,g[62]=0,g[63]=1,g[64]=0,g[65]=0,g[66]=1,g[67]=0,g[68]=0,g[69]=1,g[70]=0,g[71]=0,f.tangent=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:g})}if(c.binormal){var v=new Float32Array(72);v[0]=0,v[1]=1,v[2]=0,v[3]=0,v[4]=1,v[5]=0,v[6]=0,v[7]=1,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=1,v[14]=0,v[15]=0,v[16]=1,v[17]=0,v[18]=0,v[19]=1,v[20]=0,v[21]=0,v[22]=1,v[23]=0,v[24]=0,v[25]=0,v[26]=1,v[27]=0,v[28]=0,v[29]=1,v[30]=0,v[31]=0,v[32]=1,v[33]=0,v[34]=0,v[35]=1,v[36]=0,v[37]=0,v[38]=1,v[39]=0,v[40]=0,v[41]=1,v[42]=0,v[43]=0,v[44]=1,v[45]=0,v[46]=0,v[47]=1,v[48]=0,v[49]=0,v[50]=1,v[51]=0,v[52]=0,v[53]=1,v[54]=0,v[55]=0,v[56]=1,v[57]=0,v[58]=0,v[59]=1,v[60]=0,v[61]=0,v[62]=1,v[63]=0,v[64]=0,v[65]=1,v[66]=0,v[67]=0,v[68]=1,v[69]=0,v[70]=0,v[71]=1,f.binormal=new s({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:v})}(h=new Uint16Array(36))[0]=0,h[1]=1,h[2]=2,h[3]=0,h[4]=2,h[5]=3,h[6]=6,h[7]=5,h[8]=4,h[9]=7,h[10]=6,h[11]=4,h[12]=8,h[13]=9,h[14]=10,h[15]=8,h[16]=10,h[17]=11,h[18]=14,h[19]=13,h[20]=12,h[21]=15,h[22]=14,h[23]=12,h[24]=18,h[25]=17,h[26]=16,h[27]=19,h[28]=18,h[29]=16,h[30]=20,h[31]=21,h[32]=22,h[33]=20,h[34]=22,h[35]=23}else p=new Float64Array(24),p[0]=i.x,p[1]=i.y,p[2]=i.z,p[3]=o.x,p[4]=i.y,p[5]=i.z,p[6]=o.x,p[7]=o.y,p[8]=i.z,p[9]=i.x,p[10]=o.y,p[11]=i.z,p[12]=i.x,p[13]=i.y,p[14]=o.z,p[15]=o.x,p[16]=i.y,p[17]=o.z,p[18]=o.x,p[19]=o.y,p[20]=o.z,p[21]=i.x,p[22]=o.y,p[23]=o.z,f.position=new s({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:p}),h=new Uint16Array(36),h[0]=4,h[1]=5,h[2]=6,h[3]=4,h[4]=6,h[5]=7,h[6]=1,h[7]=0,h[8]=3,h[9]=1,h[10]=3,h[11]=2,h[12]=1,h[13]=6,h[14]=5,h[15]=1,h[16]=2,h[17]=6,h[18]=2,h[19]=3,h[20]=7,h[21]=2,h[22]=7,h[23]=6,h[24]=3,h[25]=0,h[26]=4,h[27]=3,h[28]=4,h[29]=7,h[30]=0,h[31]=1,h[32]=5,h[33]=0,h[34]=5,h[35]=4;var y=t.subtract(o,i,d),C=.5*t.magnitude(y);return new a({attributes:f,indices:h,primitiveType:u.TRIANGLES,boundingSphere:new e(t.ZERO,C)})}},h}),o("Core/BoxOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e){var n=(e=r(e,r.EMPTY_OBJECT)).maximum;this._min=t.clone(e.minimum),this._max=t.clone(n),this._workerName="createBoxOutlineGeometry"}var h=new t;c.fromDimensions=function(e){e=r(e,r.EMPTY_OBJECT);var n=t.multiplyByScalar(e.dimensions,.5,new t);return new c({minimum:t.negate(n,new t),maximum:n})},c.fromAxisAlignedBoundingBox=function(e){return new c({minimum:e.minimum,maximum:e.maximum})},c.packedLength=2*t.packedLength,c.pack=function(e,n,i){return i=r(i,0),t.pack(e._min,n,i),t.pack(e._max,n,i+t.packedLength),n};var d=new t,p=new t,f={minimum:d,maximum:p};return c.unpack=function(e,n,o){n=r(n,0);var a=t.unpack(e,n,d),s=t.unpack(e,n+t.packedLength,p);return i(o)?(o._min=t.clone(a,o._min),o._max=t.clone(s,o._max),o):new c(f)},c.createGeometry=function(r){var i=r._min,o=r._max;if(!t.equals(i,o)){var c=new l,d=new Uint16Array(24),p=new Float64Array(24);p[0]=i.x,p[1]=i.y,p[2]=i.z,p[3]=o.x,p[4]=i.y,p[5]=i.z,p[6]=o.x,p[7]=o.y,p[8]=i.z,p[9]=i.x,p[10]=o.y,p[11]=i.z,p[12]=i.x,p[13]=i.y,p[14]=o.z,p[15]=o.x,p[16]=i.y,p[17]=o.z,p[18]=o.x,p[19]=o.y,p[20]=o.z,p[21]=i.x,p[22]=o.y,p[23]=o.z,c.position=new s({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:p}),d[0]=4,d[1]=5,d[2]=5,d[3]=6,d[4]=6,d[5]=7,d[6]=7,d[7]=4,d[8]=0,d[9]=1,d[10]=1,d[11]=2,d[12]=2,d[13]=3,d[14]=3,d[15]=0,d[16]=0,d[17]=4,d[18]=1,d[19]=5,d[20]=2,d[21]=6,d[22]=3,d[23]=7;var f=t.subtract(o,i,h),m=.5*t.magnitude(f);return new a({attributes:c,indices:d,primitiveType:u.LINES,boundingSphere:new e(t.ZERO,m)})}},c}),o("Core/cancelAnimationFrame",["./defined"],function(e){"use strict";if("undefined"!=typeof window){var t=window.cancelAnimationFrame;return function(){if(!e(t))for(var n=["webkit","moz","ms","o"],r=0,i=n.length;r<i&&!e(t);)t=window[n[r]+"CancelAnimationFrame"],e(t)||(t=window[n[r]+"CancelRequestAnimationFrame"]),++r;e(t)||(t=clearTimeout)}(),function(e){t(e)}}}),o("Core/Spline",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(){this.times=void 0,this.points=void 0,n.throwInstantiationError()}return r.prototype.evaluate=n.throwInstantiationError,r.prototype.findTimeInterval=function(t,n){var r,i=this.times,o=i.length;if(t>=i[n=e(n,0)]){if(n+1<o&&t<i[n+1])return n;if(n+2<o&&t<i[n+2])return n+1}else if(n-1>=0&&t>=i[n-1])return n-1;if(t>i[n])for(r=n;r<o-1&&!(t>=i[r]&&t<i[r+1]);++r);else for(r=n-1;r>=0&&!(t>=i[r]&&t<i[r+1]);--r);return r===o-1&&(r=o-2),r},r}),o("Core/LinearSpline",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Spline"],function(e,t,n,r,i,o){"use strict";function a(e){var n=(e=t(e,t.EMPTY_OBJECT)).points;this._times=e.times,this._points=n,this._lastTimeIndex=0}return r(a.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),a.prototype.findTimeInterval=o.prototype.findTimeInterval,a.prototype.evaluate=function(t,r){var i=this.points,o=this.times,a=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex),s=(t-o[a])/(o[a+1]-o[a]);return n(r)||(r=new e),e.lerp(i[a],i[a+1],s,r)},a}),o("Core/TridiagonalSystemSolver",["./Cartesian3","./defined","./DeveloperError"],function(e,t,n){"use strict";var r={};return r.solve=function(t,n,r,i){var o,a,s=new Array(r.length),l=new Array(i.length),u=new Array(i.length);for(o=0;o<l.length;o++)l[o]=new e,u[o]=new e;for(s[0]=r[0]/n[0],l[0]=e.multiplyByScalar(i[0],1/n[0],l[0]),o=1;o<s.length;++o)a=1/(n[o]-s[o-1]*t[o-1]),s[o]=r[o]*a,l[o]=e.subtract(i[o],e.multiplyByScalar(l[o-1],t[o-1],l[o]),l[o]),l[o]=e.multiplyByScalar(l[o],a,l[o]);for(a=1/(n[o]-s[o-1]*t[o-1]),l[o]=e.subtract(i[o],e.multiplyByScalar(l[o-1],t[o-1],l[o]),l[o]),l[o]=e.multiplyByScalar(l[o],a,l[o]),u[u.length-1]=l[l.length-1],o=u.length-2;o>=0;--o)u[o]=e.subtract(l[o],e.multiplyByScalar(u[o+1],s[o],u[o]),u[o]);return u},r}),o("Core/HermiteSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./LinearSpline","./Matrix4","./Spline","./TridiagonalSystemSolver"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e){var t=(e=n(e,n.EMPTY_OBJECT)).points,r=e.inTangents,i=e.outTangents;this._times=e.times,this._points=t,this._inTangents=r,this._outTangents=i,this._lastTimeIndex=0}var h=[],d=[],p=[],f=[];i(c.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}}),c.createC1=function(e){var t=(e=n(e,n.EMPTY_OBJECT)).times,r=e.points,i=e.tangents,o=i.slice(0,i.length-1);return new c({times:t,points:r,inTangents:i.slice(1,i.length),outTangents:o})},c.createNaturalCubic=function(t){var i=(t=n(t,n.EMPTY_OBJECT)).times,o=t.points;if(o.length<3)return new a({points:o,times:i});var s=function(t){var n,i=h,o=p,a=d,s=f;i.length=o.length=t.length-1,a.length=s.length=t.length,i[0]=o[0]=1,a[0]=2;var l=s[0];for(r(l)||(l=s[0]=new e),e.subtract(t[1],t[0],l),e.multiplyByScalar(l,3,l),n=1;n<i.length;++n)i[n]=o[n]=1,a[n]=4,l=s[n],r(l)||(l=s[n]=new e),e.subtract(t[n+1],t[n-1],l),e.multiplyByScalar(l,3,l);return a[n]=2,r(l=s[n])||(l=s[n]=new e),e.subtract(t[n],t[n-1],l),e.multiplyByScalar(l,3,l),u.solve(i,a,o,s)}(o),l=s.slice(0,s.length-1);return new c({times:i,points:o,inTangents:s.slice(1,s.length),outTangents:l})},c.createClampedCubic=function(t){var i=(t=n(t,n.EMPTY_OBJECT)).times,o=t.points,s=t.firstTangent,l=t.lastTangent;if(o.length<3)return new a({points:o,times:i});var m=function(t,n,i){var o,a=h,s=p,l=d,c=f;a.length=s.length=t.length-1,l.length=c.length=t.length,a[0]=l[0]=1,s[0]=0;var m=c[0];for(r(m)||(m=c[0]=new e),e.clone(n,m),o=1;o<a.length-1;++o)a[o]=s[o]=1,l[o]=4,m=c[o],r(m)||(m=c[o]=new e),e.subtract(t[o+1],t[o-1],m),e.multiplyByScalar(m,3,m);return a[o]=0,s[o]=1,l[o]=4,r(m=c[o])||(m=c[o]=new e),e.subtract(t[o+1],t[o-1],m),e.multiplyByScalar(m,3,m),l[o+1]=1,r(m=c[o+1])||(m=c[o+1]=new e),e.clone(i,m),u.solve(a,l,s,c)}(o,s,l),_=m.slice(0,m.length-1);return new c({times:i,points:o,inTangents:m.slice(1,m.length),outTangents:_})},c.hermiteCoefficientMatrix=new s(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0),c.prototype.findTimeInterval=l.prototype.findTimeInterval;var m=new t,_=new e;return c.prototype.evaluate=function(t,n){r(n)||(n=new e);var i=this.points,o=this.times,a=this.inTangents,l=this.outTangents,u=this._lastTimeIndex=this.findTimeInterval(t,this._lastTimeIndex),h=(t-o[u])/(o[u+1]-o[u]),d=m;d.z=h,d.y=h*h,d.x=d.y*h,d.w=1;var p=s.multiplyByVector(c.hermiteCoefficientMatrix,d,d);return n=e.multiplyByScalar(i[u],p.x,n),e.multiplyByScalar(i[u+1],p.y,_),e.add(n,_,n),e.multiplyByScalar(l[u],p.z,_),e.add(n,_,n),e.multiplyByScalar(a[u],p.w,_),e.add(n,_,n)},c}),o("Core/CatmullRomSpline",["./Cartesian3","./Cartesian4","./defaultValue","./defined","./defineProperties","./DeveloperError","./HermiteSpline","./Matrix4","./Spline"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t){var i=(t=n(t,n.EMPTY_OBJECT)).points,o=t.times,l=t.firstTangent,m=t.lastTangent;if(i.length>2&&(r(l)||(e.multiplyByScalar(i[1],2,l=p),e.subtract(l,i[2],l),e.subtract(l,i[0],l),e.multiplyByScalar(l,.5,l)),!r(m))){var _=i.length-1;e.multiplyByScalar(i[_-1],2,m=f),e.subtract(i[_],m,m),e.add(m,i[_-2],m),e.multiplyByScalar(m,.5,m)}this._times=o,this._points=i,this._firstTangent=e.clone(l),this._lastTangent=e.clone(m),this._evaluateFunction=function(t){var n=t.points,i=t.times;if(n.length<3){var o=i[0],l=1/(i[1]-o),p=n[0],f=n[1];return function(t,n){return r(n)||(n=new e),e.lerp(p,f,(t-o)*l,n)}}return function(o,l){r(l)||(l=new e);var p,f,m,_,g,v=t._lastTimeIndex=t.findTimeInterval(o,t._lastTimeIndex),y=(o-i[v])/(i[v+1]-i[v]),C=c;return C.z=y,C.y=y*y,C.x=C.y*y,C.w=1,0===v?(f=n[1],m=t.firstTangent,_=e.subtract(n[2],p=n[0],h),e.multiplyByScalar(_,.5,_),g=s.multiplyByVector(a.hermiteCoefficientMatrix,C,C)):v===n.length-2?(p=n[v],_=t.lastTangent,m=e.subtract(f=n[v+1],n[v-1],h),e.multiplyByScalar(m,.5,m),g=s.multiplyByVector(a.hermiteCoefficientMatrix,C,C)):(p=n[v-1],f=n[v],m=n[v+1],_=n[v+2],g=s.multiplyByVector(u.catmullRomCoefficientMatrix,C,C)),l=e.multiplyByScalar(p,g.x,l),e.multiplyByScalar(f,g.y,d),e.add(l,d,l),e.multiplyByScalar(m,g.z,d),e.add(l,d,l),e.multiplyByScalar(_,g.w,d),e.add(l,d,l)}}(this),this._lastTimeIndex=0}var c=new t,h=new e,d=new e,p=new e,f=new e;return i(u.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}}),u.catmullRomCoefficientMatrix=new s(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0),u.prototype.findTimeInterval=l.prototype.findTimeInterval,u.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)},u}),o("Core/IndexDatatype",["../Renderer/WebGLConstants","./defined","./DeveloperError","./freezeObject","./Math"],function(e,t,n,r,i){"use strict";var o={UNSIGNED_BYTE:e.UNSIGNED_BYTE,UNSIGNED_SHORT:e.UNSIGNED_SHORT,UNSIGNED_INT:e.UNSIGNED_INT};return o.getSizeInBytes=function(e){switch(e){case o.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case o.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case o.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}},o.validate=function(e){return t(e)&&(e===o.UNSIGNED_BYTE||e===o.UNSIGNED_SHORT||e===o.UNSIGNED_INT)},o.createTypedArray=function(e,t){return e>=i.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},o.createTypedArrayFromArrayBuffer=function(e,t,n,r){return e>=i.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,n,r):new Uint16Array(t,n,r)},r(o)}),o("Core/loadArrayBuffer",["./loadWithXhr"],function(e){"use strict";return function(t,n){return e({url:t,responseType:"arraybuffer",headers:n})}}),o("Core/Intersections2D",["./Cartesian3","./defined","./DeveloperError"],function(e,t,n){"use strict";var r={};return r.clipTriangleAtAxisAlignedThreshold=function(e,n,r,i,o,a){var s,l,u;t(a)?a.length=0:a=[],n?(s=r<e,l=i<e,u=o<e):(s=r>e,l=i>e,u=o>e);var c,h,d,p,f,m,_=s+l+u;return 1===_?s?(c=(e-r)/(i-r),h=(e-r)/(o-r),a.push(1),a.push(2),1!==h&&(a.push(-1),a.push(0),a.push(2),a.push(h)),1!==c&&(a.push(-1),a.push(0),a.push(1),a.push(c))):l?(d=(e-i)/(o-i),p=(e-i)/(r-i),a.push(2),a.push(0),1!==p&&(a.push(-1),a.push(1),a.push(0),a.push(p)),1!==d&&(a.push(-1),a.push(1),a.push(2),a.push(d))):u&&(f=(e-o)/(r-o),m=(e-o)/(i-o),a.push(0),a.push(1),1!==m&&(a.push(-1),a.push(2),a.push(1),a.push(m)),1!==f&&(a.push(-1),a.push(2),a.push(0),a.push(f))):2===_?s||r===e?l||i===e?u||o===e||(h=(e-r)/(o-r),d=(e-i)/(o-i),a.push(2),a.push(-1),a.push(0),a.push(2),a.push(h),a.push(-1),a.push(1),a.push(2),a.push(d)):(m=(e-o)/(i-o),c=(e-r)/(i-r),a.push(1),a.push(-1),a.push(2),a.push(1),a.push(m),a.push(-1),a.push(0),a.push(1),a.push(c)):(p=(e-i)/(r-i),f=(e-o)/(r-o),a.push(0),a.push(-1),a.push(1),a.push(0),a.push(p),a.push(-1),a.push(2),a.push(0),a.push(f)):3!==_&&(a.push(0),a.push(1),a.push(2)),a},r.computeBarycentricCoordinates=function(n,r,i,o,a,s,l,u,c){var h=i-l,d=l-a,p=s-u,f=o-u,m=1/(p*h+d*f),_=r-u,g=n-l,v=(p*g+d*_)*m,y=(-f*g+h*_)*m,C=1-v-y;return t(c)?(c.x=v,c.y=y,c.z=C,c):new e(v,y,C)},r}),o("Core/QuantizedMeshTerrainData",["../ThirdParty/when","./BoundingSphere","./Cartesian2","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./IndexDatatype","./Intersections2D","./Math","./OrientedBoundingBox","./TaskProcessor","./TerrainEncoding","./TerrainMesh"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e){function t(e,t){return a[e]-a[t]}function n(e,t){return o[e]-o[t]}this._quantizedVertices=e.quantizedVertices,this._encodedNormals=e.encodedNormals,this._indices=e.indices,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._boundingSphere=e.boundingSphere,this._orientedBoundingBox=e.orientedBoundingBox,this._horizonOcclusionPoint=e.horizonOcclusionPoint;var r=this._quantizedVertices.length/3,o=this._uValues=this._quantizedVertices.subarray(0,r),a=this._vValues=this._quantizedVertices.subarray(r,2*r);this._heightValues=this._quantizedVertices.subarray(2*r,3*r),this._westIndices=_(e.westIndices,t,r),this._southIndices=_(e.southIndices,n,r),this._eastIndices=_(e.eastIndices,t,r),this._northIndices=_(e.northIndices,n,r),this._westSkirtHeight=e.westSkirtHeight,this._southSkirtHeight=e.southSkirtHeight,this._eastSkirtHeight=e.eastSkirtHeight,this._northSkirtHeight=e.northSkirtHeight,this._childTileMask=i(e.childTileMask,15),this._createdByUpsampling=i(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._mesh=void 0}function _(e,t,n){g.length=e.length;for(var r=!1,i=0,o=e.length;i<o;++i)g[i]=e[i],r=r||i>0&&t(e[i-1],e[i])>0;return r?(g.sort(t),l.createTypedArray(n,g)):e}a(m.prototype,{waterMask:{get:function(){return this._waterMask}}});var g=[],v=new d("createVerticesFromQuantizedTerrainMesh");m.prototype.createMesh=function(t,n,r,a,s){var u=t.ellipsoid,c=t.tileXYToRectangle(n,r,a);s=i(s,1);var h=v.scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:c,relativeToCenter:this._boundingSphere.center,ellipsoid:u,exaggeration:s});if(o(h)){var d=this;return e(h,function(e){var t=d._quantizedVertices.length/3,n=l.createTypedArray(t+=d._westIndices.length+d._southIndices.length+d._eastIndices.length+d._northIndices.length,e.indices),r=new Float32Array(e.vertices),o=e.center,a=e.minimumHeight,u=e.maximumHeight,c=i(e.boundingSphere,d._boundingSphere),h=i(e.orientedBoundingBox,d._orientedBoundingBox),m=d._horizonOcclusionPoint,_=e.vertexStride,g=p.clone(e.encoding);return d._skirtIndex=e.skirtIndex,d._vertexCountWithoutSkirts=d._quantizedVertices.length/3,d._mesh=new f(o,r,n,a,u,c,m,_,h,g,s),d._quantizedVertices=void 0,d._encodedNormals=void 0,d._indices=void 0,d._uValues=void 0,d._vValues=void 0,d._heightValues=void 0,d._westIndices=void 0,d._southIndices=void 0,d._eastIndices=void 0,d._northIndices=void 0,d._mesh})}};var y=new d("upsampleQuantizedTerrainMesh");m.prototype.upsample=function(n,i,a,s,u,c,d){var p=this._mesh;if(o(this._mesh)){var f=2*i!==u,_=2*a===c,g=n.ellipsoid,v=n.tileXYToRectangle(u,c,d),C=y.scheduleTask({vertices:p.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:p.indices,skirtIndex:this._skirtIndex,encoding:p.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:f,isNorthChild:_,childRectangle:v,ellipsoid:g,exaggeration:p.exaggeration});if(o(C)){var w=Math.min(this._westSkirtHeight,this._eastSkirtHeight);w=Math.min(w,this._southSkirtHeight),w=Math.min(w,this._northSkirtHeight);var b=f?.5*w:this._westSkirtHeight,E=_?.5*w:this._southSkirtHeight,S=f?this._eastSkirtHeight:.5*w,x=_?this._northSkirtHeight:.5*w;return e(C,function(e){var n,i=new Uint16Array(e.vertices),a=l.createTypedArray(i.length/3,e.indices);return o(e.encodedNormals)&&(n=new Uint8Array(e.encodedNormals)),new m({quantizedVertices:i,indices:a,encodedNormals:n,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:t.clone(e.boundingSphere),orientedBoundingBox:h.clone(e.orientedBoundingBox),horizonOcclusionPoint:r.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:b,southSkirtHeight:E,eastSkirtHeight:S,northSkirtHeight:x,childTileMask:0,createdByUpsampling:!0})})}}};var C=new r;m.prototype.interpolateHeight=function(e,t,n){var r=c.clamp((t-e.west)/e.width,0,1);r*=32767;var i=c.clamp((n-e.south)/e.height,0,1);return i*=32767,o(this._mesh)?void function(e,t,n){for(var r=e._mesh,i=r.vertices,o=r.encoding,a=r.indices,s=0,l=a.length;s<l;s+=3){var c=a[s],h=a[s+1],d=a[s+2],p=o.decodeTextureCoordinates(i,c,w),f=o.decodeTextureCoordinates(i,h,b),m=o.decodeTextureCoordinates(i,d,E),_=u.computeBarycentricCoordinates(t,n,p.x,p.y,f.x,f.y,m.x,m.y,C);if(_.x>=-1e-15&&_.y>=-1e-15&&_.z>=-1e-15){var g=o.decodeHeight(i,c),v=o.decodeHeight(i,h),y=o.decodeHeight(i,d);return _.x*g+_.y*v+_.z*y}}}(this,r,i):function(e,t,n){for(var r=e._uValues,i=e._vValues,o=e._heightValues,a=e._indices,s=0,l=a.length;s<l;s+=3){var h=a[s],d=a[s+1],p=a[s+2],f=u.computeBarycentricCoordinates(t,n,r[h],i[h],r[d],i[d],r[p],i[p],C);if(f.x>=-1e-15&&f.y>=-1e-15&&f.z>=-1e-15)return c.lerp(e._minimumHeight,e._maximumHeight,(f.x*o[h]+f.y*o[d]+f.z*o[p])/32767)}}(this,r,i)};var w=new n,b=new n,E=new n;return m.prototype.isChildAvailable=function(e,t,n,r){var i=2;return n!==2*e&&++i,r!==2*t&&(i-=2),0!=(this._childTileMask&1<<i)},m.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling},m}),o("Core/formatError",["./defined"],function(e){"use strict";return function(t){var n,r=t.name,i=t.message;n=e(r)&&e(i)?r+": "+i:t.toString();var o=t.stack;return e(o)&&(n+="\n"+o),n}}),o("Core/TileProviderError",["./defaultValue","./defined","./formatError"],function(e,t,n){"use strict";function r(t,n,r,i,o,a,s){this.provider=t,this.message=n,this.x=r,this.y=i,this.level=o,this.timesRetried=e(a,0),this.retry=!1,this.error=s}return r.handleError=function(e,i,o,a,s,l,u,c,h){var d=e;return t(e)?(d.provider=i,d.message=a,d.x=s,d.y=l,d.level=u,d.retry=!1,d.error=h,++d.timesRetried):d=new r(i,a,s,l,u,0,h),o.numberOfListeners>0?o.raiseEvent(d):console.log('An error occurred in "'+i.constructor.name+'": '+n(a)),d.retry&&t(c)&&c(),d},r.handleSuccess=function(e){t(e)&&(e.timesRetried=-1)},r}),o("Core/CesiumTerrainProvider",["../ThirdParty/Uri","../ThirdParty/when","./BoundingSphere","./Cartesian3","./Credit","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./IndexDatatype","./joinUrls","./loadArrayBuffer","./loadJson","./Math","./Matrix3","./OrientedBoundingBox","./QuantizedMeshTerrainData","./RuntimeError","./TerrainProvider","./throttleRequestByServer","./TileProviderError"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E){"use strict";function S(n){function r(t){var n;if(!t.format)return n="The tile format is not specified in the layer.json file.",void(f=E.handleError(f,_,_._errorEvent,n,void 0,void 0,void 0,l));if(!t.tiles||0===t.tiles.length)return n="The layer.json file does not specify any tile URL templates.",void(f=E.handleError(f,_,_._errorEvent,n,void 0,void 0,void 0,l));if("heightmap-1.0"===t.format)_._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535},_._hasWaterMask=!0,_._requestWaterMask=!0;else if(0!==t.format.indexOf("quantized-mesh-1."))return n='The tile format "'+t.format+'" is invalid or not supported.',void(f=E.handleError(f,_,_._errorEvent,n,void 0,void 0,void 0,l));_._tileUrlTemplates=t.tiles;for(var r=0;r<_._tileUrlTemplates.length;++r){var o=new e(_._tileUrlTemplates[r]),s=new e(_._url);o.authority&&!s.authority&&(s.authority=o.authority,s.scheme=o.scheme),_._tileUrlTemplates[r]=p(s,o).toString().replace("{version}",t.version)}_._availableTiles=t.available,!a(_._credit)&&a(t.attribution)&&null!==t.attribution&&(_._credit=new i(t.attribution)),a(t.extensions)&&-1!==t.extensions.indexOf("octvertexnormals")?_._hasVertexNormals=!0:a(t.extensions)&&-1!==t.extensions.indexOf("vertexnormals")&&(_._hasVertexNormals=!0,_._littleEndianExtensionSize=!1),a(t.extensions)&&-1!==t.extensions.indexOf("watermask")&&(_._hasWaterMask=!0),_._ready=!0,_._readyPromise.resolve(!0)}function s(e){a(e)&&404===e.statusCode?r({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):f=E.handleError(f,_,_._errorEvent,"An error occurred while accessing "+d+".",void 0,void 0,void 0,l)}function l(){var e=m(d);t(e,r,s)}this._url=n.url,this._proxy=n.proxy,this._tilingScheme=new c({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:n.ellipsoid}),this._heightmapWidth=65,this._levelZeroMaximumGeometricError=w.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._requestVertexNormals=o(n.requestVertexNormals,!1),this._littleEndianExtensionSize=!0,this._requestWaterMask=o(n.requestWaterMask,!1),this._errorEvent=new u;var h=n.credit;"string"==typeof h&&(h=new i(h)),this._credit=h,this._ready=!1,this._readyPromise=t.defer();var d=p(this._url,"layer.json");a(this._proxy)&&(d=this._proxy.getURL(d));var f,_=this;l()}function x(e,t,n){for(var r=0,i=e.length;r<i;++r){var o=e[r];if(t>=o.startX&&t<=o.endX&&n>=o.startY&&n<=o.endY)return!0}return!1}var T=1,A=2;return S.prototype.requestTileGeometry=function(e,i,s,l){function u(e){return f(e,a(t=w)&&0!==t.length?{Accept:"application/vnd.quantized-mesh;extensions="+t.join("-")+",application/octet-stream;q=0.9,*/*;q=0.01"}:{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"});var t}var c=this._tileUrlTemplates;if(0!==c.length){var p=this._tilingScheme.getNumberOfYTilesAtLevel(s)-i-1,m=c[(e+p+s)%c.length].replace("{z}",s).replace("{x}",e).replace("{y}",p),g=this._proxy;a(g)&&(m=g.getURL(m));var C,w=[];if(this._requestVertexNormals&&this._hasVertexNormals&&w.push(this._littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),this._requestWaterMask&&this._hasWaterMask&&w.push("watermask"),l=o(l,!0)){if(C=b(m,u),!a(C))return}else C=u(m);var E=this;return t(C,function(t){return a(E._heightmapStructure)?(o=E,l=t,u=new Uint16Array(l,0,o._heightmapWidth*o._heightmapWidth),new h({buffer:u,childTileMask:new Uint8Array(l,u.byteLength,1)[0],waterMask:new Uint8Array(l,u.byteLength+1,l.byteLength-u.byteLength-1),width:o._heightmapWidth,height:o._heightmapWidth,structure:o._heightmapStructure})):function(e,t,i,o,a,s){function l(e){return e>>1^-(1&e)}var u=0,c=3*Float64Array.BYTES_PER_ELEMENT,h=4*Float64Array.BYTES_PER_ELEMENT,p=3*Uint16Array.BYTES_PER_ELEMENT,f=Uint16Array.BYTES_PER_ELEMENT,m=3*f,g=new DataView(t),C=new r(g.getFloat64(u,!0),g.getFloat64(u+8,!0),g.getFloat64(u+16,!0)),w=g.getFloat32(u+=c,!0);u+=Float32Array.BYTES_PER_ELEMENT;var b=g.getFloat32(u,!0);u+=Float32Array.BYTES_PER_ELEMENT;var E=new n(new r(g.getFloat64(u,!0),g.getFloat64(u+8,!0),g.getFloat64(u+16,!0)),g.getFloat64(u+c,!0)),S=new r(g.getFloat64(u+=h,!0),g.getFloat64(u+8,!0),g.getFloat64(u+16,!0)),P=g.getUint32(u+=c,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var D=new Uint16Array(t,u,3*P);u+=P*p,P>65536&&(m=3*(f=Uint32Array.BYTES_PER_ELEMENT));var M,I=D.subarray(0,P),O=D.subarray(P,2*P),R=D.subarray(2*P,3*P),N=0,L=0,F=0;for(M=0;M<P;++M)N+=l(I[M]),L+=l(O[M]),F+=l(R[M]),I[M]=N,O[M]=L,R[M]=F;u%f!=0&&(u+=f-u%f);var B=g.getUint32(u,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var k=d.createTypedArrayFromArrayBuffer(P,t,u,3*B);u+=B*m;var V=0;for(M=0;M<k.length;++M){var z=k[M];k[M]=V-z,0===z&&++V}var U=g.getUint32(u,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var G=d.createTypedArrayFromArrayBuffer(P,t,u,U),W=g.getUint32(u+=U*f,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var H=d.createTypedArrayFromArrayBuffer(P,t,u,W),j=g.getUint32(u+=W*f,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var q=d.createTypedArrayFromArrayBuffer(P,t,u,j),Y=g.getUint32(u+=j*f,!0);u+=Uint32Array.BYTES_PER_ELEMENT;var X,Z,K=d.createTypedArrayFromArrayBuffer(P,t,u,Y);for(u+=Y*f;u<g.byteLength;){var Q=g.getUint8(u,!0);u+=Uint8Array.BYTES_PER_ELEMENT;var J=g.getUint32(u,e._littleEndianExtensionSize);u+=Uint32Array.BYTES_PER_ELEMENT,Q===T&&e._requestVertexNormals?X=new Uint8Array(t,u,2*P):Q===A&&e._requestWaterMask&&(Z=new Uint8Array(t,u,J)),u+=J}var $,ee=5*e.getLevelMaximumGeometricError(i),te=e._tilingScheme.tileXYToRectangle(o,a,i);return te.width<_.PI_OVER_TWO+_.EPSILON5&&($=v.fromRectangle(te,w,b,e._tilingScheme.ellipsoid)),new y({center:C,minimumHeight:w,maximumHeight:b,boundingSphere:E,orientedBoundingBox:$,horizonOcclusionPoint:S,quantizedVertices:D,encodedNormals:X,indices:k,westIndices:G,southIndices:H,eastIndices:q,northIndices:K,westSkirtHeight:ee,southSkirtHeight:ee,eastSkirtHeight:ee,northSkirtHeight:ee,childTileMask:function(t,n,r,i){var o=e._availableTiles;if(!o||0===o.length)return 15;var a=n+1;if(a>=o.length)return 0;var s=o[a],l=0;return l|=x(s,2*r,2*i)?1:0,l|=x(s,2*r+1,2*i)?2:0,(l|=x(s,2*r,2*i+1)?4:0)|(x(s,2*r+1,2*i+1)?8:0)}(0,i,o,s),waterMask:Z})}(E,t,s,e,i,p);var o,l,u})}},s(S.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){return this._hasVertexNormals&&this._requestVertexNormals}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}}}),S.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},S.prototype.getTileDataAvailable=function(e,t,n){var r=this._availableTiles;if(r&&0!==r.length)return!(n>=r.length)&&x(r[n],e,this._tilingScheme.getNumberOfYTilesAtLevel(n)-t-1)},S}),o("Core/EllipseGeometryLibrary",["./Cartesian3","./Math","./Matrix3","./Quaternion"],function(e,t,n,r){"use strict";function i(t,i,o,c,h,d,p,f,m,_){var g=t+i;e.multiplyByScalar(c,Math.cos(g),a),e.multiplyByScalar(o,Math.sin(g),s),e.add(a,s,a);var v=Math.cos(t);v*=v;var y=Math.sin(t);y*=y;var C=d/Math.sqrt(p*v+h*y);return r.fromAxisAngle(a,C/f,l),n.fromQuaternion(l,u),n.multiplyByVector(u,m,_),e.normalize(_,_),e.multiplyByScalar(_,f,_),_}var o={},a=new e,s=new e,l=new r,u=new n,c=new e,h=new e,d=new e,p=new e;o.raisePositionsToHeight=function(t,n,r){for(var i=n.ellipsoid,o=n.height,a=n.extrudedHeight,s=new Float64Array(3*(r?t.length/3*2:t.length/3)),l=t.length,u=r?l:0,f=0;f<l;f+=3){var m=f+1,_=f+2,g=e.fromArray(t,f,c);i.scaleToGeodeticSurface(g,g);var v=e.clone(g,h),y=i.geodeticSurfaceNormal(g,p),C=e.multiplyByScalar(y,o,d);e.add(g,C,g),r&&(e.multiplyByScalar(y,a,C),e.add(v,C,v),s[f+u]=v.x,s[m+u]=v.y,s[_+u]=v.z),s[f]=g.x,s[m]=g.y,s[_]=g.z}return s};var f=new e,m=new e,_=new e;return o.computeEllipsePositions=function(n,r,o){var a=n.semiMinorAxis,s=n.semiMajorAxis,l=n.rotation,u=n.center,p=8*n.granularity,g=a*a,v=s*s,y=s*a,C=e.magnitude(u),w=e.normalize(u,f),b=e.cross(e.UNIT_Z,u,m);b=e.normalize(b,b);var E=e.cross(w,b,_),S=1+Math.ceil(t.PI_OVER_TWO/p),x=t.PI_OVER_TWO/(S-1),T=t.PI_OVER_TWO-S*x;T<0&&(S-=Math.ceil(Math.abs(T)/x));var A,P,D,M,I,O=r?new Array(S*(S+2)*2*3):void 0,R=0,N=c,L=h,F=4*S*3,B=F-1,k=0,V=o?new Array(F):void 0;for(N=i(T=t.PI_OVER_TWO,l,E,b,g,y,v,C,w,N),r&&(O[R++]=N.x,O[R++]=N.y,O[R++]=N.z),o&&(V[B--]=N.z,V[B--]=N.y,V[B--]=N.x),T=t.PI_OVER_TWO-x,A=1;A<S+1;++A){if(N=i(T,l,E,b,g,y,v,C,w,N),L=i(Math.PI-T,l,E,b,g,y,v,C,w,L),r){for(O[R++]=N.x,O[R++]=N.y,O[R++]=N.z,D=2*A+2,P=1;P<D-1;++P)M=P/(D-1),I=e.lerp(N,L,M,d),O[R++]=I.x,O[R++]=I.y,O[R++]=I.z;O[R++]=L.x,O[R++]=L.y,O[R++]=L.z}o&&(V[B--]=N.z,V[B--]=N.y,V[B--]=N.x,V[k++]=L.x,V[k++]=L.y,V[k++]=L.z),T=t.PI_OVER_TWO-(A+1)*x}for(A=S;A>1;--A){if(N=i(-(T=t.PI_OVER_TWO-(A-1)*x),l,E,b,g,y,v,C,w,N),L=i(T+Math.PI,l,E,b,g,y,v,C,w,L),r){for(O[R++]=N.x,O[R++]=N.y,O[R++]=N.z,D=2*(A-1)+2,P=1;P<D-1;++P)M=P/(D-1),I=e.lerp(N,L,M,d),O[R++]=I.x,O[R++]=I.y,O[R++]=I.z;O[R++]=L.x,O[R++]=L.y,O[R++]=L.z}o&&(V[B--]=N.z,V[B--]=N.y,V[B--]=N.x,V[k++]=L.x,V[k++]=L.y,V[k++]=L.z)}N=i(-(T=t.PI_OVER_TWO),l,E,b,g,y,v,C,w,N);var z={};return r&&(O[R++]=N.x,O[R++]=N.y,O[R++]=N.z,z.positions=O,z.numPts=S),o&&(V[B--]=N.z,V[B--]=N.y,V[B--]=N.x,z.outerPositions=V),z},o}),o("Core/GeometryInstance",["./defaultValue","./defined","./DeveloperError","./Matrix4"],function(e,t,n,r){"use strict";return function(t){t=e(t,e.EMPTY_OBJECT),this.geometry=t.geometry,this.modelMatrix=r.clone(e(t.modelMatrix,r.IDENTITY)),this.id=t.id,this.pickPrimitive=t.pickPrimitive,this.attributes=e(t.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0}}),o("Core/EncodedCartesian3",["./Cartesian3","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(){this.high=e.clone(e.ZERO),this.low=e.clone(e.ZERO)}r.encode=function(e,n){var r;return t(n)||(n={high:0,low:0}),e>=0?(r=65536*Math.floor(e/65536),n.high=r,n.low=e-r):(r=65536*Math.floor(-e/65536),n.high=-r,n.low=e+r),n};var i={high:0,low:0};r.fromCartesian=function(e,n){t(n)||(n=new r);var o=n.high,a=n.low;return r.encode(e.x,i),o.x=i.high,a.x=i.low,r.encode(e.y,i),o.y=i.high,a.y=i.low,r.encode(e.z,i),o.z=i.high,a.z=i.low,n};var o=new r;return r.writeElements=function(e,t,n){r.fromCartesian(e,o);var i=o.high,a=o.low;t[n]=i.x,t[n+1]=i.y,t[n+2]=i.z,t[n+3]=a.x,t[n+4]=a.y,t[n+5]=a.z},r}),o("Core/Tipsify",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";var r={};return r.calculateACMR=function(n){var r=(n=e(n,e.EMPTY_OBJECT)).indices,i=n.maximumIndex,o=e(n.cacheSize,24),a=r.length;if(!t(i)){i=0;for(var s=0,l=r[s];s<a;)l>i&&(i=l),++s,l=r[s]}for(var u=[],c=0;c<i+1;c++)u[c]=0;for(var h=o+1,d=0;d<a;++d)h-u[r[d]]>o&&(u[r[d]]=h,++h);return(h-o+1)/(a/3)},r.tipsify=function(n){function r(e,t,n,r,o,a,s){for(var l,u=-1,c=-1,h=0;h<n.length;){var d=n[h];r[d].numLiveTriangles&&(l=0,o-r[d].timeStamp+2*r[d].numLiveTriangles<=t&&(l=o-r[d].timeStamp),(l>c||-1===c)&&(c=l,u=d)),++h}return-1===u?function(e,t,n,r){for(;t.length>=1;){var o=t[t.length-1];if(t.splice(t.length-1,1),e[o].numLiveTriangles>0)return o}for(;i<r;){if(e[i].numLiveTriangles>0)return++i,i-1;++i}return-1}(r,a,0,s):u}var i,o=(n=e(n,e.EMPTY_OBJECT)).indices,a=n.maximumIndex,s=e(n.cacheSize,24),l=o.length,u=0,c=0,h=o[c],d=l;if(t(a))u=a+1;else{for(;c<d;)h>u&&(u=h),++c,h=o[c];if(-1===u)return 0;++u}for(var p=[],f=0;f<u;f++)p[f]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};c=0;for(var m=0;c<d;)p[o[c]].vertexTriangles.push(m),++p[o[c]].numLiveTriangles,p[o[c+1]].vertexTriangles.push(m),++p[o[c+1]].numLiveTriangles,p[o[c+2]].vertexTriangles.push(m),++p[o[c+2]].numLiveTriangles,++m,c+=3;var _=0,g=s+1;i=1;var v,y,C,w,b=[],E=[],S=0,x=[],T=l/3,A=[];for(f=0;f<T;f++)A[f]=!1;for(;-1!==_;){b=[],w=(y=p[_]).vertexTriangles.length;for(var P=0;P<w;++P)if(m=y.vertexTriangles[P],!A[m]){A[m]=!0,c=m+m+m;for(var D=0;D<3;++D)C=o[c],b.push(C),E.push(C),x[S]=C,++S,v=p[C],--v.numLiveTriangles,g-v.timeStamp>s&&(v.timeStamp=g,++g),++c}_=r(0,s,b,p,g,E,u)}return x},r}),o("Core/GeometryPipeline",["./AttributeCompression","./barycentricCoordinates","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EncodedCartesian3","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryInstance","./GeometryType","./IndexDatatype","./Intersect","./IntersectionTests","./Math","./Matrix3","./Matrix4","./Plane","./PrimitiveType","./Tipsify"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e,t,n,r,i){e[t++]=n,e[t++]=r,e[t++]=r,e[t++]=i,e[t++]=i,e[t]=n}function A(e){var t={};for(var n in e)if(e.hasOwnProperty(n)&&u(e[n])&&u(e[n].values)){var r=e[n];t[n]=new f({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return t}function P(e,t,n){for(var r in t)if(t.hasOwnProperty(r)&&u(t[r])&&u(t[r].values))for(var i=t[r],o=0;o<i.componentsPerAttribute;++o)e[r].values.push(i.values[n*i.componentsPerAttribute+o])}function D(e,t){if(u(t))for(var n=t.values,r=n.length,o=0;o<r;o+=3)i.unpack(n,o,Y),b.multiplyByPoint(e,Y,Y),i.pack(Y,n,o)}function M(e,t){if(u(t))for(var n=t.values,r=n.length,o=0;o<r;o+=3)i.unpack(n,o,Y),w.multiplyByVector(e,Y,Y),Y=i.normalize(Y,Y),i.pack(Y,n,o)}function I(e,t){var r,o,a,l,c,h,d,m,_=e.length,v=u(e[0][t].indices),y=e[0][t].primitiveType,C=function(e,t){var n,r=e.length,i={},o=e[0][t].attributes;for(n in o)if(o.hasOwnProperty(n)&&u(o[n])&&u(o[n].values)){for(var a=o[n],l=a.values.length,c=!0,h=1;h<r;++h){var d=e[h][t].attributes[n];if(!u(d)||a.componentDatatype!==d.componentDatatype||a.componentsPerAttribute!==d.componentsPerAttribute||a.normalize!==d.normalize){c=!1;break}l+=d.values.length}c&&(i[n]=new f({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:s.createTypedArray(a.componentDatatype,l)}))}return i}(e,t);for(r in C)if(C.hasOwnProperty(r))for(c=C[r].values,l=0,o=0;o<_;++o)for(h=e[o][t].attributes[r].values,d=h.length,a=0;a<d;++a)c[l++]=h[a];if(v){var w=0;for(o=0;o<_;++o)w+=e[o][t].indices.length;var b=p.computeNumberOfVertices(new p({attributes:C,primitiveType:S.POINTS})),E=g.createTypedArray(b,w),x=0,T=0;for(o=0;o<_;++o){var A=e[o][t].indices,P=A.length;for(l=0;l<P;++l)E[x++]=T+A[l];T+=p.computeNumberOfVertices(e[o][t])}m=E}var D,M=new i,I=0;for(o=0;o<_;++o){if(!u(D=e[o][t].boundingSphere)){M=void 0;break}i.add(D.center,M,M)}if(u(M))for(i.divideByScalar(M,_,M),o=0;o<_;++o){var O=i.magnitude(i.subtract((D=e[o][t].boundingSphere).center,M,K))+D.radius;O>I&&(I=O)}return new p({attributes:C,indices:m,primitiveType:y,boundingSphere:u(M)?new n(M,I):void 0})}function O(e,t){Math.abs(e.y)<C.EPSILON6&&(e.y=t?-C.EPSILON6:C.EPSILON6)}function R(e,t,n,r){i.add(e,i.multiplyByScalar(i.subtract(t,e,le),e.y/(e.y-t.y),le),n),i.clone(n,r),O(n,!0),O(r,!1)}function N(e,t,n){if(!(e.x>=0||t.x>=0||n.x>=0)){!function(e,t,n){if(0!==e.y&&0!==t.y&&0!==n.y)return O(e,e.y<0),O(t,t.y<0),void O(n,n.y<0);var r=Math.abs(e.y),i=Math.abs(t.y),o=Math.abs(n.y),a=C.sign(r>i?r>o?e.y:n.y:i>o?t.y:n.y)<0;O(e,a),O(t,a),O(n,a)}(e,t,n);var r=e.y<0,i=t.y<0,o=n.y<0,a=0;a+=r?1:0,a+=i?1:0;var s=pe.indices;1===(a+=o?1:0)?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,r?(R(e,t,ue,he),R(e,n,ce,de),s[0]=0,s[3]=1,s[4]=2,s[6]=1):i?(R(t,n,ue,he),R(t,e,ce,de),s[0]=1,s[3]=2,s[4]=0,s[6]=2):o&&(R(n,e,ue,he),R(n,t,ce,de),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===a&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,r?i?o||(R(n,e,ue,he),R(n,t,ce,de),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(R(t,n,ue,he),R(t,e,ce,de),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(R(e,t,ue,he),R(e,n,ce,de),s[0]=1,s[1]=2,s[3]=1,s[6]=0));var l=pe.positions;return l[0]=e,l[1]=t,l[2]=n,l.length=3,1!==a&&2!==a||(l[3]=ue,l[4]=ce,l[5]=he,l[6]=de,l.length=7),pe}}function L(e,t){var r=e.attributes;if(0!==r.position.values.length){for(var i in r)if(r.hasOwnProperty(i)&&u(r[i])&&u(r[i].values)){var o=r[i];o.values=s.createTypedArray(o.componentDatatype,o.values)}var a=p.computeNumberOfVertices(e);return e.indices=g.createTypedArray(a,e.indices),t&&(e.boundingSphere=n.fromVertices(r.position.values)),e}}function F(e){var t=e.attributes,n={};for(var r in t)if(t.hasOwnProperty(r)&&u(t[r])&&u(t[r].values)){var i=t[r];n[r]=new f({componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,values:[]})}return new p({attributes:n,indices:[],primitiveType:e.primitiveType})}function B(e,t,n){var r=u(e.geometry.boundingSphere);t=L(t,r),n=L(n,r),u(n)&&!u(t)?e.geometry=n:!u(n)&&u(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=n,e.geometry=void 0)}function k(e,n,o,a,s,l,c,h,d,p,f){if(u(l)||u(c)||u(h)||u(d)){var m=i.fromArray(s,3*e,fe),_=i.fromArray(s,3*n,me),g=i.fromArray(s,3*o,_e),v=t(a,m,_,g,ge);if(u(l)){var y=i.fromArray(l,3*e,fe),C=i.fromArray(l,3*n,me),w=i.fromArray(l,3*o,_e);i.multiplyByScalar(y,v.x,y),i.multiplyByScalar(C,v.y,C),i.multiplyByScalar(w,v.z,w);var b=i.add(y,C,y);i.add(b,w,b),i.normalize(b,b),i.pack(b,p.normal.values,3*f)}if(u(c)){var E=i.fromArray(c,3*e,fe),S=i.fromArray(c,3*n,me),x=i.fromArray(c,3*o,_e);i.multiplyByScalar(E,v.x,E),i.multiplyByScalar(S,v.y,S),i.multiplyByScalar(x,v.z,x);var T=i.add(E,S,E);i.add(T,x,T),i.normalize(T,T),i.pack(T,p.binormal.values,3*f)}if(u(h)){var A=i.fromArray(h,3*e,fe),P=i.fromArray(h,3*n,me),D=i.fromArray(h,3*o,_e);i.multiplyByScalar(A,v.x,A),i.multiplyByScalar(P,v.y,P),i.multiplyByScalar(D,v.z,D);var M=i.add(A,P,A);i.add(M,D,M),i.normalize(M,M),i.pack(M,p.tangent.values,3*f)}if(u(d)){var I=r.fromArray(d,2*e,ve),O=r.fromArray(d,2*n,ye),R=r.fromArray(d,2*o,Ce);r.multiplyByScalar(I,v.x,I),r.multiplyByScalar(O,v.y,O),r.multiplyByScalar(R,v.z,R);var N=r.add(I,O,I);r.add(N,R,N),r.pack(N,p.st.values,2*f)}}}function V(e,t,n,r,i,o){var a=e.position.values.length/3;if(-1!==i){var s=r[i],l=n[s];return-1===l?(n[s]=a,e.position.values.push(o.x,o.y,o.z),t.push(a),a):(t.push(l),l)}return e.position.values.push(o.x,o.y,o.z),t.push(a),a}function z(e){var t,n,r,o,a,s=e.geometry,l=s.attributes,c=l.position.values,h=u(l.normal)?l.normal.values:void 0,d=u(l.binormal)?l.binormal.values:void 0,p=u(l.tangent)?l.tangent.values:void 0,f=u(l.st)?l.st.values:void 0,m=s.indices,_=F(s),g=F(s),v=[];v.length=c.length/3;var y=[];for(y.length=c.length/3,a=0;a<v.length;++a)v[a]=-1,y[a]=-1;var C=m.length;for(a=0;a<C;a+=3){var w=m[a],b=m[a+1],E=m[a+2],S=i.fromArray(c,3*w),x=i.fromArray(c,3*b),T=i.fromArray(c,3*E),A=N(S,x,T);if(u(A)&&A.positions.length>3)for(var P=A.positions,D=A.indices,M=D.length,I=0;I<M;++I){var O=D[I],R=P[O];R.y<0?(t=g.attributes,n=g.indices,r=v):(t=_.attributes,n=_.indices,r=y),k(w,b,E,R,c,h,d,p,f,t,o=V(t,n,r,m,O<3?a+O:-1,R))}else u(A)&&(S=A.positions[0],x=A.positions[1],T=A.positions[2]),S.y<0?(t=g.attributes,n=g.indices,r=v):(t=_.attributes,n=_.indices,r=y),o=V(t,n,r,m,a,S),k(w,b,E,S,c,h,d,p,f,t,o),o=V(t,n,r,m,a+1,x),k(w,b,E,x,c,h,d,p,f,t,o),o=V(t,n,r,m,a+2,T),k(w,b,E,T,c,h,d,p,f,t,o)}B(e,g,_)}function U(e){var t,n=e.geometry,r=n.attributes.position.values,o=n.indices,a=F(n),s=F(n),l=o.length,c=[];c.length=r.length/3;var h=[];for(h.length=r.length/3,t=0;t<c.length;++t)c[t]=-1,h[t]=-1;for(t=0;t<l;t+=2){var d=o[t+1],p=i.fromArray(r,3*o[t],fe),f=i.fromArray(r,3*d,me);Math.abs(p.y)<C.EPSILON6&&(p.y=p.y<0?-C.EPSILON6:C.EPSILON6),Math.abs(f.y)<C.EPSILON6&&(f.y=f.y<0?-C.EPSILON6:C.EPSILON6);var m=a.attributes,_=a.indices,g=h,v=s.attributes,w=s.indices,b=c,E=y.lineSegmentPlane(p,f,we,_e);if(u(E)){var S=i.multiplyByScalar(i.UNIT_Y,5*C.EPSILON9,be);p.y<0&&(i.negate(S,S),m=s.attributes,_=s.indices,g=c,v=a.attributes,w=a.indices,b=h);var x=i.add(E,S,Ee);V(m,_,g,o,t,p),V(m,_,g,o,-1,x),i.negate(S,S),i.add(E,S,x),V(v,w,b,o,-1,x),V(v,w,b,o,t+1,f)}else{var T,A,P;p.y<0?(T=s.attributes,A=s.indices,P=c):(T=a.attributes,A=a.indices,P=h),V(T,A,P,o,t,p),V(T,A,P,o,t+1,f)}}B(e,s,a)}function G(e){for(var t=e.attributes,n=t.position.values,r=t.prevPosition.values,o=t.nextPosition.values,a=n.length,s=0;s<a;s+=3){var l=i.unpack(n,s,Te);if(!(l.x>0)){var u=i.unpack(r,s,Ae);(l.y<0&&u.y>0||l.y>0&&u.y<0)&&(s-3>0?(r[s]=n[s-3],r[s+1]=n[s-2],r[s+2]=n[s-1]):i.pack(l,r,s));var c=i.unpack(o,s,Pe);(l.y<0&&c.y>0||l.y>0&&c.y<0)&&(s+3<a?(o[s]=n[s+3],o[s+1]=n[s+4],o[s+2]=n[s+5]):i.pack(l,o,s))}}}var W={};W.toWireframe=function(e){var t=e.indices;if(u(t)){switch(e.primitiveType){case S.TRIANGLES:e.indices=function(e){for(var t=e.length,n=g.createTypedArray(t,t/3*6),r=0,i=0;i<t;i+=3,r+=6)T(n,r,e[i],e[i+1],e[i+2]);return n}(t);break;case S.TRIANGLE_STRIP:e.indices=function(e){var t=e.length;if(t>=3){var n=g.createTypedArray(t,6*(t-2));T(n,0,e[0],e[1],e[2]);for(var r=6,i=3;i<t;++i,r+=6)T(n,r,e[i-1],e[i],e[i-2]);return n}return new Uint16Array}(t);break;case S.TRIANGLE_FAN:e.indices=function(e){if(e.length>0){for(var t=e.length-1,n=g.createTypedArray(t,6*(t-1)),r=e[0],i=0,o=1;o<t;++o,i+=6)T(n,i,r,e[o],e[o+1]);return n}return new Uint16Array}(t)}e.primitiveType=S.LINES}return e},W.createLineSegmentsForVectors=function(e,t,r){t=l(t,"normal"),r=l(r,1e4);for(var i=e.attributes.position.values,o=e.attributes[t].values,a=i.length,c=new Float64Array(2*a),h=0,d=0;d<a;d+=3)c[h++]=i[d],c[h++]=i[d+1],c[h++]=i[d+2],c[h++]=i[d]+o[d]*r,c[h++]=i[d+1]+o[d+1]*r,c[h++]=i[d+2]+o[d+2]*r;var m,_=e.boundingSphere;return u(_)&&(m=new n(_.center,_.radius+r)),new p({attributes:{position:new f({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:c})},primitiveType:S.LINES,boundingSphere:m})},W.createAttributeLocations=function(e){var t,n=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","binormal","tangent","compressedAttributes"],r=e.attributes,i={},o=0,a=n.length;for(t=0;t<a;++t){var s=n[t];u(r[s])&&(i[s]=o++)}for(var l in r)r.hasOwnProperty(l)&&!u(i[l])&&(i[l]=o++);return i},W.reorderForPreVertexCache=function(e){var t=p.computeNumberOfVertices(e),n=e.indices;if(u(n)){for(var r=new Int32Array(t),i=0;i<t;i++)r[i]=-1;for(var o,a=n,l=a.length,c=g.createTypedArray(t,l),h=0,d=0,f=0;h<l;)o=r[a[h]],-1!==o?c[d]=o:(o=a[h],r[o]=f,c[d]=f,++f),++h,++d;e.indices=c;var m=e.attributes;for(var _ in m)if(m.hasOwnProperty(_)&&u(m[_])&&u(m[_].values)){for(var v=m[_],y=v.values,C=0,w=v.componentsPerAttribute,b=s.createTypedArray(v.componentDatatype,f*w);C<t;){var E=r[C];if(-1!==E)for(i=0;i<w;i++)b[w*E+i]=y[w*C+i];++C}v.values=b}}return e},W.reorderForPostVertexCache=function(e,t){var n=e.indices;if(e.primitiveType===S.TRIANGLES&&u(n)){for(var r=n.length,i=0,o=0;o<r;o++)n[o]>i&&(i=n[o]);e.indices=x.tipsify({indices:n,maximumIndex:i,cacheSize:t})}return e},W.fitToUnsignedShortIndices=function(e){var t=[],n=p.computeNumberOfVertices(e);if(u(e.indices)&&n>=C.SIXTY_FOUR_KILOBYTES){var r,i=[],o=[],a=0,s=A(e.attributes),l=e.indices,c=l.length;e.primitiveType===S.TRIANGLES?r=3:e.primitiveType===S.LINES?r=2:e.primitiveType===S.POINTS&&(r=1);for(var h=0;h<c;h+=r){for(var d=0;d<r;++d){var f=l[h+d],m=i[f];u(m)||(m=a++,i[f]=m,P(s,e.attributes,f)),o.push(m)}a+r>=C.SIXTY_FOUR_KILOBYTES&&(t.push(new p({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),i=[],o=[],a=0,s=A(e.attributes))}0!==o.length&&t.push(new p({attributes:s,indices:o,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var H=new i,j=new a;W.projectTo2D=function(e,t,n,r,o){for(var a=e.attributes[t],l=(o=u(o)?o:new d).ellipsoid,c=a.values,h=new Float64Array(c.length),p=0,m=0;m<c.length;m+=3){var _=i.fromArray(c,m,H),g=l.cartesianToCartographic(_,j),v=o.project(g,H);h[p++]=v.x,h[p++]=v.y,h[p++]=v.z}return e.attributes[n]=a,e.attributes[r]=new f({componentDatatype:s.DOUBLE,componentsPerAttribute:3,values:h}),delete e.attributes[t],e};var q={high:0,low:0};W.encodeAttribute=function(e,t,n,r){for(var i=e.attributes[t],o=i.values,a=o.length,l=new Float32Array(a),u=new Float32Array(a),c=0;c<a;++c)h.encode(o[c],q),l[c]=q.high,u[c]=q.low;var d=i.componentsPerAttribute;return e.attributes[n]=new f({componentDatatype:s.FLOAT,componentsPerAttribute:d,values:l}),e.attributes[r]=new f({componentDatatype:s.FLOAT,componentsPerAttribute:d,values:u}),delete e.attributes[t],e};var Y=new i,X=new b,Z=new w;W.transformToWorldCoordinates=function(e){var t=e.modelMatrix;if(b.equals(t,b.IDENTITY))return e;var r=e.geometry.attributes;D(t,r.position),D(t,r.prevPosition),D(t,r.nextPosition),(u(r.normal)||u(r.binormal)||u(r.tangent))&&(b.inverse(t,X),b.transpose(X,X),b.getRotation(X,Z),M(Z,r.normal),M(Z,r.binormal),M(Z,r.tangent));var i=e.geometry.boundingSphere;return u(i)&&(e.geometry.boundingSphere=n.transform(i,t,i)),e.modelMatrix=b.clone(b.IDENTITY),e};var K=new i;W.combineInstances=function(e){for(var t=[],n=[],r=e.length,i=0;i<r;++i){var o=e[i];u(o.geometry)?t.push(o):u(o.westHemisphereGeometry)&&u(o.eastHemisphereGeometry)&&n.push(o)}var a=[];return t.length>0&&a.push(I(t,"geometry")),n.length>0&&(a.push(I(n,"westHemisphereGeometry")),a.push(I(n,"eastHemisphereGeometry"))),a};var Q=new i,J=new i,$=new i,ee=new i;W.computeNormal=function(e){for(var t=e.indices,n=e.attributes,r=n.position.values,o=n.position.values.length/3,a=t.length,l=new Array(o),u=new Array(a/3),c=new Array(a),h=0;h<o;h++)l[h]={indexOffset:0,count:0,currentCount:0};var d=0;for(h=0;h<a;h+=3){var p=t[h],m=t[h+1],_=t[h+2],g=3*p,v=3*m,y=3*_;J.x=r[g],J.y=r[g+1],J.z=r[g+2],$.x=r[v],$.y=r[v+1],$.z=r[v+2],ee.x=r[y],ee.y=r[y+1],ee.z=r[y+2],l[p].count++,l[m].count++,l[_].count++,i.subtract($,J,$),i.subtract(ee,J,ee),u[d]=i.cross($,ee,new i),d++}var C,w=0;for(h=0;h<o;h++)l[h].indexOffset+=w,w+=l[h].count;for(d=0,h=0;h<a;h+=3){var b=(C=l[t[h]]).indexOffset+C.currentCount;c[b]=d,C.currentCount++,c[b=(C=l[t[h+1]]).indexOffset+C.currentCount]=d,C.currentCount++,c[b=(C=l[t[h+2]]).indexOffset+C.currentCount]=d,C.currentCount++,d++}var E=new Float32Array(3*o);for(h=0;h<o;h++){var S=3*h;if((C=l[h]).count>0){for(i.clone(i.ZERO,Q),d=0;d<C.count;d++)i.add(Q,u[c[C.indexOffset+d]],Q);i.normalize(Q,Q),E[S]=Q.x,E[S+1]=Q.y,E[S+2]=Q.z}else E[S]=0,E[S+1]=0,E[S+2]=1}return e.attributes.normal=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:E}),e};var te=new i,ne=new i,re=new i;W.computeBinormalAndTangent=function(e){for(var t=e.indices,n=e.attributes.position.values,r=e.attributes.normal.values,o=e.attributes.st.values,a=e.attributes.position.values.length/3,l=t.length,u=new Array(3*a),c=0;c<u.length;c++)u[c]=0;var h,d,p;for(c=0;c<l;c+=3){var m=t[c],_=t[c+1],g=t[c+2],v=2*m,y=2*_,C=2*g,w=n[h=3*m],b=n[h+1],E=n[h+2],S=o[v],x=o[v+1],T=o[y+1]-x,A=o[C+1]-x,P=1/((o[y]-S)*A-(o[C]-S)*T),D=(A*(n[d=3*_]-w)-T*(n[p=3*g]-w))*P,M=(A*(n[d+1]-b)-T*(n[p+1]-b))*P,I=(A*(n[d+2]-E)-T*(n[p+2]-E))*P;u[h]+=D,u[h+1]+=M,u[h+2]+=I,u[d]+=D,u[d+1]+=M,u[d+2]+=I,u[p]+=D,u[p+1]+=M,u[p+2]+=I}var O=new Float32Array(3*a),R=new Float32Array(3*a);for(c=0;c<a;c++){d=1+(h=3*c),p=h+2;var N=i.fromArray(r,h,te),L=i.fromArray(u,h,re),F=i.dot(N,L);i.multiplyByScalar(N,F,ne),i.normalize(i.subtract(L,ne,L),L),R[h]=L.x,R[d]=L.y,R[p]=L.z,i.normalize(i.cross(N,L,L),L),O[h]=L.x,O[d]=L.y,O[p]=L.z}return e.attributes.tangent=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:R}),e.attributes.binormal=new f({componentDatatype:s.FLOAT,componentsPerAttribute:3,values:O}),e};var ie=new r,oe=new i,ae=new i,se=new i;W.compressVertices=function(t){var n=t.attributes.normal,o=t.attributes.st;if(!u(n)&&!u(o))return t;var a,l,c,h,d=t.attributes.tangent,p=t.attributes.binormal;u(n)&&(a=n.values),u(o)&&(l=o.values),u(d)&&(c=d.values),p&&(h=p.values);var m=(u(a)?a.length:l.length)/(u(a)?3:2),_=m,g=u(l)&&u(a)?2:1;g+=u(c)||u(h)?1:0;for(var v=new Float32Array(_*=g),y=0,C=0;C<m;++C){u(l)&&(r.fromArray(l,2*C,ie),v[y++]=e.compressTextureCoordinates(ie));var w=3*C;u(a)&&u(c)&&u(h)?(i.fromArray(a,w,oe),i.fromArray(c,w,ae),i.fromArray(h,w,se),e.octPack(oe,ae,se,ie),v[y++]=ie.x,v[y++]=ie.y):(u(a)&&(i.fromArray(a,w,oe),v[y++]=e.octEncodeFloat(oe)),u(c)&&(i.fromArray(c,w,oe),v[y++]=e.octEncodeFloat(oe)),u(h)&&(i.fromArray(h,w,oe),v[y++]=e.octEncodeFloat(oe)))}return t.attributes.compressedAttributes=new f({componentDatatype:s.FLOAT,componentsPerAttribute:g,values:v}),u(a)&&delete t.attributes.normal,u(l)&&delete t.attributes.st,u(c)&&delete t.attributes.tangent,u(h)&&delete t.attributes.binormal,t};var le=new i,ue=new i,ce=new i,he=new i,de=new i,pe={positions:new Array(7),indices:new Array(9)},fe=new i,me=new i,_e=new i,ge=new i,ve=new r,ye=new r,Ce=new r,we=E.fromPointNormal(i.ZERO,i.UNIT_Y),be=new i,Ee=new i,Se=new r,xe=new r,Te=new i,Ae=new i,Pe=new i,De=new i,Me=new i,Ie=new i,Oe=new o,Re=5*C.EPSILON9,Ne=C.EPSILON6;return W.splitLongitude=function(e){var t=e.geometry,a=t.boundingSphere;if(u(a)&&(a.center.x-a.radius>0||n.intersectPlane(a,E.ORIGIN_ZX_PLANE)!==v.INTERSECTING))return e;if(t.geometryType!==_.NONE)switch(t.geometryType){case _.POLYLINES:!function(e){var t,n,a,s=e.geometry,l=s.attributes,c=l.position.values,h=l.prevPosition.values,d=l.nextPosition.values,p=l.expandAndWidth.values,f=u(l.st)?l.st.values:void 0,m=u(l.color)?l.color.values:void 0,_=F(s),g=F(s),v=!1,w=c.length/3;for(t=0;t<w;t+=4){var b=t,E=t+2,S=i.fromArray(c,3*b,Te),x=i.fromArray(c,3*E,Ae);if(Math.abs(S.y)<Ne)for(S.y=Ne*(x.y<0?-1:1),c[3*t+1]=S.y,c[3*(t+1)+1]=S.y,n=3*b;n<3*b+12;n+=3)h[n]=c[3*t],h[n+1]=c[3*t+1],h[n+2]=c[3*t+2];if(Math.abs(x.y)<Ne)for(x.y=Ne*(S.y<0?-1:1),c[3*(t+2)+1]=x.y,c[3*(t+3)+1]=x.y,n=3*b;n<3*b+12;n+=3)d[n]=c[3*(t+2)],d[n+1]=c[3*(t+2)+1],d[n+2]=c[3*(t+2)+2];var T=_.attributes,A=_.indices,P=g.attributes,D=g.indices,M=y.lineSegmentPlane(S,x,we,De);if(u(M)){v=!0;var I=i.multiplyByScalar(i.UNIT_Y,Re,Me);S.y<0&&(i.negate(I,I),T=g.attributes,A=g.indices,P=_.attributes,D=_.indices);var O=i.add(M,I,Ie);T.position.values.push(S.x,S.y,S.z,S.x,S.y,S.z),T.position.values.push(O.x,O.y,O.z),T.position.values.push(O.x,O.y,O.z),T.prevPosition.values.push(h[3*b],h[3*b+1],h[3*b+2]),T.prevPosition.values.push(h[3*b+3],h[3*b+4],h[3*b+5]),T.prevPosition.values.push(S.x,S.y,S.z,S.x,S.y,S.z),T.nextPosition.values.push(O.x,O.y,O.z),T.nextPosition.values.push(O.x,O.y,O.z),T.nextPosition.values.push(O.x,O.y,O.z),T.nextPosition.values.push(O.x,O.y,O.z),i.negate(I,I),i.add(M,I,O),P.position.values.push(O.x,O.y,O.z),P.position.values.push(O.x,O.y,O.z),P.position.values.push(x.x,x.y,x.z,x.x,x.y,x.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.nextPosition.values.push(x.x,x.y,x.z,x.x,x.y,x.z),P.nextPosition.values.push(d[3*E],d[3*E+1],d[3*E+2]),P.nextPosition.values.push(d[3*E+3],d[3*E+4],d[3*E+5]);var R=r.fromArray(p,2*b,Se),N=Math.abs(R.y);T.expandAndWidth.values.push(-1,N,1,N),T.expandAndWidth.values.push(-1,-N,1,-N),P.expandAndWidth.values.push(-1,N,1,N),P.expandAndWidth.values.push(-1,-N,1,-N);var L=i.magnitudeSquared(i.subtract(M,S,Pe));if(L/=i.magnitudeSquared(i.subtract(x,S,Pe)),u(m)){var k=o.fromArray(m,4*b,Oe),V=o.fromArray(m,4*E,Oe),z=C.lerp(k.x,V.x,L),U=C.lerp(k.y,V.y,L),W=C.lerp(k.z,V.z,L),H=C.lerp(k.w,V.w,L);for(n=4*b;n<4*b+8;++n)T.color.values.push(m[n]);for(T.color.values.push(z,U,W,H),T.color.values.push(z,U,W,H),P.color.values.push(z,U,W,H),P.color.values.push(z,U,W,H),n=4*E;n<4*E+8;++n)P.color.values.push(m[n])}if(u(f)){var j=r.fromArray(f,2*b,Se),q=r.fromArray(f,2*(t+3),xe),Y=C.lerp(j.x,q.x,L);for(n=2*b;n<2*b+4;++n)T.st.values.push(f[n]);for(T.st.values.push(Y,j.y),T.st.values.push(Y,q.y),P.st.values.push(Y,j.y),P.st.values.push(Y,q.y),n=2*E;n<2*E+4;++n)P.st.values.push(f[n])}A.push(a=T.position.values.length/3-4,a+2,a+1),A.push(a+1,a+2,a+3),D.push(a=P.position.values.length/3-4,a+2,a+1),D.push(a+1,a+2,a+3)}else{var X,Z;for(S.y<0?(X=g.attributes,Z=g.indices):(X=_.attributes,Z=_.indices),X.position.values.push(S.x,S.y,S.z),X.position.values.push(S.x,S.y,S.z),X.position.values.push(x.x,x.y,x.z),X.position.values.push(x.x,x.y,x.z),n=3*t;n<3*t+12;++n)X.prevPosition.values.push(h[n]),X.nextPosition.values.push(d[n]);for(n=2*t;n<2*t+8;++n)X.expandAndWidth.values.push(p[n]),u(f)&&X.st.values.push(f[n]);if(u(m))for(n=4*t;n<4*t+16;++n)X.color.values.push(m[n]);Z.push(a=X.position.values.length/3-4,a+2,a+1),Z.push(a+1,a+2,a+3)}}v&&(G(g),G(_)),B(e,g,_)}(e);break;case _.TRIANGLES:z(e);break;case _.LINES:U(e)}else(function(e){switch(e.primitiveType){case S.TRIANGLE_FAN:return function(e){var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,3*(t-2));n[0]=1,n[1]=0,n[2]=2;for(var r=3,i=3;i<t;++i)n[r++]=i-1,n[r++]=0,n[r++]=i;return e.indices=n,e.primitiveType=S.TRIANGLES,e}(e);case S.TRIANGLE_STRIP:return function(e){var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,3*(t-2));n[0]=0,n[1]=1,n[2]=2,t>3&&(n[3]=0,n[4]=2,n[5]=3);for(var r=6,i=3;i<t-1;i+=2)n[r++]=i,n[r++]=i-1,n[r++]=i+1,i+2<t&&(n[r++]=i,n[r++]=i+1,n[r++]=i+2);return e.indices=n,e.primitiveType=S.TRIANGLES,e}(e);case S.TRIANGLES:return function(e){if(u(e.indices))return e;for(var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;return e.indices=n,e}(e);case S.LINE_STRIP:return function(e){var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,2*(t-1));n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return e.indices=n,e.primitiveType=S.LINES,e}(e);case S.LINE_LOOP:return function(e){var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,2*t);n[0]=0,n[1]=1;for(var r=2,i=2;i<t;++i)n[r++]=i-1,n[r++]=i;return n[r++]=t-1,n[r]=0,e.indices=n,e.primitiveType=S.LINES,e}(e);case S.LINES:(function(e){if(u(e.indices))return e;for(var t=p.computeNumberOfVertices(e),n=g.createTypedArray(t,t),r=0;r<t;++r)n[r]=r;e.indices=n})(e)}})(t),t.primitiveType===S.TRIANGLES?z(e):t.primitiveType===S.LINES&&U(e);return e},W}),o("Core/EllipseGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./GeographicProjection","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./Matrix4","./PrimitiveType","./Quaternion","./Rectangle","./Transforms","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e,r,o){var a=r.vertexFormat,s=r.center,l=r.semiMajorAxis,c=r.semiMinorAxis,d=r.ellipsoid,m=r.stRotation,_=o?e.length/3*2:e.length/3,g=a.st?new Float32Array(2*_):void 0,v=a.normal?new Float32Array(3*_):void 0,C=a.tangent?new Float32Array(3*_):void 0,w=a.binormal?new Float32Array(3*_):void 0,E=0,S=F,x=B,T=k,A=new h(d),P=A.project(d.cartesianToCartographic(s,V),z),O=d.scaleToGeodeticSurface(s,D);d.geodeticSurfaceNormal(O,O);for(var W=b.fromAxisAngle(O,m,L),H=y.fromQuaternion(W,N),j=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,U),q=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,G),Y=e.length,X=o?Y:0,Z=X/3*2,K=0;K<Y;K+=3){var Q=K+1,J=K+2,$=n.fromArray(e,K,D);if(a.st){var ee=y.multiplyByVector(H,$,M),te=A.project(d.cartesianToCartographic(ee,V),I);n.subtract(te,P,te),R.x=(te.x+l)/(2*l),R.y=(te.y+c)/(2*c),j.x=Math.min(R.x,j.x),j.y=Math.min(R.y,j.y),q.x=Math.max(R.x,q.x),q.y=Math.max(R.y,q.y),o&&(g[E+Z]=R.x,g[E+1+Z]=R.y),g[E++]=R.x,g[E++]=R.y}S=d.geodeticSurfaceNormal($,S),(a.normal||a.tangent||a.binormal)&&((a.tangent||a.binormal)&&(x=n.normalize(n.cross(n.UNIT_Z,S,x),x),y.multiplyByVector(H,x,x)),a.normal&&(v[K]=S.x,v[Q]=S.y,v[J]=S.z,o&&(v[K+X]=-S.x,v[Q+X]=-S.y,v[J+X]=-S.z)),a.tangent&&(C[K]=x.x,C[Q]=x.y,C[J]=x.z,o&&(C[K+X]=-x.x,C[Q+X]=-x.y,C[J+X]=-x.z)),a.binormal&&(T=n.normalize(n.cross(S,x,T),T),w[K]=T.x,w[Q]=T.y,w[J]=T.z,o&&(w[K+X]=T.x,w[Q+X]=T.y,w[J+X]=T.z)))}if(a.st){Y=g.length;for(var ne=0;ne<Y;ne+=2)g[ne]=(g[ne]-j.x)/(q.x-j.x),g[ne+1]=(g[ne+1]-j.y)/(q.y-j.y)}var re=new f;if(a.position){var ie=u.raisePositionsToHeight(e,r,o);re.position=new p({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:ie})}return a.st&&(re.st=new p({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:g})),a.normal&&(re.normal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:v})),a.tangent&&(re.tangent=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:C})),a.binormal&&(re.binormal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:w})),re}function A(e){var t,n,r,i,o,a=new Array(e*(e+1)*12-6),s=0;for(t=0,r=1,i=0;i<3;i++)a[s++]=r++,a[s++]=t,a[s++]=r;for(i=2;i<e+1;++i){for(r=i*(i+1)-1,t=(i-1)*i-1,a[s++]=r++,a[s++]=t,a[s++]=r,n=2*i,o=0;o<n-1;++o)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;a[s++]=r++,a[s++]=t,a[s++]=r}for(n=2*e,++r,++t,i=0;i<n-1;++i)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;for(a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t++,a[s++]=t,++t,i=e-1;i>1;--i){for(a[s++]=t++,a[s++]=t,a[s++]=r,n=2*i,o=0;o<n-1;++o)a[s++]=r,a[s++]=t++,a[s++]=t,a[s++]=r++,a[s++]=t,a[s++]=r;a[s++]=t++,a[s++]=t++,a[s++]=r++}for(i=0;i<3;i++)a[s++]=t++,a[s++]=t,a[s++]=r;return a}function P(e){var t=(e=o(e,o.EMPTY_OBJECT)).center,r=o(e.ellipsoid,c.WGS84),i=e.semiMajorAxis,s=e.semiMinorAxis,l=o(e.granularity,v.RADIANS_PER_DEGREE),u=o(e.height,0),h=e.extrudedHeight,d=a(h)&&Math.abs(u-h)>1,p=o(e.vertexFormat,x.DEFAULT);this._center=n.clone(t),this._semiMajorAxis=i,this._semiMinorAxis=s,this._ellipsoid=c.clone(r),this._rotation=o(e.rotation,0),this._stRotation=o(e.stRotation,0),this._height=u,this._granularity=l,this._vertexFormat=x.clone(p),this._extrudedHeight=o(h,u),this._extrude=d,this._workerName="createEllipseGeometry",this._rectangle=function(e,t,r,i,o){S.eastNorthUpToFixedFrame(e,t,q),C.inverseTransformation(q,Y);for(var a=0;a<4;++a)n.clone(n.ZERO,Z[a]);for(Z[0].x+=r,Z[1].x-=r,Z[2].y+=i,Z[3].y-=i,y.fromRotationZ(o,X),a=0;a<4;++a)y.multiplyByVector(X,Z[a],Z[a]),C.multiplyByPoint(q,Z[a],Z[a]),t.cartesianToCartographic(Z[a],K[a]);return E.fromCartographicArray(K)}(this._center,this._ellipsoid,i,s,this._rotation)}var D=new n,M=new n,I=new n,O=new n,R=new t,N=new y,L=new b,F=new n,B=new n,k=new n,V=new r,z=new n,U=new t,G=new t,W=new n,H=new e,j=new e,q=new C,Y=new C,X=new y,Z=[new n,new n,new n,new n],K=[new r,new r,new r,new r];P.packedLength=n.packedLength+c.packedLength+x.packedLength+E.packedLength+8,P.pack=function(e,t,r){return r=o(r,0),n.pack(e._center,t,r),c.pack(e._ellipsoid,t,r+=n.packedLength),x.pack(e._vertexFormat,t,r+=c.packedLength),E.pack(e._rectangle,t,r+=x.packedLength),r+=E.packedLength,t[r++]=e._semiMajorAxis,t[r++]=e._semiMinorAxis,t[r++]=e._rotation,t[r++]=e._stRotation,t[r++]=e._height,t[r++]=e._granularity,t[r++]=e._extrudedHeight,t[r]=e._extrude?1:0,t};var Q=new n,J=new c,$=new x,ee=new E,te={center:Q,ellipsoid:J,vertexFormat:$,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0};return P.unpack=function(e,t,r){t=o(t,0);var i=n.unpack(e,t,Q),s=c.unpack(e,t+=n.packedLength,J),l=x.unpack(e,t+=c.packedLength,$),u=E.unpack(e,t+=x.packedLength,ee);t+=E.packedLength;var h=e[t++],d=e[t++],p=e[t++],f=e[t++],m=e[t++],_=e[t++],g=e[t++],v=1===e[t];return a(r)?(r._center=n.clone(i,r._center),r._ellipsoid=c.clone(s,r._ellipsoid),r._vertexFormat=x.clone(l,r._vertexFormat),r._semiMajorAxis=h,r._semiMinorAxis=d,r._rotation=p,r._stRotation=f,r._height=m,r._granularity=_,r._extrudedHeight=g,r._extrude=v,r._rectangle=E.clone(u),r):(te.height=m,te.extrudedHeight=g,te.granularity=_,te.stRotation=f,te.rotation=p,te.semiMajorAxis=h,te.semiMinorAxis=d,new P(te))},P.createGeometry=function(r){if(!(r._semiMajorAxis<=0||r._semiMinorAxis<=0)){r._center=r._ellipsoid.scaleToGeodeticSurface(r._center,r._center);var o,a={center:r._center,semiMajorAxis:r._semiMajorAxis,semiMinorAxis:r._semiMinorAxis,ellipsoid:r._ellipsoid,rotation:r._rotation,height:r._height,extrudedHeight:r._extrudedHeight,granularity:r._granularity,vertexFormat:r._vertexFormat,stRotation:r._stRotation};return r._extrude?(a.extrudedHeight=Math.min(r._extrudedHeight,r._height),a.height=Math.max(r._extrudedHeight,r._height),o=function(r){var o=r.center,a=r.ellipsoid,s=r.semiMajorAxis,l=n.multiplyByScalar(a.geodeticSurfaceNormal(o,D),r.height,D);H.center=n.add(o,l,H.center),H.radius=s,l=n.multiplyByScalar(a.geodeticSurfaceNormal(o,l),r.extrudedHeight,l),j.center=n.add(o,l,j.center),j.radius=s;var c=u.computeEllipsePositions(r,!0,!0),v=c.positions,C=c.numPts,E=c.outerPositions,S=e.union(H,j),x=T(v,r,!0),P=A(C),W=P.length;P.length=2*W;for(var q=v.length/3,Y=0;Y<W;Y+=3)P[Y+W]=P[Y+2]+q,P[Y+1+W]=P[Y+1]+q,P[Y+2+W]=P[Y]+q;var X=g.createTypedArray(2*q/3,P),Z=new d({attributes:x,indices:X,primitiveType:w.TRIANGLES}),K=function(e,o){var a=r.vertexFormat,s=r.center,l=r.semiMajorAxis,u=r.semiMinorAxis,c=r.ellipsoid,d=r.height,m=r.extrudedHeight,_=r.stRotation,g=e.length/3*2,v=new Float64Array(3*g),C=a.st?new Float32Array(2*g):void 0,w=a.normal?new Float32Array(3*g):void 0,E=a.tangent?new Float32Array(3*g):void 0,S=a.binormal?new Float32Array(3*g):void 0,x=0,T=F,A=B,P=k,W=new h(c),H=W.project(c.cartesianToCartographic(s,V),z),j=c.scaleToGeodeticSurface(s,D);c.geodeticSurfaceNormal(j,j);for(var q=b.fromAxisAngle(j,_,L),Y=y.fromQuaternion(q,N),X=t.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,U),Z=t.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,G),K=e.length,Q=K/3*2,J=0;J<K;J+=3){var $,ee=J+1,te=J+2,ne=n.fromArray(e,J,D);if(a.st){var re=y.multiplyByVector(Y,ne,M),ie=W.project(c.cartesianToCartographic(re,V),I);n.subtract(ie,H,ie),R.x=(ie.x+l)/(2*l),R.y=(ie.y+u)/(2*u),X.x=Math.min(R.x,X.x),X.y=Math.min(R.y,X.y),Z.x=Math.max(R.x,Z.x),Z.y=Math.max(R.y,Z.y),C[x+Q]=R.x,C[x+1+Q]=R.y,C[x++]=R.x,C[x++]=R.y}ne=c.scaleToGeodeticSurface(ne,ne),$=n.clone(ne,M),T=c.geodeticSurfaceNormal(ne,T);var oe=n.multiplyByScalar(T,d,O);if(ne=n.add(ne,oe,ne),oe=n.multiplyByScalar(T,m,oe),$=n.add($,oe,$),a.position&&(v[J+K]=$.x,v[ee+K]=$.y,v[te+K]=$.z,v[J]=ne.x,v[ee]=ne.y,v[te]=ne.z),a.normal||a.tangent||a.binormal){P=n.clone(T,P);var ae=n.fromArray(e,(J+3)%K,O);n.subtract(ae,ne,ae);var se=n.subtract($,ne,I);T=n.normalize(n.cross(se,ae,T),T),a.normal&&(w[J]=T.x,w[ee]=T.y,w[te]=T.z,w[J+K]=T.x,w[ee+K]=T.y,w[te+K]=T.z),a.tangent&&(A=n.normalize(n.cross(P,T,A),A),E[J]=A.x,E[ee]=A.y,E[te]=A.z,E[J+K]=A.x,E[J+1+K]=A.y,E[J+2+K]=A.z),a.binormal&&(S[J]=P.x,S[ee]=P.y,S[te]=P.z,S[J+K]=P.x,S[ee+K]=P.y,S[te+K]=P.z)}}if(a.st){K=C.length;for(var le=0;le<K;le+=2)C[le]=(C[le]-X.x)/(Z.x-X.x),C[le+1]=(C[le+1]-X.y)/(Z.y-X.y)}var ue=new f;return a.position&&(ue.position=new p({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:v})),a.st&&(ue.st=new p({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:C})),a.normal&&(ue.normal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:w})),a.tangent&&(ue.tangent=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:E})),a.binormal&&(ue.binormal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:S})),ue}(E);P=function(e){for(var t=E.length/3,n=g.createTypedArray(t,6*t),r=0,i=0;i<t;i++){var o=i+t,a=(i+1)%t,s=a+t;n[r++]=i,n[r++]=o,n[r++]=a,n[r++]=a,n[r++]=o,n[r++]=s}return n}();var Q=g.createTypedArray(2*E.length/3,P),J=new d({attributes:K,indices:Q,primitiveType:w.TRIANGLES}),$=_.combineInstances([new m({geometry:Z}),new m({geometry:J})]);return{boundingSphere:S,attributes:$[0].attributes,indices:$[0].indices}}(a)):o=function(t){var r=t.center;W=n.multiplyByScalar(t.ellipsoid.geodeticSurfaceNormal(r,W),t.height,W),W=n.add(r,W,W);var i=new e(W,t.semiMajorAxis),o=u.computeEllipsePositions(t,!0,!1),a=o.positions,s=o.numPts,l=T(a,t,!1),c=A(s);return{boundingSphere:i,attributes:l,indices:c=g.createTypedArray(a.length/3,c)}}(a),new d({attributes:o.attributes,indices:o.indices,primitiveType:w.TRIANGLES,boundingSphere:o.boundingSphere})}},P.createShadowVolume=function(e,t,n){var r=e._granularity,i=e._ellipsoid,o=t(r,i),a=n(r,i);return new P({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:i,rotation:e._rotation,stRotation:e._stRotation,granularity:r,extrudedHeight:o,height:a,vertexFormat:x.POSITION_ONLY})},s(P.prototype,{rectangle:{get:function(){return this._rectangle}}}),P}),o("Core/CircleGeometry",["./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./EllipseGeometry","./Ellipsoid","./Math","./VertexFormat"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(e){var n=(e=t(e,t.EMPTY_OBJECT)).radius;this._ellipseGeometry=new o({center:e.center,semiMajorAxis:n,semiMinorAxis:n,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation}),this._workerName="createCircleGeometry"}u.packedLength=o.packedLength,u.pack=function(e,t,n){return o.pack(e._ellipseGeometry,t,n)};var c=new o({center:new e,semiMajorAxis:1,semiMinorAxis:1}),h={center:new e,radius:void 0,ellipsoid:a.clone(a.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new l,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};return u.unpack=function(t,r,i){var s=o.unpack(t,r,c);return h.center=e.clone(s._center,h.center),h.ellipsoid=a.clone(s._ellipsoid,h.ellipsoid),h.height=s._height,h.extrudedHeight=s._extrudedHeight,h.granularity=s._granularity,h.vertexFormat=l.clone(s._vertexFormat,h.vertexFormat),h.stRotation=s._stRotation,n(i)?(h.semiMajorAxis=s._semiMajorAxis,h.semiMinorAxis=s._semiMinorAxis,i._ellipseGeometry=new o(h),i):(h.radius=s._semiMajorAxis,new u(h))},u.createGeometry=function(e){return o.createGeometry(e._ellipseGeometry)},u.createShadowVolume=function(e,t,n){var r=e._ellipseGeometry._granularity,i=e._ellipseGeometry._ellipsoid,o=t(r,i),a=n(r,i);return new u({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:i,stRotation:e._ellipseGeometry._stRotation,granularity:r,extrudedHeight:o,height:a,vertexFormat:l.POSITION_ONLY})},r(u.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}}}),u}),o("Core/EllipseOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./EllipseGeometryLibrary","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(e){var n=(e=r(e,r.EMPTY_OBJECT)).center,o=r(e.ellipsoid,s.WGS84),a=e.semiMajorAxis,l=e.semiMinorAxis,u=r(e.granularity,d.RADIANS_PER_DEGREE),c=r(e.height,0),h=e.extrudedHeight,p=i(h)&&Math.abs(c-h)>1;this._center=t.clone(n),this._semiMajorAxis=a,this._semiMinorAxis=l,this._ellipsoid=s.clone(o),this._rotation=r(e.rotation,0),this._height=c,this._granularity=u,this._extrudedHeight=h,this._extrude=p,this._numberOfVerticalLines=Math.max(r(e.numberOfVerticalLines,16),0),this._workerName="createEllipseOutlineGeometry"}var m=new t,_=new t,g=new e,v=new e;f.packedLength=t.packedLength+s.packedLength+9,f.pack=function(e,n,o){return o=r(o,0),t.pack(e._center,n,o),s.pack(e._ellipsoid,n,o+=t.packedLength),o+=s.packedLength,n[o++]=e._semiMajorAxis,n[o++]=e._semiMinorAxis,n[o++]=e._rotation,n[o++]=e._height,n[o++]=e._granularity,n[o++]=i(e._extrudedHeight)?1:0,n[o++]=r(e._extrudedHeight,0),n[o++]=e._extrude?1:0,n[o]=e._numberOfVerticalLines,n};var y=new t,C=new s,w={center:y,ellipsoid:C,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0};return f.unpack=function(e,n,o){n=r(n,0);var a=t.unpack(e,n,y),l=s.unpack(e,n+=t.packedLength,C);n+=s.packedLength;var u=e[n++],c=e[n++],h=e[n++],d=e[n++],p=e[n++],m=e[n++],_=e[n++],g=1===e[n++],v=e[n];return i(o)?(o._center=t.clone(a,o._center),o._ellipsoid=s.clone(l,o._ellipsoid),o._semiMajorAxis=u,o._semiMinorAxis=c,o._rotation=h,o._height=d,o._granularity=p,o._extrudedHeight=m?_:void 0,o._extrude=g,o._numberOfVerticalLines=v,o):(w.height=d,w.extrudedHeight=m?_:void 0,w.granularity=p,w.rotation=h,w.semiMajorAxis=u,w.semiMinorAxis=c,w.numberOfVerticalLines=v,new f(w))},f.createGeometry=function(i){if(!(i._semiMajorAxis<=0||i._semiMinorAxis<=0)){i._center=i._ellipsoid.scaleToGeodeticSurface(i._center,i._center);var o,s={center:i._center,semiMajorAxis:i._semiMajorAxis,semiMinorAxis:i._semiMinorAxis,ellipsoid:i._ellipsoid,rotation:i._rotation,height:i._height,extrudedHeight:i._extrudedHeight,granularity:i._granularity,numberOfVerticalLines:i._numberOfVerticalLines};return i._extrude?(s.extrudedHeight=Math.min(i._extrudedHeight,i._height),s.height=Math.max(i._extrudedHeight,i._height),o=function(i){var o=i.center,s=i.ellipsoid,l=i.semiMajorAxis,p=t.multiplyByScalar(s.geodeticSurfaceNormal(o,m),i.height,m);g.center=t.add(o,p,g.center),g.radius=l,p=t.multiplyByScalar(s.geodeticSurfaceNormal(o,p),i.extrudedHeight,p),v.center=t.add(o,p,v.center),v.radius=l;var f=a.computeEllipsePositions(i,!1,!0).outerPositions,_=new c({position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:a.raisePositionsToHeight(f,i,!0)})});f=_.position.values;var y=e.union(g,v),C=f.length/3,w=r(i.numberOfVerticalLines,16);w=d.clamp(w,0,C/2);var b=h.createTypedArray(C,2*C+2*w);C/=2;var E,S,x=0;for(E=0;E<C;++E)b[x++]=E,b[x++]=(E+1)%C,b[x++]=E+C,b[x++]=(E+1)%C+C;if(w>0){var T=Math.min(w,C);S=Math.round(C/T);var A=Math.min(S*w,C);for(E=0;E<A;E+=S)b[x++]=E,b[x++]=E+C}return{boundingSphere:y,attributes:_,indices:b}}(s)):o=function(r){var i=r.center;_=t.multiplyByScalar(r.ellipsoid.geodeticSurfaceNormal(i,_),r.height,_),_=t.add(i,_,_);for(var o=new e(_,r.semiMajorAxis),s=a.computeEllipsePositions(r,!1,!0).outerPositions,l=new c({position:new u({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:a.raisePositionsToHeight(s,r,!1)})}),d=s.length/3,p=h.createTypedArray(d,2*d),f=0,m=0;m<d;++m)p[f++]=m,p[f++]=(m+1)%d;return{boundingSphere:o,attributes:l,indices:p}}(s),new l({attributes:o.attributes,indices:o.indices,primitiveType:p.LINES,boundingSphere:o.boundingSphere})}},f}),o("Core/CircleOutlineGeometry",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./EllipseOutlineGeometry","./Ellipsoid"],function(e,t,n,r,i,o){"use strict";function a(e){var n=(e=t(e,t.EMPTY_OBJECT)).radius;this._ellipseGeometry=new i({center:e.center,semiMajorAxis:n,semiMinorAxis:n,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines}),this._workerName="createCircleOutlineGeometry"}a.packedLength=i.packedLength,a.pack=function(e,t,n){return i.pack(e._ellipseGeometry,t,n)};var s=new i({center:new e,semiMajorAxis:1,semiMinorAxis:1}),l={center:new e,radius:void 0,ellipsoid:o.clone(o.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};return a.unpack=function(t,r,u){var c=i.unpack(t,r,s);return l.center=e.clone(c._center,l.center),l.ellipsoid=o.clone(c._ellipsoid,l.ellipsoid),l.height=c._height,l.extrudedHeight=c._extrudedHeight,l.granularity=c._granularity,l.numberOfVerticalLines=c._numberOfVerticalLines,n(u)?(l.semiMajorAxis=c._semiMajorAxis,l.semiMinorAxis=c._semiMinorAxis,u._ellipseGeometry=new i(l),u):(l.radius=c._semiMajorAxis,new a(l))},a.createGeometry=function(e){return i.createGeometry(e._ellipseGeometry)},a}),o("Core/ClockRange",["./freezeObject"],function(e){"use strict";return e({UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2})}),o("Core/ClockStep",["./freezeObject"],function(e){"use strict";return e({TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2})}),o("Core/getTimestamp",["./defined"],function(e){"use strict";return"undefined"!=typeof performance&&e(performance.now)?function(){return performance.now()}:function(){return Date.now()}}),o("Core/Clock",["./ClockRange","./ClockStep","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./getTimestamp","./JulianDate"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(i){var o=(i=n(i,n.EMPTY_OBJECT)).currentTime,u=i.startTime,c=i.stopTime;o=r(o)?l.clone(o):r(u)?l.clone(u):r(c)?l.addDays(c,-1,new l):l.now(),u=r(u)?l.clone(u):l.clone(o),c=r(c)?l.clone(c):l.addDays(u,1,new l),this.startTime=u,this.stopTime=c,this.clockRange=n(i.clockRange,e.UNBOUNDED),this.canAnimate=n(i.canAnimate,!0),this.onTick=new a,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=s(),this.currentTime=o,this.multiplier=n(i.multiplier,1),this.clockStep=n(i.clockStep,t.SYSTEM_CLOCK_MULTIPLIER),this.shouldAnimate=n(i.shouldAnimate,!0)}return i(u.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){l.equals(this._currentTime,e)||(this._clockStep===t.SYSTEM_CLOCK&&(this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===t.SYSTEM_CLOCK&&(this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===t.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=l.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===t.SYSTEM_CLOCK&&(this._clockStep=t.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}}),u.prototype.tick=function(){var n=s(),r=l.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var i=this._clockStep;if(i===t.SYSTEM_CLOCK)r=l.now(r);else{var o=this._multiplier;r=l.addSeconds(r,i===t.TICK_DEPENDENT?o:o*((n-this._lastSystemTime)/1e3),r);var a=this.clockRange,u=this.startTime,c=this.stopTime;if(a===e.CLAMPED)l.lessThan(r,u)?r=l.clone(u,r):l.greaterThan(r,c)&&(r=l.clone(c,r));else if(a===e.LOOP_STOP)for(l.lessThan(r,u)&&(r=l.clone(u,r));l.greaterThan(r,c);)r=l.addSeconds(u,l.secondsDifference(r,c),r)}}return this._currentTime=r,this._lastSystemTime=n,this.onTick.raiseEvent(this),r},u}),o("Core/Color",["./defaultValue","./defined","./DeveloperError","./FeatureDetection","./freezeObject","./Math"],function(e,t,n,r,i,o){"use strict";function a(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e}function s(t,n,r,i){this.red=e(t,1),this.green=e(n,1),this.blue=e(r,1),this.alpha=e(i,1)}var l,u,c;s.fromCartesian4=function(e,n){return t(n)?(n.red=e.x,n.green=e.y,n.blue=e.z,n.alpha=e.w,n):new s(e.x,e.y,e.z,e.w)},s.fromBytes=function(n,r,i,o,a){return n=s.byteToFloat(e(n,255)),r=s.byteToFloat(e(r,255)),i=s.byteToFloat(e(i,255)),o=s.byteToFloat(e(o,255)),t(a)?(a.red=n,a.green=r,a.blue=i,a.alpha=o,a):new s(n,r,i,o)},s.fromAlpha=function(e,n,r){return t(r)?(r.red=e.red,r.green=e.green,r.blue=e.blue,r.alpha=n,r):new s(e.red,e.green,e.blue,n)},r.supportsTypedArrays()&&(l=new ArrayBuffer(4),u=new Uint32Array(l),c=new Uint8Array(l)),s.fromRgba=function(e,t){return u[0]=e,s.fromBytes(c[0],c[1],c[2],c[3],t)},s.fromHsl=function(n,r,i,o,l){n=e(n,0)%1,r=e(r,0),i=e(i,0),o=e(o,1);var u=i,c=i,h=i;if(0!==r){var d,p=2*i-(d=i<.5?i*(1+r):i+r-i*r);u=a(p,d,n+1/3),c=a(p,d,n),h=a(p,d,n-1/3)}return t(l)?(l.red=u,l.green=c,l.blue=h,l.alpha=o,l):new s(u,c,h,o)},s.fromRandom=function(n,r){var i=(n=e(n,e.EMPTY_OBJECT)).red;if(!t(i)){var a=e(n.minimumRed,0),l=e(n.maximumRed,1);i=a+o.nextRandomNumber()*(l-a)}var u=n.green;if(!t(u)){var c=e(n.minimumGreen,0),h=e(n.maximumGreen,1);u=c+o.nextRandomNumber()*(h-c)}var d=n.blue;if(!t(d)){var p=e(n.minimumBlue,0),f=e(n.maximumBlue,1);d=p+o.nextRandomNumber()*(f-p)}var m=n.alpha;if(!t(m)){var _=e(n.minimumAlpha,0),g=e(n.maximumAlpha,1);m=_+o.nextRandomNumber()*(g-_)}return t(r)?(r.red=i,r.green=u,r.blue=d,r.alpha=m,r):new s(i,u,d,m)};var h=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,d=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,p=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,f=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;return s.fromCssColorString=function(n,r){t(r)||(r=new s);var i=s[n.toUpperCase()];if(t(i))return s.clone(i,r),r;var o=h.exec(n);return null!==o?(r.red=parseInt(o[1],16)/15,r.green=parseInt(o[2],16)/15,r.blue=parseInt(o[3],16)/15,r.alpha=1,r):null!==(o=d.exec(n))?(r.red=parseInt(o[1],16)/255,r.green=parseInt(o[2],16)/255,r.blue=parseInt(o[3],16)/255,r.alpha=1,r):null!==(o=p.exec(n))?(r.red=parseFloat(o[1])/("%"===o[1].substr(-1)?100:255),r.green=parseFloat(o[2])/("%"===o[2].substr(-1)?100:255),r.blue=parseFloat(o[3])/("%"===o[3].substr(-1)?100:255),r.alpha=parseFloat(e(o[4],"1.0")),r):null!==(o=f.exec(n))?s.fromHsl(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,parseFloat(e(o[4],"1.0")),r):r=void 0},s.packedLength=4,s.pack=function(t,n,r){return r=e(r,0),n[r++]=t.red,n[r++]=t.green,n[r++]=t.blue,n[r]=t.alpha,n},s.unpack=function(n,r,i){return r=e(r,0),t(i)||(i=new s),i.red=n[r++],i.green=n[r++],i.blue=n[r++],i.alpha=n[r],i},s.byteToFloat=function(e){return e/255},s.floatToByte=function(e){return 1===e?255:256*e|0},s.clone=function(e,n){if(t(e))return t(n)?(n.red=e.red,n.green=e.green,n.blue=e.blue,n.alpha=e.alpha,n):new s(e.red,e.green,e.blue,e.alpha)},s.equals=function(e,n){return e===n||t(e)&&t(n)&&e.red===n.red&&e.green===n.green&&e.blue===n.blue&&e.alpha===n.alpha},s.equalsArray=function(e,t,n){return e.red===t[n]&&e.green===t[n+1]&&e.blue===t[n+2]&&e.alpha===t[n+3]},s.prototype.clone=function(e){return s.clone(this,e)},s.prototype.equals=function(e){return s.equals(this,e)},s.prototype.equalsEpsilon=function(e,n){return this===e||t(e)&&Math.abs(this.red-e.red)<=n&&Math.abs(this.green-e.green)<=n&&Math.abs(this.blue-e.blue)<=n&&Math.abs(this.alpha-e.alpha)<=n},s.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},s.prototype.toCssColorString=function(){var e=s.floatToByte(this.red),t=s.floatToByte(this.green),n=s.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+n+")":"rgba("+e+","+t+","+n+","+this.alpha+")"},s.prototype.toBytes=function(e){var n=s.floatToByte(this.red),r=s.floatToByte(this.green),i=s.floatToByte(this.blue),o=s.floatToByte(this.alpha);return t(e)?(e[0]=n,e[1]=r,e[2]=i,e[3]=o,e):[n,r,i,o]},s.prototype.toRgba=function(){return c[0]=s.floatToByte(this.red),c[1]=s.floatToByte(this.green),c[2]=s.floatToByte(this.blue),c[3]=s.floatToByte(this.alpha),u[0]},s.prototype.brighten=function(e,t){return t.red=1-(1-this.red)*(e=1-e),t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},s.prototype.darken=function(e,t){return t.red=this.red*(e=1-e),t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},s.prototype.withAlpha=function(e,t){return s.fromAlpha(this,e,t)},s.add=function(e,t,n){return n.red=e.red+t.red,n.green=e.green+t.green,n.blue=e.blue+t.blue,n.alpha=e.alpha+t.alpha,n},s.subtract=function(e,t,n){return n.red=e.red-t.red,n.green=e.green-t.green,n.blue=e.blue-t.blue,n.alpha=e.alpha-t.alpha,n},s.multiply=function(e,t,n){return n.red=e.red*t.red,n.green=e.green*t.green,n.blue=e.blue*t.blue,n.alpha=e.alpha*t.alpha,n},s.divide=function(e,t,n){return n.red=e.red/t.red,n.green=e.green/t.green,n.blue=e.blue/t.blue,n.alpha=e.alpha/t.alpha,n},s.mod=function(e,t,n){return n.red=e.red%t.red,n.green=e.green%t.green,n.blue=e.blue%t.blue,n.alpha=e.alpha%t.alpha,n},s.multiplyByScalar=function(e,t,n){return n.red=e.red*t,n.green=e.green*t,n.blue=e.blue*t,n.alpha=e.alpha*t,n},s.divideByScalar=function(e,t,n){return n.red=e.red/t,n.green=e.green/t,n.blue=e.blue/t,n.alpha=e.alpha/t,n},s.ALICEBLUE=i(s.fromCssColorString("#F0F8FF")),s.ANTIQUEWHITE=i(s.fromCssColorString("#FAEBD7")),s.AQUA=i(s.fromCssColorString("#00FFFF")),s.AQUAMARINE=i(s.fromCssColorString("#7FFFD4")),s.AZURE=i(s.fromCssColorString("#F0FFFF")),s.BEIGE=i(s.fromCssColorString("#F5F5DC")),s.BISQUE=i(s.fromCssColorString("#FFE4C4")),s.BLACK=i(s.fromCssColorString("#000000")),s.BLANCHEDALMOND=i(s.fromCssColorString("#FFEBCD")),s.BLUE=i(s.fromCssColorString("#0000FF")),s.BLUEVIOLET=i(s.fromCssColorString("#8A2BE2")),s.BROWN=i(s.fromCssColorString("#A52A2A")),s.BURLYWOOD=i(s.fromCssColorString("#DEB887")),s.CADETBLUE=i(s.fromCssColorString("#5F9EA0")),s.CHARTREUSE=i(s.fromCssColorString("#7FFF00")),s.CHOCOLATE=i(s.fromCssColorString("#D2691E")),s.CORAL=i(s.fromCssColorString("#FF7F50")),s.CORNFLOWERBLUE=i(s.fromCssColorString("#6495ED")),s.CORNSILK=i(s.fromCssColorString("#FFF8DC")),s.CRIMSON=i(s.fromCssColorString("#DC143C")),s.CYAN=i(s.fromCssColorString("#00FFFF")),s.DARKBLUE=i(s.fromCssColorString("#00008B")),s.DARKCYAN=i(s.fromCssColorString("#008B8B")),s.DARKGOLDENROD=i(s.fromCssColorString("#B8860B")),s.DARKGRAY=i(s.fromCssColorString("#A9A9A9")),s.DARKGREEN=i(s.fromCssColorString("#006400")),s.DARKGREY=s.DARKGRAY,s.DARKKHAKI=i(s.fromCssColorString("#BDB76B")),s.DARKMAGENTA=i(s.fromCssColorString("#8B008B")),s.DARKOLIVEGREEN=i(s.fromCssColorString("#556B2F")),s.DARKORANGE=i(s.fromCssColorString("#FF8C00")),s.DARKORCHID=i(s.fromCssColorString("#9932CC")),s.DARKRED=i(s.fromCssColorString("#8B0000")),s.DARKSALMON=i(s.fromCssColorString("#E9967A")),s.DARKSEAGREEN=i(s.fromCssColorString("#8FBC8F")),s.DARKSLATEBLUE=i(s.fromCssColorString("#483D8B")),s.DARKSLATEGRAY=i(s.fromCssColorString("#2F4F4F")),s.DARKSLATEGREY=s.DARKSLATEGRAY,s.DARKTURQUOISE=i(s.fromCssColorString("#00CED1")),s.DARKVIOLET=i(s.fromCssColorString("#9400D3")),s.DEEPPINK=i(s.fromCssColorString("#FF1493")),s.DEEPSKYBLUE=i(s.fromCssColorString("#00BFFF")),s.DIMGRAY=i(s.fromCssColorString("#696969")),s.DIMGREY=s.DIMGRAY,s.DODGERBLUE=i(s.fromCssColorString("#1E90FF")),s.FIREBRICK=i(s.fromCssColorString("#B22222")),s.FLORALWHITE=i(s.fromCssColorString("#FFFAF0")),s.FORESTGREEN=i(s.fromCssColorString("#228B22")),s.FUSCHIA=i(s.fromCssColorString("#FF00FF")),s.GAINSBORO=i(s.fromCssColorString("#DCDCDC")),s.GHOSTWHITE=i(s.fromCssColorString("#F8F8FF")),s.GOLD=i(s.fromCssColorString("#FFD700")),s.GOLDENROD=i(s.fromCssColorString("#DAA520")),s.GRAY=i(s.fromCssColorString("#808080")),s.GREEN=i(s.fromCssColorString("#008000")),s.GREENYELLOW=i(s.fromCssColorString("#ADFF2F")),s.GREY=s.GRAY,s.HONEYDEW=i(s.fromCssColorString("#F0FFF0")),s.HOTPINK=i(s.fromCssColorString("#FF69B4")),s.INDIANRED=i(s.fromCssColorString("#CD5C5C")),s.INDIGO=i(s.fromCssColorString("#4B0082")),s.IVORY=i(s.fromCssColorString("#FFFFF0")),s.KHAKI=i(s.fromCssColorString("#F0E68C")),s.LAVENDER=i(s.fromCssColorString("#E6E6FA")),s.LAVENDAR_BLUSH=i(s.fromCssColorString("#FFF0F5")),s.LAWNGREEN=i(s.fromCssColorString("#7CFC00")),s.LEMONCHIFFON=i(s.fromCssColorString("#FFFACD")),s.LIGHTBLUE=i(s.fromCssColorString("#ADD8E6")),s.LIGHTCORAL=i(s.fromCssColorString("#F08080")),s.LIGHTCYAN=i(s.fromCssColorString("#E0FFFF")),s.LIGHTGOLDENRODYELLOW=i(s.fromCssColorString("#FAFAD2")),s.LIGHTGRAY=i(s.fromCssColorString("#D3D3D3")),s.LIGHTGREEN=i(s.fromCssColorString("#90EE90")),s.LIGHTGREY=s.LIGHTGRAY,s.LIGHTPINK=i(s.fromCssColorString("#FFB6C1")),s.LIGHTSEAGREEN=i(s.fromCssColorString("#20B2AA")),s.LIGHTSKYBLUE=i(s.fromCssColorString("#87CEFA")),s.LIGHTSLATEGRAY=i(s.fromCssColorString("#778899")),s.LIGHTSLATEGREY=s.LIGHTSLATEGRAY,s.LIGHTSTEELBLUE=i(s.fromCssColorString("#B0C4DE")),s.LIGHTYELLOW=i(s.fromCssColorString("#FFFFE0")),s.LIME=i(s.fromCssColorString("#00FF00")),s.LIMEGREEN=i(s.fromCssColorString("#32CD32")),s.LINEN=i(s.fromCssColorString("#FAF0E6")),s.MAGENTA=i(s.fromCssColorString("#FF00FF")),s.MAROON=i(s.fromCssColorString("#800000")),s.MEDIUMAQUAMARINE=i(s.fromCssColorString("#66CDAA")),s.MEDIUMBLUE=i(s.fromCssColorString("#0000CD")),s.MEDIUMORCHID=i(s.fromCssColorString("#BA55D3")),s.MEDIUMPURPLE=i(s.fromCssColorString("#9370DB")),s.MEDIUMSEAGREEN=i(s.fromCssColorString("#3CB371")),s.MEDIUMSLATEBLUE=i(s.fromCssColorString("#7B68EE")),s.MEDIUMSPRINGGREEN=i(s.fromCssColorString("#00FA9A")),s.MEDIUMTURQUOISE=i(s.fromCssColorString("#48D1CC")),s.MEDIUMVIOLETRED=i(s.fromCssColorString("#C71585")),s.MIDNIGHTBLUE=i(s.fromCssColorString("#191970")),s.MINTCREAM=i(s.fromCssColorString("#F5FFFA")),s.MISTYROSE=i(s.fromCssColorString("#FFE4E1")),s.MOCCASIN=i(s.fromCssColorString("#FFE4B5")),s.NAVAJOWHITE=i(s.fromCssColorString("#FFDEAD")),s.NAVY=i(s.fromCssColorString("#000080")),s.OLDLACE=i(s.fromCssColorString("#FDF5E6")),s.OLIVE=i(s.fromCssColorString("#808000")),s.OLIVEDRAB=i(s.fromCssColorString("#6B8E23")),s.ORANGE=i(s.fromCssColorString("#FFA500")),s.ORANGERED=i(s.fromCssColorString("#FF4500")),s.ORCHID=i(s.fromCssColorString("#DA70D6")),s.PALEGOLDENROD=i(s.fromCssColorString("#EEE8AA")),s.PALEGREEN=i(s.fromCssColorString("#98FB98")),s.PALETURQUOISE=i(s.fromCssColorString("#AFEEEE")),s.PALEVIOLETRED=i(s.fromCssColorString("#DB7093")),s.PAPAYAWHIP=i(s.fromCssColorString("#FFEFD5")),s.PEACHPUFF=i(s.fromCssColorString("#FFDAB9")),s.PERU=i(s.fromCssColorString("#CD853F")),s.PINK=i(s.fromCssColorString("#FFC0CB")),s.PLUM=i(s.fromCssColorString("#DDA0DD")),s.POWDERBLUE=i(s.fromCssColorString("#B0E0E6")),s.PURPLE=i(s.fromCssColorString("#800080")),s.RED=i(s.fromCssColorString("#FF0000")),s.ROSYBROWN=i(s.fromCssColorString("#BC8F8F")),s.ROYALBLUE=i(s.fromCssColorString("#4169E1")),s.SADDLEBROWN=i(s.fromCssColorString("#8B4513")),s.SALMON=i(s.fromCssColorString("#FA8072")),s.SANDYBROWN=i(s.fromCssColorString("#F4A460")),s.SEAGREEN=i(s.fromCssColorString("#2E8B57")),s.SEASHELL=i(s.fromCssColorString("#FFF5EE")),s.SIENNA=i(s.fromCssColorString("#A0522D")),s.SILVER=i(s.fromCssColorString("#C0C0C0")),s.SKYBLUE=i(s.fromCssColorString("#87CEEB")),s.SLATEBLUE=i(s.fromCssColorString("#6A5ACD")),s.SLATEGRAY=i(s.fromCssColorString("#708090")),s.SLATEGREY=s.SLATEGRAY,s.SNOW=i(s.fromCssColorString("#FFFAFA")),s.SPRINGGREEN=i(s.fromCssColorString("#00FF7F")),s.STEELBLUE=i(s.fromCssColorString("#4682B4")),s.TAN=i(s.fromCssColorString("#D2B48C")),s.TEAL=i(s.fromCssColorString("#008080")),s.THISTLE=i(s.fromCssColorString("#D8BFD8")),s.TOMATO=i(s.fromCssColorString("#FF6347")),s.TURQUOISE=i(s.fromCssColorString("#40E0D0")),s.VIOLET=i(s.fromCssColorString("#EE82EE")),s.WHEAT=i(s.fromCssColorString("#F5DEB3")),s.WHITE=i(s.fromCssColorString("#FFFFFF")),s.WHITESMOKE=i(s.fromCssColorString("#F5F5F5")),s.YELLOW=i(s.fromCssColorString("#FFFF00")),s.YELLOWGREEN=i(s.fromCssColorString("#9ACD32")),s.TRANSPARENT=i(new s(0,0,0,0)),s}),o("Core/ColorGeometryInstanceAttribute",["./Color","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,n,r,i,o){"use strict";function a(t,r,i,o){t=n(t,1),r=n(r,1),i=n(i,1),o=n(o,1),this.value=new Uint8Array([e.floatToByte(t),e.floatToByte(r),e.floatToByte(i),e.floatToByte(o)])}return i(a.prototype,{componentDatatype:{get:function(){return t.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}}),a.fromColor=function(e){return new a(e.red,e.green,e.blue,e.alpha)},a.toValue=function(e,t){return r(t)?e.toBytes(t):new Uint8Array(e.toBytes())},a.equals=function(e,t){return e===t||r(e)&&r(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]},a}),o("Core/combine",["./defaultValue","./defined"],function(e,t){"use strict";return function n(r,i,o){o=e(o,!1);var a,s,l,u={},c=t(r),h=t(i);if(c)for(a in r)r.hasOwnProperty(a)&&(s=r[a],h&&o&&"object"==typeof s&&i.hasOwnProperty(a)?(l=i[a],u[a]="object"==typeof l?n(s,l,o):s):u[a]=s);if(h)for(a in i)i.hasOwnProperty(a)&&!u.hasOwnProperty(a)&&(l=i[a],u[a]=l);return u}}),o("Core/CornerType",["./freezeObject"],function(e){"use strict";return e({ROUNDED:0,MITERED:1,BEVELED:2})}),o("Core/isArray",["./defined"],function(e){"use strict";var t=Array.isArray;return e(t)||(t=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t}),o("Core/EllipsoidGeodesic",["./Cartesian3","./Cartographic","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t,n,r,i,o,a){var s,l,u=(s=e)*(l=n)*(4+s*(4-3*l))/16;return(1-u)*e*t*(r+u*i*(a+u*o*(2*a*a-1)))}function u(n,r,i,o){var a,u,c,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N;e.normalize(o.cartographicToCartesian(r,d),h),e.normalize(o.cartographicToCartesian(i,d),d),function(e,t,n,o,a,u,c){var h,d,p,f,m,_=(t-n)/t,g=i.longitude-r.longitude,v=Math.atan((1-_)*Math.tan(r.latitude)),y=Math.atan((1-_)*Math.tan(c)),C=Math.cos(v),w=Math.sin(v),b=Math.cos(y),E=Math.sin(y),S=C*b,x=C*E,T=w*E,A=w*b,P=g,D=s.TWO_PI,M=Math.cos(P),I=Math.sin(P);do{M=Math.cos(P),I=Math.sin(P);var O,R=x-A*M;p=Math.sqrt(b*b*I*I+R*R),d=T+S*M,h=Math.atan2(p,d),0===p?(O=0,f=1):f=1-(O=S*I/p)*O,D=P,m=d-2*T/f,isNaN(m)&&(m=0),P=g+l(_,O,f,h,p,d,m)}while(Math.abs(P-D)>s.EPSILON12);var N=f*(t*t-n*n)/(n*n),L=N*(256+N*(N*(74-47*N)-128))/1024,F=m*m,B=n*(1+N*(4096+N*(N*(320-175*N)-768))/16384)*(h-L*p*(m+L*(d*(2*F-1)-L*m*(4*p*p-3)*(4*F-3)/6)/4)),k=Math.atan2(b*I,x-A*M),V=Math.atan2(C*I,x*M-A);e._distance=B,e._startHeading=k,e._endHeading=V,e._uSquared=N}(n,o.maximumRadius,o.minimumRadius,0,0,0,i.latitude),n._start=t.clone(r,n._start),n._end=t.clone(i,n._end),n._start.height=0,n._end.height=0,u=(a=n)._uSquared,f=((c=a._ellipsoid.maximumRadius)-(p=a._ellipsoid.minimumRadius))/c,m=Math.cos(a._startHeading),_=Math.sin(a._startHeading),g=(1-f)*Math.tan(a._start.latitude),y=(v=1/Math.sqrt(1+g*g))*g,C=Math.atan2(g,m),E=1-(b=(w=v*_)*w),S=Math.sqrt(E),I=1-3*(x=u/4)+35*(T=x*x)/4,O=1-5*x,R=(D=1+x-3*T/4+5*(A=T*x)/4-175*(P=T*T)/64)*C-(M=1-x+15*T/8-35*A/8)*Math.sin(2*C)*x/2-I*Math.sin(4*C)*T/16-O*Math.sin(6*C)*A/48-5*Math.sin(8*C)*P/512,(N=a._constants).a=c,N.b=p,N.f=f,N.cosineHeading=m,N.sineHeading=_,N.tanU=g,N.cosineU=v,N.sineU=y,N.sigma=C,N.sineAlpha=w,N.sineSquaredAlpha=b,N.cosineSquaredAlpha=E,N.cosineAlpha=S,N.u2Over4=x,N.u4Over16=T,N.u6Over64=A,N.u8Over256=P,N.a0=D,N.a1=M,N.a2=I,N.a3=O,N.distanceRatio=R}function c(e,i,o){var s=n(o,a.WGS84);this._ellipsoid=s,this._start=new t,this._end=new t,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,r(e)&&r(i)&&u(this,e,i,s)}var h=new e,d=new e;return i(c.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return this._startHeading}},endHeading:{get:function(){return this._endHeading}}}),c.prototype.setEndPoints=function(e,t){u(this,e,t,this._ellipsoid)},c.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},c.prototype.interpolateUsingSurfaceDistance=function(e,n){var i=this._constants,o=i.distanceRatio+e/i.b,a=Math.cos(2*o),s=Math.cos(4*o),u=Math.cos(6*o),c=Math.sin(2*o),h=Math.sin(4*o),d=Math.sin(6*o),p=Math.sin(8*o),f=o*o,m=i.u8Over256,_=i.u2Over4,g=i.u6Over64,v=i.u4Over16,y=o*f*2*m*a/3+o*(1-_+7*v/4-15*g/4+579*m/64-(v-15*g/4+187*m/16)*a-(5*g/4-115*m/16)*s-29*m*u/16)+(_/2-v+71*g/32-85*m/16)*c+(5*v/16-5*g/4+383*m/96)*h-f*((g-11*m/2)*c+5*m*h/2)+(29*g/96-29*m/16)*d+539*m*p/1536,C=Math.asin(Math.sin(y)*i.cosineAlpha),w=Math.atan(i.a/i.b*Math.tan(C));y-=i.sigma;var b=Math.cos(2*i.sigma+y),E=Math.sin(y),S=Math.cos(y),x=Math.atan2(E*i.sineHeading,i.cosineU*S-i.sineU*E*i.cosineHeading)-l(i.f,i.sineAlpha,i.cosineSquaredAlpha,y,E,S,b);return r(n)?(n.longitude=this._start.longitude+x,n.latitude=w,n.height=0,n):new t(this._start.longitude+x,w,0)},c}),o("Core/PolylinePipeline",["./Cartesian3","./Cartographic","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidGeodesic","./IntersectionTests","./isArray","./Math","./Matrix4","./Plane"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(t,n,r,i,o,a,s,l){var u=i.scaleToGeodeticSurface(t,A),c=i.scaleToGeodeticSurface(n,P),h=p.numberOfPoints(t,n,r),d=i.cartesianToCartographic(u,S),f=i.cartesianToCartographic(c,x),m=function(e,t,n){var r,i=E;if(i.length=e,t===n){for(r=0;r<e;r++)i[r]=t;return i}var o=(n-t)/e;for(r=0;r<e;r++)i[r]=t+r*o;return i}(h,o,a);D.setEndPoints(d,f);var _=D.surfaceDistance/h,g=l;d.height=o;var v=i.cartographicToCartesian(d,T);e.pack(v,s,g),g+=3;for(var y=1;y<h;y++){var C=D.interpolateUsingSurfaceDistance(y*_,x);C.height=m[y],v=i.cartographicToCartesian(C,T),e.pack(v,s,g),g+=3}return g}var p={};p.numberOfPoints=function(t,n,r){var i=e.distance(t,n);return Math.ceil(i/r)};var f=new t;p.extractHeights=function(e,t){for(var n=e.length,r=new Array(n),i=0;i<n;i++)r[i]=t.cartesianToCartographic(e[i],f).height;return r};var m=new c,_=new e,g=new e,v=new h(e.ZERO,0),y=new e,C=new h(e.ZERO,0),w=new e,b=new e,E=[],S=new t,x=new t,T=new e,A=new e,P=new e,D=new a;return p.wrapLongitude=function(t,i){var o=[],a=[];if(r(t)&&t.length>0){i=n(i,c.IDENTITY);var l=c.inverseTransformation(i,m),u=c.multiplyByPoint(l,e.ZERO,_),d=c.multiplyByPointAsVector(l,e.UNIT_Y,g),p=h.fromPointNormal(u,d,v),f=c.multiplyByPointAsVector(l,e.UNIT_X,y),E=h.fromPointNormal(u,f,C),S=1;o.push(e.clone(t[0]));for(var x=o[0],T=t.length,A=1;A<T;++A){var P=t[A];if(h.getPointDistance(E,x)<0||h.getPointDistance(E,P)<0){var D=s.lineSegmentPlane(x,P,p,w);if(r(D)){var M=e.multiplyByScalar(d,5e-9,b);h.getPointDistance(p,x)<0&&e.negate(M,M),o.push(e.add(D,M,new e)),a.push(S+1),e.negate(M,M),o.push(e.add(D,M,new e)),S=1}}o.push(e.clone(t[A])),S++,x=P}a.push(S)}return{positions:o,lengths:a}},p.generateArc=function(t){r(t)||(t={});var i=t.positions,a=i.length,s=n(t.ellipsoid,o.WGS84),c=n(t.height,0),h=l(c);if(a<1)return[];if(1===a){var f=s.scaleToGeodeticSurface(i[0],A);if(0!==(c=h?c[0]:c)){var m=s.geodeticSurfaceNormal(f,T);e.multiplyByScalar(m,c,m),e.add(f,m,f)}return[f.x,f.y,f.z]}var _=t.minDistance;if(!r(_)){var g=n(t.granularity,u.RADIANS_PER_DEGREE);_=u.chordLength(g,s.maximumRadius)}var v,y=0;for(v=0;v<a-1;v++)y+=p.numberOfPoints(i[v],i[v+1],_);var C=3*(y+1),w=new Array(C),b=0;for(v=0;v<a-1;v++)b=d(i[v],i[v+1],_,s,h?c[v]:c,h?c[v+1]:c,w,b);E.length=0;var x=s.cartesianToCartographic(i[a-1],S);x.height=h?c[a-1]:c;var P=s.cartographicToCartesian(x,T);return e.pack(P,w,C-3),w},p.generateCartesianArc=function(t){for(var n=p.generateArc(t),r=n.length/3,i=new Array(r),o=0;o<r;o++)i[o]=e.unpack(n,3*o);return i},p}),o("Core/PolylineVolumeGeometryLibrary",["./Cartesian2","./Cartesian3","./Cartesian4","./Cartographic","./CornerType","./EllipsoidTangentPlane","./Math","./Matrix3","./Matrix4","./PolylinePipeline","./Quaternion","./Transforms"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(e,n,r,i){var o,a=t.angleBetween(e[0],e[1]),s=Math.ceil(a/i),l=new Array(s);if(n===r){for(o=0;o<s;o++)l[o]=n;return l.push(r),l}var u=(r-n)/s;for(o=1;o<s;o++)l[o]=n+o*u;return l[0]=n,l.push(r),l}function p(n,r,i,a,u,c,d,p){var f=F,m=B;O=h.eastNorthUpToFixedFrame(n,u,O),f=l.multiplyByPointAsVector(O,I,f);var _,g,v,y,C,w,b,E=(_=f=t.normalize(f,f),g=r,C=(y=new o(v=n,u)).projectPointOntoPlane(t.add(v,_,W),W),w=y.projectPointOntoPlane(t.add(v,g,H),H),b=e.angleBetween(C,w),w.x*C.y-w.y*C.x>=0?-b:b);N=s.fromRotationZ(E,N),k.z=c,O=l.multiplyTransformation(O,l.fromRotationTranslation(N,k,R),O);var S=L;S[0]=d;for(var x=0;x<p;x++)for(var T=0;T<i.length;T+=3)m=t.fromArray(i,T,m),m=s.multiplyByVector(S,m,m),m=l.multiplyByPoint(O,m,m),a.push(m.x,m.y,m.z);return a}function f(e,n,r,i,o,a,s){for(var l=0;l<e.length;l+=3)i=p(t.fromArray(e,l,V),n,r,i,o,a[l/3],s,1);return i}function m(e,t){for(var n=e.length,r=new Array(3*n),i=0,o=t.x+t.width/2,a=t.y+t.height/2,s=0;s<n;s++)r[i++]=e[s].x-o,r[i++]=0,r[i++]=e[s].y-a;return r}function _(e,n,r,o,l,u,h,d,f,m){var _,g,v,y=t.angleBetween(t.subtract(n,e,A),t.subtract(r,e,P)),C=o===i.BEVELED?0:Math.ceil(y/a.toRadians(5));if(_=s.fromQuaternion(c.fromAxisAngle(l?t.negate(e,A):e,y/(C+1),z),G),n=t.clone(n,U),C>0)for(var w=m?2:1,b=0;b<C;b++)n=s.multiplyByVector(_,n,n),g=t.subtract(n,e,A),g=t.normalize(g,g),l||(g=t.negate(g,g)),v=u.scaleToGeodeticSurface(n,P),h=p(v,g,d,h,u,f,1,w);else g=t.subtract(n,e,A),g=t.normalize(g,g),l||(g=t.negate(g,g)),v=u.scaleToGeodeticSurface(n,P),h=p(v,g,d,h,u,f,1,1),r=t.clone(r,U),g=t.subtract(r,e,A),g=t.normalize(g,g),l||(g=t.negate(g,g)),v=u.scaleToGeodeticSurface(r,P),h=p(v,g,d,h,u,f,1,1);return h}var g=[new t,new t],v=new t,y=new t,C=new t,w=new t,b=new t,E=new t,S=new t,x=new t,T=new t,A=new t,P=new t,D={},M=new r,I=new t(-1,0,0),O=new l,R=new l,N=new s,L=s.IDENTITY.clone(),F=new t,B=new n,k=new t,V=new t,z=new c,U=new t,G=new s;D.removeDuplicatesFromShape=function(t){for(var n=t.length,r=[],i=n-1,o=0;o<n;i=o++){var a=t[o];e.equals(t[i],a)||r.push(a)}return r};var W=new t,H=new t;D.angleIsGreaterThanPi=function(e,n,r,i){var a=new o(r,i),s=a.projectPointOntoPlane(t.add(r,e,W),W),l=a.projectPointOntoPlane(t.add(r,n,H),H);return l.x*s.y-l.y*s.x>=0};var j=new t,q=new t;return D.computePositions=function(e,n,r,o,s){var l=o._ellipsoid,c=function(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++){var i=e[r];M=t.cartesianToCartographic(i,M),n[r]=M.height,e[r]=t.scaleToGeodeticSurface(i,i)}return n}(e,l),h=o._granularity,P=o._cornerType,I=s?function(e,t){var n=e.length,r=new Array(6*n),i=0,o=t.x+t.width/2,a=t.y+t.height/2,s=e[0];r[i++]=s.x-o,r[i++]=0,r[i++]=s.y-a;for(var l=1;l<n;l++){var u=(s=e[l]).x-o,c=s.y-a;r[i++]=u,r[i++]=0,r[i++]=c,r[i++]=u,r[i++]=0,r[i++]=c}return r[i++]=(s=e[0]).x-o,r[i++]=0,r[i++]=s.y-a,r}(n,r):m(n,r),O=s?m(n,r):void 0,R=r.height/2,N=r.width/2,L=e.length,F=[],B=s?[]:void 0,k=v,V=y,z=C,U=w,G=b,W=E,H=S,Y=x,X=T,Z=e[0],K=e[1];U=l.geodeticSurfaceNormal(Z,U),k=t.subtract(K,Z,k),k=t.normalize(k,k),Y=t.cross(U,k,Y),Y=t.normalize(Y,Y);var Q=c[0],J=c[1];s&&(B=p(Z,Y,O,B,l,Q+R,1,1)),X=t.clone(Z,X),Z=K,V=t.negate(k,V);for(var $,ee=1;ee<L-1;ee++){var te=s?2:1;k=t.subtract(K=e[ee+1],Z,k),k=t.normalize(k,k),z=t.add(k,V,z),z=t.normalize(z,z),U=l.geodeticSurfaceNormal(Z,U);var ne=t.multiplyByScalar(U,t.dot(k,U),j);t.subtract(k,ne,ne),t.normalize(ne,ne);var re=t.multiplyByScalar(U,t.dot(V,U),q);if(t.subtract(V,re,re),t.normalize(re,re),a.equalsEpsilon(Math.abs(t.dot(ne,re)),1,a.EPSILON7))F=p(X,Y,I,F,l,Q+R,1,1),X=Z;else{z=t.cross(z,U,z),z=t.cross(U,z,z),z=t.normalize(z,z);var ie=1/Math.max(.25,t.magnitude(t.cross(z,V,A))),oe=D.angleIsGreaterThanPi(k,V,Z,l);oe?(G=t.add(Z,t.multiplyByScalar(z,ie*N,z),G),W=t.add(G,t.multiplyByScalar(Y,N,W),W),g[0]=t.clone(X,g[0]),g[1]=t.clone(W,g[1]),$=d(g,Q+R,J+R,h),F=f(u.generateArc({positions:g,granularity:h,ellipsoid:l}),Y,I,F,l,$,1),Y=t.cross(U,k,Y),Y=t.normalize(Y,Y),H=t.add(G,t.multiplyByScalar(Y,N,H),H),P===i.ROUNDED||P===i.BEVELED?_(G,W,H,P,oe,l,F,I,J+R,s):F=p(Z,z=t.negate(z,z),I,F,l,J+R,ie,te),X=t.clone(H,X)):(G=t.add(Z,t.multiplyByScalar(z,ie*N,z),G),W=t.add(G,t.multiplyByScalar(Y,-N,W),W),g[0]=t.clone(X,g[0]),g[1]=t.clone(W,g[1]),$=d(g,Q+R,J+R,h),F=f(u.generateArc({positions:g,granularity:h,ellipsoid:l}),Y,I,F,l,$,1),Y=t.cross(U,k,Y),Y=t.normalize(Y,Y),H=t.add(G,t.multiplyByScalar(Y,-N,H),H),P===i.ROUNDED||P===i.BEVELED?_(G,W,H,P,oe,l,F,I,J+R,s):F=p(Z,z,I,F,l,J+R,ie,te),X=t.clone(H,X)),V=t.negate(k,V)}Q=J,J=c[ee+1],Z=K}g[0]=t.clone(X,g[0]),g[1]=t.clone(Z,g[1]),$=d(g,Q+R,J+R,h),F=f(u.generateArc({positions:g,granularity:h,ellipsoid:l}),Y,I,F,l,$,1),s&&(B=p(Z,Y,O,B,l,J+R,1,1)),L=F.length;var ae=new Float64Array(s?L+B.length:L);return ae.set(F),s&&ae.set(B,L),ae},D}),o("Core/CorridorGeometryLibrary",["./Cartesian3","./CornerType","./defined","./isArray","./Math","./Matrix3","./PolylinePipeline","./PolylineVolumeGeometryLibrary","./Quaternion"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(n,r,a,s,u){var c,h=e.angleBetween(e.subtract(r,n,p),e.subtract(a,n,f)),d=s===t.BEVELED?1:Math.ceil(h/i.toRadians(5))+1,m=3*d,_=new Array(m);_[m-3]=a.x,_[m-2]=a.y,_[m-1]=a.z,c=o.fromQuaternion(l.fromAxisAngle(u?e.negate(n,p):n,h/d,P),D);var g=0;r=e.clone(r,p);for(var v=0;v<d;v++)r=o.multiplyByVector(c,r,r),_[g++]=r.x,_[g++]=r.y,_[g++]=r.z;return _}function c(t,n,r,i){var o=p;return i?o=e.add(t,n,o):(n=e.negate(n,n),o=e.add(t,n,o)),[o.x,o.y,o.z,r.x,r.y,r.z]}function h(t,n,r,i){for(var o=new Array(t.length),a=new Array(t.length),s=e.multiplyByScalar(n,r,p),l=e.negate(s,f),u=0,c=t.length-1,h=0;h<t.length;h+=3){var d=e.fromArray(t,h,m),g=e.add(d,l,_);o[u++]=g.x,o[u++]=g.y,o[u++]=g.z;var v=e.add(d,s,_);a[c--]=v.z,a[c--]=v.y,a[c--]=v.x}return i.push(o,a),i}var d={},p=new e,f=new e,m=new e,_=new e,g=[new e,new e],v=new e,y=new e,C=new e,w=new e,b=new e,E=new e,S=new e,x=new e,T=new e,A=new e,P=new l,D=new o;d.addAttribute=function(e,t,r,i){var o=t.x,a=t.y,s=t.z;n(r)&&(e[r]=o,e[r+1]=a,e[r+2]=s),n(i)&&(e[i]=s,e[i-1]=a,e[i-2]=o)};var M=new e,I=new e;return d.computePositions=function(n){var r=n.granularity,o=n.positions,l=n.ellipsoid;o=function(e,t){for(var n=0;n<e.length;n++)e[n]=t.scaleToGeodeticSurface(e[n],e[n]);return e}(o,l);var d=n.width/2,f=n.cornerType,m=n.saveAttributes,_=v,P=y,D=C,O=w,R=b,N=E,L=S,F=x,B=T,k=A,V=[],z=m?[]:void 0,U=m?[]:void 0,G=o[0],W=o[1];P=e.normalize(e.subtract(W,G,P),P),_=l.geodeticSurfaceNormal(G,_),O=e.normalize(e.cross(_,P,O),O),m&&(z.push(O.x,O.y,O.z),U.push(_.x,_.y,_.z)),L=e.clone(G,L),G=W,D=e.negate(P,D);var H,j,q=[],Y=o.length;for(H=1;H<Y-1;H++){_=l.geodeticSurfaceNormal(G,_),P=e.normalize(e.subtract(W=o[H+1],G,P),P),R=e.normalize(e.add(P,D,R),R);var X=e.multiplyByScalar(_,e.dot(P,_),M);e.subtract(P,X,X),e.normalize(X,X);var Z=e.multiplyByScalar(_,e.dot(D,_),I);if(e.subtract(D,Z,Z),e.normalize(Z,Z),!i.equalsEpsilon(Math.abs(e.dot(X,Z)),1,i.EPSILON7)){R=e.cross(R,_,R),R=e.cross(_,R,R),R=e.normalize(R,R);var K=d/Math.max(.25,e.magnitude(e.cross(R,D,p))),Q=s.angleIsGreaterThanPi(P,D,G,l);R=e.multiplyByScalar(R,K,R),Q?(F=e.add(G,R,F),k=e.add(F,e.multiplyByScalar(O,d,k),k),B=e.add(F,e.multiplyByScalar(O,2*d,B),B),g[0]=e.clone(L,g[0]),g[1]=e.clone(k,g[1]),V=h(a.generateArc({positions:g,granularity:r,ellipsoid:l}),O,d,V),m&&(z.push(O.x,O.y,O.z),U.push(_.x,_.y,_.z)),N=e.clone(B,N),O=e.normalize(e.cross(_,P,O),O),B=e.add(F,e.multiplyByScalar(O,2*d,B),B),L=e.add(F,e.multiplyByScalar(O,d,L),L),q.push(f===t.ROUNDED||f===t.BEVELED?{leftPositions:u(F,N,B,f,Q)}:{leftPositions:c(G,e.negate(R,R),B,Q)})):(B=e.add(G,R,B),k=e.add(B,e.negate(e.multiplyByScalar(O,d,k),k),k),F=e.add(B,e.negate(e.multiplyByScalar(O,2*d,F),F),F),g[0]=e.clone(L,g[0]),g[1]=e.clone(k,g[1]),V=h(a.generateArc({positions:g,granularity:r,ellipsoid:l}),O,d,V),m&&(z.push(O.x,O.y,O.z),U.push(_.x,_.y,_.z)),N=e.clone(F,N),O=e.normalize(e.cross(_,P,O),O),F=e.add(B,e.negate(e.multiplyByScalar(O,2*d,F),F),F),L=e.add(B,e.negate(e.multiplyByScalar(O,d,L),L),L),q.push(f===t.ROUNDED||f===t.BEVELED?{rightPositions:u(B,N,F,f,Q)}:{rightPositions:c(G,R,F,Q)})),D=e.negate(P,D)}G=W}return _=l.geodeticSurfaceNormal(G,_),g[0]=e.clone(L,g[0]),g[1]=e.clone(G,g[1]),V=h(a.generateArc({positions:g,granularity:r,ellipsoid:l}),O,d,V),m&&(z.push(O.x,O.y,O.z),U.push(_.x,_.y,_.z)),f===t.ROUNDED&&(j=function(n){var r=v,i=y,o=C,a=n[1];i=e.fromArray(n[1],a.length-3,i),o=e.fromArray(n[0],0,o);var s=u(r=e.multiplyByScalar(e.add(i,o,r),.5,r),i,o,t.ROUNDED,!1),l=n.length-1,c=n[l-1];return a=n[l],i=e.fromArray(c,c.length-3,i),o=e.fromArray(a,0,o),[s,u(r=e.multiplyByScalar(e.add(i,o,r),.5,r),i,o,t.ROUNDED,!1)]}(V)),{positions:V,corners:q,lefts:z,normals:U,endPositions:j}},d}),o("ThirdParty/earcut-2.1.1",[],function(){"use strict";function e(e,i,o){o=o||2;var a,s,c,d,p,f,m,_=i&&i.length,g=_?i[0]*o:e.length,v=t(e,0,g,o,!0),y=[];if(!v)return y;if(_&&(v=function(e,r,i,o){var a,s,c,d,p,f=[];for(a=0,s=r.length;a<s;a++)c=r[a]*o,d=a<s-1?r[a+1]*o:e.length,p=t(e,c,d,o,!1),p===p.next&&(p.steiner=!0),f.push(h(p));for(f.sort(l),a=0;a<f.length;a++)u(f[a],i),i=n(i,i.next);return i}(e,i,v,o)),e.length>80*o){a=c=e[0],s=d=e[1];for(var C=o;C<g;C+=o)p=e[C],f=e[C+1],p<a&&(a=p),f<s&&(s=f),p>c&&(c=p),f>d&&(d=f);m=Math.max(c-a,d-s)}return r(v,y,o,a,s,m),y}function t(e,t,n,r,i){var o,a;if(i===w(e,t,n,r)>0)for(o=t;o<n;o+=r)a=v(o,e[o],e[o+1],a);else for(o=n-r;o>=t;o-=r)a=v(o,e[o],e[o+1],a);return a&&f(a,a.next)&&(y(a),a=a.next),a}function n(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!f(r,r.next)&&0!==p(r.prev,r,r.next))r=r.next;else{if(y(r),(r=t=r.prev)===r.next)return null;n=!0}}while(n||r!==t);return t}function r(e,t,l,u,h,d,p){if(e){!p&&d&&function(e,t,n,r){var i=e;do{null===i.z&&(i.z=c(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,o,a,s,l,u=1;do{for(n=e,e=null,o=null,a=0;n;){for(a++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(l=u;s>0||l>0&&r;)0===s?(i=r,r=r.nextZ,l--):0!==l&&r?n.z<=r.z?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,l--):(i=n,n=n.nextZ,s--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;n=r}o.nextZ=null,u*=2}while(a>1)}(i)}(e,u,h,d);for(var f,m,_=e;e.prev!==e.next;)if(f=e.prev,m=e.next,d?o(e,u,h,d):i(e))t.push(f.i/l),t.push(e.i/l),t.push(m.i/l),y(e),e=m.next,_=m.next;else if(e=m,e===_){p?1===p?r(e=a(e,t,l),t,l,u,h,d,2):2===p&&s(e,t,l,u,h,d):r(n(e),t,l,u,h,d,1);break}}}function i(e){var t=e.prev,n=e,r=e.next;if(p(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(d(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&p(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function o(e,t,n,r){var i=e.prev,o=e,a=e.next;if(p(i,o,a)>=0)return!1;for(var s=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,u=c(i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,t,n,r),h=c(s,l,t,n,r),f=e.nextZ;f&&f.z<=h;){if(f!==e.prev&&f!==e.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(f=e.prevZ;f&&f.z>=u;){if(f!==e.prev&&f!==e.next&&d(i.x,i.y,o.x,o.y,a.x,a.y,f.x,f.y)&&p(f.prev,f,f.next)>=0)return!1;f=f.prevZ}return!0}function a(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!f(i,o)&&m(i,r,r.next,o)&&_(i,o)&&_(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),y(r),y(r.next),r=e=o),r=r.next}while(r!==e);return r}function s(e,t,i,o,a,s){var l,u,c=e;do{for(var h=c.next.next;h!==c.prev;){if(c.i!==h.i&&(l=c).next.i!==(u=h).i&&l.prev.i!==u.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&m(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(l,u)&&_(l,u)&&_(u,l)&&function(e,t){var n=e,r=!1,i=(e.x+u.x)/2,o=(e.y+u.y)/2;do{n.y>o!=n.next.y>o&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(l)){var d=g(c,h);return c=n(c,c.next),d=n(d,d.next),r(c,t,i,o,a,s),void r(d,t,i,o,a,s)}h=h.next}c=c.next}while(c!==e)}function l(e,t){return e.x-t.x}function u(e,t){if(t=function(e,t){var n,r=t,i=e.x,o=e.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===a)return n.prev;var l,u=n,c=n.x,h=n.y,p=1/0;for(r=n.next;r!==u;)i>=r.x&&r.x>=c&&d(o<h?i:a,o,c,h,o<h?a:i,o,r.x,r.y)&&(l=Math.abs(o-r.y)/(i-r.x),(l<p||l===p&&r.x>n.x)&&_(r,e)&&(n=r,p=l)),r=r.next;return n}(e,t)){var r=g(t,e);n(r,r.next)}}function c(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)/i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)/i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function h(e){var t=e,n=e;do{t.x<n.x&&(n=t),t=t.next}while(t!==e);return n}function d(e,t,n,r,i,o,a,s){return(i-a)*(t-s)-(e-a)*(o-s)>=0&&(e-a)*(r-s)-(n-a)*(t-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function p(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function f(e,t){return e.x===t.x&&e.y===t.y}function m(e,t,n,r){return!!(f(e,t)&&f(n,r)||f(e,r)&&f(n,t))||p(e,t,n)>0!=p(e,t,r)>0&&p(n,r,e)>0!=p(n,r,t)>0}function _(e,t){return p(e.prev,e,e.next)<0?p(e,t,e.next)>=0&&p(e,e.prev,t)>=0:p(e,t,e.prev)<0||p(e,e.next,t)<0}function g(e,t){var n=new C(e.i,e.x,e.y),r=new C(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function v(e,t,n,r){var i=new C(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function y(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function w(e,t,n,r){for(var i=0,o=t,a=n-r;o<n;o+=r)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}return e.deviation=function(e,t,n,r){var i=t&&t.length,o=Math.abs(w(e,0,i?t[0]*n:e.length,n));if(i)for(var a=0,s=t.length;a<s;a++)o-=Math.abs(w(e,t[a]*n,a<s-1?t[a+1]*n:e.length,n));var l=0;for(a=0;a<r.length;a+=3){var u=r[a]*n,c=r[a+1]*n,h=r[a+2]*n;l+=Math.abs((e[u]-e[h])*(e[c+1]-e[u+1])-(e[u]-e[c])*(e[h+1]-e[u+1]))}return 0===o&&0===l?0:Math.abs((l-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)n.vertices.push(e[i][o][a]);i>0&&n.holes.push(r+=e[i-1].length)}return n},e}),o("Core/pointInsideTriangle",["./barycentricCoordinates","./Cartesian3"],function(e,t){"use strict";var n=new t;return function(t,r,i,o){return e(t,r,i,o,n),n.x>0&&n.y>0&&n.z>0}}),o("Core/Queue",["../Core/defineProperties"],function(e){"use strict";function t(){this._array=[],this._offset=0,this._length=0}return e(t.prototype,{length:{get:function(){return this._length}}}),t.prototype.enqueue=function(e){this._array.push(e),this._length++},t.prototype.dequeue=function(){if(0!==this._length){var e=this._array,t=this._offset,n=e[t];return e[t]=void 0,++t>10&&2*t>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,n}},t.prototype.peek=function(){if(0!==this._length)return this._array[this._offset]},t.prototype.contains=function(e){return-1!==this._array.indexOf(e)},t.prototype.clear=function(){this._array.length=this._offset=this._length=0},t.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)},t}),o("Core/WindingOrder",["../Renderer/WebGLConstants","./freezeObject"],function(e,t){"use strict";var n={CLOCKWISE:e.CW,COUNTER_CLOCKWISE:e.CCW,validate:function(e){return e===n.CLOCKWISE||e===n.COUNTER_CLOCKWISE}};return t(n)}),o("Core/PolygonPipeline",["../ThirdParty/earcut-2.1.1","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./Math","./pointInsideTriangle","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m){"use strict";var _=new n,g=new n,v={};v.computeArea2D=function(e){for(var t=e.length,n=0,r=t-1,i=0;i<t;r=i++){var o=e[r],a=e[i];n+=o.x*a.y-a.x*o.y}return.5*n},v.computeWindingOrder2D=function(e){return v.computeArea2D(e)>0?m.COUNTER_CLOCKWISE:m.CLOCKWISE},v.triangulate=function(n,r){var i=t.packArray(n);return e(i,r,2)};var y=new n,C=new n,w=new n,b=new n,E=new n,S=new n,x=new n;return v.computeSubdivision=function(e,t,a,s){s=i(s,h.RADIANS_PER_DEGREE);var l,d=a.slice(0),f=t.length,m=new Array(3*f),_=0;for(l=0;l<f;l++){var g=t[l];m[_++]=g.x,m[_++]=g.y,m[_++]=g.z}for(var v=[],T={},A=e.maximumRadius,P=h.chordLength(s,A),D=P*P;d.length>0;){var M,I,O=d.pop(),R=d.pop(),N=d.pop(),L=n.fromArray(m,3*N,y),F=n.fromArray(m,3*R,C),B=n.fromArray(m,3*O,w),k=n.multiplyByScalar(n.normalize(L,b),A,b),V=n.multiplyByScalar(n.normalize(F,E),A,E),z=n.multiplyByScalar(n.normalize(B,S),A,S),U=n.magnitudeSquared(n.subtract(k,V,x)),G=n.magnitudeSquared(n.subtract(V,z,x)),W=n.magnitudeSquared(n.subtract(z,k,x)),H=Math.max(U,G,W);H>D?U===H?(M=Math.min(N,R)+" "+Math.max(N,R),o(l=T[M])||(I=n.add(L,F,x),n.multiplyByScalar(I,.5,I),m.push(I.x,I.y,I.z),T[M]=l=m.length/3-1),d.push(N,l,O),d.push(l,R,O)):G===H?(M=Math.min(R,O)+" "+Math.max(R,O),o(l=T[M])||(I=n.add(F,B,x),n.multiplyByScalar(I,.5,I),m.push(I.x,I.y,I.z),T[M]=l=m.length/3-1),d.push(R,l,N),d.push(l,O,N)):W===H&&(M=Math.min(O,N)+" "+Math.max(O,N),o(l=T[M])||(I=n.add(B,L,x),n.multiplyByScalar(I,.5,I),m.push(I.x,I.y,I.z),T[M]=l=m.length/3-1),d.push(O,l,R),d.push(l,N,R)):(v.push(N),v.push(R),v.push(O))}return new u({attributes:{position:new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:m})},indices:v,primitiveType:p.TRIANGLES})},v.scaleToGeodeticHeight=function(e,t,r,a){r=i(r,s.WGS84);var l=_,u=g;if(t=i(t,0),a=i(a,!0),o(e))for(var c=e.length,h=0;h<c;h+=3)n.fromArray(e,h,u),a&&(u=r.scaleToGeodeticSurface(u,u)),0!==t&&(l=r.geodeticSurfaceNormal(u,l),n.multiplyByScalar(l,t,l),n.add(u,l,u)),e[h]=u.x,e[h+1]=u.y,e[h+2]=u.z;return e},v}),o("Core/CorridorGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C){"use strict";function w(e,t,r,i,o,s){var l=e.normals,u=e.tangents,c=e.binormals,h=n.normalize(n.cross(r,t,O),O);s.normal&&a.addAttribute(l,t,i,o),s.binormal&&a.addAttribute(c,r,i,o),s.tangent&&a.addAttribute(u,h,i,o)}function b(e,t,r){var o,s,u,c=e.positions,h=e.corners,d=e.endPositions,g=e.lefts,v=e.normals,y=new f,C=0,b=0,E=0;for(s=0;s<c.length;s+=2)u=c[s].length-3,C+=u,E+=2*u,b+=c[s+1].length-3;for(C+=3,b+=3,s=0;s<h.length;s++){o=h[s];var S=h[s].leftPositions;l(S)?(C+=u=S.length,E+=u):(b+=u=h[s].rightPositions.length,E+=u)}var x,M=l(d);M&&(C+=x=d[0].length-3,b+=x,E+=6*(x/=3));var N,L,F,B,k,V,z=C+b,U=new Float64Array(z),G={normals:t.normal?new Float32Array(z):void 0,tangents:t.tangent?new Float32Array(z):void 0,binormals:t.binormal?new Float32Array(z):void 0},W=0,H=z-1,j=T,q=A,Y=x/2,X=m.createTypedArray(z/3,E),Z=0;if(M){V=P,k=D;var K=d[0];for(j=n.fromArray(v,0,j),q=n.fromArray(g,0,q),s=0;s<Y;s++)V=n.fromArray(K,3*(Y-1-s),V),k=n.fromArray(K,3*(Y+s),k),a.addAttribute(U,k,W),a.addAttribute(U,V,void 0,H),w(G,j,q,W,H,t),L=W/3,B=L+1,N=(H-2)/3,F=N-1,X[Z++]=N,X[Z++]=L,X[Z++]=F,X[Z++]=F,X[Z++]=L,X[Z++]=B,W+=3,H-=3}var Q,J,$=0,ee=0,te=c[$++],ne=c[$++];for(U.set(te,W),U.set(ne,H-ne.length+1),q=n.fromArray(g,ee,q),u=ne.length-3,s=0;s<u;s+=3)Q=r.geodeticSurfaceNormal(n.fromArray(te,s,O),O),J=r.geodeticSurfaceNormal(n.fromArray(ne,u-s,R),R),j=n.normalize(n.add(Q,J,j),j),w(G,j,q,W,H,t),L=W/3,B=L+1,N=(H-2)/3,F=N-1,X[Z++]=N,X[Z++]=L,X[Z++]=F,X[Z++]=F,X[Z++]=L,X[Z++]=B,W+=3,H-=3;for(Q=r.geodeticSurfaceNormal(n.fromArray(te,u,O),O),J=r.geodeticSurfaceNormal(n.fromArray(ne,u,R),R),j=n.normalize(n.add(Q,J,j),j),ee+=3,s=0;s<h.length;s++){var re,ie,oe,ae=(o=h[s]).leftPositions,se=o.rightPositions,le=I,ue=P,ce=D;if(j=n.fromArray(v,ee,j),l(ae)){for(w(G,j,q,void 0,H,t),H-=3,ie=B,oe=F,re=0;re<ae.length/3;re++)le=n.fromArray(ae,3*re,le),X[Z++]=ie,X[Z++]=oe-re-1,X[Z++]=oe-re,a.addAttribute(U,le,void 0,H),ue=n.fromArray(U,3*(oe-re-1),ue),ce=n.fromArray(U,3*ie,ce),q=n.normalize(n.subtract(ue,ce,q),q),w(G,j,q,void 0,H,t),H-=3;le=n.fromArray(U,3*ie,le),ue=n.subtract(n.fromArray(U,3*oe,ue),le,ue),ce=n.subtract(n.fromArray(U,3*(oe-re),ce),le,ce),w(G,j,q=n.normalize(n.add(ue,ce,q),q),W,void 0,t),W+=3}else{for(w(G,j,q,W,void 0,t),W+=3,ie=F,oe=B,re=0;re<se.length/3;re++)le=n.fromArray(se,3*re,le),X[Z++]=ie,X[Z++]=oe+re,X[Z++]=oe+re+1,a.addAttribute(U,le,W),ue=n.fromArray(U,3*ie,ue),ce=n.fromArray(U,3*(oe+re),ce),q=n.normalize(n.subtract(ue,ce,q),q),w(G,j,q,W,void 0,t),W+=3;le=n.fromArray(U,3*ie,le),ue=n.subtract(n.fromArray(U,3*(oe+re),ue),le,ue),ce=n.subtract(n.fromArray(U,3*oe,ce),le,ce),w(G,j,q=n.normalize(n.negate(n.add(ce,ue,q),q),q),void 0,H,t),H-=3}for(te=c[$++],ne=c[$++],te.splice(0,3),ne.splice(ne.length-3,3),U.set(te,W),U.set(ne,H-ne.length+1),u=ne.length-3,q=n.fromArray(g,ee+=3,q),re=0;re<ne.length;re+=3)Q=r.geodeticSurfaceNormal(n.fromArray(te,re,O),O),J=r.geodeticSurfaceNormal(n.fromArray(ne,u-re,R),R),j=n.normalize(n.add(Q,J,j),j),w(G,j,q,W,H,t),B=W/3,L=B-1,F=(H-2)/3,N=F+1,X[Z++]=N,X[Z++]=L,X[Z++]=F,X[Z++]=F,X[Z++]=L,X[Z++]=B,W+=3,H-=3;W-=3,H+=3}if(w(G,j=n.fromArray(v,v.length-3,j),q,W,H,t),M){W+=3,H-=3,V=P,k=D;var he=d[1];for(s=0;s<Y;s++)V=n.fromArray(he,3*(x-s-1),V),k=n.fromArray(he,3*s,k),a.addAttribute(U,V,void 0,H),a.addAttribute(U,k,W),w(G,j,q,W,H,t),B=W/3,L=B-1,F=(H-2)/3,N=F+1,X[Z++]=N,X[Z++]=L,X[Z++]=F,X[Z++]=F,X[Z++]=L,X[Z++]=B,W+=3,H-=3}if(y.position=new p({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:U}),t.st){var de,pe,fe=new Float32Array(z/3*2),me=0;if(M){C/=3,b/=3;var _e=Math.PI/(x+1);pe=1/(C-x+1),de=1/(b-x+1);var ge,ve=x/2;for(s=ve+1;s<x+1;s++)ge=_.PI_OVER_TWO+_e*s,fe[me++]=de*(1+Math.cos(ge)),fe[me++]=.5*(1+Math.sin(ge));for(s=1;s<b-x+1;s++)fe[me++]=s*de,fe[me++]=0;for(s=x;s>ve;s--)ge=_.PI_OVER_TWO-s*_e,fe[me++]=1-de*(1+Math.cos(ge)),fe[me++]=.5*(1+Math.sin(ge));for(s=ve;s>0;s--)ge=_.PI_OVER_TWO-_e*s,fe[me++]=1-pe*(1+Math.cos(ge)),fe[me++]=.5*(1+Math.sin(ge));for(s=C-x;s>0;s--)fe[me++]=s*pe,fe[me++]=1;for(s=1;s<ve+1;s++)ge=_.PI_OVER_TWO+_e*s,fe[me++]=pe*(1+Math.cos(ge)),fe[me++]=.5*(1+Math.sin(ge))}else{for(pe=1/((C/=3)-1),de=1/((b/=3)-1),s=0;s<b;s++)fe[me++]=s*de,fe[me++]=0;for(s=C;s>0;s--)fe[me++]=(s-1)*pe,fe[me++]=1}y.st=new p({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:fe})}return t.normal&&(y.normal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:G.normals})),t.tangent&&(y.tangent=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:G.tangents})),t.binormal&&(y.binormal=new p({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:G.binormals})),{attributes:y,indices:X}}function E(e,t,n){n[t++]=e[0],n[t++]=e[1],n[t++]=e[2];for(var r=3;r<e.length;r+=3){var i=e[r],o=e[r+1],a=e[r+2];n[t++]=i,n[t++]=o,n[t++]=a,n[t++]=i,n[t++]=o,n[t++]=a}return n[t++]=e[0],n[t++]=e[1],n[t++]=e[2],n}function S(e,t,r,i,o,a){var s=n.subtract(t,e,N);n.normalize(s,s);var l=r.geodeticSurfaceNormal(e,L),u=n.cross(s,l,N);n.multiplyByScalar(u,i,u);var c=o.latitude,h=o.longitude,d=a.latitude,p=a.longitude;n.add(e,u,L),r.cartesianToCartographic(L,F);var f=F.latitude,m=F.longitude;c=Math.min(c,f),h=Math.min(h,m),d=Math.max(d,f),p=Math.max(p,m),n.subtract(e,u,L),r.cartesianToCartographic(L,F),f=F.latitude,m=F.longitude,c=Math.min(c,f),h=Math.min(h,m),d=Math.max(d,f),p=Math.max(p,m),o.latitude=c,o.longitude=h,a.latitude=d,a.longitude=p}function x(t){var r=(t=s(t,s.EMPTY_OBJECT)).positions,i=t.width;this._positions=r,this._ellipsoid=h.clone(s(t.ellipsoid,h.WGS84)),this._vertexFormat=C.clone(s(t.vertexFormat,C.DEFAULT)),this._width=i,this._height=s(t.height,0),this._extrudedHeight=s(t.extrudedHeight,this._height),this._cornerType=s(t.cornerType,o.ROUNDED),this._granularity=s(t.granularity,_.RADIANS_PER_DEGREE),this._workerName="createCorridorGeometry",this._rectangle=function(t,i,a,s){var l=e(r,n.equalsEpsilon),u=l.length-1;if(0===u||0===a)return new y;var c,h,d=.5*a;if(V.latitude=Number.POSITIVE_INFINITY,V.longitude=Number.POSITIVE_INFINITY,z.latitude=Number.NEGATIVE_INFINITY,z.longitude=Number.NEGATIVE_INFINITY,s===o.ROUNDED){var p=l[0];n.subtract(p,l[1],B),n.normalize(B,B),n.multiplyByScalar(B,d,B),n.add(p,B,k),i.cartesianToCartographic(k,F),c=F.latitude,h=F.longitude,V.latitude=Math.min(V.latitude,c),V.longitude=Math.min(V.longitude,h),z.latitude=Math.max(z.latitude,c),z.longitude=Math.max(z.longitude,h)}for(var f=0;f<u;++f)S(l[f],l[f+1],i,d,V,z);var m=l[u];n.subtract(m,l[u-1],B),n.normalize(B,B),n.multiplyByScalar(B,d,B),n.add(m,B,k),S(m,k,i,d,V,z),s===o.ROUNDED&&(i.cartesianToCartographic(k,F),c=F.latitude,h=F.longitude,V.latitude=Math.min(V.latitude,c),V.longitude=Math.min(V.longitude,h),z.latitude=Math.max(z.latitude,c),z.longitude=Math.max(z.longitude,h));var _=new y;return _.north=z.latitude,_.south=V.latitude,_.east=z.longitude,_.west=V.longitude,_}(0,this._ellipsoid,i,this._cornerType),this.packedLength=1+r.length*n.packedLength+h.packedLength+C.packedLength+y.packedLength+5}var T=new n,A=new n,P=new n,D=new n,M=new n,I=new n,O=new n,R=new n,N=new n,L=new n,F=new r,B=new n,k=new n,V=new r,z=new r;x.pack=function(e,t,r){r=s(r,0);var i=e._positions,o=i.length;t[r++]=o;for(var a=0;a<o;++a,r+=n.packedLength)n.pack(i[a],t,r);return h.pack(e._ellipsoid,t,r),C.pack(e._vertexFormat,t,r+=h.packedLength),y.pack(e._rectangle,t,r+=C.packedLength),r+=y.packedLength,t[r++]=e._width,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._cornerType,t[r]=e._granularity,t};var U=h.clone(h.UNIT_SPHERE),G=new C,W=new y,H={positions:void 0,ellipsoid:U,vertexFormat:G,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0};return x.unpack=function(e,t,r){t=s(t,0);for(var i=e[t++],o=new Array(i),a=0;a<i;++a,t+=n.packedLength)o[a]=n.unpack(e,t);var u=h.unpack(e,t,U),c=C.unpack(e,t+=h.packedLength,G),d=y.unpack(e,t+=C.packedLength,W);t+=y.packedLength;var p=e[t++],f=e[t++],m=e[t++],_=e[t++],g=e[t];return l(r)?(r._positions=o,r._ellipsoid=h.clone(u,r._ellipsoid),r._vertexFormat=C.clone(c,r._vertexFormat),r._width=p,r._height=f,r._extrudedHeight=m,r._cornerType=_,r._granularity=g,r._rectangle=y.clone(d),r):(H.positions=o,H.width=p,H.height=f,H.extrudedHeight=m,H.cornerType=_,H.granularity=g,new x(H))},x.createGeometry=function(r){var i=r._height,o=r._width,s=r._extrudedHeight,l=i!==s,u=e(r._positions,n.equalsEpsilon);if(!(u.length<2||o<=0)){var c,h=r._ellipsoid,p=r._vertexFormat,f={ellipsoid:h,positions:u,width:o,cornerType:r._cornerType,granularity:r._granularity,saveAttributes:!0};if(l){var _=Math.max(i,s);s=Math.min(i,s),f.height=i=_,f.extrudedHeight=s,c=function(e,t){var r=new C({position:t.positon,normal:t.normal||t.binormal,tangent:t.tangent,binormal:t.normal||t.binormal,st:t.st}),i=e.ellipsoid,o=b(a.computePositions(e),r,i),s=e.height,l=e.extrudedHeight,u=o.attributes,c=o.indices,h=u.position.values,d=h.length,p=new Float64Array(6*d),f=new Float64Array(d);f.set(h);var _=new Float64Array(4*d);_=E(h=g.scaleToGeodeticHeight(h,s,i),0,_),_=E(f=g.scaleToGeodeticHeight(f,l,i),2*d,_),p.set(h),p.set(f,d),p.set(_,2*d),u.position.values=p;var v,y=c.length,w=(d/=3)+d,S=m.createTypedArray(p.length/3,2*y+3*w);S.set(c);var x,O,R,N,L=y;for(v=0;v<y;v+=3){var F=c[v],B=c[v+1];S[L++]=c[v+2]+d,S[L++]=B+d,S[L++]=F+d}for(u=function(e,t){if(!(t.normal||t.binormal||t.tangent||t.st))return e;var r,i,o=e.position.values;(t.normal||t.binormal)&&(r=e.normal.values,i=e.binormal.values);var s,l=e.position.values.length/18,u=3*l,c=2*l,h=2*u;if(t.normal||t.binormal||t.tangent){var d=t.normal?new Float32Array(6*u):void 0,p=t.binormal?new Float32Array(6*u):void 0,f=t.tangent?new Float32Array(6*u):void 0,m=T,_=A,g=P,v=D,y=M,C=I,w=h;for(s=0;s<u;s+=3){var b=w+h;m=n.fromArray(o,s,m),_=n.fromArray(o,s+u,_),g=n.fromArray(o,(s+3)%u,g),_=n.subtract(_,m,_),g=n.subtract(g,m,g),v=n.normalize(n.cross(_,g,v),v),t.normal&&(a.addAttribute(d,v,b),a.addAttribute(d,v,b+3),a.addAttribute(d,v,w),a.addAttribute(d,v,w+3)),(t.tangent||t.binormal)&&(C=n.fromArray(r,s,C),t.binormal&&(a.addAttribute(p,C,b),a.addAttribute(p,C,b+3),a.addAttribute(p,C,w),a.addAttribute(p,C,w+3)),t.tangent&&(y=n.normalize(n.cross(C,v,y),y),a.addAttribute(f,y,b),a.addAttribute(f,y,b+3),a.addAttribute(f,y,w),a.addAttribute(f,y,w+3))),w+=6}if(t.normal){for(d.set(r),s=0;s<u;s+=3)d[s+u]=-r[s],d[s+u+1]=-r[s+1],d[s+u+2]=-r[s+2];e.normal.values=d}else e.normal=void 0;if(t.binormal?(p.set(i),p.set(i,u),e.binormal.values=p):e.binormal=void 0,t.tangent){var E=e.tangent.values;f.set(E),f.set(E,u),e.tangent.values=f}}if(t.st){var S=e.st.values,x=new Float32Array(6*c);x.set(S),x.set(S,c);for(var O=2*c,R=0;R<2;R++){for(x[O++]=S[0],x[O++]=S[1],s=2;s<c;s+=2){var N=S[s],L=S[s+1];x[O++]=N,x[O++]=L,x[O++]=N,x[O++]=L}x[O++]=S[0],x[O++]=S[1]}e.st.values=x}return e}(u,t),v=0;v<w;v+=2)x=v+w,O=x+w,R=x+1,N=O+1,S[L++]=x,S[L++]=O,S[L++]=R,S[L++]=R,S[L++]=O,S[L++]=N;return{attributes:u,indices:S}}(f,p)}else(c=b(a.computePositions(f),p,h)).attributes.position.values=g.scaleToGeodeticHeight(c.attributes.position.values,i,h);var y=c.attributes,w=t.fromVertices(y.position.values,void 0,3);return p.position||(c.attributes.position.values=void 0),new d({attributes:y,indices:c.indices,primitiveType:v.TRIANGLES,boundingSphere:w})}},x.createShadowVolume=function(e,t,n){var r=e._granularity,i=e._ellipsoid,o=t(r,i),a=n(r,i);return new x({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:i,granularity:r,extrudedHeight:o,height:a,vertexFormat:C.POSITION_ONLY})},u(x.prototype,{rectangle:{get:function(){return this._rectangle}}}),x}),o("Core/CorridorOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./ComponentDatatype","./CornerType","./CorridorGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";function g(e,t){var a,l,u,c=[],f=e.positions,m=e.corners,_=e.endPositions,g=new d,v=0,b=0,E=0;for(l=0;l<f.length;l+=2)u=f[l].length-3,v+=u,E+=u/3*4,b+=f[l+1].length-3;for(v+=3,b+=3,l=0;l<m.length;l++){a=m[l];var S=m[l].leftPositions;s(S)?(v+=u=S.length,E+=u/3*2):(b+=u=m[l].rightPositions.length,E+=u/3*2)}var x,T=s(_);T&&(v+=x=_[0].length-3,b+=x,E+=4*(x/=3));var A,P,D,M,I,O,R=v+b,N=new Float64Array(R),L=0,F=R-1,B=x/2,k=p.createTypedArray(R/3,E+4),V=0;if(k[V++]=L/3,k[V++]=(F-2)/3,T){c.push(L/3),O=y,I=C;var z=_[0];for(l=0;l<B;l++)O=n.fromArray(z,3*(B-1-l),O),I=n.fromArray(z,3*(B+l),I),o.addAttribute(N,I,L),o.addAttribute(N,O,void 0,F),P=L/3,M=P+1,A=(F-2)/3,D=A-1,k[V++]=A,k[V++]=D,k[V++]=P,k[V++]=M,L+=3,F-=3}var U=0,G=f[U++],W=f[U++];for(N.set(G,L),N.set(W,F-W.length+1),u=W.length-3,c.push(L/3,(F-2)/3),l=0;l<u;l+=3)P=L/3,M=P+1,A=(F-2)/3,D=A-1,k[V++]=A,k[V++]=D,k[V++]=P,k[V++]=M,L+=3,F-=3;for(l=0;l<m.length;l++){var H,j,q=(a=m[l]).leftPositions,Y=a.rightPositions,X=w;if(s(q)){for(F-=3,j=D,c.push(M),H=0;H<q.length/3;H++)X=n.fromArray(q,3*H,X),k[V++]=j-H-1,k[V++]=j-H,o.addAttribute(N,X,void 0,F),F-=3;c.push(j-Math.floor(q.length/6)),t===i.BEVELED&&c.push((F-2)/3+1),L+=3}else{for(L+=3,j=M,c.push(D),H=0;H<Y.length/3;H++)X=n.fromArray(Y,3*H,X),k[V++]=j+H,k[V++]=j+H+1,o.addAttribute(N,X,L),L+=3;c.push(j+Math.floor(Y.length/6)),t===i.BEVELED&&c.push(L/3-1),F-=3}for(G=f[U++],W=f[U++],G.splice(0,3),W.splice(W.length-3,3),N.set(G,L),N.set(W,F-W.length+1),u=W.length-3,H=0;H<W.length;H+=3)M=L/3,P=M-1,D=(F-2)/3,A=D+1,k[V++]=A,k[V++]=D,k[V++]=P,k[V++]=M,L+=3,F-=3;c.push((L-=3)/3,((F+=3)-2)/3)}if(T){L+=3,F-=3,O=y,I=C;var Z=_[1];for(l=0;l<B;l++)O=n.fromArray(Z,3*(x-l-1),O),I=n.fromArray(Z,3*l,I),o.addAttribute(N,O,void 0,F),o.addAttribute(N,I,L),M=L/3,P=M-1,D=(F-2)/3,A=D+1,k[V++]=A,k[V++]=D,k[V++]=P,k[V++]=M,L+=3,F-=3;c.push(L/3)}else c.push(L/3,(F-2)/3);return k[V++]=L/3,k[V++]=(F-2)/3,g.position=new h({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:N}),{attributes:g,indices:k,wallIndices:c}}function v(e){var t=(e=a(e,a.EMPTY_OBJECT)).positions,r=e.width;this._positions=t,this._ellipsoid=u.clone(a(e.ellipsoid,u.WGS84)),this._width=r,this._height=a(e.height,0),this._extrudedHeight=a(e.extrudedHeight,this._height),this._cornerType=a(e.cornerType,i.ROUNDED),this._granularity=a(e.granularity,f.RADIANS_PER_DEGREE),this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*n.packedLength+u.packedLength+5}var y=new n,C=new n,w=new n;v.pack=function(e,t,r){r=a(r,0);var i=e._positions,o=i.length;t[r++]=o;for(var s=0;s<o;++s,r+=n.packedLength)n.pack(i[s],t,r);return u.pack(e._ellipsoid,t,r),r+=u.packedLength,t[r++]=e._width,t[r++]=e._height,t[r++]=e._extrudedHeight,t[r++]=e._cornerType,t[r]=e._granularity,t};var b=u.clone(u.UNIT_SPHERE),E={positions:void 0,ellipsoid:b,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0};return v.unpack=function(e,t,r){t=a(t,0);for(var i=e[t++],o=new Array(i),l=0;l<i;++l,t+=n.packedLength)o[l]=n.unpack(e,t);var c=u.unpack(e,t,b);t+=u.packedLength;var h=e[t++],d=e[t++],p=e[t++],f=e[t++],m=e[t];return s(r)?(r._positions=o,r._ellipsoid=u.clone(c,r._ellipsoid),r._width=h,r._height=d,r._extrudedHeight=p,r._cornerType=f,r._granularity=m,r):(E.positions=o,E.width=h,E.height=d,E.extrudedHeight=p,E.cornerType=f,E.granularity=m,new v(E))},v.createGeometry=function(r){var i=r._height,a=r._width,s=r._extrudedHeight,l=i!==s,u=e(r._positions,n.equalsEpsilon);if(!(u.length<2||a<=0)){var h,d=r._ellipsoid,f={ellipsoid:d,positions:u,width:a,cornerType:r._cornerType,granularity:r._granularity,saveAttributes:!1};if(l){var v=Math.max(i,s);s=Math.min(i,s),f.height=i=v,f.extrudedHeight=s,h=function(e){var t=e.ellipsoid,n=g(o.computePositions(e),e.cornerType),r=n.wallIndices,i=e.height,a=e.extrudedHeight,s=n.attributes,l=n.indices,u=s.position.values,c=u.length,h=new Float64Array(c);h.set(u);var d=new Float64Array(2*c);u=m.scaleToGeodeticHeight(u,i,t),h=m.scaleToGeodeticHeight(h,a,t),d.set(u),d.set(h,c),s.position.values=d,c/=3;var f,_=l.length,v=p.createTypedArray(d.length/3,2*(_+r.length));v.set(l);var y,C,w=_;for(f=0;f<_;f+=2){var b=l[f+1];v[w++]=l[f]+c,v[w++]=b+c}for(f=0;f<r.length;f++)y=r[f],C=y+c,v[w++]=y,v[w++]=C;return{attributes:s,indices:v}}(f)}else(h=g(o.computePositions(f),f.cornerType)).attributes.position.values=m.scaleToGeodeticHeight(h.attributes.position.values,i,d);var y=h.attributes,C=t.fromVertices(y.position.values,void 0,3);return new c({attributes:y,indices:h.indices,primitiveType:_.LINES,boundingSphere:C})}},v}),o("Core/createGuid",[],function(){"use strict";return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}}),o("Core/CylinderGeometryLibrary",["./Math"],function(e){"use strict";var t={};return t.computePositions=function(t,n,r,i,o){var a,s=.5*t,l=-s,u=i+i,c=new Float64Array(3*(o?2*u:u)),h=0,d=0,p=o?3*u:0,f=o?3*(u+i):3*i;for(a=0;a<i;a++){var m=a/i*e.TWO_PI,_=Math.cos(m),g=Math.sin(m),v=_*r,y=g*r,C=_*n,w=g*n;c[d+p]=v,c[d+p+1]=y,c[d+p+2]=l,c[d+f]=C,c[d+f+1]=w,c[d+f+2]=s,d+=3,o&&(c[h++]=v,c[h++]=y,c[h++]=l,c[h++]=C,c[h++]=w,c[h++]=s)}return c},t}),o("Core/CylinderGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e){var t=(e=o(e,o.EMPTY_OBJECT)).length,n=e.topRadius,r=e.bottomRadius,i=o(e.vertexFormat,f.DEFAULT),a=o(e.slices,128);this._length=t,this._topRadius=n,this._bottomRadius=r,this._vertexFormat=f.clone(i),this._slices=a,this._workerName="createCylinderGeometry"}var _=new t,g=new n,v=new n,y=new n,C=new n;m.packedLength=f.packedLength+4,m.pack=function(e,t,n){return n=o(n,0),f.pack(e._vertexFormat,t,n),n+=f.packedLength,t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n]=e._slices,t};var w=new f,b={vertexFormat:w,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0};return m.unpack=function(e,t,n){t=o(t,0);var r=f.unpack(e,t,w);t+=f.packedLength;var i=e[t++],s=e[t++],l=e[t++],u=e[t];return a(n)?(n._vertexFormat=f.clone(r,n._vertexFormat),n._length=i,n._topRadius=s,n._bottomRadius=l,n._slices=u,n):(b.length=i,b.topRadius=s,b.bottomRadius=l,b.slices=u,new m(b))},m.createGeometry=function(o){var a=o._length,s=o._topRadius,f=o._bottomRadius,m=o._vertexFormat,w=o._slices;if(!(a<=0||s<0||f<0||0===s&&0===f)){var b,E=w+w,S=w+E,x=E+E,T=i.computePositions(a,s,f,w,!0),A=m.st?new Float32Array(2*x):void 0,P=m.normal?new Float32Array(3*x):void 0,D=m.tangent?new Float32Array(3*x):void 0,M=m.binormal?new Float32Array(3*x):void 0,I=m.normal||m.tangent||m.binormal;if(I){var O=m.tangent||m.binormal,R=0,N=0,L=0,F=g;F.z=0;var B=y,k=v;for(b=0;b<w;b++){var V=b/w*d.TWO_PI,z=Math.cos(V),U=Math.sin(V);I&&(F.x=z,F.y=U,O&&(B=n.normalize(n.cross(n.UNIT_Z,F,B),B)),m.normal&&(P[R++]=z,P[R++]=U,P[R++]=0,P[R++]=z,P[R++]=U,P[R++]=0),m.tangent&&(D[N++]=B.x,D[N++]=B.y,D[N++]=B.z,D[N++]=B.x,D[N++]=B.y,D[N++]=B.z),m.binormal&&(k=n.normalize(n.cross(F,B,k),k),M[L++]=k.x,M[L++]=k.y,M[L++]=k.z,M[L++]=k.x,M[L++]=k.y,M[L++]=k.z))}for(b=0;b<w;b++)m.normal&&(P[R++]=0,P[R++]=0,P[R++]=-1),m.tangent&&(D[N++]=1,D[N++]=0,D[N++]=0),m.binormal&&(M[L++]=0,M[L++]=-1,M[L++]=0);for(b=0;b<w;b++)m.normal&&(P[R++]=0,P[R++]=0,P[R++]=1),m.tangent&&(D[N++]=1,D[N++]=0,D[N++]=0),m.binormal&&(M[L++]=0,M[L++]=1,M[L++]=0)}var G=h.createTypedArray(x,12*w-12),W=0,H=0;for(b=0;b<w-1;b++)G[W++]=H,G[W++]=H+2,G[W++]=H+3,G[W++]=H,G[W++]=H+3,G[W++]=H+1,H+=2;for(G[W++]=E-2,G[W++]=0,G[W++]=1,G[W++]=E-2,G[W++]=1,G[W++]=E-1,b=1;b<w-1;b++)G[W++]=E+b+1,G[W++]=E+b,G[W++]=E;for(b=1;b<w-1;b++)G[W++]=S,G[W++]=S+b,G[W++]=S+b+1;var j=0;if(m.st){var q=Math.max(s,f);for(b=0;b<x;b++){var Y=n.fromArray(T,3*b,C);A[j++]=(Y.x+q)/(2*q),A[j++]=(Y.y+q)/(2*q)}}var X=new c;m.position&&(X.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:T})),m.normal&&(X.normal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:P})),m.tangent&&(X.tangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:D})),m.binormal&&(X.binormal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:M})),m.st&&(X.st=new u({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:A})),_.x=.5*a,_.y=Math.max(f,s);var Z=new e(n.ZERO,t.magnitude(_));return new l({attributes:X,indices:G,primitiveType:p.TRIANGLES,boundingSphere:Z})}},m}),o("Core/CylinderOutlineGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CylinderGeometryLibrary","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(e){var t=(e=o(e,o.EMPTY_OBJECT)).length,n=e.topRadius,r=e.bottomRadius,i=o(e.slices,128),a=Math.max(o(e.numberOfVerticalLines,16),0);this._length=t,this._topRadius=n,this._bottomRadius=r,this._slices=i,this._numberOfVerticalLines=a,this._workerName="createCylinderOutlineGeometry"}var f=new t;p.packedLength=5,p.pack=function(e,t,n){return n=o(n,0),t[n++]=e._length,t[n++]=e._topRadius,t[n++]=e._bottomRadius,t[n++]=e._slices,t[n]=e._numberOfVerticalLines,t};var m={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0};return p.unpack=function(e,t,n){t=o(t,0);var r=e[t++],i=e[t++],s=e[t++],l=e[t++],u=e[t];return a(n)?(n._length=r,n._topRadius=i,n._bottomRadius=s,n._slices=l,n._numberOfVerticalLines=u,n):(m.length=r,m.topRadius=i,m.bottomRadius=s,m.slices=l,m.numberOfVerticalLines=u,new p(m))},p.createGeometry=function(o){var a=o._length,s=o._topRadius,p=o._bottomRadius,m=o._slices,_=o._numberOfVerticalLines;if(!(a<=0||s<0||p<0||0===s&&0===p)){var g,v=2*m,y=i.computePositions(a,s,p,m,!1),C=2*m;if(_>0){var w=Math.min(_,m);g=Math.round(m/w),C+=w}for(var b=h.createTypedArray(v,2*C),E=0,S=0;S<m-1;S++)b[E++]=S,b[E++]=S+1,b[E++]=S+m,b[E++]=S+1+m;if(b[E++]=m-1,b[E++]=0,b[E++]=m+m-1,b[E++]=m,_>0)for(S=0;S<m;S+=g)b[E++]=S,b[E++]=S+m;var x=new c;x.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:y}),f.x=.5*a,f.y=Math.max(p,s);var T=new e(n.ZERO,t.magnitude(f));return new l({attributes:x,indices:b,primitiveType:d.LINES,boundingSphere:T})}},p}),o("Core/DefaultProxy",[],function(){"use strict";function e(e){this.proxy=e}return e.prototype.getURL=function(e){var t=-1===this.proxy.indexOf("?")?"?":"";return this.proxy+t+encodeURIComponent(e)},e}),o("Core/DistanceDisplayCondition",["./Cartesian3","./defaultValue","./defined","./defineProperties"],function(e,t,n,r){"use strict";function i(e,n){e=t(e,0),this._near=e,n=t(n,Number.MAX_VALUE),this._far=n}return r(i.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),i.equals=function(e,t){return e===t||n(e)&&n(t)&&e.near===t.near&&e.far===t.far},i.clone=function(e,t){if(n(e))return n(t)||(t=new i),t.near=e.near,t.far=e.far,t},i.prototype.clone=function(e){return i.clone(this,e)},i.prototype.equals=function(e){return i.equals(this,e)},i}),o("Core/DistanceDisplayConditionGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,n,r,i){"use strict";function o(e,n){e=t(e,0),n=t(n,Number.MAX_VALUE),this.value=new Float32Array([e,n])}return r(o.prototype,{componentDatatype:{get:function(){return e.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),o.fromDistanceDisplayCondition=function(e){return new o(e.near,e.far)},o.toValue=function(e,t){return n(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])},o}),o("ThirdParty/Tween",[],function(){void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var e,t,n=n||(e=[],{REVISION:"13",getAll:function(){return e},removeAll:function(){e=[]},add:function(t){e.push(t)},remove:function(t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)},update:function(t){if(0===e.length)return!1;var n=0;for(t=void 0!==t?t:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();n<e.length;)e[n].update(t)?n++:e.splice(n,1);return!0}});return n.Tween=function(e){var t=e,r={},i={},o={},a=1e3,s=0,l=!1,u=!1,c=!1,h=0,d=null,p=n.Easing.Linear.None,f=n.Interpolation.Linear,m=[],_=null,g=!1,v=null,y=null,C=null;for(var w in e)r[w]=parseFloat(e[w],10);this.to=function(e,t){return void 0!==t&&(a=t),i=e,this},this.start=function(e){n.add(this),u=!0,g=!1,d=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),d+=h;for(var a in i){if(i[a]instanceof Array){if(0===i[a].length)continue;i[a]=[t[a]].concat(i[a])}r[a]=t[a],r[a]instanceof Array==0&&(r[a]*=1),o[a]=r[a]||0}return this},this.stop=function(){return u?(n.remove(this),u=!1,null!==C&&C.call(t),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var e=0,t=m.length;e<t;e++)m[e].stop()},this.delay=function(e){return h=e,this},this.repeat=function(e){return s=e,this},this.yoyo=function(e){return l=e,this},this.easing=function(e){return p=e,this},this.interpolation=function(e){return f=e,this},this.chain=function(){return m=arguments,this},this.onStart=function(e){return _=e,this},this.onUpdate=function(e){return v=e,this},this.onComplete=function(e){return y=e,this},this.onStop=function(e){return C=e,this},this.update=function(e){var n;if(e<d)return!0;!1===g&&(null!==_&&_.call(t),g=!0);var u=(e-d)/a,C=p(u=u>1?1:u);for(n in i){var w=r[n]||0,b=i[n];b instanceof Array?t[n]=f(b,C):("string"==typeof b&&(b=w+parseFloat(b,10)),"number"==typeof b&&(t[n]=w+(b-w)*C))}if(null!==v&&v.call(t,C),1==u){if(s>0){isFinite(s)&&s--;for(n in o){if("string"==typeof i[n]&&(o[n]=o[n]+parseFloat(i[n],10)),l){var E=o[n];o[n]=i[n],i[n]=E}r[n]=o[n]}return l&&(c=!c),d=e+h,!0}null!==y&&y.call(t);for(var S=0,x=m.length;S<x;S++)m[S].start(e);return!1}return!0}},n.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||n<1?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?n*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:n*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){return e*e*(2.70158*e-1.70158)},Out:function(e){return--e*e*(2.70158*e+1.70158)+1},InOut:function(e){return(e*=2)<1?e*e*(3.5949095*e-2.5949095)*.5:.5*((e-=2)*e*(3.5949095*e+2.5949095)+2)}},Bounce:{In:function(e){return 1-n.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*n.Easing.Bounce.In(2*e):.5*n.Easing.Bounce.Out(2*e-1)+.5}}},n.Interpolation={Linear:function(e,t){var r=e.length-1,i=r*t,o=Math.floor(i),a=n.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],i):t>1?a(e[r],e[r-1],r-i):a(e[o],e[o+1>r?r:o+1],i-o)},Bezier:function(e,t){var r,i=0,o=e.length-1,a=Math.pow,s=n.Interpolation.Utils.Bernstein;for(r=0;r<=o;r++)i+=a(1-t,o-r)*a(t,r)*e[r]*s(o,r);return i},CatmullRom:function(e,t){var r=e.length-1,i=r*t,o=Math.floor(i),a=n.Interpolation.Utils.CatmullRom;return e[0]===e[r]?(t<0&&(o=Math.floor(i=r*(1+t))),a(e[(o-1+r)%r],e[o],e[(o+1)%r],e[(o+2)%r],i-o)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[r]-(a(e[r],e[r],e[r-1],e[r-1],i-r)-e[r]):a(e[o?o-1:0],e[o],e[r<o+1?r:o+1],e[r<o+2?r:o+2],i-o)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var r=n.Interpolation.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:(t=[1],function(e){var n,r=1;if(t[e])return t[e];for(n=e;n>1;n--)r*=n;return t[e]=r}),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t),s=i*i;return(2*t-2*n+o+a)*(i*s)+(-3*t+3*n-2*o-a)*s+o*i+t}}},n}),o("Core/EasingFunction",["../ThirdParty/Tween","./freezeObject"],function(e,t){"use strict";return t({LINEAR_NONE:e.Easing.Linear.None,QUADRACTIC_IN:e.Easing.Quadratic.In,QUADRACTIC_OUT:e.Easing.Quadratic.Out,QUADRACTIC_IN_OUT:e.Easing.Quadratic.InOut,CUBIC_IN:e.Easing.Cubic.In,CUBIC_OUT:e.Easing.Cubic.Out,CUBIC_IN_OUT:e.Easing.Cubic.InOut,QUARTIC_IN:e.Easing.Quartic.In,QUARTIC_OUT:e.Easing.Quartic.Out,QUARTIC_IN_OUT:e.Easing.Quartic.InOut,QUINTIC_IN:e.Easing.Quintic.In,QUINTIC_OUT:e.Easing.Quintic.Out,QUINTIC_IN_OUT:e.Easing.Quintic.InOut,SINUSOIDAL_IN:e.Easing.Sinusoidal.In,SINUSOIDAL_OUT:e.Easing.Sinusoidal.Out,SINUSOIDAL_IN_OUT:e.Easing.Sinusoidal.InOut,EXPONENTIAL_IN:e.Easing.Exponential.In,EXPONENTIAL_OUT:e.Easing.Exponential.Out,EXPONENTIAL_IN_OUT:e.Easing.Exponential.InOut,CIRCULAR_IN:e.Easing.Circular.In,CIRCULAR_OUT:e.Easing.Circular.Out,CIRCULAR_IN_OUT:e.Easing.Circular.InOut,ELASTIC_IN:e.Easing.Elastic.In,ELASTIC_OUT:e.Easing.Elastic.Out,ELASTIC_IN_OUT:e.Easing.Elastic.InOut,BACK_IN:e.Easing.Back.In,BACK_OUT:e.Easing.Back.Out,BACK_IN_OUT:e.Easing.Back.InOut,BOUNCE_IN:e.Easing.Bounce.In,BOUNCE_OUT:e.Easing.Bounce.Out,BOUNCE_IN_OUT:e.Easing.Bounce.InOut})}),o("Core/EllipsoidGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e){e=i(e,i.EMPTY_OBJECT);var t=i(e.radii,w),r=i(e.stackPartitions,64),o=i(e.slicePartitions,64),a=i(e.vertexFormat,f.DEFAULT);this._radii=n.clone(t),this._stackPartitions=r,this._slicePartitions=o,this._vertexFormat=f.clone(a),this._workerName="createEllipsoidGeometry"}var _=new n,g=new n,v=new n,y=new n,C=new n,w=new n(1,1,1),b=Math.cos,E=Math.sin;m.packedLength=n.packedLength+f.packedLength+2,m.pack=function(e,t,r){return r=i(r,0),n.pack(e._radii,t,r),f.pack(e._vertexFormat,t,r+=n.packedLength),r+=f.packedLength,t[r++]=e._stackPartitions,t[r]=e._slicePartitions,t};var S=new n,x=new f,T={radii:S,vertexFormat:x,stackPartitions:void 0,slicePartitions:void 0};return m.unpack=function(e,t,r){t=i(t,0);var a=n.unpack(e,t,S),s=f.unpack(e,t+=n.packedLength,x);t+=f.packedLength;var l=e[t++],u=e[t];return o(r)?(r._radii=n.clone(a,r._radii),r._vertexFormat=f.clone(s,r._vertexFormat),r._stackPartitions=l,r._slicePartitions=u,r):(T.stackPartitions=l,T.slicePartitions=u,new m(T))},m.createGeometry=function(i){var o=i._radii;if(!(o.x<=0||o.y<=0||o.z<=0)){var a,f,m=s.fromCartesian3(o),w=i._vertexFormat,S=i._slicePartitions+1,x=i._stackPartitions+1,T=x*S,A=new Float64Array(3*T),P=h.createTypedArray(T,6*(S-1)*(x-2)),D=w.normal?new Float32Array(3*T):void 0,M=w.tangent?new Float32Array(3*T):void 0,I=w.binormal?new Float32Array(3*T):void 0,O=w.st?new Float32Array(2*T):void 0,R=new Array(S),N=new Array(S),L=0;for(a=0;a<S;a++){var F=d.TWO_PI*a/(S-1);R[a]=b(F),N[a]=E(F),A[L++]=0,A[L++]=0,A[L++]=o.z}for(a=1;a<x-1;a++){var B=Math.PI*a/(x-1),k=E(B),V=o.x*k,z=o.y*k,U=o.z*b(B);for(f=0;f<S;f++)A[L++]=R[f]*V,A[L++]=N[f]*z,A[L++]=U}for(a=0;a<S;a++)A[L++]=0,A[L++]=0,A[L++]=-o.z;var G=new c;w.position&&(G.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:A}));var W,H,j=0,q=0,Y=0,X=0;if(w.st||w.normal||w.tangent||w.binormal){for(a=0;a<T;a++){var Z=n.fromArray(A,3*a,_),K=m.geodeticSurfaceNormal(Z,g);if(w.st){var Q=t.negate(K,C);t.magnitude(Q)<d.EPSILON6&&((L=3*(a+S*Math.floor(.5*x)))>A.length&&(L=3*(a-S*Math.floor(.5*x))),n.fromArray(A,L,Q),m.geodeticSurfaceNormal(Q,Q),t.negate(Q,Q)),O[j++]=Math.atan2(Q.y,Q.x)/d.TWO_PI+.5,O[j++]=Math.asin(K.z)/Math.PI+.5}if(w.normal&&(D[q++]=K.x,D[q++]=K.y,D[q++]=K.z),w.tangent||w.binormal){var J=v;if(a<S||a>T-S-1?(n.cross(n.UNIT_X,K,J),n.normalize(J,J)):(n.cross(n.UNIT_Z,K,J),n.normalize(J,J)),w.tangent&&(M[Y++]=J.x,M[Y++]=J.y,M[Y++]=J.z),w.binormal){var $=n.cross(K,J,y);n.normalize($,$),I[X++]=$.x,I[X++]=$.y,I[X++]=$.z}}}w.st&&(G.st=new u({componentDatatype:r.FLOAT,componentsPerAttribute:2,values:O})),w.normal&&(G.normal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:D})),w.tangent&&(G.tangent=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:M})),w.binormal&&(G.binormal=new u({componentDatatype:r.FLOAT,componentsPerAttribute:3,values:I}))}for(L=0,f=0;f<S-1;f++)P[L++]=S+f,P[L++]=S+f+1,P[L++]=f+1;for(a=1;a<x-2;a++)for(W=a*S,H=(a+1)*S,f=0;f<S-1;f++)P[L++]=H+f,P[L++]=H+f+1,P[L++]=W+f+1,P[L++]=H+f,P[L++]=W+f+1,P[L++]=W+f;for(W=(a=x-2)*S,H=(a+1)*S,f=0;f<S-1;f++)P[L++]=H+f,P[L++]=W+f+1,P[L++]=W+f;return new l({attributes:G,indices:P,primitiveType:p.TRIANGLES,boundingSphere:e.fromEllipsoid(m)})}},m}),o("Core/EllipsoidOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(e){e=r(e,r.EMPTY_OBJECT);var n=r(e.radii,f),i=r(e.stackPartitions,10),o=r(e.slicePartitions,8),a=r(e.subdivisions,128);this._radii=t.clone(n),this._stackPartitions=i,this._slicePartitions=o,this._subdivisions=a,this._workerName="createEllipsoidOutlineGeometry"}var f=new t(1,1,1),m=Math.cos,_=Math.sin;p.packedLength=t.packedLength+3,p.pack=function(e,n,i){return i=r(i,0),t.pack(e._radii,n,i),i+=t.packedLength,n[i++]=e._stackPartitions,n[i++]=e._slicePartitions,n[i]=e._subdivisions,n};var g=new t,v={radii:g,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};return p.unpack=function(e,n,o){n=r(n,0);var a=t.unpack(e,n,g);n+=t.packedLength;var s=e[n++],l=e[n++],u=e[n++];return i(o)?(o._radii=t.clone(a,o._radii),o._stackPartitions=s,o._slicePartitions=l,o._subdivisions=u,o):(v.stackPartitions=s,v.slicePartitions=l,v.subdivisions=u,new p(v))},p.createGeometry=function(t){var r=t._radii;if(!(r.x<=0||r.y<=0||r.z<=0)){var i,o,p,f,g,v,y=a.fromCartesian3(r),C=t._stackPartitions,w=t._slicePartitions,b=t._subdivisions,E=b*(C+w-1),S=E-w+2,x=new Float64Array(3*S),T=c.createTypedArray(S,2*E),A=0,P=new Array(b),D=new Array(b);for(i=0;i<b;i++)p=h.TWO_PI*i/b,P[i]=m(p),D[i]=_(p);for(i=1;i<C;i++)for(f=Math.PI*i/C,g=m(f),v=_(f),o=0;o<b;o++)x[A++]=r.x*P[o]*v,x[A++]=r.y*D[o]*v,x[A++]=r.z*g;for(P.length=w,D.length=w,i=0;i<w;i++)p=h.TWO_PI*i/w,P[i]=m(p),D[i]=_(p);for(x[A++]=0,x[A++]=0,x[A++]=r.z,i=1;i<b;i++)for(f=Math.PI*i/b,g=m(f),v=_(f),o=0;o<w;o++)x[A++]=r.x*P[o]*v,x[A++]=r.y*D[o]*v,x[A++]=r.z*g;for(x[A++]=0,x[A++]=0,x[A++]=-r.z,A=0,i=0;i<C-1;++i){var M=i*b;for(o=0;o<b-1;++o)T[A++]=M+o,T[A++]=M+o+1;T[A++]=M+b-1,T[A++]=M}var I=b*(C-1);for(o=1;o<w+1;++o)T[A++]=I,T[A++]=I+o;for(i=0;i<b-2;++i){var O=i*w+1+I,R=(i+1)*w+1+I;for(o=0;o<w-1;++o)T[A++]=R+o,T[A++]=O+o;T[A++]=R+w-1,T[A++]=O+w-1}var N=x.length/3-1;for(o=N-1;o>N-w-1;--o)T[A++]=N,T[A++]=o;var L=new u({position:new l({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:x})});return new s({attributes:L,indices:T,primitiveType:d.LINES,boundingSphere:e.fromEllipsoid(y)})}},p}),o("Core/EllipsoidTerrainProvider",["../ThirdParty/when","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Event","./GeographicTilingScheme","./HeightmapTerrainData","./TerrainProvider"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(r){r=t(r,{}),this._tilingScheme=r.tilingScheme,n(this._tilingScheme)||(this._tilingScheme=new a({ellipsoid:t(r.ellipsoid,i.WGS84)})),this._levelZeroMaximumGeometricError=l.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new o,this._readyPromise=e.resolve(!0)}return r(u.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),u.prototype.requestTileGeometry=function(e,t,n,r){return new s({buffer:new Uint8Array(256),width:16,height:16})},u.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},u.prototype.getTileDataAvailable=function(e,t,n){},u}),o("Core/EventHelper",["./defined","./DeveloperError"],function(e,t){"use strict";function n(){this._removalFunctions=[]}return n.prototype.add=function(e,t,n){var r=e.addEventListener(t,n);this._removalFunctions.push(r);var i=this;return function(){r();var e=i._removalFunctions;e.splice(e.indexOf(r),1)}},n.prototype.removeAll=function(){for(var e=this._removalFunctions,t=0,n=e.length;t<n;++t)e[t]();e.length=0},n}),o("Core/ExtrapolationType",["./freezeObject"],function(e){"use strict";return e({NONE:0,HOLD:1,EXTRAPOLATE:2})}),o("Core/GeometryInstanceAttribute",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";return function(t){t=e(t,e.EMPTY_OBJECT),this.componentDatatype=t.componentDatatype,this.componentsPerAttribute=t.componentsPerAttribute,this.normalize=e(t.normalize,!1),this.value=t.value}}),o("Core/getBaseUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";return function(n,r){var i="",o=n.lastIndexOf("/");return-1!==o&&(i=n.substring(0,o+1)),r?(n=new e(n),t(n.query)&&(i+="?"+n.query),t(n.fragment)&&(i+="#"+n.fragment),i):i}}),o("Core/getExtensionFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";return function(t){var n=new e(t);n.normalize();var r=n.path,i=r.lastIndexOf("/");return-1!==i&&(r=r.substr(i+1)),-1===(i=r.lastIndexOf("."))?"":r.substr(i+1)}}),o("Core/getFilenameFromUri",["../ThirdParty/Uri","./defined","./DeveloperError"],function(e,t,n){"use strict";return function(t){var n=new e(t);n.normalize();var r=n.path,i=r.lastIndexOf("/");return-1!==i&&(r=r.substr(i+1)),r}}),o("Core/getStringFromTypedArray",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t,n,i){return n=e(n,0),i=e(i,t.byteLength-n),t=t.subarray(n,n+i),r.decode(t)}return r.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)},r.decodeWithFromCharCode=function(e){for(var t="",n=e.length,r=0;r<n;++r)t+=String.fromCharCode(e[r]);return t},r.decode="undefined"!=typeof TextDecoder?r.decodeWithTextDecoder:r.decodeWithFromCharCode,r}),o("Core/getMagic",["../Core/defaultValue","../Core/getStringFromTypedArray"],function(e,t){"use strict";return function(n,r){return r=e(r,0),t(n,r,Math.min(4,n.length))}}),o("Core/HeadingPitchRange",["./defaultValue","./defined"],function(e,t){"use strict";function n(t,n,r){this.heading=e(t,0),this.pitch=e(n,0),this.range=e(r,0)}return n.clone=function(e,r){if(t(e))return t(r)||(r=new n),r.heading=e.heading,r.pitch=e.pitch,r.range=e.range,r},n}),o("Core/HermitePolynomialApproximation",["./defaultValue","./defined","./DeveloperError","./Math"],function(e,t,n,r){"use strict";function i(e,t,n,r,o,a){var s,l,u,c=0;if(r>0){for(l=0;l<o;l++){for(s=!1,u=0;u<a.length&&!s;u++)l===a[u]&&(s=!0);s||(a.push(l),c+=i(e,t,n,r-1,o,a),a.splice(a.length-1,1))}return c}for(c=1,l=0;l<o;l++){for(s=!1,u=0;u<a.length&&!s;u++)l===a[u]&&(s=!0);s||(c*=e-n[t[l]])}return c}var o=r.factorial,a={type:"Hermite"};a.getRequiredDataPoints=function(t,n){return n=e(n,0),Math.max(Math.floor((t+1)/(n+1)),2)},a.interpolateOrderZero=function(e,n,r,a,s){t(s)||(s=new Array(a));var l,u,c,h,d,p=n.length,f=new Array(a);for(l=0;l<a;l++){s[l]=0;var m=new Array(p);for(f[l]=m,u=0;u<p;u++)m[u]=[]}var _=p,g=new Array(_);for(l=0;l<_;l++)g[l]=l;var v=p-1;for(h=0;h<a;h++){for(u=0;u<_;u++)d=g[u]*a+h,f[h][0].push(r[d]);for(l=1;l<_;l++){var y=!1;for(u=0;u<_-l;u++){var C,w=n[g[u]],b=n[g[u+l]];f[h][l].push(b-w<=0?(C=r[d=g[u]*a+a*l+h])/o(l):(C=f[h][l-1][u+1]-f[h][l-1][u])/(b-w)),y=y||0!==C}y||(v=l-1)}}for(c=0;c<=0;c++)for(l=c;l<=v;l++){var E=i(e,g,n,c,l,[]);for(h=0;h<a;h++)s[h+c*a]+=f[h][l][0]*E}return s};var s=[];return a.interpolate=function(e,n,o,a,l,u,c){var h=a*(u+1);t(c)||(c=new Array(h));for(var d=0;d<h;d++)c[d]=0;for(var p=n.length,f=new Array(p*(l+1)),m=0;m<p;m++)for(var _=0;_<l+1;_++)f[m*(l+1)+_]=m;for(var g=f.length,v=s,y=function(e,t,n,i,o,a){for(var s,l,u=-1,c=t.length,h=c*(c+1)/2,d=0;d<o;d++){var p=Math.floor(d*h);for(s=0;s<c;s++)l=t[s]*o*(a+1)+d,e[p+s]=i[l];for(var f=1;f<c;f++){var m=0,_=Math.floor(f*(1-f)/2)+c*f,g=!1;for(s=0;s<c-f;s++){var v,y,C=n[t[s]],w=n[t[s+f]];if(w-C<=0)l=t[s]*o*(a+1)+o*f+d,v=i[l],y=v/r.factorial(f),e[p+_+m]=y,m++;else{var b=Math.floor((f-1)*(2-f)/2)+c*(f-1);e[p+_+m]=y=(v=e[p+b+s+1]-e[p+b+s])/(w-C),m++}g=g||0!==v}g&&(u=Math.max(u,f))}}return u}(v,f,n,o,a,l),C=[],w=g*(g+1)/2,b=Math.min(y,u),E=0;E<=b;E++)for(m=E;m<=y;m++){C.length=0;for(var S=i(e,f,n,E,m,C),x=Math.floor(m*(1-m)/2)+g*m,T=0;T<a;T++){var A=Math.floor(T*w);c[T+E*a]+=v[A+x]*S}}return c},a}),o("Core/IauOrientationParameters",[],function(){"use strict";return function(e,t,n,r){this.rightAscension=e,this.declination=t,this.rotation=n,this.rotationRate=r}}),o("Core/Iau2000Orientation",["./defined","./IauOrientationParameters","./JulianDate","./Math","./TimeConstants"],function(e,t,n,r,i){"use strict";var o={},a=new n;return o.ComputeMoon=function(o,s){e(o)||(o=n.now()),a=n.addSeconds(o,32.184,a);var l=n.totalDays(a)-2451545,u=l/i.DAYS_PER_JULIAN_CENTURY,c=(125.045+-.0529921*l)*r.RADIANS_PER_DEGREE,h=(250.089+-.1059842*l)*r.RADIANS_PER_DEGREE,d=(260.008+13.0120009*l)*r.RADIANS_PER_DEGREE,p=(176.625+13.3407154*l)*r.RADIANS_PER_DEGREE,f=(357.529+.9856003*l)*r.RADIANS_PER_DEGREE,m=(311.589+26.4057084*l)*r.RADIANS_PER_DEGREE,_=(134.963+13.064993*l)*r.RADIANS_PER_DEGREE,g=(276.617+.3287146*l)*r.RADIANS_PER_DEGREE,v=(34.226+1.7484877*l)*r.RADIANS_PER_DEGREE,y=(15.134+-.1589763*l)*r.RADIANS_PER_DEGREE,C=(119.743+.0036096*l)*r.RADIANS_PER_DEGREE,w=(239.961+.1643573*l)*r.RADIANS_PER_DEGREE,b=(25.053+12.9590088*l)*r.RADIANS_PER_DEGREE,E=Math.sin(c),S=Math.sin(h),x=Math.sin(d),T=Math.sin(p),A=Math.sin(f),P=Math.sin(m),D=Math.sin(_),M=Math.sin(g),I=Math.sin(v),O=Math.sin(y),R=Math.sin(C),N=Math.sin(w),L=Math.sin(b),F=Math.cos(c),B=Math.cos(h),k=Math.cos(d),V=Math.cos(p),z=Math.cos(f),U=Math.cos(m),G=Math.cos(_),W=Math.cos(g),H=Math.cos(v),j=Math.cos(y),q=Math.cos(C),Y=Math.cos(w),X=Math.cos(b),Z=(269.9949+.0031*u-3.8787*E-.1204*S+.07*x-.0172*T+.0072*P-.0052*O+.0043*L)*r.RADIANS_PER_DEGREE,K=(66.5392+.013*u+1.5419*F+.0239*B-.0278*k+.0068*V-.0029*U+9e-4*G+8e-4*j-9e-4*X)*r.RADIANS_PER_DEGREE,Q=(38.3213+13.17635815*l-1.4e-12*l*l+3.561*E+.1208*S-.0642*x+.0158*T+.0252*A-.0066*P-.0047*D-.0046*M+.0028*I+.0052*O+.004*R+.0019*N-.0044*L)*r.RADIANS_PER_DEGREE,J=(13.17635815-2*l*1.4e-12+3.561*F*-.0529921+.1208*B*-.1059842-.0642*k*13.0120009+.0158*V*13.3407154+.0252*z*.9856003-.0066*U*26.4057084-.0047*G*13.064993-.0046*W*.3287146+.0028*H*1.7484877+.0052*j*-.1589763+.004*q*.0036096+.0019*Y*.1643573-.0044*X*12.9590088)/86400*r.RADIANS_PER_DEGREE;return e(s)||(s=new t),s.rightAscension=Z,s.declination=K,s.rotation=Q,s.rotationRate=J,s},o}),o("Core/IauOrientationAxes",["./Cartesian3","./defined","./Iau2000Orientation","./JulianDate","./Math","./Matrix3","./Quaternion"],function(e,t,n,r,i,o,a){"use strict";function s(e){t(e)&&"function"==typeof e||(e=n.ComputeMoon),this._computeFunction=e}var l=new e,u=new e,c=new e,h=new o,d=new a;return s.prototype.evaluate=function(n,s){t(n)||(n=r.now());var p=this._computeFunction(n),f=function(n,r,a){var s=l;s.x=Math.cos(n+i.PI_OVER_TWO),s.y=Math.sin(n+i.PI_OVER_TWO),s.z=0;var h=Math.cos(r),d=c;d.x=h*Math.cos(n),d.y=h*Math.sin(n),d.z=Math.sin(r);var p=e.cross(d,s,u);return t(a)||(a=new o),a[0]=s.x,a[1]=p.x,a[2]=d.x,a[3]=s.y,a[4]=p.y,a[5]=d.y,a[6]=s.z,a[7]=p.z,a[8]=d.z,a}(p.rightAscension,p.declination,s),m=i.zeroToTwoPi(p.rotation),_=a.fromAxisAngle(e.UNIT_Z,m,d),g=o.fromQuaternion(a.conjugate(_,_),h);return o.multiply(g,f,f)},s}),o("Core/InterpolationAlgorithm",["./DeveloperError"],function(e){"use strict";var t={};return t.type=void 0,t.getRequiredDataPoints=e.throwInstantiationError,t.interpolateOrderZero=e.throwInstantiationError,t.interpolate=e.throwInstantiationError,t}),o("Core/TimeInterval",["./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject","./JulianDate"],function(e,t,n,r,i,o){"use strict";function a(n){n=e(n,e.EMPTY_OBJECT),this.start=t(n.start)?o.clone(n.start):new o,this.stop=t(n.stop)?o.clone(n.stop):new o,this.data=n.data,this.isStartIncluded=e(n.isStartIncluded,!0),this.isStopIncluded=e(n.isStopIncluded,!0)}n(a.prototype,{isEmpty:{get:function(){var e=o.compare(this.stop,this.start);return e<0||0===e&&(!this.isStartIncluded||!this.isStopIncluded)}}});var s={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};return a.fromIso8601=function(n,r){var i=n.iso8601.split("/"),l=o.fromIso8601(i[0]),u=o.fromIso8601(i[1]),c=e(n.isStartIncluded,!0),h=e(n.isStopIncluded,!0),d=n.data;return t(r)?(r.start=l,r.stop=u,r.isStartIncluded=c,r.isStopIncluded=h,r.data=d,r):(s.start=l,s.stop=u,s.isStartIncluded=c,s.isStopIncluded=h,s.data=d,new a(s))},a.toIso8601=function(e,t){return o.toIso8601(e.start,t)+"/"+o.toIso8601(e.stop,t)},a.clone=function(e,n){if(t(e))return t(n)?(n.start=e.start,n.stop=e.stop,n.isStartIncluded=e.isStartIncluded,n.isStopIncluded=e.isStopIncluded,n.data=e.data,n):new a(e)},a.equals=function(e,n,r){return e===n||t(e)&&t(n)&&(e.isEmpty&&n.isEmpty||e.isStartIncluded===n.isStartIncluded&&e.isStopIncluded===n.isStopIncluded&&o.equals(e.start,n.start)&&o.equals(e.stop,n.stop)&&(e.data===n.data||t(r)&&r(e.data,n.data)))},a.equalsEpsilon=function(e,n,r,i){return e===n||t(e)&&t(n)&&(e.isEmpty&&n.isEmpty||e.isStartIncluded===n.isStartIncluded&&e.isStopIncluded===n.isStopIncluded&&o.equalsEpsilon(e.start,n.start,r)&&o.equalsEpsilon(e.stop,n.stop,r)&&(e.data===n.data||t(i)&&i(e.data,n.data)))},a.intersect=function(e,n,r,i){if(!t(n))return a.clone(a.EMPTY,r);var s=e.start,l=e.stop,u=n.start,c=n.stop,h=o.greaterThanOrEquals(u,s)&&o.greaterThanOrEquals(l,u),d=!h&&o.lessThanOrEquals(u,s)&&o.lessThanOrEquals(s,c);if(!h&&!d)return a.clone(a.EMPTY,r);var p=e.isStartIncluded,f=e.isStopIncluded,m=n.isStartIncluded,_=n.isStopIncluded,g=o.lessThan(l,c);return r.start=h?u:s,r.isStartIncluded=p&&m||!o.equals(u,s)&&(h&&m||d&&p),r.stop=g?l:c,r.isStopIncluded=g?f:f&&_||!o.equals(c,l)&&_,r.data=t(i)?i(e.data,n.data):e.data,r},a.contains=function(e,t){if(e.isEmpty)return!1;var n=o.compare(e.start,t);if(0===n)return e.isStartIncluded;var r=o.compare(t,e.stop);return 0===r?e.isStopIncluded:n<0&&r<0},a.prototype.clone=function(e){return a.clone(this,e)},a.prototype.equals=function(e,t){return a.equals(this,e,t)},a.prototype.equalsEpsilon=function(e,t,n){return a.equalsEpsilon(this,e,t,n)},a.prototype.toString=function(){return a.toIso8601(this)},a.EMPTY=i(new a({start:new o,stop:new o,isStartIncluded:!1,isStopIncluded:!1})),a}),o("Core/Iso8601",["./freezeObject","./JulianDate","./TimeInterval"],function(e,t,n){"use strict";var r=e(t.fromIso8601("0000-01-01T00:00:00Z")),i=e(t.fromIso8601("9999-12-31T24:00:00Z"));return{MINIMUM_VALUE:r,MAXIMUM_VALUE:i,MAXIMUM_INTERVAL:e(new n({start:r,stop:i}))}}),o("Core/KeyboardEventModifier",["./freezeObject"],function(e){"use strict";return e({SHIFT:0,CTRL:1,ALT:2})}),o("Core/LagrangePolynomialApproximation",["./defined"],function(e){"use strict";var t={type:"Lagrange"};return t.getRequiredDataPoints=function(e){return Math.max(e+1,2)},t.interpolateOrderZero=function(t,n,r,i,o){e(o)||(o=new Array(i));var a,s,l=n.length;for(a=0;a<i;a++)o[a]=0;for(a=0;a<l;a++){var u=1;for(s=0;s<l;s++)s!==a&&(u*=(t-n[s])/(n[a]-n[s]));for(s=0;s<i;s++)o[s]+=u*r[a*i+s]}return o},t}),o("Core/LinearApproximation",["./defined","./DeveloperError"],function(e,t){"use strict";var n={type:"Linear"};return n.getRequiredDataPoints=function(e){return 2},n.interpolateOrderZero=function(t,n,r,i,o){e(o)||(o=new Array(i));var a,s,l,u=n[0],c=n[1];for(a=0;a<i;a++)s=r[a],l=r[a+i],o[a]=((l-s)*t+c*s-u*l)/(c-u);return o},n}),o("Core/loadBlob",["./loadWithXhr"],function(e){"use strict";return function(t,n){return e({url:t,responseType:"blob",headers:n})}}),o("Core/loadImageFromTypedArray",["../ThirdParty/when","./defined","./DeveloperError","./loadImage"],function(e,t,n,r){"use strict";return function(t,n){var i=new Blob([t],{type:n}),o=window.URL.createObjectURL(i);return r(o,!1).then(function(e){return window.URL.revokeObjectURL(o),e},function(t){return window.URL.revokeObjectURL(o),e.reject(t)})}}),o("Core/loadImageViaBlob",["../ThirdParty/when","./loadBlob","./loadImage"],function(e,t,n){"use strict";var r=/^data:/;return function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}()?function(i){return r.test(i)?n(i):t(i).then(function(t){var r=window.URL.createObjectURL(t);return n(r,!1).then(function(e){return e.blob=t,window.URL.revokeObjectURL(r),e},function(t){return window.URL.revokeObjectURL(r),e.reject(t)})})}:n}),o("Core/objectToQuery",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";return function(e){var t="";for(var r in e)if(e.hasOwnProperty(r)){var i=e[r],o=encodeURIComponent(r)+"=";if(n(i))for(var a=0,s=i.length;a<s;++a)t+=o+encodeURIComponent(i[a])+"&";else t+=o+encodeURIComponent(i)+"&"}return t.slice(0,-1)}}),o("Core/queryToObject",["./defined","./DeveloperError","./isArray"],function(e,t,n){"use strict";return function(t){var r={};if(""===t)return r;for(var i=t.replace(/\+/g,"%20").split("&"),o=0,a=i.length;o<a;++o){var s=i[o].split("="),l=decodeURIComponent(s[0]),u=s[1];u=e(u)?decodeURIComponent(u):"";var c=r[l];"string"==typeof c?r[l]=[c,u]:n(c)?c.push(u):r[l]=u}return r}}),o("Core/loadJsonp",["../ThirdParty/Uri","../ThirdParty/when","./combine","./defaultValue","./defined","./DeveloperError","./objectToQuery","./queryToObject"],function(e,t,n,r,i,o,a,s){"use strict";function l(o,u){var c;u=r(u,r.EMPTY_OBJECT);do{c="loadJsonp"+Math.random().toString().substring(2,8)}while(i(window[c]));var h=t.defer();window[c]=function(e){h.resolve(e);try{delete window[c]}catch(e){window[c]=void 0}};var d=new e(o),p=s(r(d.query,""));i(u.parameters)&&(p=n(u.parameters,p)),p[r(u.callbackParameterName,"callback")]=c,d.query=a(p),o=d.toString();var f=u.proxy;return i(f)&&(o=f.getURL(o)),l.loadAndExecuteScript(o,c,h),h.promise}return l.defaultLoadAndExecuteScript=l.loadAndExecuteScript=function(e,t,n){var r=document.createElement("script");r.async=!0,r.src=e;var i=document.getElementsByTagName("head")[0];r.onload=function(){r.onload=void 0,i.removeChild(r)},r.onerror=function(e){n.reject(e)},i.appendChild(r)},l}),o("Core/loadXML",["./loadWithXhr"],function(e){"use strict";return function(t,n){return e({url:t,responseType:"document",headers:n,overrideMimeType:"text/xml"})}}),o("Core/MapboxApi",["./defined"],function(e){"use strict";var t={};t.defaultAccessToken=void 0;var n=!1;return t.getAccessToken=function(r){return e(r)?r:e(t.defaultAccessToken)?t.defaultAccessToken:(n||(console.log("This application is using Cesium's default Mapbox access token.  Please create a new access token for the application as soon as possible and prior to deployment by visiting https://www.mapbox.com/account/apps/, and provide your token to Cesium by setting the Cesium.MapboxApi.defaultAccessToken property before constructing the CesiumWidget or any other object that uses the Mapbox API."),n=!0),"pk.eyJ1IjoiYW5hbHl0aWNhbGdyYXBoaWNzIiwiYSI6IjA2YzBjOTM3YzFlYzljYmQ5NDAxZWI1Y2ZjNzZlM2E1In0.vDZL2SPFEpi_f7ziAIP_yw")},t}),o("Core/MapProjection",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function n(){t.throwInstantiationError()}return e(n.prototype,{ellipsoid:{get:t.throwInstantiationError}}),n.prototype.project=t.throwInstantiationError,n.prototype.unproject=t.throwInstantiationError,n}),o("Core/Matrix2",["./Cartesian2","./defaultValue","./defined","./defineProperties","./DeveloperError","./freezeObject"],function(e,t,n,r,i,o){"use strict";function a(e,n,r,i){this[0]=t(e,0),this[1]=t(r,0),this[2]=t(n,0),this[3]=t(i,0)}a.packedLength=4,a.pack=function(e,n,r){return r=t(r,0),n[r++]=e[0],n[r++]=e[1],n[r++]=e[2],n[r++]=e[3],n},a.unpack=function(e,r,i){return r=t(r,0),n(i)||(i=new a),i[0]=e[r++],i[1]=e[r++],i[2]=e[r++],i[3]=e[r++],i},a.clone=function(e,t){if(n(e))return n(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new a(e[0],e[2],e[1],e[3])},a.fromArray=function(e,r,i){return r=t(r,0),n(i)||(i=new a),i[0]=e[r],i[1]=e[r+1],i[2]=e[r+2],i[3]=e[r+3],i},a.fromColumnMajorArray=function(e,t){return a.clone(e,t)},a.fromRowMajorArray=function(e,t){return n(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new a(e[0],e[1],e[2],e[3])},a.fromScale=function(e,t){return n(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new a(e.x,0,0,e.y)},a.fromUniformScale=function(e,t){return n(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new a(e,0,0,e)},a.fromRotation=function(e,t){var r=Math.cos(e),i=Math.sin(e);return n(t)?(t[0]=r,t[1]=i,t[2]=-i,t[3]=r,t):new a(r,-i,i,r)},a.toArray=function(e,t){return n(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},a.getElementIndex=function(e,t){return 2*e+t},a.getColumn=function(e,t,n){var r=2*t,i=e[r+1];return n.x=e[r],n.y=i,n},a.setColumn=function(e,t,n,r){var i=2*t;return(r=a.clone(e,r))[i]=n.x,r[i+1]=n.y,r},a.getRow=function(e,t,n){var r=e[t+2];return n.x=e[t],n.y=r,n},a.setRow=function(e,t,n,r){return(r=a.clone(e,r))[t]=n.x,r[t+2]=n.y,r};var s=new e;a.getScale=function(t,n){return n.x=e.magnitude(e.fromElements(t[0],t[1],s)),n.y=e.magnitude(e.fromElements(t[2],t[3],s)),n};var l=new e;return a.getMaximumScale=function(t){return a.getScale(t,l),e.maximumComponent(l)},a.multiply=function(e,t,n){var r=e[0]*t[2]+e[2]*t[3],i=e[1]*t[0]+e[3]*t[1],o=e[1]*t[2]+e[3]*t[3];return n[0]=e[0]*t[0]+e[2]*t[1],n[1]=i,n[2]=r,n[3]=o,n},a.add=function(e,t,n){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},a.subtract=function(e,t,n){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},a.multiplyByVector=function(e,t,n){var r=e[1]*t.x+e[3]*t.y;return n.x=e[0]*t.x+e[2]*t.y,n.y=r,n},a.multiplyByScalar=function(e,t,n){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},a.multiplyByScale=function(e,t,n){return n[0]=e[0]*t.x,n[1]=e[1]*t.x,n[2]=e[2]*t.y,n[3]=e[3]*t.y,n},a.negate=function(e,t){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},a.transpose=function(e,t){var n=e[2],r=e[1],i=e[3];return t[0]=e[0],t[1]=n,t[2]=r,t[3]=i,t},a.abs=function(e,t){return t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},a.equals=function(e,t){return e===t||n(e)&&n(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},a.equalsArray=function(e,t,n){return e[0]===t[n]&&e[1]===t[n+1]&&e[2]===t[n+2]&&e[3]===t[n+3]},a.equalsEpsilon=function(e,t,r){return e===t||n(e)&&n(t)&&Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r},a.IDENTITY=o(new a(1,0,0,1)),a.ZERO=o(new a(0,0,0,0)),a.COLUMN0ROW0=0,a.COLUMN0ROW1=1,a.COLUMN1ROW0=2,a.COLUMN1ROW1=3,r(a.prototype,{length:{get:function(){return a.packedLength}}}),a.prototype.clone=function(e){return a.clone(this,e)},a.prototype.equals=function(e){return a.equals(this,e)},a.prototype.equalsEpsilon=function(e,t){return a.equalsEpsilon(this,e,t)},a.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"},a}),o("Core/mergeSort",["./defined","./DeveloperError"],function(e,t){"use strict";var n=[],r=[];return function(e,t,i){var o=e.length,a=Math.ceil(.5*o);n.length=a,r.length=a,function e(t,i,o,a,s){if(!(a>=s)){var l=Math.floor(.5*(a+s));e(t,i,o,a,l),e(t,i,o,l+1,s),function(e,t,i,o,a,s){var l,u,c=a-o+1,h=s-a,d=n,p=r;for(l=0;l<c;++l)d[l]=e[o+l];for(u=0;u<h;++u)p[u]=e[a+u+1];l=0,u=0;for(var f=o;f<=s;++f){var m=d[l],_=p[u];l<c&&(u>=h||t(m,_,i)<=0)?(e[f]=m,++l):u<h&&(e[f]=_,++u)}}(t,i,o,a,l,s)}}(e,t,i,0,o-1),n.length=0,r.length=0}}),o("Core/NearFarScalar",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t,n,r,i){this.near=e(t,0),this.nearValue=e(n,0),this.far=e(r,1),this.farValue=e(i,0)}return r.clone=function(e,n){if(t(e))return t(n)?(n.near=e.near,n.nearValue=e.nearValue,n.far=e.far,n.farValue=e.farValue,n):new r(e.near,e.nearValue,e.far,e.farValue)},r.packedLength=4,r.pack=function(t,n,r){return r=e(r,0),n[r++]=t.near,n[r++]=t.nearValue,n[r++]=t.far,n[r]=t.farValue,n},r.unpack=function(n,i,o){return i=e(i,0),t(o)||(o=new r),o.near=n[i++],o.nearValue=n[i++],o.far=n[i++],o.farValue=n[i],o},r.equals=function(e,n){return e===n||t(e)&&t(n)&&e.near===n.near&&e.nearValue===n.nearValue&&e.far===n.far&&e.farValue===n.farValue},r.prototype.clone=function(e){return r.clone(this,e)},r.prototype.equals=function(e){return r.equals(this,e)},r}),o("Core/Visibility",["./freezeObject"],function(e){"use strict";return e({NONE:-1,PARTIAL:0,FULL:1})}),o("Core/Occluder",["./BoundingSphere","./Cartesian3","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Math","./Rectangle","./Visibility"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,n){this._occluderPosition=t.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=n}var h=new t;i(c.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){e=t.clone(e,this._cameraPosition);var n,r,i,o=t.subtract(this._occluderPosition,e,h),a=t.magnitudeSquared(o),s=this._occluderRadius*this._occluderRadius;a>s?(n=Math.sqrt(a-s),a=1/Math.sqrt(a),r=t.multiplyByScalar(o,a,h),i=t.add(e,t.multiplyByScalar(r,n*n*a,h),h)):n=Number.MAX_VALUE,this._horizonDistance=n,this._horizonPlaneNormal=r,this._horizonPlanePosition=i,this._cameraPosition=e}}}),c.fromBoundingSphere=function(e,n,i){return r(i)?(t.clone(e.center,i._occluderPosition),i._occluderRadius=e.radius,i.cameraPosition=n,i):new c(e,n)};var d=new t;c.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var n=t.subtract(e,this._occluderPosition,d),r=this._occluderRadius;if((r=t.magnitudeSquared(n)-r*r)>0)return r=Math.sqrt(r)+this._horizonDistance,n=t.subtract(e,this._cameraPosition,n),r*r>t.magnitudeSquared(n)}return!1};var p=new t;c.prototype.isBoundingSphereVisible=function(e){var n=t.clone(e.center,p),r=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var i=t.subtract(n,this._occluderPosition,d),o=this._occluderRadius-r;if(o=t.magnitudeSquared(i)-o*o,r<this._occluderRadius)return o>0&&(o=Math.sqrt(o)+this._horizonDistance,i=t.subtract(n,this._cameraPosition,i),o*o+r*r>t.magnitudeSquared(i));if(o>0){i=t.subtract(n,this._cameraPosition,i);var a=t.magnitudeSquared(i),s=this._occluderRadius*this._occluderRadius,l=r*r;return(this._horizonDistance*this._horizonDistance+s)*l>a*s||(o=Math.sqrt(o)+this._horizonDistance)*o+l>a}return!0}return!1};var f=new t;c.prototype.computeVisibility=function(e){var n=t.clone(e.center),r=e.radius;if(r>this._occluderRadius)return u.FULL;if(this._horizonDistance!==Number.MAX_VALUE){var i=t.subtract(n,this._occluderPosition,f),o=this._occluderRadius-r,a=t.magnitudeSquared(i);if((o=a-o*o)>0){o=Math.sqrt(o)+this._horizonDistance,i=t.subtract(n,this._cameraPosition,i);var s=t.magnitudeSquared(i);return o*o+r*r<s?u.NONE:(o=a-(o=this._occluderRadius+r)*o)>0?s<(o=Math.sqrt(o)+this._horizonDistance)*o+r*r?u.FULL:u.PARTIAL:(i=t.subtract(n,this._horizonPlanePosition,i),t.dot(i,this._horizonPlaneNormal)>-r?u.PARTIAL:u.FULL)}}return u.NONE};var m=new t;c.computeOccludeePoint=function(e,n,r){var i=t.clone(n),o=t.clone(e.center),a=e.radius,s=r.length,l=t.normalize(t.subtract(i,o,m),m),u=-t.dot(l,o),h=c._anyRotationVector(o,l,u),d=c._horizonToPlaneNormalDotProduct(e,l,u,h,r[0]);if(d){for(var p,f=1;f<s;++f){if(!(p=c._horizonToPlaneNormalDotProduct(e,l,u,h,r[f])))return;p<d&&(d=p)}if(!(d<.0017453283658983088))return t.add(o,t.multiplyByScalar(l,a/d,m),m)}};var _=[];c.computeOccludeePointFromRectangle=function(r,i){i=n(i,a.WGS84);var o=l.subsample(r,i,0,_),s=e.fromPoints(o),u=t.ZERO;if(!t.equals(u,s.center))return c.computeOccludeePoint(new e(u,i.minimumRadius),s.center,o)};var g=new t;c._anyRotationVector=function(e,n,r){var i=t.abs(n,g),o=i.x>i.y?0:1;(0===o&&i.z>i.x||1===o&&i.z>i.y)&&(o=2);var a,s=new t;0===o?(i.x=e.x,i.y=e.y+1,i.z=e.z+1,a=t.UNIT_X):1===o?(i.x=e.x+1,i.y=e.y,i.z=e.z+1,a=t.UNIT_Y):(i.x=e.x+1,i.y=e.y+1,i.z=e.z,a=t.UNIT_Z);var l=(t.dot(n,i)+r)/-t.dot(n,a);return t.normalize(t.subtract(t.add(i,t.multiplyByScalar(a,l,s),i),e,i),i)};var v=new t;c._rotationVector=function(e,n,r,i,o){var a=t.subtract(i,e,v);if(a=t.normalize(a,a),t.dot(n,a)<.9999999847691291){var l=t.cross(n,a,a);if(t.magnitude(l)>s.EPSILON13)return t.normalize(l,new t)}return o};var y=new t,C=new t,w=new t,b=new t;return c._horizonToPlaneNormalDotProduct=function(e,n,r,i,o){var a=t.clone(o,y),s=t.clone(e.center,C),l=e.radius,u=t.subtract(s,a,w),c=t.magnitudeSquared(u),h=l*l;if(c<h)return!1;var d=c-h,p=Math.sqrt(d),f=p*(1/Math.sqrt(c))*p;u=t.normalize(u,u);var m=t.add(a,t.multiplyByScalar(u,f,b),b),_=Math.sqrt(d-f*f),g=this._rotationVector(s,n,r,a,i),v=t.fromElements(g.x*g.x*u.x+(g.x*g.y-g.z)*u.y+(g.x*g.z+g.y)*u.z,(g.x*g.y+g.z)*u.x+g.y*g.y*u.y+(g.y*g.z-g.x)*u.z,(g.x*g.z-g.y)*u.x+(g.y*g.z+g.x)*u.y+g.z*g.z*u.z,y);v=t.normalize(v,v);var E=t.multiplyByScalar(v,_,y);g=t.normalize(t.subtract(t.add(m,E,w),s,w),w);var S=t.dot(n,g);g=t.normalize(t.subtract(t.subtract(m,E,g),s,g),g);var x=t.dot(n,g);return S<x?S:x},c}),o("Core/Packable",["./DeveloperError"],function(e){"use strict";return{packedLength:void 0,pack:e.throwInstantiationError,unpack:e.throwInstantiationError}}),o("Core/PackableForInterpolation",["./DeveloperError"],function(e){"use strict";return{packedInterpolationLength:void 0,convertPackedArrayForInterpolation:e.throwInstantiationError,unpackInterpolationResult:e.throwInstantiationError}}),o("ThirdParty/measureText",[],function(){var e=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)};return function(t,n,r,i){var o=t.measureText(n),a=e(t.canvas,"font-family"),s=e(t.canvas,"font-size").replace("px",""),l=e(t.canvas,"font-style"),u=e(t.canvas,"font-weight"),c=!/\S/.test(n);o.fontsize=s;var h=document.createElement("div");h.style.position="absolute",h.style.opacity=0,h.style.font=l+" "+u+" "+s+"px "+a,h.innerHTML=n+"<br/>"+n,document.body.appendChild(h),o.leading=1.2*s;var d=e(h,"height");if((d=d.replace("px",""))>=2*s&&(o.leading=d/2|0),document.body.removeChild(h),c)o.ascent=0,o.descent=0,o.bounds={minx:0,maxx:o.width,miny:0,maxy:0},o.height=0;else{var p=document.createElement("canvas");p.width=o.width+100,p.height=3*s,p.style.opacity=1,p.style.fontFamily=a,p.style.fontSize=s,p.style.fontStyle=l,p.style.fontWeight=u;var f=p.getContext("2d");f.font=l+" "+u+" "+s+"px "+a;var m=p.width,_=p.height,g=_/2;f.fillStyle="white",f.fillRect(-1,-1,m+2,_+2),r&&(f.strokeStyle="black",f.lineWidth=t.lineWidth,f.strokeText(n,50,g)),i&&(f.fillStyle="black",f.fillText(n,50,g));for(var v=f.getImageData(0,0,m,_).data,y=0,C=4*m,w=v.length;++y<w&&255===v[y];);var b=y/C|0;for(y=w-1;--y>0&&255===v[y];);var E=y/C|0;for(y=0;y<w&&255===v[y];)y+=C,y>=w&&(y=y-w+4);var S=y%C/4|0,x=1;for(y=w-3;y>=0&&255===v[y];)y-=C,y<0&&(y=w-3-4*x++);var T=y%C/4+1|0;o.ascent=g-b,o.descent=E-g,o.bounds={minx:S-50,maxx:T-50,miny:0,maxy:E-b},o.height=E-b+1}return o}}),o("Core/writeTextToCanvas",["../ThirdParty/measureText","./Color","./defaultValue","./defined","./DeveloperError"],function(e,t,n,r,i){"use strict";var o;return function(i,a){if(""!==i){a=n(a,n.EMPTY_OBJECT);var s=n(a.font,"10px sans-serif"),l=n(a.stroke,!1),u=n(a.fill,!0),c=n(a.strokeWidth,1),h=n(a.backgroundColor,t.TRANSPARENT),d=n(a.padding,0),p=2*d,f=document.createElement("canvas");f.width=1,f.height=1,f.style.font=s;var m=f.getContext("2d");r(o)||(r(m.imageSmoothingEnabled)?o="imageSmoothingEnabled":r(m.mozImageSmoothingEnabled)?o="mozImageSmoothingEnabled":r(m.webkitImageSmoothingEnabled)?o="webkitImageSmoothingEnabled":r(m.msImageSmoothingEnabled)&&(o="msImageSmoothingEnabled")),m.font=s,m.lineJoin="round",m.lineWidth=c,m[o]=!1,m.textBaseline=n(a.textBaseline,"bottom"),f.style.visibility="hidden",document.body.appendChild(f);var _=e(m,i,l,u);_.computedWidth=Math.max(_.width,_.bounds.maxx-_.bounds.minx),f.dimensions=_,document.body.removeChild(f),f.style.visibility="";var g=_.height-_.ascent+d;f.width=_.computedWidth+p,f.height=_.height+p;var v=f.height-g;if(m.font=s,m.lineJoin="round",m.lineWidth=c,m[o]=!1,h!==t.TRANSPARENT&&(m.fillStyle=h.toCssColorString(),m.fillRect(0,0,f.width,f.height)),l){var y=n(a.strokeColor,t.BLACK);m.strokeStyle=y.toCssColorString(),m.strokeText(i,d,v)}if(u){var C=n(a.fillColor,t.WHITE);m.fillStyle=C.toCssColorString(),m.fillText(i,d,v)}return f}}}),o("Core/PinBuilder",["./buildModuleUrl","./Color","./defined","./DeveloperError","./loadImage","./writeTextToCanvas"],function(e,t,n,r,i,o){"use strict";function a(){this._cache={}}function s(e,n,r){var i=r/2.5,o=i,a=i;n.width>n.height?a=i*(n.height/n.width):n.width<n.height&&(o=i*(n.width/n.height));var s=(r-o)/2,l=7/24*r-a/2;e.globalCompositeOperation="destination-out",e.drawImage(n,s-1,l,o,a),e.drawImage(n,s,l-1,o,a),e.drawImage(n,s+1,l,o,a),e.drawImage(n,s,l+1,o,a),e.globalCompositeOperation="destination-over",e.fillStyle=t.BLACK.toCssColorString(),e.fillRect(s-1,l-1,o+1,a+1),e.globalCompositeOperation="destination-out",e.drawImage(n,s,l,o,a),e.globalCompositeOperation="destination-over",e.fillStyle=t.WHITE.toCssColorString(),e.fillRect(s,l,o,a)}function l(e,t,r,a,l){c[0]=e,c[1]=t,c[2]=r,c[3]=a;var h=JSON.stringify(c),d=l[h];if(n(d))return d;var p=document.createElement("canvas");p.width=a,p.height=a;var f,m,_,g=p.getContext("2d");if(m=r,_=a,(f=g).save(),f.scale(_/24,_/24),f.fillStyle=m.toCssColorString(),f.strokeStyle=m.brighten(.6,u).toCssColorString(),f.lineWidth=.846,f.beginPath(),f.moveTo(6.72,.422),f.lineTo(17.28,.422),f.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),f.lineTo(19.577,10.973),f.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),f.lineTo(14.386,14.008),f.lineTo(11.826,23.578),f.lineTo(9.614,14.008),f.lineTo(6.719,13.965),f.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),f.lineTo(4.422,3.416),f.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),f.closePath(),f.fill(),f.stroke(),f.restore(),n(e)){var v=i(e).then(function(e){return s(g,e,a),l[h]=p,p});return l[h]=v,v}if(n(t)){var y=o(t,{font:"bold "+a+"px sans-serif"});s(g,y,a)}return l[h]=p,p}a.prototype.fromColor=function(e,t){return l(void 0,void 0,e,t,this._cache)},a.prototype.fromUrl=function(e,t,n){return l(e,void 0,t,n,this._cache)},a.prototype.fromMakiIconId=function(t,n,r){return l(e("Assets/Textures/maki/"+encodeURIComponent(t)+".png"),void 0,n,r,this._cache)},a.prototype.fromText=function(e,t,n){return l(void 0,e,t,n,this._cache)};var u=new t,c=new Array(4);return a}),o("Core/PixelFormat",["../Renderer/WebGLConstants","./freezeObject"],function(e,t){"use strict";var n={DEPTH_COMPONENT:e.DEPTH_COMPONENT,DEPTH_STENCIL:e.DEPTH_STENCIL,ALPHA:e.ALPHA,RGB:e.RGB,RGBA:e.RGBA,LUMINANCE:e.LUMINANCE,LUMINANCE_ALPHA:e.LUMINANCE_ALPHA,validate:function(e){return e===n.DEPTH_COMPONENT||e===n.DEPTH_STENCIL||e===n.ALPHA||e===n.RGB||e===n.RGBA||e===n.LUMINANCE||e===n.LUMINANCE_ALPHA},isColorFormat:function(e){return e===n.ALPHA||e===n.RGB||e===n.RGBA||e===n.LUMINANCE||e===n.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===n.DEPTH_COMPONENT||e===n.DEPTH_STENCIL}};return t(n)}),o("Core/PointGeometry",["./BoundingSphere","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Geometry","./GeometryAttribute","./GeometryAttributes","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t){t=n(t,n.EMPTY_OBJECT),this._positionsTypedArray=t.positionsTypedArray,this._colorsTypedArray=t.colorsTypedArray,this._boundingSphere=e.clone(t.boundingSphere),this._workerName="createPointGeometry"}return u.createGeometry=function(n){var i=n._positionsTypedArray,u=4==i.byteLength/i.length?t.FLOAT:t.DOUBLE,c=new s;c.position=new a({componentDatatype:u,componentsPerAttribute:3,values:i}),c.color=new a({componentDatatype:t.UNSIGNED_BYTE,componentsPerAttribute:3,values:n._colorsTypedArray,normalize:!0});var h=n._boundingSphere;return r(h)||(h=e.fromVertices(i)),new o({attributes:c,primitiveType:l.POINTS,boundingSphere:h})},u}),o("Core/PolygonGeometryLibrary",["./arrayRemoveDuplicates","./Cartesian2","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";var v={};v.computeHierarchyPackedLength=function(e){for(var t=0,r=[e];r.length>0;){var i=r.pop();if(o(i)){t+=2;var a=i.positions,s=i.holes;if(o(a)&&(t+=a.length*n.packedLength),o(s))for(var l=s.length,u=0;u<l;++u)r.push(s[u])}}return t},v.packPolygonHierarchy=function(e,t,r){for(var i=[e];i.length>0;){var a=i.pop();if(o(a)){var s=a.positions,l=a.holes;if(t[r++]=o(s)?s.length:0,t[r++]=o(l)?l.length:0,o(s))for(var u=s.length,c=0;c<u;++c,r+=3)n.pack(s[c],t,r);if(o(l))for(var h=l.length,d=0;d<h;++d)i.push(l[d])}}return r},v.unpackPolygonHierarchy=function(e,t){for(var r=e[t++],i=e[t++],o=new Array(r),a=i>0?new Array(i):void 0,s=0;s<r;++s,t+=n.packedLength)o[s]=n.unpack(e,t);for(var l=0;l<i;++l)a[l]=v.unpackPolygonHierarchy(e,t),t=a[l].startingIndex,delete a[l].startingIndex;return{positions:o,holes:a,startingIndex:t}};var y=new n;v.subdivideLineCount=function(e,t,r){var i=n.distance(e,t),o=Math.max(0,Math.ceil(Math.log(i/r)/Math.log(2)));return Math.pow(2,o)},v.subdivideLine=function(e,t,r,i){var a=v.subdivideLineCount(e,t,r),s=n.distance(e,t),l=s/a;o(i)||(i=[]);var u,c,h,d=i;d.length=3*a;for(var p=0,f=0;f<a;f++){var m=(c=f*l,h=s,n.subtract(t,u=e,y),n.multiplyByScalar(y,c/h,y),n.add(u,y,y),[y.x,y.y,y.z]);d[p++]=m[0],d[p++]=m[1],d[p++]=m[2]}return d};var C=new n,w=new n,b=new n,E=new n;v.scaleToGeodeticHeightExtruded=function(e,t,r,s,l){s=i(s,a.WGS84);var u=C,c=w,h=b,d=E;if(o(e)&&o(e.attributes)&&o(e.attributes.position))for(var p=e.attributes.position.values,f=p.length/2,m=0;m<f;m+=3)n.fromArray(p,m,h),s.geodeticSurfaceNormal(h,u),d=s.scaleToGeodeticSurface(h,d),c=n.multiplyByScalar(u,r,c),c=n.add(d,c,c),p[m+f]=c.x,p[m+1+f]=c.y,p[m+2+f]=c.z,l&&(d=n.clone(h,d)),c=n.multiplyByScalar(u,t,c),c=n.add(d,c,c),p[m]=c.x,p[m+1]=c.y,p[m+2]=c.z;return e},v.polygonsFromHierarchy=function(t,r,i,a){var s=[],l=[],u=new _;for(u.enqueue(t);0!==u.length;){var c=u.dequeue(),h=c.positions,d=c.holes;if(!((h=e(h,n.equalsEpsilon,!0)).length<3)){var p=i.projectPointsOntoPlane(h),m=[],v=f.computeWindingOrder2D(p);v===g.CLOCKWISE&&(p.reverse(),h=h.slice().reverse());var y,C,w=h.slice(),b=o(d)?d.length:0,E=[];for(y=0;y<b;y++){var S=d[y],x=e(S.positions,n.equalsEpsilon,!0);if(!(x.length<3)){var T=i.projectPointsOntoPlane(x);(v=f.computeWindingOrder2D(T))===g.CLOCKWISE&&(T.reverse(),x=x.slice().reverse()),E.push(x),m.push(w.length),w=w.concat(x),p=p.concat(T);var A=0;for(o(S.holes)&&(A=S.holes.length),C=0;C<A;C++)u.enqueue(S.holes[C])}}if(!r){for(y=0;y<h.length;y++)a.scaleToGeodeticSurface(h[y],h[y]);for(y=0;y<E.length;y++){var P=E[y];for(C=0;C<P.length;++C)a.scaleToGeodeticSurface(P[C],P[C])}}s.push({outerRing:h,holes:E}),l.push({positions:w,positions2D:p,holes:m})}}return{hierarchy:s,polygons:l}},v.createGeometryFromPositions=function(e,t,n,i,o){var a=f.triangulate(t.positions2D,t.holes);a.length<3&&(a=[0,1,2]);var s=t.positions;if(i){for(var c=s.length,d=new Array(3*c),p=0,_=0;_<c;_++){var g=s[_];d[p++]=g.x,d[p++]=g.y,d[p++]=g.z}var v=new l({attributes:{position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:d})},indices:a,primitiveType:m.TRIANGLES});return o.normal?h.computeNormal(v):v}return f.computeSubdivision(e,s,a,n)};var S=[],x=new n,T=new n;return v.computeWallGeometry=function(e,t,i,o){var a,s,h,f,_,g=e.length,y=0;if(o)for(s=3*g*2,a=new Array(2*s),h=0;h<g;h++)f=e[h],_=e[(h+1)%g],a[y]=a[y+s]=f.x,++y,a[y]=a[y+s]=f.y,++y,a[y]=a[y+s]=f.z,++y,a[y]=a[y+s]=_.x,++y,a[y]=a[y+s]=_.y,++y,a[y]=a[y+s]=_.z,++y;else{var C=p.chordLength(i,t.maximumRadius),w=0;for(h=0;h<g;h++)w+=v.subdivideLineCount(e[h],e[(h+1)%g],C);for(s=3*(w+g),a=new Array(2*s),h=0;h<g;h++){for(var b=v.subdivideLine(f=e[h],_=e[(h+1)%g],C,S),E=b.length,A=0;A<E;++A,++y)a[y]=b[A],a[y+s]=b[A];a[y]=_.x,a[y+s]=_.x,a[++y]=_.y,a[y+s]=_.y,a[++y]=_.z,a[y+s]=_.z,++y}}var P=d.createTypedArray((g=a.length)/3,g-6*e.length),D=0;for(g/=6,h=0;h<g;h++){var M=h,I=M+1,O=M+g,R=O+1;f=n.fromArray(a,3*M,x),_=n.fromArray(a,3*I,T),n.equalsEpsilon(f,_,p.EPSILON14)||(P[D++]=M,P[D++]=O,P[D++]=I,P[D++]=I,P[D++]=O,P[D++]=R)}return new l({attributes:new c({position:new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:a})}),indices:P,primitiveType:m.TRIANGLES})},v}),o("Core/PolygonGeometry",["./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix3","./PolygonGeometryLibrary","./PolygonPipeline","./Quaternion","./Rectangle","./VertexFormat","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e,t,n,r){var i=r.cartesianToCartographic(e,N).height,o=r.cartesianToCartographic(t,L);o.height=i,r.cartographicToCartesian(o,t);var a=r.cartesianToCartographic(n,L);a.height=i-100,r.cartographicToCartesian(a,n)}function A(e){var t=e.vertexFormat,i=e.geometry;if(t.st||t.normal||t.tangent||t.binormal){var a=e.boundingRectangle,s=e.tangentPlane,l=e.ellipsoid,u=e.stRotation,c=e.wall,h=e.top||c,d=e.bottom||c,f=e.perPositionHeight,m=q;m.x=a.x,m.y=a.y;var _,g=i.attributes.position.values,C=g.length,w=t.st?new Float32Array(C/3*2):void 0;t.normal&&(_=f&&h&&!c?i.attributes.normal.values:new Float32Array(C));var E=t.tangent?new Float32Array(C):void 0,S=t.binormal?new Float32Array(C):void 0,x=0,A=0,P=k,D=V,M=z,I=!0,O=b.fromAxisAngle(s._plane.normal,u,Z),R=y.fromQuaternion(O,K),N=0,L=0;h&&d&&(N=C/2,L=C/3,C/=2);for(var F=0;F<C;F+=3){var Q=r.fromArray(g,F,X);if(t.st){var J=y.multiplyByVector(R,Q,B);J=l.scaleToGeodeticSurface(J,J);var $=s.projectPointOntoPlane(J,Y);n.subtract($,m,$);var ee=v.clamp($.x/a.width,0,1),te=v.clamp($.y/a.height,0,1);d&&(w[x+L]=ee,w[x+1+L]=te),h&&(w[x]=ee,w[x+1]=te),x+=2}if(t.normal||t.tangent||t.binormal){var ne=A+1,re=A+2;if(c){if(F+3<C){var ie=r.fromArray(g,F+3,U);if(I){var oe=r.fromArray(g,F+C,G);f&&T(Q,ie,oe,l),r.subtract(ie,Q,ie),r.subtract(oe,Q,oe),P=r.normalize(r.cross(oe,ie,P),P),I=!1}r.equalsEpsilon(ie,Q,v.EPSILON10)&&(I=!0)}(t.tangent||t.binormal)&&(M=l.geodeticSurfaceNormal(Q,M),t.tangent&&(D=r.normalize(r.cross(M,P,D),D)))}else P=l.geodeticSurfaceNormal(Q,P),(t.tangent||t.binormal)&&(f&&(W=r.fromArray(_,A,W),H=r.cross(r.UNIT_Z,W,H),H=r.normalize(y.multiplyByVector(R,H,H),H),t.binormal&&(j=r.normalize(r.cross(W,H,j),j))),D=r.cross(r.UNIT_Z,P,D),D=r.normalize(y.multiplyByVector(R,D,D),D),t.binormal&&(M=r.normalize(r.cross(P,D,M),M)));t.normal&&(e.wall?(_[A+N]=P.x,_[ne+N]=P.y,_[re+N]=P.z):d&&(_[A+N]=-P.x,_[ne+N]=-P.y,_[re+N]=-P.z),(h&&!f||c)&&(_[A]=P.x,_[ne]=P.y,_[re]=P.z)),t.tangent&&(e.wall?(E[A+N]=D.x,E[ne+N]=D.y,E[re+N]=D.z):d&&(E[A+N]=-D.x,E[ne+N]=-D.y,E[re+N]=-D.z),h&&(f?(E[A]=H.x,E[ne]=H.y,E[re]=H.z):(E[A]=D.x,E[ne]=D.y,E[re]=D.z))),t.binormal&&(d&&(S[A+N]=M.x,S[ne+N]=M.y,S[re+N]=M.z),h&&(f?(S[A]=j.x,S[ne]=j.y,S[re]=j.z):(S[A]=M.x,S[ne]=M.y,S[re]=M.z))),A+=3}}t.st&&(i.attributes.st=new p({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:w})),t.normal&&(i.attributes.normal=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:_})),t.tangent&&(i.attributes.tangent=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:E})),t.binormal&&(i.attributes.binormal=new p({componentDatatype:o.FLOAT,componentsPerAttribute:3,values:S}))}return i}function P(e,t,n,r,i,o,a,s){var l,u={walls:[]};if(o||a){var c,d,p=C.createGeometryFromPositions(e,t,n,i,s),f=p.attributes.position.values,_=p.indices;if(o&&a){var v=f.concat(f);(d=g.createTypedArray(c=v.length/3,2*_.length)).set(_);var y=_.length,b=c/2;for(l=0;l<y;l+=3){var E=d[l]+b,S=d[l+1]+b;d[l+y]=d[l+2]+b,d[l+1+y]=S,d[l+2+y]=E}if(p.attributes.position.values=v,i){var T=p.attributes.normal.values;p.attributes.normal.values=new Float32Array(v.length),p.attributes.normal.values.set(T)}p.indices=d}else if(a){for(d=g.createTypedArray(c=f.length/3,_.length),l=0;l<_.length;l+=3)d[l]=_[l+2],d[l+1]=_[l+1],d[l+2]=_[l];p.indices=d}u.topAndBottom=new m({geometry:p})}var A=r.outerRing,P=h.fromPoints(A,e),D=P.projectPointsOntoPlane(A,Q),M=w.computeWindingOrder2D(D);M===x.CLOCKWISE&&(A=A.slice().reverse());var I=C.computeWallGeometry(A,e,n,i);u.walls.push(new m({geometry:I}));var O=r.holes;for(l=0;l<O.length;l++){var R=O[l];D=(P=h.fromPoints(R,e)).projectPointsOntoPlane(R,Q),(M=w.computeWindingOrder2D(D))===x.COUNTER_CLOCKWISE&&(R=R.slice().reverse()),I=C.computeWallGeometry(R,e,n),u.walls.push(new m({geometry:I}))}return u}function D(e){var t=e.polygonHierarchy,n=a(e.vertexFormat,S.DEFAULT),r=a(e.ellipsoid,c.WGS84),i=a(e.granularity,v.RADIANS_PER_DEGREE),o=a(e.stRotation,0),l=a(e.height,0),u=a(e.perPositionHeight,!1),h=e.extrudedHeight,d=s(h);if(!u&&d)if(v.equalsEpsilon(l,h,v.EPSILON10))h=void 0,d=!1;else{var p=h;h=Math.min(p,l),l=Math.max(p,l)}this._vertexFormat=S.clone(n),this._ellipsoid=c.clone(r),this._granularity=i,this._stRotation=o,this._height=l,this._extrudedHeight=a(h,0),this._extrude=d,this._closeTop=a(e.closeTop,!0),this._closeBottom=a(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=u,this._workerName="createPolygonGeometry";var f=t.positions;this._rectangle=!s(f)||f.length<3?new E:E.fromCartesianArray(f,r),this.packedLength=C.computeHierarchyPackedLength(t)+c.packedLength+S.packedLength+E.packedLength+9}var M=new n,I=new r,O=new b,R=new y,N=new i,L=new i,F=new e,B=new r,k=new r,V=new r,z=new r,U=new r,G=new r,W=new r,H=new r,j=new r,q=new n,Y=new n,X=new r,Z=new b,K=new y,Q=[];D.fromPositions=function(e){return new D({polygonHierarchy:{positions:(e=a(e,a.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom})},D.pack=function(e,t,n){return n=a(n,0),n=C.packPolygonHierarchy(e._polygonHierarchy,t,n),c.pack(e._ellipsoid,t,n),S.pack(e._vertexFormat,t,n+=c.packedLength),E.pack(e._rectangle,t,n+=S.packedLength),n+=E.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._stRotation,t[n++]=e._extrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e._closeTop?1:0,t[n++]=e._closeBottom?1:0,t[n]=e.packedLength,t};var J=c.clone(c.UNIT_SPHERE),$=new S,ee=new E,te={polygonHierarchy:{}};return D.unpack=function(e,t,n){t=a(t,0);var r=C.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var i=c.unpack(e,t,J),o=S.unpack(e,t+=c.packedLength,$),l=E.unpack(e,t+=S.packedLength,ee);t+=E.packedLength;var u=e[t++],h=e[t++],d=e[t++],p=e[t++],f=1===e[t++],m=1===e[t++],_=1===e[t++],g=1===e[t++],v=e[t];return s(n)||(n=new D(te)),n._polygonHierarchy=r,n._ellipsoid=c.clone(i,n._ellipsoid),n._vertexFormat=S.clone(o,n._vertexFormat),n._height=u,n._extrudedHeight=h,n._granularity=d,n._stRotation=p,n._extrude=f,n._perPositionHeight=m,n._closeTop=_,n._closeBottom=g,n._rectangle=E.clone(l),n.packedLength=v,n},D.createGeometry=function(e){var n=e._vertexFormat,i=e._ellipsoid,o=e._granularity,a=e._stRotation,l=e._height,u=e._extrudedHeight,c=e._extrude,p=e._polygonHierarchy,f=e._perPositionHeight,v=e._closeTop,E=e._closeBottom,S=p.positions;if(!(S.length<3)){var x=h.fromPoints(S,i),T=C.polygonsFromHierarchy(p,f,x,i),D=T.hierarchy,N=T.polygons;if(0!==D.length){var L,B,k=[],V={perPositionHeight:f,vertexFormat:n,geometry:void 0,tangentPlane:x,boundingRectangle:function(e,t,n,i){for(var o=b.fromAxisAngle(e._plane.normal,a,O),l=y.fromQuaternion(o,R),u=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,p=t.length,f=0;f<p;++f){var m=r.clone(t[f],I);y.multiplyByVector(l,m,m);var _=e.projectPointOntoPlane(m,M);s(_)&&(u=Math.min(u,_.x),c=Math.max(c,_.x),h=Math.min(h,_.y),d=Math.max(d,_.y))}return i.x=u,i.y=h,i.width=c-u,i.height=d-h,i}(x,S=D[0].outerRing,0,F),ellipsoid:i,stRotation:a,bottom:!1,top:!0,wall:!1};if(c)for(V.top=v,V.bottom=E,B=0;B<N.length;B++){var z;L=P(i,N[B],o,D[B],f,v,E,n),v&&E?V.geometry=C.scaleToGeodeticHeightExtruded((z=L.topAndBottom).geometry,l,u,i,f):v?((z=L.topAndBottom).geometry.attributes.position.values=w.scaleToGeodeticHeight(z.geometry.attributes.position.values,l,i,!f),V.geometry=z.geometry):E&&((z=L.topAndBottom).geometry.attributes.position.values=w.scaleToGeodeticHeight(z.geometry.attributes.position.values,u,i,!0),V.geometry=z.geometry),(v||E)&&(V.wall=!1,z.geometry=A(V),k.push(z));var U=L.walls;V.wall=!0;for(var G=0;G<U.length;G++){var W=U[G];V.geometry=C.scaleToGeodeticHeightExtruded(W.geometry,l,u,i,f),W.geometry=A(V),k.push(W)}}else for(B=0;B<N.length;B++)L=new m({geometry:C.createGeometryFromPositions(i,N[B],o,f,n)}),L.geometry.attributes.position.values=w.scaleToGeodeticHeight(L.geometry.attributes.position.values,l,i,!f),V.geometry=L.geometry,L.geometry=A(V),k.push(L);(L=_.combineInstances(k)[0]).attributes.position.values=new Float64Array(L.attributes.position.values),L.indices=g.createTypedArray(L.attributes.position.values.length/3,L.indices);var H=L.attributes,j=t.fromVertices(H.position.values);return n.position||delete H.position,new d({attributes:H,indices:L.indices,primitiveType:L.primitiveType,boundingSphere:j})}}},D.createShadowVolume=function(e,t,n){var r=e._granularity,i=e._ellipsoid,o=t(r,i),a=n(r,i);return new D({polygonHierarchy:e._polygonHierarchy,ellipsoid:i,stRotation:e._stRotation,granularity:r,perPositionHeight:!1,extrudedHeight:o,height:a,vertexFormat:S.POSITION_ONLY})},l(D.prototype,{rectangle:{get:function(){return this._rectangle}}}),D}),o("Core/PolygonHierarchy",["./defined"],function(e){"use strict";return function(t,n){this.positions=e(t)?t:[],this.holes=e(n)?n:[]}}),o("Core/PolygonOutlineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./EllipsoidTangentPlane","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./PolygonGeometryLibrary","./PolygonPipeline","./PrimitiveType","./Queue","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C){"use strict";function w(e,t,n,i){var o=l.fromPoints(t,e).projectPointsOntoPlane(t,S);g.computeWindingOrder2D(o)===C.CLOCKWISE&&(o.reverse(),t=t.slice().reverse());var a,s,p=t.length,m=0;if(i)for(a=new Float64Array(2*p*3),s=0;s<p;s++){var y=t[s],w=t[(s+1)%p];a[m++]=y.x,a[m++]=y.y,a[m++]=y.z,a[m++]=w.x,a[m++]=w.y,a[m++]=w.z}else{var b=0;for(s=0;s<p;s++)b+=_.subdivideLineCount(t[s],t[(s+1)%p],n);for(a=new Float64Array(3*b),s=0;s<p;s++)for(var E=_.subdivideLine(t[s],t[(s+1)%p],n,x),T=E.length,A=0;A<T;++A)a[m++]=E[A]}var P=f.createTypedArray(p=a.length/3,2*p);for(m=0,s=0;s<p-1;s++)P[m++]=s,P[m++]=s+1;return P[m++]=p-1,P[m++]=0,new d({geometry:new u({attributes:new h({position:new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:a})}),indices:P,primitiveType:v.LINES})})}function b(e,t,n,i){var o=l.fromPoints(t,e).projectPointsOntoPlane(t,S);g.computeWindingOrder2D(o)===C.CLOCKWISE&&(o.reverse(),t=t.slice().reverse());var a,s,p=t.length,m=new Array(p),y=0;if(i)for(a=new Float64Array(2*p*3*2),s=0;s<p;++s){m[s]=y/3;var w=t[s],b=t[(s+1)%p];a[y++]=w.x,a[y++]=w.y,a[y++]=w.z,a[y++]=b.x,a[y++]=b.y,a[y++]=b.z}else{var E=0;for(s=0;s<p;s++)E+=_.subdivideLineCount(t[s],t[(s+1)%p],n);for(a=new Float64Array(3*E*2),s=0;s<p;++s){m[s]=y/3;for(var T=_.subdivideLine(t[s],t[(s+1)%p],n,x),A=T.length,P=0;P<A;++P)a[y++]=T[P]}}var D=m.length,M=f.createTypedArray(p=a.length/6,2*(2*p+D));for(y=0,s=0;s<p;++s)M[y++]=s,M[y++]=(s+1)%p,M[y++]=s+p,M[y++]=(s+1)%p+p;for(s=0;s<D;s++){var I=m[s];M[y++]=I,M[y++]=I+p}return new d({geometry:new u({attributes:new h({position:new c({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:a})}),indices:M,primitiveType:v.LINES})})}function E(e){var t=e.polygonHierarchy,n=i(e.ellipsoid,s.WGS84),r=i(e.granularity,m.RADIANS_PER_DEGREE),a=i(e.height,0),l=i(e.perPositionHeight,!1),u=e.extrudedHeight,c=o(u);if(c&&!l){var h=u;u=Math.min(h,a),a=Math.max(h,a)}this._ellipsoid=s.clone(n),this._granularity=r,this._height=a,this._extrudedHeight=i(u,0),this._extrude=c,this._polygonHierarchy=t,this._perPositionHeight=l,this._workerName="createPolygonOutlineGeometry",this.packedLength=_.computeHierarchyPackedLength(t)+s.packedLength+6}var S=[],x=[];E.pack=function(e,t,n){return n=i(n,0),n=_.packPolygonHierarchy(e._polygonHierarchy,t,n),s.pack(e._ellipsoid,t,n),n+=s.packedLength,t[n++]=e._height,t[n++]=e._extrudedHeight,t[n++]=e._granularity,t[n++]=e._extrude?1:0,t[n++]=e._perPositionHeight?1:0,t[n++]=e.packedLength,t};var T=s.clone(s.UNIT_SPHERE),A={polygonHierarchy:{}};return E.unpack=function(e,t,n){t=i(t,0);var r=_.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var a=s.unpack(e,t,T);t+=s.packedLength;var l=e[t++],u=e[t++],c=e[t++],h=1===e[t++],d=1===e[t++],p=e[t++];return o(n)||(n=new E(A)),n._polygonHierarchy=r,n._ellipsoid=s.clone(a,n._ellipsoid),n._height=l,n._extrudedHeight=u,n._granularity=c,n._extrude=h,n._perPositionHeight=d,n.packedLength=p,n},E.fromPositions=function(e){return new E({polygonHierarchy:{positions:(e=i(e,i.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight})},E.createGeometry=function(r){var i,a=r._ellipsoid,s=r._granularity,l=r._height,c=r._extrudedHeight,h=r._extrude,d=r._polygonHierarchy,f=r._perPositionHeight,v=[],C=new y;for(C.enqueue(d);0!==C.length;){var E=C.dequeue(),S=E.positions;if(!((S=e(S,n.equalsEpsilon,!0)).length<3)){var x=E.holes?E.holes.length:0;for(i=0;i<x;i++){var T=E.holes[i];if(T.positions=e(T.positions,n.equalsEpsilon,!0),!(T.positions.length<3)){v.push(T.positions);var A=0;o(T.holes)&&(A=T.holes.length);for(var P=0;P<A;P++)C.enqueue(T.holes[P])}}v.push(S)}}if(0!==v.length){var D,M=[],I=m.chordLength(s,a.maximumRadius);if(h)for(i=0;i<v.length;i++)D=b(a,v[i],I,f),D.geometry=_.scaleToGeodeticHeightExtruded(D.geometry,l,c,a,f),M.push(D);else for(i=0;i<v.length;i++)D=w(a,v[i],I,f),D.geometry.attributes.position.values=g.scaleToGeodeticHeight(D.geometry.attributes.position.values,l,a,!f),M.push(D);D=p.combineInstances(M)[0];var O=t.fromVertices(D.attributes.position.values);return new u({attributes:D.attributes,indices:D.indices,primitiveType:D.primitiveType,boundingSphere:O})}},E}),o("Core/PolylineGeometry",["./arrayRemoveDuplicates","./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryType","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e,t,n,i,o){var a=C;a.length=o;var s,l=n.red,u=n.green,c=n.blue,h=n.alpha,d=i.red,p=i.green,f=i.blue,m=i.alpha;if(r.equals(n,i)){for(s=0;s<o;s++)a[s]=r.clone(n);return a}var _=(d-l)/o,g=(p-u)/o,v=(f-c)/o,y=(m-h)/o;for(s=0;s<o;s++)a[s]=new r(l+s*_,u+s*g,c+s*v,h+s*y);return a}function y(e){var t=(e=o(e,o.EMPTY_OBJECT)).positions,i=e.colors,s=o(e.width,1),u=o(e.colorsPerVertex,!1);this._positions=t,this._colors=i,this._width=s,this._colorsPerVertex=u,this._vertexFormat=g.clone(o(e.vertexFormat,g.DEFAULT)),this._followSurface=o(e.followSurface,!0),this._granularity=o(e.granularity,f.RADIANS_PER_DEGREE),this._ellipsoid=l.clone(o(e.ellipsoid,l.WGS84)),this._workerName="createPolylineGeometry";var c=1+t.length*n.packedLength;c+=a(i)?1+i.length*r.packedLength:1,this.packedLength=c+l.packedLength+g.packedLength+4}var C=[];y.pack=function(e,t,i){i=o(i,0);var s,u=e._positions,c=u.length;for(t[i++]=c,s=0;s<c;++s,i+=n.packedLength)n.pack(u[s],t,i);var h=e._colors;for(c=a(h)?h.length:0,t[i++]=c,s=0;s<c;++s,i+=r.packedLength)r.pack(h[s],t,i);return l.pack(e._ellipsoid,t,i),g.pack(e._vertexFormat,t,i+=l.packedLength),i+=g.packedLength,t[i++]=e._width,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._followSurface?1:0,t[i]=e._granularity,t};var w=l.clone(l.UNIT_SPHERE),b=new g,E={positions:void 0,colors:void 0,ellipsoid:w,vertexFormat:b,width:void 0,colorsPerVertex:void 0,followSurface:void 0,granularity:void 0};y.unpack=function(e,t,i){t=o(t,0);var s,u=e[t++],c=new Array(u);for(s=0;s<u;++s,t+=n.packedLength)c[s]=n.unpack(e,t);var h=(u=e[t++])>0?new Array(u):void 0;for(s=0;s<u;++s,t+=r.packedLength)h[s]=r.unpack(e,t);var d=l.unpack(e,t,w),p=g.unpack(e,t+=l.packedLength,b);t+=g.packedLength;var f=e[t++],m=1===e[t++],_=1===e[t++],v=e[t];return a(i)?(i._positions=c,i._colors=h,i._ellipsoid=l.clone(d,i._ellipsoid),i._vertexFormat=g.clone(p,i._vertexFormat),i._width=f,i._colorsPerVertex=m,i._followSurface=_,i._granularity=v,i):(E.positions=c,E.colors=h,E.width=f,E.colorsPerVertex=m,E.followSurface=_,E.granularity=v,new y(E))};var S=new n,x=new n,T=new n,A=new n;return y.createGeometry=function(o){var s,l,g,y=o._width,w=o._vertexFormat,b=o._colors,E=o._colorsPerVertex,P=o._followSurface,D=o._granularity,M=o._ellipsoid,I=e(o._positions,n.equalsEpsilon),O=I.length;if(!(O<2)){if(P){var R=m.extractHeights(I,M),N=f.chordLength(D,M.maximumRadius);if(a(b)){var L=1;for(s=0;s<O-1;++s)L+=m.numberOfPoints(I[s],I[s+1],N);var F=new Array(L),B=0;for(s=0;s<O-1;++s){var k=b[s],V=m.numberOfPoints(I[s],I[s+1],N);if(E&&s<L){var z=v(0,0,k,b[s+1],V),U=z.length;for(l=0;l<U;++l)F[B++]=z[l]}else for(l=0;l<V;++l)F[B++]=r.clone(k)}F[B]=r.clone(b[b.length-1]),b=F,C.length=0}I=m.generateCartesianArc({positions:I,minDistance:N,ellipsoid:M,height:R})}var G,W=4*(O=I.length)-4,H=new Float64Array(3*W),j=new Float64Array(3*W),q=new Float64Array(3*W),Y=new Float32Array(2*W),X=w.st?new Float32Array(2*W):void 0,Z=a(b)?new Uint8Array(4*W):void 0,K=0,Q=0,J=0,$=0;for(l=0;l<O;++l){var ee,te;0===l?(n.subtract(I[0],I[1],G=S),n.add(I[0],G,G)):G=I[l-1],n.clone(G,T),n.clone(I[l],x),l===O-1?(n.subtract(I[O-1],I[O-2],G=S),n.add(I[O-1],G,G)):G=I[l+1],n.clone(G,A),a(Z)&&(ee=0===l||E?b[l]:b[l-1],l!==O-1&&(te=b[l]));var ne=l===O-1?2:4;for(g=0===l?2:0;g<ne;++g){n.pack(x,H,K),n.pack(T,j,K),n.pack(A,q,K),K+=3;var re=g-2<0?-1:1;if(Y[Q++]=g%2*2-1,Y[Q++]=re*y,w.st&&(X[J++]=l/(O-1),X[J++]=Math.max(Y[Q-2],0)),a(Z)){var ie=g<2?ee:te;Z[$++]=r.floatToByte(ie.red),Z[$++]=r.floatToByte(ie.green),Z[$++]=r.floatToByte(ie.blue),Z[$++]=r.floatToByte(ie.alpha)}}}var oe=new h;oe.position=new c({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:H}),oe.prevPosition=new c({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:j}),oe.nextPosition=new c({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:q}),oe.expandAndWidth=new c({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:Y}),w.st&&(oe.st=new c({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:X})),a(Z)&&(oe.color=new c({componentDatatype:i.UNSIGNED_BYTE,componentsPerAttribute:4,values:Z,normalize:!0}));var ae=p.createTypedArray(W,6*O-6),se=0,le=0,ue=O-1;for(l=0;l<ue;++l)ae[le++]=se,ae[le++]=se+2,ae[le++]=se+1,ae[le++]=se+1,ae[le++]=se+2,ae[le++]=se+3,se+=4;return new u({attributes:oe,indices:ae,primitiveType:_.TRIANGLES,boundingSphere:t.fromPoints(I),geometryType:d.POLYLINES})}},y}),o("Core/PolylineVolumeGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./oneTimeWarning","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryPipeline","./IndexDatatype","./Math","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./VertexFormat","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b){"use strict";function E(e){var t=(e=s(e,s.EMPTY_OBJECT)).polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=h.clone(s(e.ellipsoid,h.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._vertexFormat=w.clone(s(e.vertexFormat,w.DEFAULT)),this._granularity=s(e.granularity,g.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var o=1+t.length*i.packedLength;this.packedLength=(o+=1+n.length*r.packedLength)+h.packedLength+w.packedLength+2}E.pack=function(e,t,n){n=s(n,0);var o,a=e._positions,l=a.length;for(t[n++]=l,o=0;o<l;++o,n+=i.packedLength)i.pack(a[o],t,n);var u=e._shape;for(t[n++]=l=u.length,o=0;o<l;++o,n+=r.packedLength)r.pack(u[o],t,n);return h.pack(e._ellipsoid,t,n),w.pack(e._vertexFormat,t,n+=h.packedLength),n+=w.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var S=h.clone(h.UNIT_SPHERE),x=new w,T={polylinePositions:void 0,shapePositions:void 0,ellipsoid:S,vertexFormat:x,cornerType:void 0,granularity:void 0};E.unpack=function(e,t,n){t=s(t,0);var o,a=e[t++],u=new Array(a);for(o=0;o<a;++o,t+=i.packedLength)u[o]=i.unpack(e,t);a=e[t++];var c=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)c[o]=r.unpack(e,t);var d=h.unpack(e,t,S),p=w.unpack(e,t+=h.packedLength,x);t+=w.packedLength;var f=e[t++],m=e[t];return l(n)?(n._positions=u,n._shape=c,n._ellipsoid=h.clone(d,n._ellipsoid),n._vertexFormat=w.clone(p,n._vertexFormat),n._cornerType=f,n._granularity=m,n):(T.polylinePositions=u,T.shapePositions=c,T.cornerType=f,T.granularity=m,new E(T))};var A=new t;return E.createGeometry=function(r){var a=e(r._positions,i.equalsEpsilon),s=r._shape;if(s=y.removeDuplicatesFromShape(s),!(a.length<2||s.length<3)){v.computeWindingOrder2D(s)===b.CLOCKWISE&&s.reverse();var l=t.fromPoints(s,A);return function(e,t,r,i){var a=new f;i.position&&(a.position=new p({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e}));var s,l,c,h,g,y,w=t.length,b=e.length/3,E=(b-2*w)/(2*w),S=v.triangulate(t),x=_.createTypedArray(b,(E-1)*w*6+2*S.length),T=2*w,A=0;for(s=0;s<E-1;s++){for(l=0;l<w-1;l++)c=2*l+s*w*2,y=c+T,h=c+1,g=h+T,x[A++]=h,x[A++]=c,x[A++]=g,x[A++]=g,x[A++]=c,x[A++]=y;g=(h=1+(c=2*w-2+s*w*2))+T,y=c+T,x[A++]=h,x[A++]=c,x[A++]=g,x[A++]=g,x[A++]=c,x[A++]=y}if(i.st||i.tangent||i.binormal){var P,D,M=new Float32Array(2*b),I=1/(E-1),O=1/r.height,R=r.height/2,N=0;for(s=0;s<E;s++){for(D=O*(t[0].y+R),M[N++]=P=s*I,M[N++]=D,l=1;l<w;l++)D=O*(t[l].y+R),M[N++]=P,M[N++]=D,M[N++]=P,M[N++]=D;D=O*(t[0].y+R),M[N++]=P,M[N++]=D}for(l=0;l<w;l++)P=0,D=O*(t[l].y+R),M[N++]=P,M[N++]=D;for(l=0;l<w;l++)P=(E-1)*I,D=O*(t[l].y+R),M[N++]=P,M[N++]=D;a.st=new p({componentDatatype:o.FLOAT,componentsPerAttribute:2,values:new Float32Array(M)})}var L=b-2*w;for(s=0;s<S.length;s+=3){var F=S[s]+L,B=S[s+1]+L,k=S[s+2]+L;x[A++]=F,x[A++]=B,x[A++]=k,x[A++]=k+w,x[A++]=B+w,x[A++]=F+w}var V=new d({attributes:a,indices:x,boundingSphere:n.fromVertices(e),primitiveType:C.TRIANGLES});if(i.normal&&(V=m.computeNormal(V)),i.tangent||i.binormal){try{V=m.computeBinormalAndTangent(V)}catch(e){u("polyline-volume-tangent-binormal","Unable to compute tangents and binormals for polyline volume geometry")}i.tangent||(V.attributes.tangent=void 0),i.binormal||(V.attributes.binormal=void 0),i.st||(V.attributes.st=void 0)}return V}(y.computePositions(a,s,l,r,!0),s,l,r._vertexFormat)}},E}),o("Core/PolylineVolumeOutlineGeometry",["./arrayRemoveDuplicates","./BoundingRectangle","./BoundingSphere","./Cartesian2","./Cartesian3","./ComponentDatatype","./CornerType","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PolylineVolumeGeometryLibrary","./PrimitiveType","./WindingOrder"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y){"use strict";function C(e){var t=(e=s(e,s.EMPTY_OBJECT)).polylinePositions,n=e.shapePositions;this._positions=t,this._shape=n,this._ellipsoid=c.clone(s(e.ellipsoid,c.WGS84)),this._cornerType=s(e.cornerType,a.ROUNDED),this._granularity=s(e.granularity,m.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var o=1+t.length*i.packedLength;this.packedLength=(o+=1+n.length*r.packedLength)+c.packedLength+2}C.pack=function(e,t,n){n=s(n,0);var o,a=e._positions,l=a.length;for(t[n++]=l,o=0;o<l;++o,n+=i.packedLength)i.pack(a[o],t,n);var u=e._shape;for(t[n++]=l=u.length,o=0;o<l;++o,n+=r.packedLength)r.pack(u[o],t,n);return c.pack(e._ellipsoid,t,n),n+=c.packedLength,t[n++]=e._cornerType,t[n]=e._granularity,t};var w=c.clone(c.UNIT_SPHERE),b={polylinePositions:void 0,shapePositions:void 0,ellipsoid:w,height:void 0,cornerType:void 0,granularity:void 0};C.unpack=function(e,t,n){t=s(t,0);var o,a=e[t++],u=new Array(a);for(o=0;o<a;++o,t+=i.packedLength)u[o]=i.unpack(e,t);a=e[t++];var h=new Array(a);for(o=0;o<a;++o,t+=r.packedLength)h[o]=r.unpack(e,t);var d=c.unpack(e,t,w);t+=c.packedLength;var p=e[t++],f=e[t];return l(n)?(n._positions=u,n._shape=h,n._ellipsoid=c.clone(d,n._ellipsoid),n._cornerType=p,n._granularity=f,n):(b.polylinePositions=u,b.shapePositions=h,b.cornerType=p,b.granularity=f,new C(b))};var E=new t;return C.createGeometry=function(r){var a=e(r._positions,i.equalsEpsilon),s=r._shape;if(s=g.removeDuplicatesFromShape(s),!(a.length<2||s.length<3)){_.computeWindingOrder2D(s)===y.CLOCKWISE&&s.reverse();var l=t.fromPoints(s,E);return function(e,t){var r=new p;r.position=new d({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:e});var i,a,s=t.length,l=r.position.values.length/3,u=e.length/3/s,c=f.createTypedArray(l,2*s*(u+1)),m=0,_=(i=0)*s;for(a=0;a<s-1;a++)c[m++]=a+_,c[m++]=a+_+1;for(c[m++]=s-1+_,c[m++]=_,_=(i=u-1)*s,a=0;a<s-1;a++)c[m++]=a+_,c[m++]=a+_+1;for(c[m++]=s-1+_,c[m++]=_,i=0;i<u-1;i++){var g=s*i,y=g+s;for(a=0;a<s;a++)c[m++]=a+g,c[m++]=a+y}return new h({attributes:r,indices:f.createTypedArray(l,c),boundingSphere:n.fromVertices(e),primitiveType:v.LINES})}(g.computePositions(a,s,l,r,!1),s)}},C}),o("Core/QuaternionSpline",["./defaultValue","./defined","./defineProperties","./DeveloperError","./Quaternion","./Spline"],function(e,t,n,r,i,o){"use strict";function a(n){var r=(n=e(n,e.EMPTY_OBJECT)).points,o=n.times,a=function(e,n,r){var o=e.length,a=new Array(o);a[0]=t(n)?n:e[0],a[o-1]=t(r)?r:e[o-1];for(var s=1;s<o-1;++s)a[s]=i.computeInnerQuadrangle(e[s-1],e[s],e[s+1],new i);return a}(r,n.firstInnerQuadrangle,n.lastInnerQuadrangle);this._times=o,this._points=r,this._innerQuadrangles=a,this._evaluateFunction=function(e){var n=e.points,r=e.innerQuadrangles,o=e.times;if(n.length<3){var a=o[0],s=1/(o[1]-a),l=n[0],u=n[1];return function(e,n){return t(n)||(n=new i),i.fastSlerp(l,u,(e-a)*s,n)}}return function(a,s){t(s)||(s=new i);var l=e._lastTimeIndex=e.findTimeInterval(a,e._lastTimeIndex);return i.fastSquad(n[l],n[l+1],r[l],r[l+1],(a-o[l])/(o[l+1]-o[l]),s)}}(this),this._lastTimeIndex=0}return n(a.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},innerQuadrangles:{get:function(){return this._innerQuadrangles}}}),a.prototype.findTimeInterval=o.prototype.findTimeInterval,a.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)},a}),o("Core/RectangleGeometryLibrary",["./Cartesian3","./Cartographic","./defined","./DeveloperError","./GeographicProjection","./Math","./Matrix2","./Rectangle"],function(e,t,n,r,i,o,a,s){"use strict";var l=Math.cos,u=Math.sin,c=Math.sqrt,h={};h.computePosition=function(e,t,r,i,o){var s=e.ellipsoid.radiiSquared,h=e.nwCorner,d=e.rectangle,p=h.latitude-e.granYCos*t+r*e.granXSin,f=l(p),m=u(p),_=s.z*m,g=h.longitude+t*e.granYSin+r*e.granXCos,v=f*l(g),y=f*u(g),C=s.x*v,w=s.y*y,b=c(C*v+w*y+_*m);i.x=C/b,i.y=w/b,i.z=_/b,n(e.vertexFormat)&&e.vertexFormat.st&&(o.x=(g-d.west)*e.lonScalar,o.y=(p-d.south)*e.latScalar,a.multiplyByVector(e.textureMatrix,o,o))};var d=new a,p=new e,f=new t,m=new e,_=new i;return h.computeOptions=function(t,r,i){var l,u,c,h,g,v=t._granularity,y=t._ellipsoid,C=t._surfaceHeight,w=t._rotation,b=t._extrudedHeight,E=r.east,S=r.west,x=r.north,T=r.south,A=x-T;S>E?(c=(g=o.TWO_PI-S+E)/((l=Math.ceil(g/v)+1)-1),h=A/((u=Math.ceil(A/v)+1)-1)):(c=(g=E-S)/((l=Math.ceil(g/v)+1)-1),h=A/((u=Math.ceil(A/v)+1)-1)),i=s.northwest(r,i);var P=s.center(r,f),D=h,M=c,I=0,O=0;if(n(w)&&0!==w){var R=Math.cos(w);D*=R,M*=R;var N=Math.sin(w);I=h*N,O=c*N,P.longitude<i.longitude&&(P.longitude+=o.TWO_PI),p=_.project(i,p),m=_.project(P,m),p=e.subtract(p,m,p);var L=a.fromRotation(w,d);p=a.multiplyByVector(L,p,p),p=e.add(p,m,p);var F=(i=_.unproject(p,i)).latitude,B=F+(l-1)*O,k=F-D*(u-1),V=F-D*(u-1)+(l-1)*O;x=Math.max(F,B,k,V),T=Math.min(F,B,k,V);var z=i.longitude,U=z+(l-1)*M,G=z+(u-1)*I,W=z+(u-1)*I+(l-1)*M;E=Math.max(z,U,G,W),S=Math.min(z,U,G,W),r.north=x,r.south=T,r.east=E,r.west=S}return{granYCos:D,granYSin:I,granXCos:M,granXSin:O,ellipsoid:y,width:l,height:u,surfaceHeight:C,extrudedHeight:b,nwCorner:i,rectangle:r}},h}),o("Core/RectangleGeometry",["./BoundingSphere","./Cartesian2","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./GeometryInstance","./GeometryPipeline","./IndexDatatype","./Math","./Matrix2","./Matrix3","./PolygonPipeline","./PrimitiveType","./Quaternion","./Rectangle","./RectangleGeometryLibrary","./VertexFormat"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S){"use strict";function x(e,t){var n=new c({attributes:new d,primitiveType:C.TRIANGLES});return n.attributes.position=new h({componentDatatype:i.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(n.attributes.normal=new h({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(n.attributes.tangent=new h({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.binormal&&(n.attributes.binormal=new h({componentDatatype:i.FLOAT,componentsPerAttribute:3,values:t.binormals})),n}function T(e){for(var t=e.vertexFormat,r=e.ellipsoid,o=e.size,a=e.height,s=e.width,l=t.position?new Float64Array(3*o):void 0,u=t.st?new Float32Array(2*o):void 0,c=0,d=0,p=M,f=L,_=Number.MAX_VALUE,g=Number.MAX_VALUE,y=-Number.MAX_VALUE,C=-Number.MAX_VALUE,w=0;w<a;++w)for(var b=0;b<s;++b)E.computePosition(e,w,b,p,f),l[c++]=p.x,l[c++]=p.y,l[c++]=p.z,t.st&&(u[d++]=f.x,u[d++]=f.y,_=Math.min(_,f.x),g=Math.min(g,f.y),y=Math.max(y,f.x),C=Math.max(C,f.y));if(t.st&&(_<0||g<0||y>1||C>1))for(var S=0;S<u.length;S+=2)u[S]=(u[S]-_)/(y-_),u[S+1]=(u[S+1]-g)/(C-g);for(var T=function(e,t,r,i){for(var o=e.length,a=t.normal?new Float32Array(o):void 0,s=t.tangent?new Float32Array(o):void 0,l=t.binormal?new Float32Array(o):void 0,u=0,c=R,h=O,d=I,p=0;p<o;p+=3){var f=n.fromArray(e,p,M),m=u+1,_=u+2;(t.normal||t.tangent||t.binormal)&&(d=r.geodeticSurfaceNormal(f,d),(t.tangent||t.binormal)&&(n.cross(n.UNIT_Z,d,h),v.multiplyByVector(i,h,h),n.normalize(h,h),t.binormal&&n.normalize(n.cross(d,h,c),c)),t.normal&&(a[u]=d.x,a[m]=d.y,a[_]=d.z),t.tangent&&(s[u]=h.x,s[m]=h.y,s[_]=h.z),t.binormal&&(l[u]=c.x,l[m]=c.y,l[_]=c.z)),u+=3}return x(t,{positions:e,normals:a,tangents:s,binormals:l})}(l,t,r,e.tangentRotationMatrix),A=m.createTypedArray(o,6*(s-1)*(a-1)),P=0,D=0,N=0;N<a-1;++N){for(var F=0;F<s-1;++F){var B=P+s,k=B+1,V=P+1;A[D++]=P,A[D++]=B,A[D++]=V,A[D++]=V,A[D++]=B,A[D++]=k,++P}++P}return T.indices=A,t.st&&(T.attributes.st=new h({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:u})),T}function A(e,t,n,r,i){return e[t++]=r[n],e[t++]=r[n+1],e[t++]=r[n+2],e[t++]=i[n],e[t++]=i[n+1],e[t++]=i[n+2],e}function P(e,t,n,r){return e[t++]=r[n],e[t++]=r[n+1],e[t++]=r[n],e[t++]=r[n+1],e}function D(e){var t=(e=o(e,o.EMPTY_OBJECT)).rectangle,n=o(e.granularity,_.RADIANS_PER_DEGREE),r=o(e.ellipsoid,u.WGS84),i=o(e.height,0),s=o(e.rotation,0),l=o(e.stRotation,0),c=o(e.vertexFormat,S.DEFAULT),h=e.extrudedHeight,d=a(h),p=o(e.closeTop,!0),f=o(e.closeBottom,!0);this._rectangle=t,this._granularity=n,this._ellipsoid=u.clone(r),this._surfaceHeight=i,this._rotation=s,this._stRotation=l,this._vertexFormat=S.clone(c),this._extrudedHeight=o(h,0),this._extrude=d,this._closeTop=p,this._closeBottom=f,this._workerName="createRectangleGeometry",this._rotatedRectangle=function(e,t,n){if(0===n)return b.clone(e);b.northeast(e,H[0]),b.northwest(e,H[1]),b.southeast(e,H[2]),b.southwest(e,H[3]),t.cartographicArrayToCartesianArray(H,W);var r=t.geodeticSurfaceNormalCartographic(b.center(e,U));w.fromAxisAngle(r,n,G),v.fromQuaternion(G,z);for(var i=0;i<4;++i)v.multiplyByVector(z,W[i],W[i]);return t.cartesianArrayToCartographicArray(W,H),b.fromCartographicArray(H)}(this._rectangle,this._ellipsoid,s)}var M=new n,I=new n,O=new n,R=new n,N=new b,L=new t,F=new e,B=new e,k=new n,V=new n,z=new v,U=new n,G=new w,W=[new n,new n,new n,new n],H=[new r,new r,new r,new r];D.packedLength=b.packedLength+u.packedLength+S.packedLength+b.packedLength+8,D.pack=function(e,t,n){return n=o(n,0),b.pack(e._rectangle,t,n),u.pack(e._ellipsoid,t,n+=b.packedLength),S.pack(e._vertexFormat,t,n+=u.packedLength),b.pack(e._rotatedRectangle,t,n+=S.packedLength),n+=b.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=e._stRotation,t[n++]=e._extrudedHeight,t[n++]=e._extrude?1:0,t[n++]=e._closeTop?1:0,t[n]=e._closeBottom?1:0,t};var j=new b,q=new b,Y=u.clone(u.UNIT_SPHERE),X=new S,Z={rectangle:j,ellipsoid:Y,vertexFormat:X,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,closeTop:void 0,closeBottom:void 0};D.unpack=function(e,t,n){t=o(t,0);var r=b.unpack(e,t,j),i=u.unpack(e,t+=b.packedLength,Y),s=S.unpack(e,t+=u.packedLength,X),l=b.unpack(e,t+=S.packedLength,q);t+=b.packedLength;var c=e[t++],h=e[t++],d=e[t++],p=e[t++],f=e[t++],m=1===e[t++],_=1===e[t++],g=1===e[t];return a(n)?(n._rectangle=b.clone(r,n._rectangle),n._ellipsoid=u.clone(i,n._ellipsoid),n._vertexFormat=S.clone(s,n._vertexFormat),n._granularity=c,n._surfaceHeight=h,n._rotation=d,n._stRotation=p,n._extrudedHeight=m?f:void 0,n._extrude=m,n._closeTop=_,n._closeBottom=g,n._rotatedRectangle=l,n):(Z.granularity=c,Z.height=h,Z.rotation=d,Z.stRotation=p,Z.extrudedHeight=m?f:void 0,Z.closeTop=_,Z.closeBottom=g,new D(Z))};var K=new g,Q=new v,J=new r,$=new w,ee=new r;return D.createGeometry=function(t){if(!_.equalsEpsilon(t._rectangle.north,t._rectangle.south,_.EPSILON10)&&!_.equalsEpsilon(t._rectangle.east,t._rectangle.west,_.EPSILON10)){var r,o,s=b.clone(t._rectangle,N),l=t._ellipsoid,u=t._surfaceHeight,C=t._extrude,S=t._extrudedHeight,D=t._stRotation,L=t._vertexFormat,z=E.computeOptions(t,s,J),U=K,G=Q;if(a(D)){g.fromRotation(-D,U);var W=b.center(s,ee),H=l.cartographicToCartesian(W,k);n.normalize(H,H),w.fromAxisAngle(H,-D,$),v.fromQuaternion($,G)}else g.clone(g.IDENTITY,U),v.clone(v.IDENTITY,G);if(z.lonScalar=1/s.width,z.latScalar=1/s.height,z.vertexFormat=L,z.textureMatrix=U,z.tangentRotationMatrix=G,z.size=z.width*z.height,s=t._rectangle,C){r=function(e){var t,r=e.vertexFormat,o=e.surfaceHeight,a=e.extrudedHeight,s=Math.min(a,o),l=Math.max(a,o),u=e.height,c=e.width,d=e.ellipsoid,g=T(e);if(_.equalsEpsilon(s,l,_.EPSILON10))return g;var v=y.scaleToGeodeticHeight(g.attributes.position.values,l,d,!1),C=(v=new Float64Array(v)).length,w=2*C,b=new Float64Array(w);b.set(v);var E=y.scaleToGeodeticHeight(g.attributes.position.values,s,d);b.set(E,C),g.attributes.position.values=b;var S,D=r.normal?new Float32Array(w):void 0,N=r.tangent?new Float32Array(w):void 0,L=r.binormal?new Float32Array(w):void 0,F=r.st?new Float32Array(w/3*2):void 0;if(r.normal){var B=g.attributes.normal.values;for(D.set(B),t=0;t<C;t++)B[t]=-B[t];D.set(B,C),g.attributes.normal.values=D}if(r.tangent){var z=g.attributes.tangent.values;for(N.set(z),t=0;t<C;t++)z[t]=-z[t];N.set(z,C),g.attributes.tangent.values=N}if(r.binormal){var U=g.attributes.binormal.values;L.set(U),L.set(U,C),g.attributes.binormal.values=L}r.st&&(F.set(S=g.attributes.st.values),F.set(S,C/3*2),g.attributes.st.values=F);var G=g.indices,W=G.length,H=C/3,j=m.createTypedArray(w/3,2*W);for(j.set(G),t=0;t<W;t+=3)j[t+W]=G[t+2]+H,j[t+1+W]=G[t+1]+H,j[t+2+W]=G[t]+H;g.indices=j;var q=2*c+2*u-4,Y=2*(q+4),X=new Float64Array(3*Y),Z=r.st?new Float32Array(2*Y):void 0,K=0,Q=0,J=c*u;for(t=0;t<J;t+=c)X=A(X,K,3*t,v,E),K+=6,r.st&&(Z=P(Z,Q,2*t,S),Q+=4);for(t=J-c;t<J;t++)X=A(X,K,3*t,v,E),K+=6,r.st&&(Z=P(Z,Q,2*t,S),Q+=4);for(t=J-1;t>0;t-=c)X=A(X,K,3*t,v,E),K+=6,r.st&&(Z=P(Z,Q,2*t,S),Q+=4);for(t=c-1;t>=0;t--)X=A(X,K,3*t,v,E),K+=6,r.st&&(Z=P(Z,Q,2*t,S),Q+=4);var $=function(e,t,r){for(var i=e.length,o=t.normal?new Float32Array(i):void 0,a=t.tangent?new Float32Array(i):void 0,s=t.binormal?new Float32Array(i):void 0,l=0,u=0,c=0,h=!0,d=R,p=O,f=I,m=0;m<i;m+=6){var g=n.fromArray(e,m,M);if(t.normal||t.tangent||t.binormal){var v=n.fromArray(e,(m+6)%i,k);if(h){var y=n.fromArray(e,(m+3)%i,V);n.subtract(v,g,v),n.subtract(y,g,y),f=n.normalize(n.cross(y,v,f),f),h=!1}n.equalsEpsilon(v,g,_.EPSILON10)&&(h=!0),(t.tangent||t.binormal)&&(d=r.geodeticSurfaceNormal(g,d),t.tangent&&(p=n.normalize(n.cross(d,f,p),p))),t.normal&&(o[l++]=f.x,o[l++]=f.y,o[l++]=f.z,o[l++]=f.x,o[l++]=f.y,o[l++]=f.z),t.tangent&&(a[u++]=p.x,a[u++]=p.y,a[u++]=p.z,a[u++]=p.x,a[u++]=p.y,a[u++]=p.z),t.binormal&&(s[c++]=d.x,s[c++]=d.y,s[c++]=d.z,s[c++]=d.x,s[c++]=d.y,s[c++]=d.z)}}return x(t,{positions:e,normals:o,tangents:a,binormals:s})}(X,r,d);r.st&&($.attributes.st=new h({componentDatatype:i.FLOAT,componentsPerAttribute:2,values:Z}));var ee,te,ne,re,ie=m.createTypedArray(Y,6*q);C=X.length/3;var oe=0;for(t=0;t<C-1;t+=2){re=((ee=t)+2)%C;var ae=n.fromArray(X,3*ee,k),se=n.fromArray(X,3*re,V);n.equalsEpsilon(ae,se,_.EPSILON10)||(ne=(2+(te=(ee+1)%C))%C,ie[oe++]=ee,ie[oe++]=te,ie[oe++]=re,ie[oe++]=re,ie[oe++]=te,ie[oe++]=ne)}return $.indices=ie,($=f.combineInstances([new p({geometry:g}),new p({geometry:$})]))[0]}(z);var j=e.fromRectangle3D(s,l,u,B),q=e.fromRectangle3D(s,l,S,F);o=e.union(j,q)}else r=T(z),r.attributes.position.values=y.scaleToGeodeticHeight(r.attributes.position.values,u,l,!1),o=e.fromRectangle3D(s,l,u);return L.position||delete r.attributes.position,new c({attributes:new d(r.attributes),indices:r.indices,primitiveType:r.primitiveType,boundingSphere:o})}},D.createShadowVolume=function(e,t,n){var r=e._granularity,i=e._ellipsoid,o=t(r,i),a=n(r,i);return new D({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:i,stRotation:e._stRotation,granularity:r,extrudedHeight:a,height:o,closeTop:!0,closeBottom:!0,vertexFormat:S.POSITION_ONLY})},s(D.prototype,{rectangle:{get:function(){return this._rotatedRectangle}}}),D}),o("Core/RectangleOutlineGeometry",["./BoundingSphere","./Cartesian3","./Cartographic","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolygonPipeline","./PrimitiveType","./Rectangle","./RectangleGeometryLibrary"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";function g(e){var t,n=e.height,i=e.width,o=new Float64Array(3*e.size),a=0,s=0,d=w;for(t=0;t<i;t++)_.computePosition(e,s,t,d),o[a++]=d.x,o[a++]=d.y,o[a++]=d.z;for(t=i-1,s=1;s<n;s++)_.computePosition(e,s,t,d),o[a++]=d.x,o[a++]=d.y,o[a++]=d.z;for(s=n-1,t=i-2;t>=0;t--)_.computePosition(e,s,t,d),o[a++]=d.x,o[a++]=d.y,o[a++]=d.z;for(t=0,s=n-2;s>0;s--)_.computePosition(e,s,t,d),o[a++]=d.x,o[a++]=d.y,o[a++]=d.z;for(var p=h.createTypedArray(o.length/3,o.length/3*2),m=0,g=0;g<o.length/3-1;g++)p[m++]=g,p[m++]=g+1;p[m++]=o.length/3-1,p[m++]=0;var v=new l({attributes:new c,primitiveType:f.LINES});return v.attributes.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:o}),v.indices=p,v}function v(e){var t=(e=i(e,i.EMPTY_OBJECT)).rectangle,n=i(e.granularity,d.RADIANS_PER_DEGREE),r=i(e.ellipsoid,s.WGS84),o=i(e.height,0),a=i(e.rotation,0),l=e.extrudedHeight;this._rectangle=t,this._granularity=n,this._ellipsoid=r,this._surfaceHeight=o,this._rotation=a,this._extrudedHeight=l,this._workerName="createRectangleOutlineGeometry"}var y=new e,C=new e,w=new t,b=new m;v.packedLength=m.packedLength+s.packedLength+5,v.pack=function(e,t,n){return n=i(n,0),m.pack(e._rectangle,t,n),s.pack(e._ellipsoid,t,n+=m.packedLength),n+=s.packedLength,t[n++]=e._granularity,t[n++]=e._surfaceHeight,t[n++]=e._rotation,t[n++]=o(e._extrudedHeight)?1:0,t[n]=i(e._extrudedHeight,0),t};var E=new m,S=s.clone(s.UNIT_SPHERE),x={rectangle:E,ellipsoid:S,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0};v.unpack=function(e,t,n){t=i(t,0);var r=m.unpack(e,t,E),a=s.unpack(e,t+=m.packedLength,S);t+=s.packedLength;var l=e[t++],u=e[t++],c=e[t++],h=e[t++],d=e[t];return o(n)?(n._rectangle=m.clone(r,n._rectangle),n._ellipsoid=s.clone(a,n._ellipsoid),n._surfaceHeight=u,n._rotation=c,n._extrudedHeight=h?d:void 0,n):(x.granularity=l,x.height=u,x.rotation=c,x.extrudedHeight=h?d:void 0,new v(x))};var T=new n;return v.createGeometry=function(t){var n,r,i=m.clone(t._rectangle,b),a=t._ellipsoid,s=t._surfaceHeight,u=t._extrudedHeight,c=_.computeOptions(t,i,T);if(c.size=2*c.width+2*c.height-4,!d.equalsEpsilon((i=t._rectangle).north,i.south,d.EPSILON10)&&!d.equalsEpsilon(i.east,i.west,d.EPSILON10)){if(o(u)){n=function(e){var t=e.surfaceHeight,n=e.extrudedHeight,r=e.ellipsoid,i=Math.min(n,t),o=Math.max(n,t),a=g(e);if(d.equalsEpsilon(i,o,d.EPSILON10))return a;var s=e.height,l=e.width,u=p.scaleToGeodeticHeight(a.attributes.position.values,o,r,!1),c=u.length,f=new Float64Array(2*c);f.set(u);var m=p.scaleToGeodeticHeight(a.attributes.position.values,i,r);f.set(m,c),a.attributes.position.values=f;var _=h.createTypedArray(f.length/3,f.length/3*2+8);c=f.length/6;for(var v=0,y=0;y<c-1;y++)_[v++]=y,_[v++]=y+1,_[v++]=y+c,_[v++]=y+c+1;return _[v++]=c-1,_[v++]=0,_[v++]=c+c-1,_[v++]=c,_[v++]=0,_[v++]=c,_[v++]=l-1,_[v++]=c+l-1,_[v++]=l+s-2,_[v++]=l+s-2+c,_[v++]=2*l+s-3,_[v++]=2*l+s-3+c,a.indices=_,a}(c);var v=e.fromRectangle3D(i,a,s,C),w=e.fromRectangle3D(i,a,u,y);r=e.union(v,w)}else n=g(c),n.attributes.position.values=p.scaleToGeodeticHeight(n.attributes.position.values,s,a,!1),r=e.fromRectangle3D(i,a,s);return new l({attributes:n.attributes,indices:n.indices,primitiveType:f.LINES,boundingSphere:r})}},v}),o("Core/ReferenceFrame",["./freezeObject"],function(e){"use strict";return e({FIXED:0,INERTIAL:1})}),o("Core/requestAnimationFrame",["./defined","./getTimestamp"],function(e,t){"use strict";if("undefined"!=typeof window){var n=window.requestAnimationFrame;return function(){if(!e(n))for(var r=["webkit","moz","ms","o"],i=0,o=r.length;i<o&&!e(n);)n=window[r[i]+"RequestAnimationFrame"],++i;if(!e(n)){var a=0;n=function(e){var n=t(),r=Math.max(1e3/60-(n-a),0);return a=n+r,setTimeout(function(){e(a)},r)}}}(),function(e){return n(e)}}}),o("Core/sampleTerrain",["../ThirdParty/when","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(e){var t=e.positions,n=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(e){for(var r=0;r<t.length;++r){var i=t[r];i.height=e.interpolateHeight(n,i.longitude,i.latitude)}}}function i(e){var t=e.positions;return function(){for(var e=0;e<t.length;++e)t[e].height=void 0}}return function(t,n,o){var a=e.defer();return function s(){t.ready?e(function(t,n,o){var a,s=t.tilingScheme,l=[],u={};for(a=0;a<o.length;++a){var c=s.positionToTileXY(o[a],n),h=c.toString();if(!u.hasOwnProperty(h)){var d={x:c.x,y:c.y,level:n,tilingScheme:s,terrainProvider:t,positions:[]};u[h]=d,l.push(d)}u[h].positions.push(o[a])}var p=[];for(a=0;a<l.length;++a){var f=l[a],m=f.terrainProvider.requestTileGeometry(f.x,f.y,f.level,!1),_=e(m,r(f),i(f));p.push(_)}return e.all(p,function(){return o})}(t,n,o),function(e){a.resolve(e)}):setTimeout(s,10)}(),a.promise}}),o("Core/ScreenSpaceEventType",["./freezeObject"],function(e){"use strict";return e({LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,RIGHT_DOUBLE_CLICK:8,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MIDDLE_DOUBLE_CLICK:13,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19})}),o("Core/ScreenSpaceEventHandler",["./AssociativeArray","./Cartesian2","./defaultValue","./defined","./destroyObject","./DeveloperError","./FeatureDetection","./getTimestamp","./KeyboardEventModifier","./ScreenSpaceEventType"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,t,n){var r=e._element;if(r===document)return n.x=t.clientX,n.y=t.clientY,n;var i=r.getBoundingClientRect();return n.x=t.clientX-i.left,n.y=t.clientY-i.top,n}function h(e,t){var n=e;return r(t)&&(n+="+"+t),n}function d(e){return e.shiftKey?l.SHIFT:e.ctrlKey?l.CTRL:e.altKey?l.ALT:void 0}function p(e,t,n,r){function i(t){r(e,t)}n.addEventListener(t,i,!1),e._removalFunctions.push(function(){n.removeEventListener(t,i,!1)})}function f(e){e._lastSeenTouchEvent=s()}function m(e){return s()-e._lastSeenTouchEvent>D.mouseEmulationIgnoreMilliseconds}function _(e,n){if(m(e)){var i,o=n.button;if(e._buttonDown=o,o===M.LEFT)i=u.LEFT_DOWN;else if(o===M.MIDDLE)i=u.MIDDLE_DOWN;else{if(o!==M.RIGHT)return;i=u.RIGHT_DOWN}var a=c(e,n,e._primaryPosition);t.clone(a,e._primaryStartPosition),t.clone(a,e._primaryPreviousPosition);var s=d(n),l=e.getInputAction(i,s);r(l)&&(t.clone(a,I.position),l(I),n.preventDefault())}}function g(e,n){if(m(e)){var i,o,a=n.button;if(e._buttonDown=void 0,a===M.LEFT)i=u.LEFT_UP,o=u.LEFT_CLICK;else if(a===M.MIDDLE)i=u.MIDDLE_UP,o=u.MIDDLE_CLICK;else{if(a!==M.RIGHT)return;i=u.RIGHT_UP,o=u.RIGHT_CLICK}var s=d(n),l=e.getInputAction(i,s),h=e.getInputAction(o,s);if(r(l)||r(h)){var p=c(e,n,e._primaryPosition);if(r(l)&&(t.clone(p,O.position),l(O)),r(h)){var f=e._primaryStartPosition,_=f.x-p.x,g=f.y-p.y;Math.sqrt(_*_+g*g)<e._clickPixelTolerance&&(t.clone(p,R.position),h(R))}}}}function v(e,n){if(m(e)){var i=d(n),o=c(e,n,e._primaryPosition),a=e._primaryPreviousPosition,s=e.getInputAction(u.MOUSE_MOVE,i);r(s)&&(t.clone(a,N.startPosition),t.clone(o,N.endPosition),s(N)),t.clone(o,a),r(e._buttonDown)&&n.preventDefault()}}function y(e,t){var n,i=t.button;if(i===M.LEFT)n=u.LEFT_DOUBLE_CLICK;else if(i===M.MIDDLE)n=u.MIDDLE_DOUBLE_CLICK;else{if(i!==M.RIGHT)return;n=u.RIGHT_DOUBLE_CLICK}var o=d(t),a=e.getInputAction(n,o);r(a)&&(c(e,t,L.position),a(L))}function C(e,t){var n;if(r(t.deltaY)){var i=t.deltaMode;n=i===t.DOM_DELTA_PIXEL?-t.deltaY:i===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else n=t.detail>0?-120*t.detail:t.wheelDelta;if(r(n)){var o=d(t),a=e.getInputAction(u.WHEEL,o);r(a)&&(a(n),t.preventDefault())}}function w(e,n){f(e);var r,i,o,a=n.changedTouches,s=a.length,l=e._positions;for(r=0;r<s;++r)i=a[r],o=i.identifier,l.set(o,c(e,i,new t));E(e,n);var u=e._previousPositions;for(r=0;r<s;++r)i=a[r],o=i.identifier,u.set(o,t.clone(l.get(o)))}function b(e,t){f(e);var n,r,i,o=t.changedTouches,a=o.length,s=e._positions;for(n=0;n<a;++n)r=o[n],i=r.identifier,s.remove(i);E(e,t);var l=e._previousPositions;for(n=0;n<a;++n)r=o[n],i=r.identifier,l.remove(i)}function E(e,n){var i,o,a=d(n),s=e._positions,l=e._previousPositions,c=s.length;if(1!==c&&e._buttonDown===M.LEFT&&(e._buttonDown=void 0,i=e.getInputAction(u.LEFT_UP,a),r(i)&&(t.clone(e._primaryPosition,k.position),i(k)),0===c&&(o=e.getInputAction(u.LEFT_CLICK,a),r(o)))){var h=e._primaryStartPosition,p=l.values[0],f=h.x-p.x,m=h.y-p.y;Math.sqrt(f*f+m*m)<e._clickPixelTolerance&&(t.clone(e._primaryPosition,V.position),o(V))}if(2!==c&&e._isPinching&&(e._isPinching=!1,i=e.getInputAction(u.PINCH_END,a),r(i)&&i()),1===c){var _=s.values[0];t.clone(_,e._primaryPosition),t.clone(_,e._primaryStartPosition),t.clone(_,e._primaryPreviousPosition),e._buttonDown=M.LEFT,i=e.getInputAction(u.LEFT_DOWN,a),r(i)&&(t.clone(_,F.position),i(F)),n.preventDefault()}2===c&&(e._isPinching=!0,i=e.getInputAction(u.PINCH_START,a),r(i)&&(t.clone(s.values[0],B.position1),t.clone(s.values[1],B.position2),i(B),n.preventDefault()))}function S(e,n){f(e);var i,o,a,s=n.changedTouches,l=s.length,u=e._positions;for(i=0;i<l;++i){var h=u.get(a=(o=s[i]).identifier);r(h)&&c(e,o,h)}x(e,n);var d=e._previousPositions;for(i=0;i<l;++i)o=s[i],a=o.identifier,t.clone(u.get(a),d.get(a))}function x(e,n){var i,o=d(n),a=e._positions,s=e._previousPositions,l=a.length;if(1===l&&e._buttonDown===M.LEFT){var c=a.values[0];t.clone(c,e._primaryPosition);var h=e._primaryPreviousPosition;i=e.getInputAction(u.MOUSE_MOVE,o),r(i)&&(t.clone(h,z.startPosition),t.clone(c,z.endPosition),i(z)),t.clone(c,h),n.preventDefault()}else if(2===l&&e._isPinching&&(i=e.getInputAction(u.PINCH_MOVE,o),r(i))){var p=a.values[0],f=a.values[1],m=s.values[0],_=s.values[1],g=f.x-p.x,v=f.y-p.y,y=.25*Math.sqrt(g*g+v*v),C=_.x-m.x,w=_.y-m.y,b=.25*Math.sqrt(C*C+w*w),E=.125*(f.y+p.y),S=.125*(_.y+m.y),x=Math.atan2(v,g),T=Math.atan2(w,C);t.fromElements(0,b,U.distance.startPosition),t.fromElements(0,y,U.distance.endPosition),t.fromElements(T,S,U.angleAndHeight.startPosition),t.fromElements(x,E,U.angleAndHeight.endPosition),i(U)}}function T(e,n){if(n.target.setPointerCapture(n.pointerId),"touch"===n.pointerType){var r=e._positions,i=n.pointerId;r.set(i,c(e,n,new t)),E(e,n),e._previousPositions.set(i,t.clone(r.get(i)))}else _(e,n)}function A(e,t){if("touch"===t.pointerType){var n=t.pointerId;e._positions.remove(n),E(e,t),e._previousPositions.remove(n)}else g(e,t)}function P(e,n){if("touch"===n.pointerType){var i=e._positions,o=n.pointerId,a=i.get(o);if(!r(a))return;c(e,n,a),x(e,n);var s=e._previousPositions;t.clone(i.get(o),s.get(o))}else v(e,n)}function D(i){var o,s;this._inputEvents={},this._buttonDown=void 0,this._isPinching=!1,this._lastSeenTouchEvent=-D.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new t,this._primaryPosition=new t,this._primaryPreviousPosition=new t,this._positions=new e,this._previousPositions=new e,this._removalFunctions=[],this._clickPixelTolerance=5,this._element=n(i,document),s=r((o=this._element).disableRootEvents)?o:document,a.supportsPointerEvents()?(p(this,"pointerdown",o,T),p(this,"pointerup",o,A),p(this,"pointermove",o,P),p(this,"pointercancel",o,A)):(p(this,"mousedown",o,_),p(this,"mouseup",s,g),p(this,"mousemove",s,v),p(this,"touchstart",o,w),p(this,"touchend",s,b),p(this,"touchmove",s,S),p(this,"touchcancel",s,b)),p(this,"dblclick",o,y),p(this,"onwheel"in o?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",o,C)}var M={LEFT:0,MIDDLE:1,RIGHT:2},I={position:new t},O={position:new t},R={position:new t},N={startPosition:new t,endPosition:new t},L={position:new t},F={position:new t},B={position1:new t,position2:new t},k={position:new t},V={position:new t},z={startPosition:new t,endPosition:new t},U={distance:{startPosition:new t,endPosition:new t},angleAndHeight:{startPosition:new t,endPosition:new t}};return D.prototype.setInputAction=function(e,t,n){var r=h(t,n);this._inputEvents[r]=e},D.prototype.getInputAction=function(e,t){var n=h(e,t);return this._inputEvents[n]},D.prototype.removeInputAction=function(e,t){var n=h(e,t);delete this._inputEvents[n]},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){return function(e){for(var t=e._removalFunctions,n=0;n<t.length;++n)t[n]()}(this),i(this)},D.mouseEmulationIgnoreMilliseconds=800,D}),o("Core/ShowGeometryInstanceAttribute",["./ComponentDatatype","./defaultValue","./defined","./defineProperties","./DeveloperError"],function(e,t,n,r,i){"use strict";function o(e){e=t(e,!0),this.value=o.toValue(e)}return r(o.prototype,{componentDatatype:{get:function(){return e.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),o.toValue=function(e,t){return n(t)?(t[0]=e,t):new Uint8Array([e])},o}),o("Core/Simon1994PlanetaryPositions",["./Cartesian3","./defined","./DeveloperError","./JulianDate","./Math","./Matrix3","./TimeConstants","./TimeStandard"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t){t=r.addSeconds(e,d,t);var n,i=r.totalDays(t)-p;return r.addSeconds(t,(n=6.239996+.0172019696544*i,.001657*Math.sin(n+.01671*Math.sin(n))),t)}function u(n,r,a,s,l,u,c){a<0&&(a=-a,l+=i.PI);var h,d,p,f,m,_,g,w,b,E,S,x=n*(1-r),T=s-l,A=l,P=function(e,t){var n=Math.floor(e/i.TWO_PI);e-=n*i.TWO_PI;var r=Math.cos(e)-t,o=Math.sin(e)*Math.sqrt(1-t*t),a=Math.atan2(o,r);return a=i.zeroToTwoPi(a),e<0&&(a-=i.TWO_PI),a+n*i.TWO_PI}(function(e,t){var n,r=Math.floor(e/i.TWO_PI),o=(e-=r*i.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),a=Number.MAX_VALUE;for(n=0;n<y&&Math.abs(a-o)>C;++n){var s=(a=o)-t*Math.sin(a)-e;o=a-s/(1-t*Math.cos(a))}return o+r*i.TWO_PI}(u-s,h=r),h);d=T,p=a,f=A,m=v,_=Math.cos(d),g=Math.sin(d),w=Math.cos(p),b=Math.sin(p),E=Math.cos(f),S=Math.sin(f),t(m)?(m[0]=E*_-S*g*w,m[1]=S*_+E*g*w,m[2]=g*b,m[3]=-E*g-S*_*w,m[4]=-S*g+E*_*w,m[5]=_*b,m[6]=S*b,m[7]=-E*b,m[8]=w):m=new o(E*_-S*g*w,-E*g-S*_*w,S*b,S*_+E*g*w,-S*g+E*_*w,-E*b,g*b,_*b,w);var D=x*(1+r),M=Math.cos(P),I=Math.sin(P),O=D/(1+r*M);return t(c)?(c.x=O*M,c.y=O*I,c.z=0):c=new e(O*M,O*I,0),o.multiplyByVector(v,c,c)}function c(e,t){l(e,E);var n=(E.dayNumber-f.dayNumber+(E.secondsOfDay-f.secondsOfDay)/a.SECONDS_PER_DAY)/a.DAYS_PER_JULIAN_CENTURY,r=n*n,i=r*n,o=i*n,s=383397.7725+.004*n,c=.055545526-1.6e-8*n,h=5.15668983*_,d=-8e-5*n+.02966*r-42e-6*i-1.3e-7*o,p=83.35324312*_,v=14643420.2669*n-38.2702*r-.045047*i+21301e-8*o,y=125.04455501*_,C=-6967919.3631*n+6.3602*r+.007625*i-3586e-8*o,w=218.31664563*_,b=1732559343.4847*n-6.391*r+.006588*i-3169e-8*o,S=297.85019547*_+g*(1602961601.209*n-6.3706*r+.006593*i-3169e-8*o),x=134.96340251*_+g*(1717915923.2178*n+31.8792*r+.051635*i-2447e-7*o),T=357.52910918*_+g*(129596581.0481*n-.5532*r+136e-6*i-1149e-8*o),A=310.17137918*_-g*(6967051.436*n+6.2068*r+.007618*i-3219e-8*o),P=2*S,D=4*S,M=6*S,I=2*x,O=3*x,R=4*x,N=2*(93.27209062*_+g*(1739527262.8478*n-12.7512*r-.001037*i+417e-8*o));s+=3400.4*Math.cos(P)-635.6*Math.cos(P-x)-235.6*Math.cos(x)+218.1*Math.cos(P-T)+181*Math.cos(P+x),c+=.014216*Math.cos(P-x)+.008551*Math.cos(P-I)-.001383*Math.cos(x)+.001356*Math.cos(P+x)-.001147*Math.cos(D-O)-914e-6*Math.cos(D-I)+869e-6*Math.cos(P-T-x)-627e-6*Math.cos(P)-394e-6*Math.cos(D-R)+282e-6*Math.cos(P-T-I)-279e-6*Math.cos(S-x)-236e-6*Math.cos(I)+231e-6*Math.cos(D)+229e-6*Math.cos(M-R)-201e-6*Math.cos(I-N),d+=486.26*Math.cos(P-N)-40.13*Math.cos(P)+37.51*Math.cos(N)+25.73*Math.cos(I-N)+19.97*Math.cos(P-T-N),v+=-55609*Math.sin(P-x)-34711*Math.sin(P-I)-9792*Math.sin(x)+9385*Math.sin(D-O)+7505*Math.sin(D-I)+5318*Math.sin(P+x)+3484*Math.sin(D-R)-3417*Math.sin(P-T-x)-2530*Math.sin(M-R)-2376*Math.sin(P)-2075*Math.sin(P-O)-1883*Math.sin(I)-1736*Math.sin(M-5*x)+1626*Math.sin(T)-1370*Math.sin(M-O),C+=-5392*Math.sin(P-N)-540*Math.sin(T)-441*Math.sin(P)+423*Math.sin(N)-288*Math.sin(I-N),b+=-3332.9*Math.sin(P)+1197.4*Math.sin(P-x)-662.5*Math.sin(T)+396.3*Math.sin(x)-218*Math.sin(P-T);var L=2*A,F=3*A;d+=46.997*Math.cos(A)*n-.614*Math.cos(P-N+A)*n+.614*Math.cos(P-N-A)*n-.0297*Math.cos(L)*r-.0335*Math.cos(A)*r+.0012*Math.cos(P-N+L)*r-16e-5*Math.cos(A)*i+4e-5*Math.cos(F)*i+4e-5*Math.cos(L)*i;var B=2.116*Math.sin(A)*n-.111*Math.sin(P-N-A)*n-.0015*Math.sin(A)*r;return v+=B,b+=B,C+=-520.77*Math.sin(A)*n+13.66*Math.sin(P-N+A)*n+1.12*Math.sin(P-A)*n-1.06*Math.sin(N-A)*n+.66*Math.sin(L)*r+.371*Math.sin(A)*r-.035*Math.sin(P-N+L)*r-.015*Math.sin(P-N+A)*r+.0014*Math.sin(A)*i-.0011*Math.sin(F)*i-9e-4*Math.sin(L)*i,u(s*=m,c,h+d*g,p+v*g,y+C*g,w+b*g,t)}var h={},d=32.184,p=2451545,f=new r(2451545,0,s.TAI),m=1e3,_=i.RADIANS_PER_DEGREE,g=i.RADIANS_PER_ARCSECOND,v=new o,y=50,C=i.EPSILON8,w=100.46645683*_,b=1295977422.83429*g,E=new r(0,0,s.TAI),S=new o(1.0000000000000002,5.619723173785822e-16,4.690511510146299e-19,-5.154129427414611e-16,.9174820620691819,-.39777715593191376,-2.23970096136568e-16,.39777715593191376,.9174820620691819),x=new e;return h.computeSunPositionInEarthInertialFrame=function(n,i){return t(n)||(n=r.now()),t(i)||(i=new e),x=function(e,t){l(n,E);var r=(E.dayNumber-f.dayNumber+(E.secondsOfDay-f.secondsOfDay)/a.SECONDS_PER_DAY)/(10*a.DAYS_PER_JULIAN_CENTURY),i=.3595362*r,o=149598022260.7121+957426.3679999999*Math.cos(16002*i)+-2243968.05*Math.sin(16002*i)+-2273887.624*Math.cos(21863*i)+-688150.202*Math.sin(21863*i)+927506.794*Math.cos(32004*i)+1017265.516*Math.sin(32004*i)+-119678.29599999999*Math.cos(10931*i)+807828.498*Math.sin(10931*i)+478713.18399999995*Math.cos(14529*i)+209437.01799999998*Math.sin(14529*i)+-613351.267*Math.cos(16368*i)+359034.888*Math.sin(16368*i)+284235.953*Math.cos(15318*i)+-418874.03599999996*Math.sin(15318*i)+-164557.657*Math.cos(32794*i)+329115.314*Math.sin(32794*i),s=w+b*r+-325e-7*Math.cos(10*i)+-105e-7*Math.sin(10*i)+-322e-7*Math.cos(16002*i)+-137e-7*Math.sin(16002*i)+1e-7*-79*Math.cos(21863*i)+258e-7*Math.sin(21863*i)+232*1e-7*Math.cos(10931*i)+35e-7*Math.sin(10931*i)+1e-7*-52*Math.cos(1473*i)+1e-7*-116*Math.sin(1473*i)+97e-7*Math.cos(32004*i)+-88e-7*Math.sin(32004*i)+55e-7*Math.cos(4387*i)+-112e-7*Math.sin(4387*i)+-41e-7*Math.cos(73*i)+-8e-6*Math.sin(73*i);return u(o,.0167086342-.0004203654*r,469.97289*g*r,102.93734808*_+11612.3529*g*r,174.87317577*_-8679.27034*g*r,s,t)}(0,x),i=e.negate(x,i),s=c(n,s=x),e.multiplyByScalar(s,-.01215058143522694,s),e.subtract(i,x,i),o.multiplyByVector(S,i,i),i;var s},h.computeMoonPositionInEarthInertialFrame=function(e,n){return t(e)||(e=r.now()),n=c(e,n),o.multiplyByVector(S,n,n),n},h}),o("Core/SimplePolylineGeometry",["./BoundingSphere","./Cartesian3","./Color","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PolylinePipeline","./PrimitiveType"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e,t,r,i,o,a,s){var l,u=p.numberOfPoints(e,t,o),c=r.red,h=r.green,d=r.blue,f=r.alpha,m=i.red,_=i.green,g=i.blue,v=i.alpha;if(n.equals(r,i)){for(l=0;l<u;l++)a[s++]=n.floatToByte(c),a[s++]=n.floatToByte(h),a[s++]=n.floatToByte(d),a[s++]=n.floatToByte(f);return s}var y=(m-c)/u,C=(_-h)/u,w=(g-d)/u,b=(v-f)/u,E=s;for(l=0;l<u;l++)a[E++]=n.floatToByte(c+l*y),a[E++]=n.floatToByte(h+l*C),a[E++]=n.floatToByte(d+l*w),a[E++]=n.floatToByte(f+l*b);return E}function _(e){var r=(e=i(e,i.EMPTY_OBJECT)).positions,a=e.colors,l=i(e.colorsPerVertex,!1);this._positions=r,this._colors=a,this._colorsPerVertex=l,this._followSurface=i(e.followSurface,!0),this._granularity=i(e.granularity,d.RADIANS_PER_DEGREE),this._ellipsoid=i(e.ellipsoid,s.WGS84),this._workerName="createSimplePolylineGeometry";var u=1+r.length*t.packedLength;u+=o(a)?1+a.length*n.packedLength:1,this.packedLength=u+s.packedLength+3}_.pack=function(e,r,a){a=i(a,0);var l,u=e._positions,c=u.length;for(r[a++]=c,l=0;l<c;++l,a+=t.packedLength)t.pack(u[l],r,a);var h=e._colors;for(c=o(h)?h.length:0,r[a++]=c,l=0;l<c;++l,a+=n.packedLength)n.pack(h[l],r,a);return s.pack(e._ellipsoid,r,a),a+=s.packedLength,r[a++]=e._colorsPerVertex?1:0,r[a++]=e._followSurface?1:0,r[a]=e._granularity,r},_.unpack=function(e,r,a){r=i(r,0);var l,u=e[r++],c=new Array(u);for(l=0;l<u;++l,r+=t.packedLength)c[l]=t.unpack(e,r);var h=(u=e[r++])>0?new Array(u):void 0;for(l=0;l<u;++l,r+=n.packedLength)h[l]=n.unpack(e,r);var d=s.unpack(e,r);r+=s.packedLength;var p=1===e[r++],f=1===e[r++],m=e[r];return o(a)?(a._positions=c,a._colors=h,a._ellipsoid=d,a._colorsPerVertex=p,a._followSurface=f,a._granularity=m,a):new _({positions:c,colors:h,ellipsoid:d,colorsPerVertex:p,followSurface:f,granularity:m})};var g=new Array(2),v=new Array(2),y={positions:g,height:v,ellipsoid:void 0,minDistance:void 0};return _.createGeometry=function(i){var a,s,_,C,w,b=i._positions,E=i._colors,S=i._colorsPerVertex,x=i._followSurface,T=i._ellipsoid,A=d.chordLength(i._granularity,T.maximumRadius),P=o(E)&&!S,D=b.length,M=0;if(x){var I=p.extractHeights(b,T),O=y;if(O.minDistance=A,O.ellipsoid=T,P){var R=0;for(a=0;a<D-1;a++)R+=p.numberOfPoints(b[a],b[a+1],A)+1;s=new Float64Array(3*R),C=new Uint8Array(4*R),O.positions=g,O.height=v;var N=0;for(a=0;a<D-1;++a){g[0]=b[a],g[1]=b[a+1],v[0]=I[a],v[1]=I[a+1];var L=p.generateArc(O);if(o(E)){var F=L.length/3;w=E[a];for(var B=0;B<F;++B)C[N++]=n.floatToByte(w.red),C[N++]=n.floatToByte(w.green),C[N++]=n.floatToByte(w.blue),C[N++]=n.floatToByte(w.alpha)}s.set(L,M),M+=L.length}}else if(O.positions=b,O.height=I,s=new Float64Array(p.generateArc(O)),o(E)){for(C=new Uint8Array(s.length/3*4),a=0;a<D-1;++a)M=m(b[a],b[a+1],E[a],E[a+1],A,C,M);var k=E[D-1];C[M++]=n.floatToByte(k.red),C[M++]=n.floatToByte(k.green),C[M++]=n.floatToByte(k.blue),C[M++]=n.floatToByte(k.alpha)}}else{_=P?2*D-2:D,s=new Float64Array(3*_),C=o(E)?new Uint8Array(4*_):void 0;var V=0,z=0;for(a=0;a<D;++a){var U=b[a];if(P&&a>0&&(t.pack(U,s,V),V+=3,C[z++]=n.floatToByte((w=E[a-1]).red),C[z++]=n.floatToByte(w.green),C[z++]=n.floatToByte(w.blue),C[z++]=n.floatToByte(w.alpha)),P&&a===D-1)break;t.pack(U,s,V),V+=3,o(E)&&(C[z++]=n.floatToByte((w=E[a]).red),C[z++]=n.floatToByte(w.green),C[z++]=n.floatToByte(w.blue),C[z++]=n.floatToByte(w.alpha))}}var G=new c;G.position=new u({componentDatatype:r.DOUBLE,componentsPerAttribute:3,values:s}),o(E)&&(G.color=new u({componentDatatype:r.UNSIGNED_BYTE,componentsPerAttribute:4,values:C,normalize:!0}));var W=h.createTypedArray(_=s.length/3,2*(_-1)),H=0;for(a=0;a<_-1;++a)W[H++]=a,W[H++]=a+1;return new l({attributes:G,indices:W,primitiveType:f.LINES,boundingSphere:e.fromPoints(b)})},_}),o("Core/SphereGeometry",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./EllipsoidGeometry","./VertexFormat"],function(e,t,n,r,i,o){"use strict";function a(n){var r=t(n.radius,1),o=new e(r,r,r);this._ellipsoidGeometry=new i({radii:o,stackPartitions:n.stackPartitions,slicePartitions:n.slicePartitions,vertexFormat:n.vertexFormat}),this._workerName="createSphereGeometry"}a.packedLength=i.packedLength,a.pack=function(e,t,n){return i.pack(e._ellipsoidGeometry,t,n)};var s=new i,l={radius:void 0,radii:new e,vertexFormat:new o,stackPartitions:void 0,slicePartitions:void 0};return a.unpack=function(t,r,u){var c=i.unpack(t,r,s);return l.vertexFormat=o.clone(c._vertexFormat,l.vertexFormat),l.stackPartitions=c._stackPartitions,l.slicePartitions=c._slicePartitions,n(u)?(e.clone(c._radii,l.radii),u._ellipsoidGeometry=new i(l),u):(l.radius=c._radii.x,new a(l))},a.createGeometry=function(e){return i.createGeometry(e._ellipsoidGeometry)},a}),o("Core/SphereOutlineGeometry",["./Cartesian3","./defaultValue","./defined","./DeveloperError","./EllipsoidOutlineGeometry"],function(e,t,n,r,i){"use strict";function o(n){var r=t(n.radius,1),o=new e(r,r,r);this._ellipsoidGeometry=new i({radii:o,stackPartitions:n.stackPartitions,slicePartitions:n.slicePartitions,subdivisions:n.subdivisions}),this._workerName="createSphereOutlineGeometry"}o.packedLength=i.packedLength,o.pack=function(e,t,n){return i.pack(e._ellipsoidGeometry,t,n)};var a=new i,s={radius:void 0,radii:new e,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};return o.unpack=function(t,r,l){var u=i.unpack(t,r,a);return s.stackPartitions=u._stackPartitions,s.slicePartitions=u._slicePartitions,s.subdivisions=u._subdivisions,n(l)?(e.clone(u._radii,s.radii),l._ellipsoidGeometry=new i(s),l):(s.radius=u._radii.x,new o(s))},o.createGeometry=function(e){return i.createGeometry(e._ellipsoidGeometry)},o}),o("Core/Spherical",["./defaultValue","./defined","./DeveloperError"],function(e,t,n){"use strict";function r(t,n,r){this.clock=e(t,0),this.cone=e(n,0),this.magnitude=e(r,1)}return r.fromCartesian3=function(e,n){var i=e.x,o=e.y,a=e.z,s=i*i+o*o;return t(n)||(n=new r),n.clock=Math.atan2(o,i),n.cone=Math.atan2(Math.sqrt(s),a),n.magnitude=Math.sqrt(s+a*a),n},r.clone=function(e,n){if(t(e))return t(n)?(n.clock=e.clock,n.cone=e.cone,n.magnitude=e.magnitude,n):new r(e.clock,e.cone,e.magnitude)},r.normalize=function(e,n){return t(n)?(n.clock=e.clock,n.cone=e.cone,n.magnitude=1,n):new r(e.clock,e.cone,1)},r.equals=function(e,n){return e===n||t(e)&&t(n)&&e.clock===n.clock&&e.cone===n.cone&&e.magnitude===n.magnitude},r.equalsEpsilon=function(n,r,i){return i=e(i,0),n===r||t(n)&&t(r)&&Math.abs(n.clock-r.clock)<=i&&Math.abs(n.cone-r.cone)<=i&&Math.abs(n.magnitude-r.magnitude)<=i},r.prototype.equals=function(e){return r.equals(this,e)},r.prototype.clone=function(e){return r.clone(this,e)},r.prototype.equalsEpsilon=function(e,t){return r.equalsEpsilon(this,e,t)},r.prototype.toString=function(){return"("+this.clock+", "+this.cone+", "+this.magnitude+")"},r}),o("Core/subdivideArray",["./defined","./DeveloperError"],function(e,t){"use strict";return function(e,t){for(var n=[],r=e.length,i=0;i<r;){var o=Math.ceil((r-i)/t--);n.push(e.slice(i,i+o)),i+=o}return n}}),o("Core/TerrainData",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function n(){t.throwInstantiationError()}return e(n.prototype,{waterMask:{get:t.throwInstantiationError}}),n.prototype.interpolateHeight=t.throwInstantiationError,n.prototype.isChildAvailable=t.throwInstantiationError,n.prototype.createMesh=t.throwInstantiationError,n.prototype.upsample=t.throwInstantiationError,n.prototype.wasCreatedByUpsampling=t.throwInstantiationError,n}),o("Core/TilingScheme",["./defineProperties","./DeveloperError"],function(e,t){"use strict";function n(e){}return e(n.prototype,{ellipsoid:{get:t.throwInstantiationError},rectangle:{get:t.throwInstantiationError},projection:{get:t.throwInstantiationError}}),n.prototype.getNumberOfXTilesAtLevel=t.throwInstantiationError,n.prototype.getNumberOfYTilesAtLevel=t.throwInstantiationError,n.prototype.rectangleToNativeRectangle=t.throwInstantiationError,n.prototype.tileXYToNativeRectangle=t.throwInstantiationError,n.prototype.tileXYToRectangle=t.throwInstantiationError,n.prototype.positionToTileXY=t.throwInstantiationError,n}),o("Core/TimeIntervalCollection",["./binarySearch","./defaultValue","./defined","./defineProperties","./DeveloperError","./Event","./JulianDate","./TimeInterval"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t){return a.compare(e.start,t.start)}function u(e){if(this._intervals=[],this._changedEvent=new o,n(e))for(var t=e.length,r=0;r<t;r++)this.addInterval(e[r])}r(u.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){var e=this._intervals;return 0===e.length?void 0:e[0].start}},isStartIncluded:{get:function(){var e=this._intervals;return 0!==e.length&&e[0].isStartIncluded}},stop:{get:function(){var e=this._intervals,t=e.length;return 0===t?void 0:e[t-1].stop}},isStopIncluded:{get:function(){var e=this._intervals,t=e.length;return 0!==t&&e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return 0===this._intervals.length}}}),u.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof u))return!1;var n=this._intervals,r=e._intervals,i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;o++)if(!s.equals(n[o],r[o],t))return!1;return!0},u.prototype.get=function(e){return this._intervals[e]},u.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))},u.prototype.findIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t]:void 0},u.prototype.findDataForIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0},u.prototype.contains=function(e){return this.indexOf(e)>=0};var c=new s;return u.prototype.indexOf=function(t){var n=this._intervals;c.start=t,c.stop=t;var r=e(n,c,l);return r>=0?n[r].isStartIncluded?r:r>0&&n[r-1].stop.equals(t)&&n[r-1].isStopIncluded?r-1:~r:(r=~r)>0&&r-1<n.length&&s.contains(n[r-1],t)?r-1:~r},u.prototype.findInterval=function(e){for(var r=(e=t(e,t.EMPTY_OBJECT)).start,i=e.stop,o=e.isStartIncluded,a=e.isStopIncluded,s=this._intervals,l=0,u=s.length;l<u;l++){var c=s[l];if((!n(r)||c.start.equals(r))&&(!n(i)||c.stop.equals(i))&&(!n(o)||c.isStartIncluded===o)&&(!n(a)||c.isStopIncluded===a))return s[l]}},u.prototype.addInterval=function(t,r){if(!t.isEmpty){var i,o,u=this._intervals;if(0===u.length||a.greaterThan(t.start,u[u.length-1].stop))return u.push(t),void this._changedEvent.raiseEvent(this);for((o=e(u,t,l))<0?o=~o:o>0&&t.isStartIncluded&&u[o-1].isStartIncluded&&u[o-1].start.equals(t.start)?--o:o<u.length&&!t.isStartIncluded&&u[o].isStartIncluded&&u[o].start.equals(t.start)&&++o,o>0&&((i=a.compare(u[o-1].stop,t.start))>0||0===i&&(u[o-1].isStopIncluded||t.isStartIncluded))&&((n(r)?r(u[o-1].data,t.data):u[o-1].data===t.data)?(t=new s(a.greaterThan(t.stop,u[o-1].stop)?{start:u[o-1].start,stop:t.stop,isStartIncluded:u[o-1].isStartIncluded,isStopIncluded:t.isStopIncluded,data:t.data}:{start:u[o-1].start,stop:u[o-1].stop,isStartIncluded:u[o-1].isStartIncluded,isStopIncluded:u[o-1].isStopIncluded||t.stop.equals(u[o-1].stop)&&t.isStopIncluded,data:t.data}),u.splice(o-1,1),--o):(i=a.compare(u[o-1].stop,t.stop))>0||0===i&&u[o-1].isStopIncluded&&!t.isStopIncluded?u.splice(o-1,1,new s({start:u[o-1].start,stop:t.start,isStartIncluded:u[o-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:u[o-1].data}),new s({start:t.stop,stop:u[o-1].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:u[o-1].isStopIncluded,data:u[o-1].data})):u[o-1]=new s({start:u[o-1].start,stop:t.start,isStartIncluded:u[o-1].isStartIncluded,isStopIncluded:!t.isStartIncluded,data:u[o-1].data}));o<u.length&&((i=a.compare(t.stop,u[o].start))>0||0===i&&(t.isStopIncluded||u[o].isStartIncluded));)if(n(r)?r(u[o].data,t.data):u[o].data===t.data)t=new s({start:t.start,stop:a.greaterThan(u[o].stop,t.stop)?u[o].stop:t.stop,isStartIncluded:t.isStartIncluded,isStopIncluded:a.greaterThan(u[o].stop,t.stop)?u[o].isStopIncluded:t.isStopIncluded,data:t.data}),u.splice(o,1);else{if(u[o]=new s({start:t.stop,stop:u[o].stop,isStartIncluded:!t.isStopIncluded,isStopIncluded:u[o].isStopIncluded,data:u[o].data}),!u[o].isEmpty)break;u.splice(o,1)}u.splice(o,0,t),this._changedEvent.raiseEvent(this)}},u.prototype.removeInterval=function(t){if(t.isEmpty)return!1;var n=!1,r=this._intervals,i=e(r,t,l);i<0&&(i=~i);var o=t.start,u=t.stop,c=t.isStartIncluded,h=t.isStopIncluded;if(i>0){var d=r[i-1],p=d.stop;(a.greaterThan(p,o)||s.equals(p,o)&&d.isStopIncluded&&c)&&(n=!0,(a.greaterThan(p,u)||d.isStopIncluded&&!h&&s.equals(p,u))&&r.splice(i,0,new s({start:u,stop:p,isStartIncluded:!h,isStopIncluded:d.isStopIncluded,data:d.data})),r[i-1]=new s({start:d.start,stop:o,isStartIncluded:d.isStartIncluded,isStopIncluded:!c,data:d.data}))}var f=r[i];for(i<r.length&&!c&&f.isStartIncluded&&o.equals(f.start)&&(n=!0,r.splice(i,0,new s({start:f.start,stop:f.start,isStartIncluded:!0,isStopIncluded:!0,data:f.data})),f=r[++i]);i<r.length&&a.greaterThan(u,f.stop);)n=!0,r.splice(i,1),f=r[i];return i<r.length&&u.equals(f.stop)&&(n=!0,!h&&f.isStopIncluded?(i+1<r.length&&r[i+1].start.equals(u)&&f.data===r[i+1].data?(r.splice(i,1),f=new s({start:f.start,stop:f.stop,isStartIncluded:!0,isStopIncluded:f.isStopIncluded,data:f.data})):f=new s({start:u,stop:u,isStartIncluded:!0,isStopIncluded:!0,data:f.data}),r[i]=f):r.splice(i,1)),i<r.length&&(a.greaterThan(u,f.start)||u.equals(f.start)&&h&&f.isStartIncluded)&&(n=!0,r[i]=new s({start:u,stop:f.stop,isStartIncluded:!h,isStopIncluded:f.isStopIncluded,data:f.data})),n&&this._changedEvent.raiseEvent(this),n},u.prototype.intersect=function(e,t,r){for(var i=0,o=0,l=new u,c=this._intervals,h=e._intervals;i<c.length&&o<h.length;){var d=c[i],p=h[o];if(a.lessThan(d.stop,p.start))++i;else if(a.lessThan(p.stop,d.start))++o;else{if(n(r)||n(t)&&t(d.data,p.data)||!n(t)&&p.data===d.data){var f=s.intersect(d,p,new s,r);f.isEmpty||l.addInterval(f,t)}a.lessThan(d.stop,p.stop)||d.stop.equals(p.stop)&&!d.isStopIncluded&&p.isStopIncluded?++i:++o}}return l},u}),o("Core/TranslationRotationScale",["./Cartesian3","./defaultValue","./defined","./Matrix4","./Quaternion"],function(e,t,n,r,i){"use strict";var o=new e(1,1,1),a=e.ZERO,s=i.IDENTITY,l=function(n,r,l){this.translation=e.clone(t(n,a)),this.rotation=i.clone(t(r,s)),this.scale=e.clone(t(l,o))};return l.prototype.equals=function(t){return this===t||n(t)&&e.equals(this.translation,t.translation)&&i.equals(this.rotation,t.rotation)&&e.equals(this.scale,t.scale)},l}),o("Core/VideoSynchronizer",["./defaultValue","./defined","./defineProperties","./destroyObject","./DeveloperError","./Event","./Iso8601","./JulianDate"],function(e,t,n,r,i,o,a,s){"use strict";function l(t){t=e(t,e.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this.clock=t.clock,this.element=t.element,this.epoch=e(t.epoch,a.MINIMUM_VALUE),this.tolerance=e(t.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}return n(l.prototype,{clock:{get:function(){return this._clock},set:function(e){var n=this._clock;n!==e&&(t(n)&&(this._clockSubscription(),this._clockSubscription=void 0),t(e)&&(this._clockSubscription=e.onTick.addEventListener(l.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){var n,r=this._element;r!==e&&(t(r)&&r.removeEventListener("seeked",this._seekFunction,!1),t(e)&&(this._seeking=!1,this._seekFunction=(n=this,function(){n._seeking=!1,n._firstTickAfterSeek=!0}),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}}),l.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,r(this)},l.prototype.isDestroyed=function(){return!1},l.prototype._onTick=function(n){var r=this._element;if(t(r)&&!(r.readyState<2)){var i=n.shouldAnimate;if(i===r.paused&&(i?r.play():r.pause()),this._seeking||this._firstTickAfterSeek)return void(this._firstTickAfterSeek=!1);r.playbackRate=n.multiplier;var o,l=n.currentTime,u=e(this.epoch,a.MINIMUM_VALUE),c=s.secondsDifference(l,u),h=r.duration,d=r.currentTime;r.loop?((c%=h)<0&&(c=h-c),o=c):o=c>h?h:c<0?0:c;var p=i?e(this.tolerance,1):.001;Math.abs(o-d)>p&&(this._seeking=!0,r.currentTime=o)}},l}),o("Core/VRTheWorldTerrainProvider",["../ThirdParty/when","./Credit","./defaultValue","./defined","./defineProperties","./DeveloperError","./Ellipsoid","./Event","./GeographicTilingScheme","./getImagePixels","./HeightmapTerrainData","./loadImage","./loadXML","./Math","./Rectangle","./TerrainProvider","./throttleRequestByServer","./TileProviderError"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e,t){this.rectangle=e,this.maxLevel=t}function y(r){function i(e){var t=e.getElementsByTagName("SRS")[0].textContent;if("EPSG:4326"===t){_._tilingScheme=new l({ellipsoid:y});var n=e.getElementsByTagName("TileFormat")[0];_._heightmapWidth=parseInt(n.getAttribute("width"),10),_._heightmapHeight=parseInt(n.getAttribute("height"),10),_._levelZeroMaximumGeometricError=m.getEstimatedLevelZeroGeometricErrorForAHeightmap(y,Math.min(_._heightmapWidth,_._heightmapHeight),_._tilingScheme.getNumberOfXTilesAtLevel(0));for(var r=e.getElementsByTagName("DataExtent"),i=0;i<r.length;++i){var a=r[i],s=p.toRadians(parseFloat(a.getAttribute("minx"))),u=p.toRadians(parseFloat(a.getAttribute("miny"))),c=p.toRadians(parseFloat(a.getAttribute("maxx"))),h=p.toRadians(parseFloat(a.getAttribute("maxy"))),d=parseInt(a.getAttribute("maxlevel"),10);_._rectangles.push(new v(new f(s,u,c,h),d))}_._ready=!0,_._readyPromise.resolve(!0)}else o("SRS "+t+" is not supported.")}function o(e){var t=n(e,"An error occurred while accessing "+_._url+".");h=g.handleError(h,_,_._errorEvent,t,void 0,void 0,void 0,u)}function u(){e(d(_._url),i,o)}r=n(r,n.EMPTY_OBJECT),this._url=r.url,this._url.length>0&&"/"!==this._url[this._url.length-1]&&(this._url+="/"),this._errorEvent=new s,this._ready=!1,this._readyPromise=e.defer(),this._proxy=r.proxy,this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215};var c=r.credit;"string"==typeof c&&(c=new t(c)),this._credit=c,this._tilingScheme=void 0,this._rectangles=[];var h,_=this,y=n(r.ellipsoid,a.WGS84);u()}function C(e,t,n,i,o){var a=e.tileXYToRectangle(n,i,o);return r(f.intersection(a,t,w))}i(y.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),y.prototype.requestTileGeometry=function(t,i,o,a){var s,l=this._tilingScheme.getNumberOfYTilesAtLevel(o),d=this._url+o+"/"+t+"/"+(l-i-1)+".tif?cesium=true",p=this._proxy;if(r(p)&&(d=p.getURL(d)),a=n(a,!0)){if(s=_(d,h),!r(s))return}else s=h(d);var m=this;return e(s,function(e){return new c({buffer:u(e),width:m._heightmapWidth,height:m._heightmapHeight,childTileMask:function(e,t,n,i){for(var o=m._tilingScheme,a=m._rectangles,s=o.tileXYToRectangle(t,n,i),l=0,u=0;u<a.length&&15!==l;++u){var c=a[u];if(!(c.maxLevel<=i)){var h=c.rectangle,d=f.intersection(h,s,w);r(d)&&(C(o,h,2*t,2*n,i+1)&&(l|=4),C(o,h,2*t+1,2*n,i+1)&&(l|=8),C(o,h,2*t,2*n+1,i+1)&&(l|=1),C(o,h,2*t+1,2*n+1,i+1)&&(l|=2))}}return l}(0,t,i,o),structure:m._terrainDataStructure})})},y.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)};var w=new f;return y.prototype.getTileDataAvailable=function(e,t,n){},y}),o("Core/WallGeometryLibrary",["./Cartographic","./defined","./EllipsoidTangentPlane","./Math","./PolygonPipeline","./PolylinePipeline","./WindingOrder"],function(e,t,n,r,i,o,a){"use strict";var s={},l=new e,u=new e,c=new Array(2),h=new Array(2),d={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};return s.computePositions=function(s,p,f,m,_,g){var v=function(n,i,o,a){var s,c,h=i.length;if(!(h<2)){var d=t(a),p=t(o),f=!0,m=new Array(h),_=new Array(h),g=new Array(h),v=i[0];m[0]=v;var y=n.cartesianToCartographic(v,l);p&&(y.height=o[0]),f=f&&y.height<=0,_[0]=y.height,g[0]=d?a[0]:0;for(var C=1,w=1;w<h;++w){var b=i[w],E=n.cartesianToCartographic(b,u);p&&(E.height=o[w]),f=f&&E.height<=0,r.equalsEpsilon((s=y).latitude,(c=E).latitude,r.EPSILON14)&&r.equalsEpsilon(s.longitude,c.longitude,r.EPSILON14)?y.height<E.height&&(_[C-1]=E.height):(m[C]=b,_[C]=E.height,g[C]=d?a[w]:0,e.clone(E,y),++C)}if(!(f||C<2))return m.length=C,_.length=C,g.length=C,{positions:m,topHeights:_,bottomHeights:g}}}(s,p,f,m);if(t(v)){if(f=v.topHeights,m=v.bottomHeights,(p=v.positions).length>=3){var y=n.fromPoints(p,s).projectPointsOntoPlane(p);i.computeWindingOrder2D(y)===a.CLOCKWISE&&(p.reverse(),f.reverse(),m.reverse())}var C,w,b=p.length,E=b-2,S=r.chordLength(_,s.maximumRadius),x=d;if(x.minDistance=S,x.ellipsoid=s,g){var T,A=0;for(T=0;T<b-1;T++)A+=o.numberOfPoints(p[T],p[T+1],S)+1;C=new Float64Array(3*A),w=new Float64Array(3*A);var P=c,D=h;x.positions=P,x.height=D;var M=0;for(T=0;T<b-1;T++){P[0]=p[T],P[1]=p[T+1],D[0]=f[T],D[1]=f[T+1];var I=o.generateArc(x);C.set(I,M),D[0]=m[T],D[1]=m[T+1],w.set(o.generateArc(x),M),M+=I.length}}else x.positions=p,x.height=f,C=new Float64Array(o.generateArc(x)),x.height=m,w=new Float64Array(o.generateArc(x));return{bottomPositions:w,topPositions:C,numCorners:E}}},s}),o("Core/WallGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./VertexFormat","./WallGeometryLibrary"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e){var n=(e=r(e,r.EMPTY_OBJECT)).positions,o=e.maximumHeights,s=e.minimumHeights,l=r(e.vertexFormat,p.DEFAULT),u=r(e.granularity,h.RADIANS_PER_DEGREE),c=r(e.ellipsoid,a.WGS84);this._positions=n,this._minimumHeights=s,this._maximumHeights=o,this._vertexFormat=p.clone(l),this._granularity=u,this._ellipsoid=a.clone(c),this._workerName="createWallGeometry";var d=1+n.length*t.packedLength+2;i(s)&&(d+=s.length),i(o)&&(d+=o.length),this.packedLength=d+a.packedLength+p.packedLength+1}var _=new t,g=new t,v=new t,y=new t,C=new t,w=new t,b=new t,E=new t;m.pack=function(e,n,o){o=r(o,0);var s,l=e._positions,u=l.length;for(n[o++]=u,s=0;s<u;++s,o+=t.packedLength)t.pack(l[s],n,o);var c=e._minimumHeights;if(u=i(c)?c.length:0,n[o++]=u,i(c))for(s=0;s<u;++s)n[o++]=c[s];var h=e._maximumHeights;if(u=i(h)?h.length:0,n[o++]=u,i(h))for(s=0;s<u;++s)n[o++]=h[s];return a.pack(e._ellipsoid,n,o),p.pack(e._vertexFormat,n,o+=a.packedLength),n[o+=p.packedLength]=e._granularity,n};var S=a.clone(a.UNIT_SPHERE),x=new p,T={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:S,vertexFormat:x,granularity:void 0};return m.unpack=function(e,n,o){n=r(n,0);var s,l,u,c=e[n++],h=new Array(c);for(s=0;s<c;++s,n+=t.packedLength)h[s]=t.unpack(e,n);if((c=e[n++])>0)for(l=new Array(c),s=0;s<c;++s)l[s]=e[n++];if((c=e[n++])>0)for(u=new Array(c),s=0;s<c;++s)u[s]=e[n++];var d=a.unpack(e,n,S),f=p.unpack(e,n+=a.packedLength,x),_=e[n+=p.packedLength];return i(o)?(o._positions=h,o._minimumHeights=l,o._maximumHeights=u,o._ellipsoid=a.clone(d,o._ellipsoid),o._vertexFormat=p.clone(f,o._vertexFormat),o._granularity=_,o):(T.positions=h,T.minimumHeights=l,T.maximumHeights=u,T.granularity=_,new m(T))},m.fromConstantHeights=function(e){var t,n,o=(e=r(e,r.EMPTY_OBJECT)).positions,a=e.minimumHeight,s=e.maximumHeight,l=i(a),u=i(s);if(l||u){var c=o.length;t=l?new Array(c):void 0,n=u?new Array(c):void 0;for(var h=0;h<c;++h)l&&(t[h]=a),u&&(n[h]=s)}return new m({positions:o,maximumHeights:n,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},m.createGeometry=function(r){var o=r._positions,a=r._vertexFormat,p=r._ellipsoid,m=f.computePositions(p,o,r._maximumHeights,r._minimumHeights,r._granularity,!0);if(i(m)){var S,x=m.bottomPositions,T=m.topPositions,A=m.numCorners,P=T.length,D=2*P,M=a.position?new Float64Array(D):void 0,I=a.normal?new Float32Array(D):void 0,O=a.tangent?new Float32Array(D):void 0,R=a.binormal?new Float32Array(D):void 0,N=a.st?new Float32Array(D/3*2):void 0,L=0,F=0,B=0,k=0,V=0,z=E,U=b,G=w,W=!0,H=0,j=1/((P/=3)-o.length+1);for(S=0;S<P;++S){var q=3*S,Y=t.fromArray(T,q,_),X=t.fromArray(x,q,g);if(a.position&&(M[L++]=X.x,M[L++]=X.y,M[L++]=X.z,M[L++]=Y.x,M[L++]=Y.y,M[L++]=Y.z),a.st&&(N[V++]=H,N[V++]=0,N[V++]=H,N[V++]=1),a.normal||a.tangent||a.binormal){var Z,K=t.clone(t.ZERO,C),Q=p.scaleToGeodeticSurface(t.fromArray(T,q,g),g);if(S+1<P&&(Z=p.scaleToGeodeticSurface(t.fromArray(T,q+3,v),v),K=t.fromArray(T,q+3,C)),W){var J=t.subtract(K,Y,y),$=t.subtract(Q,Y,_);z=t.normalize(t.cross($,J,z),z),W=!1}t.equalsEpsilon(Z,Q,h.EPSILON10)?W=!0:(H+=j,a.tangent&&(U=t.normalize(t.subtract(Z,Q,U),U)),a.binormal&&(G=t.normalize(t.cross(z,U,G),G))),a.normal&&(I[F++]=z.x,I[F++]=z.y,I[F++]=z.z,I[F++]=z.x,I[F++]=z.y,I[F++]=z.z),a.tangent&&(O[k++]=U.x,O[k++]=U.y,O[k++]=U.z,O[k++]=U.x,O[k++]=U.y,O[k++]=U.z),a.binormal&&(R[B++]=G.x,R[B++]=G.y,R[B++]=G.z,R[B++]=G.x,R[B++]=G.y,R[B++]=G.z)}}var ee=new u;a.position&&(ee.position=new l({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:M})),a.normal&&(ee.normal=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:I})),a.tangent&&(ee.tangent=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:O})),a.binormal&&(ee.binormal=new l({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:R})),a.st&&(ee.st=new l({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:N}));var te=D/3,ne=c.createTypedArray(te,D-=6*(A+1)),re=0;for(S=0;S<te-2;S+=2){var ie=S,oe=S+2,ae=t.fromArray(M,3*ie,_),se=t.fromArray(M,3*oe,g);if(!t.equalsEpsilon(ae,se,h.EPSILON10)){var le=S+3;ne[re++]=S+1,ne[re++]=ie,ne[re++]=le,ne[re++]=le,ne[re++]=ie,ne[re++]=oe}}return new s({attributes:ee,indices:ne,primitiveType:d.TRIANGLES,boundingSphere:new e.fromVertices(M)})}},m}),o("Core/WallOutlineGeometry",["./BoundingSphere","./Cartesian3","./ComponentDatatype","./defaultValue","./defined","./DeveloperError","./Ellipsoid","./Geometry","./GeometryAttribute","./GeometryAttributes","./IndexDatatype","./Math","./PrimitiveType","./WallGeometryLibrary"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(e){var n=(e=r(e,r.EMPTY_OBJECT)).positions,o=e.maximumHeights,s=e.minimumHeights,l=r(e.granularity,h.RADIANS_PER_DEGREE),u=r(e.ellipsoid,a.WGS84);this._positions=n,this._minimumHeights=s,this._maximumHeights=o,this._granularity=l,this._ellipsoid=a.clone(u),this._workerName="createWallOutlineGeometry";var c=1+n.length*t.packedLength+2;i(s)&&(c+=s.length),i(o)&&(c+=o.length),this.packedLength=c+a.packedLength+1}var m=new t,_=new t;f.pack=function(e,n,o){o=r(o,0);var s,l=e._positions,u=l.length;for(n[o++]=u,s=0;s<u;++s,o+=t.packedLength)t.pack(l[s],n,o);var c=e._minimumHeights;if(u=i(c)?c.length:0,n[o++]=u,i(c))for(s=0;s<u;++s)n[o++]=c[s];var h=e._maximumHeights;if(u=i(h)?h.length:0,n[o++]=u,i(h))for(s=0;s<u;++s)n[o++]=h[s];return a.pack(e._ellipsoid,n,o),n[o+=a.packedLength]=e._granularity,n};var g=a.clone(a.UNIT_SPHERE),v={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:g,granularity:void 0};return f.unpack=function(e,n,o){n=r(n,0);var s,l,u,c=e[n++],h=new Array(c);for(s=0;s<c;++s,n+=t.packedLength)h[s]=t.unpack(e,n);if((c=e[n++])>0)for(l=new Array(c),s=0;s<c;++s)l[s]=e[n++];if((c=e[n++])>0)for(u=new Array(c),s=0;s<c;++s)u[s]=e[n++];var d=a.unpack(e,n,g),p=e[n+=a.packedLength];return i(o)?(o._positions=h,o._minimumHeights=l,o._maximumHeights=u,o._ellipsoid=a.clone(d,o._ellipsoid),o._granularity=p,o):(v.positions=h,v.minimumHeights=l,v.maximumHeights=u,v.granularity=p,new f(v))},f.fromConstantHeights=function(e){var t,n,o=(e=r(e,r.EMPTY_OBJECT)).positions,a=e.minimumHeight,s=e.maximumHeight,l=i(a),u=i(s);if(l||u){var c=o.length;t=l?new Array(c):void 0,n=u?new Array(c):void 0;for(var h=0;h<c;++h)l&&(t[h]=a),u&&(n[h]=s)}return new f({positions:o,maximumHeights:n,minimumHeights:t,ellipsoid:e.ellipsoid})},f.createGeometry=function(r){var o=p.computePositions(r._ellipsoid,r._positions,r._maximumHeights,r._minimumHeights,r._granularity,!1);if(i(o)){var a,f=o.bottomPositions,g=o.topPositions,v=g.length,y=2*v,C=new Float64Array(y),w=0;for(v/=3,a=0;a<v;++a){var b=3*a,E=t.fromArray(g,b,m),S=t.fromArray(f,b,_);C[w++]=S.x,C[w++]=S.y,C[w++]=S.z,C[w++]=E.x,C[w++]=E.y,C[w++]=E.z}var x=new u({position:new l({componentDatatype:n.DOUBLE,componentsPerAttribute:3,values:C})}),T=y/3,A=c.createTypedArray(T,y=2*T-4+T),P=0;for(a=0;a<T-2;a+=2){var D=a,M=a+2,I=t.fromArray(C,3*D,m),O=t.fromArray(C,3*M,_);if(!t.equalsEpsilon(I,O,h.EPSILON10)){var R=a+1,N=a+3;A[P++]=R,A[P++]=D,A[P++]=R,A[P++]=N,A[P++]=D,A[P++]=M}}return A[P++]=T-2,A[P++]=T-1,new s({attributes:x,indices:A,primitiveType:d.LINES,boundingSphere:new e.fromVertices(C)})}},f}),o("Core/WebMercatorTilingScheme",["./Cartesian2","./defaultValue","./defined","./defineProperties","./Ellipsoid","./Rectangle","./WebMercatorProjection"],function(e,t,n,r,i,o,a){"use strict";function s(r){if(r=t(r,{}),this._ellipsoid=t(r.ellipsoid,i.WGS84),this._numberOfLevelZeroTilesX=t(r.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=t(r.numberOfLevelZeroTilesY,1),this._projection=new a(this._ellipsoid),n(r.rectangleSouthwestInMeters)&&n(r.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=r.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=r.rectangleNortheastInMeters;else{var s=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new e(-s,-s),this._rectangleNortheastInMeters=new e(s,s)}var l=this._projection.unproject(this._rectangleSouthwestInMeters),u=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new o(l.longitude,l.latitude,u.longitude,u.latitude)}return r(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),s.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},s.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},s.prototype.rectangleToNativeRectangle=function(e,t){var r=this._projection,i=r.project(o.southwest(e)),a=r.project(o.northeast(e));return n(t)?(t.west=i.x,t.south=i.y,t.east=a.x,t.north=a.y,t):new o(i.x,i.y,a.x,a.y)},s.prototype.tileXYToNativeRectangle=function(e,t,r,i){var a=this.getNumberOfXTilesAtLevel(r),s=this.getNumberOfYTilesAtLevel(r),l=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/a,u=this._rectangleSouthwestInMeters.x+e*l,c=this._rectangleSouthwestInMeters.x+(e+1)*l,h=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s,d=this._rectangleNortheastInMeters.y-t*h,p=this._rectangleNortheastInMeters.y-(t+1)*h;return n(i)?(i.west=u,i.south=p,i.east=c,i.north=d,i):new o(u,p,c,d)},s.prototype.tileXYToRectangle=function(t,n,r,i){var o=this.tileXYToNativeRectangle(t,n,r,i),a=this._projection,s=a.unproject(new e(o.west,o.south)),l=a.unproject(new e(o.east,o.north));return o.west=s.longitude,o.south=s.latitude,o.east=l.longitude,o.north=l.latitude,o},s.prototype.positionToTileXY=function(t,r,i){if(o.contains(this._rectangle,t)){var a=this.getNumberOfXTilesAtLevel(r),s=this.getNumberOfYTilesAtLevel(r),l=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/a,u=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/s,c=this._projection.project(t),h=(c.x-this._rectangleSouthwestInMeters.x)/l|0;h>=a&&(h=a-1);var d=(this._rectangleNortheastInMeters.y-c.y)/u|0;return d>=s&&(d=s-1),n(i)?(i.x=h,i.y=d,i):new e(h,d)}},s}),o("Core/wrapFunction",["./DeveloperError"],function(e){"use strict";return function(e,t,n){return function(){n.apply(e,arguments),t.apply(e,arguments)}}}),o("DataSources/ConstantProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event"],function(e,t,n,r,i){"use strict";function o(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new i,this.setValue(e)}return n(o.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}}),o.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value},o.prototype.setValue=function(e){var n=this._value;if(n!==e){var r=t(e),i=r&&"function"==typeof e.clone,o=r&&"function"==typeof e.equals;this._hasClone=i,this._hasEquals=o,(!o||!e.equals(n))&&(this._value=i?e.clone():e,this._definitionChanged.raiseEvent(this))}},o.prototype.equals=function(e){return this===e||e instanceof o&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))},o}),o("DataSources/createPropertyDescriptor",["../Core/defaultValue","../Core/defined","./ConstantProperty"],function(e,t,n){"use strict";function r(e){return new n(e)}return function(n,i,o){return a=n,s="_"+n.toString(),l="_"+n.toString()+"Subscription",u=e(i,!1),c=e(o,r),{configurable:u,get:function(){return this[s]},set:function(e){var n=this[s],r=this[l];t(r)&&(r(),this[l]=void 0),t(e)&&!t(e.getValue)&&t(c)&&(e=c(e)),n!==e&&(this[s]=e,this._definitionChanged.raiseEvent(this,a,e,n)),t(e)&&t(e.definitionChanged)&&(this[l]=e.definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this,a,e,e)},this))}};var a,s,l,u,c}}),o("DataSources/BillboardGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,n,r,i,o){"use strict";function a(t){this._image=void 0,this._imageSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},image:o("image"),imageSubRegion:o("imageSubRegion"),scale:o("scale"),rotation:o("rotation"),alignedAxis:o("alignedAxis"),horizontalOrigin:o("horizontalOrigin"),verticalOrigin:o("verticalOrigin"),color:o("color"),eyeOffset:o("eyeOffset"),heightReference:o("heightReference"),pixelOffset:o("pixelOffset"),show:o("show"),width:o("width"),height:o("height"),scaleByDistance:o("scaleByDistance"),translucencyByDistance:o("translucencyByDistance"),pixelOffsetScaleByDistance:o("pixelOffsetScaleByDistance"),sizeInMeters:o("sizeInMeters"),distanceDisplayCondition:o("distanceDisplayCondition")}),a.prototype.clone=function(e){return t(e)?(e.color=this._color,e.eyeOffset=this._eyeOffset,e.heightReference=this._heightReference,e.horizontalOrigin=this._horizontalOrigin,e.image=this._image,e.imageSubRegion=this._imageSubRegion,e.pixelOffset=this._pixelOffset,e.scale=this._scale,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.show=this._show,e.verticalOrigin=this._verticalOrigin,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.sizeInMeters=this._sizeInMeters,e.distanceDisplayCondition=this._distanceDisplayCondition,e):new a(this)},a.prototype.merge=function(t){this.color=e(this._color,t.color),this.eyeOffset=e(this._eyeOffset,t.eyeOffset),this.heightReference=e(this._heightReference,t.heightReference),this.horizontalOrigin=e(this._horizontalOrigin,t.horizontalOrigin),this.image=e(this._image,t.image),this.imageSubRegion=e(this._imageSubRegion,t.imageSubRegion),this.pixelOffset=e(this._pixelOffset,t.pixelOffset),this.scale=e(this._scale,t.scale),this.rotation=e(this._rotation,t.rotation),this.alignedAxis=e(this._alignedAxis,t.alignedAxis),this.show=e(this._show,t.show),this.verticalOrigin=e(this._verticalOrigin,t.verticalOrigin),this.width=e(this._width,t.width),this.height=e(this._height,t.height),this.scaleByDistance=e(this._scaleByDistance,t.scaleByDistance),this.translucencyByDistance=e(this._translucencyByDistance,t.translucencyByDistance),this.pixelOffsetScaleByDistance=e(this._pixelOffsetScaleByDistance,t.pixelOffsetScaleByDistance),this.sizeInMeters=e(this._sizeInMeters,t.sizeInMeters),this.distanceDisplayCondition=e(this._distanceDisplayCondition,t.distanceDisplayCondition)},a}),o("Scene/HeightReference",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2})}),o("Scene/HorizontalOrigin",["../Core/freezeObject"],function(e){"use strict";return e({CENTER:0,LEFT:1,RIGHT:-1})}),o("Scene/VerticalOrigin",["../Core/freezeObject"],function(e){"use strict";return e({CENTER:0,BOTTOM:1,TOP:-1})}),o("DataSources/BoundingSphereState",["../Core/freezeObject"],function(e){"use strict";return e({DONE:0,PENDING:1,FAILED:2})}),o("Scene/SceneMode",["../Core/freezeObject"],function(e){"use strict";var t={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3};return t.getMorphTime=function(e){return e===t.SCENE3D?1:e!==t.MORPHING?0:void 0},e(t)}),o("Scene/SceneTransforms",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/DeveloperError","../Core/Math","../Core/Matrix4","../Core/Transforms","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e,t,i,o){var a=l.multiplyByVector(i.viewMatrix,r.fromElements(e.x,e.y,e.z,1,v),v),s=n.multiplyComponents(t,n.normalize(a,y),y);return a.x+=t.x+s.x,a.y+=t.y+s.y,a.z+=s.z,l.multiplyByVector(i.frustum.projectionMatrix,a,o)}var d={},p=new r(0,0,0,1),f=new r,m=new e,_=new t,g=new t;d.wgs84ToWindowCoordinates=function(e,t,r){return d.wgs84WithEyeOffsetToWindowCoordinates(e,t,n.ZERO,r)};var v=new r,y=new n,C=new i(Math.PI,s.PI_OVER_TWO),w=new n,b=new n;d.wgs84WithEyeOffsetToWindowCoordinates=function(e,r,i,a){var v=e.frameState,y=d.computeActualWgs84Position(v,r,p);if(o(y)){var E=e.canvas,S=m;S.x=0,S.y=0,S.width=E.clientWidth,S.height=E.clientHeight;var x=e.camera,T=!1;if(v.mode===c.SCENE2D){var A=e.mapProjection.project(C,w),P=n.clone(x.position,b),D=x.frustum.clone(),M=l.computeViewportTransformation(S,0,1,new l),I=x.frustum.projectionMatrix,O=x.positionWC.y,R=n.fromElements(s.sign(O)*A.x-O,0,-x.positionWC.x),N=u.pointToGLWindowCoordinates(I,M,R);if(0===O||N.x<=0||N.x>=E.clientWidth)T=!0;else{if(N.x>.5*E.clientWidth){S.width=N.x,x.frustum.right=A.x-O,f=h(y,i,x,f),d.clipToGLWindowCoordinates(S,f,_),S.x+=N.x,x.position.x=-x.position.x;var L=x.frustum.right;x.frustum.right=-x.frustum.left,x.frustum.left=-L,f=h(y,i,x,f),d.clipToGLWindowCoordinates(S,f,g)}else{S.x+=N.x,S.width-=N.x,x.frustum.left=-A.x-O,f=h(y,i,x,f),d.clipToGLWindowCoordinates(S,f,_),S.x=S.x-S.width,x.position.x=-x.position.x;var F=x.frustum.left;x.frustum.left=-x.frustum.right,x.frustum.right=-F,f=h(y,i,x,f),d.clipToGLWindowCoordinates(S,f,g)}n.clone(P,x.position),x.frustum=D.clone(),((a=t.clone(_,a)).x<0||a.x>E.clientWidth)&&(a.x=g.x)}}if(v.mode!==c.SCENE2D||T){if((f=h(y,i,x,f)).z<0&&v.mode!==c.SCENE2D)return;a=d.clipToGLWindowCoordinates(S,f,a)}return a.y=E.clientHeight-a.y,a}},d.wgs84ToDrawingBufferCoordinates=function(e,t,n){if(n=d.wgs84ToWindowCoordinates(e,t,n),o(n))return d.transformWindowToDrawingBuffer(e,n,n)};var E=new n,S=new i;d.computeActualWgs84Position=function(e,t,r){var i=e.mode;if(i===c.SCENE3D)return n.clone(t,r);var a=e.mapProjection,l=a.ellipsoid.cartesianToCartographic(t,S);if(o(l)){if(a.project(l,E),i===c.COLUMBUS_VIEW)return n.fromElements(E.z,E.x,E.y,r);if(i===c.SCENE2D)return n.fromElements(0,E.x,E.y,r);var u=e.morphTime;return n.fromElements(s.lerp(E.z,t.x,u),s.lerp(E.x,t.y,u),s.lerp(E.y,t.z,u),r)}};var x=new n,T=new n,A=new l;d.clipToGLWindowCoordinates=function(e,r,i){return n.divideByScalar(r,r.w,x),l.computeViewportTransformation(e,0,1,A),l.multiplyByPoint(A,x,T),t.fromCartesian3(T,i)},d.clipToDrawingBufferCoordinates=function(e,r,i){return n.divideByScalar(r,r.w,x),l.computeViewportTransformation(e,0,1,A),l.multiplyByPoint(A,x,T),t.fromCartesian3(T,i)},d.transformWindowToDrawingBuffer=function(e,n,r){var i=e.canvas;return t.fromElements(n.x*(e.drawingBufferWidth/i.clientWidth),n.y*(e.drawingBufferHeight/i.clientHeight),r)};var P=new r,D=new r;return d.drawingBufferToWgs84Coordinates=function(e,t,i,o){var a=e.context.uniformState,s=e._passState.viewport,u=r.clone(r.UNIT_W,P);u.x=(t.x-s.x)/s.width*2-1,u.y=(t.y-s.y)/s.height*2-1,u.z=2*i-1,u.w=1;var c=l.multiplyByVector(a.inverseViewProjection,u,D);return n.multiplyByScalar(c,1/c.w,c),n.fromCartesian4(c,o)},d}),o("Scene/Billboard",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./HeightReference","./HorizontalOrigin","./SceneMode","./SceneTransforms","./VerticalOrigin"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v){"use strict";function y(e,r){e=s(e,s.EMPTY_OBJECT),this._show=s(e.show,!0),this._position=n.clone(s(e.position,n.ZERO)),this._actualPosition=n.clone(this._position),this._pixelOffset=t.clone(s(e.pixelOffset,t.ZERO)),this._translate=new t(0,0),this._eyeOffset=n.clone(s(e.eyeOffset,n.ZERO)),this._heightReference=s(e.heightReference,f.NONE),this._verticalOrigin=s(e.verticalOrigin,v.CENTER),this._horizontalOrigin=s(e.horizontalOrigin,m.CENTER),this._scale=s(e.scale,1),this._color=o.clone(s(e.color,o.WHITE)),this._rotation=s(e.rotation,0),this._alignedAxis=n.clone(s(e.alignedAxis,n.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=e.scaleByDistance,this._translucencyByDistance=e.translucencyByDistance,this._pixelOffsetScaleByDistance=e.pixelOffsetScaleByDistance,this._sizeInMeters=s(e.sizeInMeters,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._id=e.id,this._collection=s(e.collection,r),this._pickId=void 0,this._pickPrimitive=s(e._pickPrimitive,this),this._billboardCollection=r,this._dirty=!1,this._index=-1,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0;var i=e.image,u=e.imageId;l(i)&&(l(u)||(u="string"==typeof i?i:l(i.src)?i.src:a()),this._imageId=u,this._image=i),l(e.imageSubRegion)&&(this._imageId=u,this._imageSubRegion=e.imageSubRegion),l(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=_.SCENE3D,this._clusterShow=!0,this._updateClamping()}function C(e,t){var n=e._billboardCollection;l(n)&&(n._updateBillboard(e,t),e._dirty=!0)}var w=y.SHOW_INDEX=0,b=y.POSITION_INDEX=1,E=y.PIXEL_OFFSET_INDEX=2,S=y.EYE_OFFSET_INDEX=3,x=y.HORIZONTAL_ORIGIN_INDEX=4,T=y.VERTICAL_ORIGIN_INDEX=5,A=y.SCALE_INDEX=6,P=y.IMAGE_INDEX_INDEX=7,D=y.COLOR_INDEX=8,M=y.ROTATION_INDEX=9,I=y.ALIGNED_AXIS_INDEX=10,O=y.SCALE_BY_DISTANCE_INDEX=11,R=y.TRANSLUCENCY_BY_DISTANCE_INDEX=12,N=y.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,L=y.DISTANCE_DISPLAY_CONDITION=14;y.NUMBER_OF_PROPERTIES=15,u(y.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,C(this,w))}},position:{get:function(){return this._position},set:function(e){var t=this._position;n.equals(t,e)||(n.clone(e,t),n.clone(e,this._actualPosition),this._updateClamping(),C(this,b))}},heightReference:{get:function(){return this._heightReference},set:function(e){e!==this._heightReference&&(this._heightReference=e,this._updateClamping(),C(this,b))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){var n=this._pixelOffset;t.equals(n,e)||(t.clone(e,n),C(this,E))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){var t=this._scaleByDistance;p.equals(t,e)||(this._scaleByDistance=p.clone(e,t),C(this,O))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){var t=this._translucencyByDistance;p.equals(t,e)||(this._translucencyByDistance=p.clone(e,t),C(this,R))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){var t=this._pixelOffsetScaleByDistance;p.equals(t,e)||(this._pixelOffsetScaleByDistance=p.clone(e,t),C(this,N))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){var t=this._eyeOffset;n.equals(t,e)||(n.clone(e,t),C(this,S))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,C(this,x))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){this._verticalOrigin!==e&&(this._verticalOrigin=e,C(this,T))}},scale:{get:function(){return this._scale},set:function(e){this._scale!==e&&(this._scale=e,C(this,A))}},color:{get:function(){return this._color},set:function(e){var t=this._color;o.equals(t,e)||(o.clone(e,t),C(this,D))}},rotation:{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,C(this,M))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){var t=this._alignedAxis;n.equals(t,e)||(n.clone(e,t),C(this,I))}},width:{get:function(){return s(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,C(this,P))}},height:{get:function(){return s(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,C(this,P))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,C(this,D))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){h.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=h.clone(e,this._distanceDisplayCondition),C(this,L))}},id:{get:function(){return this._id},set:function(e){this._id=e,l(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,l(this._pickId)&&(this._pickId.object.primitive=e)}},image:{get:function(){return this._imageId},set:function(e){l(e)?"string"==typeof e?this.setImage(e,e):l(e.src)?this.setImage(e.src,e):this.setImage(a(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,C(this,P))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=n.clone(e,this._actualClampedPosition),C(this,b)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,C(this,w))}}}),y.prototype.getPickId=function(e){return l(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},y.prototype._updateClamping=function(){y._updateClamping(this._billboardCollection,this)};var F=new i,B=new n;y._updateClamping=function(e,t){function r(e){if(t._heightReference===f.RELATIVE_TO_GROUND)if(t._mode===_.SCENE3D){var r=s.cartesianToCartographic(e,F);r.height+=d.height,s.cartographicToCartesian(r,e)}else e.x+=d.height;t._clampedPosition=n.clone(e,t._clampedPosition)}var o=e._scene;if(l(o)){var a=o.globe,s=a.ellipsoid,u=a._surface,c=o.frameState.mode,h=c!==t._mode;if(t._mode=c,(t._heightReference===f.NONE||h)&&l(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference!==f.NONE&&l(t._position)){var d=s.cartesianToCartographic(t._position);if(l(d)){l(t._removeCallbackFunc)&&t._removeCallbackFunc(),t._removeCallbackFunc=u.updateHeight(d,r),i.clone(d,F);var p=a.getHeight(d);l(p)&&(F.height=p),s.cartographicToCartesian(F,B),r(B)}}}},y.prototype._loadImage=function(){var t,n=this._billboardCollection._textureAtlas,r=this._imageId,i=this._image,o=this._imageSubRegion;if(l(i)&&(t=n.addImage(r,i)),l(o)&&(t=n.addSubRegion(r,o)),this._imageIndexPromise=t,l(t)){var a=this;t.then(function(t){if(a._imageId===r&&a._image===i&&e.equals(a._imageSubRegion,o)){var s=n.textureCoordinates[t];a._imageWidth=n.texture.width*s.width,a._imageHeight=n.texture.height*s.height,a._imageIndex=t,a._ready=!0,a._image=void 0,a._imageIndexPromise=void 0,C(a,P)}}).otherwise(function(e){console.error("Error loading image for billboard: "+e),a._imageIndexPromise=void 0})}},y.prototype.setImage=function(e,t){this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,l(this._billboardCollection._textureAtlas)&&this._loadImage())},y.prototype.setImageSubRegion=function(t,n){this._imageId===t&&e.equals(this._imageSubRegion,n)||(this._imageIndex=-1,this._imageId=t,this._imageSubRegion=e.clone(n),l(this._billboardCollection._textureAtlas)&&this._loadImage())},y.prototype._setTranslate=function(e){var n=this._translate;t.equals(n,e)||(t.clone(e,n),C(this,E))},y.prototype._getActualPosition=function(){return l(this._clampedPosition)?this._clampedPosition:this._actualPosition},y.prototype._setActualPosition=function(e){l(this._clampedPosition)||n.clone(e,this._actualPosition),C(this,b)};var k=new r;y._computeActualPosition=function(e,t,n,r){return l(e._clampedPosition)?(n.mode!==e._mode&&e._updateClamping(),e._clampedPosition):n.mode===_.SCENE3D?t:(d.multiplyByPoint(r,t,k),g.computeActualWgs84Position(n,k))};var V=new t,z=new n,U=new t;y._computeScreenSpacePosition=function(e,n,r,i,o,a){var s=d.multiplyByPoint(e,n,z),u=g.wgs84WithEyeOffsetToWindowCoordinates(o,s,r,a);if(l(u)){i=t.clone(i,U);var c=t.multiplyByScalar(i,o.context.uniformState.resolutionScale,V);return u.x+=c.x,u.y+=c.y,u}};var G=new t(0,0);return y.prototype.computeScreenSpacePosition=function(e,n){var r=this._billboardCollection;l(n)||(n=new t),t.clone(this._pixelOffset,G),t.add(G,this._translate,G);var i=r.modelMatrix,o=this._getActualPosition();return y._computeScreenSpacePosition(i,o,this._eyeOffset,G,e,n)},y.getScreenSpaceBoundingBox=function(t,n,r){var i=t.width,o=t.height,a=t.scale;i*=a,o*=a;var s=n.x;t.horizontalOrigin===m.RIGHT?s-=i:t.horizontalOrigin===m.CENTER&&(s-=.5*i);var u=n.y;return t.verticalOrigin===v.TOP?u-=o:t.verticalOrigin===v.CENTER&&(u-=.5*o),l(r)||(r=new e),r.x=s,r.y=u,r.width=i,r.height=o,r},y.prototype.equals=function(r){return this===r||l(r)&&this._id===r._id&&n.equals(this._position,r._position)&&this._imageId===r._imageId&&this._show===r._show&&this._scale===r._scale&&this._verticalOrigin===r._verticalOrigin&&this._horizontalOrigin===r._horizontalOrigin&&this._heightReference===r._heightReference&&e.equals(this._imageSubRegion,r._imageSubRegion)&&o.equals(this._color,r._color)&&t.equals(this._pixelOffset,r._pixelOffset)&&t.equals(this._translate,r._translate)&&n.equals(this._eyeOffset,r._eyeOffset)&&p.equals(this._scaleByDistance,r._scaleByDistance)&&p.equals(this._translucencyByDistance,r._translucencyByDistance)&&p.equals(this._pixelOffsetScaleByDistance,r._pixelOffsetScaleByDistance)&&h.equals(this._distanceDisplayCondition,r._distanceDisplayCondition)},y.prototype._destroy=function(){l(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),l(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0},y}),o("Renderer/BufferUsage",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={STREAM_DRAW:t.STREAM_DRAW,STATIC_DRAW:t.STATIC_DRAW,DYNAMIC_DRAW:t.DYNAMIC_DRAW,validate:function(e){return e===n.STREAM_DRAW||e===n.STATIC_DRAW||e===n.DYNAMIC_DRAW}};return e(n)}),o("Renderer/Buffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/IndexDatatype","./BufferUsage","./WebGLConstants"],function(e,t,n,r,i,o,a,s){"use strict";function l(n){var r=(n=e(n,e.EMPTY_OBJECT)).context._gl,i=n.bufferTarget,o=n.typedArray,a=n.sizeInBytes,s=n.usage,l=t(o);l&&(a=o.byteLength);var u=r.createBuffer();r.bindBuffer(i,u),r.bufferData(i,l?o:a,s),r.bindBuffer(i,null),this._gl=r,this._bufferTarget=i,this._sizeInBytes=a,this._usage=s,this._buffer=u,this.vertexArrayDestroyable=!0}return l.createVertexBuffer=function(e){return new l({context:e.context,bufferTarget:s.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},l.createIndexBuffer=function(e){var t=e.context,r=e.indexDatatype,i=o.getSizeInBytes(r),a=new l({context:t,bufferTarget:s.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),u=a.sizeInBytes/i;return n(a,{indexDatatype:{get:function(){return r}},bytesPerIndex:{get:function(){return i}},numberOfIndices:{get:function(){return u}}}),a},n(l.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),l.prototype._getBuffer=function(){return this._buffer},l.prototype.copyFromArrayView=function(t,n){n=e(n,0);var r=this._gl,i=this._bufferTarget;r.bindBuffer(i,this._buffer),r.bufferSubData(i,n,t),r.bindBuffer(i,null)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),r(this)},l}),o("Renderer/DrawCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/PrimitiveType"],function(e,t,n,r){"use strict";function i(t){t=e(t,e.EMPTY_OBJECT),this._boundingVolume=t.boundingVolume,this._orientedBoundingBox=t.orientedBoundingBox,this._cull=e(t.cull,!0),this._modelMatrix=t.modelMatrix,this._primitiveType=e(t.primitiveType,r.TRIANGLES),this._vertexArray=t.vertexArray,this._count=t.count,this._offset=e(t.offset,0),this._instanceCount=e(t.instanceCount,0),this._shaderProgram=t.shaderProgram,this._uniformMap=t.uniformMap,this._renderState=t.renderState,this._framebuffer=t.framebuffer,this._pass=t.pass,this._executeInClosestFrustum=e(t.executeInClosestFrustum,!1),this._owner=t.owner,this._debugShowBoundingVolume=e(t.debugShowBoundingVolume,!1),this._debugOverlappingFrustums=0,this._castShadows=e(t.castShadows,!1),this._receiveShadows=e(t.receiveShadows,!1),this.dirty=!0,this.lastDirtyTime=0,this.derivedCommands={}}return n(i.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return this._castShadows},set:function(e){this._castShadows!==e&&(this._castShadows=e,this.dirty=!0)}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){this._receiveShadows!==e&&(this._receiveShadows=e,this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){this._executeInClosestFrustum!==e&&(this._executeInClosestFrustum=e,this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}}}),i.shallowClone=function(e,n){if(t(e))return t(n)||(n=new i),n._boundingVolume=e._boundingVolume,n._orientedBoundingBox=e._orientedBoundingBox,n._cull=e._cull,n._modelMatrix=e._modelMatrix,n._primitiveType=e._primitiveType,n._vertexArray=e._vertexArray,n._count=e._count,n._offset=e._offset,n._instanceCount=e._instanceCount,n._shaderProgram=e._shaderProgram,n._uniformMap=e._uniformMap,n._renderState=e._renderState,n._framebuffer=e._framebuffer,n._pass=e._pass,n._executeInClosestFrustum=e._executeInClosestFrustum,n._owner=e._owner,n._debugShowBoundingVolume=e._debugShowBoundingVolume,n._debugOverlappingFrustums=e._debugOverlappingFrustums,n._castShadows=e._castShadows,n._receiveShadows=e._receiveShadows,n.dirty=!0,n.lastDirtyTime=0,n},i.prototype.execute=function(e,t){e.draw(this,t)},i}),o("Renderer/ContextLimits",["../Core/defineProperties"],function(e){"use strict";var t={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1};return e(t,{maximumCombinedTextureImageUnits:{get:function(){return t._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return t._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return t._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return t._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return t._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return t._maximumTextureSize}},maximumVaryingVectors:{get:function(){return t._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return t._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return t._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return t._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return t._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return t._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return t._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return t._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return t._maximumViewportWidth}},maximumViewportHeight:{get:function(){return t._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return t._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return t._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return t._maximumColorAttachments}},highpFloatSupported:{get:function(){return t._highpFloatSupported}},highpIntSupported:{get:function(){return t._highpIntSupported}}}),t}),o("Renderer/RenderState",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/RuntimeError","../Core/WindingOrder","./ContextLimits","./WebGLConstants"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(i){var o=n(i,{}),s=n(o.cull,{}),u=n(o.polygonOffset,{}),c=n(o.scissorTest,{}),h=n(c.rectangle,{}),d=n(o.depthRange,{}),p=n(o.depthTest,{}),f=n(o.colorMask,{}),m=n(o.blending,{}),_=n(m.color,{}),g=n(o.stencilTest,{}),v=n(g.frontOperation,{}),y=n(g.backOperation,{}),C=n(o.sampleCoverage,{}),w=o.viewport;this.frontFace=n(o.frontFace,a.COUNTER_CLOCKWISE),this.cull={enabled:n(s.enabled,!1),face:n(s.face,l.BACK)},this.lineWidth=n(o.lineWidth,1),this.polygonOffset={enabled:n(u.enabled,!1),factor:n(u.factor,0),units:n(u.units,0)},this.scissorTest={enabled:n(c.enabled,!1),rectangle:e.clone(h)},this.depthRange={near:n(d.near,0),far:n(d.far,1)},this.depthTest={enabled:n(p.enabled,!1),func:n(p.func,l.LESS)},this.colorMask={red:n(f.red,!0),green:n(f.green,!0),blue:n(f.blue,!0),alpha:n(f.alpha,!0)},this.depthMask=n(o.depthMask,!0),this.stencilMask=n(o.stencilMask,-1),this.blending={enabled:n(m.enabled,!1),color:new t(n(_.red,0),n(_.green,0),n(_.blue,0),n(_.alpha,0)),equationRgb:n(m.equationRgb,l.FUNC_ADD),equationAlpha:n(m.equationAlpha,l.FUNC_ADD),functionSourceRgb:n(m.functionSourceRgb,l.ONE),functionSourceAlpha:n(m.functionSourceAlpha,l.ONE),functionDestinationRgb:n(m.functionDestinationRgb,l.ZERO),functionDestinationAlpha:n(m.functionDestinationAlpha,l.ZERO)},this.stencilTest={enabled:n(g.enabled,!1),frontFunction:n(g.frontFunction,l.ALWAYS),backFunction:n(g.backFunction,l.ALWAYS),reference:n(g.reference,0),mask:n(g.mask,-1),frontOperation:{fail:n(v.fail,l.KEEP),zFail:n(v.zFail,l.KEEP),zPass:n(v.zPass,l.KEEP)},backOperation:{fail:n(y.fail,l.KEEP),zFail:n(y.zFail,l.KEEP),zPass:n(y.zPass,l.KEEP)}},this.sampleCoverage={enabled:n(C.enabled,!1),value:n(C.value,1),invert:n(C.invert,!1)},this.viewport=r(w)?new e(w.x,w.y,w.width,w.height):void 0,this.id=0,this._applyFunctions=[]}function c(e,t,n){n?e.enable(t):e.disable(t)}function h(e,t){e.frontFace(t.frontFace)}function d(e,t){var n=t.cull,r=n.enabled;c(e,e.CULL_FACE,r),r&&e.cullFace(n.face)}function p(e,t){e.lineWidth(t.lineWidth)}function f(e,t){var n=t.polygonOffset,r=n.enabled;c(e,e.POLYGON_OFFSET_FILL,r),r&&e.polygonOffset(n.factor,n.units)}function m(e,t,n){var i=t.scissorTest,o=r(n.scissorTest)?n.scissorTest.enabled:i.enabled;if(c(e,e.SCISSOR_TEST,o),o){var a=r(n.scissorTest)?n.scissorTest.rectangle:i.rectangle;e.scissor(a.x,a.y,a.width,a.height)}}function _(e,t){var n=t.depthRange;e.depthRange(n.near,n.far)}function g(e,t){var n=t.depthTest,r=n.enabled;c(e,e.DEPTH_TEST,r),r&&e.depthFunc(n.func)}function v(e,t){var n=t.colorMask;e.colorMask(n.red,n.green,n.blue,n.alpha)}function y(e,t){e.depthMask(t.depthMask)}function C(e,t){e.stencilMask(t.stencilMask)}function w(e,t,n){var i,o=t.blending,a=r(n.blendingEnabled)?n.blendingEnabled:o.enabled;c(e,e.BLEND,a),a&&(e.blendColor((i=o.color).red,i.green,i.blue,i.alpha),e.blendEquationSeparate(o.equationRgb,o.equationAlpha),e.blendFuncSeparate(o.functionSourceRgb,o.functionDestinationRgb,o.functionSourceAlpha,o.functionDestinationAlpha))}function b(e,t){var n=t.stencilTest,r=n.enabled;if(c(e,e.STENCIL_TEST,r),r){var i=n.frontFunction,o=n.backFunction,a=n.reference,s=n.mask;e.stencilFunc(n.frontFunction,n.reference,n.mask),e.stencilFuncSeparate(e.BACK,o,a,s),e.stencilFuncSeparate(e.FRONT,i,a,s);var l=n.frontOperation;e.stencilOpSeparate(e.FRONT,l.fail,l.zFail,l.zPass);var u=n.backOperation;e.stencilOpSeparate(e.BACK,u.fail,u.zFail,u.zPass)}}function E(e,t){var n=t.sampleCoverage,r=n.enabled;c(e,e.SAMPLE_COVERAGE,r),r&&e.sampleCoverage(n.value,n.invert)}function S(e,t,i){var o=n(t.viewport,i.viewport);r(o)||((o=A).width=i.context.drawingBufferWidth,o.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=o,e.viewport(o.x,o.y,o.width,o.height)}var x=0,T={};u.fromCache=function(e){var t=JSON.stringify(e),n=T[t];if(r(n))return++n.referenceCount,n.state;var i=new u(e),o=JSON.stringify(i);return r(n=T[o])||(i.id=x++,T[o]=n={referenceCount:0,state:i}),++n.referenceCount,T[t]={referenceCount:1,state:n.state},n.state},u.removeFromCache=function(e){var t=new u(e),n=JSON.stringify(t),i=T[n],o=JSON.stringify(e),a=T[o];r(a)&&(--a.referenceCount,0===a.referenceCount&&(delete T[o],r(i)&&--i.referenceCount)),r(i)&&0===i.referenceCount&&delete T[n]},u.getCache=function(){return T},u.clearCache=function(){T={}};var A=new e;return u.apply=function(e,t,n){h(e,t),d(e,t),p(e,t),f(e,t),_(e,t),g(e,t),v(e,t),y(e,t),C(e,t),b(e,t),E(e,t),m(e,t,n),w(e,t,n),S(e,t,n)},u.partialApply=function(e,t,n,i,o,a){if(t!==n){var s=n._applyFunctions[t.id];r(s)||(T=[],(c=t).frontFace!==(x=n).frontFace&&T.push(h),c.cull.enabled===x.cull.enabled&&c.cull.face===x.cull.face||T.push(d),c.lineWidth!==x.lineWidth&&T.push(p),c.polygonOffset.enabled===x.polygonOffset.enabled&&c.polygonOffset.factor===x.polygonOffset.factor&&c.polygonOffset.units===x.polygonOffset.units||T.push(f),c.depthRange.near===x.depthRange.near&&c.depthRange.far===x.depthRange.far||T.push(_),c.depthTest.enabled===x.depthTest.enabled&&c.depthTest.func===x.depthTest.func||T.push(g),c.colorMask.red===x.colorMask.red&&c.colorMask.green===x.colorMask.green&&c.colorMask.blue===x.colorMask.blue&&c.colorMask.alpha===x.colorMask.alpha||T.push(v),c.depthMask!==x.depthMask&&T.push(y),c.stencilMask!==x.stencilMask&&T.push(C),c.stencilTest.enabled===x.stencilTest.enabled&&c.stencilTest.frontFunction===x.stencilTest.frontFunction&&c.stencilTest.backFunction===x.stencilTest.backFunction&&c.stencilTest.reference===x.stencilTest.reference&&c.stencilTest.mask===x.stencilTest.mask&&c.stencilTest.frontOperation.fail===x.stencilTest.frontOperation.fail&&c.stencilTest.frontOperation.zFail===x.stencilTest.frontOperation.zFail&&c.stencilTest.backOperation.fail===x.stencilTest.backOperation.fail&&c.stencilTest.backOperation.zFail===x.stencilTest.backOperation.zFail&&c.stencilTest.backOperation.zPass===x.stencilTest.backOperation.zPass||T.push(b),c.sampleCoverage.enabled===x.sampleCoverage.enabled&&c.sampleCoverage.value===x.sampleCoverage.value&&c.sampleCoverage.invert===x.sampleCoverage.invert||T.push(E),n._applyFunctions[t.id]=s=T);for(var l=s.length,u=0;u<l;++u)s[u](e,n)}var c,x,T;((r(i.scissorTest)?i.scissorTest:t.scissorTest)!==(r(o.scissorTest)?o.scissorTest:n.scissorTest)||a)&&m(e,n,o);var A=r(i.blendingEnabled)?i.blendingEnabled:t.blending.enabled,P=r(o.blendingEnabled)?o.blendingEnabled:n.blending.enabled;(A!==P||P&&t.blending!==n.blending)&&w(e,n,o),t===n&&i===o&&i.context===o.context||S(e,n,o)},u.getState=function(n){return{frontFace:n.frontFace,cull:{enabled:n.cull.enabled,face:n.cull.face},lineWidth:n.lineWidth,polygonOffset:{enabled:n.polygonOffset.enabled,factor:n.polygonOffset.factor,units:n.polygonOffset.units},scissorTest:{enabled:n.scissorTest.enabled,rectangle:e.clone(n.scissorTest.rectangle)},depthRange:{near:n.depthRange.near,far:n.depthRange.far},depthTest:{enabled:n.depthTest.enabled,func:n.depthTest.func},colorMask:{red:n.colorMask.red,green:n.colorMask.green,blue:n.colorMask.blue,alpha:n.colorMask.alpha},depthMask:n.depthMask,stencilMask:n.stencilMask,blending:{enabled:n.blending.enabled,color:t.clone(n.blending.color),equationRgb:n.blending.equationRgb,equationAlpha:n.blending.equationAlpha,functionSourceRgb:n.blending.functionSourceRgb,functionSourceAlpha:n.blending.functionSourceAlpha,functionDestinationRgb:n.blending.functionDestinationRgb,functionDestinationAlpha:n.blending.functionDestinationAlpha},stencilTest:{enabled:n.stencilTest.enabled,frontFunction:n.stencilTest.frontFunction,backFunction:n.stencilTest.backFunction,reference:n.stencilTest.reference,mask:n.stencilTest.mask,frontOperation:{fail:n.stencilTest.frontOperation.fail,zFail:n.stencilTest.frontOperation.zFail,zPass:n.stencilTest.frontOperation.zPass},backOperation:{fail:n.stencilTest.backOperation.fail,zFail:n.stencilTest.backOperation.zFail,zPass:n.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:n.sampleCoverage.enabled,value:n.sampleCoverage.value,invert:n.sampleCoverage.invert},viewport:r(n.viewport)?e.clone(n.viewport):void 0}},u}),o("Renderer/AutomaticUniforms",["../Core/Cartesian3","../Core/Matrix4","./WebGLConstants"],function(e,t,n){"use strict";function r(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var i=new e;if("undefined"==typeof WebGLRenderingContext)return{};var o={};return o[n.FLOAT]="float",o[n.FLOAT_VEC2]="vec2",o[n.FLOAT_VEC3]="vec3",o[n.FLOAT_VEC4]="vec4",o[n.INT]="int",o[n.INT_VEC2]="ivec2",o[n.INT_VEC3]="ivec3",o[n.INT_VEC4]="ivec4",o[n.BOOL]="bool",o[n.BOOL_VEC2]="bvec2",o[n.BOOL_VEC3]="bvec3",o[n.BOOL_VEC4]="bvec4",o[n.FLOAT_MAT2]="mat2",o[n.FLOAT_MAT3]="mat3",o[n.FLOAT_MAT4]="mat4",o[n.SAMPLER_2D]="sampler2D",o[n.SAMPLER_CUBE]="samplerCube",r.prototype.getDeclaration=function(e){var t=this._size;return"uniform "+o[this._datatype]+" "+e+(1===t?";":"["+t.toString()+"];")},{czm_viewport:new r({size:1,datatype:n.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new r({size:1,datatype:n.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_viewRotation3D:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_inverseProjectionOIT:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseProjectionOIT}}),czm_infiniteProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new r({size:1,datatype:n.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_normal:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new r({size:1,datatype:n.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new r({size:1,datatype:n.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new r({size:1,datatype:n.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new r({size:1,datatype:n.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_sunPositionWC:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new r({size:1,datatype:n.FLOAT_VEC3,getValue:function(e){return t.getTranslation(e.inverseView,i)}}),czm_frameNumber:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.pass}}),czm_temeToPseudoFixed:new r({size:1,datatype:n.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new r({size:1,datatype:n.FLOAT,getValue:function(e){return e.fogDensity}})}}),o("Renderer/createUniform",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function h(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function d(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function p(e,t,n,r){this.name=n,this.value=void 0,this._value=void 0,this._gl=e,this._location=r}function f(e,t,n,r){this.name=n,this.value=void 0,this._gl=e,this._location=r,this.textureUnitIndex=void 0}function m(e,t,n,r){this.name=n,this.value=void 0,this._value=0,this._gl=e,this._location=r}function _(t,n,r,i){this.name=r,this.value=void 0,this._value=new e,this._gl=t,this._location=i}function g(e,n,r,i){this.name=r,this.value=void 0,this._value=new t,this._gl=e,this._location=i}function v(e,t,r,i){this.name=r,this.value=void 0,this._value=new n,this._gl=e,this._location=i}function y(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(4),this._gl=e,this._location=r}function C(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(9),this._gl=e,this._location=r}function w(e,t,n,r){this.name=n,this.value=void 0,this._value=new Float32Array(16),this._gl=e,this._location=r}return c.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},h.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2f(this._location,t.x,t.y))},d.prototype.set=function(){var e=this.value;i(e.red)?r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue)):i(e.x)&&(t.equals(e,this._value)||(this._value=t.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z)))},p.prototype.set=function(){var e=this.value;i(e.red)?r.equals(e,this._value)||(this._value=r.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha)):i(e.x)&&(n.equals(e,this._value)||(this._value=n.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w)))},f.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)},f.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},m.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},_.prototype.set=function(){var t=this.value;e.equals(t,this._value)||(e.clone(t,this._value),this._gl.uniform2i(this._location,t.x,t.y))},g.prototype.set=function(){var e=this.value;t.equals(e,this._value)||(t.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},v.prototype.set=function(){var e=this.value;n.equals(e,this._value)||(n.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))},y.prototype.set=function(){a.equalsArray(this.value,this._value,0)||(a.toArray(this.value,this._value),this._gl.uniformMatrix2fv(this._location,!1,this._value))},C.prototype.set=function(){s.equalsArray(this.value,this._value,0)||(s.toArray(this.value,this._value),this._gl.uniformMatrix3fv(this._location,!1,this._value))},w.prototype.set=function(){l.equalsArray(this.value,this._value,0)||(l.toArray(this.value,this._value),this._gl.uniformMatrix4fv(this._location,!1,this._value))},function(e,t,n,r){switch(t.type){case e.FLOAT:return new c(e,t,n,r);case e.FLOAT_VEC2:return new h(e,t,n,r);case e.FLOAT_VEC3:return new d(e,t,n,r);case e.FLOAT_VEC4:return new p(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new f(e,t,n,r);case e.INT:case e.BOOL:return new m(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new _(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new g(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new v(e,t,n,r);case e.FLOAT_MAT2:return new y(e,t,n,r);case e.FLOAT_MAT3:return new C(e,t,n,r);case e.FLOAT_MAT4:return new w(e,t,n,r);default:throw new u("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}}),o("Renderer/createUniformArray",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/RuntimeError"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._location=r[0]}function d(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(2*i),this._gl=e,this._location=r[0]}function p(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(3*i),this._gl=e,this._location=r[0]}function f(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function m(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(i),this._gl=e,this._locations=r,this.textureUnitIndex=void 0}function _(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(i),this._gl=e,this._location=r[0]}function g(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(2*i),this._gl=e,this._location=r[0]}function v(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(3*i),this._gl=e,this._location=r[0]}function y(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Int32Array(4*i),this._gl=e,this._location=r[0]}function C(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(4*i),this._gl=e,this._location=r[0]}function w(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(9*i),this._gl=e,this._location=r[0]}function b(e,t,n,r){var i=r.length;this.name=n,this.value=new Array(i),this._value=new Float32Array(16*i),this._gl=e,this._location=r[0]}return h.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var o=e[i];o!==n[i]&&(n[i]=o,r=!0)}r&&this._gl.uniform1fv(this._location,n)},d.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,o=0,a=0;a<n;++a){var s=t[a];e.equalsArray(s,r,o)||(e.pack(s,r,o),i=!0),o+=2}i&&this._gl.uniform2fv(this._location,r)},p.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,o=!1,a=0,s=0;s<n;++s){var l=e[s];i(l.red)?l.red===r[a]&&l.green===r[a+1]&&l.blue===r[a+2]||(r[a]=l.red,r[a+1]=l.green,r[a+2]=l.blue,o=!0):i(l.x)&&(t.equalsArray(l,r,a)||(t.pack(l,r,a),o=!0)),a+=3}o&&this._gl.uniform3fv(this._location,r)},f.prototype.set=function(){for(var e=this.value,t=e.length,o=this._value,a=!1,s=0,l=0;l<t;++l){var u=e[l];i(u.red)?r.equalsArray(u,o,s)||(r.pack(u,o,s),a=!0):i(u.x)&&(n.equalsArray(u,o,s)||(n.pack(u,o,s),a=!0)),s+=4}a&&this._gl.uniform4fv(this._location,o)},m.prototype.set=function(){for(var e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,n=this.value,r=n.length,i=0;i<r;++i){var o=n[i];e.activeTexture(t+i),e.bindTexture(o._target,o._texture)}},m.prototype._setSampler=function(e){this.textureUnitIndex=e;for(var t=this._locations,n=t.length,r=0;r<n;++r)this._gl.uniform1i(t[r],e+r);return e+n},_.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0;i<t;++i){var o=e[i];o!==n[i]&&(n[i]=o,r=!0)}r&&this._gl.uniform1iv(this._location,n)},g.prototype.set=function(){for(var t=this.value,n=t.length,r=this._value,i=!1,o=0,a=0;a<n;++a){var s=t[a];e.equalsArray(s,r,o)||(e.pack(s,r,o),i=!0),o+=2}i&&this._gl.uniform2iv(this._location,r)},v.prototype.set=function(){for(var e=this.value,n=e.length,r=this._value,i=!1,o=0,a=0;a<n;++a){var s=e[a];t.equalsArray(s,r,o)||(t.pack(s,r,o),i=!0),o+=3}i&&this._gl.uniform3iv(this._location,r)},y.prototype.set=function(){for(var e=this.value,t=e.length,r=this._value,i=!1,o=0,a=0;a<t;++a){var s=e[a];n.equalsArray(s,r,o)||(n.pack(s,r,o),i=!0),o+=4}i&&this._gl.uniform4iv(this._location,r)},C.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,o=0;o<t;++o){var a=e[o];s.equalsArray(a,n,i)||(s.pack(a,n,i),r=!0),i+=4}r&&this._gl.uniformMatrix2fv(this._location,!1,n)},w.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,o=0;o<t;++o){var a=e[o];l.equalsArray(a,n,i)||(l.pack(a,n,i),r=!0),i+=9}r&&this._gl.uniformMatrix3fv(this._location,!1,n)},b.prototype.set=function(){for(var e=this.value,t=e.length,n=this._value,r=!1,i=0,o=0;o<t;++o){var a=e[o];u.equalsArray(a,n,i)||(u.pack(a,n,i),r=!0),i+=16}r&&this._gl.uniformMatrix4fv(this._location,!1,n)},function(e,t,n,r){switch(t.type){case e.FLOAT:return new h(e,t,n,r);case e.FLOAT_VEC2:return new d(e,t,n,r);case e.FLOAT_VEC3:return new p(e,t,n,r);case e.FLOAT_VEC4:return new f(e,t,n,r);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new m(e,t,n,r);case e.INT:case e.BOOL:return new _(e,t,n,r);case e.INT_VEC2:case e.BOOL_VEC2:return new g(e,t,n,r);case e.INT_VEC3:case e.BOOL_VEC3:return new v(e,t,n,r);case e.INT_VEC4:case e.BOOL_VEC4:return new y(e,t,n,r);case e.FLOAT_MAT2:return new C(e,t,n,r);case e.FLOAT_MAT3:return new w(e,t,n,r);case e.FLOAT_MAT4:return new b(e,t,n,r);default:throw new c("Unrecognized uniform type: "+t.type+' for uniform "'+n+'".')}}}),o("Renderer/ShaderProgram",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/RuntimeError","./AutomaticUniforms","./ContextLimits","./createUniform","./createUniformArray"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e){var t=function(t,n){var r={};if(!s.highpFloatSupported||!s.highpIntSupported){var i,o,a,l,u=h(e.vertexShaderText),c=h(n),d=u.length,p=c.length;for(i=0;i<d;i++)for(o=0;o<p;o++)if(u[i]===c[o]){l="czm_mediump_"+(a=u[i]);var f=new RegExp(a+"\\b","g");n=n.replace(f,l),r[l]=a}}return{fragmentShaderText:n,duplicateUniformNames:r}}(0,e.fragmentShaderText);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=t.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=t.fragmentShaderText,this.id=p++}function h(e){var n=[],r=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(t(r))for(var i=r.length,o=0;o<i;o++){var a=r[o].trim(),s=a.slice(a.lastIndexOf(" ")+1);n.push(s)}return n}function d(e){if(!t(e._program)){var n=e._gl,r=function(e,n){var r=n._vertexShaderText,i=n._fragmentShaderText,a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,r),e.compileShader(a);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,i),e.compileShader(s);var l=e.createProgram();e.attachShader(l,a),e.attachShader(l,s),e.deleteShader(a),e.deleteShader(s);var u,c=n._attributeLocations;if(t(c))for(var h in c)c.hasOwnProperty(h)&&e.bindAttribLocation(l,c[h],h);if(e.linkProgram(l),!e.getProgramParameter(l,e.LINK_STATUS)){var d=n._debugShaders;if(!e.getShaderParameter(s,e.COMPILE_STATUS)){if(u=e.getShaderInfoLog(s),console.error(f+"Fragment shader compile log: "+u),t(d)){var p=d.getTranslatedShaderSource(s);""!==p?console.error(f+"Translated fragment shader source:\n"+p):console.error(f+"Fragment shader translation failed.")}throw e.deleteProgram(l),new o("Fragment shader failed to compile.  Compile log: "+u)}if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(u=e.getShaderInfoLog(a),console.error(f+"Vertex shader compile log: "+u),t(d)){var m=d.getTranslatedShaderSource(a);""!==m?console.error(f+"Translated vertex shader source:\n"+m):console.error(f+"Vertex shader translation failed.")}throw e.deleteProgram(l),new o("Vertex shader failed to compile.  Compile log: "+u)}throw u=e.getProgramInfoLog(l),console.error(f+"Shader program link log: "+u),t(d)&&(console.error(f+"Translated vertex shader source:\n"+d.getTranslatedShaderSource(a)),console.error(f+"Translated fragment shader source:\n"+d.getTranslatedShaderSource(s))),e.deleteProgram(l),new o("Program failed to link.  Link log: "+u)}var _=n._logShaderCompilation;return _&&(u=e.getShaderInfoLog(a),t(u)&&u.length>0&&console.log(f+"Vertex shader compile log: "+u)),_&&(u=e.getShaderInfoLog(s),t(u)&&u.length>0&&console.log(f+"Fragment shader compile log: "+u)),_&&(u=e.getProgramInfoLog(l),t(u)&&u.length>0&&console.log(f+"Shader program link log: "+u)),l}(n,e),i=n.getProgramParameter(r,n.ACTIVE_ATTRIBUTES),s=function(e,n){for(var r={},i=[],o=[],a=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),s=0;s<a;++s){var c=e.getActiveUniform(n,s),h=-1!==c.name.indexOf("[0]",c.name.length-"[0]".length)?c.name.slice(0,c.name.length-3):c.name;if(0!==h.indexOf("gl_"))if(c.name.indexOf("[")<0){var d=e.getUniformLocation(n,h);if(null!==d){var p=l(e,c,h,d);r[h]=p,i.push(p),p._setSampler&&o.push(p)}}else{var f,m,_,g,v=h.indexOf("[");if(v>=0){if(f=r[h.slice(0,v)],!t(f))continue;(m=f._locations).length<=1&&(_=f.value,null!==(g=e.getUniformLocation(n,h))&&(m.push(g),_.push(e.getUniform(n,g))))}else{m=[];for(var y=0;y<c.size;++y)g=e.getUniformLocation(n,h+"["+y+"]"),null!==g&&m.push(g);f=u(e,c,h,m),r[h]=f,i.push(f),f._setSampler&&o.push(f)}}}return{uniformsByName:r,uniforms:i,samplerUniforms:o}}(n,r),c=function(e,n){var r=[],i=[];for(var o in n)if(n.hasOwnProperty(o)){var s=n[o],l=o,u=e._duplicateUniformNames[l];t(u)&&(s.name=u,l=u);var c=a[l];t(c)?r.push({uniform:s,automaticUniform:c}):i.push(s)}return{automaticUniforms:r,manualUniforms:i}}(e,s.uniformsByName);e._program=r,e._numberOfVertexAttributes=i,e._vertexAttributes=function(e,t,n){for(var r={},i=0;i<n;++i){var o=e.getActiveAttrib(t,i),a=e.getAttribLocation(t,o.name);r[o.name]={name:o.name,type:o.type,index:a}}return r}(n,r,i),e._uniformsByName=s.uniformsByName,e._uniforms=s.uniforms,e._automaticUniforms=c.automaticUniforms,e._manualUniforms=c.manualUniforms,e.maximumTextureUnitIndex=function(e,t,n){e.useProgram(r);for(var i=0,o=n.length,a=0;a<o;++a)i=n[a]._setSampler(i);return e.useProgram(null),i}(n,0,s.samplerUniforms)}}var p=0;c.fromCache=function(t){return(t=e(t,e.EMPTY_OBJECT)).context.shaderCache.getShaderProgram(t)},c.replaceCache=function(t){return(t=e(t,e.EMPTY_OBJECT)).context.shaderCache.replaceShaderProgram(t)},n(c.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return d(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return d(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return d(this),this._uniformsByName}}});var f="[Cesium WebGL] ";return c.prototype._bind=function(){d(this),this._gl.useProgram(this._program)},c.prototype._setUniforms=function(e,n,r){var i,o;if(t(e)){var a=this._manualUniforms;for(i=a.length,o=0;o<i;++o){var s=a[o];s.value=e[s.name]()}}var l=this._automaticUniforms;for(i=l.length,o=0;o<i;++o){var u=l[o];u.uniform.value=u.automaticUniform.getValue(n)}var c=this._uniforms;for(i=c.length,o=0;o<i;++o)c[o].set();r&&this._gl.validateProgram(this._program)},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},c.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),r(this)},c}),o("Shaders/Builtin/Constants/degreesPerRadian",[],function(){"use strict";return"const float czm_degreesPerRadian = 57.29577951308232;\n"}),o("Shaders/Builtin/Constants/depthRange",[],function(){"use strict";return"const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n"}),o("Shaders/Builtin/Constants/epsilon1",[],function(){"use strict";return"const float czm_epsilon1 = 0.1;\n"}),o("Shaders/Builtin/Constants/epsilon2",[],function(){"use strict";return"const float czm_epsilon2 = 0.01;\n"}),o("Shaders/Builtin/Constants/epsilon3",[],function(){"use strict";return"const float czm_epsilon3 = 0.001;\n"}),o("Shaders/Builtin/Constants/epsilon4",[],function(){"use strict";return"const float czm_epsilon4 = 0.0001;\n"}),o("Shaders/Builtin/Constants/epsilon5",[],function(){"use strict";return"const float czm_epsilon5 = 0.00001;\n"}),o("Shaders/Builtin/Constants/epsilon6",[],function(){"use strict";return"const float czm_epsilon6 = 0.000001;\n"}),o("Shaders/Builtin/Constants/epsilon7",[],function(){"use strict";return"const float czm_epsilon7 = 0.0000001;\n"}),o("Shaders/Builtin/Constants/infinity",[],function(){"use strict";return"const float czm_infinity = 5906376272000.0;\n"}),o("Shaders/Builtin/Constants/oneOverPi",[],function(){"use strict";return"const float czm_oneOverPi = 0.3183098861837907;\n"}),o("Shaders/Builtin/Constants/oneOverTwoPi",[],function(){"use strict";return"const float czm_oneOverTwoPi = 0.15915494309189535;\n"}),o("Shaders/Builtin/Constants/passCompute",[],function(){"use strict";return"const float czm_passCompute = 1.0;\n"}),o("Shaders/Builtin/Constants/passEnvironment",[],function(){"use strict";return"const float czm_passEnvironment = 0.0;\n"}),o("Shaders/Builtin/Constants/passGlobe",[],function(){"use strict";return"const float czm_passGlobe = 2.0;\n"}),o("Shaders/Builtin/Constants/passGround",[],function(){"use strict";return"const float czm_passGround = 3.0;\n"}),o("Shaders/Builtin/Constants/passOpaque",[],function(){"use strict";return"const float czm_passOpaque = 4.0;\n"}),o("Shaders/Builtin/Constants/passOverlay",[],function(){"use strict";return"const float czm_passOverlay = 6.0;\n"}),o("Shaders/Builtin/Constants/passTranslucent",[],function(){"use strict";return"const float czm_passTranslucent = 5.0;\n"}),o("Shaders/Builtin/Constants/pi",[],function(){"use strict";return"const float czm_pi = 3.141592653589793;\n"}),o("Shaders/Builtin/Constants/piOverFour",[],function(){"use strict";return"const float czm_piOverFour = 0.7853981633974483;\n"}),o("Shaders/Builtin/Constants/piOverSix",[],function(){"use strict";return"const float czm_piOverSix = 0.5235987755982988;\n"}),o("Shaders/Builtin/Constants/piOverThree",[],function(){"use strict";return"const float czm_piOverThree = 1.0471975511965976;\n"}),o("Shaders/Builtin/Constants/piOverTwo",[],function(){"use strict";return"const float czm_piOverTwo = 1.5707963267948966;\n"}),o("Shaders/Builtin/Constants/radiansPerDegree",[],function(){"use strict";return"const float czm_radiansPerDegree = 0.017453292519943295;\n"}),o("Shaders/Builtin/Constants/sceneMode2D",[],function(){"use strict";return"const float czm_sceneMode2D = 2.0;\n"}),o("Shaders/Builtin/Constants/sceneMode3D",[],function(){"use strict";return"const float czm_sceneMode3D = 3.0;\n"}),o("Shaders/Builtin/Constants/sceneModeColumbusView",[],function(){"use strict";return"const float czm_sceneModeColumbusView = 1.0;\n"}),o("Shaders/Builtin/Constants/sceneModeMorphing",[],function(){"use strict";return"const float czm_sceneModeMorphing = 0.0;\n"}),o("Shaders/Builtin/Constants/solarRadius",[],function(){"use strict";return"const float czm_solarRadius = 695500000.0;\n"}),o("Shaders/Builtin/Constants/threePiOver2",[],function(){"use strict";return"const float czm_threePiOver2 = 4.71238898038469;\n"}),o("Shaders/Builtin/Constants/twoPi",[],function(){"use strict";return"const float czm_twoPi = 6.283185307179586;\n"}),o("Shaders/Builtin/Constants/webMercatorMaxLatitude",[],function(){"use strict";return"const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n"}),o("Shaders/Builtin/Structs/depthRangeStruct",[],function(){"use strict";return"struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n"}),o("Shaders/Builtin/Structs/ellipsoid",[],function(){"use strict";return"struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n"}),o("Shaders/Builtin/Structs/material",[],function(){"use strict";return"struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n"}),o("Shaders/Builtin/Structs/materialInput",[],function(){"use strict";return"struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\n};\n"}),o("Shaders/Builtin/Structs/ray",[],function(){"use strict";return"struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n"}),o("Shaders/Builtin/Structs/raySegment",[],function(){"use strict";return"struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n"}),o("Shaders/Builtin/Structs/shadowParameters",[],function(){"use strict";return"struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n"}),o("Shaders/Builtin/Functions/alphaWeight",[],function(){"use strict";return"float czm_alphaWeight(float a)\n{\nfloat z;\nif (czm_sceneMode != czm_sceneMode2D)\n{\nfloat x = 2.0 * (gl_FragCoord.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (gl_FragCoord.y - czm_viewport.y) / czm_viewport.w - 1.0;\nz = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 0.0);\nq /= gl_FragCoord.w;\nz = (czm_inverseProjectionOIT * q).z;\n}\nelse\n{\nz = gl_FragCoord.z * (czm_currentFrustum.y - czm_currentFrustum.x) + czm_currentFrustum.x;\n}\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 100.0 / (1e-5 + pow(abs(z) / 10.0, 3.0) + pow(abs(z) / 200.0, 6.0))));\n}\n"}),o("Shaders/Builtin/Functions/antialias",[],function(){"use strict";return"vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n"}),o("Shaders/Builtin/Functions/cascadeColor",[],function(){"use strict";return"vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n"}),o("Shaders/Builtin/Functions/cascadeDistance",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n"}),o("Shaders/Builtin/Functions/cascadeMatrix",[],function(){"use strict";return"uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n"}),o("Shaders/Builtin/Functions/cascadeWeights",[],function(){"use strict";return"uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n"}),o("Shaders/Builtin/Functions/columbusViewMorph",[],function(){"use strict";return"vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n"}),o("Shaders/Builtin/Functions/computePosition",[],function(){"use strict";return"vec4 czm_computePosition();\n"}),o("Shaders/Builtin/Functions/cosineAndSine",[],function(){"use strict";return"vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n"}),o("Shaders/Builtin/Functions/decompressTextureCoordinates",[],function(){"use strict";return"vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n"}),o("Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates",[],function(){"use strict";return"mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n"}),o("Shaders/Builtin/Functions/ellipsoidContainsPoint",[],function(){"use strict";return"bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n"}),o("Shaders/Builtin/Functions/ellipsoidNew",[],function(){"use strict";return"czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),o("Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates",[],function(){"use strict";return"vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n"}),o("Shaders/Builtin/Functions/equalsEpsilon",[],function(){"use strict";return"bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n"}),o("Shaders/Builtin/Functions/eyeOffset",[],function(){"use strict";return"vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n"}),o("Shaders/Builtin/Functions/eyeToWindowCoordinates",[],function(){"use strict";return"vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),o("Shaders/Builtin/Functions/fog",[],function(){"use strict";return"vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\n"}),o("Shaders/Builtin/Functions/geodeticSurfaceNormal",[],function(){"use strict";return"vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n"}),o("Shaders/Builtin/Functions/getDefaultMaterial",[],function(){"use strict";return"czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n"}),o("Shaders/Builtin/Functions/getLambertDiffuse",[],function(){"use strict";return"float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n"}),o("Shaders/Builtin/Functions/getSpecular",[],function(){"use strict";return"float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n"}),o("Shaders/Builtin/Functions/getWaterNoise",[],function(){"use strict";return"vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n"}),o("Shaders/Builtin/Functions/getWgs84EllipsoidEC",[],function(){"use strict";return"czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = vec3(6378137.0, 6378137.0, 6356752.314245);\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n"}),o("Shaders/Builtin/Functions/hue",[],function(){"use strict";return"vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n"}),o("Shaders/Builtin/Functions/isEmpty",[],function(){"use strict";return"bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n"}),o("Shaders/Builtin/Functions/isFull",[],function(){"use strict";return"bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n"}),o("Shaders/Builtin/Functions/latitudeToWebMercatorFraction",[],function(){"use strict";return"float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n"}),o("Shaders/Builtin/Functions/luminance",[],function(){"use strict";return"float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n"}),o("Shaders/Builtin/Functions/metersPerPixel",[],function(){"use strict";return"float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n"}),o("Shaders/Builtin/Functions/modelToWindowCoordinates",[],function(){"use strict";return"vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n"}),o("Shaders/Builtin/Functions/multiplyWithColorBalance",[],function(){"use strict";return"vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n"}),o("Shaders/Builtin/Functions/nearFarScalar",[],function(){"use strict";return"float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n"}),o("Shaders/Builtin/Functions/octDecode",[],function(){"use strict";return"vec3 czm_octDecode(vec2 encoded)\n{\nencoded = encoded / 255.0 * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n"}),o("Shaders/Builtin/Functions/packDepth",[],function(){"use strict";return"vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n"}),o("Shaders/Builtin/Functions/phong",[],function(){"use strict";return"float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),o("Shaders/Builtin/Functions/pointAlongRay",[],function(){"use strict";return"vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n"}),o("Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval",[],function(){"use strict";return"czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n"}),o("Shaders/Builtin/Functions/RGBToXYZ",[],function(){"use strict";return"vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n"}),o("Shaders/Builtin/Functions/saturation",[],function(){"use strict";return"vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n"}),o("Shaders/Builtin/Functions/shadowDepthCompare",[],function(){"use strict";return"float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n"}),o("Shaders/Builtin/Functions/shadowVisibility",[],function(){"use strict";return"float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n"}),o("Shaders/Builtin/Functions/signNotZero",[],function(){"use strict";return"float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n"}),o("Shaders/Builtin/Functions/tangentToEyeSpaceMatrix",[],function(){"use strict";return"mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 binormalEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 binormal = normalize(binormalEC);\nreturn mat3(tangent.x,  tangent.y,  tangent.z,\nbinormal.x, binormal.y, binormal.z,\nnormal.x,   normal.y,   normal.z);\n}\n"}),o("Shaders/Builtin/Functions/translateRelativeToEye",[],function(){"use strict";return"vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n"}),o("Shaders/Builtin/Functions/translucentPhong",[],function(){"use strict";return"vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n"}),o("Shaders/Builtin/Functions/transpose",[],function(){"use strict";return"mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n"}),o("Shaders/Builtin/Functions/unpackDepth",[],function(){"use strict";return"float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 160581375.0));\n}\n"}),o("Shaders/Builtin/Functions/windowToEyeCoordinates",[],function(){"use strict";return"vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nq = czm_inverseProjection * q;\nreturn q;\n}\n"}),o("Shaders/Builtin/Functions/XYZToRGB",[],function(){"use strict";return"vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n"}),o("Shaders/Builtin/CzmBuiltins",["./Constants/degreesPerRadian","./Constants/depthRange","./Constants/epsilon1","./Constants/epsilon2","./Constants/epsilon3","./Constants/epsilon4","./Constants/epsilon5","./Constants/epsilon6","./Constants/epsilon7","./Constants/infinity","./Constants/oneOverPi","./Constants/oneOverTwoPi","./Constants/passCompute","./Constants/passEnvironment","./Constants/passGlobe","./Constants/passGround","./Constants/passOpaque","./Constants/passOverlay","./Constants/passTranslucent","./Constants/pi","./Constants/piOverFour","./Constants/piOverSix","./Constants/piOverThree","./Constants/piOverTwo","./Constants/radiansPerDegree","./Constants/sceneMode2D","./Constants/sceneMode3D","./Constants/sceneModeColumbusView","./Constants/sceneModeMorphing","./Constants/solarRadius","./Constants/threePiOver2","./Constants/twoPi","./Constants/webMercatorMaxLatitude","./Structs/depthRangeStruct","./Structs/ellipsoid","./Structs/material","./Structs/materialInput","./Structs/ray","./Structs/raySegment","./Structs/shadowParameters","./Functions/alphaWeight","./Functions/antialias","./Functions/cascadeColor","./Functions/cascadeDistance","./Functions/cascadeMatrix","./Functions/cascadeWeights","./Functions/columbusViewMorph","./Functions/computePosition","./Functions/cosineAndSine","./Functions/decompressTextureCoordinates","./Functions/eastNorthUpToEyeCoordinates","./Functions/ellipsoidContainsPoint","./Functions/ellipsoidNew","./Functions/ellipsoidWgs84TextureCoordinates","./Functions/equalsEpsilon","./Functions/eyeOffset","./Functions/eyeToWindowCoordinates","./Functions/fog","./Functions/geodeticSurfaceNormal","./Functions/getDefaultMaterial","./Functions/getLambertDiffuse","./Functions/getSpecular","./Functions/getWaterNoise","./Functions/getWgs84EllipsoidEC","./Functions/hue","./Functions/isEmpty","./Functions/isFull","./Functions/latitudeToWebMercatorFraction","./Functions/luminance","./Functions/metersPerPixel","./Functions/modelToWindowCoordinates","./Functions/multiplyWithColorBalance","./Functions/nearFarScalar","./Functions/octDecode","./Functions/packDepth","./Functions/phong","./Functions/pointAlongRay","./Functions/rayEllipsoidIntersectionInterval","./Functions/RGBToXYZ","./Functions/saturation","./Functions/shadowDepthCompare","./Functions/shadowVisibility","./Functions/signNotZero","./Functions/tangentToEyeSpaceMatrix","./Functions/translateRelativeToEye","./Functions/translucentPhong","./Functions/transpose","./Functions/unpackDepth","./Functions/windowToEyeCoordinates","./Functions/XYZToRGB"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie,oe,ae,se,le,ue,ce,he,de,pe,fe,me,_e,ge,ve,ye,Ce,we,be,Ee,Se,xe,Te,Ae,Pe,De,Me,Ie,Oe,Re,Ne,Le){"use strict";return{czm_degreesPerRadian:e,czm_depthRange:t,czm_epsilon1:n,czm_epsilon2:r,czm_epsilon3:i,czm_epsilon4:o,czm_epsilon5:a,czm_epsilon6:s,czm_epsilon7:l,czm_infinity:u,czm_oneOverPi:c,czm_oneOverTwoPi:h,czm_passCompute:d,czm_passEnvironment:p,czm_passGlobe:f,czm_passGround:m,czm_passOpaque:_,czm_passOverlay:g,czm_passTranslucent:v,czm_pi:y,czm_piOverFour:C,czm_piOverSix:w,czm_piOverThree:b,czm_piOverTwo:E,czm_radiansPerDegree:S,czm_sceneMode2D:x,czm_sceneMode3D:T,czm_sceneModeColumbusView:A,czm_sceneModeMorphing:P,czm_solarRadius:D,czm_threePiOver2:M,czm_twoPi:I,czm_webMercatorMaxLatitude:O,czm_depthRangeStruct:R,czm_ellipsoid:N,czm_material:L,czm_materialInput:F,czm_ray:B,czm_raySegment:k,czm_shadowParameters:V,czm_alphaWeight:z,czm_antialias:U,czm_cascadeColor:G,czm_cascadeDistance:W,czm_cascadeMatrix:H,czm_cascadeWeights:j,czm_columbusViewMorph:q,czm_computePosition:Y,czm_cosineAndSine:X,czm_decompressTextureCoordinates:Z,czm_eastNorthUpToEyeCoordinates:K,czm_ellipsoidContainsPoint:Q,czm_ellipsoidNew:J,czm_ellipsoidWgs84TextureCoordinates:$,czm_equalsEpsilon:ee,czm_eyeOffset:te,czm_eyeToWindowCoordinates:ne,czm_fog:re,czm_geodeticSurfaceNormal:ie,czm_getDefaultMaterial:oe,czm_getLambertDiffuse:ae,czm_getSpecular:se,czm_getWaterNoise:le,czm_getWgs84EllipsoidEC:ue,czm_hue:ce,czm_isEmpty:he,czm_isFull:de,czm_latitudeToWebMercatorFraction:pe,czm_luminance:fe,czm_metersPerPixel:me,czm_modelToWindowCoordinates:_e,czm_multiplyWithColorBalance:ge,czm_nearFarScalar:ve,czm_octDecode:ye,czm_packDepth:Ce,czm_phong:we,czm_pointAlongRay:be,czm_rayEllipsoidIntersectionInterval:Ee,czm_RGBToXYZ:Se,czm_saturation:xe,czm_shadowDepthCompare:Te,czm_shadowVisibility:Ae,czm_signNotZero:Pe,czm_tangentToEyeSpaceMatrix:De,czm_translateRelativeToEye:Me,czm_translucentPhong:Ie,czm_transpose:Oe,czm_unpackDepth:Re,czm_windowToEyeCoordinates:Ne,czm_XYZToRGB:Le}}),o("Renderer/ShaderSource",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Shaders/Builtin/CzmBuiltins","./AutomaticUniforms"],function(e,t,n,r,i){"use strict";function o(e){return(e=e.replace(/\/\/.*/g,"")).replace(/\/\*\*[\s\S]*?\*\//gm,function(e){for(var t=e.match(/\n/gm).length,n="",r=0;r<t;++r)n+="\n";return n})}function a(e,n,r){for(var i,a=0;a<r.length;++a)r[a].name===e&&(i=r[a]);return t(i)||(n=o(n),r.push(i={name:e,glslSource:n,dependsOn:[],requiredBy:[],evaluated:!1})),i}function s(e,n){var r,i,s,u="",c=e.sources;if(t(c))for(r=0,i=c.length;r<i;++r)u+="\n#line 0\n"+c[r];u=(u=(u=o(u)).replace(/#version\s+(.*?)\n/gm,function(e,t){return s=t,"\n"})).replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var h=e.pickColorQualifier;t(h)&&(u=l.createPickFragmentShaderSource(u,h));var d="";t(s)&&(d="#version "+s),n&&(d+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n");var p=e.defines;if(t(p))for(r=0,i=p.length;r<i;++r){var f=p[r];0!==f.length&&(d+="#define "+f+"\n")}return e.includeBuiltIns&&(d+=function(e){var n=[],r=a("main",u,n);(function e(n,r){if(!n.evaluated){n.evaluated=!0;var i=n.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);t(i)&&null!==i&&(i=i.filter(function(e,t){return i.indexOf(e)===t})).forEach(function(t){if(t!==n.name&&l._czmBuiltinsAndUniforms.hasOwnProperty(t)){var i=a(t,l._czmBuiltinsAndUniforms[t],r);n.dependsOn.push(i),i.requiredBy.push(n),e(i,r)}})}})(r,n),function(e){for(var t=[],n=[];e.length>0;){var r=e.pop();n.push(r),0===r.requiredBy.length&&t.push(r)}for(;t.length>0;){var i=t.shift();e.push(i);for(var o=0;o<i.dependsOn.length;++o){var a=i.dependsOn[o],s=a.requiredBy.indexOf(i);a.requiredBy.splice(s,1),0===a.requiredBy.length&&t.push(a)}}for(var l=[],u=0;u<n.length;++u)0!==n[u].requiredBy.length&&l.push(n[u])}(n);for(var i="",o=n.length-1;o>=0;--o)i=i+n[o].glslSource+"\n";return i.replace(r.glslSource,"")}()),(d+="\n#line 0\n")+u}function l(n){var r=(n=e(n,e.EMPTY_OBJECT)).pickColorQualifier;this.defines=t(n.defines)?n.defines.slice(0):[],this.sources=t(n.sources)?n.sources.slice(0):[],this.pickColorQualifier=r,this.includeBuiltIns=e(n.includeBuiltIns,!0)}l.prototype.clone=function(){return new l({sources:this.sources,defines:this.defines,pickColorQuantifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},l.replaceMain=function(e,t){return e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t="void "+t+"()")},l.prototype.createCombinedVertexShader=function(){return s(this,!1)},l.prototype.createCombinedFragmentShader=function(){return s(this,!0)},l._czmBuiltinsAndUniforms={};for(var u in r)r.hasOwnProperty(u)&&(l._czmBuiltinsAndUniforms[u]=r[u]);for(var c in i)if(i.hasOwnProperty(c)){var h=i[c];"function"==typeof h.getDeclaration&&(l._czmBuiltinsAndUniforms[c]=h.getDeclaration(c))}l.createPickVertexShaderSource=function(e){return l.replaceMain(e,"czm_old_main")+"\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}"},l.createPickFragmentShaderSource=function(e,t){return l.replaceMain(e,"czm_old_main")+"\n"+t+" vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}"},l.findVarying=function(e,t){for(var n=e.sources,r=t.length,i=0;i<r;++i)for(var o=t[i],a=n.length,s=0;s<a;++s)if(-1!==n[s].indexOf(o))return o};var d=["v_normalEC","v_normal"];l.findNormalVarying=function(e){return l.findVarying(e,d)};var p=["v_positionEC"];return l.findPositionVarying=function(e){return l.findVarying(e,p)},l}),o("Renderer/VertexArray",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/IndexDatatype","../Core/Math","../Core/RuntimeError","./Buffer","./BufferUsage","./ContextLimits"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(r,i,o,a){var s=n(i.vertexBuffer),l=n(i.value),u=i.value?i.value.length:i.componentsPerAttribute,c={index:t(i.index,o),enabled:t(i.enabled,!0),vertexBuffer:i.vertexBuffer,value:l?i.value.slice(0):void 0,componentsPerAttribute:u,componentDatatype:t(i.componentDatatype,e.FLOAT),normalize:t(i.normalize,!1),offsetInBytes:t(i.offsetInBytes,0),strideInBytes:t(i.strideInBytes,0),instanceDivisor:t(i.instanceDivisor,0)};if(s)c.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(a.glVertexAttribDivisor(t,this.instanceDivisor),a._vertexAttribDivisors[t]=this.instanceDivisor,a._previousDrawInstanced=!0)},c.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&a.glVertexAttribDivisor(o,0)};else{switch(c.componentsPerAttribute){case 1:c.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:c.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:c.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:c.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}c.disableVertexAttribArray=function(e){}}r.push(c)}function f(e,t,r){for(var i=0;i<t.length;++i){var o=t[i];o.enabled&&o.vertexAttrib(e)}n(r)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r._getBuffer())}function m(r){var i,o,a=(r=t(r,t.EMPTY_OBJECT)).context,s=a._gl,l=r.attributes,u=r.indexBuffer,c=[],h=1,d=!1,m=l.length;for(i=0;i<m;++i)p(c,l[i],i,a);for(m=c.length,i=0;i<m;++i){var _=c[i];if(n(_.vertexBuffer)&&0===_.instanceDivisor){var g=_.strideInBytes||_.componentsPerAttribute*e.getSizeInBytes(_.componentDatatype);h=_.vertexBuffer.sizeInBytes/g;break}}for(i=0;i<m;++i)if(c[i].instanceDivisor>0){d=!0;break}a.vertexArrayObject&&(o=a.glCreateVertexArray(),a.glBindVertexArray(o),f(s,c,u),a.glBindVertexArray(null)),this._numberOfVertices=h,this._hasInstancedAttributes=d,this._context=a,this._gl=s,this._vao=o,this._attributes=c,this._indexBuffer=u}function _(e){return e.values.length/e.componentsPerAttribute}return m.fromGeometry=function(r){var i,o,d,p=(r=t(r,t.EMPTY_OBJECT)).context,f=t(r.geometry,t.EMPTY_OBJECT),g=t(r.bufferUsage,h.DYNAMIC_DRAW),v=t(r.attributeLocations,t.EMPTY_OBJECT),y=t(r.interleave,!1),C=r.vertexArrayAttributes,w=n(C)?C:[],b=f.attributes;if(y){var E=function(t){var r,i,o,a=[];for(i in t)t.hasOwnProperty(i)&&n(t[i])&&n(t[i].values)&&(a.push(i),t[i].componentDatatype===e.DOUBLE&&(t[i].componentDatatype=e.FLOAT,t[i].values=e.createTypedArray(e.FLOAT,t[i].values)));var s,l=a.length;if(l>0)for(s=_(t[a[0]]),r=1;r<l;++r){var c=_(t[a[r]]);if(c!==s)throw new u("Each attribute list must have the same number of vertices.  Attribute "+a[r]+" has a different number of vertices ("+c.toString()+") than attribute "+a[0]+" ("+s.toString()+").")}a.sort(function(n,r){return e.getSizeInBytes(t[r].componentDatatype)-e.getSizeInBytes(t[n].componentDatatype)});var h,d=0,p={};for(r=0;r<l;++r)i=a[r],o=t[i],p[i]=d,d+=(h=o,e.getSizeInBytes(h.componentDatatype)*h.componentsPerAttribute);if(d>0){var f=e.getSizeInBytes(t[a[0]].componentDatatype),m=d%f;0!==m&&(d+=f-m);var g=new ArrayBuffer(s*d),v={};for(r=0;r<l;++r){var y=e.getSizeInBytes(t[i=a[r]].componentDatatype);v[i]={pointer:e.createTypedArray(t[i].componentDatatype,g),index:p[i]/y,strideInComponentType:d/y}}for(r=0;r<s;++r)for(var C=0;C<l;++C){for(var w=(o=t[i=a[C]]).values,b=v[i],E=b.pointer,S=o.componentsPerAttribute,x=0;x<S;++x)E[b.index+x]=w[r*S+x];b.index+=b.strideInComponentType}return{buffer:g,offsetsInBytes:p,vertexSizeInBytes:d}}}(b);if(n(E)){d=c.createVertexBuffer({context:p,typedArray:E.buffer,usage:g});var S=E.offsetsInBytes,x=E.vertexSizeInBytes;for(i in b)b.hasOwnProperty(i)&&n(b[i])&&(o=b[i],n(o.values)?w.push({index:v[i],vertexBuffer:d,componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,offsetInBytes:S[i],strideInBytes:x}):w.push({index:v[i],value:o.value,componentDatatype:o.componentDatatype,normalize:o.normalize}))}}else for(i in b)if(b.hasOwnProperty(i)&&n(b[i])){var T=(o=b[i]).componentDatatype;T===e.DOUBLE&&(T=e.FLOAT),d=void 0,n(o.values)&&(d=c.createVertexBuffer({context:p,typedArray:e.createTypedArray(T,o.values),usage:g})),w.push({index:v[i],vertexBuffer:d,value:o.value,componentDatatype:T,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize})}var A,P=f.indices;return n(P)&&(A=a.computeNumberOfVertices(f)>=l.SIXTY_FOUR_KILOBYTES&&p.elementIndexUint?c.createIndexBuffer({context:p,typedArray:new Uint32Array(P),usage:g,indexDatatype:s.UNSIGNED_INT}):c.createIndexBuffer({context:p,typedArray:new Uint16Array(P),usage:g,indexDatatype:s.UNSIGNED_SHORT})),new m({context:p,attributes:w,indexBuffer:A})},r(m.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),m.prototype.getAttribute=function(e){return this._attributes[e]},m.prototype._bind=function(){n(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&function(e){var t=e._context,n=e._hasInstancedAttributes;if(n||t._previousDrawInstanced){t._previousDrawInstanced=n;var r,i=t._vertexAttribDivisors,o=e._attributes,a=d.maximumVertexAttributes;if(n){var s=o.length;for(r=0;r<s;++r){var l=o[r];if(l.enabled){var u=l.instanceDivisor,c=l.index;u!==i[c]&&(t.glVertexAttribDivisor(c,u),i[c]=u)}}}else for(r=0;r<a;++r)i[r]>0&&(t.glVertexAttribDivisor(r,0),i[r]=0)}}(this)):f(this._gl,this._attributes,this._indexBuffer)},m.prototype._unBind=function(){if(n(this._vao))this._context.glBindVertexArray(null);else{for(var e=this._attributes,t=this._gl,r=0;r<e.length;++r){var i=e[r];i.enabled&&i.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){for(var e=this._attributes,t=0;t<e.length;++t){var r=e[t].vertexBuffer;n(r)&&!r.isDestroyed()&&r.vertexArrayDestroyable&&r.destroy()}var o=this._indexBuffer;return n(o)&&!o.isDestroyed()&&o.vertexArrayDestroyable&&o.destroy(),n(this._vao)&&this._context.glDeleteVertexArray(this._vao),i(this)},m}),o("Renderer/VertexArrayFacade",["../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","./Buffer","./BufferUsage","./VertexArray"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(r,i,o,a){function s(t,n){return e.getSizeInBytes(n.componentDatatype)-e.getSizeInBytes(t.componentDatatype)}var l=u._verifyAttributes(i);o=t(o,0);for(var c,h,d=[],p={},f=l.length,m=0;m<f;++m){var _=l[m];_.vertexBuffer?d.push(_):(n(c=p[h=_.usage])||(c=p[h]=[]),c.push(_))}this._allBuffers=[];for(h in p)if(p.hasOwnProperty(h)){(c=p[h]).sort(s);var g=u._vertexSizeInBytes(c),v={vertexSizeInBytes:g,vertexBuffer:void 0,usage:c[0].usage,needsCommit:!1,arrayBuffer:void 0,arrayViews:u._createArrayViews(c,g)};this._allBuffers.push(v)}this._size=0,this._instanced=t(a,!1),this._precreated=d,this._context=r,this.writers=void 0,this.va=void 0,this.resize(o)}function c(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;var r=t.vertexBuffer,i=e._size*t.vertexSizeInBytes,o=n(r);if(!o||r.sizeInBytes<i)return o&&r.destroy(),t.vertexBuffer=a.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}function h(e,t,n){if(e.needsCommit&&e.vertexSizeInBytes>0){var r=e.vertexSizeInBytes*t;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,r,e.vertexSizeInBytes*n),r)}}function d(e){var t=e.va;if(n(t)){for(var r=t.length,i=0;i<r;++i)t[i].va.destroy();e.va=void 0}}u._verifyAttributes=function(n){for(var r=[],i=0;i<n.length;++i){var o=n[i],a={index:t(o.index,i),enabled:t(o.enabled,!0),componentsPerAttribute:o.componentsPerAttribute,componentDatatype:t(o.componentDatatype,e.FLOAT),normalize:t(o.normalize,!1),vertexBuffer:o.vertexBuffer,usage:t(o.usage,s.STATIC_DRAW)};r.push(a)}for(var l=new Array(r.length),u=0;u<r.length;++u)l[r[u].index]=!0;return r},u._vertexSizeInBytes=function(t){for(var n=0,r=t.length,i=0;i<r;++i){var o=t[i];n+=o.componentsPerAttribute*e.getSizeInBytes(o.componentDatatype)}var a=r>0?e.getSizeInBytes(t[0].componentDatatype):0,s=a>0?n%a:0;return n+(0===s?0:a-s)},u._createArrayViews=function(t,n){for(var r=[],i=0,o=t.length,a=0;a<o;++a){var s=t[a],l=s.componentDatatype;r.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:l,normalize:s.normalize,offsetInBytes:i,vertexSizeInComponentType:n/e.getSizeInBytes(l),view:void 0}),i+=s.componentsPerAttribute*e.getSizeInBytes(l)}return r},u.prototype.resize=function(e){this._size=e;var t=this._allBuffers;this.writers=[];for(var n=0,r=t.length;n<r;++n){var i=t[n];u._resize(i,this._size),u._appendWriters(this.writers,i)}d(this)},u._resize=function(t,r){if(t.vertexSizeInBytes>0){var i=new ArrayBuffer(r*t.vertexSizeInBytes);if(n(t.arrayBuffer))for(var o=new Uint8Array(i),a=new Uint8Array(t.arrayBuffer),s=a.length,l=0;l<s;++l)o[l]=a[l];for(var u=t.arrayViews,c=u.length,h=0;h<c;++h){var d=u[h];d.view=e.createArrayBufferView(d.componentDatatype,i,d.offsetInBytes)}t.arrayBuffer=i}};var p=[function(e,t,n){return function(r,i){t[r*n]=i,e.needsCommit=!0}},function(e,t,n){return function(r,i,o){var a=r*n;t[a]=i,t[a+1]=o,e.needsCommit=!0}},function(e,t,n){return function(r,i,o,a){var s=r*n;t[s]=i,t[s+1]=o,t[s+2]=a,e.needsCommit=!0}},function(e,t,n){return function(r,i,o,a,s){var l=r*n;t[l]=i,t[l+1]=o,t[l+2]=a,t[l+3]=s,e.needsCommit=!0}}];return u._appendWriters=function(e,t){for(var n=t.arrayViews,r=n.length,i=0;i<r;++i){var o=n[i];e[o.index]=p[o.componentsPerAttribute-1](t,o.view,o.vertexSizeInComponentType)}},u.prototype.commit=function(e){var t,r,i,a=!1,s=this._allBuffers;for(r=0,i=s.length;r<i;++r)t=s[r],a=c(this,t)||a;if(a||!n(this.va)){d(this);for(var h=this.va=[],p=n(e)?Math.ceil(this._size/(o.SIXTY_FOUR_KILOBYTES-1)):1,f=0;f<p;++f){var m=[];for(r=0,i=s.length;r<i;++r)u._appendAttributes(m,t=s[r],f*(t.vertexSizeInBytes*(o.SIXTY_FOUR_KILOBYTES-1)),this._instanced);m=m.concat(this._precreated),h.push({va:new l({context:this._context,attributes:m,indexBuffer:e}),indicesCount:1.5*(f!==p-1?o.SIXTY_FOUR_KILOBYTES-1:this._size%(o.SIXTY_FOUR_KILOBYTES-1))})}}},u._appendAttributes=function(e,t,n,r){for(var i=t.arrayViews,o=i.length,a=0;a<o;++a){var s=i[a];e.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:s.componentDatatype,normalize:s.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:n+s.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:r?1:0})}},u.prototype.subCommit=function(e,t){for(var n=this._allBuffers,r=0,i=n.length;r<i;++r)h(n[r],e,t)},u.prototype.endSubCommits=function(){for(var e=this._allBuffers,t=0,n=e.length;t<n;++t)e[t].needsCommit=!1},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){for(var e=this._allBuffers,t=0,n=e.length;t<n;++t){var i=e[t];i.vertexBuffer=i.vertexBuffer&&i.vertexBuffer.destroy()}return d(this),r(this)},u}),o("Shaders/BillboardCollectionFS",[],function(){"use strict";return"uniform sampler2D u_atlas;\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef RENDER_FOR_PICK\nvec4 vertexColor = vec4(1.0, 1.0, 1.0, 1.0);\n#else\nvec4 vertexColor = v_color;\n#endif\nvec4 color = texture2D(u_atlas, v_textureCoordinates) * vertexColor;\nif (color.a == 0.0)\n{\ndiscard;\n}\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"}),o("Shaders/BillboardCollectionVS",[],function(){"use strict";return"#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScale;\nattribute vec4 positionLowAndRotation;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 compressedAttribute2;\nattribute vec4 eyeOffset;\nattribute vec4 scaleByDistance;\nattribute vec4 pixelOffsetScaleByDistance;\nattribute vec2 distanceDisplayCondition;\nvarying vec2 v_textureCoordinates;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#else\nvarying vec4 v_color;\n#endif\nconst float UPPER_BOUND = 32768.0;\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\nvec4 computePositionWindowCoordinates(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters)\n{\nvec2 halfSize = imageSize * scale * czm_resolutionScale;\nhalfSize *= ((direction * 2.0) - 1.0);\nvec2 originTranslate = origin * abs(halfSize);\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nif (validAlignedAxis || rotation != 0.0)\n{\nfloat angle = rotation;\nif (validAlignedAxis)\n{\nvec3 pos = positionEC.xyz + czm_encodedCameraPositionMCHigh + czm_encodedCameraPositionMCLow;\nvec3 normal = normalize(cross(alignedAxis, pos));\nvec4 tangent = vec4(normalize(cross(pos, normal)), 0.0);\ntangent = czm_modelViewProjection * tangent;\nangle += sign(-tangent.x) * acos(tangent.y / length(tangent.xy));\n}\nfloat cosTheta = cos(angle);\nfloat sinTheta = sin(angle);\nmat2 rotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\nhalfSize = rotationMatrix * halfSize;\n}\n#endif\nif (sizeInMeters)\n{\npositionEC.xy += halfSize;\n}\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nif (sizeInMeters)\n{\noriginTranslate += originTranslate / czm_metersPerPixel(positionEC);\n}\npositionWC.xy += originTranslate;\nif (!sizeInMeters)\n{\npositionWC.xy += halfSize;\n}\npositionWC.xy += translate;\npositionWC.xy += (pixelOffset * czm_resolutionScale);\nreturn positionWC;\n}\nvoid main()\n{\nvec3 positionHigh = positionHighAndScale.xyz;\nvec3 positionLow = positionLowAndRotation.xyz;\nfloat scale = positionHighAndScale.w;\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nfloat rotation = positionLowAndRotation.w;\n#else\nfloat rotation = 0.0;\n#endif\nfloat compressed = compressedAttribute0.x;\nvec2 pixelOffset;\npixelOffset.x = floor(compressed * SHIFT_RIGHT7);\ncompressed -= pixelOffset.x * SHIFT_LEFT7;\npixelOffset.x -= UPPER_BOUND;\nvec2 origin;\norigin.x = floor(compressed * SHIFT_RIGHT5);\ncompressed -= origin.x * SHIFT_LEFT5;\norigin.y = floor(compressed * SHIFT_RIGHT3);\ncompressed -= origin.y * SHIFT_LEFT3;\norigin -= vec2(1.0);\nfloat show = floor(compressed * SHIFT_RIGHT2);\ncompressed -= show * SHIFT_LEFT2;\n#ifdef INSTANCED\nvec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\nvec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\nvec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\nvec2 direction;\ndirection.x = floor(compressed * SHIFT_RIGHT1);\ndirection.y = compressed - direction.x * SHIFT_LEFT1;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\nfloat temp = compressedAttribute0.y  * SHIFT_RIGHT8;\npixelOffset.y = -(floor(temp) - UPPER_BOUND);\nvec2 translate;\ntranslate.y = (temp - floor(temp)) * SHIFT_LEFT16;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\ntranslate.x = floor(temp) - UPPER_BOUND;\ntranslate.y += (temp - floor(temp)) * SHIFT_LEFT8;\ntranslate.y -= UPPER_BOUND;\ntemp = compressedAttribute1.x * SHIFT_RIGHT8;\nvec2 imageSize = vec2(floor(temp), compressedAttribute2.w);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n#ifdef ALIGNED_AXIS\nvec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\ntemp = compressedAttribute2.z * SHIFT_RIGHT5;\nbool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\nvec3 alignedAxis = vec3(0.0);\nbool validAlignedAxis = false;\n#endif\n#ifdef RENDER_FOR_PICK\ntemp = compressedAttribute2.y;\n#else\ntemp = compressedAttribute2.x;\n#endif\nvec4 color;\ntemp = temp * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute2.z * SHIFT_RIGHT8;\nbool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\ntemp = floor(temp) * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\ncolor.a = (temp - floor(temp)) * SHIFT_LEFT8;\nvec4 pickColor = color / 255.0;\n#else\ncolor.a = floor(temp);\ncolor /= 255.0;\n#endif\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\nscale *= czm_nearFarScalar(scaleByDistance, lengthSq);\nif (scale == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\nfloat pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\npixelOffset *= pixelOffsetScale;\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = computePositionWindowCoordinates(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\nv_textureCoordinates = textureCoordinates;\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#else\nv_color = color;\nv_color.a *= translucency;\n#endif\n}\n"}),o("Scene/BlendEquation",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({ADD:t.FUNC_ADD,SUBTRACT:t.FUNC_SUBTRACT,REVERSE_SUBTRACT:t.FUNC_REVERSE_SUBTRACT})}),o("Scene/BlendFunction",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,ONE:t.ONE,SOURCE_COLOR:t.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:t.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:t.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:t.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:t.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:t.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:t.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:t.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:t.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:t.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:t.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:t.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:t.SRC_ALPHA_SATURATE})}),o("Scene/BlendingState",["../Core/freezeObject","./BlendEquation","./BlendFunction"],function(e,t,n){"use strict";return e({DISABLED:e({enabled:!1}),ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.ONE,functionSourceAlpha:n.ONE,functionDestinationRgb:n.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:n.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:e({enabled:!0,equationRgb:t.ADD,equationAlpha:t.ADD,functionSourceRgb:n.SOURCE_ALPHA,functionSourceAlpha:n.SOURCE_ALPHA,functionDestinationRgb:n.ONE,functionDestinationAlpha:n.ONE})})}),o("Scene/Pass",["../Core/freezeObject"],function(e){"use strict";return e({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,GROUND:3,OPAQUE:4,TRANSLUCENT:5,OVERLAY:6,NUMBER_OF_PASSES:7})}),o("Renderer/Framebuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","./ContextLimits"],function(e,t,n,r,i,o,a){"use strict";function s(e,t,n){var r=e._gl;r.framebufferTexture2D(r.FRAMEBUFFER,t,n._target,n._texture,0)}function l(e,t,n){var r=e._gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,n._getRenderbuffer())}function u(n){var r,i,o,a,u,c=(n=e(n,e.EMPTY_OBJECT)).context._gl;if(this._gl=c,this._framebuffer=c.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=e(n.destroyAttachments,!0),t(n.depthTexture)||t(n.depthRenderbuffer),t(n.depthStencilTexture)||t(n.depthStencilRenderbuffer),this._bind(),t(n.colorTextures)){var h=n.colorTextures;for(a=this._colorTextures.length=this._activeColorAttachments.length=h.length,o=0;o<a;++o)r=h[o],u=this._gl.COLOR_ATTACHMENT0+o,s(this,u,r),this._activeColorAttachments[o]=u,this._colorTextures[o]=r}if(t(n.colorRenderbuffers)){var d=n.colorRenderbuffers;for(a=this._colorRenderbuffers.length=this._activeColorAttachments.length=d.length,o=0;o<a;++o)i=d[o],u=this._gl.COLOR_ATTACHMENT0+o,l(this,u,i),this._activeColorAttachments[o]=u,this._colorRenderbuffers[o]=i}t(n.depthTexture)&&(s(this,this._gl.DEPTH_ATTACHMENT,r=n.depthTexture),this._depthTexture=r),t(n.depthRenderbuffer)&&(l(this,this._gl.DEPTH_ATTACHMENT,i=n.depthRenderbuffer),this._depthRenderbuffer=i),t(n.stencilRenderbuffer)&&(l(this,this._gl.STENCIL_ATTACHMENT,i=n.stencilRenderbuffer),this._stencilRenderbuffer=i),t(n.depthStencilTexture)&&(s(this,this._gl.DEPTH_STENCIL_ATTACHMENT,r=n.depthStencilTexture),this._depthStencilTexture=r),t(n.depthStencilRenderbuffer)&&(l(this,this._gl.DEPTH_STENCIL_ATTACHMENT,i=n.depthStencilRenderbuffer),this._depthStencilRenderbuffer=i),this._unBind()}return n(u.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),u.prototype._bind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer)},u.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},u.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},u.prototype.getColorTexture=function(e){return this._colorTextures[e]},u.prototype.getColorRenderbuffer=function(e){return this._colorRenderbuffers[e]},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){if(this.destroyAttachments){for(var e=0,n=this._colorTextures,i=n.length;e<i;++e){var o=n[e];t(o)&&o.destroy()}var a=this._colorRenderbuffers;for(i=a.length,e=0;e<i;++e){var s=a[e];t(s)&&s.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),r(this)},u}),o("Renderer/MipmapHint",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={DONT_CARE:t.DONT_CARE,FASTEST:t.FASTEST,NICEST:t.NICEST,validate:function(e){return e===n.DONT_CARE||e===n.FASTEST||e===n.NICEST}};return e(n)}),o("Renderer/PixelDatatype",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={UNSIGNED_BYTE:t.UNSIGNED_BYTE,UNSIGNED_SHORT:t.UNSIGNED_SHORT,UNSIGNED_INT:t.UNSIGNED_INT,FLOAT:t.FLOAT,UNSIGNED_INT_24_8:t.UNSIGNED_INT_24_8,UNSIGNED_SHORT_4_4_4_4:t.UNSIGNED_SHORT_4_4_4_4,UNSIGNED_SHORT_5_5_5_1:t.UNSIGNED_SHORT_5_5_5_1,UNSIGNED_SHORT_5_6_5:t.UNSIGNED_SHORT_5_6_5,validate:function(e){return e===n.UNSIGNED_BYTE||e===n.UNSIGNED_SHORT||e===n.UNSIGNED_INT||e===n.FLOAT||e===n.UNSIGNED_INT_24_8||e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5}};return e(n)}),o("Renderer/TextureMagnificationFilter",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR}};return e(n)}),o("Renderer/TextureMinificationFilter",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={NEAREST:t.NEAREST,LINEAR:t.LINEAR,NEAREST_MIPMAP_NEAREST:t.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:t.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:t.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:t.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===n.NEAREST||e===n.LINEAR||e===n.NEAREST_MIPMAP_NEAREST||e===n.LINEAR_MIPMAP_NEAREST||e===n.NEAREST_MIPMAP_LINEAR||e===n.LINEAR_MIPMAP_LINEAR}};return e(n)}),o("Renderer/TextureWrap",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={CLAMP_TO_EDGE:t.CLAMP_TO_EDGE,REPEAT:t.REPEAT,MIRRORED_REPEAT:t.MIRRORED_REPEAT,validate:function(e){return e===n.CLAMP_TO_EDGE||e===n.REPEAT||e===n.MIRRORED_REPEAT}};return e(n)}),o("Renderer/Sampler",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,n,r,i,o,a){"use strict";function s(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.wrapS,a.CLAMP_TO_EDGE),s=e(n.wrapT,a.CLAMP_TO_EDGE),l=e(n.minificationFilter,o.LINEAR),u=e(n.magnificationFilter,i.LINEAR),c=t(n.maximumAnisotropy)?n.maximumAnisotropy:1;this._wrapS=r,this._wrapT=s,this._minificationFilter=l,this._magnificationFilter=u,this._maximumAnisotropy=c}return n(s.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),s}),o("Renderer/Texture",["../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap","./WebGLConstants"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m){"use strict";function _(r){var i=(r=t(r,t.EMPTY_OBJECT)).context,o=r.width,a=r.height,l=r.source;n(l)&&(n(o)||(o=t(l.videoWidth,l.width)),n(a)||(a=t(l.videoHeight,l.height)));var u=t(r.pixelFormat,s.RGBA),d=t(r.pixelDatatype,c.UNSIGNED_BYTE),p=u;i.webgl2&&(u===s.DEPTH_STENCIL?p=m.DEPTH24_STENCIL8:u===s.DEPTH_COMPONENT&&(d===c.UNSIGNED_SHORT?p=m.DEPTH_COMPONENT16:d===c.UNSIGNED_INT&&(p=m.DEPTH_COMPONENT24)));var f=r.preMultiplyAlpha||u===s.RGB||u===s.LUMINANCE,_=t(r.flipY,!0),g=i._gl,v=g.TEXTURE_2D,y=g.createTexture();g.activeTexture(g.TEXTURE0),g.bindTexture(v,y),n(l)?(g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,_),n(l.arrayBufferView)?g.texImage2D(v,0,p,o,a,0,u,d,l.arrayBufferView):n(l.framebuffer)?(l.framebuffer!==i.defaultFramebuffer&&l.framebuffer._bind(),g.copyTexImage2D(v,0,p,l.xOffset,l.yOffset,o,a,0),l.framebuffer!==i.defaultFramebuffer&&l.framebuffer._unBind()):g.texImage2D(v,0,p,u,d,l)):g.texImage2D(v,0,p,o,a,0,u,d,null),g.bindTexture(v,null),this._context=i,this._textureFilterAnisotropic=i._textureFilterAnisotropic,this._textureTarget=v,this._texture=y,this._pixelFormat=u,this._pixelDatatype=d,this._width=o,this._height=a,this._dimensions=new e(o,a),this._preMultiplyAlpha=f,this._flipY=_,this._sampler=void 0,this.sampler=n(r.sampler)?r.sampler:new h}return _.fromFramebuffer=function(e){var r=(e=t(e,t.EMPTY_OBJECT)).context,i=r._gl,o=t(e.pixelFormat,s.RGB),a=t(e.framebufferXOffset,0),l=t(e.framebufferYOffset,0),u=t(e.width,i.drawingBufferWidth),c=t(e.height,i.drawingBufferHeight),h=e.framebuffer;return new _({context:r,width:u,height:c,pixelFormat:o,source:{framebuffer:n(h)?h:r.defaultFramebuffer,xOffset:a,yOffset:l,width:u,height:c}})},r(_.prototype,{sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,r=e.magnificationFilter;this._pixelDatatype===c.FLOAT&&(t=t===p.NEAREST_MIPMAP_NEAREST||t===p.NEAREST_MIPMAP_LINEAR||t===p.LINEAR_MIPMAP_NEAREST||t===p.LINEAR_MIPMAP_LINEAR?p.NEAREST_MIPMAP_NEAREST:p.NEAREST,r=d.NEAREST);var i=this._context._gl,o=this._textureTarget;i.activeTexture(i.TEXTURE0),i.bindTexture(o,this._texture),i.texParameteri(o,i.TEXTURE_MIN_FILTER,t),i.texParameteri(o,i.TEXTURE_MAG_FILTER,r),i.texParameteri(o,i.TEXTURE_WRAP_S,e.wrapS),i.texParameteri(o,i.TEXTURE_WRAP_T,e.wrapT),n(this._textureFilterAnisotropic)&&i.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),i.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},_target:{get:function(){return this._textureTarget}}}),_.prototype.copyFrom=function(e,n,r){n=t(n,0),r=t(r,0);var i=this._context._gl,o=this._textureTarget;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this._flipY),i.activeTexture(i.TEXTURE0),i.bindTexture(o,this._texture),e.arrayBufferView?i.texSubImage2D(o,0,n,r,e.width,e.height,this._pixelFormat,this._pixelDatatype,e.arrayBufferView):i.texSubImage2D(o,0,n,r,this._pixelFormat,this._pixelDatatype,e),i.bindTexture(o,null)},_.prototype.copyFromFramebuffer=function(e,n,r,i,o,a){e=t(e,0),n=t(n,0),r=t(r,0),i=t(i,0),o=t(o,this._width),a=t(a,this._height);var s=this._context._gl,l=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(l,this._texture),s.copyTexSubImage2D(l,0,e,n,r,i,o,a),s.bindTexture(l,null)},_.prototype.generateMipmap=function(e){e=t(e,u.DONT_CARE);var n=this._context._gl,r=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,e),n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture),n.generateMipmap(r),n.bindTexture(r,null)},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),i(this)},_}),o("Scene/TextureAtlas",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/loadImage","../Core/PixelFormat","../Core/RuntimeError","../Renderer/Framebuffer","../Renderer/RenderState","../Renderer/Texture","../ThirdParty/when"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e,n,i,o,a){this.bottomLeft=r(e,t.ZERO),this.topRight=r(n,t.ZERO),this.childNode1=i,this.childNode2=o,this.imageIndex=a}function _(e){e=r(e,r.EMPTY_OBJECT);var t=r(e.borderWidthInPixels,1),i=r(e.initialSize,g);this._context=e.context,this._pixelFormat=r(e.pixelFormat,u.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=n(),this._idHash={},this._initialSize=i,this._root=void 0}var g=new t(16,16);return o(_.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return i(this._texture)||(this._texture=new p({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),_.prototype.addImage=function(r,o){var a=this._idHash[r];if(i(a))return a;"function"==typeof o?o=o(r):"string"==typeof o&&(o=l(o));var s=this;return a=f(o,function(r){if(s.isDestroyed())return-1;var o=s.numberOfImages;return function r(o,a,s){var l=function e(n,r,o){if(i(r)){if(!i(r.childNode1)&&!i(r.childNode2)){if(i(r.imageIndex))return;var a=r.topRight.x-r.bottomLeft.x-o.width,s=r.topRight.y-r.bottomLeft.y-o.height;if(a<0||s<0)return;if(0===a&&0===s)return r;if(a>s){r.childNode1=new m(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.bottomLeft.x+o.width,r.topRight.y));var l=r.bottomLeft.x+o.width+n._borderWidthInPixels;l<r.topRight.x&&(r.childNode2=new m(new t(l,r.bottomLeft.y),new t(r.topRight.x,r.topRight.y)))}else{r.childNode1=new m(new t(r.bottomLeft.x,r.bottomLeft.y),new t(r.topRight.x,r.bottomLeft.y+o.height));var u=r.bottomLeft.y+o.height+n._borderWidthInPixels;u<r.topRight.y&&(r.childNode2=new m(new t(r.bottomLeft.x,u),new t(r.topRight.x,r.topRight.y)))}return e(n,r.childNode1,o)}return e(n,r.childNode1,o)||e(n,r.childNode2,o)}}(o,o._root,a);if(i(l)){l.imageIndex=s;var u=o._texture.width,c=o._texture.height;o._textureCoordinates[s]=new e(l.bottomLeft.x/u,l.bottomLeft.y/c,(l.topRight.x-l.bottomLeft.x)/u,(l.topRight.y-l.bottomLeft.y)/c),o._texture.copyFrom(a,l.bottomLeft.x,l.bottomLeft.y)}else(function(e,n){var r=e._context;if(e.numberOfImages>0){for(var o=e._texture.width,a=e._texture.height,s=2*(o+n.width+e._borderWidthInPixels),l=2*(a+n.height+e._borderWidthInPixels),u=o/s,c=a/l,d=new m(new t(o+e._borderWidthInPixels,0),new t(s,a)),f=new m(new t,new t(s,a),e._root,d),_=new m(new t(0,a+e._borderWidthInPixels),new t(s,l)),g=new m(new t,new t(s,l),f,_),v=0;v<e._textureCoordinates.length;v++){var y=e._textureCoordinates[v];i(y)&&(y.x*=u,y.y*=c,y.width*=u,y.height*=c)}var C=new p({context:e._context,width:s,height:l,pixelFormat:e._pixelFormat}),w=new h({context:r,colorTextures:[e._texture],destroyAttachments:!1});w._bind(),C.copyFromFramebuffer(0,0,0,0,s,l),w._unBind(),w.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=C,e._root=g}else{var b=2*(n.width+e._borderWidthInPixels),E=2*(n.height+e._borderWidthInPixels);b<e._initialSize.x&&(b=e._initialSize.x),E<e._initialSize.y&&(E=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new p({context:e._context,width:b,height:E,pixelFormat:e._pixelFormat}),e._root=new m(new t,new t(b,E))}})(o,a),r(o,a,s);o._guid=n()}(s,r,o),o}),this._idHash[r]=a,a},_.prototype.addSubRegion=function(t,r){var o=this._idHash[t];if(!i(o))throw new c('image with id "'+t+'" not found in the atlas.');var a=this;return f(o,function(t){if(-1===t)return-1;var i=a._texture.width,o=a._texture.height,s=a.numberOfImages,l=a._textureCoordinates[t];return a._textureCoordinates.push(new e(l.x+r.x/i,l.y+r.y/o,r.width/i,r.height/o)),a._guid=n(),s})},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),a(this)},_}),o("Scene/BillboardCollection",["../Core/AttributeCompression","../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/BillboardCollectionFS","../Shaders/BillboardCollectionVS","./Billboard","./BlendingState","./HeightReference","./HorizontalOrigin","./Pass","./SceneMode","./TextureAtlas","./VerticalOrigin"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I){"use strict";function O(e){e=a(e,a.EMPTY_OBJECT),this._scene=e.scene,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._rs=void 0,this._vaf=void 0,this._spPick=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._compiledShaderRotationPick=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._compiledShaderAlignedAxisPick=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._compiledShaderScaleByDistancePick=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistancePick=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistancePick=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayConditionPick=!1,this._propertiesChanged=new Uint32Array(ue),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new t,this._baseVolumeWC=new t,this._baseVolume2D=new t,this._boundingVolume=new t,this._boundingVolumeDirty=!1,this._colorCommands=[],this._pickCommands=[],this.modelMatrix=f.clone(a(e.modelMatrix,f.IDENTITY)),this._modelMatrix=f.clone(f.IDENTITY),this.debugShowBoundingVolume=a(e.debugShowBoundingVolume,!1),this._mode=D.SCENE3D,this._buffersUsage=[_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW,_.STATIC_DRAW];var n=this;this._uniforms={u_atlas:function(){return n._textureAtlas.texture}};var r=this._scene;s(r)&&(this._removeCallbackFunc=r.terrainProviderChanged.addEventListener(function(){for(var e=this._billboards,t=e.length,n=0;n<t;++n)e[n]._updateClamping()},this))}function R(e){for(var t=e.length,n=0;n<t;++n)e[n]&&e[n]._destroy()}function N(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;for(var t=[],n=e._billboards,r=n.length,i=0,o=0;i<r;++i){var a=n[i];a&&(a._index=o++,t.push(a))}e._billboards=t}}function L(e){var t=e.cache.billboardCollection_indexBufferBatched;if(s(t))return t;for(var n=new Uint16Array(98298),r=0,i=0;r<98298;r+=6,i+=4)n[r]=i,n[r+1]=i+1,n[r+2]=i+2,n[r+3]=i+0,n[r+4]=i+2,n[r+5]=i+3;return(t=m.createIndexBuffer({context:e,typedArray:n,usage:_.STATIC_DRAW,indexDatatype:d.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=t,t}function F(e){var t=e.cache.billboardCollection_indexBufferInstanced;return s(t)?t:((t=m.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:_.STATIC_DRAW,indexDatatype:d.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t,t)}function B(e,n,r,i,o){var a,s=i[q.positionHighAndScale],l=i[q.positionLowAndRotation],u=o._getActualPosition();e._mode===D.SCENE3D&&(t.expand(e._baseVolume,u,e._baseVolume),e._boundingVolumeDirty=!0),h.fromCartesian(u,de);var c=o.scale,d=o.rotation;0!==d&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,c);var p=de.high,f=de.low;e._instanced?(s(a=o._index,p.x,p.y,p.z,c),l(a,f.x,f.y,f.z,d)):(s(0+(a=4*o._index),p.x,p.y,p.z,c),s(a+1,p.x,p.y,p.z,c),s(a+2,p.x,p.y,p.z,c),s(a+3,p.x,p.y,p.z,c),l(a+0,f.x,f.y,f.z,d),l(a+1,f.x,f.y,f.z,d),l(a+2,f.x,f.y,f.z,d),l(a+3,f.x,f.y,f.z,d))}function k(t,n,r,i,o){var a,s=i[q.compressedAttribute0],l=o.pixelOffset,u=l.x,c=l.y,h=o._translate,d=h.x,f=h.y;t._maxPixelOffset=Math.max(t._maxPixelOffset,Math.abs(u+d),Math.abs(-c+f));var m=o.horizontalOrigin,_=o._verticalOrigin,g=o.show&&o.clusterShow;0===o.color.alpha&&(g=!1),t._allHorizontalCenter=t._allHorizontalCenter&&m===A.CENTER,t._allVerticalCenter=t._allVerticalCenter&&_===I.CENTER;var v=0,y=0,C=0,w=0,b=o._imageIndex;if(-1!==b){var E=r[b];v=E.x,y=E.y,C=E.width,w=E.height}var S=v+C,x=y+w,T=Math.floor(p.clamp(u,-fe,fe)+fe)*ge;T+=(m+1)*ve,T+=(_+1)*ye,T+=(g?1:0)*Ce;var P=Math.floor(p.clamp(c,-fe,fe)+fe)*_e,D=Math.floor(p.clamp(d,-fe,fe)+fe)*_e,M=(p.clamp(f,-fe,fe)+fe)*we,O=Math.floor(M);P+=O,D+=Math.floor((M-O)*_e),pe.x=v,pe.y=y;var R=e.compressTextureCoordinates(pe);pe.x=S;var N=e.compressTextureCoordinates(pe);pe.y=x;var L=e.compressTextureCoordinates(pe);pe.x=v;var F=e.compressTextureCoordinates(pe);t._instanced?s(a=o._index,T,P,D,R):(s(0+(a=4*o._index),T+be,P,D,R),s(a+1,T+Ee,P,D,N),s(a+2,T+Se,P,D,L),s(a+3,T+xe,P,D,F))}function V(t,n,i,o,l){var u,c=o[q.compressedAttribute1],h=l.alignedAxis;r.equals(h,r.ZERO)||(t._shaderAlignedAxis=!0);var d=0,f=1,m=1,_=1,g=l.translucencyByDistance;s(g)&&(d=g.near,m=g.far,_=g.farValue,1===(f=g.nearValue)&&1===_||(t._shaderTranslucencyByDistance=!0));var v=0,y=l._imageIndex;-1!==y&&(v=i[y].width);var C=Math.ceil(.5*a(l.width,t._textureAtlas.texture.width*v));t._maxSize=Math.max(t._maxSize,C);var w=p.clamp(C,0,me),b=0;Math.abs(r.magnitudeSquared(h)-1)<p.EPSILON6&&(b=e.octEncodeFloat(h)),f=p.clamp(f,0,1),w=w*_e+(f=1===f?255:255*f|0),_=p.clamp(_,0,1),b=b*_e+(_=1===_?255:255*_|0),t._instanced?c(u=l._index,w,b,d,m):(c(0+(u=4*l._index),w,b,d,m),c(u+1,w,b,d,m),c(u+2,w,b,d,m),c(u+3,w,b,d,m))}function z(e,t,n,o,s){var l,u=o[q.compressedAttribute2],c=s.color,h=s.getPickId(t).color,d=s.sizeInMeters?1:0,f=Math.abs(r.magnitudeSquared(s.alignedAxis)-1)<p.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&1===d;var m=0,_=s._imageIndex;-1!==_&&(m=n[_].height);var g=Math.ceil(.5*a(s.height,e._textureAtlas.texture.dimensions.y*m));e._maxSize=Math.max(e._maxSize,g);var v=i.floatToByte(c.red),y=i.floatToByte(c.green),C=i.floatToByte(c.blue),w=v*me+y*_e+C;v=i.floatToByte(h.red),y=i.floatToByte(h.green),C=i.floatToByte(h.blue);var b=v*me+y*_e+C,E=i.floatToByte(c.alpha)*me+i.floatToByte(h.alpha)*_e;E+=2*d+f,e._instanced?u(l=s._index,w,b,E,g):(u(0+(l=4*s._index),w,b,E,g),u(l+1,w,b,E,g),u(l+2,w,b,E,g),u(l+3,w,b,E,g))}function U(t,n,r,i,o){var a,s=i[q.eyeOffset],l=o.eyeOffset,u=l.z;if(o._heightReference!==T.NONE&&(u*=1.005),t._maxEyeOffset=Math.max(t._maxEyeOffset,Math.abs(l.x),Math.abs(l.y),Math.abs(u)),t._instanced){var c=0,h=0,d=o._imageIndex;if(-1!==d){var p=r[d];c=p.width,h=p.height}pe.x=c,pe.y=h;var f=e.compressTextureCoordinates(pe);s(a=o._index,l.x,l.y,u,f)}else a=4*o._index,s(a+0,l.x,l.y,u,0),s(a+1,l.x,l.y,u,0),s(a+2,l.x,l.y,u,0),s(a+3,l.x,l.y,u,0)}function G(e,t,n,r,i){var o,a=r[q.scaleByDistance],l=0,u=1,c=1,h=1,d=i.scaleByDistance;s(d)&&(l=d.near,c=d.far,h=d.farValue,1===(u=d.nearValue)&&1===h||(e._shaderScaleByDistance=!0)),e._instanced?a(o=i._index,l,u,c,h):(a(0+(o=4*i._index),l,u,c,h),a(o+1,l,u,c,h),a(o+2,l,u,c,h),a(o+3,l,u,c,h))}function W(e,t,n,r,i){var o,a=r[q.pixelOffsetScaleByDistance],l=0,u=1,c=1,h=1,d=i.pixelOffsetScaleByDistance;s(d)&&(l=d.near,c=d.far,h=d.farValue,1===(u=d.nearValue)&&1===h||(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?a(o=i._index,l,u,c,h):(a(0+(o=4*i._index),l,u,c,h),a(o+1,l,u,c,h),a(o+2,l,u,c,h),a(o+3,l,u,c,h))}function H(e,t,n,r,i){var o,a=r[q.distanceDisplayCondition],l=0,u=Number.MAX_VALUE,c=i.distanceDisplayCondition;s(c)&&(l=c.near,u=c.far,e._shaderDistanceDisplayCondition=!0),e._instanced?a(o=i._index,l,u):(a(0+(o=4*i._index),l,u),a(o+1,l,u),a(o+2,l,u),a(o+3,l,u))}function j(e,n,r,i,o,a){var l;i.mode===D.SCENE3D?(l=e._baseVolume,e._boundingVolumeDirty=!0):l=e._baseVolume2D;for(var u=[],c=0;c<r;++c){var h=n[c],d=S._computeActualPosition(h,h.position,i,o);s(d)&&(h._setActualPosition(d),a?u.push(d):t.expand(l,d,l))}a&&t.fromPoints(u,l)}var q,Y,X=S.SHOW_INDEX,Z=S.POSITION_INDEX,K=S.PIXEL_OFFSET_INDEX,Q=S.EYE_OFFSET_INDEX,J=S.HORIZONTAL_ORIGIN_INDEX,$=S.VERTICAL_ORIGIN_INDEX,ee=S.SCALE_INDEX,te=S.IMAGE_INDEX_INDEX,ne=S.COLOR_INDEX,re=S.ROTATION_INDEX,ie=S.ALIGNED_AXIS_INDEX,oe=S.SCALE_BY_DISTANCE_INDEX,ae=S.TRANSLUCENCY_BY_DISTANCE_INDEX,se=S.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,le=S.DISTANCE_DISPLAY_CONDITION_INDEX,ue=S.NUMBER_OF_PROPERTIES,ce={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,distanceDisplayCondition:8},he={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,distanceDisplayCondition:9};l(O.prototype,{length:{get:function(){return N(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}}),O.prototype.add=function(e){var t=new S(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t},O.prototype.remove=function(e){return!!this.contains(e)&&(this._billboards[e._index]=null,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},O.prototype.removeAll=function(){R(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},O.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]},O.prototype.contains=function(e){return s(e)&&e._billboardCollection===this},O.prototype.get=function(e){return N(this),this._billboards[e]},O.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,n=this._propertiesChanged,r=0;r<ue;++r){var i=0===n[r]?_.STATIC_DRAW:_.STREAM_DRAW;t=t||e[r]!==i,e[r]=i}return t};var de=new h,pe=new n,fe=32768,me=65536,_e=256,ge=128,ve=32,ye=8,Ce=4,we=1/256,be=0,Ee=2,Se=3,xe=1,Te=[];return O.prototype.update=function(e){N(this);var n=this._billboards,r=n.length,i=e.context;this._instanced=i.instancedArrays,q=this._instanced?he:ce,Y=this._instanced?F:L;var a=this._textureAtlas;if(!s(a)){a=this._textureAtlas=new M({context:i});for(var l=0;l<r;++l)n[l]._loadImage()}var u,c,h,d,p,S,T,A,I,O,R,de,pe,fe,me,_e,ge,ve,ye=a.textureCoordinates;if(0!==ye.length){A=(T=e).mode,I=(S=this)._billboards,O=S._billboardsToUpdate,R=S._modelMatrix,S._createVertexArray||S._mode!==A||A!==D.SCENE3D&&!f.equals(R,S.modelMatrix)?(S._mode=A,f.clone(S.modelMatrix,R),S._createVertexArray=!0,A!==D.SCENE3D&&A!==D.SCENE2D&&A!==D.COLUMBUS_VIEW||j(S,I,I.length,T,R,!0)):A===D.MORPHING?j(S,I,I.length,T,R,!0):A!==D.SCENE2D&&A!==D.COLUMBUS_VIEW||j(S,O,S._billboardsToUpdateIndex,T,R,!1),r=(n=this._billboards).length;var Ce=this._billboardsToUpdate,we=this._billboardsToUpdateIndex,be=this._propertiesChanged,Ee=a.guid,Se=this._createVertexArray||this._textureAtlasGUID!==Ee;this._textureAtlasGUID=Ee;var xe,Ae=e.passes,Pe=Ae.pick;if(Se||!Pe&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var De=0;De<ue;++De)be[De]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),r>0){this._vaf=(de=i,pe=r,ve=[{index:q.positionHighAndScale,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:(fe=this._buffersUsage)[Z]},{index:q.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[Z]},{index:q.compressedAttribute0,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[K]},{index:q.compressedAttribute1,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[ae]},{index:q.compressedAttribute2,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[ne]},{index:q.eyeOffset,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[Q]},{index:q.scaleByDistance,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[oe]},{index:q.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:o.FLOAT,usage:fe[se]},{index:q.distanceDisplayCondition,componentsPerAttribute:2,componentDatatype:o.FLOAT,usage:fe[le]}],(me=this._instanced)&&ve.push({index:q.direction,componentsPerAttribute:2,componentDatatype:o.FLOAT,vertexBuffer:(_e=de,ge=_e.cache.billboardCollection_vertexBufferInstanced,s(ge)?ge:((ge=m.createVertexBuffer({context:_e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:_.STATIC_DRAW})).vertexArrayDestroyable=!1,_e.cache.billboardCollection_vertexBufferInstanced=ge,ge))}),new w(de,ve,me?pe:4*pe,me)),xe=this._vaf.writers;for(var Me=0;Me<r;++Me){var Ie=this._billboards[Me];Ie._dirty=!1,c=i,h=ye,B(u=this,0,0,d=xe,p=Ie),k(u,0,h,d,p),V(u,0,h,d,p),z(u,c,h,d,p),U(u,0,h,d,p),G(u,0,0,d,p),W(u,0,0,d,p),H(u,0,0,d,p)}this._vaf.commit(Y(i))}this._billboardsToUpdateIndex=0}else if(we>0){var Oe=Te;Oe.length=0,(be[Z]||be[re]||be[ee])&&Oe.push(B),(be[te]||be[K]||be[J]||be[$]||be[X])&&(Oe.push(k),this._instanced&&Oe.push(U)),(be[te]||be[ie]||be[ae])&&(Oe.push(V),Oe.push(z)),(be[te]||be[ne])&&Oe.push(z),be[Q]&&Oe.push(U),be[oe]&&Oe.push(G),be[se]&&Oe.push(W),be[le]&&Oe.push(H);var Re=Oe.length;if(xe=this._vaf.writers,we/r>.1){for(var Ne=0;Ne<we;++Ne){var Le=Ce[Ne];Le._dirty=!1;for(var Fe=0;Fe<Re;++Fe)Oe[Fe](this,i,ye,xe,Le)}this._vaf.commit(Y(i))}else{for(var Be=0;Be<we;++Be){var ke=Ce[Be];ke._dirty=!1;for(var Ve=0;Ve<Re;++Ve)Oe[Ve](this,i,ye,xe,ke);this._instanced?this._vaf.subCommit(ke._index,1):this._vaf.subCommit(4*ke._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(we>1.5*r&&(Ce.length=r),s(this._vaf)&&s(this._vaf.va)){this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,t.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var ze,Ue=f.IDENTITY;e.mode===D.SCENE3D?(Ue=this.modelMatrix,ze=t.clone(this._baseVolumeWC,this._boundingVolume)):ze=t.clone(this._baseVolume2D,this._boundingVolume),function(t,n,r){var i=1;t._allSizedInMeters&&0===t._maxPixelOffset||(i=e.camera.getPixelSize(r,e.context.drawingBufferWidth,e.context.drawingBufferHeight));var o=i*t._maxScale*t._maxSize*2;t._allHorizontalCenter&&t._allVerticalCenter&&(o*=.5),r.radius+=o+(i*t._maxPixelOffset+t._maxEyeOffset)}(this,0,ze);var Ge,We,He,je,qe,Ye,Xe=e.commandList;if(Ae.render){var Ze=this._colorCommands;for(s(this._rs)||(this._rs=v.fromCache({depthTest:{enabled:!0},blending:x.ALPHA_BLEND})),s(this._sp)&&this._shaderRotation===this._compiledShaderRotation&&this._shaderAlignedAxis===this._compiledShaderAlignedAxis&&this._shaderScaleByDistance===this._compiledShaderScaleByDistance&&this._shaderTranslucencyByDistance===this._compiledShaderTranslucencyByDistance&&this._shaderPixelOffsetScaleByDistance===this._compiledShaderPixelOffsetScaleByDistance&&this._shaderDistanceDisplayCondition===this._compiledShaderDistanceDisplayCondition||(je=new C({sources:[E]}),this._instanced&&je.defines.push("INSTANCED"),this._shaderRotation&&je.defines.push("ROTATION"),this._shaderAlignedAxis&&je.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&je.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&je.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&je.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&je.defines.push("DISTANCE_DISPLAY_CONDITION"),this._sp=y.replaceCache({context:i,shaderProgram:this._sp,vertexShaderSource:je,fragmentShaderSource:b,attributeLocations:q}),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition),Ze.length=We=(Ge=this._vaf.va).length,Ye=0;Ye<We;++Ye)He=Ze[Ye],s(He)||(He=Ze[Ye]=new g({pass:P.OPAQUE,owner:this})),He.boundingVolume=ze,He.modelMatrix=Ue,He.count=Ge[Ye].indicesCount,He.shaderProgram=this._sp,He.uniformMap=this._uniforms,He.vertexArray=Ge[Ye].va,He.renderState=this._rs,He.debugShowBoundingVolume=this.debugShowBoundingVolume,this._instanced&&(He.count=6,He.instanceCount=r),Xe.push(He)}if(Pe){var Ke=this._pickCommands;for(s(this._spPick)&&this._shaderRotation===this._compiledShaderRotationPick&&this._shaderAlignedAxis===this._compiledShaderAlignedAxisPick&&this._shaderScaleByDistance===this._compiledShaderScaleByDistancePick&&this._shaderTranslucencyByDistance===this._compiledShaderTranslucencyByDistancePick&&this._shaderPixelOffsetScaleByDistance===this._compiledShaderPixelOffsetScaleByDistancePick&&this._shaderDistanceDisplayCondition===this._compiledShaderDistanceDisplayConditionPick||(je=new C({defines:["RENDER_FOR_PICK"],sources:[E]}),this._instanced&&je.defines.push("INSTANCED"),this._shaderRotation&&je.defines.push("ROTATION"),this._shaderAlignedAxis&&je.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&je.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&je.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&je.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&je.defines.push("DISTANCE_DISPLAY_CONDITION"),qe=new C({defines:["RENDER_FOR_PICK"],sources:[b]}),this._spPick=y.replaceCache({context:i,shaderProgram:this._spPick,vertexShaderSource:je,fragmentShaderSource:qe,attributeLocations:q}),this._compiledShaderRotationPick=this._shaderRotation,this._compiledShaderAlignedAxisPick=this._shaderAlignedAxis,this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistancePick=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition),Ke.length=We=(Ge=this._vaf.va).length,Ye=0;Ye<We;++Ye)He=Ke[Ye],s(He)||(He=Ke[Ye]=new g({pass:P.OPAQUE,owner:this})),He.boundingVolume=ze,He.modelMatrix=Ue,He.count=Ge[Ye].indicesCount,He.shaderProgram=this._spPick,He.uniformMap=this._uniforms,He.vertexArray=Ge[Ye].va,He.renderState=this._rs,this._instanced&&(He.count=6,He.instanceCount=r),Xe.push(He)}}}},O.prototype.isDestroyed=function(){return!1},O.prototype.destroy=function(){return s(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),R(this._billboards),u(this)},O}),o("Scene/LabelStyle",["../Core/freezeObject"],function(e){"use strict";return e({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2})}),o("Scene/Label",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","./Billboard","./HeightReference","./HorizontalOrigin","./LabelStyle","./VerticalOrigin"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function _(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function g(e,o){e=i(e,i.EMPTY_OBJECT),this._text=i(e.text,""),this._show=i(e.show,!0),this._font=i(e.font,"30px sans-serif"),this._fillColor=r.clone(i(e.fillColor,r.WHITE)),this._outlineColor=r.clone(i(e.outlineColor,r.BLACK)),this._outlineWidth=i(e.outlineWidth,1),this._style=i(e.style,p.FILL),this._verticalOrigin=i(e.verticalOrigin,f.BOTTOM),this._horizontalOrigin=i(e.horizontalOrigin,d.LEFT),this._pixelOffset=t.clone(i(e.pixelOffset,t.ZERO)),this._eyeOffset=n.clone(i(e.eyeOffset,n.ZERO)),this._position=n.clone(i(e.position,n.ZERO)),this._scale=i(e.scale,1),this._id=e.id,this._translucencyByDistance=e.translucencyByDistance,this._pixelOffsetScaleByDistance=e.pixelOffsetScaleByDistance,this._heightReference=i(e.heightReference,h.NONE),this._distanceDisplayCondition=e.distanceDisplayCondition,this._labelCollection=o,this._glyphs=[],this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this._updateClamping()}return a(g.prototype,{show:{get:function(){return this._show},set:function(e){if(this._show!==e){this._show=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n].billboard;o(i)&&(i.show=e)}}}},position:{get:function(){return this._position},set:function(e){var t=this._position;if(!n.equals(t,e)){n.clone(e,t);for(var r=this._glyphs,i=0,a=r.length;i<a;i++){var s=r[i].billboard;o(s)&&(s.position=e)}this._heightReference!==h.NONE&&this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(e!==this._heightReference){this._heightReference=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n].billboard;o(i)&&(i.heightReference=e)}_(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){this._text!==e&&(this._text=e,m(this))}},font:{get:function(){return this._font},set:function(e){this._font!==e&&(this._font=e,m(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){var t=this._fillColor;r.equals(t,e)||(r.clone(e,t),m(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){var t=this._outlineColor;r.equals(t,e)||(r.clone(e,t),m(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,m(this))}},style:{get:function(){return this._style},set:function(e){this._style!==e&&(this._style=e,m(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){var n=this._pixelOffset;if(!t.equals(n,e)){t.clone(e,n);for(var r=this._glyphs,i=0,a=r.length;i<a;i++){var s=r[i];o(s.billboard)&&(s.billboard.pixelOffset=e)}}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){var t=this._translucencyByDistance;if(!u.equals(t,e)){this._translucencyByDistance=u.clone(e,t);for(var n=this._glyphs,r=0,i=n.length;r<i;r++){var a=n[r];o(a.billboard)&&(a.billboard.translucencyByDistance=e)}}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){var t=this._pixelOffsetScaleByDistance;if(!u.equals(t,e)){this._pixelOffsetScaleByDistance=u.clone(e,t);for(var n=this._glyphs,r=0,i=n.length;r<i;r++){var a=n[r];o(a.billboard)&&(a.billboard.pixelOffsetScaleByDistance=e)}}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){var t=this._eyeOffset;if(!n.equals(t,e)){n.clone(e,t);for(var r=this._glyphs,i=0,a=r.length;i<a;i++){var s=r[i];o(s.billboard)&&(s.billboard.eyeOffset=e)}}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){this._horizontalOrigin!==e&&(this._horizontalOrigin=e,_(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(this._verticalOrigin!==e){this._verticalOrigin=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n];o(i.billboard)&&(i.billboard.verticalOrigin=e)}_(this)}}},scale:{get:function(){return this._scale},set:function(e){if(this._scale!==e){this._scale=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n];o(i.billboard)&&(i.billboard.scale=e)}_(this)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!l.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=l.clone(e,this._distanceDisplayCondition);for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n];o(i.billboard)&&(i.billboard.distanceDisplayCondition=e)}}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n];o(i.billboard)&&(i.billboard.id=e)}}}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=n.clone(e,this._actualClampedPosition);for(var t=this._glyphs,r=0,a=t.length;r<a;r++){var s=t[r];o(s.billboard)&&(s.billboard._clampedPosition=e,e=i(e,this._position),n.clone(e,s.billboard._position),n.clone(e,s.billboard._actualPosition))}}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;for(var t=this._glyphs,n=0,r=t.length;n<r;n++){var i=t[n];o(i.billboard)&&(i.billboard.clusterShow=e)}}}}}),g.prototype._updateClamping=function(){c._updateClamping(this._labelCollection,this)},g.prototype.computeScreenSpacePosition=function(e,n){o(n)||(n=new t);var r=this._labelCollection.modelMatrix,i=o(this._actualClampedPosition)?this._actualClampedPosition:this._position;return c._computeScreenSpacePosition(r,i,this._eyeOffset,this._pixelOffset,e,n)},g.getScreenSpaceBoundingBox=function(t,n,r){for(var i=0,a=0,s=t._glyphs,l=s.length,u=0;u<l;++u){var c=s[u].billboard;o(c)&&(i+=c.width,a=Math.max(a,c.height))}var h=t.scale;i*=h,a*=h;var p=n.x;t.horizontalOrigin===d.RIGHT?p-=i:t.horizontalOrigin===d.CENTER&&(p-=.5*i);var m=n.y;return t.verticalOrigin===f.TOP?m-=a:t.verticalOrigin===f.CENTER&&(m-=.5*a),o(r)||(r=new e),r.x=p,r.y=m,r.width=i,r.height=a,r},g.prototype.equals=function(e){return this===e||o(e)&&this._show===e._show&&this._scale===e._scale&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._text===e._text&&this._font===e._font&&n.equals(this._position,e._position)&&r.equals(this._fillColor,e._fillColor)&&r.equals(this._outlineColor,e._outlineColor)&&t.equals(this._pixelOffset,e._pixelOffset)&&n.equals(this._eyeOffset,e._eyeOffset)&&u.equals(this._translucencyByDistance,e._translucencyByDistance)&&u.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&l.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._id===e._id},g.prototype.isDestroyed=function(){return!1},g}),o("Scene/LabelCollection",["../Core/Cartesian2","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/writeTextToCanvas","./BillboardCollection","./HeightReference","./HorizontalOrigin","./Label","./LabelStyle","./TextureAtlas","./VerticalOrigin"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function _(e,t,n){this.labelCollection=e,this.index=t,this.dimensions=n}function g(e,t){t.textureInfo=void 0,t.dimensions=void 0;var r=t.billboard;n(r)&&(r.show=!1,r.image=void 0,e._spareBillboards.push(r),t.billboard=void 0)}function v(e,t,n,r){e.addImage(t,n).then(function(e,t){r.index=e})}function y(e,t){var r,i,o,a=t._text,l=a.length,u=t._glyphs,h=u.length;if(l<h)for(i=l;i<h;++i)g(e,u[i]);u.length=l;var p,y,C,w,b,S,x=e._glyphTextureCache;for(o=0;o<l;++o){var T=a.charAt(o),A=t._font,P=t._fillColor,D=t._outlineColor,M=t._outlineWidth,I=t._style,O=t._verticalOrigin,R=JSON.stringify([T,A,P.toRgba(),D.toRgba(),M,+I,+O]),N=x[R];if(!n(N)){var L=(p=T,y=P,C=D,w=M,b=I,S=O,E.font=A,E.fillColor=y,E.strokeColor=C,E.strokeWidth=w,E.textBaseline=S===f.BOTTOM?"bottom":S===f.TOP?"top":"middle",E.fill=b===d.FILL||b===d.FILL_AND_OUTLINE,E.stroke=b===d.OUTLINE||b===d.FILL_AND_OUTLINE,s(p,E));N=new _(e,-1,L.dimensions),x[R]=N,L.width>0&&L.height>0&&v(e._textureAtlas,R,L,N)}if(n(r=u[o])?-1===N.index?g(e,r):n(r.textureInfo)&&(r.textureInfo=void 0):(r=new m,u[o]=r),r.textureInfo=N,r.dimensions=N.dimensions,-1!==N.index){var F=r.billboard;n(F)||(F=e._spareBillboards.length>0?e._spareBillboards.pop():e._billboardCollection.add({collection:e}),r.billboard=F),F.show=t._show,F.position=t._position,F.eyeOffset=t._eyeOffset,F.pixelOffset=t._pixelOffset,F.horizontalOrigin=c.LEFT,F.verticalOrigin=t._verticalOrigin,F.heightReference=t._heightReference,F.scale=t._scale,F.pickPrimitive=t,F.id=t._id,F.image=R,F.translucencyByDistance=t._translucencyByDistance,F.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,F.distanceDisplayCondition=t._distanceDisplayCondition}}t._repositionAllGlyphs=!0}function C(e,t){var r,i,o=e._glyphs,a=0,s=0,l=0,u=o.length;for(l=0;l<u;++l)r=o[l],i=r.dimensions,a+=i.computedWidth,s=Math.max(s,i.height);var h=e._scale,d=e._horizontalOrigin,p=0;d===c.CENTER?p-=a/2*h:d===c.RIGHT&&(p-=a*h),S.x=p*t,S.y=0;var m=e._verticalOrigin;for(l=0;l<u;++l)r=o[l],i=r.dimensions,m===f.BOTTOM||i.height===s?S.y=-i.descent*h:m===f.TOP?S.y=-(s-i.height)*h-i.descent*h:m===f.CENTER&&(S.y=-(s-i.height)/2*h-i.descent*h),S.y*=t,n(r.billboard)&&r.billboard._setTranslate(S),S.x+=i.computedWidth*h*t}function w(e,t){for(var r=t._glyphs,o=0,a=r.length;o<a;++o)g(e,r[o]);t._labelCollection=void 0,n(t._removeCallbackFunc)&&t._removeCallbackFunc(),i(t)}function b(e){e=t(e,t.EMPTY_OBJECT),this._scene=e.scene,this._textureAtlas=void 0,this._billboardCollection=new l({scene:this._scene}),this._billboardCollection.destroyTextureAtlas=!1,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._resolutionScale=void 0,this.modelMatrix=a.clone(t(e.modelMatrix,a.IDENTITY)),this.debugShowBoundingVolume=t(e.debugShowBoundingVolume,!1)}var E={},S=new e;return r(b.prototype,{length:{get:function(){return this._labels.length}}}),b.prototype.add=function(e){var t=new h(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t},b.prototype.remove=function(e){if(n(e)&&e._labelCollection===this){var t=this._labels.indexOf(e);if(-1!==t)return this._labels.splice(t,1),w(this,e),!0}return!1},b.prototype.removeAll=function(){for(var e=this._labels,t=0,n=e.length;t<n;++t)w(this,e[t]);e.length=0},b.prototype.contains=function(e){return n(e)&&e._labelCollection===this},b.prototype.get=function(e){return this._labels[e]},b.prototype.update=function(e){var t=this._billboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume;var r=e.context;n(this._textureAtlas)||(this._textureAtlas=new p({context:r}),t.textureAtlas=this._textureAtlas);var i,o=r.uniformState.resolutionScale,a=this._resolutionScale!==o;this._resolutionScale=o;for(var s=(i=a?this._labels:this._labelsToUpdate).length,l=0;l<s;++l){var u=i[l];if(!u.isDestroyed()){var c=u._glyphs.length;u._rebindAllGlyphs&&(y(this,u),u._rebindAllGlyphs=!1),(a||u._repositionAllGlyphs)&&(C(u,o),u._repositionAllGlyphs=!1),this._totalGlyphCount+=u._glyphs.length-c}}this._labelsToUpdate.length=0,t.update(e)},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),i(this)},b}),o("Scene/PointPrimitive",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/NearFarScalar","./SceneMode","./SceneTransforms"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(e,t){e=o(e,o.EMPTY_OBJECT),this._show=o(e.show,!0),this._position=n.clone(o(e.position,n.ZERO)),this._actualPosition=n.clone(this._position),this._color=i.clone(o(e.color,i.WHITE)),this._outlineColor=i.clone(o(e.outlineColor,i.TRANSPARENT)),this._outlineWidth=o(e.outlineWidth,0),this._pixelSize=o(e.pixelSize,10),this._scaleByDistance=e.scaleByDistance,this._translucencyByDistance=e.translucencyByDistance,this._distanceDisplayCondition=e.distanceDisplayCondition,this._id=e.id,this._collection=o(e.collection,t),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1}function m(e,t){var n=e._pointPrimitiveCollection;a(n)&&(n._updatePointPrimitive(e,t),e._dirty=!0)}var _=f.SHOW_INDEX=0,g=f.POSITION_INDEX=1,v=f.COLOR_INDEX=2,y=f.OUTLINE_COLOR_INDEX=3,C=f.OUTLINE_WIDTH_INDEX=4,w=f.PIXEL_SIZE_INDEX=5,b=f.SCALE_BY_DISTANCE_INDEX=6,E=f.TRANSLUCENCY_BY_DISTANCE_INDEX=7,S=f.DISTANCE_DISPLAY_CONDITION=8;f.NUMBER_OF_PROPERTIES=9,s(f.prototype,{show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,m(this,_))}},position:{get:function(){return this._position},set:function(e){var t=this._position;n.equals(t,e)||(n.clone(e,t),n.clone(e,this._actualPosition),m(this,g))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){var t=this._scaleByDistance;h.equals(t,e)||(this._scaleByDistance=h.clone(e,t),m(this,b))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){var t=this._translucencyByDistance;h.equals(t,e)||(this._translucencyByDistance=h.clone(e,t),m(this,E))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){this._pixelSize!==e&&(this._pixelSize=e,m(this,w))}},color:{get:function(){return this._color},set:function(e){var t=this._color;i.equals(t,e)||(i.clone(e,t),m(this,v))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){var t=this._outlineColor;i.equals(t,e)||(i.clone(e,t),m(this,y))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){this._outlineWidth!==e&&(this._outlineWidth=e,m(this,C))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){u.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=u.clone(e,this._distanceDisplayCondition),m(this,S))}},id:{get:function(){return this._id},set:function(e){this._id=e,a(this._pickId)&&(this._pickId.object.id=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,m(this,_))}}}),f.prototype.getPickId=function(e){return a(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},f.prototype._getActualPosition=function(){return this._actualPosition},f.prototype._setActualPosition=function(e){n.clone(e,this._actualPosition),m(this,g)};var x=new r;f._computeActualPosition=function(e,t,n){return t.mode===d.SCENE3D?e:(c.multiplyByPoint(n,e,x),p.computeActualWgs84Position(t,x))};var T=new r;return f._computeScreenSpacePosition=function(e,t,n,i){var o=c.multiplyByVector(e,r.fromElements(t.x,t.y,t.z,1,T),T);return p.wgs84ToWindowCoordinates(n,o,i)},f.prototype.computeScreenSpacePosition=function(e,n){var r=this._pointPrimitiveCollection;a(n)||(n=new t);var i=f._computeScreenSpacePosition(r.modelMatrix,this._actualPosition,e,n);if(a(i))return i.y=e.canvas.clientHeight-i.y,i},f.getScreenSpaceBoundingBox=function(t,n,r){var i=t.pixelSize,o=.5*i,s=n.x-o,l=n.y-o,u=i,c=i;return a(r)||(r=new e),r.x=s,r.y=l,r.width=u,r.height=c,r},f.prototype.equals=function(e){return this===e||a(e)&&this._id===e._id&&n.equals(this._position,e._position)&&i.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&i.equals(this._outlineColor,e._outlineColor)&&h.equals(this._scaleByDistance,e._scaleByDistance)&&h.equals(this._translucencyByDistance,e._translucencyByDistance)&&u.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)},f.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0},f}),o("Shaders/PointPrimitiveCollectionFS",[],function(){"use strict";return"varying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nvoid main()\n{\nfloat distanceToCenter = length(gl_PointCoord - vec2(0.5));\nfloat maxDistance = max(0.0, 0.5 - v_pixelDistance);\nfloat wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\nfloat innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\nvec4 color = mix(v_outlineColor, v_color, innerAlpha);\ncolor.a *= wholeAlpha;\nif (color.a < 0.005)\n{\ndiscard;\n}\n#ifdef RENDER_FOR_PICK\ngl_FragColor = v_pickColor;\n#else\ngl_FragColor = color;\n#endif\n}\n"}),o("Shaders/PointPrimitiveCollectionVS",[],function(){"use strict";return"uniform float u_maxTotalPointSize;\nattribute vec4 positionHighAndSize;\nattribute vec4 positionLowAndOutline;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 scaleByDistance;\nattribute vec2 distanceDisplayCondition;\nvarying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\n#ifdef RENDER_FOR_PICK\nvarying vec4 v_pickColor;\n#endif\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nvoid main()\n{\nvec3 positionHigh = positionHighAndSize.xyz;\nvec3 positionLow = positionLowAndOutline.xyz;\nfloat outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\nfloat totalSize = positionHighAndSize.w + outlineWidthBothSides;\nfloat outlinePercent = outlineWidthBothSides / totalSize;\ntotalSize *= czm_resolutionScale;\ntotalSize += 3.0;\nfloat temp = compressedAttribute1.x * SHIFT_RIGHT8;\nfloat show = floor(temp);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\nvec4 color;\nvec4 outlineColor;\n#ifdef RENDER_FOR_PICK\ncolor = vec4(0.0);\noutlineColor = vec4(0.0);\nvec4 pickColor;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\npickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor.r = floor(temp);\n#else\ntemp = compressedAttribute0.x * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute0.y * SHIFT_RIGHT8;\noutlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor.r = floor(temp);\n#endif\ntemp = compressedAttribute0.w * SHIFT_RIGHT8;\n#ifdef RENDER_FOR_PICK\npickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor = pickColor / 255.0;\n#endif\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor /= 255.0;\ncolor.a = floor(temp);\ncolor /= 255.0;\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\ntotalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\ntotalSize = min(totalSize, u_maxTotalPointSize);\nif (totalSize < 1.0)\n{\npositionEC.xyz = vec3(0.0);\ntotalSize = 1.0;\n}\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency < 0.004)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq) {\npositionEC.xyz = vec3(0.0);\n}\n#endif\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\nv_color = color;\nv_color.a *= translucency;\nv_outlineColor = outlineColor;\nv_outlineColor.a *= translucency;\nv_innerPercent = 1.0 - outlinePercent;\nv_pixelDistance = 2.0 / totalSize;\ngl_PointSize = totalSize;\n#ifdef RENDER_FOR_PICK\nv_pickColor = pickColor;\n#endif\n}\n"}),o("Scene/PointPrimitiveCollection",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix4","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArrayFacade","../Shaders/PointPrimitiveCollectionFS","../Shaders/PointPrimitiveCollectionVS","./BlendingState","./Pass","./PointPrimitive","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T){"use strict";function A(t){t=o(t,o.EMPTY_OBJECT),this._sp=void 0,this._rs=void 0,this._vaf=void 0,this._spPick=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._compiledShaderScaleByDistancePick=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistancePick=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayConditionPick=!1,this._propertiesChanged=new Uint32Array(j),this._maxPixelSize=1,this._baseVolume=new e,this._baseVolumeWC=new e,this._baseVolume2D=new e,this._boundingVolume=new e,this._boundingVolumeDirty=!1,this._colorCommands=[],this._pickCommands=[],this.modelMatrix=d.clone(o(t.modelMatrix,d.IDENTITY)),this._modelMatrix=d.clone(d.IDENTITY),this.debugShowBoundingVolume=o(t.debugShowBoundingVolume,!1),this._mode=T.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW,f.STATIC_DRAW];var n=this;this._uniforms={u_maxTotalPointSize:function(){return n._maxTotalPointSize}}}function P(e){for(var t=e.length,n=0;n<t;++n)e[n]&&e[n]._destroy()}function D(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;for(var t=[],n=e._pointPrimitives,r=n.length,i=0,o=0;i<r;++i){var a=n[i];a&&(a._index=o++,t.push(a))}e._pointPrimitives=t}}function M(t,n,r,i){var o=i._index,a=i._getActualPosition();t._mode===T.SCENE3D&&(e.expand(t._baseVolume,a,t._baseVolume),t._boundingVolumeDirty=!0),c.fromCartesian(a,Y);var s=i.pixelSize,l=i.outlineWidth;t._maxPixelSize=Math.max(t._maxPixelSize,s+l);var u=Y.high;(0,r[q.positionHighAndSize])(o,u.x,u.y,u.z,s);var h=Y.low;(0,r[q.positionLowAndOutline])(o,h.x,h.y,h.z,l)}function I(e,t,n,i){var o=i._index,a=i.color,s=i.getPickId(t).color,l=i.outlineColor,u=r.floatToByte(a.red),c=r.floatToByte(a.green),h=r.floatToByte(a.blue),d=u*X+c*Z+h;u=r.floatToByte(l.red),c=r.floatToByte(l.green),h=r.floatToByte(l.blue);var p=u*X+c*Z+h;u=r.floatToByte(s.red),c=r.floatToByte(s.green),h=r.floatToByte(s.blue);var f=u*X+c*Z+h,m=r.floatToByte(a.alpha)*X+r.floatToByte(l.alpha)*Z+r.floatToByte(s.alpha);(0,n[q.compressedAttribute0])(o,d,p,f,m)}function O(e,t,n,r){var i=r._index,o=0,s=1,l=1,u=1,c=r.translucencyByDistance;a(c)&&(o=c.near,l=c.far,u=c.farValue,1===(s=c.nearValue)&&1===u||(e._shaderTranslucencyByDistance=!0));var d=r.show&&r.clusterShow;0===r.color.alpha&&0===r.outlineColor.alpha&&(d=!1),s=1===(s=h.clamp(s,0,1))?255:255*s|0;var p=(d?1:0)*Z+s;u=h.clamp(u,0,1),(0,n[q.compressedAttribute1])(i,p,u=1===u?255:255*u|0,o,l)}function R(e,t,n,r){var i=r._index,o=n[q.scaleByDistance],s=0,l=1,u=1,c=1,h=r.scaleByDistance;a(h)&&(s=h.near,u=h.far,c=h.farValue,1===(l=h.nearValue)&&1===c||(e._shaderScaleByDistance=!0)),o(i,s,l,u,c)}function N(e,t,n,r){var i=r._index,o=n[q.distanceDisplayCondition],s=0,l=Number.MAX_VALUE,u=r.distanceDisplayCondition;a(u)&&(s=u.near,l=u.far,e._shaderDistanceDisplayCondition=!0),o(i,s,l)}function L(t,n,r,i,o,s){var l;i.mode===T.SCENE3D?(l=t._baseVolume,t._boundingVolumeDirty=!0):l=t._baseVolume2D;for(var u=[],c=0;c<r;++c){var h=n[c],d=x._computeActualPosition(h.position,i,o);a(d)&&(h._setActualPosition(d),s?u.push(d):e.expand(l,d,l))}s&&e.fromPoints(u,l)}var F=x.SHOW_INDEX,B=x.POSITION_INDEX,k=x.COLOR_INDEX,V=x.OUTLINE_COLOR_INDEX,z=x.OUTLINE_WIDTH_INDEX,U=x.PIXEL_SIZE_INDEX,G=x.SCALE_BY_DISTANCE_INDEX,W=x.TRANSLUCENCY_BY_DISTANCE_INDEX,H=x.DISTANCE_DISPLAY_CONDITION_INDEX,j=x.NUMBER_OF_PROPERTIES,q={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayCondition:5};s(A.prototype,{length:{get:function(){return D(this),this._pointPrimitives.length}}}),A.prototype.add=function(e){var t=new x(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t},A.prototype.remove=function(e){return!!this.contains(e)&&(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},A.prototype.removeAll=function(){P(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},A.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]},A.prototype.contains=function(e){return a(e)&&e._pointPrimitiveCollection===this},A.prototype.get=function(e){return D(this),this._pointPrimitives[e]},A.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,n=this._propertiesChanged,r=0;r<j;++r){var i=0===n[r]?f.STATIC_DRAW:f.STREAM_DRAW;t=t||e[r]!==i,e[r]=i}return t};var Y=new c,X=65536,Z=256,K=[];return A.prototype.update=function(t){var n,r,o,s,l;D(this),this._maxTotalPointSize=m.maximumAliasedPointSize,r=(n=t).mode,o=this._pointPrimitives,s=this._pointPrimitivesToUpdate,l=this._modelMatrix,this._createVertexArray||this._mode!==r||r!==T.SCENE3D&&!d.equals(l,this.modelMatrix)?(this._mode=r,d.clone(this.modelMatrix,l),this._createVertexArray=!0,r!==T.SCENE3D&&r!==T.SCENE2D&&r!==T.COLUMBUS_VIEW||L(this,o,o.length,n,l,!0)):r===T.MORPHING?L(this,o,o.length,n,l,!0):r!==T.SCENE2D&&r!==T.COLUMBUS_VIEW||L(this,s,this._pointPrimitivesToUpdateIndex,n,l,!1);var u,c,h,f,x,A,P,Y,X,Z,Q=this._pointPrimitives.length,J=this._pointPrimitivesToUpdate,$=this._pointPrimitivesToUpdateIndex,ee=this._propertiesChanged,te=t.context,ne=t.passes,re=ne.pick;if(this._createVertexArray||!re&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var ie=0;ie<j;++ie)ee[ie]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),Q>0){this._vaf=new C(te,[{index:q.positionHighAndSize,componentsPerAttribute:4,componentDatatype:i.FLOAT,usage:(A=this._buffersUsage)[B]},{index:q.positionLowAndShow,componentsPerAttribute:4,componentDatatype:i.FLOAT,usage:A[B]},{index:q.compressedAttribute0,componentsPerAttribute:4,componentDatatype:i.FLOAT,usage:A[k]},{index:q.compressedAttribute1,componentsPerAttribute:4,componentDatatype:i.FLOAT,usage:A[W]},{index:q.scaleByDistance,componentsPerAttribute:4,componentDatatype:i.FLOAT,usage:A[G]},{index:q.distanceDisplayCondition,componentsPerAttribute:2,componentDatatype:i.FLOAT,usage:A[H]}],Q),u=this._vaf.writers;for(var oe=0;oe<Q;++oe){var ae=this._pointPrimitives[oe];ae._dirty=!1,h=te,M(c=this,0,f=u,x=ae),I(0,h,f,x),O(c,0,f,x),R(c,0,f,x),N(c,0,f,x)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if($>0){var se=K;se.length=0,(ee[B]||ee[z]||ee[U])&&se.push(M),(ee[k]||ee[V])&&se.push(I),(ee[F]||ee[W])&&se.push(O),ee[G]&&se.push(R),ee[H]&&se.push(N);var le=se.length;if(u=this._vaf.writers,$/Q>.1){for(var ue=0;ue<$;++ue){var ce=J[ue];ce._dirty=!1;for(var he=0;he<le;++he)se[he](this,te,u,ce)}this._vaf.commit()}else{for(var de=0;de<$;++de){var pe=J[de];pe._dirty=!1;for(var fe=0;fe<le;++fe)se[fe](this,te,u,pe);this._vaf.subCommit(pe._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if($>1.5*Q&&(J.length=Q),a(this._vaf)&&a(this._vaf.va)){this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,e.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var me,_e=d.IDENTITY;t.mode===T.SCENE3D?(_e=this.modelMatrix,me=e.clone(this._baseVolumeWC,this._boundingVolume)):me=e.clone(this._baseVolume2D,this._boundingVolume),P=this,Z=(Y=t).camera.getPixelSize(X=me,Y.context.drawingBufferWidth,Y.context.drawingBufferHeight),X.radius+=Z*P._maxPixelSize;var ge,ve,ye,Ce,we,be,Ee=t.commandList;if(ne.render){var Se=this._colorCommands;for(a(this._rs)||(this._rs=g.fromCache({depthTest:{enabled:!0},blending:E.ALPHA_BLEND})),(!a(this._sp)||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition)&&(we=new y({sources:[b]}),this._shaderScaleByDistance&&we.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&we.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&we.defines.push("DISTANCE_DISPLAY_CONDITION"),this._sp=v.replaceCache({context:te,shaderProgram:this._sp,vertexShaderSource:we,fragmentShaderSource:w,attributeLocations:q}),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition),Se.length=ve=(ge=this._vaf.va).length,Ce=0;Ce<ve;++Ce)ye=Se[Ce],a(ye)||(ye=Se[Ce]=new _({primitiveType:p.POINTS,pass:S.OPAQUE,owner:this})),ye.boundingVolume=me,ye.modelMatrix=_e,ye.shaderProgram=this._sp,ye.uniformMap=this._uniforms,ye.vertexArray=ge[Ce].va,ye.renderState=this._rs,ye.debugShowBoundingVolume=this.debugShowBoundingVolume,Ee.push(ye)}if(re){var xe=this._pickCommands;for((!a(this._spPick)||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistancePick||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistancePick||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayConditionPick)&&(we=new y({defines:["RENDER_FOR_PICK"],sources:[b]}),this._shaderScaleByDistance&&we.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&we.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&we.defines.push("DISTANCE_DISPLAY_CONDITION"),be=new y({defines:["RENDER_FOR_PICK"],sources:[w]}),this._spPick=v.replaceCache({context:te,shaderProgram:this._spPick,vertexShaderSource:we,fragmentShaderSource:be,attributeLocations:q}),this._compiledShaderScaleByDistancePick=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistancePick=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayConditionPick=this._shaderDistanceDisplayCondition),xe.length=ve=(ge=this._vaf.va).length,Ce=0;Ce<ve;++Ce)ye=xe[Ce],a(ye)||(ye=xe[Ce]=new _({primitiveType:p.POINTS,pass:S.OPAQUE,owner:this})),ye.boundingVolume=me,ye.modelMatrix=_e,ye.shaderProgram=this._spPick,ye.uniformMap=this._uniforms,ye.vertexArray=ge[Ce].va,ye.renderState=this._rs,Ee.push(ye)}}},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),P(this._pointPrimitives),l(this)},A}),o("ThirdParty/kdbush",[],function(){"use strict";function e(e,i,o,a,s){i=i||t,o=o||n,s=s||Array,this.nodeSize=a||64,this.points=e,this.ids=new s(e.length),this.coords=new s(2*e.length);for(var l=0;l<e.length;l++)this.ids[l]=l,this.coords[2*l]=i(e[l]),this.coords[2*l+1]=o(e[l]);!function e(t,n,i,o,a,s){if(!(a-o<=i)){var l=Math.floor((o+a)/2);(function e(t,n,i,o,a,s){for(;a>o;){if(a-o>600){var l=a-o+1,u=i-o+1,c=Math.log(l),h=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*h*(l-h)/l)*(u-l/2<0?-1:1);e(t,n,i,Math.max(o,Math.floor(i-u*h/l+d)),Math.min(a,Math.floor(i+(l-u)*h/l+d)),s)}var p=n[2*i+s],f=o,m=a;for(r(t,n,o,i),n[2*a+s]>p&&r(t,n,o,a);f<m;){for(r(t,n,f,m),f++,m--;n[2*f+s]<p;)f++;for(;n[2*m+s]>p;)m--}n[2*o+s]===p?r(t,n,o,m):r(t,n,++m,a),m<=i&&(o=m+1),i<=m&&(a=m-1)}})(t,n,l,o,a,s%2),e(t,n,i,o,l-1,s+1),e(t,n,i,l+1,a,s+1)}}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function t(e){return e[0]}function n(e){return e[1]}function r(e,t,n,r){i(e,n,r),i(t,2*n,2*r),i(t,2*n+1,2*r+1)}function i(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function o(e,t,n,r){var i=e-n,o=t-r;return i*i+o*o}return e.prototype={range:function(e,t,n,r){return function(e,t,n,r,i,o,a){for(var s,l,u=[0,e.length-1,0],c=[];u.length;){var h=u.pop(),d=u.pop(),p=u.pop();if(d-p<=a)for(var f=p;f<=d;f++)s=t[2*f],l=t[2*f+1],s>=n&&s<=i&&l>=r&&l<=o&&c.push(e[f]);else{var m=Math.floor((p+d)/2);l=t[2*m+1],(s=t[2*m])>=n&&s<=i&&l>=r&&l<=o&&c.push(e[m]);var _=(h+1)%2;(0===h?n<=s:r<=l)&&(u.push(p),u.push(m-1),u.push(_)),(0===h?i>=s:o>=l)&&(u.push(m+1),u.push(d),u.push(_))}}return c}(this.ids,this.coords,e,t,n,r,this.nodeSize)},within:function(e,t,n){return function(e,t,n,r,i,a){for(var s=[0,e.length-1,0],l=[],u=i*i;s.length;){var c=s.pop(),h=s.pop(),d=s.pop();if(h-d<=a)for(var p=d;p<=h;p++)o(t[2*p],t[2*p+1],n,r)<=u&&l.push(e[p]);else{var f=Math.floor((d+h)/2),m=t[2*f],_=t[2*f+1];o(m,_,n,r)<=u&&l.push(e[f]);var g=(c+1)%2;(0===c?n-i<=m:r-i<=_)&&(s.push(d),s.push(f-1),s.push(g)),(0===c?n+i>=m:r+i>=_)&&(s.push(f+1),s.push(h),s.push(g))}}return l}(this.ids,this.coords,e,t,n,this.nodeSize)}},function(t,n,r,i,o){return new e(t,n,r,i,o)}}),o("DataSources/Property",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Iso8601"],function(e,t,n,r,i){"use strict";function o(){r.throwInstantiationError()}return n(o.prototype,{isConstant:{get:r.throwInstantiationError},definitionChanged:{get:r.throwInstantiationError}}),o.prototype.getValue=r.throwInstantiationError,o.prototype.equals=r.throwInstantiationError,o.equals=function(e,n){return e===n||t(e)&&e.equals(n)},o.arrayEquals=function(e,n){if(e===n)return!0;if(!t(e)||!t(n)||e.length!==n.length)return!1;for(var r=e.length,i=0;i<r;i++)if(!o.equals(e[i],n[i]))return!1;return!0},o.isConstant=function(e){return!t(e)||e.isConstant},o.getValueOrUndefined=function(e,n,r){return t(e)?e.getValue(n,r):void 0},o.getValueOrDefault=function(n,r,i,o){return t(n)?e(n.getValue(r,o),i):i},o.getValueOrClonedDefault=function(e,n,r,i){var o;return t(e)&&(o=e.getValue(n,i)),t(o)||(o=r.clone(o)),o},o}),o("DataSources/ColorMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(e){this._definitionChanged=new r,this._color=void 0,this._colorSubscription=void 0,this.color=e}return n(s.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color")}),s.prototype.getType=function(e){return"Color"},s.prototype.getValue=function(n,r){return t(r)||(r={}),r.color=a.getValueOrClonedDefault(this._color,n,e.WHITE,r.color),r},s.prototype.equals=function(e){return this===e||e instanceof s&&a.equals(this._color,e._color)},s}),o("DataSources/ImageMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){e=n(e,n.EMPTY_OBJECT),this._definitionChanged=new o,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}var u=new e(1,1),c=t.WHITE;return i(l.prototype,{isConstant:{get:function(){return s.isConstant(this._image)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:a("image"),repeat:a("repeat"),color:a("color"),transparent:a("transparent")}),l.prototype.getType=function(e){return"Image"},l.prototype.getValue=function(e,t){return r(t)||(t={}),t.image=s.getValueOrUndefined(this._image,e),t.repeat=s.getValueOrClonedDefault(this._repeat,e,u,t.repeat),t.color=s.getValueOrClonedDefault(this._color,e,c,t.color),s.getValueOrDefault(this._transparent,e,!1)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t},l.prototype.equals=function(e){return this===e||e instanceof l&&s.equals(this._image,e._image)&&s.equals(this._color,e._color)&&s.equals(this._transparent,e._transparent)&&s.equals(this._repeat,e._repeat)},l}),o("DataSources/createMaterialPropertyDescriptor",["../Core/Color","../Core/DeveloperError","./ColorMaterialProperty","./createPropertyDescriptor","./ImageMaterialProperty"],function(e,t,n,r,i){"use strict";function o(t){if(t instanceof e)return new n(t);if("string"==typeof t||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement){var r=new i;return r.image=t,r}}return function(e,t){return r(e,t,o)}}),o("DataSources/BoxGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._dimensions=void 0,this._dimensionsSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),dimensions:a("dimensions"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.dimensions=this.dimensions,e.show=this.show,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.dimensions=e(this.dimensions,t.dimensions),this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/PositionProperty",["../Core/Cartesian3","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix3","../Core/ReferenceFrame","../Core/Transforms"],function(e,t,n,r,i,o,a){"use strict";function s(){r.throwInstantiationError()}n(s.prototype,{isConstant:{get:r.throwInstantiationError},definitionChanged:{get:r.throwInstantiationError},referenceFrame:{get:r.throwInstantiationError}}),s.prototype.getValue=r.throwInstantiationError,s.prototype.getValueInReferenceFrame=r.throwInstantiationError,s.prototype.equals=r.throwInstantiationError;var l=new i;return s.convertToReferenceFrame=function(n,r,s,u,c){if(!t(r))return r;if(t(c)||(c=new e),s===u)return e.clone(r,c);var h=a.computeIcrfToFixedMatrix(n,l);return t(h)||(h=a.computeTemeToPseudoFixedMatrix(n,l)),s===o.INERTIAL?i.multiplyByVector(h,r,c):s===o.FIXED?i.multiplyByVector(i.transpose(h,l),r,c):void 0},s}),o("DataSources/ConstantPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty"],function(e,t,n,r,i,o,a,s){"use strict";function l(n,r){this._definitionChanged=new o,this._value=e.clone(n),this._referenceFrame=t(r,a.FIXED)}return r(l.prototype,{isConstant:{get:function(){return!n(this._value)||this._referenceFrame===a.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)},l.prototype.setValue=function(t,r){var i=!1;e.equals(this._value,t)||(i=!0,this._value=e.clone(t)),n(r)&&this._referenceFrame!==r&&(i=!0,this._referenceFrame=r),i&&this._definitionChanged.raiseEvent(this)},l.prototype.getValueInReferenceFrame=function(e,t,n){return s.convertToReferenceFrame(e,this._value,this._referenceFrame,t,n)},l.prototype.equals=function(t){return this===t||t instanceof l&&e.equals(this._value,t._value)&&this._referenceFrame===t._referenceFrame},l}),o("DataSources/CorridorGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),width:a("width"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),cornerType:a("cornerType"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.width=this.width,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.positions=e(this.positions,t.positions),this.height=e(this.height,t.height),this.extrudedHeight=e(this.extrudedHeight,t.extrudedHeight),this.granularity=e(this.granularity,t.granularity),this.width=e(this.width,t.width),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.cornerType=e(this.cornerType,t.cornerType),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/createRawPropertyDescriptor",["./createPropertyDescriptor"],function(e){"use strict";function t(e){return e}return function(n,r){return e(n,r,t)}}),o("DataSources/CylinderGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},length:a("length"),topRadius:a("topRadius"),bottomRadius:a("bottomRadius"),numberOfVerticalLines:a("numberOfVerticalLines"),slices:a("slices"),show:a("show"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.bottomRadius=this.bottomRadius,e.length=this.length,e.topRadius=this.topRadius,e.show=this.show,e.material=this.material,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.bottomRadius=e(this.bottomRadius,t.bottomRadius),this.length=e(this.length,t.length),this.topRadius=e(this.topRadius,t.topRadius),this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.numberOfVerticalLines=e(this.numberOfVerticalLines,t.numberOfVerticalLines),this.slices=e(this.slices,t.slices),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/EllipseGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},semiMajorAxis:a("semiMajorAxis"),semiMinorAxis:a("semiMinorAxis"),rotation:a("rotation"),show:a("show"),material:o("material"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),numberOfVerticalLines:a("numberOfVerticalLines"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.rotation=this.rotation,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.show=this.show,e.material=this.material,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.rotation=e(this.rotation,t.rotation),this.semiMajorAxis=e(this.semiMajorAxis,t.semiMajorAxis),this.semiMinorAxis=e(this.semiMinorAxis,t.semiMinorAxis),this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.height=e(this.height,t.height),this.extrudedHeight=e(this.extrudedHeight,t.extrudedHeight),this.granularity=e(this.granularity,t.granularity),this.stRotation=e(this.stRotation,t.stRotation),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.numberOfVerticalLines=e(this.numberOfVerticalLines,t.numberOfVerticalLines),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/EllipsoidGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),radii:a("radii"),material:o("material"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),stackPartitions:a("stackPartitions"),slicePartitions:a("slicePartitions"),subdivisions:a("subdivisions"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.radii=this.radii,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.radii=e(this.radii,t.radii),this.material=e(this.material,t.material),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.stackPartitions=e(this.stackPartitions,t.stackPartitions),this.slicePartitions=e(this.slicePartitions,t.slicePartitions),this.subdivisions=e(this.subdivisions,t.subdivisions),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/LabelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,n,r,i,o){"use strict";function a(t){this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},text:o("text"),font:o("font"),style:o("style"),fillColor:o("fillColor"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),horizontalOrigin:o("horizontalOrigin"),verticalOrigin:o("verticalOrigin"),eyeOffset:o("eyeOffset"),heightReference:o("heightReference"),pixelOffset:o("pixelOffset"),scale:o("scale"),show:o("show"),translucencyByDistance:o("translucencyByDistance"),pixelOffsetScaleByDistance:o("pixelOffsetScaleByDistance"),distanceDisplayCondition:o("distanceDisplayCondition")}),a.prototype.clone=function(e){return t(e)?(e.text=this.text,e.font=this.font,e.show=this.show,e.style=this.style,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.scale=this.scale,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.eyeOffset=this.eyeOffset,e.heightReference=this.heightReference,e.pixelOffset=this.pixelOffset,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new a(this)},a.prototype.merge=function(t){this.text=e(this.text,t.text),this.font=e(this.font,t.font),this.show=e(this.show,t.show),this.style=e(this.style,t.style),this.fillColor=e(this.fillColor,t.fillColor),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.scale=e(this.scale,t.scale),this.horizontalOrigin=e(this.horizontalOrigin,t.horizontalOrigin),this.verticalOrigin=e(this.verticalOrigin,t.verticalOrigin),this.eyeOffset=e(this.eyeOffset,t.eyeOffset),this.heightReference=e(this.heightReference,t.heightReference),this.pixelOffset=e(this.pixelOffset,t.pixelOffset),this.translucencyByDistance=e(this._translucencyByDistance,t.translucencyByDistance),this.pixelOffsetScaleByDistance=e(this._pixelOffsetScaleByDistance,t.pixelOffsetScaleByDistance),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},a}),o("DataSources/NodeTransformationProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/TranslationRotationScale","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a){"use strict";var s=new i,l=function(t){t=e(t,e.EMPTY_OBJECT),this._definitionChanged=new r,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=t.translation,this.rotation=t.rotation,this.scale=t.scale};return n(l.prototype,{isConstant:{get:function(){return a.isConstant(this._translation)&&a.isConstant(this._rotation)&&a.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:o("translation"),rotation:o("rotation"),scale:o("scale")}),l.prototype.getValue=function(e,n){return t(n)||(n=new i),n.translation=a.getValueOrClonedDefault(this._translation,e,s.translation,n.translation),n.rotation=a.getValueOrClonedDefault(this._rotation,e,s.rotation,n.rotation),n.scale=a.getValueOrClonedDefault(this._scale,e,s.scale,n.scale),n},l.prototype.equals=function(e){return this===e||e instanceof l&&a.equals(this._translation,e._translation)&&a.equals(this._rotation,e._rotation)&&a.equals(this._scale,e._scale)},l}),o("DataSources/PropertyBag",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){return new o(e)}var u=function(e,n){this._propertyNames=[],this._definitionChanged=new i,t(e)&&this.merge(e,n)};return n(u.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){for(var e=this._propertyNames,t=0,n=e.length;t<n;t++)if(!s.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),u.prototype.hasProperty=function(e){return-1!==this._propertyNames.indexOf(e)},u.prototype.addProperty=function(n,r,i){this._propertyNames.push(n),Object.defineProperty(this,n,a(n,!0,e(i,l))),t(r)&&(this[n]=r),this._definitionChanged.raiseEvent(this)},u.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);this._propertyNames.splice(t,1),delete this[e],this._definitionChanged.raiseEvent(this)},u.prototype.getValue=function(e,n){t(n)||(n={});for(var r=this._propertyNames,i=0,o=r.length;i<o;i++){var a=r[i];n[a]=s.getValueOrUndefined(this[a],e,n[a])}return n},u.prototype.merge=function(e,n){for(var r=this._propertyNames,i=t(e._propertyNames)?e._propertyNames:Object.keys(e),o=0,a=i.length;o<a;o++){var s=i[o],l=this[s],u=e[s];t(l)||-1!==r.indexOf(s)||this.addProperty(s,void 0,n),t(u)&&(t(l)?t(l.merge)&&l.merge(u):this[s]=t(u.merge)&&t(u.clone)?u.clone():u)}},u.prototype.equals=function(e){return this===e||e instanceof u&&function(e,t){var n=e._propertyNames,r=t._propertyNames,i=n.length;if(i!==r.length)return!1;for(var o=0;o<i;++o){var a=n[o];if(-1===r.indexOf(a))return!1;if(!s.equals(e[a],t[a]))return!1}return!0}(this,e)},u}),o("DataSources/ModelGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor","./NodeTransformationProperty","./PropertyBag"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){return new a(e)}function u(t){this._show=void 0,this._showSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._runAnimations=void 0,this._runAnimationsSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(u.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:o("show"),scale:o("scale"),minimumPixelSize:o("minimumPixelSize"),maximumScale:o("maximumScale"),incrementallyLoadTextures:o("incrementallyLoadTextures"),shadows:o("shadows"),uri:o("uri"),runAnimations:o("runAnimations"),nodeTransformations:o("nodeTransformations",void 0,function(e){return new s(e,l)}),heightReference:o("heightReference"),distanceDisplayCondition:o("distanceDisplayCondition")}),u.prototype.clone=function(e){return t(e)?(e.show=this.show,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.shadows=this.shadows,e.uri=this.uri,e.runAnimations=this.runAnimations,e.nodeTransformations=this.nodeTransformations,e.heightReference=this._heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new u(this)},u.prototype.merge=function(n){this.show=e(this.show,n.show),this.scale=e(this.scale,n.scale),this.minimumPixelSize=e(this.minimumPixelSize,n.minimumPixelSize),this.maximumScale=e(this.maximumScale,n.maximumScale),this.incrementallyLoadTextures=e(this.incrementallyLoadTextures,n.incrementallyLoadTextures),this.shadows=e(this.shadows,n.shadows),this.uri=e(this.uri,n.uri),this.runAnimations=e(this.runAnimations,n.runAnimations),this.heightReference=e(this.heightReference,n.heightReference),this.distanceDisplayCondition=e(this.distanceDisplayCondition,n.distanceDisplayCondition);var r=n.nodeTransformations;if(t(r)){var i=this.nodeTransformations;t(i)?i.merge(r):this.nodeTransformations=new s(r,l)}},u}),o("DataSources/PathGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._material=void 0,this._materialSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),width:a("width"),resolution:a("resolution"),leadTime:a("leadTime"),trailTime:a("trailTime"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.material=this.material,e.width=this.width,e.resolution=this.resolution,e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.material=e(this.material,t.material),this.width=e(this.width,t.width),this.resolution=e(this.resolution,t.resolution),this.show=e(this.show,t.show),this.leadTime=e(this.leadTime,t.leadTime),this.trailTime=e(this.trailTime,t.trailTime),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/PointGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createPropertyDescriptor"],function(e,t,n,r,i,o){"use strict";function a(t){this._color=void 0,this._colorSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(a.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),pixelSize:o("pixelSize"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth"),show:o("show"),scaleByDistance:o("scaleByDistance"),translucencyByDistance:o("translucencyByDistance"),heightReference:o("heightReference"),distanceDisplayCondition:o("distanceDisplayCondition")}),a.prototype.clone=function(e){return t(e)?(e.color=this.color,e.pixelSize=this.pixelSize,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.show=this.show,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.heightReference=this.heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new a(this)},a.prototype.merge=function(t){this.color=e(this.color,t.color),this.pixelSize=e(this.pixelSize,t.pixelSize),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.show=e(this.show,t.show),this.scaleByDistance=e(this.scaleByDistance,t.scaleByDistance),this.translucencyByDistance=e(this._translucencyByDistance,t.translucencyByDistance),this.heightReference=e(this.heightReference,t.heightReference),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},a}),o("DataSources/PolygonGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._definitionChanged=new i,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),hierarchy:a("hierarchy"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),perPositionHeight:a("perPositionHeight"),closeTop:a("closeTop"),closeBottom:a("closeBottom"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.material=this.material,e.hierarchy=this.hierarchy,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.hierarchy=e(this.hierarchy,t.hierarchy),this.height=e(this.height,t.height),this.extrudedHeight=e(this.extrudedHeight,t.extrudedHeight),this.granularity=e(this.granularity,t.granularity),this.stRotation=e(this.stRotation,t.stRotation),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.perPositionHeight=e(this.perPositionHeight,t.perPositionHeight),this.closeTop=e(this.closeTop,t.closeTop),this.closeBottom=e(this.closeBottom,t.closeBottom),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/PolylineGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._followSurface=void 0,this._followSurfaceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._widthSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),width:a("width"),followSurface:a("followSurface"),granularity:a("granularity"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.width=this.width,e.followSurface=this.followSurface,e.granularity=this.granularity,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.positions=e(this.positions,t.positions),this.width=e(this.width,t.width),this.followSurface=e(this.followSurface,t.followSurface),this.granularity=e(this.granularity,t.granularity),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/PolylineVolumeGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),shape:a("shape"),granularity:a("granularity"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),cornerType:a("cornerType"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.shape=this.shape,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.positions=e(this.positions,t.positions),this.shape=e(this.shape,t.shape),this.granularity=e(this.granularity,t.granularity),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.cornerType=e(this.cornerType,t.cornerType),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/RectangleGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),coordinates:a("coordinates"),material:o("material"),height:a("height"),extrudedHeight:a("extrudedHeight"),granularity:a("granularity"),stRotation:a("stRotation"),rotation:a("rotation"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),closeTop:a("closeTop"),closeBottom:a("closeBottom"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.coordinates=this.coordinates,e.material=this.material,e.height=this.height,e.extrudedHeight=this.extrudedHeight,e.granularity=this.granularity,e.stRotation=this.stRotation,e.rotation=this.rotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.coordinates=e(this.coordinates,t.coordinates),this.material=e(this.material,t.material),this.height=e(this.height,t.height),this.extrudedHeight=e(this.extrudedHeight,t.extrudedHeight),this.granularity=e(this.granularity,t.granularity),this.stRotation=e(this.stRotation,t.stRotation),this.rotation=e(this.rotation,t.rotation),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.closeTop=e(this.closeTop,t.closeTop),this.closeBottom=e(this.closeBottom,t.closeBottom),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/WallGraphics",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./createMaterialPropertyDescriptor","./createPropertyDescriptor"],function(e,t,n,r,i,o,a){"use strict";function s(t){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new i,this.merge(e(t,e.EMPTY_OBJECT))}return n(s.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:a("show"),material:o("material"),positions:a("positions"),minimumHeights:a("minimumHeights"),maximumHeights:a("maximumHeights"),granularity:a("granularity"),fill:a("fill"),outline:a("outline"),outlineColor:a("outlineColor"),outlineWidth:a("outlineWidth"),shadows:a("shadows"),distanceDisplayCondition:a("distanceDisplayCondition")}),s.prototype.clone=function(e){return t(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new s(this)},s.prototype.merge=function(t){this.show=e(this.show,t.show),this.material=e(this.material,t.material),this.positions=e(this.positions,t.positions),this.minimumHeights=e(this.minimumHeights,t.minimumHeights),this.maximumHeights=e(this.maximumHeights,t.maximumHeights),this.granularity=e(this.granularity,t.granularity),this.fill=e(this.fill,t.fill),this.outline=e(this.outline,t.outline),this.outlineColor=e(this.outlineColor,t.outlineColor),this.outlineWidth=e(this.outlineWidth,t.outlineWidth),this.shadows=e(this.shadows,t.shadows),this.distanceDisplayCondition=e(this.distanceDisplayCondition,t.distanceDisplayCondition)},s}),o("DataSources/Entity",["../Core/Cartesian3","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Transforms","./BillboardGraphics","./BoxGraphics","./ConstantPositionProperty","./CorridorGraphics","./createPropertyDescriptor","./createRawPropertyDescriptor","./CylinderGraphics","./EllipseGraphics","./EllipsoidGraphics","./LabelGraphics","./ModelGraphics","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineGraphics","./PolylineVolumeGraphics","./Property","./RectangleGraphics","./WallGraphics"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D){"use strict";function M(e,t){return m(e,void 0,function(e){return e instanceof t?e:new t(e)})}function I(e){var i=(e=n(e,n.EMPTY_OBJECT)).id;r(i)||(i=t()),this._availability=void 0,this._id=i,this._definitionChanged=new a,this._name=e.name,this._show=n(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","orientation","path","point","polygon","polyline","polylineVolume","position","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function O(e,t,n){for(var r=t.length,i=0;i<r;i++){var o=t[i],a=o._show;(!n&&a)!==(n&&a)&&O(o,o._children,n)}e._definitionChanged.raiseEvent(e,"isShowing",n,!n)}i(I.prototype,{availability:_("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:_("name"),show:{get:function(){return this._show},set:function(e){if(e!==this._show){var t=this.isShowing;this._show=e;var n=this.isShowing;t!==n&&O(this,this._children,n),this._definitionChanged.raiseEvent(this,"show",e,!e)}}},isShowing:{get:function(){return this._show&&(!r(this.entityCollection)||this.entityCollection.show)&&(!r(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){var t=this._parent;if(t!==e){var n=this.isShowing;if(r(t)){var i=t._children.indexOf(this);t._children.splice(i,1)}this._parent=e,r(e)&&e._children.push(this);var o=this.isShowing;n!==o&&O(this,this._children,o),this._definitionChanged.raiseEvent(this,"parent",e,t)}}},propertyNames:{get:function(){return this._propertyNames}},billboard:M("billboard",h),box:M("box",d),corridor:M("corridor",f),cylinder:M("cylinder",g),description:m("description"),ellipse:M("ellipse",v),ellipsoid:M("ellipsoid",y),label:M("label",C),model:M("model",w),orientation:m("orientation"),path:M("path",b),point:M("point",E),polygon:M("polygon",S),polyline:M("polyline",x),polylineVolume:M("polylineVolume",T),position:m("position",void 0,function(e){return new p(e)}),rectangle:M("rectangle",P),viewFrom:m("viewFrom"),wall:M("wall",D)}),I.prototype.isAvailable=function(e){var t=this._availability;return!r(t)||t.contains(e)},I.prototype.addProperty=function(e){this._propertyNames.push(e),Object.defineProperty(this,e,_(e,!0))},I.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);this._propertyNames.splice(t,1),delete this[e]},I.prototype.merge=function(e){this.name=n(this.name,e.name),this.availability=n(e.availability,this.availability);for(var t=this._propertyNames,i=r(e._propertyNames)?e._propertyNames:Object.keys(e),o=i.length,a=0;a<o;a++){var s=i[a];if("parent"!==s){var l=this[s],u=e[s];r(l)||-1!==t.indexOf(s)||this.addProperty(s),r(u)&&(r(l)?r(l.merge)&&l.merge(u):this[s]=r(u.merge)&&r(u.clone)?u.clone():u)}}};var R=new s,N=new e,L=new u;return I.prototype._getModelMatrix=function(e,t){var n=A.getValueOrUndefined(this._position,e,N);if(r(n)){var i=A.getValueOrUndefined(this._orientation,e,L);return r(i)?l.fromRotationTranslation(s.fromQuaternion(i,R),n,t):c.eastNorthUpToFixedFrame(n,void 0,t)}},I}),o("DataSources/EntityCluster",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/EllipsoidalOccluder","../Core/Event","../Core/Matrix4","../Scene/Billboard","../Scene/BillboardCollection","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/Label","../Scene/LabelCollection","../Scene/LabelStyle","../Scene/PointPrimitive","../Scene/PointPrimitiveCollection","../Scene/SceneTransforms","../Scene/VerticalOrigin","../ThirdParty/kdbush","./Entity","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S){"use strict";function x(e){e=i(e,i.EMPTY_OBJECT),this._enabled=i(e.enabled,!1),this._pixelRange=i(e.pixelRange,80),this._minimumClusterSize=i(e.minimumClusterSize,2),this._clusterBillboards=i(e.clusterBillboards,!0),this._clusterLabels=i(e.clusterLabels,!0),this._clusterPoints=i(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new u}function T(e){return e.coord.x}function A(e){return e.coord.y}function P(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}function D(t,n,r,i,a){if(o(t._labelCollection)&&i._clusterLabels?a=m.getScreenSpaceBoundingBox(t,n,a):o(t._billboardCollection)&&i._clusterBillboards?a=h.getScreenSpaceBoundingBox(t,n,a):o(t._pointPrimitiveCollection)&&i._clusterPoints&&(a=v.getScreenSpaceBoundingBox(t,n,a)),P(a,r),i._clusterLabels&&!o(t._labelCollection)&&o(t.id)&&I(i,t.id)&&o(t.id._label)){var s=i._labelCollection.get(i._collectionIndicesByEntity[t.id]),l=m.getScreenSpaceBoundingBox(s,n,F);P(l,r),a=e.union(a,l,a)}return a}function M(e,t,n,r){var i={billboard:r._clusterBillboardCollection.add(),label:r._clusterLabelCollection.add(),point:r._clusterPointCollection.add()};i.billboard.show=!1,i.point.show=!1,i.label.show=!0,i.label.text=t.toLocaleString(),i.billboard.position=i.label.position=i.point.position=e,r._clusterEvent.raiseEvent(n,i)}function I(e,t){return o(e)&&o(e._collectionIndicesByEntity[t])&&o(e._collectionIndicesByEntity[t].labelIndex)}function O(e,t,n,r,i){if(o(e))for(var a=e.length,s=0;s<a;++s){var l=e.get(s);if(l.clusterShow=!1,l.show&&r.isPointVisible(l.position)){var u=i._clusterLabels&&o(l._labelCollection),c=i._clusterBillboards&&o(l.id._billboard),h=i._clusterPoints&&o(l.id._point);if(!u||!h&&!c){var d=l.computeScreenSpacePosition(n);o(d)&&t.push({index:s,collection:e,clustered:!1,coord:d})}}}}function R(e,t,n,r){return function(i){var a=this[e];o(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});var s=this._collectionIndicesByEntity[i.id];if(o(s)||(s=this._collectionIndicesByEntity[i.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),o(a)&&o(s[r]))return a.get(s[r]);o(a)||(a=this[e]=new t({scene:this._scene}));var l,u,c=this[n];return c.length>0?(l=c.pop(),u=a.get(l)):(u=a.add(),l=a.length-1),s[r]=l,this._clusterDirty=!0,u}}function N(e,t){var n=e._collectionIndicesByEntity[t];o(n.billboardIndex)||o(n.labelIndex)||o(n.pointIndex)||delete e._collectionIndicesByEntity[t]}function L(e){if(o(e))for(var t=e.length,n=0;n<t;++n)e.get(n).clusterShow=!0}var F=new e,B=new e,k=new e,V=new e;return x.prototype._initialize=function(r){this._scene=r;var i,a=(i=this,function(r){if(!(o(r)&&r<.05)&&i.enabled){var a=i._scene,s=i._labelCollection,u=i._billboardCollection,p=i._pointCollection;if((o(s)||o(u)||o(p))&&(i._clusterBillboards||i._clusterLabels||i._clusterPoints)){var f=i._clusterLabelCollection,m=i._clusterBillboardCollection,g=i._clusterPointCollection;o(f)?f.removeAll():f=i._clusterLabelCollection=new _({scene:a}),o(m)?m.removeAll():m=i._clusterBillboardCollection=new d({scene:a}),o(g)?g.removeAll():g=i._clusterPointCollection=new y;var v=i._pixelRange,C=i._minimumClusterSize,w=i._previousClusters,E=[],S=i._previousHeight,x=a.camera.positionCartographic.height,P=new l(a.mapProjection.ellipsoid,a.camera.positionWC),R=[];i._clusterLabels&&O(s,R,a,P,i),i._clusterBillboards&&O(u,R,a,P,i),i._clusterPoints&&O(p,R,a,P,i);var N,L,F,z,U,G,W,H,j,q,Y,X,Z=b(R,T,A,64,Int32Array);if(x<S)for(F=w.length,N=0;N<F;++N){var K=w[N];if(P.isPointVisible(K.position)){var Q=h._computeScreenSpacePosition(c.IDENTITY,K.position,n.ZERO,t.ZERO,a);if(o(Q)){var J=1-x/S,$=K.width=K.width*J,ee=K.height=K.height*J;for($=Math.max($,K.minimumWidth),ee=Math.max(ee,K.minimumHeight),G=(U=Z.range(Q.x-.5*$,Q.y-.5*ee,Q.x+$,Q.y+ee)).length,q=0,j=[],L=0;L<G;++L)W=U[L],H=R[W],H.clustered||(++q,Y=H.collection,X=H.index,j.push(Y.get(X).id));if(q>=C)for(M(K.position,q,j,i),E.push(K),L=0;L<G;++L)R[U[L]].clustered=!0}}}for(F=R.length,N=0;N<F;++N){var te=R[N];if(!te.clustered){te.clustered=!0;var ne=(Y=te.collection).get(X=te.index);z=D(ne,te.coord,v,i,B);var re=e.clone(z,k);G=(U=Z.range(z.x,z.y,z.x+z.width,z.y+z.height)).length;var ie=n.clone(ne.position);for(q=1,j=[ne.id],L=0;L<G;++L)if(W=U[L],H=R[W],!H.clustered){var oe=H.collection.get(H.index),ae=D(oe,H.coord,v,i,V);n.add(oe.position,ie,ie),e.union(re,ae,re),++q,j.push(oe.id)}if(q>=C){var se=n.multiplyByScalar(ie,1/q,ie);for(M(se,q,j,i),E.push({position:se,width:re.width,height:re.height,minimumWidth:z.width,minimumHeight:z.height}),L=0;L<G;++L)R[U[L]].clustered=!0}else le=ne,ue=i,le.clusterShow=!0,!o(le._labelCollection)&&o(le.id)&&I(ue,le.id)&&o(le.id._label)&&(ue._labelCollection.get(ue._collectionIndicesByEntity[le.id]).clusterShow=!0)}}0===f.length&&(f.destroy(),i._clusterLabelCollection=void 0),0===m.length&&(m.destroy(),i._clusterBillboardCollection=void 0),0===g.length&&(g.destroy(),i._clusterPointCollection=void 0),i._previousClusters=E,i._previousHeight=x}}var le,ue});this._cluster=a,this._removeEventListener=r.camera.changed.addEventListener(a)},a(x.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}}),x.prototype.getLabel=R("_labelCollection",_,"_unusedLabelIndices","labelIndex"),x.prototype.removeLabel=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(o(this._labelCollection)&&o(t)&&o(t.labelIndex)){var n=t.labelIndex;t.labelIndex=void 0,N(this,e.id);var r=this._labelCollection.get(n);r.show=!1,r.text="",r.id=void 0,this._unusedLabelIndices.push(n),this._clusterDirty=!0}},x.prototype.getBillboard=R("_billboardCollection",d,"_unusedBillboardIndices","billboardIndex"),x.prototype.removeBillboard=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(o(this._billboardCollection)&&o(t)&&o(t.billboardIndex)){var n=t.billboardIndex;t.billboardIndex=void 0,N(this,e.id);var r=this._billboardCollection.get(n);r.id=void 0,r.show=!1,r.image=void 0,this._unusedBillboardIndices.push(n),this._clusterDirty=!0}},x.prototype.getPoint=R("_pointCollection",y,"_unusedPointIndices","pointIndex"),x.prototype.removePoint=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(o(this._pointCollection)&&o(t)&&o(t.pointIndex)){var n=t.pointIndex;t.pointIndex=void 0,N(this,e.id);var r=this._pointCollection.get(n);r.show=!1,r.id=void 0,this._unusedPointIndices.push(n),this._clusterDirty=!0}},x.prototype.update=function(e){if(o(this._labelCollection)&&this._labelCollection.length>0&&0===this._labelCollection.get(0)._glyphs.length){var t=e.commandList;e.commandList=[],this._labelCollection.update(e),e.commandList=t}var n;this._enabledDirty&&(this._enabledDirty=!1,(n=this).enabled||(o(n._clusterLabelCollection)&&n._clusterLabelCollection.destroy(),o(n._clusterBillboardCollection)&&n._clusterBillboardCollection.destroy(),o(n._clusterPointCollection)&&n._clusterPointCollection.destroy(),n._clusterLabelCollection=void 0,n._clusterBillboardCollection=void 0,n._clusterPointCollection=void 0,L(n._labelCollection),L(n._billboardCollection),L(n._pointCollection)),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),o(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),o(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),o(this._clusterPointCollection)&&this._clusterPointCollection.update(e),o(this._labelCollection)&&this._labelCollection.update(e),o(this._billboardCollection)&&this._billboardCollection.update(e),o(this._pointCollection)&&this._pointCollection.update(e)},x.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),o(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1},x}),o("DataSources/BillboardVisualizer",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/VerticalOrigin","./BoundingSphereState","./EntityCluster","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";function g(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function v(t,n){n.collectionChanged.addEventListener(v.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new e,this._onCollectionChanged(n,n.values,[],[])}function y(e,t,n){a(e)&&(e.billboard=void 0,n.removeBillboard(t))}var C=i.WHITE,w=r.ZERO,b=h.NONE,E=n.ZERO,S=r.ZERO,x=d.CENTER,T=p.CENTER,A=new r,P=new i,D=new r,M=new n,I=new c,O=new c,R=new c,N=new t,L=new u;return v.prototype.update=function(e){for(var t=this._items.values,n=this._cluster,r=0,i=t.length;r<i;r++){var o,s=t[r],l=s.entity,u=l._billboard,c=s.billboard,h=l.isShowing&&l.isAvailable(e)&&_.getValueOrDefault(u._show,e,!0);if(h&&(A=_.getValueOrUndefined(l._position,e,A),o=_.getValueOrUndefined(u._image,e),h=a(A)&&a(o)),h){_.isConstant(l._position)||(n._clusterDirty=!0),a(c)||((c=n.getBillboard(l)).id=l,c.image=void 0,s.billboard=c),c.show=h,a(c.image)&&s.textureValue===o||(c.image=o,s.textureValue=o),c.position=A,c.color=_.getValueOrDefault(u._color,e,C,P),c.eyeOffset=_.getValueOrDefault(u._eyeOffset,e,w,D),c.heightReference=_.getValueOrDefault(u._heightReference,e,b),c.pixelOffset=_.getValueOrDefault(u._pixelOffset,e,E,M),c.scale=_.getValueOrDefault(u._scale,e,1),c.rotation=_.getValueOrDefault(u._rotation,e,0),c.alignedAxis=_.getValueOrDefault(u._alignedAxis,e,S),c.horizontalOrigin=_.getValueOrDefault(u._horizontalOrigin,e,x),c.verticalOrigin=_.getValueOrDefault(u._verticalOrigin,e,T),c.width=_.getValueOrUndefined(u._width,e),c.height=_.getValueOrUndefined(u._height,e),c.scaleByDistance=_.getValueOrUndefined(u._scaleByDistance,e,I),c.translucencyByDistance=_.getValueOrUndefined(u._translucencyByDistance,e,O),c.pixelOffsetScaleByDistance=_.getValueOrUndefined(u._pixelOffsetScaleByDistance,e,R),c.sizeInMeters=_.getValueOrDefault(u._sizeInMeters,!1),c.distanceDisplayCondition=_.getValueOrUndefined(u._distanceDisplayCondition,e,L);var d=_.getValueOrUndefined(u._imageSubRegion,e,N);a(d)&&c.setImageSubRegion(c._imageId,d)}else y(s,l,n)}return!0},v.prototype.getBoundingSphere=function(e,t){var n=this._items.get(e.id);if(!a(n)||!a(n.billboard))return f.FAILED;var i=n.billboard;if(i.heightReference===h.NONE)t.center=r.clone(i.position,t.center);else{if(!a(i._clampedPosition))return f.PENDING;t.center=r.clone(i._clampedPosition,t.center)}return t.radius=0,f.DONE},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(v.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return s(this)},v.prototype._onCollectionChanged=function(e,t,n,r){var i,o,s=this._items,l=this._cluster;for(i=t.length-1;i>-1;i--)o=t[i],a(o._billboard)&&a(o._position)&&s.set(o.id,new g(o));for(i=r.length-1;i>-1;i--)o=r[i],a(o._billboard)&&a(o._position)?s.contains(o.id)||s.set(o.id,new g(o)):(y(s.get(o.id),o,l),s.remove(o.id));for(i=n.length-1;i>-1;i--)o=n[i],y(s.get(o.id),o,l),s.remove(o.id)},v}),o("Shaders/Appearances/AllMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_binormalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nmat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_binormalEC);\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = tangentToEyeMatrix;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),o("Shaders/Appearances/AllMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 binormal;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_binormalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_tangentEC = czm_normal * tangent;\nv_binormalEC = czm_normal * binormal;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Shaders/Appearances/BasicMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),o("Shaders/Appearances/BasicMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Shaders/Appearances/TexturedMaterialAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);;\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),o("Shaders/Appearances/TexturedMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Scene/CullFace",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({FRONT:t.FRONT,BACK:t.BACK,FRONT_AND_BACK:t.FRONT_AND_BACK})}),o("Scene/Appearance",["../Core/clone","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","./BlendingState","./CullFace"],function(e,t,n,r,i,o,a){"use strict";function s(e){e=n(e,n.EMPTY_OBJECT),this.material=e.material,this.translucent=n(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=n(e.closed,!1)}return i(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),s.prototype.getFragmentShaderSource=function(){var e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),r(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},s.prototype.isTranslucent=function(){return r(this.material)&&this.material.isTranslucent()||!r(this.material)&&this.translucent},s.prototype.getRenderState=function(){var t=this.isTranslucent(),n=e(this.renderState,!1);return t?(n.depthMask=!1,n.blending=o.ALPHA_BLEND):n.depthMask=!0,n},s.getDefaultRenderState=function(e,n,i){var s={depthTest:{enabled:!0}};return e&&(s.depthMask=!1,s.blending=o.ALPHA_BLEND),n&&(s.cull={enabled:!0,face:a.BACK}),r(i)&&(s=t(i,s,!0)),s},s}),o("Renderer/CubeMapFace",["../Core/defaultValue","../Core/defineProperties","../Core/DeveloperError","./PixelDatatype"],function(e,t,n,r){"use strict";function i(e,t,n,r,i,o,a,s,l){this._gl=e,this._texture=t,this._textureTarget=n,this._targetFace=r,this._pixelFormat=i,this._pixelDatatype=o,this._size=a,this._preMultiplyAlpha=s,this._flipY=l}return t(i.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),i.prototype.copyFrom=function(t,n,r){n=e(n,0),r=e(r,0);var i=this._gl,o=this._textureTarget;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._preMultiplyAlpha),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this._flipY),i.activeTexture(i.TEXTURE0),i.bindTexture(o,this._texture),t.arrayBufferView?i.texSubImage2D(this._targetFace,0,n,r,t.width,t.height,this._pixelFormat,this._pixelDatatype,t.arrayBufferView):i.texSubImage2D(this._targetFace,0,n,r,this._pixelFormat,this._pixelDatatype,t),i.bindTexture(o,null)},i.prototype.copyFromFramebuffer=function(t,n,r,i,o,a){t=e(t,0),n=e(n,0),r=e(r,0),i=e(i,0),o=e(o,this._size),a=e(a,this._size);var s=this._gl,l=this._textureTarget;s.activeTexture(s.TEXTURE0),s.bindTexture(l,this._texture),s.copyTexSubImage2D(this._targetFace,0,t,n,r,i,o,a),s.bindTexture(l,null)},i}),o("Renderer/CubeMap",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/PixelFormat","./ContextLimits","./CubeMapFace","./MipmapHint","./PixelDatatype","./Sampler","./TextureMagnificationFilter","./TextureMinificationFilter","./TextureWrap"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(n){function r(e,t){t.arrayBufferView?_.texImage2D(e,0,d,u,u,0,d,p,t.arrayBufferView):_.texImage2D(e,0,d,d,p,t)}var i,o=(n=e(n,e.EMPTY_OBJECT)).context,s=n.source;t(s)?i=[s.positiveX,s.negativeX,s.positiveY,s.negativeY,s.positiveZ,s.negativeZ][0].width:i=n.width;var u=i,d=e(n.pixelFormat,a.RGBA),p=e(n.pixelDatatype,c.UNSIGNED_BYTE),f=n.preMultiplyAlpha||d===a.RGB||d===a.LUMINANCE,m=e(n.flipY,!0),_=o._gl,g=_.TEXTURE_CUBE_MAP,v=_.createTexture();_.activeTexture(_.TEXTURE0),_.bindTexture(g,v),t(s)?(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,m),r(_.TEXTURE_CUBE_MAP_POSITIVE_X,s.positiveX),r(_.TEXTURE_CUBE_MAP_NEGATIVE_X,s.negativeX),r(_.TEXTURE_CUBE_MAP_POSITIVE_Y,s.positiveY),r(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,s.negativeY),r(_.TEXTURE_CUBE_MAP_POSITIVE_Z,s.positiveZ),r(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,s.negativeZ)):(_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_X,0,d,u,u,0,d,p,null),_.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_X,0,d,u,u,0,d,p,null),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Y,0,d,u,u,0,d,p,null),_.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,d,u,u,0,d,p,null),_.texImage2D(_.TEXTURE_CUBE_MAP_POSITIVE_Z,0,d,u,u,0,d,p,null),_.texImage2D(_.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,d,u,u,0,d,p,null)),_.bindTexture(g,null),this._gl=_,this._textureFilterAnisotropic=o._textureFilterAnisotropic,this._textureTarget=g,this._texture=v,this._pixelFormat=d,this._pixelDatatype=p,this._size=u,this._preMultiplyAlpha=f,this._flipY=m,this._sampler=void 0,this._positiveX=new l(_,v,g,_.TEXTURE_CUBE_MAP_POSITIVE_X,d,p,u,f,m),this._negativeX=new l(_,v,g,_.TEXTURE_CUBE_MAP_NEGATIVE_X,d,p,u,f,m),this._positiveY=new l(_,v,g,_.TEXTURE_CUBE_MAP_POSITIVE_Y,d,p,u,f,m),this._negativeY=new l(_,v,g,_.TEXTURE_CUBE_MAP_NEGATIVE_Y,d,p,u,f,m),this._positiveZ=new l(_,v,g,_.TEXTURE_CUBE_MAP_POSITIVE_Z,d,p,u,f,m),this._negativeZ=new l(_,v,g,_.TEXTURE_CUBE_MAP_NEGATIVE_Z,d,p,u,f,m),this.sampler=t(n.sampler)?n.sampler:new h}return n(m.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var n=e.minificationFilter,r=e.magnificationFilter;this._pixelDatatype===c.FLOAT&&(n=n===p.NEAREST_MIPMAP_NEAREST||n===p.NEAREST_MIPMAP_LINEAR||n===p.LINEAR_MIPMAP_NEAREST||n===p.LINEAR_MIPMAP_LINEAR?p.NEAREST_MIPMAP_NEAREST:p.NEAREST,r=d.NEAREST);var i=this._gl,o=this._textureTarget;i.activeTexture(i.TEXTURE0),i.bindTexture(o,this._texture),i.texParameteri(o,i.TEXTURE_MIN_FILTER,n),i.texParameteri(o,i.TEXTURE_MAG_FILTER,r),i.texParameteri(o,i.TEXTURE_WRAP_S,e.wrapS),i.texParameteri(o,i.TEXTURE_WRAP_T,e.wrapT),t(this._textureFilterAnisotropic)&&i.texParameteri(o,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),i.bindTexture(o,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),m.prototype.generateMipmap=function(t){t=e(t,u.DONT_CARE);var n=this._gl,r=this._textureTarget;n.hint(n.GENERATE_MIPMAP_HINT,t),n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture),n.generateMipmap(r),n.bindTexture(r,null)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){return this._gl.deleteTexture(this._texture),this._positiveX=r(this._positiveX),this._negativeX=r(this._negativeX),this._positiveY=r(this._positiveY),this._negativeY=r(this._negativeY),this._positiveZ=r(this._positiveZ),this._negativeZ=r(this._negativeZ),r(this)},m}),o("Shaders/Materials/BumpMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n"}),o("Shaders/Materials/CheckerboardMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),o("Shaders/Materials/DotMaterial",[],function(){"use strict";return"uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),o("Shaders/Materials/FadeMaterial",[],function(){"use strict";return"uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),o("Shaders/Materials/GridMaterial",[],function(){"use strict";return"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec3 halfColor = color.rgb * 0.5;\nmaterial.diffuse = halfColor;\nmaterial.emission = halfColor;\nmaterial.alpha = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nreturn material;\n}\n"}),o("Shaders/Materials/NormalMapMaterial",[],function(){"use strict";return"uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n"}),o("Shaders/Materials/PolylineArrowMaterial",[],function(){"use strict";return"#extension GL_OES_standard_derivatives : enable\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),o("Shaders/Materials/PolylineGlowMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nmaterial.emission = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nmaterial.alpha = clamp(0.0, 1.0, glow) * color.a;\nreturn material;\n}\n"}),o("Shaders/Materials/PolylineOutlineMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n"}),o("Shaders/Materials/RimLightingMaterial",[],function(){"use strict";return"uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nmaterial.diffuse = color.rgb;\nmaterial.emission = rimColor.rgb * s;\nmaterial.alpha = mix(color.a, rimColor.a, s);\nreturn material;\n}\n"}),o("Shaders/Materials/StripeMaterial",[],function(){"use strict";return"uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n"}),o("Shaders/Materials/Water",[],function(){"use strict";return"uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n"}),o("Scene/Material",["../Core/Cartesian2","../Core/clone","../Core/Color","../Core/combine","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/isArray","../Core/loadImage","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Renderer/CubeMap","../Renderer/Texture","../Shaders/Materials/BumpMapMaterial","../Shaders/Materials/CheckerboardMaterial","../Shaders/Materials/DotMaterial","../Shaders/Materials/FadeMaterial","../Shaders/Materials/GridMaterial","../Shaders/Materials/NormalMapMaterial","../Shaders/Materials/PolylineArrowMaterial","../Shaders/Materials/PolylineGlowMaterial","../Shaders/Materials/PolylineOutlineMaterial","../Shaders/Materials/RimLightingMaterial","../Shaders/Materials/StripeMaterial","../Shaders/Materials/Water","../ThirdParty/when"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D){"use strict";function M(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,function(e,n){e=o(e,o.EMPTY_OBJECT),n._strict=o(e.strict,!1),n._count=o(e.count,0),n._template=t(o(e.fabric,o.EMPTY_OBJECT)),n._template.uniforms=t(o(n._template.uniforms,o.EMPTY_OBJECT)),n._template.materials=t(o(n._template.materials,o.EMPTY_OBJECT)),n.type=a(n._template.type)?n._template.type:i(),n.shaderSource="",n.materials={},n.uniforms={},n._uniforms={},n._translucentFunctions=[];var s,l=M._materialCache.getMaterial(n.type);if(a(l)){var u=t(l.fabric,!0);n._template=r(n._template,u,!0),s=l.translucent}(function(e){var t=n._template,r=t.uniforms,i=t.materials,o=t.components;I(t,F,O,!0),I(o,B,O,!0);var a=[];for(var s in i)i.hasOwnProperty(s)&&a.push(s);I(r,a,R,!1)})(),a(l)||M._materialCache.addMaterial(n.type,n),function(e){var t=e._template.components,n=e._template.source;if(a(n))e.shaderSource+=n+"\n";else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",a(t))for(var r in t)t.hasOwnProperty(r)&&(e.shaderSource+="material."+r+" = "+t[r]+";\n");e.shaderSource+="return material;\n}\n"}}(n),function(e){var t=e._template.uniforms;for(var n in t)t.hasOwnProperty(n)&&N(e,n)}(n),function(e){var t=e._strict,n=e._template.materials;for(var i in n)if(n.hasOwnProperty(i)){var o=new M({strict:t,fabric:n[i],count:e._count});e._count=o._count,e._uniforms=r(e._uniforms,o._uniforms,!0),e.materials[i]=o,e._translucentFunctions=e._translucentFunctions.concat(o._translucentFunctions);var a="czm_getMaterial_"+e._count++;L(o,"czm_getMaterial",a),e.shaderSource=o.shaderSource+e.shaderSource,L(e,i,a+"(materialInput)")}}(n),s=o(s,0===n._translucentFunctions.length||void 0),s=o(e.translucent,s),a(s)&&n._translucentFunctions.push("function"==typeof s?function(){return s(n)}:s)}(e,this),s(this,{type:{value:this.type,writable:!1}}),a(M._uniformList[this.type])||(M._uniformList[this.type]=Object.keys(this._uniforms))}function I(e,t,n,r){if(a(e))for(var i in e)if(e.hasOwnProperty(i)){var o=-1!==t.indexOf(i);(r&&!o||!r&&o)&&n(i,t)}}function O(e,t){}function R(e,t){}function N(e,t){var n,r,i,o,s=e._template.uniforms,l=s[t],u=function(e){var t=e.type;if(!a(t)){var n=typeof e;if("number"===n)t="float";else if("boolean"===n)t="bool";else if("string"===n||e instanceof HTMLCanvasElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===M.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===n)if(c(e))4!==e.length&&9!==e.length&&16!==e.length||(t="mat"+Math.sqrt(e.length));else{var r=0;for(var i in e)e.hasOwnProperty(i)&&(r+=1);r>=2&&r<=4?t="vec"+r:6===r&&(t="samplerCube")}}return t}(l);if("channels"===u)L(e,t,l,!1);else{if("sampler2D"===u){var d=t+"Dimensions";L(e,o=d,o,void 0)>0&&(s[d]={type:"ivec3",x:1,y:1},N(e,d))}new RegExp("uniform\\s+"+u+"\\s+"+t+"\\s*;").test(e.shaderSource)||(e.shaderSource="uniform "+u+" "+t+";"+e.shaderSource);var p=t+"_"+e._count++;if(L(e,t,p),e.uniforms[t]=l,"sampler2D"===u)e._uniforms[p]=function(){return e._textures[t]},e._updateFunctions.push((r=t,function(e,t){var n=e.uniforms,o=n[r],s=i!==o;i=o;var l,u,c=e._textures[r];if(o instanceof HTMLVideoElement)if(o.readyState>=2){if(s&&a(c)&&(c!==t.defaultTexture&&c.destroy(),c=void 0),!a(c)||c===t.defaultTexture)return c=new _({context:t,source:o}),void(e._textures[r]=c);c.copyFrom(o)}else a(c)||(e._textures[r]=t.defaultTexture);else{if(o instanceof _&&o!==c){e._texturePaths[r]=void 0;var d=e._textures[r];return d!==e._defaultTexture&&d.destroy(),e._textures[r]=o,void(n.hasOwnProperty(l=r+"Dimensions")&&(u=n[l],u.x=o._width,u.y=o._height))}a(c)||(e._texturePaths[r]=void 0,a(e._defaultTexture)||(e._defaultTexture=t.defaultTexture),c=e._textures[r]=e._defaultTexture,n.hasOwnProperty(l=r+"Dimensions")&&((u=n[l]).x=c._width,u.y=c._height)),o!==M.DefaultImageId&&o!==e._texturePaths[r]&&("string"==typeof o?D(h(o),function(t){e._loadedImages.push({id:r,image:t})}):o instanceof HTMLCanvasElement&&e._loadedImages.push({id:r,image:o}),e._texturePaths[r]=o)}}));else if("samplerCube"===u)e._uniforms[p]=function(){return e._textures[t]},e._updateFunctions.push((n=t,function(e,t){var r=e.uniforms[n];if(r instanceof m){var i=e._textures[n];return i!==e._defaultTexture&&i.destroy(),e._texturePaths[n]=void 0,void(e._textures[n]=r)}if(a(e._textures[n])||(e._texturePaths[n]=void 0,e._textures[n]=t.defaultCubeMap),r!==M.DefaultCubeMapId){var o=r.positiveX+r.negativeX+r.positiveY+r.negativeY+r.positiveZ+r.negativeZ;if(o!==e._texturePaths[n]){var s=[h(r.positiveX),h(r.negativeX),h(r.positiveY),h(r.negativeY),h(r.positiveZ),h(r.negativeZ)];D.all(s).then(function(t){e._loadedCubeMaps.push({id:n,images:t})}),e._texturePaths[n]=o}}}));else if(-1!==u.indexOf("mat")){var f=new k[u];e._uniforms[p]=function(){return k[u].fromColumnMajorArray(e.uniforms[t],f)}}else e._uniforms[p]=function(){return e.uniforms[t]}}}function L(e,t,n,r){r=o(r,!0);var i=0,a=new RegExp("([\\w"+(r?".":"")+"])?"+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(a,function(e,t,r){return t||r?e:(i+=1,n)}),i}M._uniformList={},M.fromType=function(e,t){var n=new M({fabric:{type:e}});if(a(t))for(var r in t)t.hasOwnProperty(r)&&(n.uniforms[r]=t[r]);return n},M.prototype.isTranslucent=function(){if(a(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;for(var e=!0,t=this._translucentFunctions,n=t.length,r=0;r<n;++r){var i=t[r];if(!(e="function"==typeof i?e&&i():e&&i))break}return e},M.prototype.update=function(e){var t,n,r=this._loadedImages,i=r.length;for(t=0;t<i;++t){var o=r[t];n=o.id;var a=new _({context:e,source:o.image});this._textures[n]=a;var s=n+"Dimensions";if(this.uniforms.hasOwnProperty(s)){var l=this.uniforms[s];l.x=a._width,l.y=a._height}}r.length=0;var u=this._loadedCubeMaps;for(i=u.length,t=0;t<i;++t){var c=u[t];n=c.id;var h=c.images,d=new m({context:e,source:{positiveX:h[0],negativeX:h[1],positiveY:h[2],negativeY:h[3],positiveZ:h[4],negativeZ:h[5]}});this._textures[n]=d}u.length=0;var p=this._updateFunctions;for(i=p.length,t=0;t<i;++t)p[t](this,e);var f=this.materials;for(var g in f)f.hasOwnProperty(g)&&f[g].update(e)},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){var e=this._textures;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];n!==this._defaultTexture&&n.destroy()}var r=this.materials;for(var i in r)r.hasOwnProperty(i)&&r[i].destroy();return l(this)};var F=["type","materials","uniforms","components","source"],B=["diffuse","specular","shininess","normal","emission","alpha"],k={mat2:d,mat3:p,mat4:f};return M._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},M.DefaultImageId="czm_defaultImage",M.DefaultCubeMapId="czm_defaultCubeMap",M._materialCache.addMaterial(M.ColorType="Color",{fabric:{type:M.ColorType,uniforms:{color:new n(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),M._materialCache.addMaterial(M.ImageType="Image",{fabric:{type:M.ImageType,uniforms:{image:M.DefaultImageId,repeat:new e(1,1),color:new n(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),M._materialCache.addMaterial(M.DiffuseMapType="DiffuseMap",{fabric:{type:M.DiffuseMapType,uniforms:{image:M.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),M._materialCache.addMaterial(M.AlphaMapType="AlphaMap",{fabric:{type:M.AlphaMapType,uniforms:{image:M.DefaultImageId,channel:"a",repeat:new e(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),M._materialCache.addMaterial(M.SpecularMapType="SpecularMap",{fabric:{type:M.SpecularMapType,uniforms:{image:M.DefaultImageId,channel:"r",repeat:new e(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),M._materialCache.addMaterial(M.EmissionMapType="EmissionMap",{fabric:{type:M.EmissionMapType,uniforms:{image:M.DefaultImageId,channels:"rgb",repeat:new e(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),M._materialCache.addMaterial(M.BumpMapType="BumpMap",{fabric:{type:M.BumpMapType,uniforms:{image:M.DefaultImageId,channel:"r",strength:.8,repeat:new e(1,1)},source:g},translucent:!1}),M._materialCache.addMaterial(M.NormalMapType="NormalMap",{fabric:{type:M.NormalMapType,uniforms:{image:M.DefaultImageId,channels:"rgb",strength:.8,repeat:new e(1,1)},source:b},translucent:!1}),M._materialCache.addMaterial(M.GridType="Grid",{fabric:{type:M.GridType,uniforms:{color:new n(0,1,0,1),cellAlpha:.1,lineCount:new e(8,8),lineThickness:new e(1,1),lineOffset:new e(0,0)},source:w},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),M._materialCache.addMaterial(M.StripeType="Stripe",{fabric:{type:M.StripeType,uniforms:{horizontal:!0,evenColor:new n(1,1,1,.5),oddColor:new n(0,0,1,.5),offset:0,repeat:5},source:A},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<0}}),M._materialCache.addMaterial(M.CheckerboardType="Checkerboard",{fabric:{type:M.CheckerboardType,uniforms:{lightColor:new n(1,1,1,.5),darkColor:new n(0,0,0,.5),repeat:new e(5,5)},source:v},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),M._materialCache.addMaterial(M.DotType="Dot",{fabric:{type:M.DotType,uniforms:{lightColor:new n(1,1,0,.75),darkColor:new n(0,1,1,.75),repeat:new e(5,5)},source:y},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<0}}),M._materialCache.addMaterial(M.WaterType="Water",{fabric:{type:M.WaterType,uniforms:{baseWaterColor:new n(.2,.3,.6,1),blendColor:new n(0,1,.699,1),specularMap:M.DefaultImageId,normalMap:M.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:P},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<0}}),M._materialCache.addMaterial(M.RimLightingType="RimLighting",{fabric:{type:M.RimLightingType,uniforms:{color:new n(1,0,0,.7),rimColor:new n(1,1,1,.4),width:.3},source:T},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<0}}),M._materialCache.addMaterial(M.FadeType="Fade",{fabric:{type:M.FadeType,uniforms:{fadeInColor:new n(1,0,0,1),fadeOutColor:new n(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new e(.5,.5)},source:C},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<0}}),M._materialCache.addMaterial(M.PolylineArrowType="PolylineArrow",{fabric:{type:M.PolylineArrowType,uniforms:{color:new n(1,1,1,1)},source:E},translucent:!0}),M._materialCache.addMaterial(M.PolylineGlowType="PolylineGlow",{fabric:{type:M.PolylineGlowType,uniforms:{color:new n(0,.5,1,1),glowPower:.25},source:S},translucent:!0}),M._materialCache.addMaterial(M.PolylineOutlineType="PolylineOutline",{fabric:{type:M.PolylineOutlineType,uniforms:{color:new n(1,1,1,1),outlineColor:new n(1,0,0,1),outlineWidth:1},source:x},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),M}),o("Scene/MaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/freezeObject","../Core/VertexFormat","../Shaders/Appearances/AllMaterialAppearanceFS","../Shaders/Appearances/AllMaterialAppearanceVS","../Shaders/Appearances/BasicMaterialAppearanceFS","../Shaders/Appearances/BasicMaterialAppearanceVS","../Shaders/Appearances/TexturedMaterialAppearanceFS","../Shaders/Appearances/TexturedMaterialAppearanceVS","./Appearance","./Material"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.translucent,!0),i=e(n.closed,!1),o=e(n.materialSupport,p.MaterialSupport.TEXTURED);this.material=t(n.material)?n.material:d.fromType(d.ColorType),this.translucent=r,this._vertexShaderSource=e(n.vertexShaderSource,o.vertexShaderSource),this._fragmentShaderSource=e(n.fragmentShaderSource,o.fragmentShaderSource),this._renderState=h.getDefaultRenderState(r,i,n.renderState),this._closed=i,this._materialSupport=o,this._vertexFormat=o.vertexFormat,this._flat=e(n.flat,!1),this._faceForward=e(n.faceForward,!i)}return n(p.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),p.prototype.getFragmentShaderSource=h.prototype.getFragmentShaderSource,p.prototype.isTranslucent=h.prototype.isTranslucent,p.prototype.getRenderState=h.prototype.getRenderState,p.MaterialSupport={BASIC:r({vertexFormat:i.POSITION_AND_NORMAL,vertexShaderSource:l,fragmentShaderSource:s}),TEXTURED:r({vertexFormat:i.POSITION_NORMAL_AND_ST,vertexShaderSource:c,fragmentShaderSource:u}),ALL:r({vertexFormat:i.ALL,vertexShaderSource:a,fragmentShaderSource:o})},p}),o("Shaders/Appearances/PerInstanceColorAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getDefaultMaterial(materialInput);\nmaterial.diffuse = v_color.rgb;\nmaterial.alpha = v_color.a;\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n}\n"}),o("Shaders/Appearances/PerInstanceColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Shaders/Appearances/PerInstanceFlatColorAppearanceFS",[],function(){"use strict";return"varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n"}),o("Shaders/Appearances/PerInstanceFlatColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Scene/PerInstanceColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceColorAppearanceFS","../Shaders/Appearances/PerInstanceColorAppearanceVS","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Appearance"],function(e,t,n,r,i,o,a,s){"use strict";function l(t){t=e(t,e.EMPTY_OBJECT);var n=e(t.translucent,!0),u=e(t.closed,!1),c=e(t.flat,!1),h=c?a:i,d=c?o:r,p=c?l.FLAT_VERTEX_FORMAT:l.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=e(t.vertexShaderSource,h),this._fragmentShaderSource=e(t.fragmentShaderSource,d),this._renderState=s.getDefaultRenderState(n,u,t.renderState),this._closed=u,this._vertexFormat=p,this._flat=c,this._faceForward=e(t.faceForward,!u)}return t(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),l.VERTEX_FORMAT=n.POSITION_AND_NORMAL,l.FLAT_VERTEX_FORMAT=n.POSITION_ONLY,l.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,l.prototype.isTranslucent=s.prototype.isTranslucent,l.prototype.getRenderState=s.prototype.getRenderState,l}),o("Scene/BatchTable",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/combine","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/PixelFormat","../Core/RuntimeError","../Renderer/ContextLimits","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";function g(t,r){this._attributes=t,this._numberOfInstances=r;var o=function(e){for(var t=!1,n=e.length,r=0;r<n;++r)if(e[r].componentDatatype!==i.UNSIGNED_BYTE){t=!0;break}return t?d.FLOAT:d.UNSIGNED_BYTE}(t),a=t.length,s=Math.floor(h.maximumTextureSize/a),l=Math.min(r,s),u=a*l,c=Math.ceil(r/l),p=1/u,f=.5*p,m=1/c,_=.5*m;this._textureDimensions=new e(u,c),this._textureStep=new n(p,f,m,_),this._pixelDatatype=o,this._texture=void 0;var g=u*c*4;this._batchValues=o===d.FLOAT?new Float32Array(g):new Uint8Array(g),this._batchValuesDirty=!1}function v(r,i){var o=r[i].componentsPerAttribute;return 2===o?e:3===o?t:4===o?n:Number}a(g.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var y=new n;g.prototype.getBatchedAttribute=function(e,t,r){var i=this._attributes,a=n.unpack(this._batchValues,4*i.length*e+4*t,y),s=v(i,t);return o(s.fromCartesian4)?s.fromCartesian4(a,r):o(s.clone)?s.clone(a,r):a.x};var C=[void 0,void 0,new e,new t,new n],w=new n;return g.prototype.setBatchedAttribute=function(e,t,r){var i=this._attributes,a=this.getBatchedAttribute(e,t,C[i[t].componentsPerAttribute]),s=v(this._attributes,t);if(!(o(s.equals)?s.equals(a,r):a===r)){var l=w;l.x=o(r.x)?r.x:r,l.y=o(r.y)?r.y:0,l.z=o(r.z)?r.z:0,l.w=o(r.w)?r.w:0,n.pack(l,this._batchValues,4*i.length*e+4*t),this._batchValuesDirty=!0}},g.prototype.update=function(e){var t,n,r,i,a=e.context;if(this._pixelDatatype===d.FLOAT&&!a.floatingPointTexture)throw new c("The floating point texture extension is required but not supported.");o(this._texture)&&!this._batchValuesDirty||(this._batchValuesDirty=!1,o(this._texture)||((r=this)._texture=new f({context:a,pixelFormat:u.RGBA,pixelDatatype:r._pixelDatatype,width:(i=r._textureDimensions).x,height:i.y,sampler:new p({minificationFilter:_.NEAREST,magnificationFilter:m.NEAREST})})),(t=this)._texture.copyFrom({width:(n=t._textureDimensions).x,height:n.y,arrayBufferView:t._batchValues}))},g.prototype.getUniformMapCallback=function(){var e=this;return function(t){return r(t,{batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}})}},g.prototype.getVertexShaderCallback=function(){var e,t,n,r,o,a,s,l,u,c="uniform sampler2D batchTexture; \n";c+=(e=this._attributes.length,(1===this._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+e+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+e+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), 1.0 - (centerY + (yId * stepY))); \n} \n")+"\n");for(var h=this._attributes.length,p=0;p<h;++p)c+=(t=this,n=p,r=void 0,o=void 0,u=void 0,a=t._attributes[n],s=a.componentsPerAttribute,l=1===(o=s)?"float":"vec"+o,u=l+" "+a.functionName+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+n+"); \n    vec4 textureValue = texture2D(batchTexture, st); \n    "+l+" value = textureValue"+(1===(r=s)?".x":2===r?".xy":3===r?".xyz":"")+"; \n",t._pixelDatatype!==d.UNSIGNED_BYTE||a.normalize?t._pixelDatatype===d.FLOAT&&a.componentDatatype===i.UNSIGNED_BYTE&&a.normalize&&(u+="value /= 255.0; \n"):u+="value *= 255.0; \n",u+"    return value; \n} \n");return function(e){var t=e.indexOf("void main"),n=e.substring(0,t),r=e.substring(t);return n+"\n"+c+"\n"+r}},g.prototype.isDestroyed=function(){return!1},g.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),s(this)},g}),o("Scene/PrimitivePipeline",["../Core/BoundingSphere","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/FeatureDetection","../Core/GeographicProjection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Matrix4","../Core/WebMercatorProjection"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m){"use strict";function _(e,t){var r=e.attributes,i=r.position,o=i.values.length/i.componentsPerAttribute;r.batchId=new c({componentDatatype:n.FLOAT,componentsPerAttribute:1,values:new Float32Array(o)});for(var a=r.batchId.values,s=0;s<o;++s)a[s]=t}function g(e,t,n,r){var o,a,s,l=r.length-1;if(l>=0){var u=r[l];o=u.offset+u.count,a=n[s=u.index].indices.length}else o=0,s=0,a=n[s].indices.length;for(var c=e.length,h=0;h<c;++h){var d=e[h][t];if(i(d)){var p=d.indices.length;o+p>a&&(o=0,a=n[++s].indices.length),r.push({index:s,offset:o,count:p}),o+=p}}}function v(e,t){var n=e.attributes;for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];i(o)&&i(o.values)&&t.push(o.values.buffer)}i(e.indices)&&t.push(e.indices.buffer)}function y(t){var n=t.length,r=new Float32Array(1+(e.packedLength+1)*n),o=0;r[o++]=n;for(var a=0;a<n;++a)i(t[a])?(r[o++]=1,e.pack(t[a],r,o)):r[o++]=0,o+=e.packedLength;return r}function C(t){for(var n=new Array(t[0]),r=0,i=1;i<t.length;)1===t[i++]&&(n[r]=e.unpack(t,i)),++r,i+=e.packedLength;return n}if(!s.supportsTypedArrays())return{};var w={};return w.combineGeometry=function(t){var r,o,a,s,l,u,c=t.instances,h=c.length;h>0&&(r=function(r){var o,a,s=t.instances,l=t.projection,u=t.elementIndexUintSupported,c=t.scene3DOnly,h=t.vertexCacheOptimize,p=t.compressVertices,m=t.modelMatrix,g=s.length;for(o=0;o<g&&!i(s[o].geometry);++o);if(function(e,t,n){var r,o=!c,a=e.length;if(!o&&a>1){var s=e[0].modelMatrix;for(r=1;r<a;++r)if(!f.equals(s,e[r].modelMatrix)){o=!0;break}}if(o)for(r=0;r<a;++r)i(e[r].geometry)&&d.transformToWorldCoordinates(e[r]);else f.multiplyTransformation(t,e[0].modelMatrix,t)}(s,m),!c)for(o=0;o<g;++o)i(s[o].geometry)&&d.splitLongitude(s[o]);if(function(e){for(var t=e.length,n=0;n<t;++n){var r=e[n];i(r.geometry)?_(r.geometry,n):i(r.westHemisphereGeometry)&&i(r.eastHemisphereGeometry)&&(_(r.westHemisphereGeometry,n),_(r.eastHemisphereGeometry,n))}}(s),h)for(o=0;o<g;++o){var v=s[o];i(v.geometry)?(d.reorderForPostVertexCache(v.geometry),d.reorderForPreVertexCache(v.geometry)):i(v.westHemisphereGeometry)&&i(v.eastHemisphereGeometry)&&(d.reorderForPostVertexCache(v.westHemisphereGeometry),d.reorderForPreVertexCache(v.westHemisphereGeometry),d.reorderForPostVertexCache(v.eastHemisphereGeometry),d.reorderForPreVertexCache(v.eastHemisphereGeometry))}var y=d.combineInstances(s);for(g=y.length,o=0;o<g;++o){var C,w=(a=y[o]).attributes;if(c)for(C in w)w.hasOwnProperty(C)&&w[C].componentDatatype===n.DOUBLE&&d.encodeAttribute(a,C,C+"3DHigh",C+"3DLow");else for(C in w)if(w.hasOwnProperty(C)&&w[C].componentDatatype===n.DOUBLE){var b=C+"3D",E=C+"2D";d.projectTo2D(a,C,b,E,l),i(a.boundingSphere)&&"position"===C&&(a.boundingSphereCV=e.fromVertices(a.attributes.position2D.values)),d.encodeAttribute(a,b,b+"High",b+"Low"),d.encodeAttribute(a,E,E+"High",E+"Low")}p&&d.compressVertices(a)}if(!u){var S=[];for(g=y.length,o=0;o<g;++o)a=y[o],S=S.concat(d.fitToUnsignedShortIndices(a));y=S}return y}()).length>0&&(o=d.createAttributeLocations(r[0])),t.createPickOffsets&&r.length>0&&(g(s=c,"geometry",l=r,u=[]),g(s,"westHemisphereGeometry",l,u),g(s,"eastHemisphereGeometry",l,u),a=u);for(var p=new Array(h),m=new Array(h),v=0;v<h;++v){var y=c[v],C=y.geometry;i(C)&&(p[v]=C.boundingSphere,m[v]=C.boundingSphereCV);var w=y.eastHemisphereGeometry,b=y.westHemisphereGeometry;i(w)&&i(b)&&(i(w.boundingSphere)&&i(b.boundingSphere)&&(p[v]=e.union(w.boundingSphere,b.boundingSphere)),i(w.boundingSphereCV)&&i(b.boundingSphereCV)&&(m[v]=e.union(w.boundingSphereCV,b.boundingSphereCV)))}return{geometries:r,modelMatrix:t.modelMatrix,attributeLocations:o,pickOffsets:a,boundingSpheres:p,boundingSpheresCV:m}},w.packCreateGeometryResults=function(t,n){var r=new Float64Array(function(t){for(var n=1,r=t.length,o=0;o<r;o++){var a=t[o];if(++n,i(a)){var s=a.attributes;n+=6+2*e.packedLength+(i(a.indices)?a.indices.length:0);for(var l in s)s.hasOwnProperty(l)&&i(s[l])&&(n+=5+s[l].values.length)}}return n}(t)),o=[],a={},s=t.length,l=0;r[l++]=s;for(var u=0;u<s;u++){var c=t[u],h=i(c);if(r[l++]=h?1:0,h){r[l++]=c.primitiveType,r[l++]=c.geometryType;var d=i(c.boundingSphere)?1:0;r[l++]=d,d&&e.pack(c.boundingSphere,r,l),l+=e.packedLength;var p=i(c.boundingSphereCV)?1:0;r[l++]=p,p&&e.pack(c.boundingSphereCV,r,l),l+=e.packedLength;var f=c.attributes,m=[];for(var _ in f)f.hasOwnProperty(_)&&i(f[_])&&(m.push(_),i(a[_])||(a[_]=o.length,o.push(_)));r[l++]=m.length;for(var g=0;g<m.length;g++){var v=m[g],y=f[v];r[l++]=a[v],r[l++]=y.componentDatatype,r[l++]=y.componentsPerAttribute,r[l++]=y.normalize?1:0,r[l++]=y.values.length,r.set(y.values,l),l+=y.values.length}var C=i(c.indices)?c.indices.length:0;r[l++]=C,C>0&&(r.set(c.indices,l),l+=C)}}return n.push(r.buffer),{stringTable:o,packedData:r}},w.unpackCreateGeometryResults=function(t){for(var r,i=t.stringTable,o=t.packedData,a=new Array(o[0]),s=0,l=1;l<o.length;)if(1===o[l++]){var d,f,m=o[l++],_=o[l++];1===o[l++]&&(d=e.unpack(o,l)),l+=e.packedLength,1===o[l++]&&(f=e.unpack(o,l)),l+=e.packedLength;var g,v,y,C,w=new h,b=o[l++];for(r=0;r<b;r++){var E=i[o[l++]],S=o[l++];y=o[l++];var x=0!==o[l++];g=o[l++],v=n.createTypedArray(S,g);for(var T=0;T<g;T++)v[T]=o[l++];w[E]=new c({componentDatatype:S,componentsPerAttribute:y,normalize:x,values:v})}if((g=o[l++])>0)for(C=p.createTypedArray(v.length/y,g),r=0;r<g;r++)C[r]=o[l++];a[s++]=new u({primitiveType:m,geometryType:_,boundingSphere:d,boundingSphereCV:f,indices:C,attributes:w})}else a[s++]=void 0;return a},w.packCombineGeometryParameters=function(e,t){for(var n=e.createGeometryResults,r=n.length,i=0;i<r;i++)t.push(n[i].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:function(e,t){var n=e.length,r=new Float64Array(1+16*n),i=0;r[i++]=n;for(var o=0;o<n;o++)f.pack(e[o].modelMatrix,r,i),i+=f.packedLength;return t.push(r.buffer),r}(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof l,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},w.unpackCombineGeometryParameters=function(e){for(var t=function(t){for(var n=e.packedInstances,r=new Array(n[0]),i=0,o=1;o<n.length;){var a=f.unpack(n,o);o+=f.packedLength,r[i++]={modelMatrix:a}}return r}(),n=e.createGeometryResults,r=n.length,i=0,o=0;o<r;o++)for(var s=w.unpackCreateGeometryResults(n[o]),u=s.length,c=0;c<u;c++)t[i].geometry=s[c],++i;var h=a.clone(e.ellipsoid);return{instances:t,ellipsoid:h,projection:e.isGeographic?new l(h):new m(h),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:f.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},w.packCombineGeometryResults=function(e,t){i(e.geometries)&&function(e,t){for(var n=e.length,r=0;r<n;++r)v(e[r],t)}(e.geometries,t);var n=y(e.boundingSpheres),r=y(e.boundingSpheresCV);return t.push(n.buffer,r.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:n,boundingSpheresCV:r}},w.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,boundingSpheres:C(e.boundingSpheres),boundingSpheresCV:C(e.boundingSpheresCV)}},w}),o("Scene/PrimitiveState",["../Core/freezeObject"],function(e){"use strict";return e({READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6})}),o("Scene/ShadowMode",["../Core/freezeObject"],function(e){"use strict";var t={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4};return t.castShadows=function(e){return e===t.ENABLED||e===t.CAST_ONLY},t.receiveShadows=function(e){return e===t.ENABLED||e===t.RECEIVE_ONLY},t.fromCastReceive=function(e,n){return e&&n?t.ENABLED:e?t.CAST_ONLY:n?t.RECEIVE_ONLY:t.DISABLED},e(t)}),o("Scene/Primitive",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryInstance","../Core/GeometryInstanceAttribute","../Core/isArray","../Core/Matrix4","../Core/RuntimeError","../Core/subdivideArray","../Core/TaskProcessor","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../ThirdParty/when","./BatchTable","./CullFace","./Pass","./PrimitivePipeline","./PrimitiveState","./SceneMode","./ShadowMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U){"use strict";function G(e){e=u(e,u.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.modelMatrix=b.clone(u(e.modelMatrix,b.IDENTITY)),this._modelMatrix=new b,this.show=u(e.show,!0),this._vertexCacheOptimize=u(e.vertexCacheOptimize,!1),this._interleave=u(e.interleave,!1),this._releaseGeometryInstances=u(e.releaseGeometryInstances,!0),this._allowPicking=u(e.allowPicking,!0),this._asynchronous=u(e.asynchronous,!0),this._compressVertices=u(e.compressVertices,!0),this.cull=u(e.cull,!0),this.debugShowBoundingVolume=u(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,this.shadows=u(e.shadows,U.DISABLED),this._translucent=void 0,this._state=V.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._pickRS=void 0,this._pickSP=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=N.defer(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}function W(e){var i=e.length;return 1===i?e[0]:2===i?t.unpack(e,0,$):3===i?n.unpack(e,0,ee):4===i?r.unpack(e,0,te):void 0}function H(t){var n,r,i,o=t.attributes,a=new v;for(var s in o)o.hasOwnProperty(s)&&c(o[s])&&(a[s]=(n=o[s],r=void 0,r=w(n.values)?n.values.slice(0):new n.values.constructor(n.values),new g({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:r})));if(c(t.indices)){var l=t.indices;i=w(l)?l.slice(0):new l.constructor(l)}return new _({attributes:a,indices:i,primitiveType:t.primitiveType,boundingSphere:e.clone(t.boundingSphere)})}function j(e,t){return function(){return e[t]}}function q(e,t,n,r){var i,a=n.getRenderState();r?((i=o(a,!1)).cull={enabled:!0,face:F.BACK},e._frontFaceRS=M.fromCache(i),i.cull.face=F.FRONT,e._backFaceRS=M.fromCache(i)):(e._frontFaceRS=M.fromCache(a),e._backFaceRS=e._frontFaceRS),e.allowPicking?r?((i=o(a,!1)).cull={enabled:!1},e._pickRS=M.fromCache(i)):e._pickRS=e._frontFaceRS:((i=o(a,!1)).colorMask={red:!1,green:!1,blue:!1,alpha:!1},r?(i.cull={enabled:!1},e._pickRS=M.fromCache(i)):e._pickRS=M.fromCache(i))}function Y(e,t,n){var r=t.context,i=e._attributeLocations,o=e._batchTable.getVertexShaderCallback()(n.vertexShaderSource);o=G._appendShowToShader(e,o),o=G._appendDistanceDisplayConditionToShader(e,o,t.scene3DOnly),o=function(e,t){if(!e.compressVertices)return t;var n=-1!==t.search(/attribute\s+vec3\s+normal;/g),r=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!n&&!r)return t;var i=-1!==t.search(/attribute\s+vec3\s+tangent;/g),o=-1!==t.search(/attribute\s+vec3\s+binormal;/g),a=r&&n?2:1,s="compressedAttributes",l="attribute "+((a+=i||o?1:0)>1?"vec"+a:"float")+" "+s+";",u="",c="";r&&(u+="vec2 st;\n",c+="    st = czm_decompressTextureCoordinates("+(a>1?s+".x":s)+");\n"),n&&i&&o?(u+="vec3 normal;\nvec3 tangent;\nvec3 binormal;\n",c+="    czm_octDecode("+s+"."+(r?"yz":"xy")+", normal, tangent, binormal);\n"):(n&&(u+="vec3 normal;\n",c+="    normal = czm_octDecode("+s+(a>1?"."+(r?"y":"x"):"")+");\n"),i&&(u+="vec3 tangent;\n",c+="    tangent = czm_octDecode("+s+"."+(r&&n?"z":"y")+");\n"),o&&(u+="vec3 binormal;\n",c+="    binormal = czm_octDecode("+s+"."+(r&&n?"z":"y")+");\n"));var h=t;return h=(h=(h=(h=h.replace(/attribute\s+vec3\s+normal;/g,"")).replace(/attribute\s+vec2\s+st;/g,"")).replace(/attribute\s+vec3\s+tangent;/g,"")).replace(/attribute\s+vec3\s+binormal;/g,""),[l,u,h=O.replaceMain(h,"czm_non_compressed_main"),"void main() \n{ \n"+c+"    czm_non_compressed_main(); \n}"].join("\n")}(e,o=G._updateColorAttribute(e,o)),o=G._modifyShaderPosition(e,o,t.scene3DOnly);var a=n.getFragmentShaderSource();if(e.allowPicking){var s=O.createPickVertexShaderSource(o);s=G._updatePickColorAttribute(s),e._pickSP=I.replaceCache({context:r,shaderProgram:e._pickSP,vertexShaderSource:s,fragmentShaderSource:O.createPickFragmentShaderSource(a,"varying"),attributeLocations:i})}else e._pickSP=I.fromCache({context:r,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:i});e._sp=I.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:o,fragmentShaderSource:a,attributeLocations:i})}function X(e,t,n,r,i,o,a,l){var u=c(n)?n._uniforms:void 0,h={},d=t.uniforms;if(c(d))for(var p in d)d.hasOwnProperty(p)&&(h[p]=j(d,p));var f=s(h,u);f=e._batchTable.getUniformMapCallback()(f),c(e.rtcCenter)&&(f.u_modifiedModelView=function(){return b.multiply(l.context.uniformState.view,e._modelMatrix,ue),b.multiplyByPoint(ue,e.rtcCenter,ce),b.setTranslation(ue,ce,ue),ue});var m=r?B.TRANSLUCENT:B.OPAQUE;o.length=e._va.length*(i?2:1),a.length=e._va.length;for(var _=o.length,g=0,v=0,y=0;y<_;++y){var C;i&&(c(C=o[y])||(C=o[y]=new D({owner:e,primitiveType:e._primitiveType})),C.vertexArray=e._va[v],C.renderState=e._backFaceRS,C.shaderProgram=e._sp,C.uniformMap=f,C.pass=m,++y),c(C=o[y])||(C=o[y]=new D({owner:e,primitiveType:e._primitiveType})),C.vertexArray=e._va[v],C.renderState=e._frontFaceRS,C.shaderProgram=e._sp,C.uniformMap=f,C.pass=m;var w=a[g];c(w)||(w=a[g]=new D({owner:e,primitiveType:e._primitiveType})),w.vertexArray=e._va[v],w.renderState=e._pickRS,w.shaderProgram=e._pickSP,w.uniformMap=f,w.pass=m,++g,++v}}function Z(t,n,r,i,o,a,s,l){if(function(e,t){var n=e.appearance.pixelSize;if(c(n))for(var r=e._boundingSpheres.length,i=0;i<r;++i){var o=e._boundingSpheres[i],a=e._boundingSphereWC[i],s=t.camera.getPixelSize(o,t.context.drawingBufferWidth,t.context.drawingBufferHeight);a.radius=o.radius+s*n}}(t,n),!b.equals(o,t._modelMatrix)){b.clone(o,t._modelMatrix);for(var u=t._boundingSpheres.length,h=0;h<u;++h){var d=t._boundingSpheres[h];c(d)&&(t._boundingSphereWC[h]=e.transform(d,o,t._boundingSphereWC[h]),n.scene3DOnly||(t._boundingSphere2D[h]=e.clone(t._boundingSphereCV[h],t._boundingSphere2D[h]),t._boundingSphere2D[h].center.x=0,t._boundingSphereMorph[h]=e.union(t._boundingSphereWC[h],t._boundingSphereCV[h])))}}var p;n.mode===z.SCENE3D?p=t._boundingSphereWC:n.mode===z.COLUMBUS_VIEW?p=t._boundingSphereCV:n.mode===z.SCENE2D&&c(t._boundingSphere2D)?p=t._boundingSphere2D:c(t._boundingSphereMorph)&&(p=t._boundingSphereMorph);var f=n.commandList,m=n.passes;if(m.render)for(var _=U.castShadows(t.shadows),g=U.receiveShadows(t.shadows),v=r.length,y=0;y<v;++y){var C=l?Math.floor(y/2):y,w=r[y];w.modelMatrix=o,w.boundingVolume=p[C],w.cull=a,w.debugShowBoundingVolume=s,w.castShadows=_,w.receiveShadows=g,f.push(w)}if(m.pick)for(var E=i.length,S=0;S<E;++S){var x=i[S];x.modelMatrix=o,x.boundingVolume=p[S],x.cull=a,f.push(x)}}function K(e,t,n){return function(){var r=e.getBatchedAttribute(t,n),i=e.attributes[n],o=l.createTypedArray(i.componentDatatype,i.componentsPerAttribute);return c(r.constructor.pack)?r.constructor.pack(r,o,0):o[0]=r,o}}function Q(e,t,n){return function(r){var i=W(r);e.setBatchedAttribute(t,n,i)}}function J(e,t,n,r){e._error=r,e._state=n,t.afterRender.push(function(){e._ready=e._state===V.COMPLETE||e._state===V.FAILED,c(r)?e._readyPromise.reject(r):e._readyPromise.resolve(e)})}h(G.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var $=new t,ee=new n,te=new r,ne=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;G._modifyShaderPosition=function(e,t,n){for(var r,i="",o="",a="";null!==(r=ne.exec(t));){var s=r[1],l="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==l&&(i+=l+";\n"),c(e.rtcCenter)?(i+="uniform mat4 u_modifiedModelView;\n",o+="attribute vec4 position;\n",a+=l+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=(t=(t=(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"")).replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"")).replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"")).replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):n?a+=l+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(o+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",a+=l+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[i,o,t,a].join("\n")},G._appendShowToShader=function(e,t){return c(e._batchTableAttributeIndices.show)?O.replaceMain(t,"czm_non_show_main")+"\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}":t},G._updateColorAttribute=function(e,t){return c(e._batchTableAttributeIndices.color)?-1===t.search(/attribute\s+vec4\s+color;/g)?t:t.replace(/attribute\s+vec4\s+color;/g,"").replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2"):t},G._updatePickColorAttribute=function(e){return e.replace(/attribute\s+vec4\s+pickColor;/g,"").replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2")},G._appendDistanceDisplayConditionToShader=function(e,t,n){if(!c(e._batchTableAttributeIndices.distanceDisplayCondition))return t;var r="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return O.replaceMain(t,"czm_non_distanceDisplayCondition_main")+"\n"+(r+=n?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n")+"    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}"};var re,ie=Math.max(m.hardwareConcurrency-1,1),oe=new x("combineGeometry",Number.POSITIVE_INFINITY),ae=new f,se=new i,le=new n,ue=new b,ce=new n;return G.prototype.update=function(t){if(!(!c(this.geometryInstances)&&0===this._va.length||c(this.geometryInstances)&&w(this.geometryInstances)&&0===this.geometryInstances.length||!c(this.appearance)||t.mode!==z.SCENE3D&&t.scene3DOnly||!t.passes.render&&!t.passes.pick)){if(c(this._error))throw this._error;if(this._state!==V.FAILED){var n=t.context;if(c(this._batchTable)||function(e,t){var n=e.geometryInstances,r=w(n)?n:[n],i=r.length;if(0!==i){var o,s,h,d=function(e){var t,n=e.length,r=[],i=e[0].attributes;for(t in i)if(i.hasOwnProperty(t)){for(var o=i[t],a=!0,s=1;s<n;++s){var l=e[s].attributes[t];if(!c(l)||o.componentDatatype!==l.componentDatatype||o.componentsPerAttribute!==l.componentsPerAttribute||o.normalize!==l.normalize){a=!1;break}}a&&r.push(t)}return r}(r),p=d.length,f=e.allowPicking,m=[],_={},g={},v=r[0].attributes;for(o=0;o<p;++o)s=d[o],h=v[s],_[s]=o,m.push({functionName:"czm_batchTable_"+s,componentDatatype:h.componentDatatype,componentsPerAttribute:h.componentsPerAttribute,normalize:h.normalize});-1!==d.indexOf("distanceDisplayCondition")&&(m.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:l.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:l.FLOAT,componentsPerAttribute:1}),g.center3DHigh=m.length-5,g.center3DLow=m.length-4,g.center2DHigh=m.length-3,g.center2DLow=m.length-2,g.radius=m.length-1),f&&m.push({functionName:"czm_batchTable_pickColor",componentDatatype:l.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});var y=m.length,C=new L(m,i);for(o=0;o<i;++o){var b=r[o];v=b.attributes;for(var E=0;E<p;++E){var S=W((h=v[s=d[E]]).value);C.setBatchedAttribute(o,_[s],S)}if(f){var x={primitive:u(b.pickPrimitive,e)};c(b.id)&&(x.id=b.id);var T=t.createPickId(x);e._pickIds.push(T);var A=T.color,P=te;P.x=a.floatToByte(A.red),P.y=a.floatToByte(A.green),P.z=a.floatToByte(A.blue),P.w=a.floatToByte(A.alpha),C.setBatchedAttribute(o,y-1,P)}}e._batchTable=C,e._batchTableAttributeIndices=_,e._batchTableBoundingSphereAttributeIndices=g}}(this,n),this._batchTable.attributes.length>0){if(0===P.maximumVertexTextureImageUnits)throw new E("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(t)}if(this._state!==V.COMPLETE&&this._state!==V.COMBINED&&(this.asynchronous?function(e,t){var n,r,i,o,a=e._instanceIds;if(e._state===V.READY){n=w(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s,l=e._numberOfInstances=n.length,h=[],d=[];for(i=0;i<l;++i)r=n[i].geometry,a.push(n[i].id),d.push({moduleName:r._workerName,geometry:r});if(!c(re))for(re=new Array(ie),i=0;i<ie;i++)re[i]=new x("createGeometry",Number.POSITIVE_INFINITY);for(d=S(d,ie),i=0;i<d.length;i++){var p,f=0,m=d[i],_=m.length;for(o=0;o<_;++o)s=m[o],r=s.geometry,c(r.constructor.pack)&&(s.offset=f,f+=u(r.constructor.packedLength,r.packedLength));if(f>0){var g=new Float64Array(f);for(p=[g.buffer],o=0;o<_;++o)s=m[o],r=s.geometry,c(r.constructor.pack)&&(r.constructor.pack(r,g,s.offset),s.geometry=g)}h.push(re[i].scheduleTask({subTasks:d[i]},p))}e._state=V.CREATING,N.all(h,function(t){e._createGeometryResults=t,e._state=V.CREATED}).otherwise(function(n){J(e,t,V.FAILED,n)})}else if(e._state===V.CREATED){var v=[];n=w(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var y=t.mapProjection,C=oe.scheduleTask(k.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:n,ellipsoid:y.ellipsoid,projection:y,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:t.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},v),v);e._createGeometryResults=void 0,e._state=V.COMBINING,N(C,function(n){var r=k.unpackCombineGeometryResults(n);e._geometries=r.geometries,e._attributeLocations=r.attributeLocations,e.modelMatrix=b.clone(r.modelMatrix,e.modelMatrix),e._pickOffsets=r.pickOffsets,e._instanceBoundingSpheres=r.boundingSpheres,e._instanceBoundingSpheresCV=r.boundingSpheresCV,c(e._geometries)&&e._geometries.length>0?e._state=V.COMBINED:J(e,t,V.FAILED,void 0)}).otherwise(function(n){J(e,t,V.FAILED,n)})}}(this,t):function(e,t){var n,r,i,o=w(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=o.length,s=new Array(a),l=e._instanceIds,u=0;for(r=0;r<a;r++){var h,d=(n=o[r]).geometry;h=c(d.attributes)&&c(d.primitiveType)?H(d):d.constructor.createGeometry(d),s[u++]={geometry:h,modelMatrix:b.clone((i=n).modelMatrix),pickPrimitive:i.pickPrimitive,id:i.id},l.push(n.id)}s.length=u;var p=t.mapProjection,f=k.combineGeometry({instances:s,ellipsoid:p.ellipsoid,projection:p,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:t.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=f.geometries,e._attributeLocations=f.attributeLocations,e.modelMatrix=b.clone(f.modelMatrix,e.modelMatrix),e._pickOffsets=f.pickOffsets,e._instanceBoundingSpheres=f.boundingSpheres,e._instanceBoundingSpheresCV=f.boundingSpheresCV,c(e._geometries)&&e._geometries.length>0?e._state=V.COMBINED:J(e,t,V.FAILED,void 0)}(this,t)),this._state===V.COMBINED&&(function(t,n){var r=c(t._batchTableAttributeIndices.distanceDisplayCondition);if(r||!t._batchTableBoundingSpheresUpdated){for(var i=t._batchTableBoundingSphereAttributeIndices,o=i.center3DHigh,a=i.center3DLow,s=i.center2DHigh,l=i.center2DLow,u=i.radius,h=n.mapProjection,d=h.ellipsoid,p=t._batchTable,m=t._instanceBoundingSpheres,_=m.length,g=0;g<_;++g){var v=m[g];if(c(v)){var y=t.modelMatrix;if(c(y)&&(v=e.transform(v,y,v)),r){var C=v.center,w=v.radius,b=f.fromCartesian(C,ae);p.setBatchedAttribute(g,o,b.high),p.setBatchedAttribute(g,a,b.low);var E=d.cartesianToCartographic(C,se),S=h.project(E,le);b=f.fromCartesian(S,ae),p.setBatchedAttribute(g,s,b.high),p.setBatchedAttribute(g,l,b.low),p.setBatchedAttribute(g,u,w)}}}t._batchTableBoundingSpheresUpdated=!0}}(this,t),function(t,n){for(var r=t._attributeLocations,i=t._geometries,o=n.scene3DOnly,a=n.context,s=[],l=i.length,u=0;u<l;++u){var h=i[u];if(s.push(R.fromGeometry({context:a,geometry:h,attributeLocations:r,bufferUsage:A.STATIC_DRAW,interleave:t._interleave})),c(t._createBoundingVolumeFunction))t._createBoundingVolumeFunction(n,h);else if(t._boundingSpheres.push(e.clone(h.boundingSphere)),t._boundingSphereWC.push(new e),!o){var d=h.boundingSphereCV.center,p=d.x,f=d.y;d.x=d.z,d.y=p,d.z=f,t._boundingSphereCV.push(e.clone(h.boundingSphereCV)),t._boundingSphere2D.push(new e),t._boundingSphereMorph.push(new e)}}t._va=s,t._primitiveType=i[0].primitiveType,t.releaseGeometryInstances&&(t.geometryInstances=void 0),t._geometries=void 0,J(t,n,V.COMPLETE,void 0)}(this,t)),this.show&&this._state===V.COMPLETE){var r=this.appearance,i=r.material,o=!1,s=!1;this._appearance!==r?(this._appearance=r,this._material=i,o=!0,s=!0):this._material!==i&&(this._material=i,s=!0);var h=this._appearance.isTranslucent();this._translucent!==h&&(this._translucent=h,o=!0),c(this._material)&&this._material.update(n);var d=r.closed&&h;o&&u(this._createRenderStatesFunction,q)(this,n,r,d),s&&u(this._createShaderProgramFunction,Y)(this,t,r),(o||s)&&u(this._createCommandsFunction,X)(this,r,i,h,d,this._colorCommands,this._pickCommands,t),u(this._updateAndQueueCommandsFunction,Z)(this,t,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,d)}}}},G.prototype.getGeometryInstanceAttributes=function(e){for(var t=-1,n=this._lastPerInstanceAttributeIndex,r=this._instanceIds,i=r.length,o=0;o<i;++o){var a=(n+o)%i;if(e===r[a]){t=a;break}}if(-1!==t){var s=this._perInstanceAttributeCache[t];if(c(s))return s;var l=this._batchTable,u=this._batchTableAttributeIndices;s={};var d={};for(var p in u)if(u.hasOwnProperty(p)){var f=u[p];d[p]={get:K(l,t,f)};var m=!0,_=this._readOnlyInstanceAttributes;if(m&&c(_)){i=_.length;for(var g=0;g<i;++g)if(p===_[g]){m=!1;break}}m&&(d[p].set=Q(l,t,f))}return v=this,C=t,(y=d).boundingSphere={get:function(){return v._instanceBoundingSpheres[C]}},y.boundingSphereCV={get:function(){return v._instanceBoundingSpheresCV[C]}},h(s,d),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=s,s}var v,y,C},G.prototype.isDestroyed=function(){return!1},G.prototype.destroy=function(){var e,t;this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy();var n=this._va;for(e=n.length,t=0;t<e;++t)n[t].destroy();this._va=void 0;var r=this._pickIds;for(e=r.length,t=0;t<e;++t)r[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,d(this)},G}),o("DataSources/dynamicGeometryGetBoundingSphere",["../Core/BoundingSphere","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Matrix4","./BoundingSphereState"],function(e,t,n,r,i,o){"use strict";return function(r,a,s,l){var u,c;return n(a)&&a.show&&a.ready&&(u=a.getGeometryInstanceAttributes(r),n(u)&&n(u.boundingSphere))?(c=t(a.modelMatrix,i.IDENTITY),e.transform(u.boundingSphere,c,l),o.DONE):n(s)&&s.show&&s.ready&&(u=s.getGeometryInstanceAttributes(r),n(u)&&n(u.boundingSphere))?(c=t(s.modelMatrix,i.IDENTITY),e.transform(u.boundingSphere,c,l),o.DONE):n(a)&&!a.ready||n(s)&&!s.ready?o.PENDING:o.FAILED}}),o("DataSources/MaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Scene/Material"],function(e,t,n,r,i){"use strict";function o(){r.throwInstantiationError()}return n(o.prototype,{isConstant:{get:r.throwInstantiationError},definitionChanged:{get:r.throwInstantiationError}}),o.prototype.getType=r.throwInstantiationError,o.prototype.getValue=r.throwInstantiationError,o.prototype.equals=r.throwInstantiationError,o.getValue=function(n,r,o){var a;return t(r)&&(a=r.getType(n),t(a))?(t(o)&&o.type===a||(o=i.fromType(a)),r.getValue(n,o.uniforms),o):(t(o)&&o.type===i.ColorType||(o=i.fromType(i.ColorType)),e.clone(e.WHITE,o.uniforms.color),o)},o}),o("DataSources/BoxGeometryUpdater",["../Core/BoxGeometry","../Core/BoxOutlineGeometry","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E){"use strict";function S(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0}function x(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(x.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new h,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new S(e),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function T(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new S(t._entity)}var A=new y(n.WHITE),P=new C(!0),D=new C(!0),M=new C(!1),I=new C(n.BLACK),O=new C(v.DISABLED),R=new C(new u),N=new n;return a(x,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:m}}),a(x.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!o(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!o(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),x.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},x.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},x.prototype.createFillGeometryInstance=function(t){var i,a=this._entity,s=a.isAvailable(t),l=new f(s&&a.isShowing&&this._showProperty.getValue(t)&&this._fillProperty.getValue(t)),u=this._distanceDisplayConditionProperty.getValue(t),h=c.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof y){var m=n.WHITE;o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||s)&&(m=this._materialProperty.color.getValue(t)),i={show:l,distanceDisplayCondition:h,color:r.fromColor(m)}}else i={show:l,distanceDisplayCondition:h};return new d({id:a,geometry:e.fromDimensions(this._options),modelMatrix:a._getModelMatrix(p.MINIMUM_VALUE),attributes:i})},x.prototype.createOutlineGeometryInstance=function(e){var i=this._entity,o=i.isAvailable(e),a=E.getValueOrDefault(this._outlineColorProperty,e,n.BLACK),s=this._distanceDisplayConditionProperty.getValue(e);return new d({id:i,geometry:t.fromDimensions(this._options),modelMatrix:i._getModelMatrix(p.MINIMUM_VALUE),attributes:{show:new f(o&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:r.fromColor(a),distanceDisplayCondition:c.fromDistanceDisplayCondition(s)}})},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){this._entitySubscription(),s(this)},x.prototype._onEntityPropertyChanged=function(e,t,n,r){if("availability"===t||"position"===t||"orientation"===t||"box"===t){var a=this._entity.box;if(!o(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!o(s)||!s.isConstant||s.getValue(p.MINIMUM_VALUE),u=a.outline,c=o(u);if(c&&u.isConstant&&(c=u.getValue(p.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var h=a.dimensions,d=e.position,f=a.show;if(!o(h)||!o(d)||o(f)&&f.isConstant&&!f.getValue(p.MINIMUM_VALUE))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var g=i(a.material,A),v=g instanceof y;this._materialProperty=g,this._fillProperty=i(s,D),this._showProperty=i(f,P),this._showOutlineProperty=i(a.outline,M),this._outlineColorProperty=c?i(a.outlineColor,I):void 0,this._shadowsProperty=i(a.shadows,O),this._distanceDisplayConditionProperty=i(a.distanceDisplayCondition,R);var C=a.outlineWidth;if(this._fillEnabled=l,this._outlineEnabled=c,d.isConstant&&E.isConstant(e.orientation)&&h.isConstant&&E.isConstant(C)){var w=this._options;w.vertexFormat=v?_.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat,w.dimensions=h.getValue(p.MINIMUM_VALUE,w.dimensions),this._outlineWidth=o(C)?C.getValue(p.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},x.prototype.createDynamicUpdater=function(e){return new T(e,this)},T.prototype.update=function(i){var a=this._primitives;a.removeAndDestroy(this._primitive),a.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var s=this._geometryUpdater,l=s._entity,u=l.box;if(l.isShowing&&l.isAvailable(i)&&E.getValueOrDefault(u.show,i,!0)){var h=this._options,p=l._getModelMatrix(i),f=E.getValueOrUndefined(u.dimensions,i,h.dimensions);if(o(p)&&o(f)){h.dimensions=f;var v=this._geometryUpdater.shadowsProperty.getValue(i),y=this._geometryUpdater.distanceDisplayConditionProperty.getValue(i),C=c.fromDistanceDisplayCondition(y);if(E.getValueOrDefault(u.fill,i,!0)){var w=b.getValue(i,s.fillMaterialProperty,this._material);this._material=w;var S=new m({material:w,translucent:w.isTranslucent(),closed:!0});h.vertexFormat=S.vertexFormat,this._primitive=a.add(new g({geometryInstances:new d({id:l,geometry:e.fromDimensions(h),modelMatrix:p,attributes:{distanceDisplayCondition:C}}),appearance:S,asynchronous:!1,shadows:v}))}if(E.getValueOrDefault(u.outline,i,!1)){h.vertexFormat=_.VERTEX_FORMAT;var x=E.getValueOrClonedDefault(u.outlineColor,i,n.BLACK,N),T=E.getValueOrDefault(u.outlineWidth,i,1),A=1!==x.alpha;this._outlinePrimitive=a.add(new g({geometryInstances:new d({id:l,geometry:t.fromDimensions(h),modelMatrix:p,attributes:{color:r.fromColor(x),distanceDisplayCondition:C}}),appearance:new _({flat:!0,translucent:A,renderState:{lineWidth:s._scene.clampLineWidth(T)}}),asynchronous:!1,shadows:v}))}}}},T.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),s(this)},x}),o("DataSources/CallbackProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event"],function(e,t,n,r){"use strict";function i(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new r,this.setCallback(e,t)}return t(i.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}}),i.prototype.getValue=function(e,t){return this._callback(e,t)},i.prototype.setCallback=function(e,t){var n=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,n&&this._definitionChanged.raiseEvent(this)},i.prototype.equals=function(e){return this===e||e instanceof i&&this._callback===e._callback&&this._isConstant===e._isConstant},i}),o("DataSources/CheckerboardMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){e=n(e,n.EMPTY_OBJECT),this._definitionChanged=new o,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}var u=t.WHITE,c=t.BLACK,h=new e(2,2);return i(l.prototype,{isConstant:{get:function(){return s.isConstant(this._evenColor)&&s.isConstant(this._oddColor)&&s.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:a("evenColor"),oddColor:a("oddColor"),repeat:a("repeat")}),l.prototype.getType=function(e){return"Checkerboard"},l.prototype.getValue=function(e,t){return r(t)||(t={}),t.lightColor=s.getValueOrClonedDefault(this._evenColor,e,u,t.lightColor),t.darkColor=s.getValueOrClonedDefault(this._oddColor,e,c,t.darkColor),t.repeat=s.getValueOrDefault(this._repeat,e,h),t},l.prototype.equals=function(e){return this===e||e instanceof l&&s.equals(this._evenColor,e._evenColor)&&s.equals(this._oddColor,e._oddColor)&&s.equals(this._repeat,e._repeat)},l}),o("DataSources/EntityCollection",["../Core/AssociativeArray","../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/Iso8601","../Core/JulianDate","../Core/RuntimeError","../Core/TimeInterval","./Entity"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e){if(e._firing)e._refire=!0;else if(0===e._suspendCount){var t=e._addedEntities,n=e._removedEntities,r=e._changedEntities;if(0!==r.length||0!==t.length||0!==n.length){e._firing=!0;do{e._refire=!1;var i=t.values.slice(0),o=n.values.slice(0),a=r.values.slice(0);t.removeAll(),n.removeAll(),r.removeAll(),e._collectionChanged.raiseEvent(e,i,o,a)}while(e._refire);e._firing=!1}}}function d(n){this._owner=n,this._entities=new e,this._addedEntities=new e,this._removedEntities=new e,this._changedEntities=new e,this._suspendCount=0,this._collectionChanged=new o,this._id=t(),this._show=!0,this._firing=!1,this._refire=!1}var p={id:void 0};return d.prototype.suspendEvents=function(){this._suspendCount++},d.prototype.resumeEvents=function(){this._suspendCount--,h(this)},d.collectionChangedEventCallback=void 0,r(d.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(e!==this._show){this.suspendEvents();var t,n=[],r=this._entities.values,i=r.length;for(t=0;t<i;t++)n.push(r[t].isShowing);for(this._show=e,t=0;t<i;t++){var o=n[t],a=r[t];o!==a.isShowing&&a.definitionChanged.raiseEvent(a,"isShowing",a.isShowing,o)}this.resumeEvents()}}},owner:{get:function(){return this._owner}}}),d.prototype.computeAvailability=function(){for(var e=a.MAXIMUM_VALUE,t=a.MINIMUM_VALUE,r=this._entities.values,i=0,o=r.length;i<o;i++){var l=r[i].availability;if(n(l)){var c=l.start,h=l.stop;s.lessThan(c,e)&&!c.equals(a.MINIMUM_VALUE)&&(e=c),s.greaterThan(h,t)&&!h.equals(a.MAXIMUM_VALUE)&&(t=h)}}return a.MAXIMUM_VALUE.equals(e)&&(e=a.MINIMUM_VALUE),a.MINIMUM_VALUE.equals(t)&&(t=a.MAXIMUM_VALUE),new u({start:e,stop:t})},d.prototype.add=function(e){e instanceof c||(e=new c(e));var t=e.id,n=this._entities;if(n.contains(t))throw new l("An entity with id "+t+" already exists in this collection.");return e.entityCollection=this,n.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(d.prototype._onEntityDefinitionChanged,this),h(this),e},d.prototype.remove=function(e){return!!n(e)&&this.removeById(e.id)},d.prototype.contains=function(e){return this._entities.get(e.id)===e},d.prototype.removeById=function(e){if(!n(e))return!1;var t=this._entities.get(e);return!!this._entities.remove(e)&&(this._addedEntities.remove(e)||(this._removedEntities.set(e,t),this._changedEntities.remove(e)),this._entities.remove(e),t.definitionChanged.removeEventListener(d.prototype._onEntityDefinitionChanged,this),h(this),!0)},d.prototype.removeAll=function(){for(var e=this._entities,t=e.length,r=e.values,i=this._addedEntities,o=this._removedEntities,a=0;a<t;a++){var s=r[a],l=s.id,u=i.get(l);n(u)||(s.definitionChanged.removeEventListener(d.prototype._onEntityDefinitionChanged,this),o.set(l,s))}e.removeAll(),i.removeAll(),this._changedEntities.removeAll(),h(this)},d.prototype.getById=function(e){return this._entities.get(e)},d.prototype.getOrCreateEntity=function(e){var t=this._entities.get(e);return n(t)||(p.id=e,t=new c(p),this.add(t)),t},d.prototype._onEntityDefinitionChanged=function(e){var t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),h(this)},d}),o("DataSources/CompositeEntityCollection",["../Core/createGuid","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Math","./Entity","./EntityCollection"],function(e,t,n,r,i,o,a){"use strict";function s(e){for(var t=e.propertyNames,n=t.length,r=0;r<n;r++)e[t[r]]=void 0}function l(e,t,n,r){m[0]=n,m[1]=r.id,t[JSON.stringify(m)]=r.definitionChanged.addEventListener(h.prototype._onDefinitionChanged,e)}function u(e,t,n,r){m[0]=n,m[1]=r.id;var i=JSON.stringify(m);t[i](),t[i]=void 0}function c(e){if(e._shouldRecomposite=!0,0===e._suspendCount){var n,r,i,c,d,p,m=e._collections,_=m.length,g=e._collectionsCopy,v=g.length,y=e._composite,C=new a(e),w=e._eventHash;for(n=0;n<v;n++)for(d=g[n],d.collectionChanged.removeEventListener(h.prototype._onCollectionChanged,e),i=d.values,p=d.id,c=i.length-1;c>-1;c--)r=i[c],u(0,w,p,r);for(n=_-1;n>=0;n--)for(d=m[n],d.collectionChanged.addEventListener(h.prototype._onCollectionChanged,e),i=d.values,p=d.id,c=i.length-1;c>-1;c--){l(e,w,p,r=i[c]);var b=C.getById(r.id);t(b)||(b=y.getById(r.id),t(b)?s(b):(f.id=r.id,b=new o(f)),C.add(b)),b.merge(r)}e._collectionsCopy=m.slice(0),y.suspendEvents(),y.removeAll();var E=C.values;for(n=0;n<E.length;n++)y.add(E[n]);y.resumeEvents()}}function h(n,r){this._owner=r,this._composite=new a(this),this._suspendCount=0,this._collections=t(n)?n.slice():[],this._collectionsCopy=[],this._id=e(),this._eventHash={},c(this),this._shouldRecomposite=!1}function d(e,t){return e.indexOf(t)}function p(e,t,n){var r=e._collections;if((t=i.clamp(t,0,r.length-1))!==(n=i.clamp(n,0,r.length-1))){var o=r[t];r[t]=r[n],r[n]=o,c(e)}}var f={id:void 0},m=new Array(2);return n(h.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}}),h.prototype.addCollection=function(e,n){t(n)?this._collections.splice(n,0,e):(n=this._collections.length,this._collections.push(e)),c(this)},h.prototype.removeCollection=function(e){var t=this._collections.indexOf(e);return-1!==t&&(this._collections.splice(t,1),c(this),!0)},h.prototype.removeAllCollections=function(){this._collections.length=0,c(this)},h.prototype.containsCollection=function(e){return-1!==this._collections.indexOf(e)},h.prototype.contains=function(e){return this._composite.contains(e)},h.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)},h.prototype.getCollection=function(e){return this._collections[e]},h.prototype.getCollectionsLength=function(){return this._collections.length},h.prototype.raiseCollection=function(e){var t=d(this._collections,e);p(this,t,t+1)},h.prototype.lowerCollection=function(e){var t=d(this._collections,e);p(this,t,t-1)},h.prototype.raiseCollectionToTop=function(e){var t=d(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),c(this))},h.prototype.lowerCollectionToBottom=function(e){var t=d(this._collections,e);0!==t&&(this._collections.splice(t,1),this._collections.splice(0,0,e),c(this))},h.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()},h.prototype.resumeEvents=function(){this._suspendCount--,this._shouldRecomposite&&0===this._suspendCount&&(c(this),this._shouldRecomposite=!1),this._composite.resumeEvents()},h.prototype.computeAvailability=function(){return this._composite.computeAvailability()},h.prototype.getById=function(e){return this._composite.getById(e)},h.prototype._onCollectionChanged=function(e,n,r){var i=this._collectionsCopy,a=i.length,c=this._composite;c.suspendEvents();var h,d,p,m,_=r.length,g=this._eventHash,v=e.id;for(h=0;h<_;h++){var y=r[h];u(0,g,v,y);var C=y.id;for(d=a-1;d>=0;d--)p=i[d].getById(C),t(p)&&(t(m)||(m=c.getById(C),s(m)),m.merge(p));t(m)||c.removeById(C),m=void 0}var w=n.length;for(h=0;h<w;h++){var b=n[h];l(this,g,v,b);var E=b.id;for(d=a-1;d>=0;d--)p=i[d].getById(E),t(p)&&(t(m)||(m=c.getById(E),t(m)?s(m):(f.id=E,m=new o(f),c.add(m))),m.merge(p));m=void 0}c.resumeEvents()},h.prototype._onDefinitionChanged=function(e,n,r,i){for(var o=this._collections,a=o.length,s=this._composite.getById(e.id),l=s[n],u=!t(l),c=!0,h=a-1;h>=0;h--){var d=o[h].getById(e.id);if(t(d)){var p=d[n];if(t(p)){if(c){if(c=!1,!t(p.merge)||!t(p.clone)){l=p;break}l=p.clone(l)}l.merge(p)}}}u&&-1===s.propertyNames.indexOf(n)&&s.addProperty(n),s[n]=l},h}),o("DataSources/CompositeProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/TimeIntervalCollection","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(){this._eventHelper=new i,this._definitionChanged=new r,this._intervals=new o,this._intervals.changedEvent.addEventListener(s.prototype._intervalsChanged,this)}return t(s.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),s.prototype.getValue=function(t,n){var r=this._intervals.findDataForIntervalContainingDate(t);if(e(r))return r.getValue(t,n)},s.prototype.equals=function(e){return this===e||e instanceof s&&this._intervals.equals(e._intervals,a.equals)},s.prototype._intervalsChanged=function(){(function(t,n,r,i){function o(){r.raiseEvent(t)}var a=[];n.removeAll();for(var s=i.length,l=0;l<s;l++){var u=i.get(l);e(u.data)&&-1===a.indexOf(u.data)&&n.add(u.data.definitionChanged,o)}})(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)},s}),o("DataSources/CompositeMaterialProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./CompositeProperty","./Property"],function(e,t,n,r,i,o){"use strict";function a(){this._definitionChanged=new r,this._composite=new i,this._composite.definitionChanged.addEventListener(a.prototype._raiseDefinitionChanged,this)}return t(a.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),a.prototype.getType=function(t){var n=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(n))return n.getType(t)},a.prototype.getValue=function(t,n){var r=this._composite._intervals.findDataForIntervalContainingDate(t);if(e(r))return r.getValue(t,n)},a.prototype.equals=function(e){return this===e||e instanceof a&&this._composite.equals(e._composite,o.equals)},a.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},a}),o("DataSources/CompositePositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./CompositeProperty","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(t){this._referenceFrame=e(t,o.FIXED),this._definitionChanged=new i,this._composite=new a,this._composite.definitionChanged.addEventListener(l.prototype._raiseDefinitionChanged,this)}return n(l.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},l.prototype.getValueInReferenceFrame=function(e,n,r){var i=this._composite._intervals.findDataForIntervalContainingDate(e);if(t(i))return i.getValueInReferenceFrame(e,n,r)},l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,s.equals)},l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},l}),o("Shaders/ShadowVolumeFS",[],function(){"use strict";return"#extension GL_EXT_frag_depth : enable\nvarying float v_WindowZ;\nvarying vec4 v_color;\nvoid writeDepthClampedToFarPlane()\n{\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n}\nvoid main(void)\n{\ngl_FragColor = v_color;\nwriteDepthClampedToFarPlane();\n}\n"}),o("Shaders/ShadowVolumeVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying float v_WindowZ;\nvarying vec4 v_color;\nvec4 depthClampFarPlane(vec4 vertexInClipCoordinates)\n{\nv_WindowZ = (0.5 * (vertexInClipCoordinates.z / vertexInClipCoordinates.w) + 0.5) * vertexInClipCoordinates.w;\nvertexInClipCoordinates.z = min(vertexInClipCoordinates.z, vertexInClipCoordinates.w);\nreturn vertexInClipCoordinates;\n}\nvoid main()\n{\nv_color = color;\nvec4 position = czm_computePosition();\ngl_Position = depthClampFarPlane(czm_modelViewProjectionRelativeToEye * position);\n}\n"}),o("Scene/DepthFunction",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),o("Scene/StencilFunction",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({NEVER:t.NEVER,LESS:t.LESS,EQUAL:t.EQUAL,LESS_OR_EQUAL:t.LEQUAL,GREATER:t.GREATER,NOT_EQUAL:t.NOTEQUAL,GREATER_OR_EQUAL:t.GEQUAL,ALWAYS:t.ALWAYS})}),o("Scene/StencilOperation",["../Core/freezeObject","../Renderer/WebGLConstants"],function(e,t){"use strict";return e({ZERO:t.ZERO,KEEP:t.KEEP,REPLACE:t.REPLACE,INCREMENT:t.INCR,DECREMENT:t.DECR,INVERT:t.INVERT,INCREMENT_WRAP:t.INCR_WRAP,DECREMENT_WRAP:t.DECR_WRAP})}),o("Scene/GroundPrimitive",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/GeographicTilingScheme","../Core/GeometryInstance","../Core/isArray","../Core/loadJson","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/PolygonGeometry","../Core/Rectangle","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Shaders/ShadowVolumeFS","../Shaders/ShadowVolumeVS","../ThirdParty/when","./BlendingState","./DepthFunction","./Pass","./PerInstanceColorAppearance","./Primitive","./SceneMode","./StencilFunction","./StencilOperation"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B){"use strict";function k(e){e=l(e,l.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.show=l(e.show,!0),this.debugShowBoundingVolume=l(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=l(e.debugShowShadowVolume,!1),this._sp=void 0,this._spPick=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilDepthPass=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._uniformMap={},this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1,this._readyPromise=D.defer(),this._primitive=void 0,this._debugPrimitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=k._defaultMaxTerrainHeight,this._minTerrainHeight=k._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[];var t,n=new R({flat:!0});u(this.geometryInstances)&&m(this.geometryInstances)&&this.geometryInstances.length>1&&(t=H),this._primitiveOptions={geometryInstances:void 0,appearance:n,vertexCacheOptimize:l(e.vertexCacheOptimize,!1),interleave:l(e.interleave,!1),releaseGeometryInstances:l(e.releaseGeometryInstances,!0),allowPicking:l(e.allowPicking,!0),asynchronous:l(e.asynchronous,!0),compressVertices:l(e.compressVertices,!0),_readOnlyInstanceAttributes:t,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_createPickOffsets:!0}}function V(e){return function(t,n){var r=n.maximumRadius,i=r/Math.cos(.5*t)-r;return e._maxHeight+i}}function z(e){return function(t,n){return e._minHeight}}function U(e,t){var n=e.mapProjection.ellipsoid;if(u(t.attributes)&&u(t.attributes.position3DHigh)){for(var r=t.attributes.position3DHigh.values,o=t.attributes.position3DLow.values,a=r.length,s=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,h=Number.NEGATIVE_INFINITY,d=0;d<a;d+=3){var p=i.unpack(r,d,Z),f=i.unpack(o,d,K),m=i.add(p,f,Q),_=n.cartesianToCartographic(m,J),g=_.latitude,v=_.longitude;s=Math.min(s,g),l=Math.min(l,v),c=Math.max(c,g),h=Math.max(h,v)}var y=$;return y.north=c,y.south=s,y.east=h,y.west=l,y}if(u(t.rectangle))return t.rectangle}function G(e){o.fromRadians(e.east,e.north,0,te[0]),o.fromRadians(e.west,e.north,0,te[1]),o.fromRadians(e.east,e.south,0,te[2]),o.fromRadians(e.west,e.south,0,te[3]);for(var t=0,n=0,r=0,i=0,a=k._terrainHeightsMaxLevel,s=0;s<=a;++s){for(var l=!1,u=0;u<4;++u)if(ee.positionToTileXY(te[u],s,ne),0===u)r=ne.x,i=ne.y;else if(r!==ne.x||i!==ne.y){l=!0;break}if(l)break;t=r,n=i}if(0!==s)return{x:t,y:n,level:s>a?a:s-1}}function W(e,n){var r=G(e),i=k._defaultMaxTerrainHeight;if(u(r)){var o=k._terrainHeights[r.level+"-"+r.x+"-"+r.y];u(o)&&(i=o[1])}var a=t.fromRectangle3D(e,n,0);return t.fromRectangle3D(e,n,i,le),t.union(a,le,a)}var H=["color"];c(k.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),k.isSupported=function(e){return e.context.fragmentDepth},k._defaultMaxTerrainHeight=9e3,k._defaultMinTerrainHeight=-1e5,k._terrainHeights=void 0,k._terrainHeightsMaxLevel=6;var j={colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:F.ALWAYS,frontOperation:{fail:B.KEEP,zFail:B.DECREMENT_WRAP,zPass:B.DECREMENT_WRAP},backFunction:F.ALWAYS,backOperation:{fail:B.KEEP,zFail:B.INCREMENT_WRAP,zPass:B.INCREMENT_WRAP},reference:0,mask:-1},depthTest:{enabled:!1},depthMask:!1},q={colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:F.ALWAYS,frontOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.INCREMENT_WRAP},backFunction:F.ALWAYS,backOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.DECREMENT_WRAP},reference:0,mask:-1},depthTest:{enabled:!0,func:I.LESS_OR_EQUAL},depthMask:!1},Y={stencilTest:{enabled:!0,frontFunction:F.NOT_EQUAL,frontOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.DECREMENT_WRAP},backFunction:F.NOT_EQUAL,backOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.DECREMENT_WRAP},reference:0,mask:-1},depthTest:{enabled:!1},depthMask:!1,blending:M.ALPHA_BLEND},X={stencilTest:{enabled:!0,frontFunction:F.NOT_EQUAL,frontOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.DECREMENT_WRAP},backFunction:F.NOT_EQUAL,backOperation:{fail:B.KEEP,zFail:B.KEEP,zPass:B.DECREMENT_WRAP},reference:0,mask:-1},depthTest:{enabled:!1},depthMask:!1},Z=new i,K=new i,Q=new i,J=new o,$=new b,ee=new p,te=[new o,new o,new o,new o],ne=new r,re=new i,ie=new i,oe=new o,ae=new i,se=new i,le=new t;return k._initialized=!1,k._initPromise=void 0,k.initializeTerrainHeights=function(){var e=k._initPromise;return u(e)?e:k._initPromise=_(n("Assets/approximateTerrainHeights.json")).then(function(e){k._initialized=!0,k._terrainHeights=e})},k.prototype.update=function(e){if(e.context.fragmentDepth&&this.show&&(u(this._primitive)||u(this.geometryInstances))){if(!k._initialized)return void k.initializeTerrainHeights();if(!u(this._primitive)){var n,r,o,l,c,h=this._primitiveOptions,d=e.mapProjection.ellipsoid,p=m(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],_=p.length,v=new Array(_);for(l=0;l<_;++l){var y=U(e,r=(n=p[l]).geometry);u(c)?u(y)&&b.union(c,y,c):c=y;var w=n.id;if(u(w)&&u(y)){var D=W(y,d);this._boundingSpheresKeys.push(w),this._boundingSpheres.push(D)}u(o=r.constructor)&&u(o.createShadowVolume)}!function(e,t,n){var r=G(t),o=k._defaultMinTerrainHeight,a=k._defaultMaxTerrainHeight;if(u(r)){var s=k._terrainHeights[r.level+"-"+r.x+"-"+r.y];u(s)&&(o=s[0],a=s[1]),n.cartographicToCartesian(b.northeast(t,oe),re),n.cartographicToCartesian(b.southwest(t,oe),ie),i.subtract(ie,re,ae),i.add(re,i.multiplyByScalar(ae,.5,ae),ae);var l=n.scaleToGeodeticSurface(ae,se);if(u(l)){var c=i.distance(ae,l);o=Math.min(o,-c)}else o=k._defaultMinTerrainHeight}e._minTerrainHeight=Math.max(k._defaultMinTerrainHeight,o),e._maxTerrainHeight=a}(this,c,e.mapProjection.ellipsoid);var M=e.terrainExaggeration;for(this._minHeight=this._minTerrainHeight*M,this._maxHeight=this._maxTerrainHeight*M,l=0;l<_;++l)n=p[l],r=n.geometry,o=r.constructor,v[l]=new f({geometry:o.createShadowVolume(r,z(this),V(this)),attributes:n.attributes,id:n.id,pickPrimitive:this});h.geometryInstances=v;var I=this;h._createBoundingVolumeFunction=function(e,n){!function(e,n,r){var o=n.mapProjection.ellipsoid,a=U(n,r);if(a.width<g.PI){var s=C.fromRectangle(a,e._maxHeight,e._minHeight,o);e._boundingVolumes.push(s)}else e._boundingVolumes.push(t.fromEncodedCartesianVertices(r.attributes.position3DHigh.values,r.attributes.position3DLow.values));if(!n.scene3DOnly){var l=t.fromRectangleWithHeights2D(a,n.mapProjection,e._maxHeight,e._minHeight);i.fromElements(l.center.z,l.center.x,l.center.y,l.center),e._boundingVolumes2D.push(l)}}(I,e,n)},h._createRenderStatesFunction=function(e,t,n,r){var i;u((i=I)._rsStencilPreloadPass)||(i._rsStencilPreloadPass=S.fromCache(j),i._rsStencilDepthPass=S.fromCache(q),i._rsColorPass=S.fromCache(Y),i._rsPickPass=S.fromCache(X))},h._createShaderProgramFunction=function(e,t,n){!function(e,t,n){if(!u(e._sp)){var r=t.context,i=P;i=e._primitive._batchTable.getVertexShaderCallback()(i),i=N._appendShowToShader(e._primitive,i),i=N._appendDistanceDisplayConditionToShader(e._primitive,i),i=N._modifyShaderPosition(e,i,t.scene3DOnly),i=N._updateColorAttribute(e._primitive,i);var o=A,a=e._primitive._attributeLocations;if(e._sp=x.replaceCache({context:r,shaderProgram:e._sp,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:a}),e._primitive.allowPicking){var s=T.createPickVertexShaderSource(i);s=N._updatePickColorAttribute(s);var l=new T({sources:[o],pickColorQualifier:"varying"});e._spPick=x.replaceCache({context:r,shaderProgram:e._spPick,vertexShaderSource:s,fragmentShaderSource:l,attributeLocations:a})}else e._spPick=x.fromCache({context:r,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:a})}}(I,t)},h._createCommandsFunction=function(e,t,n,r,i,o,a){var s,l;l=a,function(e,t){var n=e._primitive,r=3*n._va.length;t.length=r;for(var i=0,o=n._batchTable.getUniformMapCallback()(e._uniformMap),a=0;a<r;a+=3){var s=n._va[i++],l=t[a];u(l)||(l=t[a]=new E({owner:e,primitiveType:n._primitiveType})),l.vertexArray=s,l.renderState=e._rsStencilPreloadPass,l.shaderProgram=e._sp,l.uniformMap=o,l.pass=O.GROUND,u(l=t[a+1])||(l=t[a+1]=new E({owner:e,primitiveType:n._primitiveType})),l.vertexArray=s,l.renderState=e._rsStencilDepthPass,l.shaderProgram=e._sp,l.uniformMap=o,l.pass=O.GROUND,u(l=t[a+2])||(l=t[a+2]=new E({owner:e,primitiveType:n._primitiveType})),l.vertexArray=s,l.renderState=e._rsColorPass,l.shaderProgram=e._sp,l.uniformMap=o,l.pass=O.GROUND}}(s=I,o),function(e,t){var n=e._primitive,r=n._pickOffsets,i=3*r.length;t.length=i;for(var o=0,a=n._batchTable.getUniformMapCallback()(e._uniformMap),s=0;s<i;s+=3){var l=r[o++],c=l.offset,h=l.count,d=n._va[l.index],p=t[s];u(p)||(p=t[s]=new E({owner:e,primitiveType:n._primitiveType})),p.vertexArray=d,p.offset=c,p.count=h,p.renderState=e._rsStencilPreloadPass,p.shaderProgram=e._sp,p.uniformMap=a,p.pass=O.GROUND,u(p=t[s+1])||(p=t[s+1]=new E({owner:e,primitiveType:n._primitiveType})),p.vertexArray=d,p.offset=c,p.count=h,p.renderState=e._rsStencilDepthPass,p.shaderProgram=e._sp,p.uniformMap=a,p.pass=O.GROUND,u(p=t[s+2])||(p=t[s+2]=new E({owner:e,primitiveType:n._primitiveType})),p.vertexArray=d,p.offset=c,p.count=h,p.renderState=e._rsPickPass,p.shaderProgram=e._spPick,p.uniformMap=a,p.pass=O.GROUND}}(s,l)},h._updateAndQueueCommandsFunction=function(e,t,n,r,i,o,a,s){!function(e,t,n,r,i,o,a,s){var l;t.mode===L.SCENE3D?l=e._boundingVolumes:t.mode!==L.SCENE3D&&u(e._boundingVolumes2D)&&(l=e._boundingVolumes2D);var c=t.commandList,h=t.passes;if(h.render)for(var d=n.length,p=0;p<d;++p)n[p].modelMatrix=i,n[p].boundingVolume=l[Math.floor(p/3)],n[p].cull=o,n[p].debugShowBoundingVolume=a,c.push(n[p]);if(h.pick){var f=e._primitive._pickOffsets,m=3*f.length;r.length=m;for(var _=0,g=0;g<m;g+=3){var v=l[f[_++].index];r[g].modelMatrix=i,r[g].boundingVolume=v,r[g].cull=o,r[g+1].modelMatrix=i,r[g+1].boundingVolume=v,r[g+1].cull=o,r[g+2].modelMatrix=i,r[g+2].boundingVolume=v,r[g+2].cull=o,c.push(r[g],r[g+1],r[g+2])}}}(I,t,n,r,i,o,a)},this._primitive=new N(h),this._primitive.readyPromise.then(function(e){I._ready=!0,I.releaseGeometryInstances&&(I.geometryInstances=void 0);var t=e._error;u(t)?I._readyPromise.reject(t):I._readyPromise.resolve(I)})}if(this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e),this.debugShowShadowVolume&&!u(this._debugPrimitive)&&u(this.geometryInstances)){for(var F=m(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],B=F.length,H=new Array(B),Z=0;Z<B;++Z){var K=F[Z],Q=K.geometry,J=Q.constructor;if(u(J)&&u(J.createShadowVolume)){var $=K.attributes.color.value,ee=a.fromBytes($[0],$[1],$[2],$[3]);a.subtract(new a(1,1,1,0),ee,ee),H[Z]=new f({geometry:J.createShadowVolume(Q,z(this),V(this)),attributes:{color:s.fromColor(ee)},id:K.id,pickPrimitive:this})}}this._debugPrimitive=new N({geometryInstances:H,releaseGeometryInstances:!0,allowPicking:!1,asynchronous:!1,appearance:new R({flat:!0})})}u(this._debugPrimitive)&&(this.debugShowShadowVolume?this._debugPrimitive.update(e):(this._debugPrimitive.destroy(),this._debugPrimitive=void 0))}},k.prototype.getBoundingSphere=function(e){var t=this._boundingSpheresKeys.indexOf(e);if(-1!==t)return this._boundingSpheres[t]},k.prototype.getGeometryInstanceAttributes=function(e){return this._primitive.getGeometryInstanceAttributes(e)},k.prototype.isDestroyed=function(){return!1},k.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._debugPrimitive=this._debugPrimitive&&this._debugPrimitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),h(this)},k}),o("DataSources/CorridorGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CorridorGeometry","../Core/CorridorOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0}function A(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(A.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new h,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new T(e),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function P(e,t,n){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=n,this._options=new T(n._entity)}var D=new w(e.WHITE),M=new b(!0),I=new b(!0),O=new b(!1),R=new b(e.BLACK),N=new b(C.DISABLED),L=new b(new u),F=new e;return a(A,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:g}}),a(A.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!o(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!o(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayCondition}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),A.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},A.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},A.prototype.createFillGeometryInstance=function(r){var i,a=this._entity,s=a.isAvailable(r),l=new m(s&&a.isShowing&&this._showProperty.getValue(r)&&this._fillProperty.getValue(r)),u=c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(r));if(this._materialProperty instanceof w){var h=e.WHITE;o(this._materialProperty.color)&&(this._materialProperty.color.isConstant||s)&&(h=this._materialProperty.color.getValue(r)),i={show:l,distanceDisplayCondition:u,color:t.fromColor(h)}}else i={show:l,distanceDisplayCondition:u};return new d({id:a,geometry:new n(this._options),attributes:i})},A.prototype.createOutlineGeometryInstance=function(n){var i=this._entity,o=i.isAvailable(n),a=x.getValueOrDefault(this._outlineColorProperty,n,e.BLACK);return new d({id:i,geometry:new r(this._options),attributes:{show:new m(o&&i.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(a),distanceDisplayCondition:c.fromDistanceDisplayCondition(this._distanceDisplayCondition.getValue(n))}})},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._entitySubscription(),s(this)},A.prototype._onEntityPropertyChanged=function(e,t,n,r){if("availability"===t||"corridor"===t){var a=this._entity.corridor;if(!o(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!o(s)||!s.isConstant||s.getValue(p.MINIMUM_VALUE),u=a.outline,c=o(u);if(c&&u.isConstant&&(c=u.getValue(p.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var h=a.positions,d=a.show;if(o(d)&&d.isConstant&&!d.getValue(p.MINIMUM_VALUE)||!o(h))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var m=i(a.material,D),y=m instanceof w;this._materialProperty=m,this._fillProperty=i(s,I),this._showProperty=i(d,M),this._showOutlineProperty=i(a.outline,O),this._outlineColorProperty=c?i(a.outlineColor,R):void 0,this._shadowsProperty=i(a.shadows,N),this._distanceDisplayCondition=i(a.distanceDisplayCondition,L);var C=a.height,b=a.extrudedHeight,E=a.granularity,S=a.width,T=a.outlineWidth,A=a.cornerType,P=l&&!o(C)&&!o(b)&&y&&_.isSupported(this._scene);if(c&&P&&(f(f.geometryOutlines),c=!1),this._fillEnabled=l,this._onTerrain=P,this._isClosed=o(b)||P,this._outlineEnabled=c,h.isConstant&&x.isConstant(C)&&x.isConstant(b)&&x.isConstant(E)&&x.isConstant(S)&&x.isConstant(T)&&x.isConstant(A)&&(!P||x.isConstant(m))){var F=this._options;F.vertexFormat=y?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,F.positions=h.getValue(p.MINIMUM_VALUE,F.positions),F.height=o(C)?C.getValue(p.MINIMUM_VALUE):void 0,F.extrudedHeight=o(b)?b.getValue(p.MINIMUM_VALUE):void 0,F.granularity=o(E)?E.getValue(p.MINIMUM_VALUE):void 0,F.width=o(S)?S.getValue(p.MINIMUM_VALUE):void 0,F.cornerType=o(A)?A.getValue(p.MINIMUM_VALUE):void 0,this._outlineWidth=o(T)?T.getValue(p.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},A.prototype.createDynamicUpdater=function(e,t){return new P(e,t,this)},P.prototype.update=function(i){var a=this._geometryUpdater,s=a._onTerrain,l=this._primitives,u=this._groundPrimitives;s?u.removeAndDestroy(this._primitive):(l.removeAndDestroy(this._primitive),l.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var h=a._entity,p=h.corridor;if(h.isShowing&&h.isAvailable(i)&&x.getValueOrDefault(p.show,i,!0)){var f=this._options,m=x.getValueOrUndefined(p.positions,i,f.positions),C=x.getValueOrUndefined(p.width,i);if(o(m)&&o(C)){f.positions=m,f.width=C,f.height=x.getValueOrUndefined(p.height,i),f.extrudedHeight=x.getValueOrUndefined(p.extrudedHeight,i),f.granularity=x.getValueOrUndefined(p.granularity,i),f.cornerType=x.getValueOrUndefined(p.cornerType,i);var w=this._geometryUpdater.shadowsProperty.getValue(i),b=this._geometryUpdater.distanceDisplayConditionProperty.getValue(i),E=c.fromDistanceDisplayCondition(b);if(!o(p.fill)||p.fill.getValue(i)){var T=a.fillMaterialProperty,A=S.getValue(i,T,this._material);if(this._material=A,s){var P=e.WHITE;o(T.color)&&(P=T.color.getValue(i)),this._primitive=u.add(new _({geometryInstances:new d({id:h,geometry:new n(f),attributes:{color:t.fromColor(P),distanceDisplayCondition:E}}),asynchronous:!1,shadows:w}))}else{var D=new g({material:A,translucent:A.isTranslucent(),closed:o(f.extrudedHeight)});f.vertexFormat=D.vertexFormat,this._primitive=l.add(new y({geometryInstances:new d({id:h,geometry:new n(f),attributes:{distanceDisplayCondition:E}}),appearance:D,asynchronous:!1,shadows:w}))}}if(!s&&o(p.outline)&&p.outline.getValue(i)){f.vertexFormat=v.VERTEX_FORMAT;var M=x.getValueOrClonedDefault(p.outlineColor,i,e.BLACK,F),I=x.getValueOrDefault(p.outlineWidth,i,1),O=1!==M.alpha;this._outlinePrimitive=l.add(new y({geometryInstances:new d({id:h,geometry:new r(f),attributes:{color:t.fromColor(M),distanceDisplayCondition:E}}),appearance:new v({flat:!0,translucent:O,renderState:{lineWidth:a._scene.clampLineWidth(I)}}),asynchronous:!1,shadows:w}))}}}},P.prototype.getBoundingSphere=function(e,t){return E(e,this._primitive,this._outlinePrimitive,t)},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){var e=this._primitives;this._geometryUpdater._onTerrain?this._groundPrimitives.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),s(this)},A}),o("DataSources/DataSource",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function n(){t.throwInstantiationError()}return e(n.prototype,{name:{get:t.throwInstantiationError},clock:{get:t.throwInstantiationError},entities:{get:t.throwInstantiationError},isLoading:{get:t.throwInstantiationError},changedEvent:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError},loadingEvent:{get:t.throwInstantiationError},show:{get:t.throwInstantiationError},clustering:{get:t.throwInstantiationError}}),n.prototype.update=t.throwInstantiationError,n.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))},n}),o("DataSources/CustomDataSource",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","./DataSource","./EntityCluster","./EntityCollection"],function(e,t,n,r,i,o,a){"use strict";function s(e){this._name=e,this._clock=void 0,this._changed=new r,this._error=new r,this._isLoading=!1,this._loading=new r,this._entityCollection=new a(this),this._entityCluster=new o}return t(s.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){i.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),s}),o("DataSources/CylinderGeometryUpdater",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/CylinderGeometry","../Core/CylinderOutlineGeometry","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S){"use strict";function x(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0}function T(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(T.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new d,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new x(e),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function A(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new x(t._entity)}var P=new C(t.WHITE),D=new w(!0),M=new w(!0),I=new w(!1),O=new w(t.BLACK),R=new w(y.DISABLED),N=new w(new c),L=new t;return s(T,{perInstanceColorAppearanceType:{value:g},materialAppearanceType:{value:_}}),s(T.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!a(this._entity.availability)&&S.isConstant(this._showProperty)&&S.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),T.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},T.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},T.prototype.createFillGeometryInstance=function(e){var i,o=this._entity,s=o.isAvailable(e),l=new m(s&&o.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),u=this._distanceDisplayConditionProperty.getValue(e),c=h.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof C){var d=t.WHITE;a(this._materialProperty.color)&&(this._materialProperty.color.isConstant||s)&&(d=this._materialProperty.color.getValue(e)),i={show:l,distanceDisplayCondition:c,color:n.fromColor(d)}}else i={show:l,distanceDisplayCondition:c};return new p({id:o,geometry:new r(this._options),modelMatrix:o._getModelMatrix(f.MINIMUM_VALUE),attributes:i})},T.prototype.createOutlineGeometryInstance=function(e){var r=this._entity,o=r.isAvailable(e),a=S.getValueOrDefault(this._outlineColorProperty,e,t.BLACK),s=this._distanceDisplayConditionProperty.getValue(e);return new p({id:r,geometry:new i(this._options),modelMatrix:r._getModelMatrix(f.MINIMUM_VALUE),attributes:{show:new m(o&&r.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(a),distanceDisplayCondition:h.fromDistanceDisplayCondition(s)}})},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){this._entitySubscription(),l(this)},T.prototype._onEntityPropertyChanged=function(e,t,n,r){if("availability"===t||"position"===t||"orientation"===t||"cylinder"===t){var i=e.cylinder;if(!a(i))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=i.fill,l=!a(s)||!s.isConstant||s.getValue(f.MINIMUM_VALUE),u=i.outline,c=a(u);if(c&&u.isConstant&&(c=u.getValue(f.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var h=e.position,d=i.length,p=i.topRadius,m=i.bottomRadius,v=i.show;if(a(v)&&v.isConstant&&!v.getValue(f.MINIMUM_VALUE)||!a(h)||!a(d)||!a(p)||!a(m))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var y=o(i.material,P),w=y instanceof C;this._materialProperty=y,this._fillProperty=o(s,M),this._showProperty=o(v,D),this._showOutlineProperty=o(i.outline,I),this._outlineColorProperty=c?o(i.outlineColor,O):void 0,this._shadowsProperty=o(i.shadows,R),this._distanceDisplayConditionProperty=o(i.distanceDisplayCondition,N);var b=i.slices,E=i.outlineWidth,x=i.numberOfVerticalLines;if(this._fillEnabled=l,this._outlineEnabled=c,h.isConstant&&S.isConstant(e.orientation)&&d.isConstant&&p.isConstant&&m.isConstant&&S.isConstant(b)&&S.isConstant(E)&&S.isConstant(x)){var T=this._options;T.vertexFormat=w?g.VERTEX_FORMAT:_.MaterialSupport.TEXTURED.vertexFormat,T.length=d.getValue(f.MINIMUM_VALUE),T.topRadius=p.getValue(f.MINIMUM_VALUE),T.bottomRadius=m.getValue(f.MINIMUM_VALUE),T.slices=a(b)?b.getValue(f.MINIMUM_VALUE):void 0,T.numberOfVerticalLines=a(x)?x.getValue(f.MINIMUM_VALUE):void 0,this._outlineWidth=a(E)?E.getValue(f.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},T.prototype.createDynamicUpdater=function(e){return new A(e,this)},A.prototype.update=function(e){var o=this._primitives;o.removeAndDestroy(this._primitive),o.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var s=this._geometryUpdater,l=s._entity,u=l.cylinder;if(l.isShowing&&l.isAvailable(e)&&S.getValueOrDefault(u.show,e,!0)){var c=this._options,d=l._getModelMatrix(e),f=S.getValueOrUndefined(u.length,e),m=S.getValueOrUndefined(u.topRadius,e),y=S.getValueOrUndefined(u.bottomRadius,e);if(a(d)&&a(f)&&a(m)&&a(y)){c.length=f,c.topRadius=m,c.bottomRadius=y,c.slices=S.getValueOrUndefined(u.slices,e),c.numberOfVerticalLines=S.getValueOrUndefined(u.numberOfVerticalLines,e);var C=this._geometryUpdater.shadowsProperty.getValue(e),w=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),b=h.fromDistanceDisplayCondition(w);if(S.getValueOrDefault(u.fill,e,!0)){var x=E.getValue(e,s.fillMaterialProperty,this._material);this._material=x;var T=new _({material:x,translucent:x.isTranslucent(),closed:!0});c.vertexFormat=T.vertexFormat,this._primitive=o.add(new v({geometryInstances:new p({id:l,geometry:new r(c),modelMatrix:d,attributes:{distanceDisplayCondition:b}}),appearance:T,asynchronous:!1,shadows:C}))}if(S.getValueOrDefault(u.outline,e,!1)){c.vertexFormat=g.VERTEX_FORMAT;var A=S.getValueOrClonedDefault(u.outlineColor,e,t.BLACK,L),P=S.getValueOrDefault(u.outlineWidth,e,1),D=1!==A.alpha;this._outlinePrimitive=o.add(new v({geometryInstances:new p({id:l,geometry:new i(c),modelMatrix:d,attributes:{color:n.fromColor(A),distanceDisplayCondition:b}}),appearance:new g({flat:!0,translucent:D,renderState:{lineWidth:s._scene.clampLineWidth(P)}}),asynchronous:!1,shadows:C}))}}}},A.prototype.getBoundingSphere=function(e,t){return b(e,this._primitive,this._outlinePrimitive,t)},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),l(this)},T}),o("DataSources/DataSourceClock",["../Core/Clock","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./createRawPropertyDescriptor"],function(e,t,n,r,i,o,a,s){"use strict";function l(){this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0,this._definitionChanged=new o}return r(l.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:s("startTime"),stopTime:s("stopTime"),currentTime:s("currentTime"),clockRange:s("clockRange"),clockStep:s("clockStep"),multiplier:s("multiplier")}),l.prototype.clone=function(e){return n(e)||(e=new l),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},l.prototype.equals=function(e){return this===e||n(e)&&a.equals(this.startTime,e.startTime)&&a.equals(this.stopTime,e.stopTime)&&a.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},l.prototype.merge=function(e){this.startTime=t(this.startTime,e.startTime),this.stopTime=t(this.stopTime,e.stopTime),this.currentTime=t(this.currentTime,e.currentTime),this.clockRange=t(this.clockRange,e.clockRange),this.clockStep=t(this.clockStep,e.clockStep),this.multiplier=t(this.multiplier,e.multiplier)},l.prototype.getValue=function(t){return n(t)||(t=new e),t.startTime=this.startTime,t.stopTime=this.stopTime,t.currentTime=this.currentTime,t.clockRange=this.clockRange,t.multiplier=this.multiplier,t.clockStep=this.clockStep,t},l}),o("DataSources/GridMaterialProperty",["../Core/Cartesian2","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){e=n(e,n.EMPTY_OBJECT),this._definitionChanged=new o,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}var u=t.WHITE,c=new e(8,8),h=new e(0,0),d=new e(1,1);return i(l.prototype,{isConstant:{get:function(){return s.isConstant(this._color)&&s.isConstant(this._cellAlpha)&&s.isConstant(this._lineCount)&&s.isConstant(this._lineThickness)&&s.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:a("color"),cellAlpha:a("cellAlpha"),lineCount:a("lineCount"),lineThickness:a("lineThickness"),lineOffset:a("lineOffset")}),l.prototype.getType=function(e){return"Grid"},l.prototype.getValue=function(e,t){return r(t)||(t={}),t.color=s.getValueOrClonedDefault(this._color,e,u,t.color),t.cellAlpha=s.getValueOrDefault(this._cellAlpha,e,.1),t.lineCount=s.getValueOrClonedDefault(this._lineCount,e,c,t.lineCount),t.lineThickness=s.getValueOrClonedDefault(this._lineThickness,e,d,t.lineThickness),t.lineOffset=s.getValueOrClonedDefault(this._lineOffset,e,h,t.lineOffset),t},l.prototype.equals=function(e){return this===e||e instanceof l&&s.equals(this._color,e._color)&&s.equals(this._cellAlpha,e._cellAlpha)&&s.equals(this._lineCount,e._lineCount)&&s.equals(this._lineThickness,e._lineThickness)&&s.equals(this._lineOffset,e._lineOffset)},l}),o("DataSources/PolylineArrowMaterialProperty",["../Core/Color","../Core/defined","../Core/defineProperties","../Core/Event","./ConstantProperty","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(e){this._definitionChanged=new r,this._color=void 0,this._colorSubscription=void 0,this.color=e}return n(s.prototype,{isConstant:{get:function(){return a.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color")}),s.prototype.getType=function(e){return"PolylineArrow"},s.prototype.getValue=function(n,r){return t(r)||(r={}),r.color=a.getValueOrClonedDefault(this._color,n,e.WHITE,r.color),r},s.prototype.equals=function(e){return this===e||e instanceof s&&a.equals(this._color,e._color)},s}),o("DataSources/PolylineGlowMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new i,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower}var l=e.WHITE;return r(s.prototype,{isConstant:{get:function(){return a.isConstant(this._color)&&a.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),glowPower:o("glowPower")}),s.prototype.getType=function(e){return"PolylineGlow"},s.prototype.getValue=function(e,t){return n(t)||(t={}),t.color=a.getValueOrClonedDefault(this._color,e,l,t.color),t.glowPower=a.getValueOrDefault(this._glowPower,e,.25,t.glowPower),t},s.prototype.equals=function(e){return this===e||e instanceof s&&a.equals(this._color,e._color)&&a.equals(this._glowPower,e._glowPower)},s}),o("DataSources/PolylineOutlineMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new i,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}var l=e.WHITE,u=e.BLACK;return r(s.prototype,{isConstant:{get:function(){return a.isConstant(this._color)&&a.isConstant(this._outlineColor)&&a.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:o("color"),outlineColor:o("outlineColor"),outlineWidth:o("outlineWidth")}),s.prototype.getType=function(e){return"PolylineOutline"},s.prototype.getValue=function(e,t){return n(t)||(t={}),t.color=a.getValueOrClonedDefault(this._color,e,l,t.color),t.outlineColor=a.getValueOrClonedDefault(this._outlineColor,e,u,t.outlineColor),t.outlineWidth=a.getValueOrDefault(this._outlineWidth,e,1),t},s.prototype.equals=function(e){return this===e||e instanceof s&&a.equals(this._color,e._color)&&a.equals(this._outlineColor,e._outlineColor)&&a.equals(this._outlineWidth,e._outlineWidth)},s}),o("DataSources/PositionPropertyArray",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","../Core/ReferenceFrame","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(t,n){this._value=void 0,this._definitionChanged=new i,this._eventHelper=new o,this._referenceFrame=e(n,a.FIXED),this.setValue(t)}return n(l.prototype,{isConstant:{get:function(){var e=this._value;if(!t(e))return!0;for(var n=e.length,r=0;r<n;r++)if(!s.isConstant(e[r]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),l.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)},l.prototype.getValueInReferenceFrame=function(e,n,r){var i=this._value;if(t(i)){var o=i.length;t(r)||(r=new Array(o));for(var a=0,s=0;a<o;){var l=i[a].getValueInReferenceFrame(e,n,r[a]);t(l)&&(r[s]=l,s++),a++}return r.length=s,r}},l.prototype.setValue=function(e){var n=this._eventHelper;if(n.removeAll(),t(e)){this._value=e.slice();for(var r=e.length,i=0;i<r;i++){var o=e[i];t(o)&&n.add(o.definitionChanged,l.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},l.prototype.equals=function(e){return this===e||e instanceof l&&this._referenceFrame===e._referenceFrame&&s.arrayEquals(this._value,e._value)},l.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},l}),o("DataSources/PropertyArray",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/EventHelper","./Property"],function(e,t,n,r,i,o){"use strict";function a(e){this._value=void 0,this._definitionChanged=new r,this._eventHelper=new i,this.setValue(e)}return t(a.prototype,{isConstant:{get:function(){var t=this._value;if(!e(t))return!0;for(var n=t.length,r=0;r<n;r++)if(!o.isConstant(t[r]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),a.prototype.getValue=function(t,n){var r=this._value;if(e(r)){var i=r.length;e(n)||(n=new Array(i));for(var o=0,a=0;o<i;){var s=this._value[o].getValue(t,n[o]);e(s)&&(n[a]=s,a++),o++}return n.length=a,n}},a.prototype.setValue=function(t){var n=this._eventHelper;if(n.removeAll(),e(t)){this._value=t.slice();for(var r=t.length,i=0;i<r;i++){var o=t[i];e(o)&&n.add(o.definitionChanged,a.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},a.prototype.equals=function(e){return this===e||e instanceof a&&o.arrayEquals(this._value,e._value)},a.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},a}),o("DataSources/ReferenceProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/RuntimeError","./Property"],function(e,t,n,r,i,o){"use strict";function a(t){var n=t._targetProperty;if(t._resolveProperty){var r=function(t){var n=!0;if(t._resolveEntity){var r=t._targetCollection.getById(t._targetId);if(e(r)?(r.definitionChanged.addEventListener(s.prototype._onTargetEntityDefinitionChanged,t),t._targetEntity=r,t._resolveEntity=!1):(r=t._targetEntity,n=!1),!e(r))throw new i('target entity "'+t._targetId+'" could not be resolved.')}return n}(t),o=t._targetPropertyNames;n=t._targetEntity;for(var a=o.length,l=0;l<a&&e(n);l++)n=n[o[l]];if(e(n))t._targetProperty=n,t._resolveProperty=!r;else if(!e(t._targetProperty))throw new i('targetProperty "'+t._targetId+"."+o.join(".")+'" could not be resolved.')}return n}function s(e,t,n){this._targetCollection=e,this._targetId=t,this._targetPropertyNames=n,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new r,this._resolveEntity=!0,this._resolveProperty=!0,e.collectionChanged.addEventListener(s.prototype._onCollectionChanged,this)}return t(s.prototype,{isConstant:{get:function(){return o.isConstant(a(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return a(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return a(this)}}}),s.fromString=function(e,t){for(var n,r=[],i=!0,o=!1,a="",l=0;l<t.length;++l){var u=t.charAt(l);o?(a+=u,o=!1):"\\"===u?o=!0:i&&"#"===u?(n=a,i=!1,a=""):i||"."!==u?a+=u:(r.push(a),a="")}return r.push(a),new s(e,n,r)},s.prototype.getValue=function(e,t){return a(this).getValue(e,t)},s.prototype.getValueInReferenceFrame=function(e,t,n){return a(this).getValueInReferenceFrame(e,t,n)},s.prototype.getType=function(e){return a(this).getType(e)},s.prototype.equals=function(e){if(this===e)return!0;var t=this._targetPropertyNames,n=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==n.length)return!1;for(var r=this._targetPropertyNames.length,i=0;i<r;i++)if(t[i]!==n[i])return!1;return!0},s.prototype._onTargetEntityDefinitionChanged=function(e,t,n,r){this._targetPropertyNames[0]===t&&(this._resolveProperty=!0,this._definitionChanged.raiseEvent(this))},s.prototype._onCollectionChanged=function(t,n,r){var i=this._targetEntity;e(i)&&(-1!==r.indexOf(i)?(i.definitionChanged.removeEventListener(s.prototype._onTargetEntityDefinitionChanged,this),this._resolveEntity=!0,this._resolveProperty=!0):this._resolveEntity&&(a(this),this._resolveEntity||this._definitionChanged.raiseEvent(this)))},s}),o("DataSources/Rotation",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Math"],function(e,t,n,r){"use strict";return{packedLength:1,pack:function(t,n,r){return n[r=e(r,0)]=t,n},unpack:function(t,n,r){return t[n=e(n,0)]},convertPackedArrayForInterpolation:function(t,n,i,o){n=e(n,0);for(var a,s=0,l=(i=e(i,t.length))-n+1;s<l;s++){var u=t[n+s];o[s]=0===s||Math.abs(a-u)<Math.PI?u:u-r.TWO_PI,a=u}},unpackInterpolationResult:function(e,t,n,i,o){return(o=e[0])<0?o+r.TWO_PI:o}}}),o("DataSources/SampledProperty",["../Core/binarySearch","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ExtrapolationType","../Core/JulianDate","../Core/LinearApproximation"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(e,t,n){var r,i=e.length,o=n.length,a=i+o;if(e.length=a,i!==t){var s=i-1;for(r=a-1;r>=t;r--)e[r]=e[s--]}for(r=0;r<o;r++)e[t++]=n[r]}function c(e,t){return e instanceof s?e:"string"==typeof e?s.fromIso8601(e):s.addSeconds(t,e,new s)}function h(t,r,i,o,a){for(var l,h,d,p,_,g,v=0;v<o.length;){_=c(o[v],t);var y=0,C=0;if((d=e(r,_,s.compare))<0){for(p=(d=~d)*a,h=void 0,g=r[d];v<o.length&&(_=c(o[v],t),!(n(h)&&s.compare(h,_)>=0||n(g)&&s.compare(_,g)>=0));){for(f[y++]=_,v+=1,l=0;l<a;l++)m[C++]=o[v],v+=1;h=_}y>0&&(m.length=C,u(i,p,m),f.length=y,u(r,d,f))}else{for(l=0;l<a;l++)v++,i[d*a+l]=o[v];v++}}}function d(e,r){var i=e;i===Number&&(i=p);var s,u=i.packedLength,c=t(i.packedInterpolationLength,u),h=0;if(n(r)){var d=r.length;s=new Array(d);for(var f=0;f<d;f++){var m=r[f];m===Number&&(m=p);var _=m.packedLength;u+=_,c+=t(m.packedInterpolationLength,_),s[f]=m}h=d}this._type=e,this._innerType=i,this._interpolationDegree=1,this._interpolationAlgorithm=l,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=u,this._packedInterpolationLength=c,this._updateTableLength=!0,this._interpolationResult=new Array(c),this._definitionChanged=new o,this._derivativeTypes=r,this._innerDerivativeTypes=s,this._inputOrder=h,this._forwardExtrapolationType=a.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=a.NONE,this._backwardExtrapolationDuration=0}var p={packedLength:1,pack:function(e,n,r){n[r=t(r,0)]=e},unpack:function(e,n,r){return e[n=t(n,0)]}},f=[],m=[];return r(d.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}}),d.prototype.getValue=function(t,r){var i=this._times,o=i.length;if(0!==o){var l,u=this._innerType,c=this._values,h=e(i,t,s.compare);if(h<0){if(0==(h=~h)){if(l=this._backwardExtrapolationDuration,this._backwardExtrapolationType===a.NONE||0!==l&&s.secondsDifference(i[h],t)>l)return;if(this._backwardExtrapolationType===a.HOLD)return u.unpack(c,0,r)}if(h>=o){if(h=o-1,l=this._forwardExtrapolationDuration,this._forwardExtrapolationType===a.NONE||0!==l&&s.secondsDifference(t,i[h])>l)return;if(this._forwardExtrapolationType===a.HOLD)return h=o-1,u.unpack(c,h*u.packedLength,r)}var d=this._xTable,p=this._yTable,f=this._interpolationAlgorithm,m=this._packedInterpolationLength,_=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;var g=Math.min(f.getRequiredDataPoints(this._interpolationDegree,_),o);g!==this._numberOfPoints&&(this._numberOfPoints=g,d.length=g,p.length=g*m)}var v=this._numberOfPoints-1;if(v<1)return;var y=0,C=o-1;if(C-y+1>=v+1){var w=h-(v/2|0)-1;w<y&&(w=y);var b=w+v;b>C&&(w=(b=C)-v)<y&&(w=y),y=w,C=b}for(var E=C-y+1,S=0;S<E;++S)d[S]=s.secondsDifference(i[y+S],i[C]);if(n(u.convertPackedArrayForInterpolation))u.convertPackedArrayForInterpolation(c,y,C,p);else for(var x=0,T=this._packedLength,A=y*T,P=(C+1)*T;A<P;)p[x]=c[A],A++,x++;var D,M=s.secondsDifference(t,i[C]);if(0!==_&&n(f.interpolate)){var I=Math.floor(m/(_+1));D=f.interpolate(M,d,p,I,_,_,this._interpolationResult)}else D=f.interpolateOrderZero(M,d,p,m,this._interpolationResult);return n(u.unpackInterpolationResult)?u.unpackInterpolationResult(D,c,y,C,r):u.unpack(D,0,r)}return u.unpack(c,h*this._packedLength,r)}},d.prototype.setInterpolationOptions=function(e){var t=!1,n=e.interpolationAlgorithm,r=e.interpolationDegree;this._interpolationAlgorithm!==n&&(this._interpolationAlgorithm=n,t=!0),this._interpolationDegree!==r&&(this._interpolationDegree=r,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))},d.prototype.addSample=function(e,t,r){var i=this._innerDerivativeTypes,o=n(i),a=this._innerType,s=[];if(s.push(e),a.pack(t,s,s.length),o)for(var l=i.length,u=0;u<l;u++)i[u].pack(r[u],s,s.length);h(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},d.prototype.addSamples=function(e,t,r){for(var i=this._innerDerivativeTypes,o=n(i),a=this._innerType,s=e.length,l=[],u=0;u<s;u++)if(l.push(e[u]),a.pack(t[u],l,l.length),o)for(var c=r[u],d=i.length,p=0;p<d;p++)i[p].pack(c[p],l,l.length);h(void 0,this._times,this._values,l,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},d.prototype.addSamplesPackedArray=function(e,t){h(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},d.prototype.equals=function(e){if(this===e)return!0;if(!n(e))return!1;if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;var t,r,i=this._derivativeTypes,o=n(i),a=e._derivativeTypes;if(o!==n(a))return!1;if(o){if((r=i.length)!==a.length)return!1;for(t=0;t<r;t++)if(i[t]!==a[t])return!1}var l=this._times,u=e._times;if((r=l.length)!==u.length)return!1;for(t=0;t<r;t++)if(!s.equals(l[t],u[t]))return!1;var c=this._values,h=e._values;for(t=0;t<r;t++)if(c[t]!==h[t])return!1;return!0},d._mergeNewSamples=h,d}),o("DataSources/SampledPositionProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","./PositionProperty","./Property","./SampledProperty"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(n,r){var i;if((r=t(r,0))>0){i=new Array(r);for(var s=0;s<r;s++)i[s]=e}this._numberOfDerivatives=r,this._property=new u(e,i),this._definitionChanged=new o,this._referenceFrame=t(n,a.FIXED),this._property._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)}return r(c.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}}),c.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,a.FIXED,t)},c.prototype.getValueInReferenceFrame=function(e,t,r){if(r=this._property.getValue(e,r),n(r))return s.convertToReferenceFrame(e,r,this._referenceFrame,t,r)},c.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)},c.prototype.addSample=function(e,t,n){this._property.addSample(e,t,n)},c.prototype.addSamples=function(e,t,n){this._property.addSamples(e,t,n)},c.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)},c.prototype.equals=function(e){return this===e||e instanceof c&&l.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame},c}),o("DataSources/StripeOrientation",["../Core/freezeObject"],function(e){"use strict";return e({HORIZONTAL:0,VERTICAL:1})}),o("DataSources/StripeMaterialProperty",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","./createPropertyDescriptor","./Property","./StripeOrientation"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){e=t(e,t.EMPTY_OBJECT),this._definitionChanged=new i,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}var u=s.HORIZONTAL,c=e.WHITE,h=e.BLACK;return r(l.prototype,{isConstant:{get:function(){return a.isConstant(this._orientation)&&a.isConstant(this._evenColor)&&a.isConstant(this._oddColor)&&a.isConstant(this._offset)&&a.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:o("orientation"),evenColor:o("evenColor"),oddColor:o("oddColor"),offset:o("offset"),repeat:o("repeat")}),l.prototype.getType=function(e){return"Stripe"},l.prototype.getValue=function(e,t){return n(t)||(t={}),t.horizontal=a.getValueOrDefault(this._orientation,e,u)===s.HORIZONTAL,t.evenColor=a.getValueOrClonedDefault(this._evenColor,e,c,t.evenColor),t.oddColor=a.getValueOrClonedDefault(this._oddColor,e,h,t.oddColor),t.offset=a.getValueOrDefault(this._offset,e,0),t.repeat=a.getValueOrDefault(this._repeat,e,1),t},l.prototype.equals=function(e){return this===e||e instanceof l&&a.equals(this._orientation,e._orientation)&&a.equals(this._evenColor,e._evenColor)&&a.equals(this._oddColor,e._oddColor)&&a.equals(this._offset,e._offset)&&a.equals(this._repeat,e._repeat)},l}),o("DataSources/TimeIntervalCollectionPositionProperty",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/ReferenceFrame","../Core/TimeIntervalCollection","./PositionProperty","./Property"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t){this._definitionChanged=new i,this._intervals=new a,this._intervals.changedEvent.addEventListener(u.prototype._intervalsChanged,this),this._referenceFrame=e(t,o.FIXED)}return n(u.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}}),u.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},u.prototype.getValueInReferenceFrame=function(e,n,r){var i=this._intervals.findDataForIntervalContainingDate(e);if(t(i))return s.convertToReferenceFrame(e,i,this._referenceFrame,n,r)},u.prototype.equals=function(e){return this===e||e instanceof u&&this._intervals.equals(e._intervals,l.equals)&&this._referenceFrame===e._referenceFrame},u.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)},u}),o("DataSources/TimeIntervalCollectionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/TimeIntervalCollection","./Property"],function(e,t,n,r,i,o){"use strict";function a(){this._definitionChanged=new r,this._intervals=new i,this._intervals.changedEvent.addEventListener(a.prototype._intervalsChanged,this)}return t(a.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),a.prototype.getValue=function(t,n){var r=this._intervals.findDataForIntervalContainingDate(t);return e(r)&&"function"==typeof r.clone?r.clone(n):r},a.prototype.equals=function(e){return this===e||e instanceof a&&this._intervals.equals(e._intervals,o.equals)},a.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)},a}),o("DataSources/VelocityVectorProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","./Property"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,n){this._position=void 0,this._subscription=void 0,this._definitionChanged=new o,this._normalize=t(n,!0),this.position=e}r(l.prototype,{isConstant:{get:function(){return s.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){var t=this._position;t!==e&&(n(t)&&this._subscription(),this._position=e,n(e)&&(this._subscription=e._definitionChanged.addEventListener(function(){this._definitionChanged.raiseEvent(this)},this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var u=new e,c=new e,h=new a;return l.prototype.getValue=function(e,t){return this._getValue(e,t)},l.prototype._getValue=function(t,r,i){n(r)||(r=new e);var o=this._position;if(s.isConstant(o))return this._normalize?void 0:e.clone(e.ZERO,r);var l=o.getValue(t,u),d=o.getValue(a.addSeconds(t,1/60,h),c);if(n(l)&&(n(d)||(d=l,l=o.getValue(a.addSeconds(t,-1/60,h),c),n(l)))){if(e.equals(l,d))return this._normalize?void 0:e.clone(e.ZERO,r);n(i)&&l.clone(i);var p=e.subtract(d,l,r);return this._normalize?e.normalize(p,r):e.divideByScalar(p,1/60,r)}},l.prototype.equals=function(e){return this===e||e instanceof l&&s.equals(this._position,e._position)},l}),o("DataSources/CzmlDataSource",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/CornerType","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ExtrapolationType","../Core/getAbsoluteUri","../Core/getFilenameFromUri","../Core/HermitePolynomialApproximation","../Core/isArray","../Core/Iso8601","../Core/JulianDate","../Core/LagrangePolynomialApproximation","../Core/LinearApproximation","../Core/loadJson","../Core/Math","../Core/NearFarScalar","../Core/Quaternion","../Core/Rectangle","../Core/ReferenceFrame","../Core/RuntimeError","../Core/Spherical","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/ShadowMode","../Scene/VerticalOrigin","../ThirdParty/Uri","../ThirdParty/when","./BillboardGraphics","./BoxGraphics","./ColorMaterialProperty","./CompositeMaterialProperty","./CompositePositionProperty","./CompositeProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./CylinderGraphics","./DataSource","./DataSourceClock","./EllipseGraphics","./EllipsoidGraphics","./EntityCluster","./EntityCollection","./GridMaterialProperty","./ImageMaterialProperty","./LabelGraphics","./ModelGraphics","./NodeTransformationProperty","./PathGraphics","./PointGraphics","./PolygonGraphics","./PolylineArrowMaterialProperty","./PolylineGlowMaterialProperty","./PolylineGraphics","./PolylineOutlineMaterialProperty","./PositionPropertyArray","./PropertyArray","./PropertyBag","./RectangleGraphics","./ReferenceProperty","./Rotation","./SampledPositionProperty","./SampledProperty","./StripeMaterialProperty","./StripeOrientation","./TimeIntervalCollectionPositionProperty","./TimeIntervalCollectionProperty","./VelocityVectorProperty","./WallGraphics"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie,oe,ae,se,le,ue,ce,he,de,pe,fe,me,_e,ge,ve,ye,Ce,we,be,Ee,Se,xe,Te,Ae,Pe){"use strict";function De(e,t){return"#"===t[0]&&(t=Ze+t),ye.fromString(e,t)}function Me(e,t){var n=u(e.uri,e);return c(t)&&(n=_(n,_(t))),n}function Ie(e){var t=e.cartesian;if(c(t))return t;var r=e.cartesianVelocity;if(c(r))return r;var i=e.unitCartesian;if(c(i))return i;var o=e.unitSpherical;if(c(o))return function(e){var t=e.length;if(Qe.magnitude=1,2===t)return Qe.clock=e[0],Qe.cone=e[1],n.fromSpherical(Qe,Ke),[Ke.x,Ke.y,Ke.z];for(var r=new Array(t/3*4),i=0,o=0;i<t;i+=3,o+=4)r[o]=e[i],Qe.clock=e[i+1],Qe.cone=e[i+2],n.fromSpherical(Qe,Ke),r[o+1]=Ke.x,r[o+2]=Ke.y,r[o+3]=Ke.z;return r}(o);var a=e.spherical;if(c(a))return function(e){var t=e.length;if(3===t)return Qe.clock=e[0],Qe.cone=e[1],Qe.magnitude=e[2],n.fromSpherical(Qe,Ke),[Ke.x,Ke.y,Ke.z];for(var r=new Array(t),i=0;i<t;i+=4)r[i]=e[i],Qe.clock=e[i+1],Qe.cone=e[i+2],Qe.magnitude=e[i+3],n.fromSpherical(Qe,Ke),r[i+1]=Ke.x,r[i+2]=Ke.y,r[i+3]=Ke.z;return r}(a);var s=e.cartographicRadians;if(c(s))return function(e){var t=e.length;if(3===t)return Je.longitude=e[0],Je.latitude=e[1],Je.height=e[2],p.WGS84.cartographicToCartesian(Je,Ke),[Ke.x,Ke.y,Ke.z];for(var n=new Array(t),r=0;r<t;r+=4)n[r]=e[r],Je.longitude=e[r+1],Je.latitude=e[r+2],Je.height=e[r+3],p.WGS84.cartographicToCartesian(Je,Ke),n[r+1]=Ke.x,n[r+2]=Ke.y,n[r+3]=Ke.z;return n}(s);var l=e.cartographicDegrees;if(c(l))return function(e){var t=e.length;if(3===t)return Je.longitude=x.toRadians(e[0]),Je.latitude=x.toRadians(e[1]),Je.height=e[2],p.WGS84.cartographicToCartesian(Je,Ke),[Ke.x,Ke.y,Ke.z];for(var n=new Array(t),r=0;r<t;r+=4)n[r]=e[r],Je.longitude=x.toRadians(e[r+1]),Je.latitude=x.toRadians(e[r+2]),Je.height=e[r+3],p.WGS84.cartographicToCartesian(Je,Ke),n[r+1]=Ke.x,n[r+2]=Ke.y,n[r+3]=Ke.z;return n}(l);throw new M(JSON.stringify(e)+" is not a valid CZML interval.")}function Oe(e,t){var n=e[t],r=e[t+1],i=e[t+2],o=e[t+3],a=1/Math.sqrt(n*n+r*r+i*i+o*o);e[t]=n*a,e[t+1]=r*a,e[t+2]=i*a,e[t+3]=o*a}function Re(e,t){var n=e.interpolationAlgorithm;(c(n)||c(e.interpolationDegree))&&t.setInterpolationOptions({interpolationAlgorithm:et[n],interpolationDegree:e.interpolationDegree});var r=e.forwardExtrapolationType;c(r)&&(t.forwardExtrapolationType=m[r]);var i=e.forwardExtrapolationDuration;c(i)&&(t.forwardExtrapolationDuration=i);var o=e.backwardExtrapolationType;c(o)&&(t.backwardExtrapolationType=m[o]);var a=e.backwardExtrapolationDuration;c(a)&&(t.backwardExtrapolationDuration=a)}function Ne(r,i,o,l,h,d,p){var f,m=l.interval;c(m)?(tt.iso8601=m,f=O.fromIso8601(tt),c(h)&&(f=O.intersect(f,h,$e))):c(h)&&(f=h);var _,g,v,y,b=c(l.reference),E=c(f)&&!f.equals(C.MAXIMUM_INTERVAL);b||(v=function(r,i,o){switch(r){case Array:return i.array;case Boolean:return u(i.boolean,i);case e:return i.boundingRectangle;case t:return i.cartesian2;case n:return Ie(i);case a:return function(e){var t=e.rgbaf;if(c(t))return t;var n=e.rgba;if(c(n)){var r=n.length;if(r===a.packedLength)return[a.byteToFloat(n[0]),a.byteToFloat(n[1]),a.byteToFloat(n[2]),a.byteToFloat(n[3])];t=new Array(r);for(var i=0;i<r;i+=5)t[i]=n[i],t[i+1]=a.byteToFloat(n[i+1]),t[i+2]=a.byteToFloat(n[i+2]),t[i+3]=a.byteToFloat(n[i+3]),t[i+4]=a.byteToFloat(n[i+4]);return t}}(i);case s:return s[u(i.cornerType,i)];case N:return N[u(i.heightReference,i)];case L:return L[u(i.horizontalOrigin,i)];case Image:return Me(i,o);case w:return w.fromIso8601(u(i.date,i));case F:return F[u(i.labelStyle,i)];case Number:return u(i.number,i);case T:return i.nearFarScalar;case A:return function(e){var t=i.unitQuaternion;if(c(t)){if(4===t.length)return Oe(t,0),t;for(var n=1;n<t.length;n+=5)Oe(t,n)}return t}();case Ce:return u(i.number,i);case B:return B[u(i.shadows,i)];case String:return u(i.string,i);case Se:return Se[u(i.stripeOrientation,i)];case P:return function(e){var t=e.wsen;if(c(t))return t;var n=e.wsenDegrees;if(c(n)){var r=n.length;if(r===P.packedLength)return[x.toRadians(n[0]),x.toRadians(n[1]),x.toRadians(n[2]),x.toRadians(n[3])];t=new Array(r);for(var i=0;i<r;i+=5)t[i]=n[i],t[i+1]=x.toRadians(n[i+1]),t[i+2]=x.toRadians(n[i+2]),t[i+3]=x.toRadians(n[i+3]),t[i+4]=x.toRadians(n[i+4]);return t}}(i);case V:return Me(i,o);case k:return k[u(i.verticalOrigin,i)];default:throw new M(r)}}(r,l,d),_=u(r.packedLength,1),y=u(v.length,1),g=!c(l.array)&&"string"!=typeof v&&y>_);var S="function"==typeof r.unpack&&r!==Ce;if(g||E){var D,I,R=i[o],z=l.epoch;if(c(z)&&(D=w.fromIso8601(z)),g&&!E)return R instanceof be||(R=new be(r),i[o]=R),R.addSamplesPackedArray(v,D),void Re(l,R);if(!g&&E)return f=f.clone(),f.data=b?De(p,l.reference):S?r.unpack(v,0):v,c(R)||(R=b?new q:new Te,i[o]=R),void(!b&&R instanceof Te?R.intervals.addInterval(f):R instanceof q?(f.data=b?f.data:new X(f.data),R.intervals.addInterval(f)):(I=C.MAXIMUM_INTERVAL.clone(),I.data=R,R=new q,i[o]=R,R.intervals.addInterval(I),f.data=b?f.data:new X(f.data),R.intervals.addInterval(f)));c(R)||(R=new q,i[o]=R),R instanceof q||((I=C.MAXIMUM_INTERVAL.clone()).data=R,R=new q,i[o]=R,R.intervals.addInterval(I));var U=R.intervals;I=U.findInterval(f),c(I)&&I.data instanceof be||((I=f.clone()).data=new be(r),U.addInterval(I)),I.data.addSamplesPackedArray(v,D),Re(l,I.data)}else i[o]=b?De(p,l.reference):new X(S?r.unpack(v,0):v)}function Le(e,t,n,r,i,o,a){if(c(r))if(y(r))for(var s=0,l=r.length;s<l;s++)Ne(e,t,n,r[s],i,o,a);else Ne(e,t,n,r,i,o,a)}function Fe(e,t,r,i,o,a){var s,l=r.interval;c(l)?(tt.iso8601=l,s=O.fromIso8601(tt),c(i)&&(s=O.intersect(s,i,$e))):c(i)&&(s=i);var h,d,p=!1,f=c(r.cartesianVelocity)?1:0,m=n.packedLength*(f+1),_=c(r.reference),g=c(s)&&!s.equals(C.MAXIMUM_INTERVAL);if(_||(c(r.referenceFrame)&&(h=D[r.referenceFrame]),h=u(h,D.FIXED),d=Ie(r),p=u(d.length,1)>m),p||g){var v,y,b=e[t],E=r.epoch;if(c(E)&&(v=w.fromIso8601(E)),p&&!g)return b instanceof we&&(!c(h)||b.referenceFrame===h)||(b=new we(h,f),e[t]=b),b.addSamplesPackedArray(d,v),void Re(r,b);if(!p&&g)return s=s.clone(),s.data=_?De(a,r.reference):n.unpack(d),c(b)||(b=_?new j(h):new xe(h),e[t]=b),void(!_&&b instanceof xe&&c(h)&&b.referenceFrame===h?b.intervals.addInterval(s):b instanceof j?(s.data=_?s.data:new Y(s.data,h),b.intervals.addInterval(s)):(y=C.MAXIMUM_INTERVAL.clone(),y.data=b,b=new j(b.referenceFrame),e[t]=b,b.intervals.addInterval(y),s.data=_?s.data:new Y(s.data,h),b.intervals.addInterval(s)));c(b)?b instanceof j||((y=C.MAXIMUM_INTERVAL.clone()).data=b,b=new j(b.referenceFrame),e[t]=b,b.intervals.addInterval(y)):(b=new j(h),e[t]=b);var S=b.intervals;y=S.findInterval(s),c(y)&&y.data instanceof we&&(!c(h)||y.data.referenceFrame===h)||((y=s.clone()).data=new we(h,f),S.addInterval(y)),y.data.addSamplesPackedArray(d,v),Re(r,y.data)}else e[t]=_?De(a,r.reference):new Y(n.unpack(d),h)}function Be(e,t,n,r,i,o){if(c(n))if(y(n))for(var a=0,s=n.length;a<s;a++)Fe(e,t,n[a],r,0,o);else Fe(e,t,n,r,0,o)}function ke(e,n,r,i,o,s){var l,u=r.interval;c(u)?(tt.iso8601=u,l=O.fromIso8601(tt),c(i)&&(l=O.intersect(l,i,$e))):c(i)&&(l=i);var h,d,p,f=e[n];if(c(l)){f instanceof H||(f=new H,e[n]=f);var m=f.intervals;d=m.findInterval({start:l.start,stop:l.stop}),c(d)?h=d.data:(d=l.clone(),m.addInterval(d))}else h=f;c(r.solidColor)?(h instanceof W||(h=new W),Le(a,h,"color",(p=r.solidColor).color,void 0,void 0,s)):c(r.grid)?(h instanceof re||(h=new re),Le(a,h,"color",(p=r.grid).color,void 0,o,s),Le(Number,h,"cellAlpha",p.cellAlpha,void 0,o,s),Le(t,h,"lineCount",p.lineCount,void 0,o,s),Le(t,h,"lineThickness",p.lineThickness,void 0,o,s),Le(t,h,"lineOffset",p.lineOffset,void 0,o,s)):c(r.image)?(h instanceof ie||(h=new ie),p=r.image,Le(Image,h,"image",p.image,void 0,o,s),Le(t,h,"repeat",p.repeat,void 0,o,s),Le(a,h,"color",p.color,void 0,o,s),Le(Boolean,h,"transparent",p.transparent,void 0,o,s)):c(r.stripe)?(h instanceof Ee||(h=new Ee),Le(Se,h,"orientation",(p=r.stripe).orientation,void 0,o,s),Le(a,h,"evenColor",p.evenColor,void 0,o,s),Le(a,h,"oddColor",p.oddColor,void 0,o,s),Le(Number,h,"offset",p.offset,void 0,o,s),Le(Number,h,"repeat",p.repeat,void 0,o,s)):c(r.polylineOutline)?(h instanceof fe||(h=new fe),Le(a,h,"color",(p=r.polylineOutline).color,void 0,o,s),Le(a,h,"outlineColor",p.outlineColor,void 0,o,s),Le(Number,h,"outlineWidth",p.outlineWidth,void 0,o,s)):c(r.polylineGlow)?(h instanceof de||(h=new de),Le(a,h,"color",(p=r.polylineGlow).color,void 0,o,s),Le(Number,h,"glowPower",p.glowPower,void 0,o,s)):c(r.polylineArrow)&&(h instanceof he||(h=new he),Le(a,h,"color",(p=r.polylineArrow).color,void 0,void 0,s)),c(d)?d.data=h:e[n]=h}function Ve(e,t,n,r,i,o){if(c(n))if(y(n))for(var a=0,s=n.length;a<s;a++)ke(e,t,n[a],r,i,o);else ke(e,t,n,r,i,o)}function ze(e,t,n,r){var i=n.references;if(c(i)){var o=i.map(function(e){return De(r,e)}),a=n.interval;if(c(a)){if(a=O.fromIso8601(a),!(e[t]instanceof j)){a.data=new _e(o);var s=new q;s.intervals.addInterval(a),e[t]=s}}else e[t]=new _e(o)}else Le(Array,e,t,n,void 0,void 0,r)}function Ue(e,t,n,r){if(c(n))if(y(n))for(var i=0,o=n.length;i<o;++i)ze(e,t,n[i],r);else ze(e,t,n,r)}function Ge(e,t,r,i){if(c(r.references)){var o=r.references.map(function(e){return De(i,e)}),a=r.interval;if(c(a)){if(a=O.fromIso8601(a),!(e[t]instanceof j)){a.data=new me(o);var s=new j;s.intervals.addInterval(a),e[t]=s}}else e[t]=new me(o)}else c(r.cartesian)?r.array=n.unpackArray(r.cartesian):c(r.cartographicRadians)?r.array=n.fromRadiansArrayHeights(r.cartographicRadians):c(r.cartographicDegrees)&&(r.array=n.fromDegreesArrayHeights(r.cartographicDegrees)),c(r.array)&&Le(Array,e,t,r,void 0,void 0,i)}function We(e,t,n,r){if(c(n))if(y(n))for(var i=0,o=n.length;i<o;i++)Ge(e,t,n[i],r);else Ge(e,t,n,r)}function He(e,t,r,i,o){var a,s=t.interval;c(s)?(tt.iso8601=s,a=O.fromIso8601(tt),c(r)&&(a=O.intersect(a,r,$e))):c(r)&&(a=r);for(var l=e.nodeTransformations,u=Object.keys(t),h=0,d=u.length;h<d;++h){var p=u[h];if("interval"!==p){var f=t[p];if(c(f)){c(l)||(e.nodeTransformations=l=new ge),l.hasProperty(p)||l.addProperty(p);var m=l[p];c(m)||(l[p]=m=new se),Le(n,m,"translation",f.translation,a,i,o),Le(A,m,"rotation",f.rotation,a,i,o),Le(n,m,"scale",f.scale,a,i,o)}}}}function je(e,t,n,r,i){var o=e.id;if(c(o)||(o=l()),Ze=o,!c(i._version)&&"document"!==o)throw new M("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(o);else if("document"===o)!function(e,t){var n=e.version;if(c(n)&&"string"==typeof n){var r=n.split(".");if(2===r.length){if("1"!==r[0])throw new M("Cesium only supports CZML version 1.");t._version=n}}if(!c(t._version))throw new M("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");var i=t._documentPacket;c(e.name)&&(i.name=e.name);var o=e.clock;if(c(o)){var a=i.clock;c(a)?(a.interval=u(o.interval,a.interval),a.currentTime=u(o.currentTime,a.currentTime),a.range=u(o.range,a.range),a.step=u(o.step,a.step),a.multiplier=u(o.multiplier,a.multiplier)):i.clock={interval:o.interval,currentTime:o.currentTime,range:o.range,step:o.step,multiplier:o.multiplier}}}(e,i);else{var a=t.getOrCreateEntity(o),s=e.parent;c(s)&&(a.parent=t.getOrCreateEntity(s));for(var h=n.length-1;h>-1;h--)n[h](a,e,t,r)}Ze=void 0}function qe(e,t,n,r){var a=t,s=(n=u(n,u.EMPTY_OBJECT)).sourceUri;return"string"==typeof t&&(a=S(t),s=u(s,t)),Q.setLoading(e,!0),z(a,function(t){return function(e,t,n,r){Q.setLoading(e,!0);var a=e._entityCollection;r&&(e._version=void 0,e._documentPacket=new Ye,a.removeAll()),Xe._processCzml(t,a,n,void 0,e);var s=function(e){var t,n=e._documentPacket.clock;if(!c(n)){if(!c(e._clock)){var r=e._entityCollection.computeAvailability();if(!r.start.equals(C.MINIMUM_VALUE)){var a=r.start,s=r.stop,l=w.secondsDifference(s,a),h=Math.round(l/120);return(t=new J).startTime=w.clone(a),t.stopTime=w.clone(s),t.clockRange=i.LOOP_STOP,t.multiplier=h,t.currentTime=w.clone(a),t.clockStep=o.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}if(c(e._clock)?t=e._clock.clone():((t=new J).startTime=C.MINIMUM_VALUE.clone(),t.stopTime=C.MAXIMUM_VALUE.clone(),t.currentTime=C.MINIMUM_VALUE.clone(),t.clockRange=i.LOOP_STOP,t.clockStep=o.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1),c(n.interval)){tt.iso8601=n.interval;var d=O.fromIso8601(tt);t.startTime=d.start,t.stopTime=d.stop}return c(n.currentTime)&&(t.currentTime=w.fromIso8601(n.currentTime)),c(n.range)&&(t.clockRange=u(i[n.range],i.LOOP_STOP)),c(n.step)&&(t.clockStep=u(o[n.step],o.SYSTEM_CLOCK_MULTIPLIER)),c(n.multiplier)&&(t.multiplier=n.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}(e),l=e._documentPacket;return c(l.name)&&e._name!==l.name?(e._name=l.name,s=!0):!c(e._name)&&c(n)&&(e._name=g(n),s=!0),Q.setLoading(e,!1),s&&e._changed.raiseEvent(e),e}(e,t,s,r)}).otherwise(function(t){return Q.setLoading(e,!1),e._error.raiseEvent(e,t),console.log(t),z.reject(t)})}function Ye(){this.name=void 0,this.clock=void 0}function Xe(e){this._name=e,this._changed=new f,this._error=new f,this._isLoading=!1,this._loading=new f,this._clock=void 0,this._documentPacket=new Ye,this._version=void 0,this._entityCollection=new ne(this),this._entityCluster=new te}var Ze,Ke=new n,Qe=new I,Je=new r,$e=new O,et={HERMITE:v,LAGRANGE:b,LINEAR:E},tt={iso8601:void 0};return Xe.load=function(e,t){return(new Xe).load(e,t)},h(Xe.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),Xe.updaters=[function(r,i,o,s){var l,u,h,d,p,f=i.billboard;if(c(f)){var m,_=f.interval;c(_)&&(tt.iso8601=_,m=O.fromIso8601(tt));var g=r.billboard;c(g)||(r.billboard=g=new U),Le(Boolean,g,"show",f.show,m,s,o),Le(Image,g,"image",f.image,m,s,o),Le(Number,g,"scale",f.scale,m,s,o),Le(t,g,"pixelOffset",f.pixelOffset,m,s,o),Le(n,g,"eyeOffset",f.eyeOffset,m,s,o),Le(L,g,"horizontalOrigin",f.horizontalOrigin,m,s,o),Le(k,g,"verticalOrigin",f.verticalOrigin,m,s,o),Le(N,g,"heightReference",f.heightReference,m,s,o),Le(a,g,"color",f.color,m,s,o),Le(Ce,g,"rotation",f.rotation,m,s,o),l=g,h=m,d=s,p=o,c(u=f.alignedAxis)&&(c(u.velocityReference)?l.alignedAxis=new Ae(De(p,u.velocityReference),!0):Le(n,l,"alignedAxis",u,h,d,p)),Le(Boolean,g,"sizeInMeters",f.sizeInMeters,m,s,o),Le(Number,g,"width",f.width,m,s,o),Le(Number,g,"height",f.height,m,s,o),Le(T,g,"scaleByDistance",f.scaleByDistance,m,s,o),Le(T,g,"translucencyByDistance",f.translucencyByDistance,m,s,o),Le(T,g,"pixelOffsetScaleByDistance",f.pixelOffsetScaleByDistance,m,s,o),Le(e,g,"imageSubRegion",f.imageSubRegion,m,s,o)}},function(e,t,r,i){var o=t.box;if(c(o)){var s,l=o.interval;c(l)&&(tt.iso8601=l,s=O.fromIso8601(tt));var u=e.box;c(u)||(e.box=u=new G),Le(Boolean,u,"show",o.show,s,i,r),Le(n,u,"dimensions",o.dimensions,s,i,r),Le(Boolean,u,"fill",o.fill,s,i,r),Ve(u,"material",o.material,s,i,r),Le(Boolean,u,"outline",o.outline,s,i,r),Le(a,u,"outlineColor",o.outlineColor,s,i,r),Le(Number,u,"outlineWidth",o.outlineWidth,s,i,r),Le(B,u,"shadows",o.shadows,s,i,r)}},function(e,t,n,r){var i=t.corridor;if(c(i)){var o,l=i.interval;c(l)&&(tt.iso8601=l,o=O.fromIso8601(tt));var u=e.corridor;c(u)||(e.corridor=u=new Z),Le(Boolean,u,"show",i.show,o,r,n),We(u,"positions",i.positions,n),Le(Number,u,"width",i.width,o,r,n),Le(Number,u,"height",i.height,o,r,n),Le(Number,u,"extrudedHeight",i.extrudedHeight,o,r,n),Le(s,u,"cornerType",i.cornerType,o,r,n),Le(Number,u,"granularity",i.granularity,o,r,n),Le(Boolean,u,"fill",i.fill,o,r,n),Ve(u,"material",i.material,o,r,n),Le(Boolean,u,"outline",i.outline,o,r,n),Le(a,u,"outlineColor",i.outlineColor,o,r,n),Le(Number,u,"outlineWidth",i.outlineWidth,o,r,n),Le(B,u,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.cylinder;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.cylinder;c(l)||(e.cylinder=l=new K),Le(Boolean,l,"show",i.show,o,r,n),Le(Number,l,"length",i.length,o,r,n),Le(Number,l,"topRadius",i.topRadius,o,r,n),Le(Number,l,"bottomRadius",i.bottomRadius,o,r,n),Le(Boolean,l,"fill",i.fill,o,r,n),Ve(l,"material",i.material,o,r,n),Le(Boolean,l,"outline",i.outline,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(Number,l,"numberOfVerticalLines",i.numberOfVerticalLines,o,r,n),Le(Number,l,"slices",i.slices,o,r,n),Le(B,l,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.ellipse;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.ellipse;c(l)||(e.ellipse=l=new $),Le(Boolean,l,"show",i.show,o,r,n),Le(Number,l,"semiMajorAxis",i.semiMajorAxis,o,r,n),Le(Number,l,"semiMinorAxis",i.semiMinorAxis,o,r,n),Le(Number,l,"height",i.height,o,r,n),Le(Number,l,"extrudedHeight",i.extrudedHeight,o,r,n),Le(Ce,l,"rotation",i.rotation,o,r,n),Le(Ce,l,"stRotation",i.stRotation,o,r,n),Le(Number,l,"granularity",i.granularity,o,r,n),Le(Boolean,l,"fill",i.fill,o,r,n),Ve(l,"material",i.material,o,r,n),Le(Boolean,l,"outline",i.outline,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(Number,l,"numberOfVerticalLines",i.numberOfVerticalLines,o,r,n),Le(B,l,"shadows",i.shadows,o,r,n)}},function(e,t,r,i){var o=t.ellipsoid;if(c(o)){var s,l=o.interval;c(l)&&(tt.iso8601=l,s=O.fromIso8601(tt));var u=e.ellipsoid;c(u)||(e.ellipsoid=u=new ee),Le(Boolean,u,"show",o.show,s,i,r),Le(n,u,"radii",o.radii,s,i,r),Le(Boolean,u,"fill",o.fill,s,i,r),Ve(u,"material",o.material,s,i,r),Le(Boolean,u,"outline",o.outline,s,i,r),Le(a,u,"outlineColor",o.outlineColor,s,i,r),Le(Number,u,"outlineWidth",o.outlineWidth,s,i,r),Le(Number,u,"stackPartitions",o.stackPartitions,s,i,r),Le(Number,u,"slicePartitions",o.slicePartitions,s,i,r),Le(Number,u,"subdivisions",o.subdivisions,s,i,r),Le(B,u,"shadows",o.shadows,s,i,r)}},function(e,r,i,o){var s=r.label;if(c(s)){var l,u=s.interval;c(u)&&(tt.iso8601=u,l=O.fromIso8601(tt));var h=e.label;c(h)||(e.label=h=new oe),Le(Boolean,h,"show",s.show,l,o,i),Le(String,h,"text",s.text,l,o,i),Le(String,h,"font",s.font,l,o,i),Le(F,h,"style",s.style,l,o,i),Le(Number,h,"scale",s.scale,l,o,i),Le(t,h,"pixelOffset",s.pixelOffset,l,o,i),Le(n,h,"eyeOffset",s.eyeOffset,l,o,i),Le(L,h,"horizontalOrigin",s.horizontalOrigin,l,o,i),Le(k,h,"verticalOrigin",s.verticalOrigin,l,o,i),Le(N,h,"heightReference",s.heightReference,l,o,i),Le(a,h,"fillColor",s.fillColor,l,o,i),Le(a,h,"outlineColor",s.outlineColor,l,o,i),Le(Number,h,"outlineWidth",s.outlineWidth,l,o,i),Le(T,h,"translucencyByDistance",s.translucencyByDistance,l,o,i),Le(T,h,"pixelOffsetScaleByDistance",s.pixelOffsetScaleByDistance,l,o,i)}},function(e,t,n,r){var i=t.model;if(c(i)){var o,a=i.interval;c(a)&&(tt.iso8601=a,o=O.fromIso8601(tt));var s=e.model;c(s)||(e.model=s=new ae),Le(Boolean,s,"show",i.show,o,r,n),Le(V,s,"uri",i.gltf,o,r,n),Le(Number,s,"scale",i.scale,o,r,n),Le(Number,s,"minimumPixelSize",i.minimumPixelSize,o,r,n),Le(Number,s,"maximumScale",i.maximumScale,o,r,n),Le(Boolean,s,"incrementallyLoadTextures",i.incrementallyLoadTextures,o,r,n),Le(Boolean,s,"runAnimations",i.runAnimations,o,r,n),Le(B,s,"shadows",i.shadows,o,r,n),Le(N,s,"heightReference",i.heightReference,o,r,n);var l=i.nodeTransformations;if(c(l))if(y(l))for(var u=0,h=l.length;u<h;u++)He(s,l[u],o,r,n);else He(s,l,o,r,n)}},function(e,t,n,r){e.name=u(t.name,e.name)},function(e,t,n,r){var i=t.description;c(i)&&Le(String,e,"description",i,void 0,r,n)},function(e,t,n,r){var i=t.path;if(c(i)){var o,a=i.interval;c(a)&&(tt.iso8601=a,o=O.fromIso8601(tt));var s=e.path;c(s)||(e.path=s=new le),Le(Boolean,s,"show",i.show,o,r,n),Le(Number,s,"width",i.width,o,r,n),Le(Number,s,"resolution",i.resolution,o,r,n),Le(Number,s,"leadTime",i.leadTime,o,r,n),Le(Number,s,"trailTime",i.trailTime,o,r,n),Ve(s,"material",i.material,o,r,n)}},function(e,t,n,r){var i=t.point;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.point;c(l)||(e.point=l=new ue),Le(Boolean,l,"show",i.show,o,r,n),Le(Number,l,"pixelSize",i.pixelSize,o,r,n),Le(N,l,"heightReference",i.heightReference,o,r,n),Le(a,l,"color",i.color,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(T,l,"scaleByDistance",i.scaleByDistance,o,r,n),Le(T,l,"translucencyByDistance",i.translucencyByDistance,o,r,n)}},function(e,t,n,r){var i=t.polygon;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.polygon;c(l)||(e.polygon=l=new ce),Le(Boolean,l,"show",i.show,o,r,n),We(l,"hierarchy",i.positions,n),Le(Number,l,"height",i.height,o,r,n),Le(Number,l,"extrudedHeight",i.extrudedHeight,o,r,n),Le(Ce,l,"stRotation",i.stRotation,o,r,n),Le(Number,l,"granularity",i.granularity,o,r,n),Le(Boolean,l,"fill",i.fill,o,r,n),Ve(l,"material",i.material,o,r,n),Le(Boolean,l,"outline",i.outline,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(Boolean,l,"perPositionHeight",i.perPositionHeight,o,r,n),Le(Boolean,l,"closeTop",i.closeTop,o,r,n),Le(Boolean,l,"closeBottom",i.closeBottom,o,r,n),Le(B,l,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.polyline;if(c(i)){var o,a=i.interval;c(a)&&(tt.iso8601=a,o=O.fromIso8601(tt));var s=e.polyline;c(s)||(e.polyline=s=new pe),Le(Boolean,s,"show",i.show,o,r,n),We(s,"positions",i.positions,n),Le(Number,s,"width",i.width,o,r,n),Le(Number,s,"granularity",i.granularity,o,r,n),Ve(s,"material",i.material,o,r,n),Le(Boolean,s,"followSurface",i.followSurface,o,r,n),Le(B,s,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.rectangle;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.rectangle;c(l)||(e.rectangle=l=new ve),Le(Boolean,l,"show",i.show,o,r,n),Le(P,l,"coordinates",i.coordinates,o,r,n),Le(Number,l,"height",i.height,o,r,n),Le(Number,l,"extrudedHeight",i.extrudedHeight,o,r,n),Le(Ce,l,"rotation",i.rotation,o,r,n),Le(Ce,l,"stRotation",i.stRotation,o,r,n),Le(Number,l,"granularity",i.granularity,o,r,n),Le(Boolean,l,"fill",i.fill,o,r,n),Ve(l,"material",i.material,o,r,n),Le(Boolean,l,"outline",i.outline,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(Boolean,l,"closeTop",i.closeTop,o,r,n),Le(Boolean,l,"closeBottom",i.closeBottom,o,r,n),Le(B,l,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.position;c(i)&&Be(e,"position",i,void 0,0,n)},function(e,t,r,i){var o=t.viewFrom;c(o)&&Le(n,e,"viewFrom",o,void 0,i,r)},function(e,t,n,r){var i=t.wall;if(c(i)){var o,s=i.interval;c(s)&&(tt.iso8601=s,o=O.fromIso8601(tt));var l=e.wall;c(l)||(e.wall=l=new Pe),Le(Boolean,l,"show",i.show,o,r,n),We(l,"positions",i.positions,n),Ue(l,"minimumHeights",i.minimumHeights,n),Ue(l,"maximumHeights",i.maximumHeights,n),Le(Number,l,"granularity",i.granularity,o,r,n),Le(Boolean,l,"fill",i.fill,o,r,n),Ve(l,"material",i.material,o,r,n),Le(Boolean,l,"outline",i.outline,o,r,n),Le(a,l,"outlineColor",i.outlineColor,o,r,n),Le(Number,l,"outlineWidth",i.outlineWidth,o,r,n),Le(B,l,"shadows",i.shadows,o,r,n)}},function(e,t,n,r){var i=t.orientation;c(i)&&Le(A,e,"orientation",i,void 0,r,n)},function(e,t,n,r){var i,o=t.availability;if(c(o)){var a;if(y(o))for(var s=o.length,l=0;l<s;l++)c(a)||(a=new R),tt.iso8601=o[l],i=O.fromIso8601(tt),a.addInterval(i);else tt.iso8601=o,i=O.fromIso8601(tt),a=new R,a.addInterval(i);e.availability=a}}],Xe.prototype.process=function(e,t){return qe(this,e,t,!1)},Xe.prototype.load=function(e,t){return qe(this,e,t,!0)},Xe.processPacketData=Le,Xe.processPositionPacketData=Be,Xe.processMaterialPacketData=Ve,Xe._processCzml=function(e,t,n,r,i){if(r=c(r)?r:Xe.updaters,y(e))for(var o=0,a=e.length;o<a;o++)je(e[o],t,r,n,i);else je(e,t,r,n,i)},Xe}),o("DataSources/DataSourceCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../ThirdParty/when"],function(e,t,n,r,i,o,a){"use strict";function s(){this._dataSources=[],this._dataSourceAdded=new o,this._dataSourceRemoved=new o}return n(s.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}}}),s.prototype.add=function(e){var t=this,n=this._dataSources;return a(e,function(e){return n===t._dataSources&&(t._dataSources.push(e),t._dataSourceAdded.raiseEvent(t,e)),e})},s.prototype.remove=function(t,n){n=e(n,!1);var r=this._dataSources.indexOf(t);return-1!==r&&(this._dataSources.splice(r,1),this._dataSourceRemoved.raiseEvent(this,t),n&&"function"==typeof t.destroy&&t.destroy(),!0)},s.prototype.removeAll=function(t){t=e(t,!1);for(var n=this._dataSources,r=0,i=n.length;r<i;++r){var o=n[r];this._dataSourceRemoved.raiseEvent(this,o),t&&"function"==typeof o.destroy&&o.destroy()}this._dataSources=[]},s.prototype.contains=function(e){return-1!==this.indexOf(e)},s.prototype.indexOf=function(e){return this._dataSources.indexOf(e)},s.prototype.get=function(e){return this._dataSources[e]},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this.removeAll(!0),r(this)},s}),o("DataSources/EllipseGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipseGeometry","../Core/EllipseOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0}function A(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(A.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new h,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new T(e),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function P(e,t,n){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=n,this._options=new T(n._entity)}var D=new w(e.WHITE),M=new b(!0),I=new b(!0),O=new b(!1),R=new b(e.BLACK),N=new b(C.DISABLED),L=new b(new s),F=new e;return i(A,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:g}}),i(A.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),A.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},A.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},A.prototype.createFillGeometryInstance=function(n){var i,o=this._entity,a=o.isAvailable(n),s=new m(a&&o.isShowing&&this._showProperty.getValue(n)&&this._fillProperty.getValue(n)),c=this._distanceDisplayConditionProperty.getValue(n),h=l.fromDistanceDisplayCondition(c);if(this._materialProperty instanceof w){var p=e.WHITE;r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(p=this._materialProperty.color.getValue(n)),i={show:s,distanceDisplayCondition:h,color:t.fromColor(p)}}else i={show:s,distanceDisplayCondition:h};return new d({id:o,geometry:new u(this._options),attributes:i})},A.prototype.createOutlineGeometryInstance=function(n){var r=this._entity,i=r.isAvailable(n),o=x.getValueOrDefault(this._outlineColorProperty,n,e.BLACK),a=this._distanceDisplayConditionProperty.getValue(n);return new d({id:r,geometry:new c(this._options),attributes:{show:new m(i&&r.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(a)}})},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._entitySubscription(),o(this)},A.prototype._onEntityPropertyChanged=function(e,t,i,o){if("availability"===t||"position"===t||"ellipse"===t){var a=this._entity.ellipse;if(!r(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(p.MINIMUM_VALUE),u=a.outline,c=r(u);if(c&&u.isConstant&&(c=u.getValue(p.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var h=this._entity.position,d=a.semiMajorAxis,m=a.semiMinorAxis,y=a.show;if(r(y)&&y.isConstant&&!y.getValue(p.MINIMUM_VALUE)||!r(h)||!r(d)||!r(m))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var C=n(a.material,D),b=C instanceof w;this._materialProperty=C,this._fillProperty=n(s,I),this._showProperty=n(y,M),this._showOutlineProperty=n(a.outline,O),this._outlineColorProperty=c?n(a.outlineColor,R):void 0,this._shadowsProperty=n(a.shadows,N),this._distanceDisplayConditionProperty=n(a.distanceDisplayCondition,L);var E=a.rotation,S=a.height,T=a.extrudedHeight,A=a.granularity,P=a.stRotation,F=a.outlineWidth,B=a.numberOfVerticalLines,k=l&&!r(S)&&!r(T)&&b&&_.isSupported(this._scene);if(c&&k&&(f(f.geometryOutlines),c=!1),this._fillEnabled=l,this._onTerrain=k,this._isClosed=r(T)||k,this._outlineEnabled=c,h.isConstant&&d.isConstant&&m.isConstant&&x.isConstant(E)&&x.isConstant(S)&&x.isConstant(T)&&x.isConstant(A)&&x.isConstant(P)&&x.isConstant(F)&&x.isConstant(B)&&(!k||x.isConstant(C))){var V=this._options;V.vertexFormat=b?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,V.center=h.getValue(p.MINIMUM_VALUE,V.center),V.semiMajorAxis=d.getValue(p.MINIMUM_VALUE,V.semiMajorAxis),V.semiMinorAxis=m.getValue(p.MINIMUM_VALUE,V.semiMinorAxis),V.rotation=r(E)?E.getValue(p.MINIMUM_VALUE):void 0,V.height=r(S)?S.getValue(p.MINIMUM_VALUE):void 0,V.extrudedHeight=r(T)?T.getValue(p.MINIMUM_VALUE):void 0,V.granularity=r(A)?A.getValue(p.MINIMUM_VALUE):void 0,V.stRotation=r(P)?P.getValue(p.MINIMUM_VALUE):void 0,V.numberOfVerticalLines=r(B)?B.getValue(p.MINIMUM_VALUE):void 0,this._outlineWidth=r(F)?F.getValue(p.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},A.prototype.createDynamicUpdater=function(e,t){return new P(e,t,this)},P.prototype.update=function(n){var i=this._geometryUpdater,o=i._onTerrain,a=this._primitives,s=this._groundPrimitives;o?s.removeAndDestroy(this._primitive):(a.removeAndDestroy(this._primitive),a.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var h=i._entity,p=h.ellipse;if(h.isShowing&&h.isAvailable(n)&&x.getValueOrDefault(p.show,n,!0)){var f=this._options,m=x.getValueOrUndefined(h.position,n,f.center),C=x.getValueOrUndefined(p.semiMajorAxis,n),w=x.getValueOrUndefined(p.semiMinorAxis,n);if(r(m)&&r(C)&&r(w)){f.center=m,f.semiMajorAxis=C,f.semiMinorAxis=w,f.rotation=x.getValueOrUndefined(p.rotation,n),f.height=x.getValueOrUndefined(p.height,n),f.extrudedHeight=x.getValueOrUndefined(p.extrudedHeight,n),f.granularity=x.getValueOrUndefined(p.granularity,n),f.stRotation=x.getValueOrUndefined(p.stRotation,n),f.numberOfVerticalLines=x.getValueOrUndefined(p.numberOfVerticalLines,n);var b=this._geometryUpdater.shadowsProperty.getValue(n),E=this._geometryUpdater.distanceDisplayConditionProperty.getValue(n),T=l.fromDistanceDisplayCondition(E);if(x.getValueOrDefault(p.fill,n,!0)){var A=i.fillMaterialProperty,P=S.getValue(n,A,this._material);if(this._material=P,o){var D=e.WHITE;r(A.color)&&(D=A.color.getValue(n)),this._primitive=s.add(new _({geometryInstances:new d({id:h,geometry:new u(f),attributes:{color:t.fromColor(D),distanceDisplayCondition:T}}),asynchronous:!1,shadows:b}))}else{var M=new g({material:P,translucent:P.isTranslucent(),closed:r(f.extrudedHeight)});f.vertexFormat=M.vertexFormat,this._primitive=a.add(new y({geometryInstances:new d({id:h,geometry:new u(f)}),attributes:{distanceDisplayCondition:T},appearance:M,asynchronous:!1,shadows:b}))}}if(!o&&x.getValueOrDefault(p.outline,n,!1)){f.vertexFormat=v.VERTEX_FORMAT;var I=x.getValueOrClonedDefault(p.outlineColor,n,e.BLACK,F),O=x.getValueOrDefault(p.outlineWidth,n,1),R=1!==I.alpha;this._outlinePrimitive=a.add(new y({geometryInstances:new d({id:h,geometry:new c(f),attributes:{color:t.fromColor(I),distanceDisplayCondition:T}}),appearance:new v({flat:!0,translucent:R,renderState:{lineWidth:i._scene.clampLineWidth(O)}}),asynchronous:!1,shadows:b}))}}}},P.prototype.getBoundingSphere=function(e,t){return E(e,this._primitive,this._outlinePrimitive,t)},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){var e=this._primitives;this._geometryUpdater._onTerrain?this._groundPrimitives.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),o(this)},A}),o("DataSources/EllipsoidGeometryUpdater",["../Core/Cartesian3","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/EllipsoidGeometry","../Core/EllipsoidOutlineGeometry","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/Matrix4","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/SceneMode","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T){"use strict";function A(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0}function P(e,t){this._scene=t,this._entity=e,this._entitySubscription=e.definitionChanged.addEventListener(P.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new d,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new A(e),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function D(e,t){this._entity=t._entity,this._scene=t._scene,this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new A(t._entity),this._modelMatrix=new m,this._material=void 0,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0}var M=new b(t.WHITE),I=new E(!0),O=new E(!0),R=new E(!1),N=new E(t.BLACK),L=new E(w.DISABLED),F=new E(new l),B=new e,k=new t,V=new e(1,1,1);return o(P,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:g}}),o(P.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!i(this._entity.availability)&&T.isConstant(this._showProperty)&&T.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),P.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},P.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},P.prototype.createFillGeometryInstance=function(e){var r,o=this._entity,a=o.isAvailable(e),s=new _(a&&o.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),l=this._distanceDisplayConditionProperty.getValue(e),h=u.fromDistanceDisplayCondition(l);if(this._materialProperty instanceof b){var d=t.WHITE;i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(d=this._materialProperty.color.getValue(e)),r={show:s,distanceDisplayCondition:h,color:n.fromColor(d)}}else r={show:s,distanceDisplayCondition:h};return new p({id:o,geometry:new c(this._options),modelMatrix:o._getModelMatrix(f.MINIMUM_VALUE),attributes:r})},P.prototype.createOutlineGeometryInstance=function(e){var r=this._entity,i=r.isAvailable(e),o=T.getValueOrDefault(this._outlineColorProperty,e,t.BLACK),a=this._distanceDisplayConditionProperty.getValue(e);return new p({id:r,geometry:new h(this._options),modelMatrix:r._getModelMatrix(f.MINIMUM_VALUE),attributes:{show:new _(i&&r.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:n.fromColor(o),distanceDisplayCondition:u.fromDistanceDisplayCondition(a)}})},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){this._entitySubscription(),a(this)},P.prototype._onEntityPropertyChanged=function(e,t,n,o){if("availability"===t||"position"===t||"orientation"===t||"ellipsoid"===t){var a=e.ellipsoid;if(!i(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!i(s)||!s.isConstant||s.getValue(f.MINIMUM_VALUE),u=a.outline,c=i(u);if(c&&u.isConstant&&(c=u.getValue(f.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var h=e.position,d=a.radii,p=a.show;if(i(p)&&p.isConstant&&!p.getValue(f.MINIMUM_VALUE)||!i(h)||!i(d))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var m=r(a.material,M),_=m instanceof b;this._materialProperty=m,this._fillProperty=r(s,O),this._showProperty=r(p,I),this._showOutlineProperty=r(a.outline,R),this._outlineColorProperty=c?r(a.outlineColor,N):void 0,this._shadowsProperty=r(a.shadows,L),this._distanceDisplayConditionProperty=r(a.distanceDisplayCondition,F),this._fillEnabled=l,this._outlineEnabled=c;var y=a.stackPartitions,C=a.slicePartitions,w=a.outlineWidth,E=a.subdivisions;if(h.isConstant&&T.isConstant(e.orientation)&&d.isConstant&&T.isConstant(y)&&T.isConstant(C)&&T.isConstant(w)&&T.isConstant(E)){var S=this._options;S.vertexFormat=_?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,S.radii=d.getValue(f.MINIMUM_VALUE,S.radii),S.stackPartitions=i(y)?y.getValue(f.MINIMUM_VALUE):void 0,S.slicePartitions=i(C)?C.getValue(f.MINIMUM_VALUE):void 0,S.subdivisions=i(E)?E.getValue(f.MINIMUM_VALUE):void 0,this._outlineWidth=i(w)?w.getValue(f.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},P.prototype.createDynamicUpdater=function(e){return new D(e,this)},D.prototype.update=function(e){var o=this._entity,a=o.ellipsoid;if(!o.isShowing||!o.isAvailable(e)||!T.getValueOrDefault(a.show,e,!0))return i(this._primitive)&&(this._primitive.show=!1),void(i(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var s=T.getValueOrUndefined(a.radii,e,B),d=o._getModelMatrix(e,this._modelMatrix);if(!i(d)||!i(s))return i(this._primitive)&&(this._primitive.show=!1),void(i(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var f,w=T.getValueOrDefault(a.fill,e,!0),b=T.getValueOrDefault(a.outline,e,!1),E=T.getValueOrClonedDefault(a.outlineColor,e,t.BLACK,k),S=x.getValue(e,r(a.material,M),this._material);this._material=S;var A=T.getValueOrUndefined(a.stackPartitions,e),P=T.getValueOrUndefined(a.slicePartitions,e),D=T.getValueOrUndefined(a.subdivisions,e),I=T.getValueOrDefault(a.outlineWidth,e,1),O=this._scene.mode,R=O===C.SCENE3D,N=this._options,L=this._geometryUpdater.shadowsProperty.getValue(e),F=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),z=u.fromDistanceDisplayCondition(F);if(R&&this._lastSceneMode===O&&i(this._primitive)&&N.stackPartitions===A&&N.slicePartitions===P&&N.subdivisions===D&&this._lastOutlineWidth===I){if(this._primitive.ready){var U=this._primitive,G=this._outlinePrimitive;U.show=!0,G.show=!0,(f=U.appearance).material=S;var W=this._attributes;i(W)||(W=U.getGeometryInstanceAttributes(o),this._attributes=W),w!==this._lastShow&&(W.show=_.toValue(w,W.show),this._lastShow=w);var H=this._outlineAttributes;i(H)||(H=G.getGeometryInstanceAttributes(o),this._outlineAttributes=H),b!==this._lastOutlineShow&&(H.show=_.toValue(b,H.show),this._lastOutlineShow=b),t.equals(E,this._lastOutlineColor)||(H.color=n.toValue(E,H.color),t.clone(E,this._lastOutlineColor)),l.equals(F,this._lastDistanceDisplayCondition)||(W.distanceDisplayCondition=u.toValue(F,W.distanceDisplayCondition),H.distanceDisplayCondition=u.toValue(F,H.distanceDisplayCondition),l.clone(F,this._lastDistanceDisplayCondition))}}else{var j=this._primitives;j.removeAndDestroy(this._primitive),j.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=O,this._lastOutlineWidth=I,N.stackPartitions=A,N.slicePartitions=P,N.subdivisions=D,N.radii=R?V:s,f=new g({material:S,translucent:S.isTranslucent(),closed:!0}),N.vertexFormat=f.vertexFormat,this._primitive=j.add(new y({geometryInstances:new p({id:o,geometry:new c(N),modelMatrix:R?void 0:d,attributes:{show:new _(w),distanceDisplayCondition:z}}),appearance:f,asynchronous:!1,shadows:L})),N.vertexFormat=v.VERTEX_FORMAT,this._outlinePrimitive=j.add(new y({geometryInstances:new p({id:o,geometry:new h(N),modelMatrix:R?void 0:d,attributes:{show:new _(b),color:n.fromColor(E),distanceDisplayCondition:z}}),appearance:new v({flat:!0,translucent:1!==E.alpha,renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(I)}}),asynchronous:!1,shadows:L})),this._lastShow=w,this._lastOutlineShow=b,this._lastOutlineColor=t.clone(E,this._lastOutlineColor),this._lastDistanceDisplayCondition=F}R&&(s.x=Math.max(s.x,.001),s.y=Math.max(s.y,.001),s.z=Math.max(s.z,.001),d=m.multiplyByScale(d,s,d),this._primitive.modelMatrix=d,this._outlinePrimitive.modelMatrix=d)},D.prototype.getBoundingSphere=function(e,t){return S(e,this._primitive,this._outlinePrimitive,t)},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),a(this)},P}),o("DataSources/StaticGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./Property"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(t,n,r,i,o){this.translucent=n,this.appearanceType=r,this.closed=i,this.shadows=o,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[]}function h(e,t,n,r){this._solidBatch=new c(e,!1,t,n,r),this._translucentBatch=new c(e,!0,t,n,r)}var d=new t,p=new i;return c.prototype.add=function(e,t){var n=e.entity.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&u.isConstant(e.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(t,n,i,o){"isShowing"===n&&r.showsUpdated.set(t.id,e)}))}else this.updatersWithAttributes.set(n,e)},c.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);r(n)&&(n(),this.subscriptions.remove(t))}},c.prototype.update=function(e){var l,c,h=!0,f=0,m=this.primitive,_=this.primitives;if(this.createPrimitive){var g=this.geometry.values,v=g.length;if(v>0){for(r(m)&&(r(this.oldPrimitive)?_.remove(m):this.oldPrimitive=m),c=0;c<v;c++){var y=g[c],C=y.attributes;l=this.attributes.get(y.id.id),r(l)&&(r(C.show)&&(C.show.value=l.show),r(C.color)&&(C.color.value=l.color))}m=new s({asynchronous:!0,geometryInstances:g,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),shadows:this.shadows}),_.add(m),h=!1}else{r(m)&&(_.remove(m),m=void 0);var w=this.oldPrimitive;r(w)&&(_.remove(w),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=m,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(r(m)&&m.ready){r(this.oldPrimitive)&&(_.remove(this.oldPrimitive),this.oldPrimitive=void 0);var b=this.updatersWithAttributes.values,E=b.length,S=this.waitingOnCreate;for(c=0;c<E;c++){var x=b[c],T=this.geometry.get(x.entity.id);l=this.attributes.get(T.id.id),r(l)||(l=m.getGeometryInstanceAttributes(T.id),this.attributes.set(T.id.id,l)),(!x.fillMaterialProperty.isConstant||S)&&(x.fillMaterialProperty.color.getValue(e,d),t.equals(l._lastColor,d)||(l._lastColor=t.clone(d,l._lastColor),l.color=n.toValue(d,l.color),(this.translucent&&255===l.color[3]||!this.translucent&&255!==l.color[3])&&(this.itemsToRemove[f++]=x)));var A=x.entity.isShowing&&(x.hasConstantFill||x.isFilled(e));A!==(1===l.show[0])&&(l.show=a.toValue(A,l.show));var P=x.distanceDisplayConditionProperty;if(!u.isConstant(P)){var D=P.getValue(e,p);i.equals(D,l._lastDistanceDisplayCondition)||(l._lastDistanceDisplayCondition=i.clone(D,l._lastDistanceDisplayCondition),l.distanceDisplayCondition=o.toValue(D,l.distanceDisplayCondition))}}this.updateShows(m),this.waitingOnCreate=!1}else r(m)&&!m.ready&&(h=!1);return this.itemsToRemove.length=f,h},c.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,n=t.length,i=0;i<n;i++){var o=t[i],s=this.geometry.get(o.entity.id),l=this.attributes.get(s.id.id);r(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var u=o.entity.isShowing;u!==(1===l.show[0])&&(l.show=a.toValue(u,l.show))}this.showsUpdated.removeAll()},c.prototype.contains=function(e){return this.updaters.contains(e.id)},c.prototype.getBoundingSphere=function(e,t){var n=this.primitive;if(!n.ready)return l.PENDING;var i=n.getGeometryInstanceAttributes(e);return!r(i)||!r(i.boundingSphere)||r(i.show)&&0===i.show[0]?l.FAILED:(i.boundingSphere.clone(t),l.DONE)},c.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;r(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var n=this.oldPrimitive;r(n)&&(e.remove(n),this.oldPrimitive=void 0)},h.prototype.add=function(e,t){var n=t.createFillGeometryInstance(e);255===n.attributes.color.value[3]?this._solidBatch.add(t,n):this._translucentBatch.add(t,n)},h.prototype.remove=function(e){this._solidBatch.remove(e)||this._translucentBatch.remove(e)},h.prototype.update=function(e){var t,n,r=this._solidBatch.update(e);r=this._translucentBatch.update(e)&&r;var i=this._solidBatch.itemsToRemove,o=i.length;if(o>0)for(t=0;t<o;t++)n=i[t],this._solidBatch.remove(n),this._translucentBatch.add(n,n.createFillGeometryInstance(e));var a=(i=this._translucentBatch.itemsToRemove).length;if(a>0)for(t=0;t<a;t++)n=i[t],this._translucentBatch.remove(n),this._solidBatch.add(n,n.createFillGeometryInstance(e));return(o>0||a>0)&&(r=this._solidBatch.update(e)&&r,r=this._translucentBatch.update(e)&&r),r},h.prototype.getBoundingSphere=function(e,t){return this._solidBatch.contains(e)?this._solidBatch.getBoundingSphere(e,t):this._translucentBatch.contains(e)?this._translucentBatch.getBoundingSphere(e,t):l.FAILED},h.prototype.removeAllPrimitives=function(){this._solidBatch.removeAllPrimitives(),this._translucentBatch.removeAllPrimitives()},h}),o("DataSources/StaticGeometryPerMaterialBatch",["../Core/AssociativeArray","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/Primitive","./BoundingSphereState","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t,n,r,i,o){this.primitives=t,this.appearanceType=n,this.materialProperty=r,this.closed=i,this.shadows=o,this.updaters=new e,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.material=void 0,this.updatersWithAttributes=new e,this.attributes=new e,this.invalidated=!1,this.removeMaterialSubscription=r.definitionChanged.addEventListener(u.prototype.onMaterialChanged,this),this.subscriptions=new e,this.showsUpdated=new e}function c(e,t,n,r){this._items=[],this._primitives=e,this._appearanceType=t,this._closed=n,this._shadows=r}var h=new n;return u.prototype.onMaterialChanged=function(){this.invalidated=!0},u.prototype.isMaterial=function(e){var n=this.materialProperty,r=e.fillMaterialProperty;return r===n||!!t(n)&&n.equals(r)},u.prototype.add=function(e,t){var n=t.entity.id;if(this.updaters.set(n,t),this.geometry.set(n,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&l.isConstant(t.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener(function(e,n,i,o){"isShowing"===n&&r.showsUpdated.set(e.id,t)}))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},u.prototype.remove=function(e){var n=e.entity.id;if(this.createPrimitive=this.geometry.remove(n)||this.createPrimitive,this.updaters.remove(n)){this.updatersWithAttributes.remove(n);var r=this.subscriptions.get(n);t(r)&&(r(),this.subscriptions.remove(n))}return this.createPrimitive},u.prototype.update=function(e){var a,u,c=!0,d=this.primitive,p=this.primitives,f=this.geometry.values;if(this.createPrimitive){var m=f.length;if(m>0){for(t(d)&&(t(this.oldPrimitive)?p.remove(d):this.oldPrimitive=d),u=0;u<m;u++){var _=f[u],g=_.attributes;a=this.attributes.get(_.id.id),t(a)&&(t(g.show)&&(g.show.value=a.show),t(g.color)&&(g.color.value=a.color))}this.material=s.getValue(e,this.materialProperty,this.material),d=new o({asynchronous:!0,geometryInstances:f,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),shadows:this.shadows}),p.add(d),c=!1}else{t(d)&&(p.remove(d),d=void 0);var v=this.oldPrimitive;t(v)&&(p.remove(v),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=d,this.createPrimitive=!1}else if(t(d)&&d.ready){t(this.oldPrimitive)&&(p.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=s.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;var y=this.updatersWithAttributes.values,C=y.length;for(u=0;u<C;u++){var w=y[u],b=w.entity,E=this.geometry.get(b.id);a=this.attributes.get(E.id.id),t(a)||(a=d.getGeometryInstanceAttributes(E.id),this.attributes.set(E.id.id,a));var S=b.isShowing&&(w.hasConstantFill||w.isFilled(e));S!==(1===a.show[0])&&(a.show=i.toValue(S,a.show));var x=w.distanceDisplayConditionProperty;if(!l.isConstant(x)){var T=x.getValue(e,h);n.equals(T,a._lastDistanceDisplayCondition)||(a._lastDistanceDisplayCondition=n.clone(T,a._lastDistanceDisplayCondition),a.distanceDisplayCondition=r.toValue(T,a.distanceDisplayCondition))}}this.updateShows(d)}else t(d)&&!d.ready&&(c=!1);return c},u.prototype.updateShows=function(e){for(var n=this.showsUpdated.values,r=n.length,o=0;o<r;o++){var a=n[o].entity,s=this.geometry.get(a.id),l=this.attributes.get(s.id.id);t(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var u=a.isShowing;u!==(1===l.show[0])&&(l.show=i.toValue(u,l.show))}this.showsUpdated.removeAll()},u.prototype.contains=function(e){return this.updaters.contains(e.id)},u.prototype.getBoundingSphere=function(e,n){var r=this.primitive;if(!r.ready)return a.PENDING;var i=r.getGeometryInstanceAttributes(e);return!t(i)||!t(i.boundingSphere)||t(i.show)&&0===i.show[0]?a.FAILED:(i.boundingSphere.clone(n),a.DONE)},u.prototype.destroy=function(e){var n=this.primitive,r=this.primitives;t(n)&&r.remove(n);var i=this.oldPrimitive;t(i)&&r.remove(i),this.removeMaterialSubscription()},c.prototype.add=function(e,t){for(var n=this._items,r=n.length,i=0;i<r;i++){var o=n[i];if(o.isMaterial(t))return void o.add(e,t)}var a=new u(this._primitives,this._appearanceType,t.fillMaterialProperty,this._closed,this._shadows);a.add(e,t),n.push(a)},c.prototype.remove=function(e){for(var t=this._items,n=t.length-1;n>=0;n--){var r=t[n];if(r.remove(e)){0===r.updaters.length&&(t.splice(n,1),r.destroy());break}}},c.prototype.update=function(e){var t,n=this._items,r=n.length;for(t=r-1;t>=0;t--){var i=n[t];if(i.invalidated){n.splice(t,1);for(var o=i.updaters.values,a=o.length,s=0;s<a;s++)this.add(e,o[s]);i.destroy()}}var l=!0;for(t=0;t<r;t++)l=n[t].update(e)&&l;return l},c.prototype.getBoundingSphere=function(e,t){for(var n=this._items,r=n.length,i=0;i<r;i++){var o=n[i];if(o.contains(e))return o.getBoundingSphere(e,t)}return a.FAILED},c.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,n=0;n<t;n++)e[n].destroy();this._items.length=0},c}),o("DataSources/StaticGroundGeometryColorBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","./BoundingSphereState","./Property"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(t,n,r){this.primitives=t,this.color=n,this.key=r,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.subscriptions=new e,this.showsUpdated=new e,this.itemsToRemove=[],this.isDirty=!1}function h(t){this._batches=new e,this._primitives=t}var d=new t,p=new i;c.prototype.add=function(e,t){var n=e.entity.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&u.isConstant(e.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(t,n,i,o){"isShowing"===n&&r.showsUpdated.set(t.id,e)}))}else this.updatersWithAttributes.set(n,e)},c.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);r(n)&&(n(),this.subscriptions.remove(t))}};var f=new Array(4);return c.prototype.update=function(e){var n,l,c=!0,h=0,m=this.primitive,_=this.primitives;if(this.createPrimitive){var g=this.geometry.values,v=g.length;if(v>0){for(r(m)&&(r(this.oldPrimitive)?_.remove(m):this.oldPrimitive=m),l=0;l<v;l++){var y=g[l],C=y.attributes;n=this.attributes.get(y.id.id),r(n)&&(r(C.show)&&(C.show.value=n.show),r(C.color)&&(C.color.value=n.color))}m=new s({asynchronous:!0,geometryInstances:g}),_.add(m),c=!1}else{r(m)&&(_.remove(m),m=void 0);var w=this.oldPrimitive;r(w)&&(_.remove(w),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=m,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(r(m)&&m.ready){r(this.oldPrimitive)&&(_.remove(this.oldPrimitive),this.oldPrimitive=void 0);var b=this.updatersWithAttributes.values,E=b.length,S=this.waitingOnCreate;for(l=0;l<E;l++){var x=b[l],T=this.geometry.get(x.entity.id);if(n=this.attributes.get(T.id.id),r(n)||(n=m.getGeometryInstanceAttributes(T.id),this.attributes.set(T.id.id,n)),(!x.fillMaterialProperty.isConstant||S)&&(x.fillMaterialProperty.color.getValue(e,d),!t.equals(n._lastColor,d))){n._lastColor=t.clone(d,n._lastColor);var A=this.color,P=d.toBytes(f);A[0]===P[0]&&A[1]===P[1]&&A[2]===P[2]&&A[3]===P[3]||(this.itemsToRemove[h++]=x)}var D=x.entity.isShowing&&(x.hasConstantFill||x.isFilled(e));D!==(1===n.show[0])&&(n.show=a.toValue(D,n.show));var M=x.distanceDisplayConditionProperty;if(!u.isConstant(M)){var I=M.getValue(e,p);i.equals(I,n._lastDistanceDisplayCondition)||(n._lastDistanceDisplayCondition=i.clone(I,n._lastDistanceDisplayCondition),n.distanceDisplayCondition=o.toValue(I,n.distanceDisplayCondition))}}this.updateShows(m),this.waitingOnCreate=!1}else r(m)&&!m.ready&&(c=!1);return this.itemsToRemove.length=h,c},c.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,n=t.length,i=0;i<n;i++){var o=t[i],s=this.geometry.get(o.entity.id),l=this.attributes.get(s.id.id);r(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var u=o.entity.isShowing;u!==(1===l.show[0])&&(l.show=a.toValue(u,l.show))}this.showsUpdated.removeAll()},c.prototype.contains=function(e){return this.updaters.contains(e.id)},c.prototype.getBoundingSphere=function(e,t){var n=this.primitive;if(!n.ready)return l.PENDING;var i=n.getBoundingSphere(e);return r(i)?(i.clone(t),l.DONE):l.FAILED},c.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;r(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var n=this.oldPrimitive;r(n)&&(e.remove(n),this.oldPrimitive=void 0)},h.prototype.add=function(e,t){var n,r=t.createFillGeometryInstance(e),i=this._batches,o=new Uint32Array(r.attributes.color.value.buffer)[0];return i.contains(o)?n=i.get(o):(n=new c(this._primitives,r.attributes.color.value,o),i.set(o,n)),n.add(t,r),n},h.prototype.remove=function(e){for(var t=this._batches.values,n=t.length,r=0;r<n;++r)if(t[r].remove(e))return},h.prototype.update=function(e){var t,n,r=!0,i=this._batches,o=i.values,a=o.length;for(t=0;t<a;++t)r=o[t].update(e)&&r;for(t=0;t<a;++t)for(var s=o[t],l=s.itemsToRemove,u=l.length,c=0;c<u;c++){s.remove(n=l[c]);var h=this.add(e,n);s.isDirty=!0,h.isDirty=!0}var d=o.slice(),p=d.length;for(t=0;t<p;++t){var f=d[t];f.isDirty&&(r=d[t].update(e)&&r,f.isDirty=!1),0===f.geometry.length&&i.remove(f.key)}return r},h.prototype.getBoundingSphere=function(e,t){for(var n=this._batches.values,r=n.length,i=0;i<r;++i){var o=n[i];if(o.contains(e))return o.getBoundingSphere(e,t)}return l.FAILED},h.prototype.removeAllPrimitives=function(){for(var e=this._batches.values,t=e.length,n=0;n<t;++n)e[n].removeAllPrimitives()},h}),o("DataSources/StaticOutlineGeometryBatch",["../Core/AssociativeArray","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defined","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/ShowGeometryInstanceAttribute","../Scene/PerInstanceColorAppearance","../Scene/Primitive","./BoundingSphereState","./Property"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(t,n,r,i){this.translucent=n,this.width=r,this.shadows=i,this.primitives=t,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new e,this.updaters=new e,this.updatersWithAttributes=new e,this.attributes=new e,this.itemsToRemove=[],this.subscriptions=new e,this.showsUpdated=new e}function d(t,n,r){this._primitives=t,this._scene=n,this._shadows=r,this._solidBatches=new e,this._translucentBatches=new e}h.prototype.add=function(e,t){var n=e.entity.id;if(this.createPrimitive=!0,this.geometry.set(n,t),this.updaters.set(n,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&c.isConstant(e.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,e.entity.definitionChanged.addEventListener(function(t,n,i,o){"isShowing"===n&&r.showsUpdated.set(t.id,e)}))}else this.updatersWithAttributes.set(n,e)},h.prototype.remove=function(e){var t=e.entity.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);r(n)&&(n(),this.subscriptions.remove(t))}};var p=new t,f=new i;return h.prototype.update=function(e){var u,h,d=!0,m=0,_=this.primitive,g=this.primitives;if(this.createPrimitive){var v=this.geometry.values,y=v.length;if(y>0){for(r(_)&&(r(this.oldPrimitive)?g.remove(_):this.oldPrimitive=_),h=0;h<y;h++){var C=v[h],w=C.attributes;u=this.attributes.get(C.id.id),r(u)&&(r(w.show)&&(w.show.value=u.show),r(w.color)&&(w.color.value=u.color))}_=new l({asynchronous:!0,geometryInstances:v,appearance:new s({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),g.add(_),d=!1}else{r(_)&&(g.remove(_),_=void 0);var b=this.oldPrimitive;r(b)&&(g.remove(b),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=_,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(r(_)&&_.ready){r(this.oldPrimitive)&&(g.remove(this.oldPrimitive),this.oldPrimitive=void 0);var E=this.updatersWithAttributes.values,S=E.length,x=this.waitingOnCreate;for(h=0;h<S;h++){var T=E[h],A=this.geometry.get(T.entity.id);u=this.attributes.get(A.id.id),r(u)||(u=_.getGeometryInstanceAttributes(A.id),this.attributes.set(A.id.id,u)),(!T.outlineColorProperty.isConstant||x)&&(T.outlineColorProperty.getValue(e,p),t.equals(u._lastColor,p)||(u._lastColor=t.clone(p,u._lastColor),u.color=n.toValue(p,u.color),(this.translucent&&255===u.color[3]||!this.translucent&&255!==u.color[3])&&(this.itemsToRemove[m++]=T)));var P=T.entity.isShowing&&(T.hasConstantOutline||T.isOutlineVisible(e));P!==(1===u.show[0])&&(u.show=a.toValue(P,u.show));var D=T.distanceDisplayConditionProperty;if(!c.isConstant(D)){var M=D.getValue(e,f);i.equals(M,u._lastDistanceDisplayCondition)||(u._lastDistanceDisplayCondition=i.clone(M,u._lastDistanceDisplayCondition),u.distanceDisplayCondition=o.toValue(M,u.distanceDisplayCondition))}}this.updateShows(_),this.waitingOnCreate=!1}else r(_)&&!_.ready&&(d=!1);return this.itemsToRemove.length=m,d},h.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,n=t.length,i=0;i<n;i++){var o=t[i],s=this.geometry.get(o.entity.id),l=this.attributes.get(s.id.id);r(l)||(l=e.getGeometryInstanceAttributes(s.id),this.attributes.set(s.id.id,l));var u=o.entity.isShowing;u!==(1===l.show[0])&&(l.show=a.toValue(u,l.show))}this.showsUpdated.removeAll()},h.prototype.contains=function(e){return this.updaters.contains(e.id)},h.prototype.getBoundingSphere=function(e,t){var n=this.primitive;if(!n.ready)return u.PENDING;var i=n.getGeometryInstanceAttributes(e);return!r(i)||!r(i.boundingSphere)||r(i.show)&&0===i.show[0]?u.FAILED:(i.boundingSphere.clone(t),u.DONE)},h.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;r(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var n=this.oldPrimitive;r(n)&&(e.remove(n),this.oldPrimitive=void 0)},d.prototype.add=function(e,t){var n,i,o=t.createOutlineGeometryInstance(e),a=this._scene.clampLineWidth(t.outlineWidth);255===o.attributes.color.value[3]?(i=(n=this._solidBatches).get(a),r(i)||(i=new h(this._primitives,!1,a,this._shadows),n.set(a,i)),i.add(t,o)):(i=(n=this._translucentBatches).get(a),r(i)||(i=new h(this._primitives,!0,a,this._shadows),n.set(a,i)),i.add(t,o))},d.prototype.remove=function(e){var t,n=this._solidBatches.values,r=n.length;for(t=0;t<r;t++)if(n[t].remove(e))return;var i=this._translucentBatches.values,o=i.length;for(t=0;t<o;t++)if(i[t].remove(e))return},d.prototype.update=function(e){var t,n,r,i,o,a=this._solidBatches.values,s=a.length,l=this._translucentBatches.values,u=l.length,c=!0,h=!1;do{for(h=!1,n=0;n<s;n++){c=(i=a[n]).update(e);var d=(o=i.itemsToRemove).length;if(d>0)for(h=!0,t=0;t<d;t++)r=o[t],i.remove(r),this.add(e,r)}for(n=0;n<u;n++){c=(i=l[n]).update(e);var p=(o=i.itemsToRemove).length;if(p>0)for(h=!0,t=0;t<p;t++)r=o[t],i.remove(r),this.add(e,r)}}while(h);return c},d.prototype.getBoundingSphere=function(e,t){var n,r=this._solidBatches.values,i=r.length;for(n=0;n<i;n++){var o=r[n];if(o.contains(e))return o.getBoundingSphere(e,t)}var a=this._translucentBatches.values,s=a.length;for(n=0;n<s;n++){var l=a[n];if(l.contains(e))return l.getBoundingSphere(e,t)}return u.FAILED},d.prototype.removeAllPrimitives=function(){var e,t=this._solidBatches.values,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();var r=this._translucentBatches.values,i=r.length;for(e=0;e<i;e++)r[e].removeAllPrimitives()},d}),o("DataSources/GeometryVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./StaticGeometryColorBatch","./StaticGeometryPerMaterialBatch","./StaticGroundGeometryColorBatch","./StaticOutlineGeometryBatch"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(t,n){this._primitives=t,this._groundPrimitives=n,this._dynamicUpdaters=new e}function p(e,t){for(var n=e._batches,r=n.length,i=0;i<r;i++)n[i].remove(t)}function f(e,t,n){var r;n.isDynamic?e._dynamicBatch.add(t,n):((n.outlineEnabled||n.fillEnabled)&&(r=n.shadowsProperty.getValue(t)),n.outlineEnabled&&e._outlineBatches[r].add(t,n),n.fillEnabled&&(n.onTerrain?e._groundColorBatch.add(t,n):n.isClosed?n.fillMaterialProperty instanceof s?e._closedColorBatches[r].add(t,n):e._closedMaterialBatches[r].add(t,n):n.fillMaterialProperty instanceof s?e._openColorBatches[r].add(t,n):e._openMaterialBatches[r].add(t,n)))}function m(t,n,r){this._type=t;var i=n.primitives,a=n.groundPrimitives;this._scene=n,this._primitives=i,this._groundPrimitives=a,this._entityCollection=void 0,this._addedObjects=new e,this._removedObjects=new e,this._changedObjects=new e;var s=o.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(s),this._closedColorBatches=new Array(s),this._closedMaterialBatches=new Array(s),this._openColorBatches=new Array(s),this._openMaterialBatches=new Array(s);for(var p=0;p<s;++p)this._outlineBatches[p]=new h(i,n,p),this._closedColorBatches[p]=new l(i,t.perInstanceColorAppearanceType,!0,p),this._closedMaterialBatches[p]=new u(i,t.materialAppearanceType,!0,p),this._openColorBatches[p]=new l(i,t.perInstanceColorAppearanceType,!1,p),this._openMaterialBatches[p]=new u(i,t.materialAppearanceType,!1,p);this._groundColorBatch=new c(a),this._dynamicBatch=new d(i,a),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatch,this._dynamicBatch),this._subscriptions=new e,this._updaters=new e,this._entityCollection=r,r.collectionChanged.addEventListener(m.prototype._onCollectionChanged,this),this._onCollectionChanged(r,r.values,_)}var _=[];d.prototype.add=function(e,t){this._dynamicUpdaters.set(t.entity.id,t.createDynamicUpdater(this._primitives,this._groundPrimitives))},d.prototype.remove=function(e){var t=e.entity.id,r=this._dynamicUpdaters.get(t);n(r)&&(this._dynamicUpdaters.remove(t),r.destroy())},d.prototype.update=function(e){for(var t=this._dynamicUpdaters.values,n=0,r=t.length;n<r;n++)t[n].update(e);return!0},d.prototype.removeAllPrimitives=function(){for(var e=this._dynamicUpdaters.values,t=0,n=e.length;t<n;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},d.prototype.getBoundingSphere=function(e,t){var r=this._dynamicUpdaters.get(e.id);return n(r)&&n(r.getBoundingSphere)?r.getBoundingSphere(e,t):a.FAILED},m.prototype.update=function(e){var t,n,r,i,o=this._addedObjects,a=o.values,s=this._removedObjects,l=s.values,u=this._changedObjects,c=u.values;for(t=c.length-1;t>-1;t--)n=c[t],r=n.id,i=this._updaters.get(r),i.entity===n?(p(this,i),f(this,e,i)):(l.push(n),a.push(n));for(t=l.length-1;t>-1;t--)n=l[t],r=n.id,i=this._updaters.get(r),p(this,i),i.destroy(),this._updaters.remove(r),this._subscriptions.get(r)(),this._subscriptions.remove(r);for(t=a.length-1;t>-1;t--)n=a[t],r=n.id,i=new this._type(n,this._scene),this._updaters.set(r,i),f(this,e,i),this._subscriptions.set(r,i.geometryChanged.addEventListener(m._onGeometryChanged,this));o.removeAll(),s.removeAll(),u.removeAll();var h=!0,d=this._batches,_=d.length;for(t=0;t<_;t++)h=d[t].update(e)&&h;return h};var g=[],v=new t;return m.prototype.getBoundingSphere=function(e,n){for(var r=g,i=v,o=0,s=a.DONE,l=this._batches,u=l.length,c=0;c<u;c++){if((s=l[c].getBoundingSphere(e,i))===a.PENDING)return a.PENDING;s===a.DONE&&(r[o]=t.clone(i,r[o]),o++)}return 0===o?a.FAILED:(r.length=o,t.fromBoundingSpheres(r,n),a.DONE)},m.prototype.isDestroyed=function(){return!1},m.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(m.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var e,t=this._batches,n=t.length;for(e=0;e<n;e++)t[e].removeAllPrimitives();var i=this._subscriptions.values;for(n=i.length,e=0;e<n;e++)i[e]();return this._subscriptions.removeAll(),r(this)},m._onGeometryChanged=function(e){var t=this._changedObjects,r=e.entity,i=r.id;n(this._removedObjects.get(i))||n(t.get(i))||t.set(i,r)},m.prototype._onCollectionChanged=function(e,t,n){var r,i,o,a=this._addedObjects,s=this._removedObjects,l=this._changedObjects;for(r=n.length-1;r>-1;r--)o=n[r],i=o.id,a.remove(i)||(s.set(i,o),l.remove(i));for(r=t.length-1;r>-1;r--)o=t[r],i=o.id,s.remove(i)?l.set(i,o):a.set(i,o)},m}),o("DataSources/LabelVisualizer",["../Core/AssociativeArray","../Core/Cartesian2","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/VerticalOrigin","./BoundingSphereState","./EntityCluster","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";function g(e){this.entity=e,this.label=void 0,this.index=void 0}function v(t,n){n.collectionChanged.addEventListener(v.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new e,this._onCollectionChanged(n,n.values,[],[])}function y(e,t,n){o(e)&&(e.label=void 0,n.removeLabel(t))}var C=d.FILL,w=r.WHITE,b=r.BLACK,E=t.ZERO,S=n.ZERO,x=c.NONE,T=h.CENTER,A=p.CENTER,P=new n,D=new r,M=new r,I=new n,O=new t,R=new u,N=new u,L=new l;return v.prototype.update=function(e){for(var t=this._items.values,n=this._cluster,r=0,i=t.length;r<i;r++){var a,s=t[r],l=s.entity,u=l._label,c=s.label,h=l.isShowing&&l.isAvailable(e)&&_.getValueOrDefault(u._show,e,!0);h&&(P=_.getValueOrUndefined(l._position,e,P),a=_.getValueOrUndefined(u._text,e),h=o(P)&&o(a)),h?(_.isConstant(l._position)||(n._clusterDirty=!0),o(c)||((c=n.getLabel(l)).id=l,s.label=c),c.show=!0,c.position=P,c.text=a,c.scale=_.getValueOrDefault(u._scale,e,1),c.font=_.getValueOrDefault(u._font,e,"30px sans-serif"),c.style=_.getValueOrDefault(u._style,e,C),c.fillColor=_.getValueOrDefault(u._fillColor,e,w,D),c.outlineColor=_.getValueOrDefault(u._outlineColor,e,b,M),c.outlineWidth=_.getValueOrDefault(u._outlineWidth,e,1),c.pixelOffset=_.getValueOrDefault(u._pixelOffset,e,E,O),c.eyeOffset=_.getValueOrDefault(u._eyeOffset,e,S,I),c.heightReference=_.getValueOrDefault(u._heightReference,e,x),c.horizontalOrigin=_.getValueOrDefault(u._horizontalOrigin,e,T),c.verticalOrigin=_.getValueOrDefault(u._verticalOrigin,e,A),c.translucencyByDistance=_.getValueOrUndefined(u._translucencyByDistance,e,R),c.pixelOffsetScaleByDistance=_.getValueOrUndefined(u._pixelOffsetScaleByDistance,e,N),c.distanceDisplayCondition=_.getValueOrUndefined(u._distanceDisplayCondition,e,L)):y(s,l,n)}return!0},v.prototype.getBoundingSphere=function(e,t){var r=this._items.get(e.id);if(!o(r)||!o(r.label))return f.FAILED;var a=r.label;return t.center=n.clone(i(a._clampedPosition,a.position),t.center),t.radius=0,f.DONE},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(v.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return a(this)},v.prototype._onCollectionChanged=function(e,t,n,r){var i,a,s=this._items,l=this._cluster;for(i=t.length-1;i>-1;i--)a=t[i],o(a._label)&&o(a._position)&&s.set(a.id,new g(a));for(i=r.length-1;i>-1;i--)a=r[i],o(a._label)&&o(a._position)?s.contains(a.id)||s.set(a.id,new g(a)):(y(s.get(a.id),a,l),s.remove(a.id));for(i=n.length-1;i>-1;i--)a=n[i],y(s.get(a.id),a,l),s.remove(a.id)},v}),o("ThirdParty/gltfDefaults",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/Quaternion","../Renderer/WebGLConstants"],function(e,t,n,r,i){"use strict";return function(o){if(n(o))return n(o.allExtensions)&&(o.extensionsUsed=o.allExtensions,o.allExtensions=void 0),o.extensionsUsed=t(o.extensionsUsed,[]),function(e){n(e.accessors)||(e.accessors={});var r=e.accessors;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.byteStride=t(o.byteStride,0)}}(o),function(e){n(e.animations)||(e.animations={});var r=e.animations;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];n(o.channels)||(o.channels=[]),n(o.parameters)||(o.parameters={}),n(o.samplers)||(o.samplers={});var a=r.samplers;for(var s in a)if(a.hasOwnProperty(s)){var l=a[s];l.interpolation=t(l.interpolation,"LINEAR")}}}(o),function(e){n(e.asset)||(e.asset={});var r=e.asset;n(r.profile)&&"string"!=typeof r.profile||(r.profile={});var i=r.profile;r.premultipliedAlpha=t(r.premultipliedAlpha,!1),i.api=t(i.api,"WebGL"),i.version=t(i.version,"1.0.2"),n(e.version)&&(r.version=t(r.version,e.version),delete e.version),"number"==typeof r.version&&(r.version=r.version.toFixed(1).toString())}(o),function(e){n(e.buffers)||(e.buffers={});var r=e.buffers;for(var i in r)if(r.hasOwnProperty(i)){var o=r[i];o.type=t(o.type,"arraybuffer")}}(o),u=o,n(u.bufferViews)||(u.bufferViews={}),l=o,n(l.cameras)||(l.cameras={}),s=o,n(s.images)||(s.images={}),function(e){n(e.extensions)||(e.extensions={});var r=e.extensions;n(r.KHR_materials_common)||(r.KHR_materials_common={});var i=r.KHR_materials_common;n(e.lights)?(i.lights=e.lights,delete e.lights):n(i.lights)||(i.lights={});var o=i.lights;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if("ambient"===s.type){n(s.ambient)||(s.ambient={});var l=s.ambient;n(l.color)||(l.color=[1,1,1])}else if("directional"===s.type){n(s.directional)||(s.directional={});var u=s.directional;n(u.color)||(u.color=[1,1,1])}else if("point"===s.type){n(s.point)||(s.point={});var c=s.point;n(c.color)||(c.color=[1,1,1]),c.constantAttenuation=t(c.constantAttenuation,1),c.linearAttenuation=t(c.linearAttenuation,0),c.quadraticAttenuation=t(c.quadraticAttenuation,0)}else if("spot"===s.type){n(s.spot)||(s.spot={});var h=s.spot;n(h.color)||(h.color=[1,1,1]),h.constantAttenuation=t(h.constantAttenuation,1),h.fallOffAngle=t(h.fallOffAngle,3.14159265),h.fallOffExponent=t(h.fallOffExponent,0),h.linearAttenuation=t(h.linearAttenuation,0),h.quadraticAttenuation=t(h.quadraticAttenuation,0)}}}(o),function(e){n(e.materials)||(e.materials={});var t=e.materials;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r],a=o.instanceTechnique;if(n(a)&&(o.technique=a.technique,o.values=a.values,delete o.instanceTechnique),!n(o.extensions))if(n(o.technique))n(o.values)||(o.values={});else{delete o.values,o.extensions={KHR_materials_common:{technique:"CONSTANT",transparent:!1,values:{emission:{type:i.FLOAT_VEC4,value:[.5,.5,.5,1]}}}},n(e.extensionsUsed)||(e.extensionsUsed=[]);var s=e.extensionsUsed;-1===s.indexOf("KHR_materials_common")&&s.push("KHR_materials_common")}}}(o),function(e){n(e.meshes)||(e.meshes={});var r=e.meshes;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];n(a.primitives)||(a.primitives=[]);for(var s=a.primitives.length,l=s.length,u=0;u<l;++u){var c=s[u];n(c.attributes)||(c.attributes={});var h=t(c.primitive,i.TRIANGLES);c.mode=t(c.mode,h)}}}(o),function(t){n(t.nodes)||(t.nodes={});var i=t.nodes,o=parseFloat(t.asset.version)<1,a=new e,s=new r;for(var l in i)if(i.hasOwnProperty(l)){var u=i[l];if(n(u.children)||(u.children=[]),o&&n(u.rotation)){var c=u.rotation;e.fromArray(c,0,a),r.fromAxisAngle(a,c[3],s),u.rotation=[s.x,s.y,s.z,s.w]}n(u.matrix)||(n(u.translation)||n(u.rotation)||n(u.scale)?(n(u.translation)||(u.translation=[0,0,0]),n(u.rotation)||(u.rotation=[0,0,0,1]),n(u.scale)||(u.scale=[1,1,1])):u.matrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var h=u.instanceSkin;n(h)&&(u.skeletons=h.skeletons,u.skin=h.skin,u.meshes=h.meshes,delete u.instanceSkin)}}(o),function(e){n(e.programs)||(e.programs={});var t=e.programs;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n(i.attributes)||(i.attributes=[])}}(o),function(e){n(e.samplers)||(e.samplers={});var r=e.samplers;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];a.magFilter=t(a.magFilter,i.LINEAR),a.minFilter=t(a.minFilter,i.NEAREST_MIPMAP_LINEAR),a.wrapS=t(a.wrapS,i.REPEAT),a.wrapT=t(a.wrapT,i.REPEAT)}}(o),function(e){n(e.scenes)||(e.scenes={});var t=e.scenes;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n(i.node)||(i.node=[])}}(o),a=o,n(a.shaders)||(a.shaders={}),function(e){n(e.skins)||(e.skins={});var t=e.skins;for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n(i.bindShapeMatrix)&&(i.bindShapeMatrix=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}}(o),function(e){n(e.techniques)||(e.techniques={});var r,i=e.techniques;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];n(a.parameters)||(a.parameters={});var s=a.parameters;for(var l in s){var u=s[l];u.node=t(u.node,u.source),u.source=void 0}var c=a.passes;if(n(c)){var h=t(a.pass,"defaultPass");if(c.hasOwnProperty(h)){var d=c[h],p=d.instanceProgram;a.attributes=t(a.attributes,p.attributes),a.program=t(a.program,p.program),a.uniforms=t(a.uniforms,p.uniforms),a.states=t(a.states,d.states)}a.passes=void 0,a.pass=void 0}n(a.attributes)||(a.attributes={}),n(a.uniforms)||(a.uniforms={}),n(a.states)||(a.states={}),n((r=a.states).enable)||(r.enable=[]),n(r.disable)||(r.disable=[])}}(o),function(e){n(e.textures)||(e.textures={});var r=e.textures;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];a.format=t(a.format,i.RGBA),a.internalFormat=t(a.internalFormat,a.format),a.target=t(a.target,i.TEXTURE_2D),a.type=t(a.type,i.UNSIGNED_BYTE)}}(o),o;var a,s,l,u}}),o("Scene/getBinaryAccessor",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/ComponentDatatype","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4"],function(e,t,n,r,i,o,a){"use strict";var s={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},l={SCALAR:void 0,VEC2:e,VEC3:t,VEC4:n,MAT2:i,MAT3:o,MAT4:a};return function(e){var t,n=e.componentType;t="string"==typeof n?r.fromName(n):n;var i=s[e.type];return{componentsPerAttribute:i,classType:l[e.type],createArrayBufferView:function(e,n,o){return r.createArrayBufferView(t,e,n,i*o)}}}}),o("Scene/ModelAnimationCache",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/LinearSpline","../Core/Matrix4","../Core/Quaternion","../Core/QuaternionSpline","../Renderer/WebGLConstants","./getBinaryAccessor"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(){}function c(e,n){var r=e.gltf,i=r.bufferViews[n.bufferView],o=r.buffers[i.buffer],a=i.byteOffset+n.byteOffset,s=n.count*l(n).componentsPerAttribute;return e.cacheKey+"//"+t(o.path,"")+"/"+a+"/"+s}function h(e){this._value=e}var d={},p=new e;u.getAnimationParameterValues=function(t,r){var i=c(t,r),a=d[i];if(!n(a)){var u,h=t._loadResources,f=t.gltf,m=parseFloat(f.asset.version)<1,_=r.componentType,g=r.type,v=r.count,y=h.getBuffer(f.bufferViews[r.bufferView]),C=l(r).createArrayBufferView(y.buffer,y.byteOffset+r.byteOffset,v);if(_===s.FLOAT&&"SCALAR"===g)a=C;else if(_===s.FLOAT&&"VEC3"===g)for(a=new Array(v),u=0;u<v;++u)a[u]=e.fromArray(C,3*u);else if(_===s.FLOAT&&"VEC4"===g)for(a=new Array(v),u=0;u<v;++u){var w=4*u;a[u]=m?o.fromAxisAngle(e.fromArray(C,w,p),C[w+3]):o.unpack(C,w)}n(t.cacheKey)&&(d[i]=a)}return a};var f={};h.prototype.evaluate=function(e,t){return this._value},u.getAnimationSpline=function(e,t,i,o,l,u){var c=e.cacheKey+"//"+t+"/"+o,d=f[c];if(!n(d)){var p=u[l.input],m=e.gltf.accessors[i.parameters[l.output]],_=u[l.output];if(1===p.length&&1===_.length)d=new h(_[0]);else{var g=m.componentType,v=m.type;"LINEAR"===l.interpolation&&(g===s.FLOAT&&"VEC3"===v?d=new r({times:p,points:_}):g===s.FLOAT&&"VEC4"===v&&(d=new a({times:p,points:_})))}n(e.cacheKey)&&(f[c]=d)}return d};var m={};return u.getSkinInverseBindMatrices=function(e,t){var r=c(e,t),o=m[r];if(!n(o)){var a=t.componentType,u=t.type,h=t.count,d=e._loadResources.getBuffer(e.gltf.bufferViews[t.bufferView]),p=l(t).createArrayBufferView(d.buffer,d.byteOffset+t.byteOffset,h);if(o=new Array(h),a===s.FLOAT&&"MAT4"===u)for(var f=0;f<h;++f)o[f]=i.fromArray(p,16*f);m[r]=o}return o},u}),o("Scene/ModelAnimationLoop",["../Core/freezeObject"],function(e){"use strict";return e({NONE:0,REPEAT:1,MIRRORED_REPEAT:2})}),o("Scene/ModelAnimationState",["../Core/freezeObject"],function(e){"use strict";return e({STOPPED:0,ANIMATING:1})}),o("Scene/ModelAnimation",["../Core/defaultValue","../Core/defineProperties","../Core/Event","../Core/JulianDate","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,n,r,i,o){"use strict";function a(t,a,s){this._name=t.name,this._startTime=r.clone(t.startTime),this._delay=e(t.delay,0),this._stopTime=t.stopTime,this.removeOnStop=e(t.removeOnStop,!1),this._speedup=e(t.speedup,1),this._reverse=e(t.reverse,!1),this._loop=e(t.loop,i.NONE),this.start=new n,this.update=new n,this.stop=new n,this._state=o.STOPPED,this._runtimeAnimation=s,this._computedStartTime=void 0,this._duration=void 0;var l=this;this._raiseStartEvent=function(){l.start.raiseEvent(a,l)},this._updateEventTime=0,this._raiseUpdateEvent=function(){l.update.raiseEvent(a,l,l._updateEventTime)},this._raiseStopEvent=function(){l.stop.raiseEvent(a,l)}}return t(a.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},speedup:{get:function(){return this._speedup}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}}}),a}),o("Scene/ModelAnimationCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/JulianDate","../Core/Math","./ModelAnimation","./ModelAnimationLoop","./ModelAnimationState"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e){this.animationAdded=new o,this.animationRemoved=new o,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}function d(e,t){for(var n=e.channelEvaluators,r=n.length,i=0;i<r;++i)n[i](t)}function p(e,t,n){return function(){e.animationRemoved.raiseEvent(t,n)}}r(h.prototype,{length:{get:function(){return this._scheduledAnimations.length}}}),h.prototype.add=function(e){e=t(e,t.EMPTY_OBJECT);var n=this._model,r=new l(e,n,n._runtime.animations[e.name]);return this._scheduledAnimations.push(r),this.animationAdded.raiseEvent(n,r),r},h.prototype.addAll=function(n){n=t(n,t.EMPTY_OBJECT),n=e(n);for(var r=[],i=this._model._animationIds,o=i.length,a=0;a<o;++a)n.name=i[a],r.push(this.add(n));return r},h.prototype.remove=function(e){if(n(e)){var t=this._scheduledAnimations,r=t.indexOf(e);if(-1!==r)return t.splice(r,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1},h.prototype.removeAll=function(){var e=this._model,t=this._scheduledAnimations,n=t.length;this._scheduledAnimations=[];for(var r=0;r<n;++r)this.animationRemoved.raiseEvent(e,t[r])},h.prototype.contains=function(e){return!!n(e)&&-1!==this._scheduledAnimations.indexOf(e)},h.prototype.get=function(e){return this._scheduledAnimations[e]};var f=[];return h.prototype.update=function(e){var r=this._scheduledAnimations,i=r.length;if(0===i)return this._previousTime=void 0,!1;if(a.equals(e.time,this._previousTime))return!1;this._previousTime=a.clone(e.time,this._previousTime);for(var o=!1,l=e.time,h=this._model,m=0;m<i;++m){var _=r[m],g=_._runtimeAnimation;n(_._computedStartTime)||(_._computedStartTime=a.addSeconds(t(_.startTime,l),_.delay,new a)),n(_._duration)||(_._duration=g.stopTime*(1/_.speedup));var v=_._duration,y=_.stopTime,C=0!==v?a.secondsDifference(l,_._computedStartTime)/v:0,w=C>=0,b=_.loop===u.REPEAT||_.loop===u.MIRRORED_REPEAT;if((w||b&&!n(_.startTime))&&(C<=1||b)&&(!n(y)||a.lessThanOrEquals(l,y))){if(_._state===c.STOPPED&&(_._state=c.ANIMATING,_.start.numberOfListeners>0&&e.afterRender.push(_._raiseStartEvent)),_.loop===u.REPEAT)C-=Math.floor(C);else if(_.loop===u.MIRRORED_REPEAT){var E=Math.floor(C),S=C-E;C=E%2==1?1-S:S}_.reverse&&(C=1-C);var x=C*v*_.speedup;d(g,x=s.clamp(x,g.startTime,g.stopTime)),_.update.numberOfListeners>0&&(_._updateEventTime=x,e.afterRender.push(_._raiseUpdateEvent)),o=!0}else w&&_._state===c.ANIMATING&&(_._state=c.STOPPED,_.stop.numberOfListeners>0&&e.afterRender.push(_._raiseStopEvent),_.removeOnStop&&f.push(_))}i=f.length;for(var T=0;T<i;++T){var A=f[T];r.splice(r.indexOf(A),1),e.afterRender.push(p(this,h,A))}return f.length=0,o},h}),o("Scene/ModelMaterial",["../Core/defined","../Core/defineProperties","../Core/DeveloperError"],function(e,t,n){"use strict";function r(e,t,n){this._name=t.name,this._id=n,this._uniformMap=e._uniformMaps[n]}return t(r.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}}}),r.prototype.setValue=function(e,t){var n=this._uniformMap.values[e];n.value=n.clone(t,n.value)},r.prototype.getValue=function(t){var n=this._uniformMap.values[t];if(e(n))return n.value},r}),o("Scene/modelMaterialsCommon",["../Core/defaultValue","../Core/defined","../Renderer/WebGLConstants"],function(e,t,n){"use strict";function r(e){switch(e){case n.FLOAT:return"float";case n.FLOAT_VEC2:return"vec2";case n.FLOAT_VEC3:return"vec3";case n.FLOAT_VEC4:return"vec4";case n.FLOAT_MAT2:return"mat2";case n.FLOAT_MAT3:return"mat3";case n.FLOAT_MAT4:return"mat4";case n.SAMPLER_2D:return"sampler2D"}}function i(n,r,i){var o,a=e(i,0);do{o=r+(a++).toString()}while(t(n[o]));return o}function o(o,s,d){var p,f=o.techniques,m=o.shaders,_=o.programs,g=s.technique.toUpperCase();t(o.extensions)&&t(o.extensions.KHR_materials_common)&&(p=o.extensions.KHR_materials_common.lights);var v=e(s.jointCount,0),y=v>0,C=s.values,w="precision highp float;\n",b="precision highp float;\n",E=i(f,"technique",l),S=i(m,"vertexShader",u),x=i(m,"fragmentShader",c),T=i(_,"program",h),A="CONSTANT"!==g,P={modelViewMatrix:{semantic:"MODELVIEW",type:n.FLOAT_MAT4},projectionMatrix:{semantic:"PROJECTION",type:n.FLOAT_MAT4}};A&&(P.normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:n.FLOAT_MAT3}),y&&(P.jointMatrix={count:v,semantic:"JOINTMATRIX",type:n.FLOAT_MAT4});var D,M=!1;for(var I in C)if(C.hasOwnProperty(I)&&"transparent"!==I&&"doubleSided"!==I){var O=a(I,C[I]);D=I.toLowerCase(),M||O!==n.SAMPLER_2D||(M=!0),P[D]={type:O}}if(t(d))for(var R in d)d.hasOwnProperty(R)&&(P[R]=d[R]);var N={};for(var L in P)if(P.hasOwnProperty(L)){var F=P[L];N["u_"+L]=L;var B=t(F.count)?"["+F.count+"]":"";F.type!==n.FLOAT_MAT3&&F.type!==n.FLOAT_MAT4||F.useInFragment?(b+="uniform "+r(F.type)+" u_"+L+B+";\n",delete F.useInFragment):w+="uniform "+r(F.type)+" u_"+L+B+";\n"}var k="";y&&(k+="  mat4 skinMat = a_weight.x * u_jointMatrix[int(a_joint.x)];\n",k+="  skinMat += a_weight.y * u_jointMatrix[int(a_joint.y)];\n",k+="  skinMat += a_weight.z * u_jointMatrix[int(a_joint.z)];\n",k+="  skinMat += a_weight.w * u_jointMatrix[int(a_joint.w)];\n");var V,z={a_position:"position"};P.position={semantic:"POSITION",type:n.FLOAT_VEC3},w+="attribute vec3 a_position;\n",w+="varying vec3 v_positionEC;\n",k+=y?"  vec4 pos = u_modelViewMatrix * skinMat * vec4(a_position,1.0);\n":"  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);\n",k+="  v_positionEC = pos.xyz;\n",k+="  gl_Position = u_projectionMatrix * pos;\n",b+="varying vec3 v_positionEC;\n",A&&(z.a_normal="normal",P.normal={semantic:"NORMAL",type:n.FLOAT_VEC3},w+="attribute vec3 a_normal;\n",w+="varying vec3 v_normal;\n",k+=y?"  v_normal = u_normalMatrix * mat3(skinMat) * a_normal;\n":"  v_normal = u_normalMatrix * a_normal;\n",b+="varying vec3 v_normal;\n"),M&&(z.a_texcoord_0="texcoord_0",P.texcoord_0={semantic:"TEXCOORD_0",type:n.FLOAT_VEC2},w+="attribute vec2 a_texcoord_0;\n",w+="varying vec2 "+(V="v_texcoord_0")+";\n",k+="  "+V+" = a_texcoord_0;\n",b+="varying vec2 "+V+";\n"),y&&(z.a_joint="joint",P.joint={semantic:"JOINT",type:n.FLOAT_VEC4},z.a_weight="weight",P.weight={semantic:"WEIGHT",type:n.FLOAT_VEC4},w+="attribute vec4 a_joint;\n",w+="attribute vec4 a_weight;\n");var U=A&&("BLINN"===g||"PHONG"===g)&&t(P.specular)&&t(P.shininess),G=!1,W=!1,H="";for(var j in p)if(p.hasOwnProperty(j)){var q=p[j],Y=q.type.toLowerCase(),X=q.baseName;H+="  {\n";var Z,K,Q="u_"+X+"Color";"ambient"===Y?(W=!0,H+="    ambientLight += "+Q+";\n"):A&&(G=!0,Z="v_"+X+"Direction",K="v_"+X+"Position","point"!==Y&&(w+="varying vec3 "+Z+";\n",b+="varying vec3 "+Z+";\n",k+="  "+Z+" = mat3(u_"+X+"Transform) * vec3(0.,0.,1.);\n","directional"===Y&&(H+="    vec3 l = normalize("+Z+");\n")),"directional"!==Y?(w+="varying vec3 "+K+";\n",b+="varying vec3 "+K+";\n",k+="  "+K+" = u_"+X+"Transform[3].xyz;\n",H+="    vec3 VP = "+K+" - v_positionEC;\n",H+="    vec3 l = normalize(VP);\n",H+="    float range = length(VP);\n",H+="    float attenuation = 1.0 / (u_"+X+"Attenuation.x + ",H+="(u_"+X+"Attenuation.y * range) + ",H+="(u_"+X+"Attenuation.z * range * range));\n"):H+="    float attenuation = 1.0;\n","spot"===Y&&(H+="    float spotDot = dot(l, normalize("+Z+"));\n",H+="    if (spotDot < cos(u_"+X+"FallOff.x * 0.5))\n",H+="    {\n",H+="      attenuation = 0.0;\n",H+="    }\n",H+="    else\n",H+="    {\n",H+="        attenuation *= max(0.0, pow(spotDot, u_"+X+"FallOff.y));\n",H+="    }\n"),H+="    diffuseLight += "+Q+"* max(dot(normal,l), 0.) * attenuation;\n",U&&("BLINN"===g?(H+="    vec3 h = normalize(l + viewDir);\n",H+="    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;\n"):(H+="    vec3 reflectDir = reflect(-l, normal);\n",H+="    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;\n"),H+="    specularLight += "+Q+" * specularIntensity;\n")),H+="  }\n"}W||(H+="  ambientLight += vec3(0.2, 0.2, 0.2);\n"),G||"CONSTANT"===g||(H+="  vec3 l = normalize(czm_sunDirectionEC);\n",H+="  diffuseLight += vec3(1.0, 1.0, 1.0) * max(dot(normal,l), 0.);\n",U&&("BLINN"===g?(H+="  vec3 h = normalize(l + viewDir);\n",H+="  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));\n"):(H+="  vec3 reflectDir = reflect(-l, normal);\n",H+="  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));\n"),H+="  specularLight += vec3(1.0, 1.0, 1.0) * specularIntensity;\n")),w+="void main(void) {\n",w+=k,w+="}\n",b+="void main(void) {\n";var J,$="  vec3 color = vec3(0.0, 0.0, 0.0);\n";A&&(b+="  vec3 normal = normalize(v_normal);\n",s.doubleSided&&(b+="  if (gl_FrontFacing == false)\n",b+="  {\n",b+="    normal = -normal;\n",b+="  }\n")),"CONSTANT"!==g?(t(P.diffuse)&&(b+=P.diffuse.type===n.SAMPLER_2D?"  vec4 diffuse = texture2D(u_diffuse, "+V+");\n":"  vec4 diffuse = u_diffuse;\n",b+="  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n",$+="  color += diffuse.rgb * diffuseLight;\n"),U&&(b+=P.specular.type===n.SAMPLER_2D?"  vec3 specular = texture2D(u_specular, "+V+").rgb;\n":"  vec3 specular = u_specular.rgb;\n",b+="  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n",$+="  color += specular * specularLight;\n"),J=t(P.transparency)?"  gl_FragColor = vec4(color * diffuse.a, diffuse.a * u_transparency);\n":"  gl_FragColor = vec4(color * diffuse.a, diffuse.a);\n"):J=t(P.transparency)?"  gl_FragColor = vec4(color, u_transparency);\n":"  gl_FragColor = vec4(color, 1.0);\n",t(P.emission)&&(b+=P.emission.type===n.SAMPLER_2D?"  vec3 emission = texture2D(u_emission, "+V+").rgb;\n":"  vec3 emission = u_emission.rgb;\n",$+="  color += emission;\n"),(t(P.ambient)||"CONSTANT"!==g)&&(b+=t(P.ambient)?P.ambient.type===n.SAMPLER_2D?"  vec3 ambient = texture2D(u_ambient, "+V+").rgb;\n":"  vec3 ambient = u_ambient.rgb;\n":"  vec3 ambient = diffuse.rgb;\n",$+="  color += ambient * ambientLight;\n"),b+="  vec3 viewDir = -normalize(v_positionEC);\n",b+="  vec3 ambientLight = vec3(0.0, 0.0, 0.0);\n",b+=H,b+=$,b+=J,b+="}\n",f[E]={attributes:z,parameters:P,program:T,states:s.transparent?{enable:[n.DEPTH_TEST,n.BLEND],depthMask:!1,functions:{blendEquationSeparate:[n.FUNC_ADD,n.FUNC_ADD],blendFuncSeparate:[n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA]}}:s.doubleSided?{enable:[n.DEPTH_TEST]}:{enable:[n.CULL_FACE,n.DEPTH_TEST]},uniforms:N},m[S]={type:n.VERTEX_SHADER,uri:"",extras:{source:w}},m[x]={type:n.FRAGMENT_SHADER,uri:"",extras:{source:b}};var ee=Object.keys(z);return _[T]={attributes:ee,fragmentShader:x,vertexShader:S},E}function a(e,r){var i;switch(i=t(r.value)?r.value:r,e){case"ambient":case"diffuse":case"emission":case"specular":return i instanceof String||"string"==typeof i?n.SAMPLER_2D:n.FLOAT_VEC4;case"shininess":case"transparency":return n.FLOAT;case"transparent":case"doubleSided":return n.BOOL}}function s(t){var n="";n+="technique:"+t.technique+";";for(var r=t.values,i=Object.keys(r).sort(),o=i.length,s=0;s<o;++s){var l=i[s];r.hasOwnProperty(l)&&"transparent"!==l&&"doubleSided"!==l&&(n+=l+":"+a(l,r[l]),n+=";")}return n+=e(t.doubleSided,!1).toString()+";",(n+=e(t.transparent,!1).toString()+";")+e(t.jointCount,0).toString()+";"}var l=0,u=0,c=0,h=0;return function(e){if(t(e)){var r=!1,i=e.extensionsUsed;if(t(i))for(var a=i.length,l=0;l<a;++l)if("KHR_materials_common"===i[l]){r=!0,i.splice(l,1);break}if(r){t(e.programs)||(e.programs={}),t(e.shaders)||(e.shaders={}),t(e.techniques)||(e.techniques={});var u=function(e){var r,i={};if(t(e.extensions)&&t(e.extensions.KHR_materials_common)&&(r=e.extensions.KHR_materials_common.lights),t(r)){var o=e.nodes;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];if(t(s.extensions)&&t(s.extensions.KHR_materials_common)){var l=s.extensions.KHR_materials_common.light;t(l)&&t(r[l])&&(r[l].node=a),delete s.extensions.KHR_materials_common}}var u=0;for(var c in r)if(r.hasOwnProperty(c)){var h=r[c],d=h.type;if("ambient"!==d&&!t(h.node)){delete r[c];continue}var p="light"+u.toString();switch(h.baseName=p,d){case"ambient":i[p+"Color"]={type:n.FLOAT_VEC3,value:h.ambient.color};break;case"directional":i[p+"Color"]={type:n.FLOAT_VEC3,value:h.directional.color},t(h.node)&&(i[p+"Transform"]={node:h.node,semantic:"MODELVIEW",type:n.FLOAT_MAT4});break;case"point":var f=h.point;i[p+"Color"]={type:n.FLOAT_VEC3,value:f.color},t(h.node)&&(i[p+"Transform"]={node:h.node,semantic:"MODELVIEW",type:n.FLOAT_MAT4}),i[p+"Attenuation"]={type:n.FLOAT_VEC3,value:[f.constantAttenuation,f.linearAttenuation,f.quadraticAttenuation]};break;case"spot":var m=h.spot;i[p+"Color"]={type:n.FLOAT_VEC3,value:m.color},t(h.node)&&(i[p+"Transform"]={node:h.node,semantic:"MODELVIEW",type:n.FLOAT_MAT4},i[p+"InverseTransform"]={node:h.node,semantic:"MODELVIEWINVERSE",type:n.FLOAT_MAT4,useInFragment:!0}),i[p+"Attenuation"]={type:n.FLOAT_VEC3,value:[m.constantAttenuation,m.linearAttenuation,m.quadraticAttenuation]},i[p+"FallOff"]={type:n.FLOAT_VEC2,value:[m.fallOffAngle,m.fallOffExponent]}}++u}}return i}(e),c={},h=e.materials;for(var d in h)if(h.hasOwnProperty(d)){var p=h[d];if(t(p.extensions)&&t(p.extensions.KHR_materials_common)){var f=p.extensions.KHR_materials_common,m=s(f),_=c[m];t(_)||(_=o(e,f,u),c[m]=_),p.values={};var g=f.values;for(var v in g)if(g.hasOwnProperty(v)){var y=g[v];p.values[v]=t(y.value)?y.value:y}p.technique=_,delete p.extensions.KHR_materials_common}}t(e.extensions)&&delete e.extensions.KHR_materials_common}return e}}}),o("Scene/ModelMesh",["../Core/defineProperties"],function(e){"use strict";function t(e,t,n){for(var r=[],i=e.primitives,o=i.length,a=0;a<o;++a)r[a]=t[i[a].material];this._name=e.name,this._materials=r,this._id=n}return e(t.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}}),t}),o("Scene/ModelNode",["../Core/defaultValue","../Core/defineProperties","../Core/Matrix4"],function(e,t,n){"use strict";function r(e,t,r,i,o){this._model=e,this._runtimeNode=r,this._name=t.name,this._id=i,this.useMatrix=!1,this._show=!0,this._matrix=n.clone(o)}return t(r.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,this._model._perNodeShowDirty=!0)}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=n.clone(e,this._matrix),this.useMatrix=!0;var t=this._model;t._cesiumAnimationsDirty=!0,this._runtimeNode.dirtyNumber=t._maxDirtyNumber}}}),r.prototype.setMatrix=function(e){n.clone(e,this._matrix)},r}),o("Scene/Model",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/combine","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/FeatureDetection","../Core/getAbsoluteUri","../Core/getBaseUri","../Core/getMagic","../Core/getStringFromTypedArray","../Core/IndexDatatype","../Core/loadArrayBuffer","../Core/loadImage","../Core/loadImageFromTypedArray","../Core/loadText","../Core/Math","../Core/Matrix2","../Core/Matrix3","../Core/Matrix4","../Core/PrimitiveType","../Core/Quaternion","../Core/Queue","../Core/RuntimeError","../Core/Transforms","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Renderer/WebGLConstants","../ThirdParty/gltfDefaults","../ThirdParty/Uri","../ThirdParty/when","./getBinaryAccessor","./HeightReference","./ModelAnimationCache","./ModelAnimationCollection","./ModelMaterial","./modelMaterialsCommon","./ModelMesh","./ModelNode","./Pass","./SceneMode","./ShadowMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie){"use strict";function oe(){this.buffersToCreate=new M,this.buffers={},this.pendingBufferLoads=0,this.programsToCreate=new M,this.shaders={},this.pendingShaderLoads=0,this.texturesToCreate=new M,this.pendingTextureLoads=0,this.texturesToCreateFromBufferView=new M,this.pendingBufferViewToImage=0,this.createSamplers=!0,this.createSkins=!0,this.createRuntimeAnimations=!0,this.createVertexArrays=!0,this.createRenderStates=!0,this.createUniformMaps=!0,this.createRuntimeNodes=!0,this.skinnedNodesIds=[]}function ae(e,t){e._cachedGltf=t,e._animationIds=function(e){var t=[];if(u(e)&&u(e.gltf)){var n=e.gltf.animations;for(var r in n)n.hasOwnProperty(r)&&t.push(r)}return t}(t)}function se(e){this._gltf=$(j(e.gltf)),this._bgltf=e.bgltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}function le(t){var n,r=(t=l(t,l.EMPTY_OBJECT)).cacheKey;if(this._cacheKey=r,this._cachedGltf=void 0,this._releaseGltfJson=l(t.releaseGltfJson,!1),this._animationIds=void 0,u(r)&&u(Je[r])&&Je[r].ready)n=Je[r],++n.count;else{var i=t.gltf;if(u(i)){if(i instanceof ArrayBuffer&&(i=new Uint8Array(i)),i instanceof Uint8Array){var o=ue(i);0!==o.binaryOffset&&(i=i.subarray(o.binaryOffset)),n=new se({gltf:o.glTF,bgltf:i,ready:!0})}else n=new se({gltf:t.gltf,ready:!0});n.count=1,u(r)&&(Je[r]=n)}}ae(this,n),this._basePath=l(t.basePath,"");var a=new q(document.location.href),s=new q(this._basePath);this._baseUri=s.resolve(a),this.show=l(t.show,!0),this.modelMatrix=A.clone(l(t.modelMatrix,A.IDENTITY)),this._modelMatrix=A.clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=l(t.scale,1),this._scale=this.scale,this.minimumPixelSize=l(t.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=t.maximumScale,this._maximumScale=this.maximumScale,this.id=t.id,this._id=t.id,this.heightReference=l(t.heightReference,Z.NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;var c=t.scene;this._scene=c,u(c)&&c.terrainProviderChanged.addEventListener(function(){this._heightChanged=!0},this),this.pickPrimitive=t.pickPrimitive,this._allowPicking=l(t.allowPicking,!0),this._ready=!1,this._readyPromise=Y.defer(),this.activeAnimations=new Q(this),this._defaultTexture=void 0,this._incrementallyLoadTextures=l(t.incrementallyLoadTextures,!0),this._asynchronous=l(t.asynchronous,!0),this.shadows=l(t.shadows,ie.ENABLED),this._shadows=this.shadows,this.debugShowBoundingVolume=l(t.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=l(t.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=t.distanceDisplayCondition,this._precreatedAttributes=t.precreatedAttributes,this._vertexShaderLoaded=t.vertexShaderLoaded,this._fragmentShaderLoaded=t.fragmentShaderLoaded,this._uniformMapLoaded=t.uniformMapLoaded,this._pickVertexShaderLoaded=t.pickVertexShaderLoaded,this._pickFragmentShaderLoaded=t.pickFragmentShaderLoaded,this._pickUniformMapLoaded=t.pickUniformMapLoaded,this._ignoreCommands=l(t.ignoreCommands,!1),this.cull=l(t.cull,!0),this._computedModelMatrix=new A,this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new e,this._state=Qe.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},pickPrograms:{},textures:{},samplers:{},renderStates:{}},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0}function ue(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=0;n+=$e,n+=$e;var r=t.getUint32(n+=$e,!0),i=(n+=$e+$e)+r,o=v(e,n,r);return{glTF:JSON.parse(o),binaryOffset:i}}function ce(e,t,n){return e._runtime[t][n]}function he(e,t){var n=e.accessors[t],r=n.extensions,i=n.min,o=n.max;if(u(r)){var a=r.WEB3D_quantized_attributes;u(a)&&(i=a.decodedMin,o=a.decodedMax)}return{min:i,max:o}}function de(e,t,n){return function(){e._state=Qe.FAILED,e._readyPromise.reject(new I("Failed to load "+t+": "+n))}}function pe(e,t){return function(n){var r=e._loadResources;r.buffers[t]=new Uint8Array(n),--r.pendingBufferLoads}}function fe(e,t){return function(n){var r=e._loadResources;r.shaders[t]={source:n,bufferView:void 0},--r.pendingShaderLoads}}function me(e,t){return function(n){var r=e._loadResources;--r.pendingTextureLoads,r.texturesToCreate.enqueue({id:t,image:n,bufferView:void 0})}}function _e(e){return u(e.matrix)?A.fromArray(e.matrix):A.fromTranslationQuaternionRotationScale(n.fromArray(e.translation,0,nt),D.unpack(e.rotation,0,rt),n.fromArray(e.scale,0,it))}function ge(e,t){var n=e._extensionsUsed;if(!u(n)){var r=e.gltf.extensionsUsed;n={};for(var i=r.length,o=0;o<i;o++)n[r[o]]=!0}return u(n[t])}function ve(e,t){return u(t.source)?t.source:v(e._loadResources.getBuffer(e.gltf.bufferViews[t.bufferView]))}function ye(e,t,n){var r=e.indexOf(t);return e.replace(new RegExp(t,"g"),function(e,t,i){return r===t?e:n})}function Ce(e,t){var n=e.gltf;return n.techniques[n.materials[t.material].technique].program}function we(e,t){var n=e.gltf.accessors[t].extensions;if(u(n))return n.WEB3D_quantized_attributes}function be(e,t,n){var r=e.gltf,i=r.techniques[r.materials[t.material].technique];for(var o in i.parameters)if(i.parameters.hasOwnProperty(o)&&i.parameters[o].semantic===n){var a=i.attributes;for(var s in a)if(a.hasOwnProperty(s)&&a[s]===o)return s}}function Ee(e,t,n){return u(n)&&(e=n(e,t)),e}function Se(e,t,n){var r=t._loadResources.shaders,i=t.gltf.programs[e],o=function(e,t){var n,r={},i=t.length;for(n=1;n<i;++n){var o=t[n];if(/position/i.test(o)){t[n]=t[0],t[0]=o;break}}for(n=0;n<i;++n)r[t[n]]=n;return r}(0,i.attributes),a=ve(t,r[i.vertexShader]),s=ve(t,r[i.fragmentShader]),l=i.attributes.length,c=t._precreatedAttributes;if(u(c))for(var h in c)c.hasOwnProperty(h)&&(o[h]=l++);ge(t,"WEB3D_quantized_attributes")&&(a=function(e,t,n,r){var i={};n._quantizedUniforms[t]=i;for(var o=n._programPrimitives[t],a=0;a<o.length;a++){var s=o[a];if(Ce(n,s)===t)for(var l in s.attributes)if(s.attributes.hasOwnProperty(l)){var c="czm_u_dec_"+l.toLowerCase(),h=c+"_scale",d=c+"_translate";if(!u(i[c])&&!u(i[h])){var p=we(n,s.attributes[l]);if(u(p)){var f,m=be(n,s,l),_=p.decodeMatrix,g="czm_decoded_"+l,v=m.replace("a_","czm_a_dec_"),y=Math.floor(Math.sqrt(_.length));e=ye(e,m,v),e=(f=y>2?"vec"+(y-1):"float")+" "+v+";\n"+e;var C="";5===y?(e="uniform vec4 "+d+";\n"+(e="uniform mat4 "+h+";\n"+e),C="\nvoid main() {\n    "+v+" = "+h+" * "+m+" + "+d+";\n    "+g+"();\n}\n",i[h]={mat:4},i[d]={vec:4}):(e="uniform mat"+y+" "+c+";\n"+e,C="\nvoid main() {\n    "+v+" = "+f+"("+c+" * vec"+y+"("+m+",1.0));\n    "+g+"();\n}\n",i[c]={mat:y}),e=V.replaceMain(e,g),e+=C}}}}return n._programPrimitives[t]=void 0,e}(a,e,t));var d=Ee(a,e,t._vertexShaderLoaded),p=Ee(s,e,t._fragmentShaderLoaded);if(t._rendererResources.programs[e]=k.fromCache({context:n,vertexShaderSource:d,fragmentShaderSource:p,attributeLocations:o}),t.allowPicking){var f=Ee(a,e,t._pickVertexShaderLoaded),m=Ee(s,e,t._pickFragmentShaderLoaded);t._pickFragmentShaderLoaded||(m=V.createPickFragmentShaderSource(s,"uniform")),t._rendererResources.pickPrograms[e]=k.fromCache({context:n,vertexShaderSource:f,fragmentShaderSource:m,attributeLocations:o})}}function xe(e,t){return function(n){e.texturesToCreate.enqueue({id:t.id,image:n,bufferView:void 0}),--e.pendingBufferViewToImage}}function Te(e,t,n){var r,i=t.gltf.textures[e.id],o=t._rendererResources.samplers[i.sampler],a=o.minificationFilter===U.NEAREST_MIPMAP_NEAREST||o.minificationFilter===U.NEAREST_MIPMAP_LINEAR||o.minificationFilter===U.LINEAR_MIPMAP_NEAREST||o.minificationFilter===U.LINEAR_MIPMAP_LINEAR,s=a||o.wrapS===G.REPEAT||o.wrapS===G.MIRRORED_REPEAT||o.wrapT===G.REPEAT||o.wrapT===G.MIRRORED_REPEAT,l=e.image,u=!S.isPowerOfTwo(l.width)||!S.isPowerOfTwo(l.height);if(s&&u){var c=document.createElement("canvas");c.width=S.nextPowerOfTwo(l.width),c.height=S.nextPowerOfTwo(l.height),c.getContext("2d").drawImage(l,0,0,l.width,l.height,0,0,c.width,c.height),l=c}i.target===H.TEXTURE_2D&&(r=new z({context:n,source:l,pixelFormat:i.internalFormat,pixelDatatype:i.type,sampler:o,flipY:!1})),a&&r.generateMipmap(),t._rendererResources.textures[e.id]=r}function Ae(e,t){var n=e.gltf,r={},i=n.techniques[n.materials[t.material].technique],o=i.parameters,a=i.attributes,s=e._rendererResources.programs[i.program].vertexAttributes;for(var l in s)if(s.hasOwnProperty(l)){var c=a[l],h=s[l].index;u(c)?r[o[c].semantic]=h:r[l]=h}return r}function Pe(e,t,n){for(var r=e.length,i=0;i<r;++i)for(var o=[e[i]];o.length>0;){var a=o.pop(),s=n[a];if(s.jointName===t)return a;for(var l=s.children,u=l.length,c=0;c<u;++c)o.push(l[c])}}function De(e,t,n,r){return function(i){t[n]=r.evaluate(i,t[n]),t.dirtyNumber=e._maxDirtyNumber}}function Me(e,t){var n=e._loadResources;if(n.finishedBuffersCreation()&&n.finishedProgramCreation()&&n.createVertexArrays){n.createVertexArrays=!1;var r=e._rendererResources.buffers,i=e._rendererResources.vertexArrays,o=e.gltf,a=o.accessors,s=o.meshes;for(var l in s)if(s.hasOwnProperty(l))for(var c=s[l].primitives,h=c.length,d=0;d<h;++d){var p,f,m,_=c[d],g=Ae(e,_),v=[],y=_.attributes;for(p in y)if(y.hasOwnProperty(p)&&(f=g[p],u(f))){var C=a[y[p]];v.push({index:f,vertexBuffer:r[C.bufferView],componentsPerAttribute:X(C).componentsPerAttribute,componentDatatype:C.componentType,normalize:!1,offsetInBytes:C.byteOffset,strideInBytes:C.byteStride})}var w,b=e._precreatedAttributes;if(u(b))for(p in b)b.hasOwnProperty(p)&&(f=g[p],u(f)&&(m=b[p],m.index=f,v.push(m)));u(_.indices)&&(w=r[a[_.indices].bufferView]),i[l+".primitive."+d]=new W({context:t,attributes:v,indexBuffer:w})}}}function Ie(e,t){var n={value:e,clone:function(e,t){return e},func:function(){return n.value}};return n}function Oe(e,n){var r={value:t.fromArray(e),clone:t.clone,func:function(){return r.value}};return r}function Re(e,t){var r={value:n.fromArray(e),clone:n.clone,func:function(){return r.value}};return r}function Ne(e,t){var n={value:r.fromArray(e),clone:r.clone,func:function(){return n.value}};return n}function Le(e,t){var n={value:x.fromColumnMajorArray(e),clone:x.clone,func:function(){return n.value}};return n}function Fe(e,t){var n={value:T.fromColumnMajorArray(e),clone:T.clone,func:function(){return n.value}};return n}function Be(e,t){var n={value:A.fromColumnMajorArray(e),clone:A.clone,func:function(){return n.value}};return n}function ke(e,t){this._value=void 0,this._textureId=e,this._model=t}function Ve(e,t,n){var r,i,o=e.gltf.accessors,a=Ce(e,t),s=e._quantizedUniforms[a],l={},c={};for(var h in t.attributes)if(t.attributes.hasOwnProperty(h)){var d=o[t.attributes[h]],p=d.extensions;if(u(p)){var f=p.WEB3D_quantized_attributes;if(u(f)){var m=f.decodeMatrix,_="czm_u_dec_"+h.toLowerCase();switch(d.type){case"SCALAR":c[_]=Le(m).func,l[_]=!0;break;case"VEC2":c[_]=Fe(m).func,l[_]=!0;break;case"VEC3":c[_]=Be(m).func,l[_]=!0;break;case"VEC4":var g=_+"_scale",v=_+"_translate";c[g]=Be((i=m,[i[0],i[1],i[2],i[3],i[5],i[6],i[7],i[8],i[10],i[11],i[12],i[13],i[15],i[16],i[17],i[18]])).func,c[v]=Ne((r=m,[r[20],r[21],r[22],r[23]])).func,l[g]=!0,l[v]=!0}}}}for(var y in s)if(s.hasOwnProperty(y)&&!l[y]){var C=s[y];u(C.mat)&&(2===C.mat?c[y]=Le(x.IDENTITY).func:3===C.mat?c[y]=Fe(T.IDENTITY).func:4===C.mat&&(c[y]=Be(A.IDENTITY).func)),u(C.vec)&&4===C.vec&&(c[y]=Ne([0,0,0,0]).func)}return c}function ze(e){return function(){return e}}function Ue(e){return function(){return e.computedJointMatrices}}function Ge(t,r,i,o,s){for(var c=t._nodeCommands,h=t._pickIds,d=t.allowPicking,p=t._runtime.meshesByName,f=t._rendererResources,m=f.vertexArrays,_=f.programs,g=f.pickPrograms,v=f.renderStates,C=t._uniformMaps,w=t.gltf,b=w.accessors,E=w.meshes,S=w.techniques,x=w.materials,T=r.meshes,P=T.length,D=0;D<P;++D)for(var M=T[D],I=E[M],O=I.primitives,R=O.length,N=0;N<R;++N){var F,B=O[N],k=b[B.indices],V=x[B.material],z=S[V.technique],U=z.program,G=B.attributes.POSITION;if(u(G)){var W=he(w,G);F=e.fromCornerPoints(n.fromArray(W.min),n.fromArray(W.max))}var H,j,q=m[M+".primitive."+N];u(k)?(j=k.count,H=k.byteOffset/y.getSizeInBytes(k.componentType)):(j=b[B.attributes.POSITION].count,H=0);var Y=C[B.material],X=Y.uniformMap;if(u(Y.jointMatrixUniformName)){var Z={};Z[Y.jointMatrixUniformName]=Ue(i),X=a(X,Z)}if(u(t._uniformMapLoaded)&&(X=t._uniformMapLoaded(X,U,i)),ge(t,"WEB3D_quantized_attributes")){var K=Ve(t,B);X=a(X,K)}var Q,J,$,ee=v[V.technique],te=ee.blending.enabled,re={primitive:l(t.pickPrimitive,t),id:t.id,node:i.publicNode,mesh:p[I.name]},oe=ie.castShadows(t._shadows),ae=ie.receiveShadows(t._shadows),se=new L({boundingVolume:new e,cull:t.cull,modelMatrix:new A,primitiveType:B.mode,vertexArray:q,count:j,offset:H,shaderProgram:_[z.program],castShadows:oe,receiveShadows:ae,uniformMap:X,renderState:ee,owner:re,pass:te?ne.TRANSLUCENT:ne.OPAQUE});if(d){var le;if(u(t._pickFragmentShaderLoaded))le=u(t._pickUniformMapLoaded)?t._pickUniformMapLoaded(X):a(X);else{var ue=o.createPickId(re);h.push(ue);var ce={czm_pickColor:ze(ue.color)};le=a(X,ce)}Q=new L({boundingVolume:new e,cull:t.cull,modelMatrix:new A,primitiveType:B.mode,vertexArray:q,count:j,offset:H,shaderProgram:g[z.program],uniformMap:le,renderState:ee,owner:re,pass:te?ne.TRANSLUCENT:ne.OPAQUE})}s||((J=L.shallowClone(se)).boundingVolume=new e,J.modelMatrix=new A,d&&(($=L.shallowClone(Q)).boundingVolume=new e,$.modelMatrix=new A));var de={show:!0,boundingSphere:F,command:se,pickCommand:Q,command2D:J,pickCommand2D:$};i.commands.push(de),c.push(de)}}function We(e,t){var r=t.context,i=t.scene3DOnly;if(e._loadRendererResourcesFromCache){var o=e._rendererResources,a=e._cachedRendererResources;o.buffers=a.buffers,o.vertexArrays=a.vertexArrays,o.programs=a.programs,o.pickPrograms=a.pickPrograms,o.textures=a.textures,o.samplers=a.samplers,o.renderStates=a.renderStates,u(e._precreatedAttributes)&&Me(e,r)}else(function(e,t){var n=e._loadResources;if(0===n.pendingBufferLoads){for(var r,i=e.gltf.bufferViews,o=e._rendererResources.buffers;n.buffersToCreate.length>0;){var a=n.buffersToCreate.dequeue(),s=R.createVertexBuffer({context:t,typedArray:n.getBuffer(r=i[a]),usage:N.STATIC_DRAW});s.vertexArrayDestroyable=!1,o[a]=s}var l=e.gltf.accessors;for(var c in l)if(l.hasOwnProperty(c)){var h=l[c];if((r=i[h.bufferView]).target===H.ELEMENT_ARRAY_BUFFER&&!u(o[h.bufferView])){var d=R.createIndexBuffer({context:t,typedArray:n.getBuffer(r),usage:N.STATIC_DRAW,indexDatatype:h.componentType});d.vertexArrayDestroyable=!1,o[h.bufferView]=d}}}})(e,r),function(e,t){var n,r=e._loadResources;if(0===r.pendingShaderLoads&&0===r.pendingBufferLoads)if(e.asynchronous)r.programsToCreate.length>0&&(n=r.programsToCreate.dequeue(),Se(n,e,t));else for(;r.programsToCreate.length>0;)n=r.programsToCreate.dequeue(),Se(n,e,t)}(e,r),function(e,t){var n=e._loadResources;if(n.createSamplers){n.createSamplers=!1;var r=e._rendererResources.samplers,i=e.gltf.samplers;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];r[o]=new B({wrapS:a.wrapS,wrapT:a.wrapT,minificationFilter:a.minFilter,magnificationFilter:a.magFilter})}}}(e),function(e){var t=e._loadResources;if(0===t.pendingBufferLoads)for(;t.texturesToCreateFromBufferView.length>0;){var n=t.texturesToCreateFromBufferView.dequeue(),r=e.gltf.bufferViews[n.bufferView],i=xe(t,n),o=de(e,"image","id: "+n.id+", bufferView: "+n.bufferView);b(t.getBuffer(r),n.mimeType).then(i).otherwise(o),++t.pendingBufferViewToImage}}(e),function(e,t){var n,r=e._loadResources;if(e.asynchronous)r.texturesToCreate.length>0&&(n=r.texturesToCreate.dequeue(),Te(n,e,t));else for(;r.texturesToCreate.length>0;)n=r.texturesToCreate.dequeue(),Te(n,e,t)}(e,r);(function(e){var t=e._loadResources;if(0===t.pendingBufferLoads&&t.createSkins){t.createSkins=!1;var n=e.gltf,r=n.accessors,i=n.skins,o={};for(var a in i)if(i.hasOwnProperty(a)){var s,l=i[a],u=r[l.inverseBindMatrices];A.equals(l.bindShapeMatrix,A.IDENTITY)||(s=A.clone(l.bindShapeMatrix)),o[a]={inverseBindMatrices:K.getSkinInverseBindMatrices(e,u),bindShapeMatrix:s}}!function(t,n){for(var r=e.gltf,i=r.skins,o=r.nodes,a=e._runtime.nodes,s=e._loadResources.skinnedNodesIds,l=s.length,u=0;u<l;++u){var c=s[u],h=a[c],d=o[c],p=n[d.skin];h.inverseBindMatrices=p.inverseBindMatrices,h.bindShapeMatrix=p.bindShapeMatrix;for(var f=[],m=d.skeletons,_=m.length,g=0;g<_;++g)f.push(m[g]);for(var v=i[d.skin].jointNames,y=v.length,C=0;C<y;++C){var w=a[Pe(f,v[C],o)];h.joints.push(w)}}}(0,o)}})(e),function(e){var t=e._loadResources;if(t.finishedPendingBufferLoads()&&t.createRuntimeAnimations){t.createRuntimeAnimations=!1,e._runtime.animations={};var n=e._runtime.nodes,r=e.gltf.animations,i=e.gltf.accessors;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o],s=a.channels,l=a.parameters,u=a.samplers,c={};for(var h in l)l.hasOwnProperty(h)&&(c[h]=K.getAnimationParameterValues(e,i[l[h]]));for(var d=Number.MAX_VALUE,p=-Number.MAX_VALUE,f=s.length,m=new Array(f),_=0;_<f;++_){var g=s[_],v=g.target,y=u[g.sampler],C=c[y.input];d=Math.min(d,C[0]),p=Math.max(p,C[C.length-1]);var w=K.getAnimationSpline(e,o,a,g.sampler,y,c);m[_]=De(e,n[v.id],v.path,w)}e._runtime.animations[o]={startTime:d,stopTime:p,channelEvaluators:m}}}}(e),e._loadRendererResourcesFromCache||(Me(e,r),function(e,t){var n,r,i,o,a,s,c,h,d,p,f,m,_,g,v,y=e._loadResources,C=e.gltf.techniques;if(y.createRenderStates){y.createRenderStates=!1;for(var w in C)C.hasOwnProperty(w)&&(n=e,r=w,i=void 0,i=n._rendererResources.renderStates,o=n.gltf.techniques,a=o[r],s=a.states,c=function(e){var t={};t[H.BLEND]=!1,t[H.CULL_FACE]=!1,t[H.DEPTH_TEST]=!1,t[H.POLYGON_OFFSET_FILL]=!1,t[H.SCISSOR_TEST]=!1;var n,r=e.enable,i=r.length;for(n=0;n<i;++n)t[r[n]]=!0;return t}(s),h=l(s.functions,l.EMPTY_OBJECT),d=l(h.blendColor,[0,0,0,0]),p=l(h.blendEquationSeparate,[H.FUNC_ADD,H.FUNC_ADD]),f=l(h.blendFuncSeparate,[H.ONE,H.ZERO,H.ONE,H.ZERO]),m=l(h.colorMask,[!0,!0,!0,!0]),_=l(h.depthRange,[0,1]),g=l(h.polygonOffset,[0,0]),v=l(h.scissor,[0,0,0,0]),i[r]=F.fromCache({frontFace:u(h.frontFace)?h.frontFace[0]:H.CCW,cull:{enabled:c[H.CULL_FACE],face:u(h.cullFace)?h.cullFace[0]:H.BACK},lineWidth:u(h.lineWidth)?h.lineWidth[0]:1,polygonOffset:{enabled:c[H.POLYGON_OFFSET_FILL],factor:g[0],units:g[1]},scissorTest:{enabled:c[H.SCISSOR_TEST],rectangle:{x:v[0],y:v[1],width:v[2],height:v[3]}},depthRange:{near:_[0],far:_[1]},depthTest:{enabled:c[H.DEPTH_TEST],func:u(h.depthFunc)?h.depthFunc[0]:H.LESS},colorMask:{red:m[0],green:m[1],blue:m[2],alpha:m[3]},depthMask:!u(h.depthMask)||h.depthMask[0],blending:{enabled:c[H.BLEND],color:{red:d[0],green:d[1],blue:d[2],alpha:d[3]},equationRgb:p[0],equationAlpha:p[1],functionSourceRgb:f[0],functionDestinationRgb:f[1],functionSourceAlpha:f[2],functionDestinationAlpha:f[3]}}))}}(e)),function(e,t){var n,r,i,o,a=e._loadResources;if(a.finishedProgramCreation()&&a.createUniformMaps){a.createUniformMaps=!1;var s=e.gltf,l=s.materials,c=s.techniques,h=e._uniformMaps;for(var d in l)if(l.hasOwnProperty(d)){var p,f=l[d],m=f.values,_=c[f.technique],g=_.parameters,v=_.uniforms,y={},C={};for(var w in v)if(v.hasOwnProperty(w)){var b=v[w],E=g[b];if(u(m[b])){var S=st[E.type](m[b],e);y[w]=S.func,C[b]=S}else if(u(E.node))y[w]=(n=E.node,r=e,i=E.semantic,o=t.uniformState,lt[i](o,r,r._runtime.nodes[n]));else if(u(E.semantic))"JOINTMATRIX"!==E.semantic?y[w]=at[E.semantic](t.uniformState,e):p=w;else if(u(E.value)){var x=st[E.type](E.value,e);y[w]=x.func,C[b]=x}}var T=h[d];T.uniformMap=y,T.values=C,T.jointMatrixUniformName=p}}}(e,r),function(e,t,r){var i=e._loadResources;if(i.finishedEverythingButTextureCreation()&&i.createRuntimeNodes){i.createRuntimeNodes=!1;for(var o=[],a=e._runtime.nodes,s=e.gltf,l=s.nodes,c=s.scenes[s.scene].nodes,h=c.length,d=[],p=0;p<h;++p)for(d.push({parentRuntimeNode:void 0,gltfNode:l[c[p]],id:c[p]});d.length>0;){var f=d.pop(),m=f.parentRuntimeNode,_=f.gltfNode,g=a[f.id];if(0===g.parents.length)if(u(_.matrix))g.matrix=A.fromColumnMajorArray(_.matrix);else{var v=_.rotation;g.translation=n.fromArray(_.translation),g.rotation=D.unpack(v),g.scale=n.fromArray(_.scale)}u(m)?(m.children.push(g),g.parents.push(m)):o.push(g),u(_.meshes)&&Ge(e,_,g,t,r);for(var y=_.children,C=y.length,w=0;w<C;++w)d.push({parentRuntimeNode:g,gltfNode:l[y[w]],id:y[w]})}e._runtime.rootNodes=o,e._runtime.nodes=a}}(e,r,i)}function He(e,t){var n=e.publicNode,r=n.matrix;n.useMatrix&&u(r)?A.clone(r,t):u(e.matrix)?A.clone(e.matrix,t):(A.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),n.setMatrix(t))}function je(e){u(e._cacheKey)&&u(e._cachedGltf)&&0==--e._cachedGltf.count&&delete Je[e._cacheKey],e._cachedGltf=void 0}function qe(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.pickPrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function Ye(e){for(var t in e)e.hasOwnProperty(t)&&e[t].destroy()}function Xe(e,t,n){return function(r){if(e.heightReference===Z.RELATIVE_TO_GROUND){var i=t.cartesianToCartographic(r,ft);i.height+=n.height,t.cartographicToCartesian(i,r)}var o=e._clampedModelMatrix;A.clone(e.modelMatrix,o),o[12]=r.x,o[13]=r.y,o[14]=r.z,e._heightChanged=!0}}if(!f.supportsTypedArrays())return{};var Ze=A.fromRotationTranslation(T.fromRotationX(S.PI_OVER_TWO)),Ke=new n,Qe={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};oe.prototype.getBuffer=function(e){return this.buffers[e.buffer].subarray(t=e.byteOffset,t+e.byteLength);var t},oe.prototype.finishedPendingBufferLoads=function(){return 0===this.pendingBufferLoads},oe.prototype.finishedBuffersCreation=function(){return 0===this.pendingBufferLoads&&0===this.buffersToCreate.length},oe.prototype.finishedProgramCreation=function(){return 0===this.pendingShaderLoads&&0===this.programsToCreate.length},oe.prototype.finishedTextureCreation=function(){return 0===this.pendingTextureLoads&&0===this.texturesToCreate.length&&0===this.texturesToCreateFromBufferView.length},oe.prototype.finishedEverythingButTextureCreation=function(){return 0===this.pendingBufferLoads&&0===this.pendingShaderLoads&&0===this.buffersToCreate.length&&0===this.programsToCreate.length&&0===this.pendingBufferViewToImage},oe.prototype.finished=function(){return this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()},c(se.prototype,{gltf:{set:function(e){this._gltf=$(j(e))},get:function(){return this._gltf}},bgltf:{get:function(){return this._bgltf}}}),se.prototype.makeReady=function(e,t){this.gltf=e,this._bgltf=t;for(var n=this.modelsToLoad,r=n.length,i=0;i<r;++i){var o=n[i];o.isDestroyed()||ae(o,this)}this.modelsToLoad=void 0,this.ready=!0};var Je={};c(le.prototype,{gltf:{get:function(){return u(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._basePath}},boundingSphere:{get:function(){var e=this.modelMatrix;this.heightReference!==Z.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);var t=A.getScale(e,Ke),r=u(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;n.multiplyByScalar(t,r,t);var i=this._scaledBoundingSphere;return i.center=n.multiplyComponents(this._boundingSphere.center,t,i.center),i.radius=n.maximumComponent(t)*this._initialRadius,u(this._rtcCenter)&&n.add(this._rtcCenter,i.center,i.center),i}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return u(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=p.clone(e,this._distanceDisplayCondition)}}});var $e=Uint32Array.BYTES_PER_ELEMENT;le.fromGltf=function(e){var t=e.url,n=l(e.cacheKey,m(t));(e=o(e)).basePath=_(t),e.cacheKey=n;var r=new le(e);e.headers=u(e.headers)?o(e.headers):{},u(e.headers.Accept)||(e.headers.Accept="model/vnd.gltf.binary,model/vnd.gltf+json,model/gltf.binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01");var i=Je[n];return u(i)?i.ready||(++i.count,i.modelsToLoad.push(r)):((i=new se({ready:!1})).count=1,i.modelsToLoad.push(r),ae(r,i),Je[n]=i,C(t,e.headers).then(function(e){var t=new Uint8Array(e);if("glTF"===g(t)){var n=ue(t);0!==n.binaryOffset&&(t=t.subarray(n.binaryOffset)),i.makeReady(n.glTF,t)}else{var r=v(t);i.makeReady(JSON.parse(r))}}).otherwise(de(r,"model",t))),r},le._gltfCache=Je,le.prototype.getNode=function(e){var t=ce(this,"nodesByName",e);return u(t)?t.publicNode:void 0},le.prototype.getMesh=function(e){return ce(this,"meshesByName",e)},le.prototype.getMaterial=function(e){return ce(this,"materialsByName",e)};var et=new n,tt=new n,nt=new n,rt=new D,it=new n,ot=new n,at={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){var r=new A;return function(){return A.getTranslation(e.model,ot),n.add(ot,t._rtcCenter,ot),A.multiplyByPoint(e.view,ot,ot),A.setTranslation(e.modelView,ot,r)}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};c(ke.prototype,{value:{get:function(){if(!u(this._value)){var e=this._model._rendererResources.textures[this._textureId];if(!u(e))return this._model._defaultTexture;this._value=e}return this._value},set:function(e){this._value=e}}}),ke.prototype.clone=function(e,t){return e},ke.prototype.func=void 0;var st={};st[H.FLOAT]=Ie,st[H.FLOAT_VEC2]=Oe,st[H.FLOAT_VEC3]=Re,st[H.FLOAT_VEC4]=Ne,st[H.INT]=Ie,st[H.INT_VEC2]=Oe,st[H.INT_VEC3]=Re,st[H.INT_VEC4]=Ne,st[H.BOOL]=Ie,st[H.BOOL_VEC2]=Oe,st[H.BOOL_VEC3]=Re,st[H.BOOL_VEC4]=Ne,st[H.FLOAT_MAT2]=Le,st[H.FLOAT_MAT3]=Fe,st[H.FLOAT_MAT4]=Be,st[H.SAMPLER_2D]=function(e,t){var n=new ke(e,t);return n.func=function(){return n.value},n};var lt={MODEL:function(e,t,n){return function(){return n.computedMatrix}},VIEW:function(e,t,n){return function(){return e.view}},PROJECTION:function(e,t,n){return function(){return e.projection}},MODELVIEW:function(e,t,n){var r=new A;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r)}},CESIUM_RTC_MODELVIEW:function(e,t,n){var r=new A;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r),A.setTranslation(r,t._rtcCenterEye,r)}},MODELVIEWPROJECTION:function(e,t,n){var r=new A;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r),A.multiply(e._projection,r,r)}},MODELINVERSE:function(e,t,n){var r=new A;return function(){return A.inverse(n.computedMatrix,r)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,n){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,n){var r=new A,i=new A;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r),A.inverse(r,i)}},MODELVIEWPROJECTIONINVERSE:function(e,t,n){var r=new A,i=new A;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r),A.multiply(e._projection,r,r),A.inverse(r,i)}},MODELINVERSETRANSPOSE:function(e,t,n){var r=new A,i=new T;return function(){return A.inverse(n.computedMatrix,r),A.getRotation(r,i),T.transpose(i,i)}},MODELVIEWINVERSETRANSPOSE:function(e,t,n){var r=new A,i=new A,o=new T;return function(){return A.multiplyTransformation(e.view,n.computedMatrix,r),A.inverse(r,i),A.getRotation(i,o),T.transpose(o,o)}},VIEWPORT:function(e,t,n){return function(){return e.viewportCartesian4}}},ut=[],ct=new A,ht=new A,dt=new e,pt=new n,ft=new i;qe.prototype.release=function(){if(0==--this.count)return u(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],Ye(this.buffers),Ye(this.vertexArrays),Ye(this.programs),Ye(this.pickPrograms),Ye(this.textures),h(this)};var mt=new n,_t=new i;return le.prototype.update=function(t){if(t.mode!==re.MORPHING){var r=t.context;if(this._defaultTexture=r.defaultTexture,this._state===Qe.NEEDS_LOAD&&u(this.gltf)){var o,a=this.cacheKey;if(u(a)){r.cache.modelRendererResourceCache=l(r.cache.modelRendererResourceCache,{});var s=r.cache.modelRendererResourceCache;if(u(o=s[this.cacheKey])){if(!o.ready)return;++o.count,this._loadRendererResourcesFromCache=!0}else o=new qe(r,a),o.count=1,s[this.cacheKey]=o;this._cachedRendererResources=o}else o=new qe(r),o.count=1,this._cachedRendererResources=o;if(this._state=Qe.LOADING,this._boundingSphere=function(t){for(var r=t.nodes,i=t.meshes,o=t.scenes[t.scene].nodes,a=o.length,s=[],l=new n(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),c=new n(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),h=0;h<a;++h){var d=r[o[h]];for(d._transformToRoot=_e(d),s.push(d);s.length>0;){var p=(d=s.pop())._transformToRoot,f=d.meshes;if(u(f))for(var m=f.length,_=0;_<m;++_)for(var g=i[f[_]].primitives,v=g.length,y=0;y<v;++y){var C=g[y].attributes.POSITION;if(u(C)){var w=he(t,C),b=n.fromArray(w.min,0,et),E=n.fromArray(w.max,0,tt);u(l)&&u(c)&&(A.multiplyByPoint(p,b,b),A.multiplyByPoint(p,E,E),n.minimumByComponent(l,b,l),n.maximumByComponent(c,E,c))}}for(var S=d.children,x=S.length,T=0;T<x;++T){var P=r[S[T]];P._transformToRoot=_e(P),A.multiplyTransformation(p,P._transformToRoot,P._transformToRoot),s.push(P)}delete d._transformToRoot}}var D=e.fromCornerPoints(l,c);return e.transformWithoutScale(D,Ze,D)}(this.gltf),this._initialRadius=this._boundingSphere.radius,function(e){var t=e.gltf.extensionsUsed;if(u(t))for(var n=t.length,r=0;r<n;++r){var i=t[r];if("CESIUM_RTC"!==i&&"KHR_binary_glTF"!==i&&"KHR_materials_common"!==i&&"WEB3D_quantized_attributes"!==i)throw new I("Unsupported glTF Extension: "+i)}}(this),this._state!==Qe.FAILED){var c=this.gltf.extensions;u(c)&&u(c.CESIUM_RTC)&&(this._rtcCenter=n.fromArray(c.CESIUM_RTC.center),this._rtcCenterEye=new n),this._loadResources=new oe,this._loadRendererResourcesFromCache||(function(e){var t=e.gltf.buffers;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if("binary_glTF"===n||"KHR_binary_glTF"===n)e._loadResources.buffers[n]=e._cachedGltf.bgltf;else if("arraybuffer"===r.type){++e._loadResources.pendingBufferLoads;var i=new q(r.uri).resolve(e._baseUri).toString();C(i).then(pe(e,n)).otherwise(de(e,"buffer",i))}}}(this),function(e){var t=e.gltf.bufferViews;for(var n in t)t.hasOwnProperty(n)&&t[n].target===H.ARRAY_BUFFER&&e._loadResources.buffersToCreate.enqueue(n)}(this),function(e){var t=e.gltf.shaders;for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(u(r.extras)&&u(r.extras.source))e._loadResources.shaders[n]={source:r.extras.source,bufferView:void 0};else if(u(r.extensions)&&u(r.extensions.KHR_binary_glTF))e._loadResources.shaders[n]={source:void 0,bufferView:r.extensions.KHR_binary_glTF.bufferView};else{++e._loadResources.pendingShaderLoads;var i=new q(r.uri).resolve(e._baseUri).toString();E(i).then(fe(e,n)).otherwise(de(e,"shader",i))}}}(this),function(e){var t=e.gltf.programs;for(var n in t)t.hasOwnProperty(n)&&e._loadResources.programsToCreate.enqueue(n)}(this),function(e){var t=e.gltf.images,n=e.gltf.textures;for(var r in n)if(n.hasOwnProperty(r)){var i=t[n[r].source];if(u(i.extensions)&&u(i.extensions.KHR_binary_glTF)){var o=i.extensions.KHR_binary_glTF;e._loadResources.texturesToCreateFromBufferView.enqueue({id:r,image:void 0,bufferView:o.bufferView,mimeType:o.mimeType})}else{++e._loadResources.pendingTextureLoads;var a=new q(i.uri).resolve(e._baseUri).toString();w(a).then(me(e,r)).otherwise(de(e,"image",a))}}}(this)),function(e){var t={},n={},r=e.gltf.materials,i=e._uniformMaps;for(var o in r)if(r.hasOwnProperty(o)){i[o]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0};var a=r[o],s=new J(e,a,o);t[a.name]=s,n[o]=s}e._runtime.materialsByName=t,e._runtime.materialsById=n}(this),function(e){var t={},n=e._runtime.materialsById,r=e.gltf.meshes,i=ge(e,"WEB3D_quantized_attributes");for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];if(t[a.name]=new ee(a,n,o),i)for(var s=a.primitives,l=s.length,c=0;c<l;c++){var h=s[c],d=Ce(e,h),p=e._programPrimitives[d];u(p)||(e._programPrimitives[d]=p=[]),p.push(h)}}e._runtime.meshesByName=t}(this),function(e){var t={},n={},r=[],i=e._loadResources.skinnedNodesIds,o=e.gltf.nodes;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a],l={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new A,computedMatrix:new A,dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:s.jointName,children:[],parents:[],publicNode:void 0};l.publicNode=new te(e,s,l,a,_e(s)),t[a]=l,n[s.name]=l,u(s.skin)&&(i.push(a),r.push(l))}e._runtime.nodes=t,e._runtime.nodesByName=n,e._runtime.skinnedNodes=r}(this)}}var h=this._loadResources,d=this._incrementallyLoadTextures,p=!1;if(this._state===Qe.LOADING&&(We(this,t),(h.finished()||d&&h.finishedEverythingButTextureCreation())&&(this._state=Qe.LOADED,p=!0)),u(h)&&this._state===Qe.LOADED&&(d&&!p&&We(this,t),h.finished())){this._loadResources=void 0;var f=this._rendererResources,m=this._cachedRendererResources;m.buffers=f.buffers,m.vertexArrays=f.vertexArrays,m.programs=f.programs,m.pickPrograms=f.pickPrograms,m.textures=f.textures,m.samplers=f.samplers,m.renderStates=f.renderStates,m.ready=!0,u(this._precreatedAttributes)&&(m.vertexArrays={}),this.releaseGltfJson&&je(this)}var _=!u(this.distanceDisplayCondition)||function(e,t){var r,i=e.distanceDisplayCondition,o=i.near*i.near,a=i.far*i.far;if(t.mode===re.SCENE2D)r=.5*(t.camera.frustum.right-t.camera.frustum.left),r*=r;else{var s=A.getTranslation(e.modelMatrix,mt);if(t.mode===re.COLUMBUS_VIEW){var l=t.mapProjection,u=l.ellipsoid.cartesianToCartographic(s,_t);s=l.project(u,s),n.fromElements(s.z,s.x,s.y,s)}r=n.distanceSquared(s,t.camera.positionWC)}return r>=o&&r<=a}(this,t),g=this.show&&_&&0!==this.scale;if(g&&this._state===Qe.LOADED||p){var v=this.activeAnimations.update(t)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;var y=this.modelMatrix,b=t.mode!==this._mode;this._mode=t.mode;var x=!A.equals(this._modelMatrix,y)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||b;if(x||p){A.clone(y,this._modelMatrix),function(e){u(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);var t=e._scene;if(u(t)&&e.heightReference!==Z.NONE){var n=t.globe,r=n.ellipsoid,o=e.modelMatrix;pt.x=o[12],pt.y=o[13],pt.z=o[14];var a=r.cartesianToCartographic(pt);u(e._clampedModelMatrix)||(e._clampedModelMatrix=A.clone(o,new A)),e._removeUpdateHeightCallback=n._surface.updateHeight(a,Xe(e,r,a));var s=n.getHeight(a);if(u(s)){var l=Xe(e,r,a);i.clone(a,ft),ft.height=s,r.cartographicToCartesian(ft,pt),l(pt)}}else e._clampedModelMatrix=void 0}(this),u(this._clampedModelMatrix)&&(y=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;var T=function(e,t){var r,i,o=e.scale;if(0!==e.minimumPixelSize){var a=t.context,s=Math.max(a.drawingBufferWidth,a.drawingBufferHeight),l=u(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(pt.x=l[12],pt.y=l[13],pt.z=l[14],u(e._rtcCenter)&&n.add(e._rtcCenter,pt,pt),e._mode!==re.SCENE3D){var c=t.mapProjection,h=c.ellipsoid.cartesianToCartographic(pt,ft);c.project(h,pt),n.fromElements(pt.z,pt.x,pt.y,pt)}var d=e.boundingSphere.radius,p=(r=d,i=t,dt.center=pt,dt.radius=r,i.camera.getPixelSize(dt,i.context.drawingBufferWidth,i.context.drawingBufferHeight));Math.min(1/p*(2*d),s)<e.minimumPixelSize&&(o=e.minimumPixelSize*p/(2*e._initialRadius))}return u(e.maximumScale)?Math.min(e.maximumScale,o):o}(this,t),D=this._computedModelMatrix;A.multiplyByUniformScale(y,T,D),A.multiplyTransformation(D,Ze,D)}(v||x||p)&&(function(t,r,i,o){var a=t._maxDirtyNumber,s=t.allowPicking,l=t._runtime.rootNodes,c=l.length,h=ut,d=t._computedModelMatrix;t._mode!==re.SCENE3D&&(d=O.basisTo2D(o,d,ct));for(var p=0;p<c;++p){var f=l[p];for(He(f,f.transformToRoot),h.push(f);h.length>0;){var m=(f=h.pop()).transformToRoot,_=f.commands;if(f.dirtyNumber===a||r||i){var g=A.multiplyTransformation(d,m,f.computedMatrix),v=_.length;if(v>0)for(var y=0;y<v;++y){var C=_[y],w=C.command;if(A.clone(g,w.modelMatrix),e.transform(C.boundingSphere,w.modelMatrix,w.boundingVolume),u(t._rtcCenter)&&n.add(t._rtcCenter,w.boundingVolume.center,w.boundingVolume.center),s){var b=C.pickCommand;A.clone(w.modelMatrix,b.modelMatrix),e.clone(w.boundingVolume,b.boundingVolume)}if(u(w=C.command2D)&&t._mode===re.SCENE2D&&(A.clone(g,w.modelMatrix),w.modelMatrix[13]-=2*S.sign(w.modelMatrix[13])*S.PI*o.ellipsoid.maximumRadius,e.transform(C.boundingSphere,w.modelMatrix,w.boundingVolume),s)){var E=C.pickCommand2D;A.clone(w.modelMatrix,E.modelMatrix),e.clone(w.boundingVolume,E.boundingVolume)}}}for(var x=f.children,T=x.length,P=0;P<T;++P){var D=x[P];D.dirtyNumber=Math.max(D.dirtyNumber,f.dirtyNumber),(D.dirtyNumber===a||i)&&(He(D,D.transformToRoot),A.multiplyTransformation(m,D.transformToRoot,D.transformToRoot)),h.push(D)}}}++t._maxDirtyNumber}(this,x,p,t.mapProjection),this._dirty=!0,(v||p)&&function(e){for(var t=e._runtime.skinnedNodes,n=t.length,r=0;r<n;++r){var i=t[r];ht=A.inverseTransformation(i.transformToRoot,ht);for(var o=i.computedJointMatrices,a=i.joints,s=i.bindShapeMatrix,l=i.inverseBindMatrices,c=l.length,h=0;h<c;++h)u(o[h])||(o[h]=new A),o[h]=A.multiplyTransformation(ht,a[h].transformToRoot,o[h]),o[h]=A.multiplyTransformation(o[h],l[h],o[h]),u(s)&&(o[h]=A.multiplyTransformation(o[h],s,o[h]))}}(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,function(e){for(var t=e._runtime.rootNodes,n=t.length,r=ut,i=0;i<n;++i){var o=t[i];for(o.computedShow=o.publicNode.show,r.push(o);r.length>0;){for(var a=(o=r.pop()).computedShow,s=o.commands,l=s.length,u=0;u<l;++u)s[u].show=a;for(var c=o.children,h=c.length,d=0;d<h;++d){var p=c[d];p.computedShow=a&&p.publicNode.show,r.push(p)}}}}(this)),function(e,t){var n=e.id;if(e._id!==n){e._id=n;for(var r=e._pickIds,i=r.length,o=0;o<i;++o)r[o].object.id=n}}(this),function(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?P.LINES:P.TRIANGLES,n=e._nodeCommands,r=n.length,i=0;i<r;++i)n[i].command.primitiveType=t}}(this),function(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e.debugShowBoundingVolume,n=e._nodeCommands,r=n.length,i=0;i<r;++i)n[i].command.debugShowBoundingVolume=t}}(this),function(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=ie.castShadows(e.shadows),n=ie.receiveShadows(e.shadows),r=e._nodeCommands,i=r.length,o=0;o<i;o++){var a=r[o];a.command.castShadows=t,a.command.receiveShadows=n}}}(this)}if(p){var M=this;return void t.afterRender.push(function(){M._ready=!0,M._readyPromise.resolve(M)})}if(g&&!this._ignoreCommands){var R,N,L,F=t.commandList,B=t.passes,k=this._nodeCommands,V=k.length,z=t.mapProjection.ellipsoid.maximumRadius*S.PI;if(B.render)for(R=0;R<V;++R)if(N=k[R],N.show){var U=N.command;F.push(U),L=U.boundingVolume,t.mode===re.SCENE2D&&(L.center.y+L.radius>z||L.center.y-L.radius<z)&&F.push(N.command2D)}if(B.pick&&this.allowPicking)for(R=0;R<V;++R)if(N=k[R],N.show){var G=N.pickCommand;F.push(G),L=G.boundingVolume,t.mode===re.SCENE2D&&(L.center.y+L.radius>z||L.center.y-L.radius<z)&&F.push(N.pickCommand2D)}}}},le.prototype.isDestroyed=function(){return!1},le.prototype.destroy=function(){u(this._precreatedAttributes)&&Ye(this._rendererResources.vertexArrays),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release();for(var e=this._pickIds,t=e.length,n=0;n<t;++n)e[n].destroy();return je(this),h(this)},le}),o("DataSources/ModelVisualizer",["../Core/AssociativeArray","../Core/BoundingSphere","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Scene/HeightReference","../Scene/Model","../Scene/ModelAnimationLoop","../Scene/ShadowMode","./BoundingSphereState","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(t,n){n.collectionChanged.addEventListener(d.prototype._onCollectionChanged,this),this._scene=t,this._primitives=t.primitives,this._entityCollection=n,this._modelHash={},this._entitiesToVisualize=new e,this._onCollectionChanged(n,n.values,[],[])}function p(e,t,r,i){var o=r[t.id];n(o)&&(i.removeAndDestroy(o.modelPrimitive),delete r[t.id])}function f(e){console.error(e)}var m=u.ENABLED,_=a.NONE,g=new o,v=new o;return d.prototype.update=function(e){for(var t=this._entitiesToVisualize.values,r=this._modelHash,i=this._primitives,a=0,u=t.length;a<u;a++){var c,d,p=t[a],y=p._model,C=r[p.id],w=p.isShowing&&p.isAvailable(e)&&h.getValueOrDefault(y._show,e,!0);if(w&&(d=p._getModelMatrix(e,g),c=h.getValueOrUndefined(y._uri,e),w=n(d)&&n(c)),w){var b=n(C)?C.modelPrimitive:void 0;if(n(b)&&c===C.uri||(n(b)&&(i.removeAndDestroy(b),delete r[p.id]),(b=s.fromGltf({url:c,incrementallyLoadTextures:h.getValueOrDefault(y._incrementallyLoadTextures,e,!0),scene:this._scene})).readyPromise.otherwise(f),b.id=p,i.add(b),r[p.id]=C={modelPrimitive:b,uri:c,animationsRunning:!1,nodeTransformationsScratch:{},originalNodeMatrixHash:{}}),b.show=!0,b.scale=h.getValueOrDefault(y._scale,e,1),b.minimumPixelSize=h.getValueOrDefault(y._minimumPixelSize,e,0),b.maximumScale=h.getValueOrUndefined(y._maximumScale,e),b.modelMatrix=o.clone(d,b.modelMatrix),b.shadows=h.getValueOrDefault(y._shadows,e,m),b.heightReference=h.getValueOrDefault(y._heightReference,e,_),b.distanceDisplayCondition=h.getValueOrUndefined(y._distanceDisplayCondition,e),b.ready){var E=h.getValueOrDefault(y._runAnimations,e,!0);C.animationsRunning!==E&&(E?b.activeAnimations.addAll({loop:l.REPEAT}):b.activeAnimations.removeAll(),C.animationsRunning=E);var S=h.getValueOrUndefined(y._nodeTransformations,e,C.nodeTransformationsScratch);if(n(S))for(var x=C.originalNodeMatrixHash,T=Object.keys(S),A=0,P=T.length;A<P;++A){var D=T[A],M=S[D];if(n(M)){var I=b.getNode(D);if(n(I)){var O=x[D];n(O)||(O=I.matrix.clone(),x[D]=O);var R=o.fromTranslationRotationScale(M,v);I.matrix=o.multiply(O,R,R)}}}}}else n(C)&&(C.modelPrimitive.show=!1)}return!0},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(d.prototype._onCollectionChanged,this);for(var e=this._entitiesToVisualize.values,t=this._modelHash,n=this._primitives,i=e.length-1;i>-1;i--)p(0,e[i],t,n);return r(this)},d.prototype.getBoundingSphere=function(e,r){var i=this._modelHash[e.id];if(!n(i))return c.FAILED;var o=i.modelPrimitive;if(!n(o)||!o.show)return c.FAILED;if(!o.ready)return c.PENDING;if(o.heightReference===a.NONE)t.transform(o.boundingSphere,o.modelMatrix,r);else{if(!n(o._clampedModelMatrix))return c.PENDING;t.transform(o.boundingSphere,o._clampedModelMatrix,r)}return c.DONE},d.prototype._onCollectionChanged=function(e,t,r,i){var o,a,s,l,u,c=this._entitiesToVisualize,h=this._modelHash,d=this._primitives;for(o=t.length-1;o>-1;o--)a=t[o],n(a._model)&&n(a._position)&&c.set(a.id,a);for(o=i.length-1;o>-1;o--)a=i[o],n(a._model)&&n(a._position)?(s=a,l=h,u=void 0,u=l[s.id],n(u)&&(u.nodeTransformationsScratch={}),c.set(a.id,a)):(p(0,a,h,d),c.remove(a.id));for(o=r.length-1;o>-1;o--)a=r[o],p(0,a,h,d),c.remove(a.id)},d}),o("Shaders/PolylineCommon",[],function(){"use strict";return"void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious) {\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\nif (czm_equalsEpsilon(previous.xyz - position.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(next.xyz - position.xyz, vec3(0.0), czm_epsilon1) || clipped)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\n"}),o("Shaders/PolylineFS",[],function(){"use strict";return"varying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"}),o("Shaders/PolylineVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 position2DHigh;\nattribute vec3 position2DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 prevPosition2DHigh;\nattribute vec3 prevPosition2DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec3 nextPosition2DHigh;\nattribute vec3 nextPosition2DLow;\nattribute vec4 texCoordExpandAndBatchIndex;\nvarying vec2  v_st;\nvarying float v_width;\nvarying vec4  czm_pickColor;\nvoid main()\n{\nfloat texCoord = texCoordExpandAndBatchIndex.x;\nfloat expandDir = texCoordExpandAndBatchIndex.y;\nbool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\nfloat batchTableIndex = texCoordExpandAndBatchIndex.w;\nvec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\nfloat width = widthAndShow.x + 0.5;\nfloat show = widthAndShow.y;\nif (width < 1.0)\n{\nshow = 0.0;\n}\nvec4 pickColor = batchTable_getPickColor(batchTableIndex);\nvec4 p, prev, next;\nif (czm_morphTime == 1.0)\n{\np = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\nprev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\nnext = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n}\nelse if (czm_morphTime == 0.0)\n{\np = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nprev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\nnext = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n}\nelse\n{\np = czm_columbusViewMorph(\nczm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\nczm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\nczm_morphTime);\nprev = czm_columbusViewMorph(\nczm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\nczm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\nczm_morphTime);\nnext = czm_columbusViewMorph(\nczm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\nczm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\nczm_morphTime);\n}\n#ifdef DISTANCE_DISPLAY_CONDITION\nvec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\nvec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\nvec3 centerLow = centerLowAndRadius.xyz;\nfloat radius = centerLowAndRadius.w;\nvec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nvec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\nlengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n}\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\nshow = 0.0;\n}\n#endif\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC * show;\nv_st = vec2(texCoord, clamp(expandDir, 0.0, 1.0));\nv_width = width;\nczm_pickColor = pickColor;\n}\n"}),o("Scene/Polyline",["../Core/arrayRemoveDuplicates","../Core/BoundingSphere","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/Matrix4","../Core/PolylinePipeline","./Material"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(a,s){a=i(a,i.EMPTY_OBJECT),this._show=i(a.show,!0),this._width=i(a.width,1),this._loop=i(a.loop,!1),this._distanceDisplayCondition=a.distanceDisplayCondition,this._material=a.material,o(this._material)||(this._material=h.fromType(h.ColorType,{color:new r(1,1,1,1)}));var l,d=a.positions;o(d)||(d=[]),this._positions=d,this._actualPositions=e(d,n.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=d.slice()),this._actualPositions.push(n.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=a.id,o(s)&&(l=u.clone(s.modelMatrix)),this._modelMatrix=l,this._segments=c.wrapLongitude(this._actualPositions,l),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(C),this._polylineCollection=s,this._dirty=!1,this._pickId=void 0,this._boundingVolume=t.fromPoints(this._actualPositions),this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new t}function p(e,t){++e._propertiesChanged[t];var n=e._polylineCollection;o(n)&&(n._updatePolyline(e,t),e._dirty=!0)}var f=d.POSITION_INDEX=0,m=d.SHOW_INDEX=1,_=d.WIDTH_INDEX=2,g=d.MATERIAL_INDEX=3,v=d.POSITION_SIZE_INDEX=4,y=d.DISTANCE_DISPLAY_CONDITION=5,C=d.NUMBER_OF_PROPERTIES=6;return a(d.prototype,{show:{get:function(){return this._show},set:function(e){e!==this._show&&(this._show=e,p(this,m))}},positions:{get:function(){return this._positions},set:function(r){var i=e(r,n.equalsEpsilon);this._loop&&i.length>2&&(i===r&&(i=r.slice()),i.push(n.clone(i[0]))),this._actualPositions.length===i.length&&this._actualPositions.length===this._length||p(this,v),this._positions=r,this._actualPositions=i,this._length=i.length,this._boundingVolume=t.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=t.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),p(this,f),this.update()}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,p(this,g))}},width:{get:function(){return this._width},set:function(e){e!==this._width&&(this._width=e,p(this,_))}},loop:{get:function(){return this._loop},set:function(e){if(e!==this._loop){var t=this._actualPositions;e?t.length>2&&!n.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(n.clone(t[0]))):t.length>2&&n.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,p(this,v)}}},id:{get:function(){return this._id},set:function(e){this._id=e,o(this._pickId)&&(this._pickId.object.id=e)}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){l.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=l.clone(e,this._distanceDisplayCondition),p(this,y))}}}),d.prototype.update=function(){var e=u.IDENTITY;o(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);var n=this._segments.positions.length,r=this._segments.lengths,i=this._propertiesChanged[f]>0||this._propertiesChanged[v]>0;if(u.equals(e,this._modelMatrix)&&!i||(this._segments=c.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=t.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=e,this._segments.positions.length!==n)p(this,v);else for(var a=r.length,s=0;s<a;++s)if(r[s]!==this._segments.lengths[s]){p(this,v);break}},d.prototype.getPickId=function(e){return o(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},d.prototype._clean=function(){this._dirty=!1;for(var e=this._propertiesChanged,t=0;t<C-1;++t)e[t]=0},d.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0},d}),o("Scene/PolylineCollection",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EncodedCartesian3","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/Plane","../Core/RuntimeError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/PolylineCommon","../Shaders/PolylineFS","../Shaders/PolylineVS","./BatchTable","./BlendingState","./Material","./Pass","./Polyline","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L){"use strict";function F(e){e=s(e,s.EMPTY_OBJECT),this.modelMatrix=_.clone(s(e.modelMatrix,_.IDENTITY)),this._modelMatrix=_.clone(_.IDENTITY),this.debugShowBoundingVolume=s(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._pickCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array($),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:C.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1}function B(t,n,r,i,o){for(var a=n.context,s=n.commandList,u=r.length,c=0,h=!0,d=t._vertexArrays,p=t.debugShowBoundingVolume,f=t._batchTable.getUniformMapCallback(),m=d.length,_=0;_<m;++_)for(var g=d[_],v=g.buckets,y=v.length,C=0;C<y;++C){for(var w,E,S,x=v[C],T=x.offset,A=o?x.bucket.shaderProgram:x.bucket.pickShaderProgram,P=x.bucket.polylines,D=P.length,M=0,I=0;I<D;++I){var O,N=P[I],F=V(N._material);if(F!==w){if(l(w)&&M>0){var B=E.isTranslucent();c>=u?(S=new b({owner:t}),r.push(S)):S=r[c],++c,S.boundingVolume=e.clone(ie,S.boundingVolume),S.modelMatrix=i,S.shaderProgram=A,S.vertexArray=g.va,S.renderState=B?t._translucentRS:t._opaqueRS,S.pass=B?R.TRANSLUCENT:R.OPAQUE,S.debugShowBoundingVolume=!!o&&p,S.uniformMap=f(E._uniforms),S.count=M,S.offset=T,T+=M,M=0,h=!0,s.push(S)}(E=N._material).update(a),w=F}for(var k=N._locatorBuckets,z=k.length,U=0;U<z;++U){var G=k[U];G.locator===x&&(M+=G.count)}n.mode===L.SCENE3D?O=N._boundingVolumeWC:n.mode===L.COLUMBUS_VIEW?O=N._boundingVolume2D:n.mode===L.SCENE2D?l(N._boundingVolume2D)&&((O=e.clone(N._boundingVolume2D,oe)).center.x=0):l(N._boundingVolumeWC)&&l(N._boundingVolume2D)&&(O=e.union(N._boundingVolumeWC,N._boundingVolume2D,oe)),h?(h=!1,e.clone(O,ie)):e.union(O,ie,ie)}l(w)&&M>0&&(c>=u?(S=new b({owner:t}),r.push(S)):S=r[c],++c,S.boundingVolume=e.clone(ie,S.boundingVolume),S.modelMatrix=i,S.shaderProgram=A,S.vertexArray=g.va,S.renderState=E.isTranslucent()?t._translucentRS:t._opaqueRS,S.pass=E.isTranslucent()?R.TRANSLUCENT:R.OPAQUE,S.debugShowBoundingVolume=!!o&&p,S.uniformMap=f(E._uniforms),S.count=M,S.offset=T,h=!0,s.push(S)),w=void 0}r.length=c}function k(e,t,n){e._createVertexArray=!1,U(e),G(e),function(e){for(var t=e._mode,n=e._modelMatrix,r=e._polylineBuckets={},i=e._polylines,o=i.length,a=0;a<o;++a){var s=i[a];if(s._actualPositions.length>1){s.update();var u=s.material,c=r[u.type];l(c)||(c=r[u.type]=new j(u,t,n)),c.addPolyline(s)}}}(e);var r,i,o=[[]],s=o[0],u=e._batchTable,c=[0],h=0,d=[[]],f=0,_=e._polylineBuckets;for(r in _)_.hasOwnProperty(r)&&(i=_[r],i.updateShader(t,u),f+=i.lengthOfPositions);if(f>0){var g,v=e._mode,w=new Float32Array(6*f*3),b=new Float32Array(4*f),E=0,S=0,x=0;for(r in _)if(_.hasOwnProperty(r)){(i=_[r]).write(w,b,E,S,x,u,t,n),v===L.MORPHING&&(l(g)||(g=new Float32Array(6*f*3)),i.writeForMorph(g,E));var A=i.lengthOfPositions;E+=6*A*3,S+=4*A,x+=4*A,h=i.updateIndices(o,c,d,h)}var P,D=e._positionBufferUsage.bufferUsage,M=C.STATIC_DRAW;e._positionBuffer=y.createVertexBuffer({context:t,typedArray:w,usage:D}),l(g)&&(P=y.createVertexBuffer({context:t,typedArray:g,usage:D})),e._texCoordExpandAndBatchIndexBuffer=y.createVertexBuffer({context:t,typedArray:b,usage:M});for(var I=3*Float32Array.BYTES_PER_ELEMENT,O=4*Float32Array.BYTES_PER_ELEMENT,R=0,N=o.length,F=0;F<N;++F)if(s=o[F],s.length>0){var B,k,V,z,W=new Uint16Array(s),H=y.createIndexBuffer({context:t,typedArray:W,usage:C.STATIC_DRAW,indexDatatype:p.UNSIGNED_SHORT}),q=6*(F*(I*m.SIXTY_FOUR_KILOBYTES)-(R+=c[F])*I),Y=I+q,X=I+Y,Z=I+X,K=I+Z,Q=I+K,J=[{index:ee.position3DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:ee.position3DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Y,strideInBytes:6*I},{index:ee.position2DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:q,strideInBytes:6*I},{index:ee.position2DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Y,strideInBytes:6*I},{index:ee.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:X,strideInBytes:6*I},{index:ee.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Z,strideInBytes:6*I},{index:ee.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:X,strideInBytes:6*I},{index:ee.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Z,strideInBytes:6*I},{index:ee.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:K,strideInBytes:6*I},{index:ee.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Q,strideInBytes:6*I},{index:ee.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:K,strideInBytes:6*I},{index:ee.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:a.FLOAT,offsetInBytes:Q,strideInBytes:6*I},{index:ee.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:a.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:F*(O*m.SIXTY_FOUR_KILOBYTES)-R*O}];v===L.SCENE3D?(B=e._positionBuffer,k="vertexBuffer",V=ae,z="value"):v===L.SCENE2D||v===L.COLUMBUS_VIEW?(B=ae,k="value",V=e._positionBuffer,z="vertexBuffer"):(B=P,k="vertexBuffer",V=e._positionBuffer,z="vertexBuffer"),J[0][k]=B,J[1][k]=B,J[2][z]=V,J[3][z]=V,J[4][k]=B,J[5][k]=B,J[6][z]=V,J[7][z]=V,J[8][k]=B,J[9][k]=B,J[10][z]=V,J[11][z]=V;var $=new T({context:t,attributes:J,indexBuffer:H});e._vertexArrays.push({va:$,buckets:d[F]})}}}function V(e){var t=O._uniformList[e.type],n=t.length;se.length=2*n;for(var r=0,i=0;i<n;++i){var o=t[i];se[r]=o,se[r+1]=e._uniforms[o](),r+=2}return e.type+":"+JSON.stringify(se)}function z(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;for(var t=[],n=e._polylines.length,r=0,i=0;r<n;++r){var o=e._polylines[r];l(o)&&(o._index=i++,t.push(o))}e._polylines=t}}function U(e){for(var t=e._polylines,n=t.length,r=0;r<n;++r)if(l(t[r])){var i=t[r]._bucket;l(i)&&(i.shaderProgram=i.shaderProgram&&i.shaderProgram.destroy())}}function G(e){for(var t=e._vertexArrays.length,n=0;n<t;++n)e._vertexArrays[n].va.destroy();e._vertexArrays.length=0}function W(e){for(var t=e._polylines,n=t.length,r=0;r<n;++r)l(t[r])&&t[r]._destroy()}function H(e,t,n){this.count=e,this.offset=t,this.bucket=n}function j(e,t,n){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.pickShaderProgram=void 0,this.mode=t,this.modelMatrix=n}function q(e){return n.dot(n.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(g.ORIGIN_ZX_PLANE)===f.INTERSECTING}var Y=N.SHOW_INDEX,X=N.WIDTH_INDEX,Z=N.POSITION_INDEX,K=N.MATERIAL_INDEX,Q=N.POSITION_SIZE_INDEX,J=N.DISTANCE_DISPLAY_CONDITION,$=N.NUMBER_OF_PROPERTIES,ee={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};u(F.prototype,{length:{get:function(){return z(this),this._polylines.length}}}),F.prototype.add=function(e){var t=new N(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},F.prototype.remove=function(e){if(this.contains(e)){if(this._polylines[e._index]=void 0,this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,l(e._bucket)){var t=e._bucket;t.shaderProgram=t.shaderProgram&&t.shaderProgram.destroy(),t.pickShaderProgram=t.pickShaderProgram&&t.pickShaderProgram.destroy()}return e._destroy(),!0}return!1},F.prototype.removeAll=function(){U(this),W(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},F.prototype.contains=function(e){return l(e)&&e._polylineCollection===this},F.prototype.get=function(e){return z(this),this._polylines[e]};var te=new d,ne=new r,re=new t;F.prototype.update=function(e){if(z(this),0!==this._polylines.length){this._mode===(U=e.mode)&&_.equals(this._modelMatrix,this.modelMatrix)||(this._mode=U,this._modelMatrix=_.clone(this.modelMatrix),this._createVertexArray=!0);var n,i=e.context,o=e.mapProjection,s=this._propertiesChanged;if(this._createBatchTable){if(0===w.maximumVertexTextureImageUnits)throw new v("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");(function(e,t){l(e._batchTable)&&e._batchTable.destroy();var n=[{functionName:"batchTable_getWidthAndShow",componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:a.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0}];l(t.floatingPointTexture)&&n.push({functionName:"batchTable_getCenterHigh",componentDatatype:a.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:a.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:a.FLOAT,componentsPerAttribute:2}),e._batchTable=new M(n,e._polylines.length)})(this,i),this._createBatchTable=!1}if(this._createVertexArray||(F=!1,V=this._positionBufferUsage,this._propertiesChanged[Z]?V.bufferUsage!==C.STREAM_DRAW?(F=!0,V.bufferUsage=C.STREAM_DRAW,V.frameCount=100):V.frameCount=100:V.bufferUsage!==C.STATIC_DRAW&&(0===V.frameCount?(F=!0,V.bufferUsage=C.STATIC_DRAW):V.frameCount--),F))k(this,i,o);else if(this._polylinesUpdated){var u=this._polylinesToUpdate;if(this._mode!==L.SCENE3D)for(var c=u.length,h=0;h<c;++h)n=u[h],n.update();if(s[Q]||s[K])k(this,i,o);else for(var p=u.length,f=this._polylineBuckets,m=0;m<p;++m){s=(n=u[m])._propertiesChanged;var g=n._bucket,y=0;for(var b in f)if(f.hasOwnProperty(b)){if(f[b]===g){s[Z]&&g.writeUpdate(y,n,this._positionBuffer,o);break}y+=f[b].lengthOfPositions}if((s[Y]||s[X])&&this._batchTable.setBatchedAttribute(n._index,0,new t(n._width,n._show)),this._batchTable.attributes.length>2){if(s[Z]||s[Q]){var S=e.mode===L.SCENE2D?n._boundingVolume2D:n._boundingVolumeWC,x=d.fromCartesian(S.center,te),T=r.fromElements(x.low.x,x.low.y,x.low.z,S.radius,ne);this._batchTable.setBatchedAttribute(n._index,2,x.high),this._batchTable.setBatchedAttribute(n._index,3,T)}if(s[J]){var A=re;A.x=0,A.y=Number.MAX_VALUE;var P=n.distanceDisplayCondition;l(P)&&(A.x=P.near,A.x=P.far),this._batchTable.setBatchedAttribute(n._index,4,A)}}n._clean()}u.length=0,this._polylinesUpdated=!1}s=this._propertiesChanged;for(var D=0;D<$;++D)s[D]=0;var O=_.IDENTITY;e.mode===L.SCENE3D&&(O=this.modelMatrix);var R=e.passes,N=0!==e.morphTime;l(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===N||(this._opaqueRS=E.fromCache({depthMask:N,depthTest:{enabled:N}})),l(this._translucentRS)&&this._translucentRS.depthTest.enabled===N||(this._translucentRS=E.fromCache({blending:I.ALPHA_BLEND,depthMask:!N,depthTest:{enabled:N}})),this._batchTable.update(e),R.render&&B(this,e,this._colorCommands,O,!0),R.pick&&B(this,e,this._pickCommands,O,!1)}var F,V,U};var ie=new e,oe=new e;F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){return G(this),U(this),W(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),c(this)};var ae=[0,0,0],se=[];F.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},j.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},j.prototype.updateShader=function(e,t){if(!l(this.shaderProgram)){var n=[];e.floatingPointTexture&&n.push("DISTANCE_DISPLAY_CONDITION");var r=t.getVertexShaderCallback()(D),i=new x({defines:n,sources:[A,r]}),o=new x({sources:[this.material.shaderSource,P]}),a=new x({sources:o.sources,pickColorQualifier:"varying"});this.shaderProgram=S.fromCache({context:e,vertexShaderSource:i,fragmentShaderSource:o,attributeLocations:ee}),this.pickShaderProgram=S.fromCache({context:e,vertexShaderSource:i,fragmentShaderSource:a,attributeLocations:ee})}},j.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===L.SCENE3D||!q(e))return t=e._actualPositions.length,4*t-4;var n=0,r=e._segments.lengths;t=r.length;for(var i=0;i<t;++i)n+=4*r[i]-4;return n};var le=new n,ue=new n,ce=new n,he=new n,de=new r,pe=new t;j.prototype.write=function(e,t,i,a,s,u,c,h){for(var p=this.mode,f=h.ellipsoid.maximumRadius*m.PI,_=this.polylines,g=_.length,v=0;v<g;++v){for(var y,C=_[v],w=C.width,b=C.show&&w>0,E=C._index,S=this.getSegments(C,h),x=S.positions,T=S.lengths,A=x.length,P=C.getPickId(c).color,D=0,M=0,I=0;I<A;++I){0===I?C._loop?y=x[A-2]:(n.subtract(x[0],x[1],y=he),n.add(x[0],y,y)):y=x[I-1],n.clone(y,ue),n.clone(x[I],le),I===A-1?C._loop?y=x[1]:(n.subtract(x[A-1],x[A-2],y=he),n.add(x[A-1],y,y)):y=x[I+1],n.clone(y,ce);var O=T[D];I===M+O&&(M+=O,++D);var R=I-M==0,N=I===M+T[D]-1;p===L.SCENE2D&&(ue.z=0,le.z=0,ce.z=0),p!==L.SCENE2D&&p!==L.MORPHING||(R||N)&&f-Math.abs(le.x)<1&&((le.x<0&&ue.x>0||le.x>0&&ue.x<0)&&n.clone(le,ue),(le.x<0&&ce.x>0||le.x>0&&ce.x<0)&&n.clone(le,ce));for(var F=N?2:4,B=R?2:0;B<F;++B){d.writeElements(le,e,i),d.writeElements(ue,e,i+6),d.writeElements(ce,e,i+12);var k=B-2<0?-1:1;t[s]=I/(A-1),t[s+1]=B%2*2-1,t[s+2]=k,t[s+3]=E,i+=18,s+=4}}var V=de;V.x=o.floatToByte(P.red),V.y=o.floatToByte(P.green),V.z=o.floatToByte(P.blue),V.w=o.floatToByte(P.alpha);var z=pe;z.x=w,z.y=b?1:0;var U=p===L.SCENE2D?C._boundingVolume2D:C._boundingVolumeWC,G=d.fromCartesian(U.center,te),W=G.high,H=r.fromElements(G.low.x,G.low.y,G.low.z,U.radius,ne),j=re;j.x=0,j.y=Number.MAX_VALUE;var q=C.distanceDisplayCondition;l(q)&&(j.x=q.near,j.y=q.far),u.setBatchedAttribute(E,0,z),u.setBatchedAttribute(E,1,V),u.attributes.length>2&&(u.setBatchedAttribute(E,2,W),u.setBatchedAttribute(E,3,H),u.setBatchedAttribute(E,4,j))}};var fe=new n,me=new n,_e=new n,ge=new n;j.prototype.writeForMorph=function(e,t){for(var r=this.modelMatrix,i=this.polylines,o=i.length,a=0;a<o;++a)for(var s=i[a],l=s._segments.positions,u=s._segments.lengths,c=l.length,h=0,p=0,f=0;f<c;++f){var m;0===f?s._loop?m=l[c-2]:(n.subtract(l[0],l[1],m=ge),n.add(l[0],m,m)):m=l[f-1],m=_.multiplyByPoint(r,m,me);var g,v=_.multiplyByPoint(r,l[f],fe);f===c-1?s._loop?g=l[1]:(n.subtract(l[c-1],l[c-2],g=ge),n.add(l[c-1],g,g)):g=l[f+1],g=_.multiplyByPoint(r,g,_e);var y=u[h];f===p+y&&(p+=y,++h);for(var C=f===p+u[h]-1?2:4,w=f-p==0?2:0;w<C;++w)d.writeElements(v,e,t),d.writeElements(m,e,t+6),d.writeElements(g,e,t+12),t+=18}};var ve=new Array(1);j.prototype.updateIndices=function(e,t,n,r){var i=n.length-1,o=new H(0,r,this);n[i].push(o);var a=0,s=e[e.length-1],l=0;s.length>0&&(l=s[s.length-1]+1);for(var u=this.polylines,c=u.length,h=0;h<c;++h){var d,p=u[h];if(p._locatorBuckets=[],this.mode===L.SCENE3D){d=ve;var f=p._actualPositions.length;if(!(f>0))continue;d[0]=f}else d=p._segments.lengths;var _=d.length;if(_>0){for(var g=0,v=0;v<_;++v)for(var y=d[v]-1,C=0;C<y;++C)l+4>=m.SIXTY_FOUR_KILOBYTES-2&&(p._locatorBuckets.push({locator:o,count:g}),g=0,t.push(4),s=[],e.push(s),l=0,o.count=a,a=0,r=0,o=new H(0,0,this),n[++i]=[o]),s.push(l,l+2,l+1),s.push(l+1,l+2,l+3),g+=6,a+=6,r+=6,l+=4;p._locatorBuckets.push({locator:o,count:g}),l+4>=m.SIXTY_FOUR_KILOBYTES-2&&(t.push(0),e.push(s=[]),l=0,o.count=a,r=0,a=0,o=new H(0,0,this),n[++i]=[o])}p._clean()}return o.count=a,r},j.prototype.getPolylineStartIndex=function(e){for(var t=this.polylines,n=0,r=t.length,i=0;i<r;++i){var o=t[i];if(o===e)break;n+=o._actualLength}return n};var ye,Ce={positions:void 0,lengths:void 0},we=new Array(1),be=new n,Ee=new i;return j.prototype.getSegments=function(t,r){var i=t._actualPositions;if(this.mode===L.SCENE3D)return we[0]=i.length,Ce.positions=i,Ce.lengths=we,Ce;q(t)&&(i=t._segments.positions);for(var o,a=r.ellipsoid,s=[],l=this.modelMatrix,u=i.length,c=be,h=0;h<u;++h)o=i[h],c=_.multiplyByPoint(l,o,c),s.push(r.project(a.cartesianToCartographic(c,Ee)));if(s.length>0){t._boundingVolume2D=e.fromPoints(s,t._boundingVolume2D);var d=t._boundingVolume2D.center;t._boundingVolume2D.center=new n(d.z,d.x,d.y)}return Ce.positions=s,Ce.lengths=t._segments.lengths,Ce},j.prototype.writeUpdate=function(e,t,r,i){var o=this.mode,a=i.ellipsoid.maximumRadius*m.PI,s=t._actualLength;if(s){e+=this.getPolylineStartIndex(t);var u=ye,c=6*s*3;!l(u)||u.length<c?u=ye=new Float32Array(c):u.length>c&&(u=new Float32Array(u.buffer,0,c));var h,p=this.getSegments(t,i),f=p.positions,_=p.lengths,g=0,v=0,y=0;s=f.length;for(var C=0;C<s;++C){0===C?t._loop?h=f[s-2]:(n.subtract(f[0],f[1],h=he),n.add(f[0],h,h)):h=f[C-1],n.clone(h,ue),n.clone(f[C],le),C===s-1?t._loop?h=f[1]:(n.subtract(f[s-1],f[s-2],h=he),n.add(f[s-1],h,h)):h=f[C+1],n.clone(h,ce);var w=_[v];C===y+w&&(y+=w,++v);var b=C-y==0,E=C===y+_[v]-1;o===L.SCENE2D&&(ue.z=0,le.z=0,ce.z=0),o!==L.SCENE2D&&o!==L.MORPHING||(b||E)&&a-Math.abs(le.x)<1&&((le.x<0&&ue.x>0||le.x>0&&ue.x<0)&&n.clone(le,ue),(le.x<0&&ce.x>0||le.x>0&&ce.x<0)&&n.clone(le,ce));for(var S=E?2:4,x=b?2:0;x<S;++x)d.writeElements(le,u,g),d.writeElements(ue,u,g+6),d.writeElements(ce,u,g+12),g+=18}r.copyFromArrayView(u,18*Float32Array.BYTES_PER_ELEMENT*e)}},F}),o("DataSources/ScaledPositionProperty",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/ReferenceFrame","./Property"],function(e,t,n,r,i,o,a){"use strict";function s(e){this._definitionChanged=new i,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}return t(s.prototype,{isConstant:{get:function(){return a.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return e(this._value)?this._value.referenceFrame:o.FIXED}}}),s.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,o.FIXED,t)},s.prototype.setValue=function(t){this._value!==t&&(this._value=t,e(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),e(t)&&(this._removeSubscription=t.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},s.prototype.getValueInReferenceFrame=function(t,n,i){if(e(this._value))return i=this._value.getValueInReferenceFrame(t,n,i),e(i)?r.WGS84.scaleToGeodeticSurface(i,i):void 0},s.prototype.equals=function(e){return this===e||e instanceof s&&this._value===e._value},s.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)},s}),o("DataSources/PathVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/JulianDate","../Core/Matrix3","../Core/Matrix4","../Core/ReferenceFrame","../Core/TimeInterval","../Core/Transforms","../Scene/PolylineCollection","../Scene/SceneMode","./CompositePositionProperty","./ConstantPositionProperty","./MaterialProperty","./Property","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionPositionProperty"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C){"use strict";function w(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function b(e,t,r,i,a,s,l){n(l)||(l=[]);var c=function e(t,r,i,a,s,l,c,h){for(var d=t;d instanceof g||d instanceof y;)d instanceof g&&(d=d.resolvedProperty),d instanceof y&&(d=d._value);var m,_,w;return d instanceof v?function(e,t,r,i,a,s,l,u,h){var d,p=c;d=e.getValueInReferenceFrame(t,s,h[p]),n(d)&&(h[p++]=d);for(var f,m,_,g=!n(a)||o.lessThanOrEquals(a,t)||o.greaterThanOrEquals(a,r),v=0,y=i.length,C=i[v],w=r,b=!1;v<y;){if(!g&&o.greaterThanOrEquals(C,a)&&(d=e.getValueInReferenceFrame(a,s,h[p]),n(d)&&(h[p++]=d),g=!0),o.greaterThan(C,t)&&o.lessThan(C,w)&&!C.equals(a)&&(d=e.getValueInReferenceFrame(C,s,h[p]),n(d)&&(h[p++]=d)),v<y-1){if(l>0&&!b){var E=o.secondsDifference(i[v+1],C);(b=E>l)&&(f=Math.ceil(E/l),m=0,_=E/Math.max(f,2),f=Math.max(f-1,1))}if(b&&m<f){C=o.addSeconds(C,_,new o),m++;continue}}b=!1,C=i[++v]}return d=e.getValueInReferenceFrame(r,s,h[p]),n(d)&&(h[p++]=d),p}(t,r,i,d._property._times,a,s,l,0,h):d instanceof p?function(t,n,r,i,a,s,l,c){T.start=n,T.stop=r;for(var h=l,d=t.intervals,p=0;p<d.length;p++){var f=d.get(p);if(!u.intersect(f,T,x).isEmpty){var m=f.start,_=f.stop,g=n;o.greaterThan(m,g)&&(g=m);var v=r;o.lessThan(_,v)&&(v=_),h=e(f.data,g,v,i,a,s,h,c)}}return h}(t,r,i,a,s,l,c,h):d instanceof C?function(e,t,i,a,s,l,c,h){A.start=r,A.stop=i;for(var d=c,p=e.intervals,f=0;f<p.length;f++){var m=p.get(f);if(!u.intersect(m,A,x).isEmpty){var _=m.start;m.isStartIncluded||(_=m.isStopIncluded?m.stop:o.addSeconds(m.start,o.secondsDifference(m.stop,m.start)/2,new o));var g=e.getValueInReferenceFrame(_,s,h[d]);n(g)&&(h[d]=g,d++)}}return d}(t,0,i,0,s,0,c,h):d instanceof f?(w=t.getValueInReferenceFrame(r,s,(_=h)[m=c]),n(w)&&(_[m++]=w),m):function(e,t,r,i,a,s,u,h){for(var d,p=0,f=c,m=t,_=Math.max(l,60),g=!n(i)||o.lessThanOrEquals(i,t)||o.greaterThanOrEquals(i,r);o.lessThan(m,r);)!g&&o.greaterThanOrEquals(m,i)&&(g=!0,d=e.getValueInReferenceFrame(i,a,h[f]),n(d)&&(h[f]=d,f++)),d=e.getValueInReferenceFrame(m,a,h[f]),n(d)&&(h[f]=d,f++),p++,m=o.addSeconds(t,_*p,new o);return d=e.getValueInReferenceFrame(r,a,h[f]),n(d)&&(h[f]=d,f++),f}(t,r,i,a,s,0,0,h)}(e,t,r,i,a,s,0,l);return l.length=c,l}function E(e,t){this._unusedIndexes=[],this._polylineCollection=new h,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function S(t,n){n.collectionChanged.addEventListener(S.prototype._onCollectionChanged,this),this._scene=t,this._updaters={},this._entityCollection=n,this._items=new e,this._onCollectionChanged(n,n.values,[],[])}var x=new u,T=new u,A=new u,P=new a;return E.prototype.update=function(e){if(this._referenceFrame===l.INERTIAL){var r=c.computeIcrfToFixedMatrix(e,P);n(r)||(r=c.computeTemeToPseudoFixedMatrix(e,P)),s.fromRotationTranslation(r,t.ZERO,this._polylineCollection.modelMatrix)}},E.prototype.updateObject=function(e,t){var r,i,a=t.entity,s=a._path,l=a._position,u=s._show,c=t.polyline,h=a.isShowing&&(!n(u)||u.getValue(e));if(h){var d=_.getValueOrUndefined(s._leadTime,e),p=_.getValueOrUndefined(s._trailTime,e),f=a._availability,g=n(f),v=n(d),y=n(p);if(h=g||v&&y){if(y&&(r=o.addSeconds(e,-p,new o)),v&&(i=o.addSeconds(e,d,new o)),g){var C=f.start,w=f.stop;y&&!o.greaterThan(C,r)||(r=C),v&&!o.lessThan(w,i)||(i=w)}h=o.lessThan(r,i)}}if(h){if(!n(c)){var E=this._unusedIndexes;if(E.length>0){var S=E.pop();c=this._polylineCollection.get(S),t.index=S}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=a,t.polyline=c}var x=_.getValueOrDefault(s._resolution,e,60);c.show=!0,c.positions=b(l,r,i,e,this._referenceFrame,x,c.positions.slice()),c.material=m.getValue(e,s._material,c.material),c.width=_.getValueOrDefault(s._width,e,1),c.distanceDisplayCondition=_.getValueOrUndefined(s._distanceDisplayCondition,e,c.distanceDisplayCondition)}else n(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0)},E.prototype.removeObject=function(e){var t=e.polyline;n(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},E.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),r(this)},S.prototype.update=function(e){var t=this._updaters;for(var r in t)t.hasOwnProperty(r)&&t[r].update(e);for(var i=this._items.values,o=0,a=i.length;o<a;o++){var s=i[o],u=s.updater,c=l.FIXED;this._scene.mode===d.SCENE3D&&(c=s.entity._position.referenceFrame);var h=this._updaters[c];u===h&&n(h)?h.updateObject(e,s):(n(u)&&u.removeObject(s),n(h)||((h=new E(this._scene,c)).update(e),this._updaters[c]=h),s.updater=h,n(h)&&h.updateObject(e,s))}return!0},S.prototype.isDestroyed=function(){return!1},S.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(S.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();return r(this)},S.prototype._onCollectionChanged=function(e,t,r,i){var o,a,s,l=this._items;for(o=t.length-1;o>-1;o--)a=t[o],n(a._path)&&n(a._position)&&l.set(a.id,new w(a));for(o=i.length-1;o>-1;o--)a=i[o],n(a._path)&&n(a._position)?l.contains(a.id)||l.set(a.id,new w(a)):(s=l.get(a.id),n(s)&&(s.updater.removeObject(s),l.remove(a.id)));for(o=r.length-1;o>-1;o--)a=r[o],s=l.get(a.id),n(s)&&(n(s.updater)&&s.updater.removeObject(s),l.remove(a.id))},S._subSample=b,S}),o("DataSources/PointVisualizer",["../Core/AssociativeArray","../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/NearFarScalar","../Scene/HeightReference","./BoundingSphereState","./EntityCluster","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function f(t,n){n.collectionChanged.addEventListener(f.prototype._onCollectionChanged,this),this._cluster=t,this._entityCollection=n,this._items=new e,this._onCollectionChanged(n,n.values,[],[])}function m(e,t,n){if(i(e)){if(i(e.pointPrimitive))return e.pointPrimitive=void 0,void n.removePoint(t);i(e.billboard)&&(e.billboard=void 0,n.removeBillboard(t))}}function _(e,t,n,r,i){return function(o){var a=document.createElement("canvas"),s=i+2*r;a.height=a.width=s;var l=a.getContext("2d");return l.clearRect(0,0,s,s),0!==r&&(l.beginPath(),l.arc(s/2,s/2,s/2,0,2*Math.PI,!0),l.closePath(),l.fillStyle=n,l.fill(),e<1&&(l.save(),l.globalCompositeOperation="destination-out",l.beginPath(),l.arc(s/2,s/2,i/2,0,2*Math.PI,!0),l.closePath(),l.fillStyle="black",l.fill(),l.restore())),l.beginPath(),l.arc(s/2,s/2,i/2,0,2*Math.PI,!0),l.closePath(),l.fillStyle=t,l.fill(),a}}var g=n.WHITE,v=n.BLACK,y=new n,C=new t,w=new n,b=new l,E=new l,S=new s;return f.prototype.update=function(e){for(var t=this._items.values,r=this._cluster,o=0,a=t.length;o<a;o++){var s=t[o],l=s.entity,c=l._point,h=s.pointPrimitive,p=s.billboard,f=d.getValueOrDefault(c._heightReference,e,u.NONE),x=l.isShowing&&l.isAvailable(e)&&d.getValueOrDefault(c._show,e,!0);if(x&&(C=d.getValueOrUndefined(l._position,e,C),x=i(C)),x){d.isConstant(l._position)||(r._clusterDirty=!0);var T=!1;if(f===u.NONE||i(p)?f!==u.NONE||i(h)||(i(p)&&(m(s,l,r),p=void 0),(h=r.getPoint(l)).id=l,s.pointPrimitive=h):(i(h)&&(m(s,l,r),h=void 0),(p=r.getBillboard(l)).id=l,p.image=void 0,s.billboard=p,T=!0),i(h))h.show=!0,h.position=C,h.scaleByDistance=d.getValueOrUndefined(c._scaleByDistance,e,b),h.translucencyByDistance=d.getValueOrUndefined(c._translucencyByDistance,e,E),h.color=d.getValueOrDefault(c._color,e,g,y),h.outlineColor=d.getValueOrDefault(c._outlineColor,e,v,w),h.outlineWidth=d.getValueOrDefault(c._outlineWidth,e,0),h.pixelSize=d.getValueOrDefault(c._pixelSize,e,1),h.distanceDisplayCondition=d.getValueOrUndefined(c._distanceDisplayCondition,e,S);else{p.show=!0,p.position=C,p.scaleByDistance=d.getValueOrUndefined(c._scaleByDistance,e,b),p.translucencyByDistance=d.getValueOrUndefined(c._translucencyByDistance,e,E),p.distanceDisplayCondition=d.getValueOrUndefined(c._distanceDisplayCondition,e,S),p.heightReference=f;var A=d.getValueOrDefault(c._color,e,g,y),P=d.getValueOrDefault(c._outlineColor,e,v,w),D=Math.round(d.getValueOrDefault(c._outlineWidth,e,0)),M=Math.max(1,Math.round(d.getValueOrDefault(c._pixelSize,e,1)));if(D>0?(p.scale=1,T=T||D!==s.outlineWidth||M!==s.pixelSize||!n.equals(A,s.color)||!n.equals(P,s.outlineColor)):(p.scale=M/50,M=50,T=T||D!==s.outlineWidth||!n.equals(A,s.color)||!n.equals(P,s.outlineColor)),T){s.color=n.clone(A,s.color),s.outlineColor=n.clone(P,s.outlineColor),s.pixelSize=M,s.outlineWidth=D;var I=A.alpha,O=A.toCssColorString(),R=P.toCssColorString(),N=JSON.stringify([O,M,R,D]);p.setImage(N,_(I,O,R,D,M))}}}else m(s,l,r)}return!0},f.prototype.getBoundingSphere=function(e,n){var r=this._items.get(e.id);if(!i(r)||!i(r.pointPrimitive)&&!i(r.billboard))return c.FAILED;if(i(r.pointPrimitive))n.center=t.clone(r.pointPrimitive.position,n.center);else{var o=r.billboard;if(!i(o._clampedPosition))return c.PENDING;n.center=t.clone(o._clampedPosition,n.center)}return n.radius=0,c.DONE},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(f.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return o(this)},f.prototype._onCollectionChanged=function(e,t,n,r){var o,a,s=this._items,l=this._cluster;for(o=t.length-1;o>-1;o--)a=t[o],i(a._point)&&i(a._position)&&s.set(a.id,new p(a));for(o=r.length-1;o>-1;o--)a=r[o],i(a._point)&&i(a._position)?s.contains(a.id)||s.set(a.id,new p(a)):(m(s.get(a.id),a,l),s.remove(a.id));for(o=n.length-1;o>-1;o--)a=n[o],m(s.get(a.id),a,l),s.remove(a.id)},f}),o("DataSources/PolygonGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/isArray","../Core/Iso8601","../Core/oneTimeWarning","../Core/PolygonGeometry","../Core/PolygonHierarchy","../Core/PolygonOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A){"use strict";function P(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0}function D(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(D.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new u,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new P(e),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function M(e,t,n){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=n,this._options=new P(n._entity)}var I=new E(e.WHITE),O=new S(!0),R=new S(!0),N=new S(!1),L=new S(e.BLACK),F=new S(b.DISABLED),B=new S(new s),k=new e;return i(D,{perInstanceColorAppearanceType:{value:C},materialAppearanceType:{value:y}}),i(D.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&A.isConstant(this._showProperty)&&A.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&A.isConstant(this._showProperty)&&A.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),D.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},D.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},D.prototype.createFillGeometryInstance=function(n){var i,o=this._entity,a=o.isAvailable(n),s=new g(a&&o.isShowing&&this._showProperty.getValue(n)&&this._fillProperty.getValue(n)),u=this._distanceDisplayConditionProperty.getValue(n),h=l.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof E){var d=e.WHITE;r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(d=this._materialProperty.color.getValue(n)),i={show:s,distanceDisplayCondition:h,color:t.fromColor(d)}}else i={show:s,distanceDisplayCondition:h};return new c({id:o,geometry:new f(this._options),attributes:i})},D.prototype.createOutlineGeometryInstance=function(n){var r=this._entity,i=r.isAvailable(n),o=A.getValueOrDefault(this._outlineColorProperty,n,e.BLACK),a=this._distanceDisplayConditionProperty.getValue(n);return new c({id:r,geometry:new _(this._options),attributes:{show:new g(i&&r.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(a)}})},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){this._entitySubscription(),o(this)},D.prototype._onEntityPropertyChanged=function(e,t,i,o){if("availability"===t||"polygon"===t){var a=this._entity.polygon;if(!r(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(d.MINIMUM_VALUE),u=a.perPositionHeight,c=r(u)&&(!u.isConstant||u.getValue(d.MINIMUM_VALUE)),f=a.outline,_=r(f);if(_&&f.isConstant&&(_=f.getValue(d.MINIMUM_VALUE)),!l&&!_)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var g=a.hierarchy,w=a.show;if(r(w)&&w.isConstant&&!w.getValue(d.MINIMUM_VALUE)||!r(g))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var b=n(a.material,I),S=b instanceof E;this._materialProperty=b,this._fillProperty=n(s,R),this._showProperty=n(w,O),this._showOutlineProperty=n(a.outline,N),this._outlineColorProperty=_?n(a.outlineColor,L):void 0,this._shadowsProperty=n(a.shadows,F),this._distanceDisplayConditionProperty=n(a.distanceDisplayCondition,B);var x=a.height,T=a.extrudedHeight,P=a.granularity,D=a.stRotation,M=a.outlineWidth,k=l&&!r(x)&&!r(T)&&S&&!c&&v.isSupported(this._scene);_&&k&&(p(p.geometryOutlines),_=!1);var V=a.perPositionHeight,z=a.closeTop,U=a.closeBottom;if(this._fillEnabled=l,this._onTerrain=k,this._outlineEnabled=_,g.isConstant&&A.isConstant(x)&&A.isConstant(T)&&A.isConstant(P)&&A.isConstant(D)&&A.isConstant(M)&&A.isConstant(u)&&A.isConstant(V)&&A.isConstant(z)&&A.isConstant(U)&&(!k||A.isConstant(b))){var G=this._options;G.vertexFormat=S?C.VERTEX_FORMAT:y.MaterialSupport.TEXTURED.vertexFormat;var W=g.getValue(d.MINIMUM_VALUE);h(W)&&(W=new m(W));var H=A.getValueOrUndefined(x,d.MINIMUM_VALUE),j=A.getValueOrDefault(z,d.MINIMUM_VALUE,!0),q=A.getValueOrDefault(U,d.MINIMUM_VALUE,!0),Y=A.getValueOrUndefined(T,d.MINIMUM_VALUE);G.polygonHierarchy=W,G.height=H,G.extrudedHeight=Y,G.granularity=A.getValueOrUndefined(P,d.MINIMUM_VALUE),G.stRotation=A.getValueOrUndefined(D,d.MINIMUM_VALUE),G.perPositionHeight=A.getValueOrUndefined(V,d.MINIMUM_VALUE),G.closeTop=j,G.closeBottom=q,this._outlineWidth=A.getValueOrDefault(M,d.MINIMUM_VALUE,1),this._isClosed=r(Y)&&Y!==H&&j&&q,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},D.prototype.createDynamicUpdater=function(e,t){return new M(e,t,this)},M.prototype.update=function(n){var i=this._geometryUpdater,o=i._onTerrain,a=this._primitives,s=this._groundPrimitives;o?s.removeAndDestroy(this._primitive):(a.removeAndDestroy(this._primitive),a.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var l=i._entity,u=l.polygon;if(l.isShowing&&l.isAvailable(n)&&A.getValueOrDefault(u.show,n,!0)){var d=this._options,p=A.getValueOrUndefined(u.hierarchy,n);if(r(p)){d.polygonHierarchy=h(p)?new m(p):p;var g=A.getValueOrDefault(u.closeTop,n,!0),b=A.getValueOrDefault(u.closeBottom,n,!0);d.height=A.getValueOrUndefined(u.height,n),d.extrudedHeight=A.getValueOrUndefined(u.extrudedHeight,n),d.granularity=A.getValueOrUndefined(u.granularity,n),d.stRotation=A.getValueOrUndefined(u.stRotation,n),d.perPositionHeight=A.getValueOrUndefined(u.perPositionHeight,n),d.closeTop=g,d.closeBottom=b;var E=this._geometryUpdater.shadowsProperty.getValue(n);if(A.getValueOrDefault(u.fill,n,!0)){var S=i.fillMaterialProperty,x=T.getValue(n,S,this._material);if(this._material=x,o){var P=e.WHITE;r(S.color)&&(P=S.color.getValue(n)),this._primitive=s.add(new v({geometryInstances:new c({id:l,geometry:new f(d),attributes:{color:t.fromColor(P)}}),asynchronous:!1,shadows:E}))}else{var D=new y({material:x,translucent:x.isTranslucent(),closed:r(d.extrudedHeight)&&d.extrudedHeight!==d.height&&g&&b});d.vertexFormat=D.vertexFormat,this._primitive=a.add(new w({geometryInstances:new c({id:l,geometry:new f(d)}),appearance:D,asynchronous:!1,shadows:E}))}}if(!o&&A.getValueOrDefault(u.outline,n,!1)){d.vertexFormat=C.VERTEX_FORMAT;var M=A.getValueOrClonedDefault(u.outlineColor,n,e.BLACK,k),I=A.getValueOrDefault(u.outlineWidth,n,1),O=1!==M.alpha;this._outlinePrimitive=a.add(new w({geometryInstances:new c({id:l,geometry:new _(d),attributes:{color:t.fromColor(M)}}),appearance:new C({flat:!0,translucent:O,renderState:{lineWidth:i._scene.clampLineWidth(I)}}),asynchronous:!1,shadows:E}))}}}},M.prototype.getBoundingSphere=function(e,t){return x(e,this._primitive,this._outlinePrimitive,t)},M.prototype.isDestroyed=function(){return!1},M.prototype.destroy=function(){var e=this._primitives;this._geometryUpdater._onTerrain?this._groundPrimitives.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),o(this)},D}),o("Shaders/Appearances/PolylineColorAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"}),o("Scene/PolylineColorAppearance",["../Core/defaultValue","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PerInstanceFlatColorAppearanceFS","../Shaders/Appearances/PolylineColorAppearanceVS","../Shaders/PolylineCommon","./Appearance"],function(e,t,n,r,i,o,a){"use strict";function s(t){t=e(t,e.EMPTY_OBJECT);var n=e(t.translucent,!0),r=s.VERTEX_FORMAT;this.material=void 0,this.translucent=n,this._vertexShaderSource=e(t.vertexShaderSource,l),this._fragmentShaderSource=e(t.fragmentShaderSource,u),this._renderState=a.getDefaultRenderState(n,!1,t.renderState),this._closed=!1,this._vertexFormat=r}var l=o+"\n"+i,u=r;return t(s.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),s.VERTEX_FORMAT=n.POSITION_ONLY,s.prototype.getFragmentShaderSource=a.prototype.getFragmentShaderSource,s.prototype.isTranslucent=a.prototype.isTranslucent,s.prototype.getRenderState=a.prototype.getRenderState,s}),o("Shaders/Appearances/PolylineMaterialAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev);\ngl_Position = czm_viewportOrthographic * positionWC;\n}\n"}),o("Scene/PolylineMaterialAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PolylineMaterialAppearanceVS","../Shaders/PolylineCommon","../Shaders/PolylineFS","./Appearance","./Material"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.translucent,!0),i=u.VERTEX_FORMAT;this.material=t(n.material)?n.material:l.fromType(l.ColorType),this.translucent=r,this._vertexShaderSource=e(n.vertexShaderSource,c),this._fragmentShaderSource=e(n.fragmentShaderSource,h),this._renderState=s.getDefaultRenderState(r,!1,n.renderState),this._closed=!1,this._vertexFormat=i}var c=o+"\n"+i,h=a;return n(u.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),u.VERTEX_FORMAT=r.POSITION_AND_ST,u.prototype.getFragmentShaderSource=s.prototype.getFragmentShaderSource,u.prototype.isTranslucent=s.prototype.isTranslucent,u.prototype.getRenderState=s.prototype.getRenderState,u}),o("DataSources/PolylineGeometryUpdater",["../Core/BoundingSphere","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Ellipsoid","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineGeometry","../Core/PolylinePipeline","../Core/ShowGeometryInstanceAttribute","../Scene/PolylineCollection","../Scene/PolylineColorAppearance","../Scene/PolylineMaterialAppearance","../Scene/ShadowMode","./BoundingSphereState","./ColorMaterialProperty","./ConstantProperty","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(T.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new h,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new function(t){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.followSurface=void 0,this.granularity=void 0}(0),this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}function A(e,t){var n=t._scene.id,r=P[n];!i(r)||r.isDestroyed()?(r=new g,P[n]=r,e.add(r)):e.contains(r)||e.add(r);var o=r.add();o.id=t._entity,this._line=o,this._primitives=e,this._geometryUpdater=t,this._positions=[],R.ellipsoid=t._scene.globe.ellipsoid}var P={},D=new b(t.WHITE),M=new E(!0),I=new E(C.DISABLED),O=new E(new l);o(T,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:y}}),o(T.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!i(this._entity.availability)&&x.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}}}),T.prototype.isOutlineVisible=function(e){return!1},T.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)},T.prototype.createFillGeometryInstance=function(e){var r,o=this._entity,a=o.isAvailable(e),s=new _(a&&o.isShowing&&this._showProperty.getValue(e)),l=this._distanceDisplayConditionProperty.getValue(e),c=u.fromDistanceDisplayCondition(l);if(this._materialProperty instanceof b){var h=t.WHITE;i(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(h=this._materialProperty.color.getValue(e)),r={show:s,distanceDisplayCondition:c,color:n.fromColor(h)}}else r={show:s,distanceDisplayCondition:c};return new d({id:o,geometry:new f(this._options),attributes:r})},T.prototype.createOutlineGeometryInstance=function(e){},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){this._entitySubscription(),a(this)},T.prototype._onEntityPropertyChanged=function(e,t,n,o){if("availability"===t||"polyline"===t){var a=this._entity.polyline;if(!i(a))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.positions,l=a.show;if(i(l)&&l.isConstant&&!l.getValue(p.MINIMUM_VALUE)||!i(s))return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));var u=r(a.material,D),c=u instanceof b;this._materialProperty=u,this._showProperty=r(l,M),this._shadowsProperty=r(a.shadows,I),this._distanceDisplayConditionProperty=r(a.distanceDisplayCondition,O),this._fillEnabled=!0;var h=a.width,d=a.followSurface,f=a.granularity;if(s.isConstant&&x.isConstant(h)&&x.isConstant(d)&&x.isConstant(f)){var m=this._options,_=s.getValue(p.MINIMUM_VALUE,m.positions);if(!i(_)||_.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));m.vertexFormat=c?v.VERTEX_FORMAT:y.VERTEX_FORMAT,m.positions=_,m.width=i(h)?h.getValue(p.MINIMUM_VALUE):void 0,m.followSurface=i(d)?d.getValue(p.MINIMUM_VALUE):void 0,m.granularity=i(f)?f.getValue(p.MINIMUM_VALUE):void 0,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},T.prototype.createDynamicUpdater=function(e){return new A(e,this)};var R={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};return A.prototype.update=function(e){var t=this._geometryUpdater,n=t._entity,r=n.polyline,o=this._line;if(n.isShowing&&n.isAvailable(e)&&x.getValueOrDefault(r._show,e,!0)){var a=x.getValueOrUndefined(r.positions,e,this._positions);!i(a)||a.length<2?o.show=!1:(x.getValueOrDefault(r._followSurface,e,!0)&&(R.positions=a,R.granularity=x.getValueOrUndefined(r._granularity,e),R.height=m.extractHeights(a,this._geometryUpdater._scene.globe.ellipsoid),a=m.generateCartesianArc(R)),o.show=!0,o.positions=a.slice(),o.material=S.getValue(e,t.fillMaterialProperty,o.material),o.width=x.getValueOrDefault(r._width,e,1),o.distanceDisplayCondition=x.getValueOrUndefined(r._distanceDisplayCondition,e,o.distanceDisplayCondition))}else o.show=!1},A.prototype.getBoundingSphere=function(t,n){var r=this._line;return r.show&&r.positions.length>0?(e.fromPoints(r.positions,n),w.DONE):w.FAILED},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){var e=this._geometryUpdater._scene.id,t=P[e];t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete P[e]),a(this)},T}),o("DataSources/PolylineVolumeGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/PolylineVolumeGeometry","../Core/PolylineVolumeOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E){"use strict";function S(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function x(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(x.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new u,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new S(e),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function T(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new S(t._entity)}var A=new y(e.WHITE),P=new C(!0),D=new C(!0),M=new C(!1),I=new C(e.BLACK),O=new C(v.DISABLED),R=new C(new s),N=new e;return i(x,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:m}}),i(x.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!0},geometryChanged:{get:function(){return this._geometryChanged}}}),x.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},x.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},x.prototype.createFillGeometryInstance=function(n){var i,o=this._entity,a=o.isAvailable(n),s=new f(a&&o.isShowing&&this._showProperty.getValue(n)&&this._fillProperty.getValue(n)),u=this._distanceDisplayConditionProperty.getValue(n),h=l.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof y){var p=e.WHITE;r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(p=this._materialProperty.color.getValue(n)),i={show:s,distanceDisplayCondition:h,color:t.fromColor(p)}}else i={show:s,distanceDisplayCondition:h};return new c({id:o,geometry:new d(this._options),attributes:i})},x.prototype.createOutlineGeometryInstance=function(n){var r=this._entity,i=r.isAvailable(n),o=E.getValueOrDefault(this._outlineColorProperty,n,e.BLACK),a=this._distanceDisplayConditionProperty.getValue(n);return new c({id:r,geometry:new p(this._options),attributes:{show:new f(i&&r.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(a)}})},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){this._entitySubscription(),o(this)},x.prototype._onEntityPropertyChanged=function(e,t,i,o){if("availability"===t||"polylineVolume"===t){var a=this._entity.polylineVolume;if(!r(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(h.MINIMUM_VALUE),u=a.outline,c=r(u);if(c&&u.isConstant&&(c=u.getValue(h.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var d=a.positions,p=a.shape,f=a.show;if(!r(d)||!r(p)||r(f)&&f.isConstant&&!f.getValue(h.MINIMUM_VALUE))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var g=n(a.material,A),v=g instanceof y;this._materialProperty=g,this._fillProperty=n(s,D),this._showProperty=n(f,P),this._showOutlineProperty=n(a.outline,M),this._outlineColorProperty=c?n(a.outlineColor,I):void 0,this._shadowsProperty=n(a.shadows,O),this._distanceDisplayConditionProperty=n(a.distanceDisplayCondition,R);var C=a.granularity,w=a.outlineWidth,b=a.cornerType;if(this._fillEnabled=l,this._outlineEnabled=c,d.isConstant&&p.isConstant&&E.isConstant(C)&&E.isConstant(w)&&E.isConstant(b)){var S=this._options;S.vertexFormat=v?_.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat,S.polylinePositions=d.getValue(h.MINIMUM_VALUE,S.polylinePositions),S.shapePositions=p.getValue(h.MINIMUM_VALUE,S.shape),S.granularity=r(C)?C.getValue(h.MINIMUM_VALUE):void 0,S.cornerType=r(b)?b.getValue(h.MINIMUM_VALUE):void 0,this._outlineWidth=r(w)?w.getValue(h.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},x.prototype.createDynamicUpdater=function(e){return new T(e,this)},T.prototype.update=function(n){var i=this._primitives;i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var o=this._geometryUpdater,a=o._entity,s=a.polylineVolume;if(a.isShowing&&a.isAvailable(n)&&E.getValueOrDefault(s.show,n,!0)){var l=this._options,u=E.getValueOrUndefined(s.positions,n,l.polylinePositions),h=E.getValueOrUndefined(s.shape,n);if(r(u)&&r(h)){l.polylinePositions=u,l.shapePositions=h,l.granularity=E.getValueOrUndefined(s.granularity,n),l.cornerType=E.getValueOrUndefined(s.cornerType,n);var f=this._geometryUpdater.shadowsProperty.getValue(n);if(!r(s.fill)||s.fill.getValue(n)){var v=b.getValue(n,o.fillMaterialProperty,this._material);this._material=v;var y=new m({material:v,translucent:v.isTranslucent(),closed:!0});l.vertexFormat=y.vertexFormat,this._primitive=i.add(new g({geometryInstances:new c({id:a,geometry:new d(l)}),appearance:y,asynchronous:!1,shadows:f}))}if(r(s.outline)&&s.outline.getValue(n)){l.vertexFormat=_.VERTEX_FORMAT;var C=E.getValueOrClonedDefault(s.outlineColor,n,e.BLACK,N),w=E.getValueOrDefault(s.outlineWidth,n,1),S=1!==C.alpha;this._outlinePrimitive=i.add(new g({geometryInstances:new c({id:a,geometry:new p(l),attributes:{color:t.fromColor(C)}}),appearance:new _({flat:!0,translucent:S,renderState:{lineWidth:o._scene.clampLineWidth(w)}}),asynchronous:!1,shadows:f}))}}}},T.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),o(this)},x}),o("DataSources/RectangleGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/oneTimeWarning","../Core/RectangleGeometry","../Core/RectangleOutlineGeometry","../Core/ShowGeometryInstanceAttribute","../Scene/GroundPrimitive","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x){"use strict";function T(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.closeBottom=void 0,this.closeTop=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0}function A(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(A.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._isClosed=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new u,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._onTerrain=!1,this._options=new T(e),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function P(e,t,n){this._primitives=e,this._groundPrimitives=t,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=n,this._options=new T(n._entity)}var D=new w(e.WHITE),M=new b(!0),I=new b(!0),O=new b(!1),R=new b(e.BLACK),N=new b(C.DISABLED),L=new b(new s),F=new e;return i(A,{perInstanceColorAppearanceType:{value:v},materialAppearanceType:{value:g}}),i(A.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&x.isConstant(this._showProperty)&&x.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),A.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},A.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},A.prototype.createFillGeometryInstance=function(n){var i,o=this._entity,a=o.isAvailable(n),s=new m(a&&o.isShowing&&this._showProperty.getValue(n)&&this._fillProperty.getValue(n)),u=this._distanceDisplayConditionProperty.getValue(n),h=l.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof w){var d=e.WHITE;r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(d=this._materialProperty.color.getValue(n)),i={show:s,distanceDisplayCondition:h,color:t.fromColor(d)}}else i={show:s,distanceDisplayCondition:h};return new c({id:o,geometry:new p(this._options),attributes:i})},A.prototype.createOutlineGeometryInstance=function(n){var r=this._entity,i=r.isAvailable(n),o=x.getValueOrDefault(this._outlineColorProperty,n,e.BLACK),a=this._distanceDisplayConditionProperty.getValue(n);return new c({id:r,geometry:new f(this._options),attributes:{show:new m(i&&r.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(a)}})},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._entitySubscription(),o(this)},A.prototype._onEntityPropertyChanged=function(e,t,i,o){if("availability"===t||"rectangle"===t){var a=this._entity.rectangle;if(!r(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(h.MINIMUM_VALUE),u=a.outline,c=r(u);if(c&&u.isConstant&&(c=u.getValue(h.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var p=a.coordinates,f=a.show;if(r(f)&&f.isConstant&&!f.getValue(h.MINIMUM_VALUE)||!r(p))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var m=n(a.material,D),y=m instanceof w;this._materialProperty=m,this._fillProperty=n(s,I),this._showProperty=n(f,M),this._showOutlineProperty=n(a.outline,O),this._outlineColorProperty=c?n(a.outlineColor,R):void 0,this._shadowsProperty=n(a.shadows,N),this._distanceDisplayConditionProperty=n(a.distanceDisplayCondition,L);var C=a.height,b=a.extrudedHeight,E=a.granularity,S=a.stRotation,T=a.rotation,A=a.outlineWidth,P=a.closeBottom,F=a.closeTop,B=l&&!r(C)&&!r(b)&&y&&_.isSupported(this._scene);if(c&&B&&(d(d.geometryOutlines),c=!1),this._fillEnabled=l,this._onTerrain=B,this._outlineEnabled=c,p.isConstant&&x.isConstant(C)&&x.isConstant(b)&&x.isConstant(E)&&x.isConstant(S)&&x.isConstant(T)&&x.isConstant(A)&&x.isConstant(P)&&x.isConstant(F)&&(!B||x.isConstant(m))){var k=this._options;k.vertexFormat=y?v.VERTEX_FORMAT:g.MaterialSupport.TEXTURED.vertexFormat,k.rectangle=p.getValue(h.MINIMUM_VALUE,k.rectangle),k.height=r(C)?C.getValue(h.MINIMUM_VALUE):void 0,k.extrudedHeight=r(b)?b.getValue(h.MINIMUM_VALUE):void 0,k.granularity=r(E)?E.getValue(h.MINIMUM_VALUE):void 0,k.stRotation=r(S)?S.getValue(h.MINIMUM_VALUE):void 0,k.rotation=r(T)?T.getValue(h.MINIMUM_VALUE):void 0,k.closeBottom=r(P)?P.getValue(h.MINIMUM_VALUE):void 0,k.closeTop=r(F)?F.getValue(h.MINIMUM_VALUE):void 0,this._isClosed=r(b)&&r(k.closeTop)&&r(k.closeBottom)&&k.closeTop&&k.closeBottom,this._outlineWidth=r(A)?A.getValue(h.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},A.prototype.createDynamicUpdater=function(e,t){return new P(e,t,this)},P.prototype.update=function(n){var i=this._geometryUpdater,o=i._onTerrain,a=this._primitives,s=this._groundPrimitives;o?s.removeAndDestroy(this._primitive):(a.removeAndDestroy(this._primitive),a.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var l=i._entity,u=l.rectangle;if(l.isShowing&&l.isAvailable(n)&&x.getValueOrDefault(u.show,n,!0)){var h=this._options,d=x.getValueOrUndefined(u.coordinates,n,h.rectangle);if(r(d)){h.rectangle=d,h.height=x.getValueOrUndefined(u.height,n),h.extrudedHeight=x.getValueOrUndefined(u.extrudedHeight,n),h.granularity=x.getValueOrUndefined(u.granularity,n),h.stRotation=x.getValueOrUndefined(u.stRotation,n),h.rotation=x.getValueOrUndefined(u.rotation,n),h.closeBottom=x.getValueOrUndefined(u.closeBottom,n),h.closeTop=x.getValueOrUndefined(u.closeTop,n);var m=this._geometryUpdater.shadowsProperty.getValue(n);if(x.getValueOrDefault(u.fill,n,!0)){var C=i.fillMaterialProperty,w=S.getValue(n,C,this._material);if(this._material=w,o){var b=e.WHITE;r(C.color)&&(b=C.color.getValue(n)),this._primitive=s.add(new _({geometryInstances:new c({id:l,geometry:new p(h),attributes:{color:t.fromColor(b)}}),asynchronous:!1,shadows:m}))}else{var E=new g({material:w,translucent:w.isTranslucent(),closed:r(h.extrudedHeight)});h.vertexFormat=E.vertexFormat,this._primitive=a.add(new y({geometryInstances:new c({id:l,geometry:new p(h)}),appearance:E,asynchronous:!1,shadows:m}))}}if(!o&&x.getValueOrDefault(u.outline,n,!1)){h.vertexFormat=v.VERTEX_FORMAT;var T=x.getValueOrClonedDefault(u.outlineColor,n,e.BLACK,F),A=x.getValueOrDefault(u.outlineWidth,n,1),P=1!==T.alpha;this._outlinePrimitive=a.add(new y({geometryInstances:new c({id:l,geometry:new f(h),attributes:{color:t.fromColor(T)}}),appearance:new v({flat:!0,translucent:P,renderState:{lineWidth:i._scene.clampLineWidth(A)}}),asynchronous:!1,shadows:m}))}}}},P.prototype.getBoundingSphere=function(e,t){return E(e,this._primitive,this._outlinePrimitive,t)},P.prototype.isDestroyed=function(){return!1},P.prototype.destroy=function(){var e=this._primitives;this._geometryUpdater._onTerrain?this._groundPrimitives.removeAndDestroy(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),o(this)},A}),o("DataSources/WallGeometryUpdater",["../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/DistanceDisplayCondition","../Core/DistanceDisplayConditionGeometryInstanceAttribute","../Core/Event","../Core/GeometryInstance","../Core/Iso8601","../Core/ShowGeometryInstanceAttribute","../Core/WallGeometry","../Core/WallOutlineGeometry","../Scene/MaterialAppearance","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../Scene/ShadowMode","./ColorMaterialProperty","./ConstantProperty","./dynamicGeometryGetBoundingSphere","./MaterialProperty","./Property"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E){"use strict";function S(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function x(e,t){this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(x.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new u,this._showProperty=void 0,this._materialProperty=void 0,this._hasConstantOutline=!0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._options=new S(e),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function T(e,t){this._primitives=e,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=t,this._options=new S(t._entity)}var A=new y(e.WHITE),P=new C(!0),D=new C(!0),M=new C(!1),I=new C(e.BLACK),O=new C(v.DISABLED),R=new C(new s),N=new e;return i(x,{perInstanceColorAppearanceType:{value:_},materialAppearanceType:{value:m}}),i(x.prototype,{entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!r(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!r(this._entity.availability)&&E.isConstant(this._showProperty)&&E.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return!1}},geometryChanged:{get:function(){return this._geometryChanged}}}),x.prototype.isOutlineVisible=function(e){return this._outlineEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)},x.prototype.isFilled=function(e){return this._fillEnabled&&this._entity.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)},x.prototype.createFillGeometryInstance=function(n){var i,o=this._entity,a=o.isAvailable(n),s=new d(a&&o.isShowing&&this._showProperty.getValue(n)&&this._fillProperty.getValue(n)),u=this._distanceDisplayConditionProperty.getValue(n),h=l.fromDistanceDisplayCondition(u);if(this._materialProperty instanceof y){var f=e.WHITE;r(this._materialProperty.color)&&(this._materialProperty.color.isConstant||a)&&(f=this._materialProperty.color.getValue(n)),i={show:s,distanceDisplayCondition:h,color:t.fromColor(f)}}else i={show:s,distanceDisplayCondition:h};return new c({id:o,geometry:new p(this._options),attributes:i})},x.prototype.createOutlineGeometryInstance=function(n){var r=this._entity,i=r.isAvailable(n),o=E.getValueOrDefault(this._outlineColorProperty,n,e.BLACK),a=this._distanceDisplayConditionProperty.getValue(n);return new c({id:r,geometry:new f(this._options),attributes:{show:new d(i&&r.isShowing&&this._showProperty.getValue(n)&&this._showOutlineProperty.getValue(n)),color:t.fromColor(o),distanceDisplayCondition:l.fromDistanceDisplayCondition(a)}})},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){this._entitySubscription(),o(this)},x.prototype._onEntityPropertyChanged=function(e,t,i,o){if("availability"===t||"wall"===t){var a=this._entity.wall;if(!r(a))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var s=a.fill,l=!r(s)||!s.isConstant||s.getValue(h.MINIMUM_VALUE),u=a.outline,c=r(u);if(c&&u.isConstant&&(c=u.getValue(h.MINIMUM_VALUE)),!l&&!c)return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var d=a.positions,p=a.show;if(r(p)&&p.isConstant&&!p.getValue(h.MINIMUM_VALUE)||!r(d))return void((this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this)));var f=n(a.material,A),g=f instanceof y;this._materialProperty=f,this._fillProperty=n(s,D),this._showProperty=n(p,P),this._showOutlineProperty=n(a.outline,M),this._outlineColorProperty=c?n(a.outlineColor,I):void 0,this._shadowsProperty=n(a.shadows,O),this._distanceDisplayConditionProperty=n(a.distanceDisplayCondition,R);var v=a.minimumHeights,C=a.maximumHeights,w=a.outlineWidth,b=a.granularity;if(this._fillEnabled=l,this._outlineEnabled=c,d.isConstant&&E.isConstant(v)&&E.isConstant(C)&&E.isConstant(w)&&E.isConstant(b)){var S=this._options;S.vertexFormat=g?_.VERTEX_FORMAT:m.MaterialSupport.TEXTURED.vertexFormat,S.positions=d.getValue(h.MINIMUM_VALUE,S.positions),S.minimumHeights=r(v)?v.getValue(h.MINIMUM_VALUE,S.minimumHeights):void 0,S.maximumHeights=r(C)?C.getValue(h.MINIMUM_VALUE,S.maximumHeights):void 0,S.granularity=r(b)?b.getValue(h.MINIMUM_VALUE):void 0,this._outlineWidth=r(w)?w.getValue(h.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}},x.prototype.createDynamicUpdater=function(e){return new T(e,this)},T.prototype.update=function(n){var i=this._primitives;i.removeAndDestroy(this._primitive),i.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0;var o=this._geometryUpdater,a=o._entity,s=a.wall;if(a.isShowing&&a.isAvailable(n)&&E.getValueOrDefault(s.show,n,!0)){var l=this._options,u=E.getValueOrUndefined(s.positions,n,l.positions);if(r(u)){l.positions=u,l.minimumHeights=E.getValueOrUndefined(s.minimumHeights,n,l.minimumHeights),l.maximumHeights=E.getValueOrUndefined(s.maximumHeights,n,l.maximumHeights),l.granularity=E.getValueOrUndefined(s.granularity,n);var h=this._geometryUpdater.shadowsProperty.getValue(n);if(E.getValueOrDefault(s.fill,n,!0)){var d=b.getValue(n,o.fillMaterialProperty,this._material);this._material=d;var v=new m({material:d,translucent:d.isTranslucent(),closed:r(l.extrudedHeight)});l.vertexFormat=v.vertexFormat,this._primitive=i.add(new g({geometryInstances:new c({id:a,geometry:new p(l)}),appearance:v,asynchronous:!1,shadows:h}))}if(E.getValueOrDefault(s.outline,n,!1)){l.vertexFormat=_.VERTEX_FORMAT;var y=E.getValueOrClonedDefault(s.outlineColor,n,e.BLACK,N),C=E.getValueOrDefault(s.outlineWidth,n,1),w=1!==y.alpha;this._outlinePrimitive=i.add(new g({geometryInstances:new c({id:a,geometry:new f(l),attributes:{color:t.fromColor(y)}}),appearance:new _({flat:!0,translucent:w,renderState:{lineWidth:o._scene.clampLineWidth(C)}}),asynchronous:!1,shadows:h}))}}}},T.prototype.getBoundingSphere=function(e,t){return w(e,this._primitive,this._outlinePrimitive,t)},T.prototype.isDestroyed=function(){return!1},T.prototype.destroy=function(){var e=this._primitives;e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),o(this)},x}),o("DataSources/DataSourceDisplay",["../Core/BoundingSphere","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EventHelper","../Scene/GroundPrimitive","./BillboardVisualizer","./BoundingSphereState","./BoxGeometryUpdater","./CorridorGeometryUpdater","./CustomDataSource","./CylinderGeometryUpdater","./EllipseGeometryUpdater","./EllipsoidGeometryUpdater","./EntityCluster","./GeometryVisualizer","./LabelVisualizer","./ModelVisualizer","./PathVisualizer","./PointVisualizer","./PolygonGeometryUpdater","./PolylineGeometryUpdater","./PolylineVolumeGeometryUpdater","./RectangleGeometryUpdater","./WallGeometryUpdater"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T){"use strict";function A(e){s.initializeTerrainHeights();var n=e.scene,r=e.dataSourceCollection;this._eventHelper=new a,this._eventHelper.add(r.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(r.dataSourceRemoved,this._onDataSourceRemoved,this),this._dataSourceCollection=r,this._scene=n,this._visualizersCallback=t(e.visualizersCallback,A.defaultVisualizersCallback);for(var i=0,o=r.length;i<o;i++)this._onDataSourceAdded(r,r.get(i));var l=new d;this._onDataSourceAdded(void 0,l),this._defaultDataSource=l,this._ready=!1}A.defaultVisualizersCallback=function(e,t,n){var r=n.entities;return[new l(t,r),new g(c,e,r),new g(p,e,r),new g(h,e,r),new g(f,e,r),new g(m,e,r),new g(b,e,r),new g(E,e,r),new g(S,e,r),new g(x,e,r),new g(T,e,r),new v(t,r),new y(e,r),new w(t,r),new C(e,r)]},r(A.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._eventHelper.removeAll();for(var e=this._dataSourceCollection,t=0,n=e.length;t<n;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),i(this)},A.prototype.update=function(e){if(!s._initialized)return this._ready=!1,!1;var t,r,i,o,a=!0,l=this._dataSourceCollection,u=l.length;for(t=0;t<u;t++){var c=l.get(t);for(n(c.update)&&(a=c.update(e)&&a),o=(i=c._visualizers).length,r=0;r<o;r++)a=i[r].update(e)&&a}for(o=(i=this._defaultDataSource._visualizers).length,r=0;r<o;r++)a=i[r].update(e)&&a;return this._ready=a,a};var P=[],D=new e;return A.prototype.getBoundingSphere=function(t,r,i){if(!this._ready)return u.PENDING;var o,a,s=this._defaultDataSource;if(!s.entities.contains(t)){s=void 0;var l=this._dataSourceCollection;for(a=l.length,o=0;o<a;o++){var c=l.get(o);if(c.entities.contains(t)){s=c;break}}}if(!n(s))return u.FAILED;var h=P,d=D,p=0,f=u.DONE,m=s._visualizers,_=m.length;for(o=0;o<_;o++)if(n(m[o].getBoundingSphere)){if(f=m[o].getBoundingSphere(t,d),!r&&f===u.PENDING)return u.PENDING;f===u.DONE&&(h[p]=e.clone(d,h[p]),p++)}return 0===p?u.FAILED:(h.length=p,e.fromBoundingSpheres(h,i),u.DONE)},A.prototype._onDataSourceAdded=function(e,t){var n=this._scene,r=t.clustering;r._initialize(n),n.primitives.add(r),t._visualizers=this._visualizersCallback(n,r,t)},A.prototype._onDataSourceRemoved=function(e,t){this._scene.primitives.remove(t.clustering);for(var n=t._visualizers,r=n.length,i=0;i<r;i++)n[i].destroy();t._visualizers=void 0},A}),o("DataSources/DynamicGeometryUpdater",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}return t.prototype.update=e.throwInstantiationError,t.prototype.getBoundingSphere=e.throwInstantiationError,t.prototype.isDestroyed=e.throwInstantiationError,t.prototype.destroy=e.throwInstantiationError,t}),o("DataSources/EntityView",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/HeadingPitchRange","../Core/JulianDate","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Transforms","../Scene/SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f){"use strict";function m(e,n,i){this.entity=e,this.scene=n,this.ellipsoid=r(i,s.WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new t,this._defaultOffset3D=void 0,this._offset3D=new t}var _=new h,g=new h,v=new h,y=new d,C=new t,w=new t,b=new t,E=new t,S=new t,x=new t,T=new u;o(m,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=t.clone(e,new t)}}}),m.defaultOffset3D=new t(-14e3,3500,3500);var A=new l,P=new t;return m.prototype.update=function(e,n){var r=this.scene,o=this.entity,a=this.ellipsoid,s=r.mode;if(s!==f.MORPHING){var l=o.position,d=o!==this._lastEntity,D=s!==this._mode,M=this._offset3D,I=r.camera,O=d||D,R=!0;if(d){var N=o.viewFrom,L=i(N);if(!L&&i(n)){var F=r.screenSpaceCameraController;F.minimumZoomDistance=Math.min(F.minimumZoomDistance,.5*n.radius),A.pitch=-c.PI_OVER_FOUR,A.range=0;var B=l.getValue(e,P);if(i(B)){var k=2-1/Math.max(1,t.magnitude(B)/a.maximumRadius);A.pitch*=k}I.viewBoundingSphere(n,A),this.boundingSphere=n,O=!1,R=!1}else L&&i(N.getValue(e,M))||t.clone(m._defaultOffset3D,M)}else D||r.mode===f.MORPHING||this._mode===f.SCENE2D||t.clone(I.position,M);this._lastEntity=o,this._mode=r.mode!==f.MORPHING?r.mode:this._mode,r.mode!==f.MORPHING&&function(e,n,r,o,a,s,l){var d=e.scene.mode,m=a.getValue(s,e._lastCartesian);if(i(m)){var A,P,D,M,I,O,R=!1;if(d===f.SCENE3D){T=u.addSeconds(s,.001,T);var N=a.getValue(T,C);if(i(N)){var L,F=p.computeFixedToIcrfMatrix(s,_),B=p.computeFixedToIcrfMatrix(T,g);i(F)&&i(B)?L=h.transpose(F,v):(L=p.computeTemeToPseudoFixedMatrix(s,v),F=h.transpose(L,_),B=p.computeTemeToPseudoFixedMatrix(T,g),h.transpose(B,B));var k=h.multiplyByVector(F,m,S),V=h.multiplyByVector(B,N,x);t.subtract(k,V,E);var z=1e3*t.magnitude(E),U=-3986004418e5/(z*z-7972008836e5/t.magnitude(k));U<0||U>1.25*l.maximumRadius?(t.normalize(m,A=w),t.negate(A,A),D=t.clone(t.UNIT_Z,b),P=t.cross(D,A,C),t.magnitude(P)>c.EPSILON7&&(t.normalize(A,A),t.normalize(P,P),D=t.cross(A,P,b),t.normalize(D,D),R=!0)):t.equalsEpsilon(m,N,c.EPSILON7)||(t.normalize(k,D=w),t.normalize(V,V),P=t.cross(D,V,b),t.equalsEpsilon(P,t.ZERO,c.EPSILON7)||(A=t.cross(P,D,C),h.multiplyByVector(L,A,A),h.multiplyByVector(L,P,P),h.multiplyByVector(L,D,D),t.normalize(A,A),t.normalize(P,P),t.normalize(D,D),R=!0))}}i(e.boundingSphere)&&(m=e.boundingSphere.center),o&&(M=t.clone(n.position,E),I=t.clone(n.direction,S),O=t.clone(n.up,x));var G=y;R?(G[0]=A.x,G[1]=A.y,G[2]=A.z,G[3]=0,G[4]=P.x,G[5]=P.y,G[6]=P.z,G[7]=0,G[8]=D.x,G[9]=D.y,G[10]=D.z,G[11]=0,G[12]=m.x,G[13]=m.y,G[14]=m.z,G[15]=0):p.eastNorthUpToFixedFrame(m,l,G),n._setTransform(G),o&&(t.clone(M,n.position),t.clone(I,n.direction),t.clone(O,n.up),t.cross(I,O,n.right))}if(r){var W=d===f.SCENE2D||t.equals(e._offset3D,t.ZERO)?void 0:e._offset3D;n.lookAtTransform(n.transform,W)}}(this,I,O,R,l,e,a)}},m}),function(){function t(e,t){function n(e,t){for(var n in e){var i=e[n];delete t[i.start],delete i.start,delete i.end,i.forEach(function(e){r[e<0?~e:e]=1}),a.push(i)}}var r={},i={},o={},a=[],s=-1;return t.forEach(function(n,r){var i,o=e.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=t[++s],t[s]=n,t[r]=i)}),t.forEach(function(t){var n,r,a,s,l,u,c=(u=(l=e.arcs[(a=t)<0?~a:a])[0],e.transform?(s=[0,0],l.forEach(function(e){s[0]+=e[0],s[1]+=e[1]})):s=l[l.length-1],a<0?[s,u]:[u,s]),h=c[0],d=c[1];if(n=o[h])if(delete o[n.end],n.push(t),n.end=d,r=i[d]){delete i[r.start];var p=r===n?n:n.concat(r);i[p.start=n.start]=o[p.end=r.end]=p}else i[n.start]=o[n.end]=n;else if(n=i[d])if(delete i[n.start],n.unshift(t),n.start=h,r=o[h]){delete o[r.end];var f=r===n?n:r.concat(n);i[f.start=r.start]=o[f.end=n.end]=f}else i[n.start]=o[n.end]=n;else n=[t],i[n.start=h]=o[n.end=d]=n}),n(o,i),n(i,o),t.forEach(function(e){r[e<0?~e:e]||a.push([e])}),a}function r(e,n,r){function i(e){var t=e<0?~e:e;(u[t]||(u[t]=[])).push({i:e,g:l})}function o(e){e.forEach(i)}function a(e){e.forEach(o)}var s=[];if(arguments.length>1){var l,u=[],c={LineString:o,MultiLineString:a,Polygon:a,MultiPolygon:function(e){e.forEach(a)}};(function e(t){"GeometryCollection"===t.type?t.geometries.forEach(e):t.type in c&&(l=t,c[t.type](t.arcs))})(n),u.forEach(arguments.length<3?function(e){s.push(e[0].i)}:function(e){r(e[0].g,e[e.length-1].g)&&s.push(e[0].i)})}else for(var h=0,d=e.arcs.length;h<d;++h)s.push(h);return{type:"MultiLineString",arcs:t(e,s)}}function i(e,r){function i(e){e.forEach(function(t){t.forEach(function(t){(a[t=t<0?~t:t]||(a[t]=[])).push(e)})}),l.push(e)}function o(t){return function(e){for(var t,n=-1,r=e.length,i=e[r-1],o=0;++n<r;)t=i,i=e[n],o+=t[0]*i[1]-t[1]*i[0];return.5*o}(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var a={},l=[],u=[];return r.forEach(function(e){"Polygon"===e.type?i(e.arcs):"MultiPolygon"===e.type&&e.arcs.forEach(i)}),l.forEach(function(e){if(!e._){var t=[],n=[e];for(e._=1,u.push(t);e=n.pop();)t.push(e),e.forEach(function(e){e.forEach(function(e){a[e<0?~e:e].forEach(function(e){e._||(e._=1,n.push(e))})})})}}),l.forEach(function(e){delete e._}),{type:"MultiPolygon",arcs:u.map(function(r){var i=[];if(r.forEach(function(e){e.forEach(function(e){e.forEach(function(e){a[e<0?~e:e].length<2&&i.push(e)})})}),i=t(e,i),(n=i.length)>1)for(var s,l=o(r[0][0]),u=0;u<n;++u)if(l===o(i[u])){s=i[0],i[0]=i[u],i[u]=s;break}return i})}}function a(e,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(e,t)};return null==t.id&&delete n.id,n}function s(e,t){function n(e,t){t.length&&t.pop();for(var n,r=l[e<0?~e:e],i=0,o=r.length;i<o;++i)t.push(n=r[i].slice()),s(n,i);e<0&&function(e,t){for(var n,r=e.length,i=r-o;i<--r;)n=e[i],e[i++]=e[r],e[r]=n}(t)}function r(e){return e=e.slice(),s(e,0),e}function i(e){for(var t=[],r=0,i=e.length;r<i;++r)n(e[r],t);return t.length<2&&t.push(t[0].slice()),t}function o(e){for(var t=i(e);t.length<4;)t.push(t[0].slice());return t}function a(e){return e.map(o)}var s=h(e.transform),l=e.arcs,u={Point:function(e){return r(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(r)},LineString:function(e){return i(e.arcs)},MultiLineString:function(e){return e.arcs.map(i)},Polygon:function(e){return a(e.arcs)},MultiPolygon:function(e){return e.arcs.map(a)}};return function e(t){var n=t.type;return"GeometryCollection"===n?{type:n,geometries:t.geometries.map(e)}:n in u?{type:n,coordinates:u[n](t)}:null}(t)}function l(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;e[i]<t?n=i+1:r=i}return n}function u(e){var t=e[0],n=e[1],r=e[2];return Math.abs((t[0]-r[0])*(n[1]-t[1])-(t[0]-n[0])*(r[1]-t[1]))}function c(e,t){return e[1][2]-t[1][2]}function h(e){if(!e)return d;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0),e[0]=(t+=e[0])*r+o,e[1]=(n+=e[1])*i+a}}function d(){}var p={version:"1.6.18",mesh:function(e){return s(e,r.apply(this,arguments))},meshArcs:r,merge:function(e){return s(e,i.apply(this,arguments))},mergeArcs:i,feature:function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return a(e,t)})}:a(e,t)},neighbors:function(e){function t(e,t){e.forEach(function(e){e<0&&(e=~e);var n=r[e];n?n.push(t):r[e]=[t]})}function n(e,n){e.forEach(function(e){t(e,n)})}var r={},i=e.map(function(){return[]}),o={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(e,t){e.forEach(function(e){n(e,t)})}};e.forEach(function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,n)}):t.type in o&&o[t.type](t.arcs,n)});for(var a in r)for(var s=r[a],u=s.length,c=0;c<u;++c)for(var h=c+1;h<u;++h){var d,p=s[c],f=s[h];(d=i[p])[a=l(d,f)]!==f&&d.splice(a,0,f),(d=i[f])[a=l(d,p)]!==p&&d.splice(a,0,p)}return i},presimplify:function(e,t){function n(e){o.remove(e),e[1][2]=t(e),o.push(e)}var r=h(e.transform),i=function(e){if(!e)return d;var t,n,r=e.scale[0],i=e.scale[1],o=e.translate[0],a=e.translate[1];return function(e,s){s||(t=n=0);var l=(e[0]-o)/r|0,u=(e[1]-a)/i|0;e[0]=l-t,e[1]=u-n,t=l,n=u}}(e.transform),o=function(){function e(e,t){for(;t>0;){var n=(t+1>>1)-1,i=r[n];if(c(e,i)>=0)break;r[i._=t]=i,r[e._=t=n]=e}}function t(e,t){for(;;){var n=t+1<<1,o=n-1,a=t,s=r[a];if(o<i&&c(r[o],s)<0&&(s=r[a=o]),n<i&&c(r[n],s)<0&&(s=r[a=n]),a===t)break;r[s._=t]=s,r[e._=t=a]=e}}var n={},r=[],i=0;return n.push=function(t){return e(r[t._=i]=t,i++),i},n.pop=function(){if(!(i<=0)){var e,n=r[0];return--i>0&&t(r[(e=r[i])._=0]=e,0),n}},n.remove=function(n){var o,a=n._;if(r[a]===n)return a!==--i&&(o=r[i],(c(o,n)<0?e:t)(r[o._=a]=o,a)),a},n}();return t||(t=u),e.arcs.forEach(function(e){for(var a,s,l=[],u=0,c=0,h=e.length;c<h;++c)s=e[c],r(e[c]=[s[0],s[1],1/0],c);for(c=1,h=e.length-1;c<h;++c)a=e.slice(c-1,c+2),a[1][2]=t(a),l.push(a),o.push(a);for(c=0,h=l.length;c<h;++c)a=l[c],a.previous=l[c-1],a.next=l[c+1];for(;a=o.pop();){var d=a.previous,p=a.next;a[1][2]<u?a[1][2]=u:u=a[1][2],d&&(d.next=p,d[2]=a[2],n(d)),p&&(p.previous=d,p[0]=a[0],n(p))}e.forEach(i)}),e}};"function"==typeof o&&o.amd?o("ThirdParty/topojson",p):"object"==typeof e&&e.exports?e.exports=p:this.topojson=p}(),o("DataSources/GeoJsonDataSource",["../Core/Cartesian3","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getFilenameFromUri","../Core/loadJson","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/RuntimeError","../Scene/HeightReference","../Scene/VerticalOrigin","../ThirdParty/topojson","../ThirdParty/when","./BillboardGraphics","./CallbackProperty","./ColorMaterialProperty","./ConstantPositionProperty","./ConstantProperty","./CorridorGraphics","./DataSource","./EntityCluster","./EntityCollection","./PolygonGraphics","./PolylineGraphics"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A){"use strict";function P(t){return e.fromDegrees(t[0],t[1],t[2])}function D(e,t){var n="";for(var r in e)if(e.hasOwnProperty(r)){if(r===t||-1!==oe.indexOf(r))continue;var o=e[r];i(o)&&(n+="object"==typeof o?"<tr><th>"+r+"</th><td>"+D(o)+"</td></tr>":"<tr><th>"+r+"</th><td>"+o+"</td></tr>")}return n.length>0&&(n='<table class="cesium-infoBox-defaultTable"><tbody>'+n+"</tbody></table>"),n}function M(e,t){return new v((n=D,r=e,o=t,function(e,t){return i(a)||(a=n(r,o)),a}),!0);var n,r,o,a}function I(e,t,r){var o=e.id;if(i(o)&&"Feature"===e.type){for(var a=2,s=o;i(t.getById(s));)s=o+"_"+a,a++;o=s}else o=n();var l=t.getOrCreateEntity(o),u=e.properties;if(i(u)){l.addProperty("properties"),l.properties=u;var c,h=u.title;if(i(h))l.name=h,c="title";else{var d=Number.MAX_VALUE;for(var p in u)if(u.hasOwnProperty(p)&&u[p]){var f=p.toLowerCase();if(d>1&&"title"===f){d=1,c=p;break}d>2&&"name"===f?(d=2,c=p):d>3&&/title/i.test(p)?(d=3,c=p):d>4&&/name/i.test(p)&&(d=4,c=p)}i(c)&&(l.name=u[c])}var m=u.description;null!==m&&(l.description=i(m)?new w(m):r(u,c))}return l}function O(e,t){for(var n=new Array(e.length),r=0;r<e.length;r++)n[r]=t(e[r]);return n}function R(e,t,n,r,o){if(null!==t.geometry){if(!i(t.geometry))throw new d("feature.geometry is required.");var a=t.geometry.type,s=se[a];if(!i(s))throw new d("Unknown geometry type: "+a);s(e,t,t.geometry,r,o)}else I(t,e._entityCollection,o.describe)}function N(e,t,n,r,o){for(var a=n.geometries,s=0,l=a.length;s<l;s++){var u=a[s],c=u.type,h=se[c];if(!i(h))throw new d("Unknown geometry type: "+c);h(e,t,u,r,o)}}function L(e,n,o,a,s){var l,u=s.markerSymbol,c=s.markerColor,h=s.markerSize,d=n.properties;if(i(d)){var m=d["marker-color"];i(m)&&(c=t.fromCssColorString(m)),h=r(ie[d["marker-size"]],h);var v=d["marker-symbol"];i(v)&&(u=v)}l=i(u)?1===u.length?e._pinBuilder.fromText(u.toUpperCase(),c,h):e._pinBuilder.fromMakiIconId(u,c,h):e._pinBuilder.fromColor(c,h);var y=new g;y.verticalOrigin=new w(f.BOTTOM),2===a.length&&s.clampToGround&&(y.heightReference=p.CLAMP_TO_GROUND);var b=I(n,e._entityCollection,s.describe);b.billboard=y,b.position=new C(o(a));var E=_(l).then(function(e){y.image=new w(e)}).otherwise(function(){y.image=new w(e._pinBuilder.fromColor(c,h))});e._promises.push(E)}function F(e,t,n,r,i){L(e,t,r,n.coordinates,i)}function B(e,t,n,r,i){for(var o=n.coordinates,a=0;a<o.length;a++)L(e,t,r,o[a],i)}function k(e,n,r,o,a){var s=a.strokeMaterialProperty,l=a.strokeWidthProperty,u=n.properties;if(i(u)){var c=u["stroke-width"];i(c)&&(l=new w(c));var h,d=u.stroke;i(d)&&(h=t.fromCssColorString(d));var p=u["stroke-opacity"];i(p)&&1!==p&&(i(h)||(h=s.color.clone()),h.alpha=p),i(h)&&(s=new y(h))}var f,m=I(n,e._entityCollection,a.describe);a.clampToGround?(f=new b,m.corridor=f):(f=new A,m.polyline=f),f.material=s,f.width=l,f.positions=new w(O(o,r))}function V(e,t,n,r,i){k(e,t,r,n.coordinates,i)}function z(e,t,n,r,i){for(var o=n.coordinates,a=0;a<o.length;a++)k(e,t,r,o[a],i)}function U(e,n,r,o,a){if(0!==o.length&&0!==o[0].length){var s=a.strokeMaterialProperty.color,l=a.fillMaterialProperty,u=a.strokeWidthProperty,c=n.properties;if(i(c)){var d=c["stroke-width"];i(d)&&(u=new w(d));var p,f=c.stroke;i(f)&&(p=t.fromCssColorString(f));var m=c["stroke-opacity"];i(m)&&1!==m&&(i(p)||(p=a.strokeMaterialProperty.color.clone()),p.alpha=m),i(p)&&(s=new w(p));var _,g=c.fill;i(g)&&((_=t.fromCssColorString(g)).alpha=l.color.alpha),i(m=c["fill-opacity"])&&m!==l.color.alpha&&(i(_)||(_=l.color.clone()),_.alpha=m),i(_)&&(l=new y(_))}var v=new T;v.outline=new w(!0),v.outlineColor=s,v.outlineWidth=u,v.material=l;for(var C=[],b=1,E=o.length;b<E;b++)C.push(new h(O(o[b],r)));var S=o[0];v.hierarchy=new w(new h(O(S,r),C)),S[0].length>2?v.perPositionHeight=new w(!0):a.clampToGround||(v.height=0),I(n,e._entityCollection,a.describe).polygon=v}}function G(e,t,n,r,i){U(e,t,r,n.coordinates,i)}function W(e,t,n,r,i){for(var o=n.coordinates,a=0;a<o.length;a++)U(e,t,r,o[a],i)}function H(e,t,n,r,i){for(var o in n.objects)if(n.objects.hasOwnProperty(o)){var a=m.feature(n,n.objects[o]);(0,ae[a.type])(e,a,a,r,i)}}function j(e){this._name=e,this._changed=new s,this._error=new s,this._isLoading=!1,this._loading=new s,this._entityCollection=new x(this),this._promises=[],this._pinBuilder=new c,this._entityCluster=new S}var q,Y={"urn:ogc:def:crs:OGC:1.3:CRS84":P,"EPSG:4326":P,"urn:ogc:def:crs:EPSG::4326":P},X={},Z={},K=48,Q=t.ROYALBLUE,J=t.YELLOW,$=2,ee=t.fromBytes(255,255,0,100),te=!1,ne=new w($),re=new y(J),ie=(new y(ee),{small:24,medium:48,large:64}),oe=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"],ae={Feature:R,FeatureCollection:function(e,t,n,r,i){for(var o=t.features,a=0,s=o.length;a<s;a++)R(e,o[a],0,r,i)},GeometryCollection:N,LineString:V,MultiLineString:z,MultiPoint:B,MultiPolygon:W,Point:F,Polygon:G,Topology:H},se={GeometryCollection:N,LineString:V,MultiLineString:z,MultiPoint:B,MultiPolygon:W,Point:F,Polygon:G,Topology:H};return j.load=function(e,t){return(new j).load(e,t)},o(j,{markerSize:{get:function(){return K},set:function(e){K=e}},markerSymbol:{get:function(){return q},set:function(e){q=e}},markerColor:{get:function(){return Q},set:function(e){Q=e}},stroke:{get:function(){return J},set:function(e){J=e,re.color.setValue(e)}},strokeWidth:{get:function(){return $},set:function(e){$=e,ne.setValue(e)}},fill:{get:function(){return ee},set:function(e){new y(ee=e)}},clampToGround:{get:function(){return te},set:function(e){te=e}},crsNames:{get:function(){return Y}},crsLinkHrefs:{get:function(){return X}},crsLinkTypes:{get:function(){return Z}}}),o(j.prototype,{name:{get:function(){return this._name}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),j.prototype.load=function(e,t){E.setLoading(this,!0);var n=e,o=(t=r(t,r.EMPTY_OBJECT)).sourceUri;"string"==typeof e&&(i(o)||(o=e),n=u(e)),t={describe:r(t.describe,M),markerSize:r(t.markerSize,K),markerSymbol:r(t.markerSymbol,q),markerColor:r(t.markerColor,Q),strokeWidthProperty:new w(r(t.strokeWidth,$)),strokeMaterialProperty:new y(r(t.stroke,J)),fillMaterialProperty:new y(r(t.fill,ee)),clampToGround:r(t.clampToGround,te)};var a=this;return _(n,function(e){return function(e,t,n,r){var o;i(r)&&(o=l(r)),i(o)&&e._name!==o&&(e._name=o,e._changed.raiseEvent(e));var a=ae[t.type];if(!i(a))throw new d("Unsupported GeoJSON object type: "+t.type);var s=t.crs,u=null!==s?P:null;if(i(s)){if(!i(s.properties))throw new d("crs.properties is undefined.");var c=s.properties;if("name"===s.type){if(!i(u=Y[c.name]))throw new d("Unknown crs name: "+c.name)}else if("link"===s.type){var h=X[c.href];if(i(h)||(h=Z[c.type]),!i(h))throw new d("Unable to resolve crs link: "+JSON.stringify(c));u=h(c)}else{if("EPSG"!==s.type)throw new d("Unknown crs type: "+s.type);if(!i(u=Y["EPSG:"+c.code]))throw new d("Unknown crs EPSG code: "+c.code)}}return _(u,function(r){return e._entityCollection.removeAll(),null!==r&&a(e,t,t,r,n),_.all(e._promises,function(){return e._promises.length=0,E.setLoading(e,!1),e})})}(a,e,t,o)}).otherwise(function(e){return E.setLoading(a,!1),a._error.raiseEvent(a,e),console.log(e),_.reject(e)})},j}),o("DataSources/GeometryUpdater",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function n(e,n){t.throwInstantiationError()}return e(n,{perInstanceColorAppearanceType:{get:t.throwInstantiationError},materialAppearanceType:{get:t.throwInstantiationError}}),e(n.prototype,{entity:{get:t.throwInstantiationError},fillEnabled:{get:t.throwInstantiationError},hasConstantFill:{get:t.throwInstantiationError},fillMaterialProperty:{get:t.throwInstantiationError},outlineEnabled:{get:t.throwInstantiationError},hasConstantOutline:{get:t.throwInstantiationError},outlineColorProperty:{get:t.throwInstantiationError},outlineWidth:{get:t.throwInstantiationError},isDynamic:{get:t.throwInstantiationError},isClosed:{get:t.throwInstantiationError},geometryChanged:{get:t.throwInstantiationError}}),n.prototype.isOutlineVisible=t.throwInstantiationError,n.prototype.isFilled=t.throwInstantiationError,n.prototype.createFillGeometryInstance=t.throwInstantiationError,n.prototype.createOutlineGeometryInstance=t.throwInstantiationError,n.prototype.isDestroyed=t.throwInstantiationError,n.prototype.destroy=t.throwInstantiationError,n.prototype.createDynamicUpdater=t.throwInstantiationError,n}),a=this,s=function(){var e,t,n,r,i=function(e){i.Util.assign(this,e);var t=this.hashtag;if(!1!==t&&"twitter"!==t&&"facebook"!==t)throw new Error("invalid `hashtag` cfg - see docs")};return i.prototype={constructor:i,urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,newWindow:!0,stripPrefix:!0,truncate:void 0,className:"",htmlParser:void 0,matchParser:void 0,tagBuilder:void 0,link:function(e){for(var t=this.getHtmlParser().parse(e),n=0,r=[],i=0,o=t.length;i<o;i++){var a=t[i],s=a.getType(),l=a.getText();if("element"===s)"a"===a.getTagName()&&(a.isClosing()?n=Math.max(n-1,0):n++),r.push(l);else if("entity"===s||"comment"===s)r.push(l);else if(0===n){var u=this.linkifyStr(l);r.push(u)}else r.push(l)}return r.join("")},linkifyStr:function(e){return this.getMatchParser().replace(e,this.createMatchReturnVal,this)},createMatchReturnVal:function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this,this,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof i.HtmlTag?t.toAnchorString():this.getTagBuilder().build(e).toAnchorString()},getHtmlParser:function(){var e=this.htmlParser;return e||(e=this.htmlParser=new i.htmlParser.HtmlParser),e},getMatchParser:function(){var e=this.matchParser;return e||(e=this.matchParser=new i.matchParser.MatchParser({urls:this.urls,email:this.email,twitter:this.twitter,phone:this.phone,hashtag:this.hashtag,stripPrefix:this.stripPrefix})),e},getTagBuilder:function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new i.AnchorTagBuilder({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e}},i.link=function(e,t){return new i(t).link(e)},i.match={},i.htmlParser={},i.matchParser={},i.Util={abstractMethod:function(){throw"abstract"},trimRegex:/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,assign:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},extend:function(e,t){var n,r=e.prototype,o=function(){};o.prototype=r;var a=(n=t.hasOwnProperty("constructor")?t.constructor:function(){r.constructor.apply(this,arguments)}).prototype=new o;return a.constructor=n,a.superclass=r,delete t.constructor,i.Util.assign(a,t),n},ellipsis:function(e,t,n){return e.length>t&&(e=e.substring(0,t-(n=null==n?"..":n).length)+n),e},indexOf:function(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},splitAndCapture:function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,r=[],i=0;n=t.exec(e);)r.push(e.substring(i,n.index)),r.push(n[0]),i=n.index+n[0].length;return r.push(e.substring(i)),r},trim:function(e){return e.replace(this.trimRegex,"")}},i.HtmlTag=i.Util.extend(Object,{whitespaceRegex:/\s+/,constructor:function(e){i.Util.assign(this,e),this.innerHtml=this.innerHtml||this.innerHTML},setTagName:function(e){return this.tagName=e,this},getTagName:function(){return this.tagName||""},setAttr:function(e,t){return this.getAttrs()[e]=t,this},getAttr:function(e){return this.getAttrs()[e]},setAttrs:function(e){var t=this.getAttrs();return i.Util.assign(t,e),this},getAttrs:function(){return this.attrs||(this.attrs={})},setClass:function(e){return this.setAttr("class",e)},addClass:function(e){for(var t,n=this.getClass(),r=this.whitespaceRegex,o=i.Util.indexOf,a=n?n.split(r):[],s=e.split(r);t=s.shift();)-1===o(a,t)&&a.push(t);return this.getAttrs().class=a.join(" "),this},removeClass:function(e){for(var t,n=this.getClass(),r=this.whitespaceRegex,o=i.Util.indexOf,a=n?n.split(r):[],s=e.split(r);a.length&&(t=s.shift());){var l=o(a,t);-1!==l&&a.splice(l,1)}return this.getAttrs().class=a.join(" "),this},getClass:function(){return this.getAttrs().class||""},hasClass:function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},setInnerHtml:function(e){return this.innerHtml=e,this},getInnerHtml:function(){return this.innerHtml||""},toAnchorString:function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},buildAttrsStr:function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")}}),i.AnchorTagBuilder=i.Util.extend(Object,{constructor:function(e){i.Util.assign(this,e)},build:function(e){return new i.HtmlTag({tagName:"a",attrs:this.createAttrs(e.getType(),e.getAnchorHref()),innerHtml:this.processAnchorText(e.getAnchorText())})},createAttrs:function(e,t){var n={href:t},r=this.createCssClass(e);return r&&(n.class=r),this.newWindow&&(n.target="_blank"),n},createCssClass:function(e){var t=this.className;return t?t+" "+t+"-"+e:""},processAnchorText:function(e){return this.doTruncate(e)},doTruncate:function(e){return i.Util.ellipsis(e,this.truncate||Number.POSITIVE_INFINITY)}}),i.htmlParser.HtmlParser=i.Util.extend(Object,{htmlRegex:(n=/(?:"[^"]*?"|'[^']*?'|[^'"=<>`\s]+)/,r=/[^\s\0"'>\/=\x01-\x1F\x7F]+/.source+"(?:\\s*=\\s*"+n.source+")?",new RegExp(["(?:","<(!DOCTYPE)","(?:","\\s+","(?:",r,"|",n.source+")",")*",">",")","|","(?:","<(/)?","(?:",/!--([\s\S]+?)--/.source,"|","(?:","("+/[0-9a-zA-Z][0-9a-zA-Z:]*/.source+")","(?:","\\s+",r,")*","\\s*/?",")",")",">",")"].join(""),"gi")),htmlCharacterEntitiesRegex:/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi,parse:function(e){for(var t,n,r=this.htmlRegex,i=0,o=[];null!==(t=r.exec(e));){var a=t[0],s=t[3],l=t[1]||t[4],u=!!t[2],c=e.substring(i,t.index);c&&(n=this.parseTextAndEntityNodes(c),o.push.apply(o,n)),o.push(s?this.createCommentNode(a,s):this.createElementNode(a,l,u)),i=t.index+a.length}if(i<e.length){var h=e.substring(i);h&&(n=this.parseTextAndEntityNodes(h),o.push.apply(o,n))}return o},parseTextAndEntityNodes:function(e){for(var t=[],n=i.Util.splitAndCapture(e,this.htmlCharacterEntitiesRegex),r=0,o=n.length;r<o;r+=2){var a=n[r],s=n[r+1];a&&t.push(this.createTextNode(a)),s&&t.push(this.createEntityNode(s))}return t},createCommentNode:function(e,t){return new i.htmlParser.CommentNode({text:e,comment:i.Util.trim(t)})},createElementNode:function(e,t,n){return new i.htmlParser.ElementNode({text:e,tagName:t.toLowerCase(),closing:n})},createEntityNode:function(e){return new i.htmlParser.EntityNode({text:e})},createTextNode:function(e){return new i.htmlParser.TextNode({text:e})}}),i.htmlParser.HtmlNode=i.Util.extend(Object,{text:"",constructor:function(e){i.Util.assign(this,e)},getType:i.Util.abstractMethod,getText:function(){return this.text}}),i.htmlParser.CommentNode=i.Util.extend(i.htmlParser.HtmlNode,{comment:"",getType:function(){return"comment"},getComment:function(){return this.comment}}),i.htmlParser.ElementNode=i.Util.extend(i.htmlParser.HtmlNode,{tagName:"",closing:!1,getType:function(){return"element"},getTagName:function(){return this.tagName},isClosing:function(){return this.closing}}),i.htmlParser.EntityNode=i.Util.extend(i.htmlParser.HtmlNode,{getType:function(){return"entity"}}),i.htmlParser.TextNode=i.Util.extend(i.htmlParser.HtmlNode,{getType:function(){return"text"}}),i.matchParser.MatchParser=i.Util.extend(Object,{urls:!0,email:!0,twitter:!0,phone:!0,hashtag:!1,stripPrefix:!0,matcherRegex:(e=/[A-Za-z0-9\.\-]*[A-Za-z0-9\-]/,t=/\.(?:international|construction|contractors|enterprises|photography|productions|foundation|immobilien|industries|management|properties|technology|christmas|community|directory|education|equipment|institute|marketing|solutions|vacations|bargains|boutique|builders|catering|cleaning|clothing|computer|democrat|diamonds|graphics|holdings|lighting|partners|plumbing|supplies|training|ventures|academy|careers|company|cruises|domains|exposed|flights|florist|gallery|guitars|holiday|kitchen|neustar|okinawa|recipes|rentals|reviews|shiksha|singles|support|systems|agency|berlin|camera|center|coffee|condos|dating|estate|events|expert|futbol|kaufen|luxury|maison|monash|museum|nagoya|photos|repair|report|social|supply|tattoo|tienda|travel|viajes|villas|vision|voting|voyage|actor|build|cards|cheap|codes|dance|email|glass|house|mango|ninja|parts|photo|shoes|solar|today|tokyo|tools|watch|works|aero|arpa|asia|best|bike|blue|buzz|camp|club|cool|coop|farm|fish|gift|guru|info|jobs|kiwi|kred|land|limo|link|menu|mobi|moda|name|pics|pink|post|qpon|rich|ruhr|sexy|tips|vote|voto|wang|wien|wiki|zone|bar|bid|biz|cab|cat|ceo|com|edu|gov|int|kim|mil|net|onl|org|pro|pub|red|tel|uno|wed|xxx|xyz|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw)\b/,new RegExp(["(",/(^|[^\w])@(\w{1,15})/.source,")","|","(",/(?:[\-;:&=\+\$,\w\.]+@)/.source,e.source,t.source,")","|","(","(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]+:(?![A-Za-z][-.+A-Za-z0-9]+:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,e.source,")","|","(?:","(.?//)?",/(?:www\.)/.source,e.source,")","|","(?:","(.?//)?",e.source,t.source,")",")","(?:"+/[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]?!:,.;]*[\-A-Za-z0-9+&@#\/%=~_()|'$*\[\]]/.source+")?",")","|","(",/(?:\+?\d{1,3}[-\s.])?\(?\d{3}\)?[-\s.]?\d{3}[-\s.]\d{4}/.source,")","|","(",/(^|[^\w])#(\w{1,15})/.source,")"].join(""),"gi")),charBeforeProtocolRelMatchRegex:/^(.)?\/\//,constructor:function(e){i.Util.assign(this,e),this.matchValidator=new i.MatchValidator},replace:function(e,t,n){var r=this;return e.replace(this.matcherRegex,function(e,i,o,a,s,l,u,c,h,d,p,f,m){var _=r.processCandidateMatch(e,i,o,a,s,l,u,c,h,d,p,f,m);if(_){var g=t.call(n,_.match);return _.prefixStr+g+_.suffixStr}return e})},processCandidateMatch:function(e,t,n,r,o,a,s,l,u,c,h,d,p){var f,m=l||u,_="",g="";if(a&&!this.urls||o&&!this.email||c&&!this.phone||t&&!this.twitter||h&&!this.hashtag||!this.matchValidator.isValidMatch(a,s,m))return null;if(this.matchHasUnbalancedClosingParen(e)&&(e=e.substr(0,e.length-1),g=")"),o)f=new i.match.Email({matchedText:e,email:o});else if(t)n&&(_=n,e=e.slice(1)),f=new i.match.Twitter({matchedText:e,twitterHandle:r});else if(c){var v=e.replace(/\D/g,"");f=new i.match.Phone({matchedText:e,number:v})}else if(h)d&&(_=d,e=e.slice(1)),f=new i.match.Hashtag({matchedText:e,serviceName:this.hashtag,hashtag:p});else{if(m){var y=m.match(this.charBeforeProtocolRelMatchRegex)[1]||"";y&&(_=y,e=e.slice(1))}f=new i.match.Url({matchedText:e,url:e,protocolUrlMatch:!!s,protocolRelativeMatch:!!m,stripPrefix:this.stripPrefix})}return{prefixStr:_,suffixStr:g,match:f}},matchHasUnbalancedClosingParen:function(e){if(")"===e.charAt(e.length-1)){var t=e.match(/\(/g),n=e.match(/\)/g);if((t&&t.length||0)<(n&&n.length||0))return!0}return!1}}),i.MatchValidator=i.Util.extend(Object,{invalidProtocolRelMatchRegex:/^[\w]\/\//,hasFullProtocolRegex:/^[A-Za-z][-.+A-Za-z0-9]+:\/\//,uriSchemeRegex:/^[A-Za-z][-.+A-Za-z0-9]+:/,hasWordCharAfterProtocolRegex:/:[^\s]*?[A-Za-z]/,isValidMatch:function(e,t,n){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)||this.isInvalidProtocolRelativeMatch(n))},isValidUriScheme:function(e){var t=e.match(this.uriSchemeRegex)[0].toLowerCase();return"javascript:"!==t&&"vbscript:"!==t},urlMatchDoesNotHaveProtocolOrDot:function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},urlMatchDoesNotHaveAtLeastOneWordChar:function(e,t){return!(!e||!t||this.hasWordCharAfterProtocolRegex.test(e))},isInvalidProtocolRelativeMatch:function(e){return!!e&&this.invalidProtocolRelMatchRegex.test(e)}}),i.match.Match=i.Util.extend(Object,{constructor:function(e){i.Util.assign(this,e)},getType:i.Util.abstractMethod,getMatchedText:function(){return this.matchedText},getAnchorHref:i.Util.abstractMethod,getAnchorText:i.Util.abstractMethod}),i.match.Email=i.Util.extend(i.match.Match,{getType:function(){return"email"},getEmail:function(){return this.email},getAnchorHref:function(){return"mailto:"+this.email},getAnchorText:function(){return this.email}}),i.match.Hashtag=i.Util.extend(i.match.Match,{getType:function(){return"hashtag"},getHashtag:function(){return this.hashtag},getAnchorHref:function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;default:throw new Error("Unknown service name to point hashtag to: ",e)}},getAnchorText:function(){return"#"+this.hashtag}}),i.match.Phone=i.Util.extend(i.match.Match,{getType:function(){return"phone"},getNumber:function(){return this.number},getAnchorHref:function(){return"tel:"+this.number},getAnchorText:function(){return this.matchedText}}),i.match.Twitter=i.Util.extend(i.match.Match,{getType:function(){return"twitter"},getTwitterHandle:function(){return this.twitterHandle},getAnchorHref:function(){return"https://twitter.com/"+this.twitterHandle},getAnchorText:function(){return"@"+this.twitterHandle}}),i.match.Url=i.Util.extend(i.match.Match,{urlPrefixRegex:/^(https?:\/\/)?(www\.)?/i,protocolRelativeRegex:/^\/\//,protocolPrepended:!1,getType:function(){return"url"},getUrl:function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},getAnchorHref:function(){return this.getUrl().replace(/&amp;/g,"&")},getAnchorText:function(){var e=this.getUrl();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix&&(e=this.stripUrlPrefix(e)),this.removeTrailingSlash(e)},stripUrlPrefix:function(e){return e.replace(this.urlPrefixRegex,"")},stripProtocolRelativePrefix:function(e){return e.replace(this.protocolRelativeRegex,"")},removeTrailingSlash:function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e}}),i},"function"==typeof o&&o.amd?o("ThirdParty/Autolinker",[],function(){return a.Autolinker=s()}):e.exports=s(),o("ThirdParty/zip",["../Core/buildModuleUrl","../Core/defineProperties"],function(e,t){var n={};return function(n){function r(){var e=-1,t=this;t.append=function(n){var r,i=t.table;for(r=0;r<n.length;r++)e=e>>>8^i[255&(e^n[r])]},t.get=function(){return~e}}function i(e,t){var n,r;return n=new ArrayBuffer(e),r=new Uint8Array(n),t&&r.set(t,0),{buffer:n,array:r,view:new DataView(n)}}function o(){}function a(e){var t,n=this;n.size=0,n.init=function(r,i){var o=new Blob([e],{type:N});(t=new l(o)).init(function(){n.size=t.size,r()},i)},n.readUint8Array=function(e,n,r,i){t.readUint8Array(e,n,r,i)}}function s(e){var t,n=this;n.size=0,n.init=function(r){for(var i=e.length;"="==e.charAt(i-1);)i--;t=e.indexOf(",")+1,n.size=Math.floor(.75*(i-t)),r()},n.readUint8Array=function(n,r,o){var a,s=i(r),l=4*Math.floor(n/3),u=4*Math.ceil((n+r)/3),c=window.atob(e.substring(l+t,u+t)),h=n-3*Math.floor(l/4);for(a=h;a<h+r;a++)s.array[a-h]=c.charCodeAt(a);o(s.array)}}function l(e){this.size=0,this.init=function(t){this.size=e.size,t()},this.readUint8Array=function(t,n,r,i){var o,a,s,l=new FileReader;l.onload=function(e){r(new Uint8Array(e.target.result))},l.onerror=i,l.readAsArrayBuffer((a=t,s=n,(o=e).slice?o.slice(a,a+s):o.webkitSlice?o.webkitSlice(a,a+s):o.mozSlice?o.mozSlice(a,a+s):o.msSlice?o.msSlice(a,a+s):void 0))}}function u(){}function c(e){var t;this.init=function(e){t=new Blob([],{type:N}),e()},this.writeUint8Array=function(e,n){t=new Blob([t,b?e:e.buffer],{type:N}),n()},this.getData=function(n,r){var i=new FileReader;i.onload=function(e){n(e.target.result)},i.onerror=r,i.readAsText(t,e)}}function h(e){var t="",n="";this.init=function(n){t+="data:"+(e||"")+";base64,",n()},this.writeUint8Array=function(e,r){var i,o=n.length,a=n;for(n="",i=0;i<3*Math.floor((o+e.length)/3)-o;i++)a+=String.fromCharCode(e[i]);for(;i<e.length;i++)n+=String.fromCharCode(e[i]);a.length>2?t+=window.btoa(a):n=a,r()},this.getData=function(e){e(t+window.btoa(n))}}function d(e){var t;this.init=function(n){t=new Blob([],{type:e}),n()},this.writeUint8Array=function(n,r){t=new Blob([t,b?n:n.buffer],{type:e}),r()},this.getData=function(e){e(t)}}function p(e,t,n,r,i,o,a,s,l,u){function c(){e.removeEventListener(L,h,!1),s(f)}function h(e){var t=e.data,r=t.data;t.onappend&&(f+=r.length,n.writeUint8Array(r,function(){o(!1,r),d()},u)),t.onflush&&(r?(f+=r.length,n.writeUint8Array(r,function(){o(!1,r),c()},u)):c()),t.progress&&a&&a(p+t.current,i)}function d(){(p=m*O)<i?t.readUint8Array(r+p,Math.min(O,i-p),function(t){e.postMessage({append:!0,data:t}),m++,a&&a(p,i),o(!0,t)},l):e.postMessage({flush:!0})}var p,f,m=0;f=0,e.addEventListener(L,h,!1),d()}function f(e,t,n,r,i,o,a,s,l,u){var c,h=0,d=0;!function p(){var f;(c=h*O)<i?t.readUint8Array(r+c,Math.min(O,i-c),function(t){var s=e.append(t,function(){a&&a(r+c,i)});d+=s.length,o(!0,t),n.writeUint8Array(s,function(){o(!1,s),h++,setTimeout(p,1)},u),a&&a(c,i)},l):(f=e.flush())?(d+=f.length,n.writeUint8Array(f,function(){o(!1,f),s(d)},u)):s(d)}()}function m(e,t,n,i,o,a,s,l,u){var c=0,h=new r;!function r(){var d=c*O;d<i?e.readUint8Array(n+d,Math.min(O,i-d),function(e){o&&h.append(e),s&&s(d,i,e),t.writeUint8Array(e,function(){c++,r()},u)},l):a(i,h.get())}()}function _(e){var t,n,r="",i=["\xc7","\xfc","\xe9","\xe2","\xe4","\xe0","\xe5","\xe7","\xea","\xeb","\xe8","\xef","\xee","\xec","\xc4","\xc5","\xc9","\xe6","\xc6","\xf4","\xf6","\xf2","\xfb","\xf9","\xff","\xd6","\xdc","\xf8","\xa3","\xd8","\xd7","\u0192","\xe1","\xed","\xf3","\xfa","\xf1","\xd1","\xaa","\xba","\xbf","\xae","\xac","\xbd","\xbc","\xa1","\xab","\xbb","_","_","_","\xa6","\xa6","\xc1","\xc2","\xc0","\xa9","\xa6","\xa6","+","+","\xa2","\xa5","+","+","-","-","+","-","+","\xe3","\xc3","+","+","-","-","\xa6","-","+","\xa4","\xf0","\xd0","\xca","\xcb","\xc8","i","\xcd","\xce","\xcf","+","+","_","_","\xa6","\xcc","_","\xd3","\xdf","\xd4","\xd2","\xf5","\xd5","\xb5","\xfe","\xde","\xda","\xdb","\xd9","\xfd","\xdd","\xaf","\xb4","\xad","\xb1","_","\xbe","\xb6","\xa7","\xf7","\xb8","\xb0","\xa8","\xb7","\xb9","\xb3","\xb2","_"," "];for(t=0;t<e.length;t++)n=255&e.charCodeAt(t),r+=n>127?i[n-128]:String.fromCharCode(n);return r}function g(e){return decodeURIComponent(escape(e))}function v(e){var t,n="";for(t=0;t<e.length;t++)n+=String.fromCharCode(e[t]);return n}function y(e,t,n,r,i){return e.version=t.view.getUint16(n,!0),e.bitFlag=t.view.getUint16(n+2,!0),e.compressionMethod=t.view.getUint16(n+4,!0),e.lastModDateRaw=t.view.getUint32(n+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,n=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&n)>>11,(2016&n)>>5,2*(31&n),0)}catch(e){}}(e.lastModDateRaw),1==(1&e.bitFlag)?void i(x):((r||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(n+10,!0),e.compressedSize=t.view.getUint32(n+14,!0),e.uncompressedSize=t.view.getUint32(n+18,!0)),4294967295===e.compressedSize||4294967295===e.uncompressedSize?void i(T):(e.filenameLength=t.view.getUint16(n+22,!0),void(e.extraFieldLength=t.view.getUint16(n+24,!0))))}function C(e){return unescape(encodeURIComponent(e))}function w(e){var t,n=[];for(t=0;t<e.length;t++)n.push(e.charCodeAt(t));return n}var b,E,S="File format is not recognized.",x="File contains encrypted entry.",T="File is using Zip64 (4gb+ file size).",A="Error while reading zip file.",P="Error while writing zip file.",D="Error while writing file data.",M="Error while reading file data.",I="File already exists.",O=524288,R="deflate.js",N="text/plain",L="message";try{b=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}r.prototype.table=function(){var e,t,n,r=[];for(e=0;e<256;e++){for(n=e,t=0;t<8;t++)1&n?n=n>>>1^3988292384:n>>>=1;r[e]=n}return r}(),(a.prototype=new o).constructor=a,(s.prototype=new o).constructor=s,(l.prototype=new o).constructor=l,u.prototype.getData=function(e){e(this.data)},(c.prototype=new u).constructor=c,(h.prototype=new u).constructor=h,(d.prototype=new u).constructor=d,n.zip={Reader:o,Writer:u,BlobReader:l,Data64URIReader:s,TextReader:a,BlobWriter:d,Data64URIWriter:h,TextWriter:c,createReader:function(e,t,o){e.init(function(){t(function(e,t){function o(){}return o.prototype.getData=function(o,a,s,l){function u(e,t){_&&_.terminate(),_=null,e&&e(t)}function c(e,t){var n,r;l&&(n=t,(r=i(4)).view.setUint32(0,n),g.crc32!=r.view.getUint32(0))?h():o.getData(function(e){u(a,e)})}function h(){u(t,M)}function d(){u(t,D)}var _,g=this;e.readUint8Array(g.offset,30,function(a){var u,v=i(a.length,a);return 1347093252!=v.view.getUint32(0)?void t(S):(y(g,v,4,!1,t),u=g.offset+30+g.filenameLength+g.extraFieldLength,void o.init(function(){0===g.compressionMethod?m(e,o,u,g.compressedSize,l,c,s,h,d):_=function(e,t,i,o,a,s,l,u,c){function h(e,t){a&&!e&&_.append(t)}function d(e){s(e,_.get())}var m,_=new r;return n.zip.useWebWorkers?p(m=new Worker(n.zip.workerScriptsPath+"inflate.js"),e,t,i,o,h,l,d,u,c):f(new n.zip.Inflater,e,t,i,o,h,l,d,u,c),m}(e,o,u,g.compressedSize,l,c,s,h,d)},d))},h)},{getEntries:function(n){return e.size<22?void t(S):void function n(r,o){e.readUint8Array(e.size-r,r,function(e){var t=i(e.length,e).view;1347093766!=t.getUint32(0)?n(r+1,o):o(t)},function(){t(A)})}(22,function(r){var a,s;a=r.getUint32(16,!0),s=r.getUint16(8,!0),e.readUint8Array(a,e.size-a,function(e){var r,a,l,u,c=0,h=[],d=i(e.length,e);for(r=0;r<s;r++){if(a=new o,1347092738!=d.view.getUint32(c))return void t(S);y(a,d,c+6,!0,t),a.commentLength=d.view.getUint16(c+32,!0),a.directory=16==(16&d.view.getUint8(c+38)),a.offset=d.view.getUint32(c+42,!0),l=v(d.array.subarray(c+46,c+46+a.filenameLength)),a.filename=2048==(2048&a.bitFlag)?g(l):_(l),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),u=v(d.array.subarray(c+46+a.filenameLength+a.extraFieldLength,c+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048==(2048&a.bitFlag)?g(u):_(u),h.push(a),c+=46+a.filenameLength+a.extraFieldLength+a.commentLength}n(h)},function(){t(A)})})},close:function(e){e&&e()}}}(e,o))},o)},createWriter:function(e,t,o,a){e.init(function(){t(function(e,t,o){function a(e,t){u&&u.terminate(),u=null,e&&e(t)}function s(){a(t,P)}function l(){a(t,M)}var u,c={},h=[],d=0;return{add:function(_,g,v,y,b){function E(t,n){var r=i(16);d+=t||0,r.view.setUint32(0,1347094280),"undefined"!=typeof n&&(x.view.setUint32(10,n,!0),r.view.setUint32(4,n,!0)),g&&(r.view.setUint32(8,t,!0),x.view.setUint32(14,t,!0),r.view.setUint32(12,g.size,!0),x.view.setUint32(18,g.size,!0)),e.writeUint8Array(r.array,function(){d+=16,a(v)},s)}function S(){return b=b||{},_=_.trim(),b.directory&&"/"!=_.charAt(_.length-1)&&(_+="/"),c.hasOwnProperty(_)?void t(I):(T=w(C(_)),h.push(_),a=function(){g?o||0===b.level?m(g,e,0,g.size,!0,E,y,l,s):u=function(e,t,i,o,a,s,l){function u(e,t){e&&d.append(t)}function c(e){o(e,d.get())}var h,d=new r;return n.zip.useWebWorkers?((h=new Worker(n.zip.workerScriptsPath+R)).addEventListener(L,function n(){h.removeEventListener(L,n,!1),p(h,e,t,0,e.size,u,a,c,s,l)},!1),h.postMessage({init:!0,level:i})):f(new n.zip.Deflater,e,t,0,e.size,u,a,c,s,l),h}(g,e,b.level,E,y,l,s):E()},A=b.lastModDate||new Date,x=i(26),c[_]={headerArray:x.array,directory:b.directory,filename:T,offset:d,comment:w(C(b.comment||""))},x.view.setUint32(0,335546376),b.version&&x.view.setUint8(0,b.version),o||0===b.level||b.directory||x.view.setUint16(4,2048),x.view.setUint16(6,(A.getHours()<<6|A.getMinutes())<<5|A.getSeconds()/2,!0),x.view.setUint16(8,(A.getFullYear()-1980<<4|A.getMonth()+1)<<5|A.getDate(),!0),x.view.setUint16(22,T.length,!0),(v=i(30+T.length)).view.setUint32(0,1347093252),v.array.set(x.array,4),v.array.set(T,30),d+=v.array.length,void e.writeUint8Array(v.array,a,s));var a,v}var x,T,A;g?g.init(S,l):S()},close:function(t){var n,r,o,l=0,u=0;for(r=0;r<h.length;r++)o=c[h[r]],l+=46+o.filename.length+o.comment.length;for(n=i(l+22),r=0;r<h.length;r++)o=c[h[r]],n.view.setUint32(u,1347092738),n.view.setUint16(u+4,5120),n.array.set(o.headerArray,u+6),n.view.setUint16(u+32,o.comment.length,!0),o.directory&&n.view.setUint8(u+38,16),n.view.setUint32(u+42,o.offset,!0),n.array.set(o.filename,u+46),n.array.set(o.comment,u+46+o.filename.length),u+=46+o.filename.length+o.comment.length;n.view.setUint32(u,1347093766),n.view.setUint16(u+8,h.length,!0),n.view.setUint16(u+10,h.length,!0),n.view.setUint32(u+12,l,!0),n.view.setUint32(u+16,d,!0),e.writeUint8Array(n.array,function(){a(function(){e.getData(t)})},s)}}}(e,o,a))},o)},useWebWorkers:!0},t(n.zip,{workerScriptsPath:{get:function(){return"undefined"==typeof E&&(E=e("ThirdParty/Workers/")),E}}})}(n),n.zip}),o("DataSources/KmlDataSource",["../Core/AssociativeArray","../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/ClockRange","../Core/ClockStep","../Core/Color","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Ellipsoid","../Core/Event","../Core/getAbsoluteUri","../Core/getExtensionFromUri","../Core/getFilenameFromUri","../Core/Iso8601","../Core/joinUrls","../Core/JulianDate","../Core/loadBlob","../Core/loadXML","../Core/Math","../Core/NearFarScalar","../Core/PinBuilder","../Core/PolygonHierarchy","../Core/Rectangle","../Core/RuntimeError","../Core/TimeInterval","../Core/TimeIntervalCollection","../Scene/HeightReference","../Scene/HorizontalOrigin","../Scene/LabelStyle","../Scene/SceneMode","../ThirdParty/Autolinker","../ThirdParty/Uri","../ThirdParty/when","../ThirdParty/zip","./BillboardGraphics","./CompositePositionProperty","./ConstantPositionProperty","./CorridorGraphics","./DataSource","./DataSourceClock","./Entity","./EntityCluster","./EntityCollection","./LabelGraphics","./PathGraphics","./PolygonGraphics","./PolylineGraphics","./PositionPropertyArray","./RectangleGraphics","./ReferenceProperty","./SampledPositionProperty","./ScaledPositionProperty","./TimeIntervalCollectionProperty","./WallGraphics"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie){"use strict";function oe(e,t,n,r){var i=u(qe.detectFromFilename(t.filename),"application/octet-stream");t.getData(new k.Data64URIWriter(i),function(e){n[t.filename]=e,r.resolve()})}function ae(e,t,n,r){for(var i=r.keys,o=new F("."),a=e.querySelectorAll(t),s=0;s<a.length;s++){var l=a[s],u=l.getAttribute(n),c=new F(u).resolve(o).toString(),h=i.indexOf(c);if(-1!==h){var d=i[h];l.setAttribute(n,r[d]),"a"===t&&null===l.getAttribute("download")&&l.setAttribute("download",d)}}}function se(e,t){return c(t)&&new F(e).isAbsolute()&&(e=t.getURL(e)),e}function le(e,t,n){var r=pe(e,"id");r=c(r)&&0!==r.length?r:l(),c(n)&&(r=n+r);var i=t.getById(r);return c(i)&&(r=l(),c(n)&&(r=n+r)),i=t.add(new j({id:r})),c(i.kml)||(i.addProperty("kml"),i.kml=new function(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}),i}function ue(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function ce(e){if(!c(e))return r.fromDegrees(0,0,0);var t=e.match(/[^\s,\n]+/g);if(!c(t))return r.fromDegrees(0,0,0);var n=parseFloat(t[0]),i=parseFloat(t[1]),o=parseFloat(t[2]);return n=isNaN(n)?0:n,i=isNaN(i)?0:i,o=isNaN(o)?0:o,r.fromDegrees(n,i,o)}function he(e){if(c(e)){var t=e.textContent.match(/[^\s\n]+/g);if(c(t)){for(var n=t.length,r=new Array(n),i=0,o=0;o<n;o++)r[i++]=ce(t[o]);return r}}}function de(e,t){if(c(e)){var n=e.getAttribute(t);if(null!==n){var r=parseFloat(n);return isNaN(r)?void 0:r}}}function pe(e,t){if(c(e)){var n=e.getAttribute(t);return null!==n?n:void 0}}function fe(e,t,n){if(c(e))for(var r=e.childNodes,i=r.length,o=0;o<i;o++){var a=r[o];if(a.localName===t&&-1!==n.indexOf(a.namespaceURI))return a}}function me(e,t,n){if(c(e)){for(var r=[],i=e.getElementsByTagNameNS("*",t),o=i.length,a=0;a<o;a++){var s=i[a];s.localName===t&&-1!==n.indexOf(s.namespaceURI)&&r.push(s)}return r}}function _e(e,t,n){if(!c(e))return[];for(var r=[],i=e.childNodes,o=i.length,a=0;a<o;a++){var s=i[a];s.localName===t&&-1!==n.indexOf(s.namespaceURI)&&r.push(s)}return r}function ge(e,t,n){var r=fe(e,t,n);if(c(r)){var i=parseFloat(r.textContent);return isNaN(i)?void 0:i}}function ve(e,t,n){var r=fe(e,t,n);if(c(r))return r.textContent.trim()}function ye(e,t,n){var r=fe(e,t,n);if(c(r)){var i=r.textContent.trim();return"1"===i||/^true$/i.test(i)}}function Ce(e,t,n,r){if(c(e)){var i=!1;if(c(r)){var o=r[e];if(c(o))i=!0,e=o;else{var a=m(e,n);c(o=r[a])&&(i=!0,e=o)}}return!i&&c(n)&&(e=se(e=m(e,m(n)),t)),e}}function we(e,t){if(c(e)){"#"===e[0]&&(e=e.substring(1));var n=parseInt(e.substring(0,2),16)/255,r=parseInt(e.substring(2,4),16)/255,i=parseInt(e.substring(4,6),16)/255,o=parseInt(e.substring(6,8),16)/255;return t?(o>0?rt.maximumRed=o:rt.red=0,i>0?rt.maximumGreen=i:rt.green=0,r>0?rt.maximumBlue=r:rt.blue=0,rt.alpha=n,s.fromRandom(rt)):new s(o,i,r,n)}}function be(e,t,n){var r=ve(e,t,n);if(c(r))return we(r,"random"===ve(e,"colorMode",n))}function Ee(){var e=new V;return e.width=Ze,e.height=Ze,e.scaleByDistance=new S(Ke,Qe,Je,$e),e.pixelOffsetScaleByDistance=new S(Ke,Qe,Je,$e),e}function Se(){var e=new K;return e.outline=!0,e.outlineColor=s.WHITE,e}function xe(){var e=new X;return e.translucencyByDistance=new S(3e6,1,5e6,0),e.pixelOffset=new n(17,0),e.horizontalOrigin=O.LEFT,e.font="16px sans-serif",e.style=R.FILL_AND_OUTLINE,e}function Te(e,t,n,r,i){var o=ve(e,"href",nt.kml);if(c(o)&&0!==o.length){if(0===o.indexOf("root://icons/palette-")){var a=o.charAt(21),s=u(ge(e,"x",nt.gx),0),l=u(ge(e,"y",nt.gx),0);s=Math.min(s/32,7),o="https://maps.google.com/mapfiles/kml/pal"+a+"/icon"+(8*(l=7-Math.min(l/32,7))+s)+".png"}if(o=Ce(o,t._proxy,n,r),i){var h=ve(e,"refreshMode",nt.kml),d=ve(e,"viewRefreshMode",nt.kml);"onInterval"===h||"onExpire"===h?console.log("KML - Unsupported Icon refreshMode: "+h):"onStop"!==d&&"onRegion"!==d||console.log("KML - Unsupported Icon viewRefreshMode: "+d);var p=u(ve(e,"viewBoundScale",nt.kml),1),f="onStop"===d?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",m=ze(u(ve(e,"viewFormat",nt.kml),f),ve(e,"httpQuery",nt.kml)),_=y(o,m,!1);return Ue(t._camera,t._canvas,_,p,t._lastCameraView.bbox)}return o}}function Ae(e,i,o,a,l){for(var h=0,d=i.childNodes.length;h<d;h++){var p=i.childNodes.item(h);if("IconStyle"===p.localName)w=e,b=p,S=o,x=a,T=l,A=void 0,P=void 0,D=void 0,W=void 0,D=ge(b,"scale",nt.kml),M=ge(b,"heading",nt.kml),I=be(b,"color",nt.kml),O=fe(b,"Icon",nt.kml),R=Te(O,w,x,T,!1),N=ge(O,"x",nt.gx),L=ge(O,"y",nt.gx),F=ge(O,"w",nt.gx),B=ge(O,"h",nt.gx),k=fe(b,"hotSpot",nt.kml),V=de(k,"x"),z=de(k,"y"),U=pe(k,"xunits"),G=pe(k,"yunits"),W=S.billboard,c(W)||(W=Ee(),S.billboard=W),W.image=R,W.scale=D,W.color=I,(c(N)||c(L)||c(F)||c(B))&&(W.imageSubRegion=new t(N,L,F,B)),c(M)&&0!==M&&(W.rotation=E.toRadians(-M),W.alignedAxis=r.UNIT_Z),D=u(D,1),c(V)&&("pixels"===U?A=-V*D:"insetPixels"===U?A=(V-Ze)*D:"fraction"===U&&(A=-V*Ze*D),A+=.5*Ze*D),c(z)&&("pixels"===G?P=z*D:"insetPixels"===G?P=(-z+Ze)*D:"fraction"===G&&(P=z*Ze*D),P-=.5*Ze*D),(c(A)||c(P))&&(W.pixelOffset=new n(A,P));else if("LabelStyle"===p.localName){var f=o.label;c(f)||(f=xe(),o.label=f),f.scale=u(ge(p,"scale",nt.kml),f.scale),f.fillColor=u(be(p,"color",nt.kml),f.fillColor),f.text=o.name}else if("LineStyle"===p.localName){var m=o.polyline;c(m)||(m=new Q,o.polyline=m),m.width=ge(p,"width",nt.kml),m.material=be(p,"color",nt.kml),c(be(p,"outerColor",nt.gx))&&console.log("KML - gx:outerColor is not supported in a LineStyle"),c(ge(p,"outerWidth",nt.gx))&&console.log("KML - gx:outerWidth is not supported in a LineStyle"),c(ge(p,"physicalWidth",nt.gx))&&console.log("KML - gx:physicalWidth is not supported in a LineStyle"),c(ye(p,"labelVisibility",nt.gx))&&console.log("KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===p.localName){var _=o.polygon;c(_)||(_=Se(),o.polygon=_),_.material=u(be(p,"color",nt.kml),_.material),_.fill=u(ye(p,"fill",nt.kml),_.fill),_.outline=u(ye(p,"outline",nt.kml),_.outline)}else if("BalloonStyle"===p.localName){var g=u(we(ve(p,"bgColor",nt.kml)),s.WHITE),v=u(we(ve(p,"textColor",nt.kml)),s.BLACK),y=ve(p,"text",nt.kml);o.addProperty("balloonStyle"),o.balloonStyle={bgColor:g,textColor:v,text:y}}else if("ListStyle"===p.localName){var C=ve(p,"listItemType",nt.kml);"radioFolder"!==C&&"checkOffOnly"!==C||console.log("KML - Unsupported ListStyle with listItemType: "+C)}}var w,b,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W}function Pe(e,t,n){return b(se(t,e._proxy)).then(function(r){return De(e,r,n,t,!0)})}function De(e,t,n,r,i,o){var a,s,l,u,h=me(t,"Style",nt.kml);if(c(h)){var d=h.length;for(a=0;a<d;a++)u=h[a],s=pe(u,"id"),c(s)&&(s="#"+s,i&&c(r)&&(s=r+s),c(n.getById(s))||(l=new j({id:s}),n.add(l),Ae(e,u,l,r,o)))}var p=me(t,"StyleMap",nt.kml);if(c(p)){var f=p.length;for(a=0;a<f;a++){var _=p[a];if(s=pe(_,"id"),c(s))for(var g=_e(_,"Pair",nt.kml),v=0;v<g.length;v++){var y=g[v],C=ve(y,"key",nt.kml);if("normal"===C){if(s="#"+s,i&&c(r)&&(s=r+s),!c(n.getById(s))){l=n.getOrCreateEntity(s);var w=ve(y,"styleUrl",nt.kml);if(c(w)){"#"!==w[0]&&(w="#"+w),i&&c(r)&&(w=r+w);var b=n.getById(w);c(b)&&l.merge(b)}else u=fe(y,"Style",nt.kml),Ae(e,u,l,r,o)}}else console.log("KML - Unsupported StyleMap key: "+C)}}}var E={},S=[],x=t.getElementsByTagName("styleUrl"),T=x.length;for(a=0;a<T;a++){var A=x[a].textContent;if("#"!==A[0]){var P=A.split("#");if(2===P.length){var D=P[0];c(E[D])||(c(r)&&(D=m(D,m(r))),S.push(Pe(e,D,n)))}}}return S}function Me(e,t,n){var r=new ee(e,t.id,["position"]),i=new ne(t.position);t.polyline=c(n.polyline)?n.polyline.clone():new Q,t.polyline.positions=new J([r,i])}function Ie(e,t){return!c(e)&&!c(t)||"clampToGround"===e?I.CLAMP_TO_GROUND:"relativeToGround"===e?I.RELATIVE_TO_GROUND:"absolute"===e?I.NONE:"clampToSeaFloor"===t?(console.log("KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),I.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?(console.log("KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),I.RELATIVE_TO_GROUND):(c(e)?console.log("KML - Unknown <kml:altitudeMode>:"+e+", using <kml:altitudeMode>:CLAMP_TO_GROUND."):console.log("KML - Unknown <gx:altitudeMode>:"+t+", using <kml:altitudeMode>:CLAMP_TO_GROUND."),I.CLAMP_TO_GROUND)}function Oe(e,t,r,i){var o=t.label;c(o)||(o=c(r.label)?r.label.clone():xe(),t.label=o),o.text=t.name;var a=t.billboard;c(a)||(a=c(r.billboard)?r.billboard.clone():Ee(),t.billboard=a),c(a.image)||(a.image=e._pinBuilder.fromColor(s.YELLOW,64));var l=1;c(a.scale)&&(0!==(l=a.scale.getValue())?o.pixelOffset=new n(16*l+1,0):(o.pixelOffset=void 0,o.horizontalOrigin=void 0)),c(i)&&e._clampToGround&&(a.heightReference=i,o.heightReference=i)}function Re(e,t,n){var r=t.path;c(r)||((r=new Z).leadTime=0,t.path=r);var i=n.polyline;c(i)&&(r.material=i.material,r.width=i.width)}function Ne(e,t,n,r,i){var o=fe(n,"coordinates",nt.kml),a=ve(n,"altitudeMode",nt.kml),l=ve(n,"altitudeMode",nt.gx),h=ye(n,"extrude",nt.kml),d=ye(n,"tessellate",nt.kml),f=ue(a,l);c(ge(n,"drawOrder",nt.gx))&&console.log("KML - gx:drawOrder is not supported in LineStrings");var m=he(o),_=i.polyline;if(f&&h){var g=new ie;r.wall=g,g.positions=m;var y=i.polygon;c(y)&&(g.fill=y.fill,g.outline=y.outline,g.material=y.material),c(_)&&(g.outlineColor=c(_.material)?_.material.color:s.WHITE,g.outlineWidth=_.width)}else if(e._clampToGround&&!f&&d){var C=new G;r.corridor=C,C.positions=m,c(_)?(C.material=c(_.material)?_.material.color.getValue(v.MINIMUM_VALUE):s.WHITE,C.width=u(_.width,1)):(C.material=s.WHITE,C.width=1)}else _=c(_)?_.clone():new Q,r.polyline=_,_.positions=function(e,t,n){if(c(e)){if("relativeToSeaFloor"===n||"absolute"===t||"relativeToGround"===t)return e;(c(t)&&"clampToGround"!==t||c(n)&&"clampToSeaFloor"!==n)&&console.log("KML - Unknown altitudeMode: "+u(t,n));for(var r=e.length,i=0;i<r;i++){var o=e[i];p.WGS84.scaleToGeodeticSurface(o,o)}return e}}(m,a,l),d&&!f||(_.followSurface=!1);return!0}function Le(e,t,n,r,i,o,a,s,l){var h,d,p,f=e[0],m=e[e.length-1],_=new te;_.addSamples(e,t),n.intervals.addInterval(new D({start:f,stop:m,isStartIncluded:l,isStopIncluded:l,data:(h=_,d=a,p=s,"relativeToSeaFloor"===p||"absolute"===d||"relativeToGround"===d?h:((c(d)&&"clampToGround"!==d||c(p)&&"clampToSeaFloor"!==p)&&console.log("KML - Unknown altitudeMode: "+u(d,p)),new ne(h)))})),r.addInterval(new D({start:f,stop:m,isStartIncluded:l,isStopIncluded:l})),i.intervals.addInterval(new D({start:f,stop:m,isStartIncluded:l,isStopIncluded:l,data:o}))}function Fe(e,t,n,r,i,o,a,l,h){var d=le(n,r,h),p=d.kml,f=function(e,t,n,r,i,o){for(var a,s=new j,l=-1,u=n.childNodes,h=u.length,d=0;d<h;d++){var p=u[d];"Style"!==p.localName&&"StyleMap"!==p.localName||(l=d)}if(-1!==l){var f=u[l];if("Style"===f.localName)Ae(t,f,s,i,o);else for(var _=_e(f,"Pair",nt.kml),g=0;g<_.length;g++){var v=_[g],y=ve(v,"key",nt.kml);if("normal"===y){var C=ve(v,"styleUrl",nt.kml);c(C)?(a=r.getById(C),c(a)||(a=r.getById("#"+C)),c(a)&&s.merge(a)):Ae(t,fe(v,"Style",nt.kml),s,i,o)}else console.log("KML - Unsupported StyleMap key: "+y)}}var w=ve(n,"styleUrl",nt.kml);if(c(w)){var b=w;if("#"!==w[0]&&-1!==w.indexOf("#")){var E=w.split("#"),S=E[0];c(i)&&(S=m(S,m(i))),b=S+"#"+E[1]}a=r.getById(b),c(a)||(a=r.getById("#"+b)),c(a)&&s.merge(a)}return s}(0,e,n,i,o,a),_=ve(n,"name",nt.kml);d.name=_,d.parent=t;var g=function(e){var t=fe(n,"TimeSpan",nt.kmlgx);if(c(t)){var r,i=fe(t,"begin",nt.kmlgx),o=c(i)?C.fromIso8601(i.textContent):void 0,a=fe(t,"end",nt.kmlgx),s=c(a)?C.fromIso8601(a.textContent):void 0;if(c(o)&&c(s)){if(C.lessThan(s,o)){var l=o;o=s,s=l}(r=new M).addInterval(new D({start:o,stop:s}))}else c(o)?(r=new M,r.addInterval(new D({start:o,stop:v.MAXIMUM_VALUE}))):c(s)&&(r=new M,r.addInterval(new D({start:v.MINIMUM_VALUE,stop:s})));return r}}();c(g)||(g=function(e){var t=fe(n,"TimeStamp",nt.kmlgx),r=ve(t,"when",nt.kmlgx);if(c(t)&&c(r)&&0!==r.length){var i=C.fromIso8601(r),o=new M;return o.addInterval(new D({start:i,stop:v.MAXIMUM_VALUE})),o}}()),d.availability=g,je(d);var y=ye(n,"visibility",nt.kml);d.show=function e(t){return!t||t.show&&e(t.parent)}(t)&&u(y,!0);var w=fe(n,"author",nt.atom),b=p.author;b.name=ve(w,"name",nt.atom),b.uri=ve(w,"uri",nt.atom),b.email=ve(w,"email",nt.atom);var E=fe(n,"link",nt.atom),S=p.link;return S.href=pe(E,"href"),S.hreflang=pe(E,"hreflang"),S.rel=pe(E,"rel"),S.type=pe(E,"type"),S.title=pe(E,"title"),S.length=pe(E,"length"),p.address=ve(n,"address",nt.kml),p.phoneNumber=ve(n,"phoneNumber",nt.kml),p.snippet=ve(n,"Snippet",nt.kml),function(e,t){var r=fe(n,"ExtendedData",nt.kml);if(c(r)){c(fe(r,"SchemaData",nt.kml))&&console.log("KML - SchemaData is unsupported"),c(pe(r,"xmlns:prefix"))&&console.log("KML - ExtendedData with xmlns:prefix is unsupported");var i={},o=_e(r,"Data",nt.kml);if(c(o))for(var a=o.length,s=0;s<a;s++){var l=o[s],u=pe(l,"name");c(u)&&(i[u]={displayName:ve(l,"displayName",nt.kml),value:ve(l,"value",nt.kml)})}t.kml.extendedData=i}}(0,d),function(e,t,r,i){var o,a,l,h,d=t.kml,p=d.extendedData,f=ve(n,"description",nt.kml),m=u(t.balloonStyle,r.balloonStyle),_=s.WHITE,g=s.BLACK,v=f;if(c(m)&&(_=u(m.bgColor,s.WHITE),g=u(m.textColor,s.BLACK),v=u(m.text,f)),c(v)){if(v=(v=(v=(v=(v=(v=v.replace("$[name]",u(t.name,""))).replace("$[description]",u(f,""))).replace("$[address]",u(d.address,""))).replace("$[Snippet]",u(d.snippet,""))).replace("$[id]",t.id)).replace("$[geDirections]",""),c(p)){var y=v.match(/\$\[.+?\]/g);if(null!==y)for(o=0;o<y.length;o++){var C=y[o],w=C.substr(2,C.length-3),b=/\/displayName$/.test(w);w=w.replace(/\/displayName$/,""),c(h=p[w])&&(h=b?h.displayName:h.value),c(h)&&(v=v.replace(C,u(h,"")))}}}else if(c(p)&&(l=Object.keys(p),l.length>0)){for(v='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',o=0;o<l.length;o++)a=l[o],h=p[a],v+="<tr><th>"+u(h.displayName,a)+"</th><td>"+u(h.value,"")+"</td></tr>";v+="</tbody></table>"}if(c(v)){v=Xe.link(v),it.innerHTML=v;var E=it.querySelectorAll("a");for(o=0;o<E.length;o++)E[o].setAttribute("target","_blank");c(i)&&i.keys.length>1&&(ae(it,"a","href",i),ae(it,"img","src",i));var S='<div class="cesium-infoBox-description-lighter" style="';S+="overflow:auto;",S+="word-wrap:break-word;",S+="background-color:"+_.toCssColorString()+";",S+="color:"+g.toCssColorString()+";",S+='">',S+=it.innerHTML+"</div>",it.innerHTML="",t.description=S}}(0,d,f,a),c(fe(n,"Camera",nt.kml))&&console.log("KML - Unsupported view: Camera"),c(fe(n,"LookAt",nt.kml))&&console.log("KML - Unsupported view: LookAt"),c(fe(n,"Region",nt.kml))&&console.log("KML - Placemark Regions are unsupported"),{entity:d,styleEntity:f}}function Be(e,t,n,r,i,o,a,s,l){for(var u=Object.keys(ct),c=u.length,h=0;h<c;h++)for(var d=u[h],p=ct[d],f=n.childNodes,m=f.length,_=0;_<m;_++){var g=f[_];g.localName!==d||-1===nt.kml.indexOf(g.namespaceURI)&&-1===nt.gx.indexOf(g.namespaceURI)||p(e,t,g,r,i,o,a,s,l)}}function ke(e,t,n,r,i,o,a,s,l){e._unsupportedNode.raiseEvent(e,t,n,r,i,o,a),console.log("KML - Unsupported feature: "+n.localName)}function Ve(e){if(!c(e)||0===e.length)return"";var t=e[0];return"&"===t&&e.splice(0,1),"?"!==t&&(e="?"+e),e}function ze(e,t){var n="";return(c(e)&&e.length>0||c(t)&&t.length>0)&&(n+=y(Ve(e),Ve(t),!1)),n}function Ue(e,t,n,i,o){function a(e){return e<-E.PI_OVER_TWO?-E.PI_OVER_TWO:e>E.PI_OVER_TWO?E.PI_OVER_TWO:e}function s(e){return e>E.PI?e-E.TWO_PI:e<-E.PI?e+E.TWO_PI:e}if(c(e)&&e._mode!==N.MORPHING){var l,h,d=p.WGS84;if(o=u(o,at),c(t)&&(lt.x=.5*t.clientWidth,lt.y=.5*t.clientHeight,l=e.pickEllipsoid(lt,d,ut)),c(l)?h=d.cartesianToCartographic(l,st):(h=A.center(o,st),l=d.cartographicToCartesian(h)),c(i)&&!E.equalsEpsilon(i,1,E.EPSILON9)){var f=o.width*i*.5,m=o.height*i*.5;o=new A(s(h.longitude-f),a(h.latitude-m),s(h.longitude+f),a(h.latitude+m))}n=(n=(n=(n=n.replace("[bboxWest]",E.toDegrees(o.west).toString())).replace("[bboxSouth]",E.toDegrees(o.south).toString())).replace("[bboxEast]",E.toDegrees(o.east).toString())).replace("[bboxNorth]",E.toDegrees(o.north).toString());var _=E.toDegrees(h.longitude).toString(),g=E.toDegrees(h.latitude).toString();n=(n=(n=(n=(n=(n=(n=(n=n.replace("[lookatLon]",_)).replace("[lookatLat]",g)).replace("[lookatTilt]",E.toDegrees(e.pitch).toString())).replace("[lookatHeading]",E.toDegrees(e.heading).toString())).replace("[lookatRange]",r.distance(e.positionWC,l))).replace("[lookatTerrainLon]",_)).replace("[lookatTerrainLat]",g)).replace("[lookatTerrainAlt]",h.height.toString()),d.cartesianToCartographic(e.positionWC,st),n=(n=(n=n.replace("[cameraLon]",E.toDegrees(st.longitude).toString())).replace("[cameraLat]",E.toDegrees(st.latitude).toString())).replace("[cameraAlt]",E.toDegrees(st.height).toString());var v=e.frustum,y=v.aspectRatio,C="",w="";if(c(y)){var b=E.toDegrees(v.fov);y>1?(C=b,w=b/y):(w=b,C=b*y)}n=(n=n.replace("[horizFov]",C.toString())).replace("[vertFov]",w.toString())}else n=n.replace("[bboxWest]","-180"),n=n.replace("[bboxSouth]","-90"),n=n.replace("[bboxEast]","180"),n=n.replace("[bboxNorth]","90"),n=n.replace("[lookatLon]",""),n=n.replace("[lookatLat]",""),n=n.replace("[lookatRange]",""),n=n.replace("[lookatTilt]",""),n=n.replace("[lookatHeading]",""),n=n.replace("[lookatTerrainLon]",""),n=n.replace("[lookatTerrainLat]",""),n=n.replace("[lookatTerrainAlt]",""),n=n.replace("[cameraLon]",""),n=n.replace("[cameraLat]",""),n=n.replace("[cameraAlt]",""),n=n.replace("[horizFov]",""),n=n.replace("[vertFov]","");return(n=(n=(n=(n=(n=c(t)?(n=n.replace("[horizPixels]",t.clientWidth)).replace("[vertPixels]",t.clientHeight):(n=n.replace("[horizPixels]","")).replace("[vertPixels]","")).replace("[terrainEnabled]","1")).replace("[clientVersion]","1")).replace("[kmlVersion]","2.2")).replace("[clientName]","Cesium")).replace("[language]","English")}function Ge(e,t,n,r,i,o){t.removeAll();var a=[],s=n.documentElement,l=ve("Document"===s.localName?s:fe(s,"Document",nt.kml),"name",nt.kml);!c(l)&&c(r)&&(l=g(r)),c(e._name)||(e._name=l);var u=new Y(e);return B.all(De(e,n,u,r,!1,i)).then(function(){var s,l,h,d,p,f,m,_,g,v=n.documentElement;if("kml"===v.localName)for(var y=v.childNodes,C=0;C<y.length;C++){var w=y[C];if(c(ct[w.localName])){v=w;break}}return t.suspendEvents(),s=e,h=t,d=u,p=r,f=i,m=a,_=o,c(g=ct[(l=v).localName])?g(s,void 0,l,h,d,p,f,m,_):ke(s,void 0,l,h,d,p,f),t.resumeEvents(),B.all(a).then(function(){return n.documentElement})})}function We(e,t,n,r){var i=(r=u(r,u.EMPTY_OBJECT)).sourceUri,o=r.uriResolver,a=r.context,s=n;return"string"==typeof n&&(s=w(se(n,e._proxy)),i=u(i,n)),B(s).then(function(n){return n instanceof Blob?(r=n,s=r.slice(0,Math.min(4,r.size)),l=B.defer(),u=new FileReader,u.addEventListener("load",function(){l.resolve(1347093252===new DataView(u.result).getUint32(0,!1))}),u.addEventListener("error",function(){l.reject(u.error)}),u.readAsArrayBuffer(s),l.promise).then(function(r){return r?(s=e,l=t,u=n,h=i,d=B.defer(),k.createReader(new k.BlobReader(u),function(e){e.getEntries(function(t){for(var n,r,i=[],o={},a=0;a<t.length;a++){var u=t[a];if(!u.directory){var p=B.defer();i.push(p.promise),/\.kml$/i.test(u.filename)?c(n)&&/\//i.test(u.filename)?oe(0,u,o,p):(c(n)&&oe(0,n,o,r),n=u,r=p):oe(0,u,o,p)}}var f,m;c(n)&&(f=o,m=r,n.getData(new k.TextWriter,function(e){f.kml=Ye.parseFromString(e,"application/xml"),m.resolve()})),B.all(i).then(function(){return e.close(),c(o.kml)?(o.keys=Object.keys(o),Ge(s,l,o.kml,h,o)):void d.reject(new P("KMZ file does not contain a KML document."))}).then(d.resolve).otherwise(d.reject)})},function(e){d.reject(e)}),d.promise):(p=n,f=B.defer(),m=new FileReader,m.addEventListener("load",function(){f.resolve(m.result)}),m.addEventListener("error",function(){f.reject(m.error)}),m.readAsText(p),f.promise).then(function(n){var r,s;try{r=Ye.parseFromString(n,"application/xml")}catch(e){s=e.toString()}if(c(s)||r.body||"parsererror"===r.documentElement.tagName){var l=c(s)?s:r.documentElement.firstChild.nodeValue;throw l||(l=r.body.innerText),new P(l)}return Ge(e,t,r,i,o,a)});var s,l,u,h,d,p,f,m}):Ge(e,t,n,i,o,a);var r,s,l,u}).otherwise(function(t){return e._error.raiseEvent(e,t),console.log(t),B.reject(t)})}function He(t){var n=(t=u(t,{})).camera,i=t.canvas;this._changed=new f,this._error=new f,this._loading=new f,this._refresh=new f,this._unsupportedNode=new f,this._clock=void 0,this._entityCollection=new Y(this),this._name=void 0,this._isLoading=!1,this._proxy=t.proxy,this._pinBuilder=new x,this._networkLinks=new e,this._entityCluster=new q,this._canvas=i,this._camera=n,this._lastCameraView={position:c(n)?r.clone(n.positionWC):void 0,direction:c(n)?r.clone(n.directionWC):void 0,up:c(n)?r.clone(n.upWC):void 0,bbox:c(n)?n.computeViewRectangle():A.clone(A.MAX_VALUE)}}function je(e){var t=e.parent;if(c(t)){var n=t.availability;if(c(n)){var r=e.availability;c(r)?r.intersect(n):e.availability=n}}}if("undefined"==typeof DOMParser)return{};var qe={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){var t=e.toLowerCase();return t=_(t),qe[t]}},Ye=new DOMParser,Xe=new L({stripPrefix:!1,twitter:!1,email:!1,replaceFn:function(e,t){if(!t.protocolUrlMatch)return!1}}),Ze=32,Ke=2414016,Qe=1,Je=16093e3,$e=.1,et=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],tt=["http://www.google.com/kml/ext/2.2"],nt={kml:et,gx:tt,atom:["http://www.w3.org/2005/Atom"],kmlgx:et.concat(tt)},rt={},it=document.createElement("div"),ot={Point:function(e,t,n,r,i){var o=ve(n,"coordinates",nt.kml),a=ve(n,"altitudeMode",nt.kml),s=ve(n,"altitudeMode",nt.gx),l=ye(n,"extrude",nt.kml),u=ce(o);return r.position=u,Oe(e,r,i,Ie(a,s)),l&&ue(a,s)&&Me(t,r,i),!0},LineString:Ne,LinearRing:Ne,Polygon:function(e,t,n,r,i){var o=fe(fe(n,"outerBoundaryIs",nt.kml),"LinearRing",nt.kml),a=fe(o,"coordinates",nt.kml),l=he(a),u=ye(n,"extrude",nt.kml),h=ue(ve(n,"altitudeMode",nt.kml),ve(n,"altitudeMode",nt.gx)),d=c(i.polygon)?i.polygon.clone():Se(),p=i.polyline;if(c(p)&&(d.outlineColor=c(p.material)?p.material.color:s.WHITE,d.outlineWidth=p.width),r.polygon=d,h?(d.perPositionHeight=!0,d.extrudedHeight=u?0:void 0):e._clampToGround||(d.height=0),c(l)){for(var f=new T(l),m=_e(n,"innerBoundaryIs",nt.kml),_=0;_<m.length;_++){o=_e(m[_],"LinearRing",nt.kml);for(var g=0;g<o.length;g++)a=fe(o[g],"coordinates",nt.kml),l=he(a),c(l)&&f.holes.push(new T(l))}d.hierarchy=f}return!0},Track:function(e,t,n,r,i){var o=ve(n,"altitudeMode",nt.kml),a=ve(n,"altitudeMode",nt.gx),s=_e(n,"coord",nt.gx),l=_e(n,"angles",nt.gx),u=_e(n,"when",nt.kml),c=ye(n,"extrude",nt.kml),h=ue(o,a);l.length>0&&console.log("KML - gx:angles are not supported in gx:Tracks");for(var d=Math.min(s.length,u.length),p=[],f=[],m=0;m<d;m++){var _=ce(s[m].textContent);p.push(_),f.push(C.fromIso8601(u[m].textContent))}var g=new te;return g.addSamples(f,p),r.position=g,Oe(e,r,i,Ie(o,a)),Re(0,r,i),r.availability=new M,u.length>0&&r.availability.addInterval(new D({start:f[0],stop:f[f.length-1]})),h&&c&&Me(t,r,i),!0},MultiTrack:function(e,t,n,r,i){for(var o,a,s,l=ye(n,"interpolate",nt.gx),u=_e(n,"Track",nt.gx),h=!1,d=new re,p=new M,f=new z,m=0,_=u.length;m<_;m++){var g=u[m],v=_e(g,"when",nt.kml),y=_e(g,"coord",nt.gx),w=ve(g,"altitudeMode",nt.kml),b=ve(g,"altitudeMode",nt.gx),E=ue(w,b),S=ye(g,"extrude",nt.kml),x=Math.min(y.length,v.length),T=[];o=[];for(var A=0;A<x;A++){var P=ce(y[A].textContent);T.push(P),o.push(C.fromIso8601(v[A].textContent))}l&&(c(a)&&Le([a,o[0]],[s,T[0]],f,p,d,!1,"absolute",void 0,!1),a=o[x-1],s=T[T.length-1]),Le(o,T,f,p,d,E&&S,w,b,!0),h=h||E&&S}return r.availability=p,r.position=f,Oe(e,r,i),Re(0,r,i),h&&(Me(t,r,i),r.polyline.show=d),!0},MultiGeometry:function(e,t,n,r,i,o){for(var a=n.childNodes,s=!1,l=0,u=a.length;l<u;l++){var h=a.item(l),d=ot[h.localName];if(c(d)){var p=le(h,t,o);p.parent=r,p.name=r.name,p.availability=r.availability,p.description=r.description,p.kml=r.kml,d(e,t,h,p,i)&&(s=!0)}}return s},Model:function(e,t,n,r,i){return console.log("KML - Unsupported geometry: "+n.localName),!1}},at=new A,st=new i,lt=new n,ut=new r,ct={Document:Be,Folder:function(e,t,n,r,i,o,a,s,l){Be(e,Fe(e,t,n,r,i,o,a,0,l).entity,n,r,i,o,a,s,l)},Placemark:function(e,t,n,r,i,o,a,s,l){for(var u=Fe(e,t,n,r,i,o,a,0,l),h=u.entity,d=u.styleEntity,p=!1,f=n.childNodes,m=0,_=f.length;m<_&&!p;m++){var g=f.item(m),v=ot[g.localName];c(v)&&(v(e,r,g,h,d,h.id),p=!0)}p||(h.merge(d),Oe(e,h,d))},NetworkLink:function(e,t,n,r,i,o,a,s,h){var d=Fe(e,t,n,r,i,o,a,0,h).entity,p=fe(n,"Link",nt.kml);if(c(p)||(p=fe(n,"Url",nt.kml)),c(p)){var f=ve(p,"href",nt.kml);if(c(f)){var _,g=f;if(f=Ce(f,void 0,o,a),/^data:/.test(f))_=f,/\.kmz/i.test(o)||(g=m(g,o));else{g=f;var v=ve(p,"viewRefreshMode",nt.kml),w=u(ve(p,"viewBoundScale",nt.kml),1),b="onStop"===v?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",E=ze(u(ve(p,"viewFormat",nt.kml),b),ve(p,"httpQuery",nt.kml));_=Ue(e._camera,e._canvas,y(f,E,!1),w,e._lastCameraView.bbox)}var S={sourceUri:g,uriResolver:a,context:d.id},x=new Y,T=We(e,x,_,S).then(function(t){var n=e._entityCollection,r=x.values;n.suspendEvents();for(var i=0;i<r.length;i++){var o=r[i];c(o.parent)||(o.parent=d,je(o)),n.add(o)}n.resumeEvents();var a=ve(p,"refreshMode",nt.kml),s=u(ge(p,"refreshInterval",nt.kml),0);if("onInterval"===a&&s>0||"onExpire"===a||"onStop"===v){var h=fe(t,"NetworkLinkControl",nt.kml),m=c(h),_=C.now(),g={id:l(),href:f,cookie:"",queryString:E,lastUpdated:_,updating:!1,entity:d,viewBoundScale:w,needsUpdate:!1,cameraUpdateTime:_},y=0;if(m&&(g.cookie=u(ve(h,"cookie",nt.kml),""),y=u(ge(h,"minRefreshPeriod",nt.kml),0)),"onInterval"===a)m&&(s=Math.max(y,s)),g.refreshMode=0,g.time=s;else if("onExpire"===a){var b;if(m&&(b=ve(h,"expires",nt.kml)),c(b))try{var S=C.fromIso8601(b),T=C.secondsDifference(S,_);T>0&&T<y&&C.addSeconds(_,y,S),g.refreshMode=1,g.time=S}catch(e){console.log("KML - NetworkLinkControl expires is not a valid date")}else console.log("KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else e._camera?(g.refreshMode=2,g.time=u(ge(p,"viewRefreshTime",nt.kml),0)):console.log("A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource");c(g.refreshMode)&&e._networkLinks.set(g.id,g)}else"onRegion"===v&&console.log("KML - Unsupported viewRefreshMode: onRegion")});s.push(T)}}},GroundOverlay:function(e,t,n,r,i,o,a,s,l){var u,h=Fe(e,t,n,r,i,o,a,0,l).entity,d=!1,p=he(fe(n,"LatLonQuad",nt.gx));if(c(p))u=Se(),u.hierarchy=new T(p),h.polygon=u,d=!0;else{u=new $,h.rectangle=u;var f=fe(n,"LatLonBox",nt.kml);if(c(f)){var m=ge(f,"west",nt.kml),_=ge(f,"south",nt.kml),g=ge(f,"east",nt.kml),v=ge(f,"north",nt.kml);c(m)&&(m=E.negativePiToPi(E.toRadians(m))),c(_)&&(_=E.clampToLatitudeRange(E.toRadians(_))),c(g)&&(g=E.negativePiToPi(E.toRadians(g))),c(v)&&(v=E.clampToLatitudeRange(E.toRadians(v))),u.coordinates=new A(m,_,g,v);var y=ge(f,"rotation",nt.kml);c(y)&&(u.rotation=E.toRadians(y))}}var C=fe(n,"Icon",nt.kml),w=Te(C,e,o,a,!0);if(c(w)){d&&console.log("KML - gx:LatLonQuad Icon does not support texture projection.");var b=ge(C,"x",nt.gx),S=ge(C,"y",nt.gx),x=ge(C,"w",nt.gx),P=ge(C,"h",nt.gx);(c(b)||c(S)||c(x)||c(P))&&console.log("KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),u.material=w,u.material.color=be(n,"color",nt.kml),u.material.transparent=!0}else u.material=be(n,"color",nt.kml);var D=ve(n,"altitudeMode",nt.kml);c(D)?"absolute"===D?u.height=ge(n,"altitude",nt.kml):"clampToGround"!==D&&console.log("KML - Unknown altitudeMode: "+D):"relativeToSeaFloor"===(D=ve(n,"altitudeMode",nt.gx))?(console.log("KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),u.height=ge(n,"altitude",nt.kml)):"clampToSeaFloor"===D?console.log("KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):c(D)&&console.log("KML - Unknown altitudeMode: "+D)},PhotoOverlay:ke,ScreenOverlay:ke,Tour:ke};He.load=function(e,t){return new He(t=u(t,u.EMPTY_OBJECT)).load(e,t)},h(He.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){this._entityCluster=e}}}),He.prototype.load=function(e,t){t=u(t,{}),W.setLoading(this,!0);var n=this._name;this._name=void 0,this._clampToGround=u(t.clampToGround,!1);var r=this;return We(this,this._entityCollection,e,t).then(function(){var e,t,i=r._entityCollection.computeAvailability(),s=i.start,l=i.stop,u=C.equals(s,v.MINIMUM_VALUE),c=C.equals(l,v.MAXIMUM_VALUE);u&&c||(u&&((t=new Date).setHours(0,0,0,0),s=C.fromDate(t)),c&&((t=new Date).setHours(24,0,0,0),l=C.fromDate(t)),(e=new H).startTime=s,e.stopTime=l,e.currentTime=C.clone(s),e.clockRange=o.LOOP_STOP,e.clockStep=a.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(C.secondsDifference(l,s)/60,1),31556900)));var h=!1;return e!==r._clock&&(r._clock=e,h=!0),n!==r._name&&(h=!0),h&&r._changed.raiseEvent(r),W.setLoading(r,!1),r}).otherwise(function(e){return W.setLoading(r,!1),r._error.raiseEvent(r,e),console.log(e),B.reject(e)})};var ht=new e;return He.prototype.update=function(t){var n=this._networkLinks;if(0===n.length)return!0;var i=C.now(),o=this;ht.removeAll();var a=!1,s=this._lastCameraView,l=this._camera;!c(l)||l.positionWC.equalsEpsilon(s.position,E.EPSILON7)&&l.directionWC.equalsEpsilon(s.direction,E.EPSILON7)&&l.upWC.equalsEpsilon(s.up,E.EPSILON7)||(s.position=r.clone(l.positionWC),s.direction=r.clone(l.directionWC),s.up=r.clone(l.upWC),s.bbox=l.computeViewRectangle(),a=!0);var h=new e,d=!1;return n.values.forEach(function(e){var t,n,r,l,p,f=e.entity;if(!ht.contains(f.id)){if(!e.updating){var m=!1;if(0===e.refreshMode?C.secondsDifference(i,e.lastUpdated)>e.time&&(m=!0):1===e.refreshMode?C.greaterThan(i,e.time)&&(m=!0):2===e.refreshMode&&(a&&(e.needsUpdate=!0,e.cameraUpdateTime=i),e.needsUpdate&&C.secondsDifference(i,e.cameraUpdateTime)>=e.time&&(m=!0)),m){(function e(t){for(var n=t._children,r=n.length,i=0;i<r;++i){var o=n[i];ht.set(o.id,o),e(o)}})(f),e.updating=!0;var _=new Y,g=y(e.href,ze(e.cookie,e.queryString),!1);g=Ue(o._camera,o._canvas,g,e.viewBoundScale,s.bbox),We(o,_,g,{context:f.id}).then((t=o,n=e,r=_,l=h,p=g,function(e){function i(e){y.remove(e);for(var t=e._children,n=t.length,r=0;r<n;++r)i(t[r])}if(l.contains(n.id)){var o=!1,a=fe(e,"NetworkLinkControl",nt.kml),s=0;if(c(a)){if(c(fe(a,"Update",nt.kml)))return console.log("KML - NetworkLinkControl updates aren't supported."),n.updating=!1,void l.remove(n.id);n.cookie=u(ve(a,"cookie",nt.kml),""),s=u(ge(a,"minRefreshPeriod",nt.kml),0)}var h=C.now(),d=n.refreshMode;if(0===d)c(a)&&(n.time=Math.max(s,n.time));else if(1===d){var f;if(c(a)&&(f=ve(a,"expires",nt.kml)),c(f))try{var m=C.fromIso8601(f),_=C.secondsDifference(m,h);_>0&&_<s&&C.addSeconds(h,s,m),n.time=m}catch(e){console.log("KML - NetworkLinkControl expires is not a valid date"),o=!0}else console.log("KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),o=!0}var g=n.entity,y=t._entityCollection,w=r.values;y.suspendEvents();for(var b=y.values.slice(),E=0;E<b.length;++E){var S=b[E];S.parent===g&&(S.parent=void 0,i(S))}for(y.resumeEvents(),y.suspendEvents(),E=0;E<w.length;E++){var x=w[E];c(x.parent)||(x.parent=g,je(x)),y.add(x)}y.resumeEvents(),o?l.remove(n.id):n.lastUpdated=h;var T=y.computeAvailability(),A=T.start,P=T.stop,D=C.equals(A,v.MINIMUM_VALUE),M=C.equals(P,v.MAXIMUM_VALUE);if(!D||!M){var I=t._clock;I.startTime===A&&I.stopTime===P||(I.startTime=A,I.stopTime=P,t._changed.raiseEvent(t))}n.updating=!1,n.needsUpdate=!1,t._refresh.raiseEvent(t,p)}})).otherwise(function(t){var n="NetworkLink "+e.href+" refresh failed: "+t;console.log(n),o._error.raiseEvent(o,n)}),d=!0}}h.set(e.id,e)}}),d&&(this._networkLinks=h,this._changed.raiseEvent(this)),!0},He}),o("DataSources/VelocityOrientationProperty",["../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Ellipsoid","../Core/Event","../Core/JulianDate","../Core/Matrix3","../Core/Quaternion","../Core/Transforms","./Property","./VelocityVectorProperty"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(e,n){this._velocityVectorProperty=new h(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new o,this.ellipsoid=t(n,i.WGS84);var r=this;this._velocityVectorProperty.definitionChanged.addEventListener(function(){r._definitionChanged.raiseEvent(r)})}r(d.prototype,{isConstant:{get:function(){return c.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var p=new e,f=new e,m=new s;return d.prototype.getValue=function(e,t){var r=this._velocityVectorProperty._getValue(e,f,p);if(n(r))return u.rotationMatrixFromPositionVelocity(p,r,this._ellipsoid,m),l.fromRotationMatrix(m,t)},d.prototype.equals=function(e){return this===e||e instanceof d&&c.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))},d}),o("DataSources/Visualizer",["../Core/DeveloperError"],function(e){"use strict";function t(){e.throwInstantiationError()}return t.prototype.update=e.throwInstantiationError,t.prototype.getBoundingSphere=e.throwInstantiationError,t.prototype.isDestroyed=e.throwInstantiationError,t.prototype.destroy=e.throwInstantiationError,t}),o("Renderer/ClearCommand",["../Core/Color","../Core/defaultValue","../Core/freezeObject"],function(e,t,n){"use strict";function r(e){e=t(e,t.EMPTY_OBJECT),this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner}return r.ALL=n(new r({color:new e(0,0,0,0),depth:1,stencil:0})),r.prototype.execute=function(e,t){e.clear(this,t)},r}),o("Renderer/ComputeCommand",["../Core/defaultValue","../Core/PrimitiveType","../Scene/Pass"],function(e,t,n){"use strict";function r(t){t=e(t,e.EMPTY_OBJECT),this.vertexArray=t.vertexArray,this.fragmentShaderSource=t.fragmentShaderSource,this.shaderProgram=t.shaderProgram,this.uniformMap=t.uniformMap,this.outputTexture=t.outputTexture,this.preExecute=t.preExecute,this.postExecute=t.postExecute,this.persists=e(t.persists,!1),this.pass=n.COMPUTE,this.owner=t.owner}return r.prototype.execute=function(e){e.execute(this)},r}),o("Shaders/ViewportQuadVS",[],function(){"use strict";return"attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_Position = position;\nv_textureCoordinates = textureCoordinates;\n}\n"}),o("Renderer/ComputeEngine",["../Core/BoundingRectangle","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/GeometryAttribute","../Core/PrimitiveType","../Shaders/ViewportQuadVS","./BufferUsage","./ClearCommand","./DrawCommand","./Framebuffer","./RenderState","./ShaderProgram"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e){this._context=e}var y,C=new f({primitiveType:c.TRIANGLES}),w=new p({color:new t(0,0,0,0)});return v.prototype.execute=function(t){i(t.preExecute)&&t.preExecute(t);var n,r,o=t.outputTexture,a=o.width,s=o.height,l=this._context,u=i(t.vertexArray)?t.vertexArray:l.getViewportQuadVertexArray(),c=i(t.shaderProgram)?t.shaderProgram:g.fromCache({context:l,vertexShaderSource:h,fragmentShaderSource:t.fragmentShaderSource,attributeLocations:{position:0,textureCoordinates:1}}),d=new m({context:l,colorTextures:[o],destroyAttachments:!1}),p=(n=a,r=s,i(y)&&y.viewport.width===n&&y.viewport.height===r||(y=_.fromCache({viewport:new e(0,0,n,r)})),y),f=t.uniformMap,v=w;v.framebuffer=d,v.renderState=p,v.execute(l);var b=C;b.vertexArray=u,b.renderState=p,b.shaderProgram=c,b.uniformMap=f,b.framebuffer=d,b.execute(l),d.destroy(),t.persists||(c.destroy(),i(t.vertexArray)&&u.destroy()),i(t.postExecute)&&t.postExecute(o)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return a(this)},v}),o("Renderer/PassState",["../Core/BoundingRectangle"],function(e){"use strict";return function(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0}}),o("Renderer/RenderbufferFormat",["../Core/freezeObject","./WebGLConstants"],function(e,t){"use strict";var n={RGBA4:t.RGBA4,RGB5_A1:t.RGB5_A1,RGB565:t.RGB565,DEPTH_COMPONENT16:t.DEPTH_COMPONENT16,STENCIL_INDEX8:t.STENCIL_INDEX8,DEPTH_STENCIL:t.DEPTH_STENCIL,validate:function(e){return e===n.RGBA4||e===n.RGB5_A1||e===n.RGB565||e===n.DEPTH_COMPONENT16||e===n.STENCIL_INDEX8||e===n.DEPTH_STENCIL}};return e(n)}),o("Renderer/Renderbuffer",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","./ContextLimits","./RenderbufferFormat"],function(e,t,n,r,i,o,a){"use strict";function s(n){var r=(n=e(n,e.EMPTY_OBJECT)).context._gl,i=e(n.format,a.RGBA4),o=t(n.width)?n.width:r.drawingBufferWidth,s=t(n.height)?n.height:r.drawingBufferHeight;this._gl=r,this._format=i,this._width=o,this._height=s,this._renderbuffer=this._gl.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,this._renderbuffer),r.renderbufferStorage(r.RENDERBUFFER,i,o,s),r.bindRenderbuffer(r.RENDERBUFFER,null)}return n(s.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),s.prototype._getRenderbuffer=function(){return this._renderbuffer},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),r(this)},s}),o("Renderer/PickFramebuffer",["../Core/BoundingRectangle","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","./Framebuffer","./PassState","./Renderbuffer","./RenderbufferFormat","./Texture"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(t){var n=new a(t);n.blendingEnabled=!1,n.scissorTest={enabled:!0,rectangle:new e},n.viewport=new e,this._context=t,this._fb=void 0,this._passState=n,this._width=0,this._height=0}c.prototype.begin=function(t){var n=this._context,i=n.drawingBufferWidth,a=n.drawingBufferHeight;return e.clone(t,this._passState.scissorTest.rectangle),r(this._fb)&&this._width===i&&this._height===a||(this._width=i,this._height=a,this._fb=this._fb&&this._fb.destroy(),this._fb=new o({context:n,colorTextures:[new u({context:n,width:i,height:a})],depthStencilRenderbuffer:new s({context:n,format:l.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=i,this._passState.viewport.height=a,this._passState};var h=new t;return c.prototype.end=function(e){for(var i=n(e.width,1),o=n(e.height,1),a=this._context,s=a.readPixels({x:e.x,y:e.y,width:i,height:o,framebuffer:this._fb}),l=Math.max(i,o),u=l*l,c=Math.floor(.5*i),d=Math.floor(.5*o),p=0,f=0,m=0,_=-1,g=0;g<u;++g){if(-c<=p&&p<=c&&-d<=f&&f<=d){var v=4*((d-f)*i+p+c);h.red=t.byteToFloat(s[v]),h.green=t.byteToFloat(s[v+1]),h.blue=t.byteToFloat(s[v+2]),h.alpha=t.byteToFloat(s[v+3]);var y=a.getObjectByPickColor(h);if(r(y))return y}if(p===f||p<0&&-p===f||p>0&&p===1-f){var C=m;m=-_,_=C}p+=m,f+=_}},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),i(this)},c}),o("Renderer/ShaderCache",["../Core/defined","../Core/defineProperties","../Core/destroyObject","./ShaderProgram","./ShaderSource"],function(e,t,n,r,i){"use strict";function o(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}return t(o.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),o.prototype.replaceShaderProgram=function(t){return e(t.shaderProgram)&&t.shaderProgram.destroy(),this.getShaderProgram(t)},o.prototype.getShaderProgram=function(e){var t=e.vertexShaderSource,n=e.fragmentShaderSource,o=e.attributeLocations;"string"==typeof t&&(t=new i({sources:[t]})),"string"==typeof n&&(n=new i({sources:[n]}));var a,s=t.createCombinedVertexShader(),l=n.createCombinedFragmentShader(),u=s+l+JSON.stringify(o);if(this._shaders[u])a=this._shaders[u],delete this._shadersToRelease[u];else{var c=this._context,h=new r({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:t,vertexShaderText:s,fragmentShaderSource:n,fragmentShaderText:l,attributeLocations:o});h._cachedShader=a={cache:this,shaderProgram:h,keyword:u,count:0},this._shaders[u]=a,++this._numberOfShaders}return++a.count,a.shaderProgram},o.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];delete this._shaders[n.keyword],n.shaderProgram.finalDestroy(),--this._numberOfShaders}this._shadersToRelease={}},o.prototype.releaseShaderProgram=function(t){if(e(t)){var n=t._cachedShader;n&&0==--n.count&&(this._shadersToRelease[n.keyword]=n)}},o.prototype.isDestroyed=function(){return!1},o.prototype.destroy=function(){var e=this._shaders;for(var t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return n(this)},o}),o("Renderer/UniformState",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defined","../Core/defineProperties","../Core/EncodedCartesian3","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","../Scene/SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(){this.globeDepthTexture=void 0,this._viewport=new e,this._viewportCartesian4=new r,this._viewportDirty=!1,this._viewportOrthographicMatrix=c.clone(c.IDENTITY),this._viewportTransformation=c.clone(c.IDENTITY),this._model=c.clone(c.IDENTITY),this._view=c.clone(c.IDENTITY),this._inverseView=c.clone(c.IDENTITY),this._projection=c.clone(c.IDENTITY),this._infiniteProjection=c.clone(c.IDENTITY),this._entireFrustum=new t,this._currentFrustum=new t,this._frustumPlanes=new r,this._frameState=void 0,this._temeToPseudoFixed=u.clone(c.IDENTITY),this._view3DDirty=!0,this._view3D=new c,this._inverseView3DDirty=!0,this._inverseView3D=new c,this._inverseModelDirty=!0,this._inverseModel=new c,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new u,this._viewRotation=new u,this._inverseViewRotation=new u,this._viewRotation3D=new u,this._inverseViewRotation3D=new u,this._inverseProjectionDirty=!0,this._inverseProjection=new c,this._inverseProjectionOITDirty=!0,this._inverseProjectionOIT=new c,this._modelViewDirty=!0,this._modelView=new c,this._modelView3DDirty=!0,this._modelView3D=new c,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new c,this._inverseModelViewDirty=!0,this._inverseModelView=new c,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new c,this._viewProjectionDirty=!0,this._viewProjection=new c,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new c,this._modelViewProjectionDirty=!0,this._modelViewProjection=new c,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new c,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new c,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new c,this._normalDirty=!0,this._normal=new u,this._normal3DDirty=!0,this._normal3D=new u,this._inverseNormalDirty=!0,this._inverseNormal=new u,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new u,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new s,this._cameraPosition=new n,this._sunPositionWC=new n,this._sunPositionColumbusView=new n,this._sunDirectionWC=new n,this._sunDirectionEC=new n,this._moonDirectionEC=new n,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._cameraDirection=new n,this._cameraRight=new n,this._cameraUp=new n,this._frustum2DWidth=0,this._eyeHeight2D=new t,this._resolutionScale=1,this._fogDensity=void 0}function m(e){if(e._viewportDirty){var t=e._viewport;c.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),c.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}function _(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,c.multiplyByPoint(e.inverseModel,e._cameraPosition,w),s.fromCartesian(w,e._encodedCameraPositionMC))}function g(e){e._view3DDirty&&(e._mode===p.SCENE3D?c.clone(e._view,e._view3D):function(e,t,r,i,a,s,u,h){var f=b;f.x=e.y,f.y=e.z,f.z=e.x;var m=E;m.x=r.y,m.y=r.z,m.z=r.x;var _=S;_.x=i.y,_.y=i.z,_.z=i.x;var g=x;g.x=t.y,g.y=t.z,g.z=t.x,s===p.SCENE2D&&(f.z=.5*a);var v=u.unproject(f,T);v.longitude=l.clamp(v.longitude,-Math.PI,Math.PI),v.latitude=l.clamp(v.latitude,-l.PI_OVER_TWO,l.PI_OVER_TWO);var y=u.ellipsoid,C=y.cartographicToCartesian(v,A),w=d.eastNorthUpToFixedFrame(C,y,P);c.multiplyByPointAsVector(w,m,m),c.multiplyByPointAsVector(w,_,_),c.multiplyByPointAsVector(w,g,g),o(h)||(h=new c),h[0]=m.x,h[1]=_.x,h[2]=-g.x,h[3]=0,h[4]=m.y,h[5]=_.y,h[6]=-g.y,h[7]=0,h[8]=m.z,h[9]=_.z,h[10]=-g.z,h[11]=0,h[12]=-n.dot(m,C),h[13]=-n.dot(_,C),h[14]=n.dot(g,C),h[15]=1}(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),c.getRotation(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function v(e){e._inverseView3DDirty&&(c.inverseTransformation(e.view3D,e._inverseView3D),c.getRotation(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}a(f.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(t){if(!e.equals(t,this._viewport)){e.clone(t,this._viewport);var n=this._viewport,r=this._viewportCartesian4;r.x=n.x,r.y=n.y,r.z=n.width,r.w=n.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return m(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return m(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){c.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,c.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,c.getRotation(this.inverseModel,e),u.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return g(this),this._view3D}},viewRotation:{get:function(){return g(this),this._viewRotation}},viewRotation3D:{get:function(){return g(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return v(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return v(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){return this._inverseProjectionDirty&&(this._inverseProjectionDirty=!1,c.inverse(this._projection,this._inverseProjection)),this._inverseProjection}},inverseProjectionOIT:{get:function(){return this._inverseProjectionOITDirty&&(this._inverseProjectionOITDirty=!1,this._mode!==p.SCENE2D&&this._mode!==p.MORPHING?c.inverse(this._projection,this._inverseProjectionOIT):c.clone(c.IDENTITY,this._inverseProjectionOIT)),this._inverseProjectionOIT}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){return this._modelViewDirty&&(this._modelViewDirty=!1,c.multiplyTransformation(this._view,this._model,this._modelView)),this._modelView}},modelView3D:{get:function(){return this._modelView3DDirty&&(this._modelView3DDirty=!1,c.multiplyTransformation(this.view3D,this._model,this._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;var t=e.modelView,n=e._modelViewRelativeToEye;n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=0,n[13]=0,n[14]=0,n[15]=t[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){return this._inverseModelViewDirty&&(this._inverseModelViewDirty=!1,c.inverse(this.modelView,this._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){return this._inverseModelView3DDirty&&(this._inverseModelView3DDirty=!1,c.inverse(this.modelView3D,this._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){return this._viewProjectionDirty&&(this._viewProjectionDirty=!1,c.multiply(this._projection,this._view,this._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){return this._inverseViewProjectionDirty&&(this._inverseViewProjectionDirty=!1,c.inverse(this.viewProjection,this._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){return this._modelViewProjectionDirty&&(this._modelViewProjectionDirty=!1,c.multiply(this._projection,this.modelView,this._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){return this._inverseModelViewProjectionDirty&&(this._inverseModelViewProjectionDirty=!1,c.inverse(this.modelViewProjection,this._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){return this._modelViewProjectionRelativeToEyeDirty&&(this._modelViewProjectionRelativeToEyeDirty=!1,c.multiply(this._projection,this.modelViewRelativeToEye,this._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){return this._modelViewInfiniteProjectionDirty&&(this._modelViewInfiniteProjectionDirty=!1,c.multiply(this._infiniteProjection,this.modelView,this._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(e){if(e._normalDirty){e._normalDirty=!1;var t=e._normal;c.getRotation(e.inverseModelView,t),u.transpose(t,t)}}(this),this._normal}},normal3D:{get:function(){return function(e){if(e._normal3DDirty){e._normal3DDirty=!1;var t=e._normal3D;c.getRotation(e.inverseModelView3D,t),u.transpose(t,t)}}(this),this._normal3D}},inverseNormal:{get:function(){return this._inverseNormalDirty&&(this._inverseNormalDirty=!1,c.getRotation(this.inverseModelView,this._inverseNormal)),this._inverseNormal}},inverseNormal3D:{get:function(){return this._inverseNormal3DDirty&&(this._inverseNormal3DDirty=!1,c.getRotation(this.inverseModelView3D,this._inverseNormal3D)),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){return _(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return _(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},pass:{get:function(){return this._pass}}});var y=new u,C=new i;f.prototype.updateCamera=function(e){var t,r,i;c.clone(i=e.viewMatrix,this._view),c.getRotation(i,this._viewRotation),this._view3DDirty=!0,this._inverseView3DDirty=!0,this._modelViewDirty=!0,this._modelView3DDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._inverseModelViewDirty=!0,this._inverseModelView3DDirty=!0,this._viewProjectionDirty=!0,this._inverseViewProjectionDirty=!0,this._modelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,c.clone(r=e.inverseViewMatrix,this._inverseView),c.getRotation(r,this._inverseViewRotation),n.clone((t=e).positionWC,this._cameraPosition),n.clone(t.directionWC,this._cameraDirection),n.clone(t.rightWC,this._cameraRight),n.clone(t.upWC,this._cameraUp),this._encodedCameraPositionMCDirty=!0,this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this.updateFrustum(e.frustum)},f.prototype.updateFrustum=function(e){var t;c.clone(e.projectionMatrix,this._projection),this._inverseProjectionDirty=!0,this._inverseProjectionOITDirty=!0,this._viewProjectionDirty=!0,this._inverseViewProjectionDirty=!0,this._modelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,o(e.infiniteProjectionMatrix)&&(c.clone(e.infiniteProjectionMatrix,(t=this)._infiniteProjection),t._modelViewInfiniteProjectionDirty=!0),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,o(e.top)||(e=e._offCenterFrustum),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},f.prototype.updatePass=function(e){this._pass=e},f.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var r=e.camera;this.updateCamera(r),e.mode===p.SCENE2D?(this._frustum2DWidth=r.frustum.right-r.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(e,t){o(d.computeIcrfToFixedMatrix(t.time,y))||(y=d.computeTemeToPseudoFixedMatrix(t.time,y));var r=h.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);u.multiplyByVector(y,r,r),n.normalize(r,e._sunDirectionWC),r=u.multiplyByVector(e.viewRotation3D,r,e._sunDirectionEC),n.normalize(r,r),r=h.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),u.multiplyByVector(y,r,r),u.multiplyByVector(e.viewRotation3D,r,r),n.normalize(r,r);var i=t.mapProjection,a=i.ellipsoid.cartesianToCartographic(e._sunPositionWC,C);i.project(a,e._sunPositionColumbusView)}(this,e),this._fogDensity=e.fog.density,this._frameState=e,this._temeToPseudoFixed=d.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed)};var w=new n,b=new n,E=new n,S=new n,x=new n,T=new i,A=new n,P=new c;return f}),o("Renderer/Context",["../Core/clone","../Core/Color","../Core/ComponentDatatype","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/Math","../Core/Matrix4","../Core/PrimitiveType","../Core/RuntimeError","../Shaders/ViewportQuadVS","./BufferUsage","./ClearCommand","./ContextLimits","./CubeMap","./DrawCommand","./PassState","./PickFramebuffer","./PixelDatatype","./RenderbufferFormat","./RenderState","./ShaderCache","./ShaderProgram","./Texture","./UniformState","./VertexArray","./WebGLConstants"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O){"use strict";function R(e,t,n){var r=e.getError();if(r!==e.NO_ERROR)throw new m(function(e,t,n,i){for(var o=function(t,n){var r="WebGL Error:  ";switch(n){case e.INVALID_ENUM:r+="INVALID_ENUM";break;case e.INVALID_VALUE:r+="INVALID_VALUE";break;case e.INVALID_OPERATION:r+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:r+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:r+="CONTEXT_LOST_WEBGL lost";break;default:r+="Unknown ("+n+")"}return r}(0,r)+": "+t.name+"(",a=0;a<n.length;++a)0!==a&&(o+=", "),o+=n[a];return o+");"}(e,t,n))}function N(e,t,n){return{get:function(){return n(e,"get: "+t,e[t]),e[t]},set:function(r){e[t]=r,n(e,"set: "+t,r)}}}function L(e,t){for(var n=t.length,r=0;r<n;++r){var i=e.getExtension(t[r]);if(i)return i}}function F(n,a){if("undefined"==typeof WebGLRenderingContext)throw new m("The browser does not support WebGL.  Visit http://get.webgl.org.");this._canvas=n,a=e(a,!0),(a=i(a,{})).allowTextureFilterAnisotropic=i(a.allowTextureFilterAnisotropic,!0);var s,l=i(a.webgl,{});if(l.alpha=i(l.alpha,!1),o(s)||(s=n.getContext("webgl",l)||n.getContext("experimental-webgl",l)||void 0),!o(s))throw new m("The browser supports WebGL, but initialization failed.");this._originalGLContext=s,this._webgl2=!1,this._id=r(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new A(this);var u=this._gl=this._originalGLContext;this._redBits=u.getParameter(u.RED_BITS),this._greenBits=u.getParameter(u.GREEN_BITS),this._blueBits=u.getParameter(u.BLUE_BITS),this._alphaBits=u.getParameter(u.ALPHA_BITS),this._depthBits=u.getParameter(u.DEPTH_BITS),this._stencilBits=u.getParameter(u.STENCIL_BITS),y._maximumCombinedTextureImageUnits=u.getParameter(u.MAX_COMBINED_TEXTURE_IMAGE_UNITS),y._maximumCubeMapSize=u.getParameter(u.MAX_CUBE_MAP_TEXTURE_SIZE),y._maximumFragmentUniformVectors=u.getParameter(u.MAX_FRAGMENT_UNIFORM_VECTORS),y._maximumTextureImageUnits=u.getParameter(u.MAX_TEXTURE_IMAGE_UNITS),y._maximumRenderbufferSize=u.getParameter(u.MAX_RENDERBUFFER_SIZE),y._maximumTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),y._maximumVaryingVectors=u.getParameter(u.MAX_VARYING_VECTORS),y._maximumVertexAttributes=u.getParameter(u.MAX_VERTEX_ATTRIBS),y._maximumVertexTextureImageUnits=u.getParameter(u.MAX_VERTEX_TEXTURE_IMAGE_UNITS),y._maximumVertexUniformVectors=u.getParameter(u.MAX_VERTEX_UNIFORM_VECTORS);var c=u.getParameter(u.ALIASED_LINE_WIDTH_RANGE);y._minimumAliasedLineWidth=c[0],y._maximumAliasedLineWidth=c[1];var h=u.getParameter(u.ALIASED_POINT_SIZE_RANGE);y._minimumAliasedPointSize=h[0],y._maximumAliasedPointSize=h[1];var d=u.getParameter(u.MAX_VIEWPORT_DIMS);y._maximumViewportWidth=d[0],y._maximumViewportHeight=d[1];var p=u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_FLOAT);y._highpFloatSupported=0!==p.precision;var f=u.getShaderPrecisionFormat(u.FRAGMENT_SHADER,u.HIGH_INT);y._highpIntSupported=0!==f.rangeMax,this._antialias=u.getContextAttributes().antialias,this._standardDerivatives=!!L(u,["OES_standard_derivatives"]),this._elementIndexUint=!!L(u,["OES_element_index_uint"]),this._depthTexture=!!L(u,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._textureFloat=!!L(u,["OES_texture_float"]),this._fragDepth=!!L(u,["EXT_frag_depth"]),this._debugShaders=L(u,["WEBGL_debug_shaders"]);var _,g,v,C,w,E,S,x,P,D,I=a.allowTextureFilterAnisotropic?L(u,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;this._textureFilterAnisotropic=I,y._maximumTextureFilterAnisotropy=o(I)?u.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,x=L(u,["OES_vertex_array_object"]),o(x)&&(_=function(){return x.createVertexArrayOES()},g=function(e){x.bindVertexArrayOES(e)},v=function(e){x.deleteVertexArrayOES(e)}),P=L(u,["ANGLE_instanced_arrays"]),o(P)&&(C=function(e,t,n,r,i){P.drawElementsInstancedANGLE(e,t,n,r,i)},w=function(e,t,n,r){P.drawArraysInstancedANGLE(e,t,n,r)},E=function(e,t){P.vertexAttribDivisorANGLE(e,t)}),D=L(u,["WEBGL_draw_buffers"]),o(D)&&(S=function(e){D.drawBuffersWEBGL(e)}),this.glCreateVertexArray=_,this.glBindVertexArray=g,this.glDeleteVertexArray=v,this.glDrawElementsInstanced=C,this.glDrawArraysInstanced=w,this.glVertexAttribDivisor=E,this.glDrawBuffers=S,this._vertexArrayObject=!!x,this._instancedArrays=!!P,this._drawBuffers=!!D,y._maximumDrawBuffers=this.drawBuffers?u.getParameter(O.MAX_DRAW_BUFFERS):1,y._maximumColorAttachments=this.drawBuffers?u.getParameter(O.MAX_COLOR_ATTACHMENTS):1;var R=u.getParameter(u.COLOR_CLEAR_VALUE);this._clearColor=new t(R[0],R[1],R[2],R[3]),this._clearDepth=u.getParameter(u.DEPTH_CLEAR_VALUE),this._clearStencil=u.getParameter(u.STENCIL_CLEAR_VALUE);var N=new M,F=new b(this),B=T.fromCache();this._defaultPassState=F,this._defaultRenderState=B,this._defaultTexture=void 0,this._defaultCubeMap=void 0,this._us=N,this._currentRenderState=B,this._currentPassState=F,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(var k=0;k<y._maximumVertexAttributes;k++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=a,this.cache={},T.apply(u,B,F)}function B(e,t,n,r){var i=e._currentRenderState,o=e._currentPassState;e._currentRenderState=t,e._currentPassState=n,T.partialApply(e._gl,i,t,o,n,r)}function k(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var n=z;if(o(t))t._bind(),n=t._getActiveColorAttachments();else{var r=e._gl;r.bindFramebuffer(r.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(n)}}function V(e,t,n){this._pickObjects=e,this.key=t,this.color=n}var z,U={};a(F.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},uniformState:{get:function(){return this._us}},redBits:{get:function(){return this._redBits}},greenBits:{get:function(){return this._greenBits}},blueBits:{get:function(){return this._blueBits}},alphaBits:{get:function(){return this._alphaBits}},depthBits:{get:function(){return this._depthBits}},stencilBits:{get:function(){return this._stencilBits}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture}},floatingPointTexture:{get:function(){return this._textureFloat}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=function(e,t){function n(n){return function(){var r=n.apply(e,arguments);return t(e,n,arguments),r}}if(!t)return e;var r={};for(var i in e){var o=e[i];"function"==typeof o?r[i]=n(o):Object.defineProperty(r,i,N(e,i,t))}return r}(this._originalGLContext,e?R:null)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new D({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])}})),this._defaultTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new C({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e}})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return U}}}),"undefined"!=typeof WebGLRenderingContext&&(z=[O.BACK]);var G=new v;F.prototype.clear=function(e,n){e=i(e,G),n=i(n,this._defaultPassState);var r=this._gl,a=0,s=e.color,l=e.depth,u=e.stencil;o(s)&&(t.equals(this._clearColor,s)||(t.clone(s,this._clearColor),r.clearColor(s.red,s.green,s.blue,s.alpha)),a|=r.COLOR_BUFFER_BIT),o(l)&&(l!==this._clearDepth&&(this._clearDepth=l,r.clearDepth(l)),a|=r.DEPTH_BUFFER_BIT),o(u)&&(u!==this._clearStencil&&(this._clearStencil=u,r.clearStencil(u)),a|=r.STENCIL_BUFFER_BIT),B(this,i(e.renderState,this._defaultRenderState),n,!0),k(this,i(e.framebuffer,n.framebuffer)),r.clear(a)},F.prototype.draw=function(e,t){t=i(t,this._defaultPassState),function(e,t,n,r){var o=i(n._renderState,e._defaultRenderState);k(e,t),B(e,o,r,!1);var a=n._shaderProgram;a._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,a.maximumTextureUnitIndex)}(this,i(e._framebuffer,t.framebuffer),e,t),function(e,t){var n=t._primitiveType,r=t._vertexArray,a=t._offset,s=t._count,l=t.instanceCount;e._us.model=i(t._modelMatrix,p.IDENTITY),t._shaderProgram._setUniforms(t._uniformMap,e._us,e.validateShaderProgram),r._bind();var u=r.indexBuffer;o(u)?(a*=u.bytesPerIndex,s=i(s,u.numberOfIndices),0===l?e._gl.drawElements(n,s,u.indexDatatype,a):e.glDrawElementsInstanced(n,s,u.indexDatatype,a,l)):(s=i(s,r.numberOfVertices),0===l?e._gl.drawArrays(n,a,s):e.glDrawArraysInstanced(n,a,s,l)),r._unBind()}(this,e)},F.prototype.endFrame=function(){var e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null),this.drawBuffers&&this.glDrawBuffers(z);var t=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var n=0;n<t;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},F.prototype.readPixels=function(e){var t=this._gl;e=e||{};var n=Math.max(e.x||0,0),r=Math.max(e.y||0,0),i=e.width||t.drawingBufferWidth,o=e.height||t.drawingBufferHeight,a=e.framebuffer,s=new Uint8Array(4*i*o);return k(this,a),t.readPixels(n,r,i,o,t.RGBA,t.UNSIGNED_BYTE,s),s};var W={position:0,textureCoordinates:1};return F.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!o(e)){var t=new c({attributes:{position:new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new h({componentDatatype:n.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:f.TRIANGLES});e=I.fromGeometry({context:this,geometry:t,attributeLocations:W,bufferUsage:g.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},F.prototype.createViewportQuadCommand=function(e,t){return t=i(t,i.EMPTY_OBJECT),new w({vertexArray:this.getViewportQuadVertexArray(),primitiveType:f.TRIANGLES,renderState:t.renderState,shaderProgram:P.fromCache({context:this,vertexShaderSource:_,fragmentShaderSource:e,attributeLocations:W}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer})},F.prototype.createPickFramebuffer=function(){return new E(this)},F.prototype.getObjectByPickColor=function(e){return this._pickObjects[e.toRgba()]},a(V.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),V.prototype.destroy=function(){delete this._pickObjects[this.key]},F.prototype.createPickId=function(e){++this._nextPickColor[0];var n=this._nextPickColor[0];if(0===n)throw new m("Out of unique Pick IDs.");return this._pickObjects[n]=e,new V(this._pickObjects,n,t.fromRgba(n))},F.prototype.isDestroyed=function(){return!1},F.prototype.destroy=function(){var e=this.cache;for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];o(n.destroy)&&n.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),s(this)},F}),o("Renderer/loadCubeMap",["../Core/defined","../Core/DeveloperError","../Core/loadImage","../ThirdParty/when","./CubeMap"],function(e,t,n,r,i){"use strict";return function(e,t,o){var a=[n(t.positiveX,o),n(t.negativeX,o),n(t.positiveY,o),n(t.negativeY,o),n(t.positiveZ,o),n(t.negativeZ,o)];return r.all(a,function(t){return new i({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})})}}),o("Scene/DiscardMissingTileImagePolicy",["../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/getImagePixels","../Core/loadImageViaBlob","../ThirdParty/when"],function(e,t,n,r,i,o){"use strict";function a(n){n=e(n,e.EMPTY_OBJECT),this._pixelsToCheck=n.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;var a=this;o(i(n.missingImageUrl),function(e){t(e.blob)&&(a._missingImageByteLength=e.blob.size);var i=r(e);if(n.disableCheckIfAllPixelsAreTransparent){for(var o=!0,s=e.width,l=n.pixelsToCheck,u=0,c=l.length;o&&u<c;++u){var h=l[u];i[4*h.x+h.y*s+3]>0&&(o=!1)}o&&(i=void 0)}a._missingImagePixels=i,a._isReady=!0},function(){a._missingImagePixels=void 0,a._isReady=!0})}return a.prototype.isReady=function(){return this._isReady},a.prototype.shouldDiscardImage=function(e){var n=this._pixelsToCheck,i=this._missingImagePixels;if(!t(i))return!1;if(t(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;for(var o=r(e),a=e.width,s=0,l=n.length;s<l;++s)for(var u=n[s],c=4*u.x+u.y*a,h=0;h<4;++h){var d=c+h;if(o[d]!==i[d])return!1}return!0},a}),o("Scene/ImageryLayerFeatureInfo",["../Core/defined"],function(e){"use strict";function t(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}return t.prototype.configureNameFromProperties=function(t){var n,r=10;for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=i.toLowerCase();r>1&&"name"===o?(r=1,n=i):r>2&&"title"===o?(r=2,n=i):r>3&&/name/i.test(i)?(r=3,n=i):r>4&&/title/i.test(i)&&(r=4,n=i)}e(n)&&(this.name=t[n])},t.prototype.configureDescriptionFromProperties=function(t){this.description=function t(n){var r='<table class="cesium-infoBox-defaultTable">';for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];e(o)&&(r+="object"==typeof o?"<tr><td>"+i+"</td><td>"+t(o)+"</td></tr>":"<tr><td>"+i+"</td><td>"+o+"</td></tr>")}return r+"</table>"}(t)},t}),o("Scene/ImageryProvider",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/loadImage","../Core/loadImageViaBlob","../Core/throttleRequestByServer"],function(e,t,n,r,i,o){"use strict";function a(){this.defaultAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,n.throwInstantiationError()}return t(a.prototype,{ready:{get:n.throwInstantiationError},readyPromise:{get:n.throwInstantiationError},rectangle:{get:n.throwInstantiationError},tileWidth:{get:n.throwInstantiationError},tileHeight:{get:n.throwInstantiationError},maximumLevel:{get:n.throwInstantiationError},minimumLevel:{get:n.throwInstantiationError},tilingScheme:{get:n.throwInstantiationError},tileDiscardPolicy:{get:n.throwInstantiationError},errorEvent:{get:n.throwInstantiationError},credit:{get:n.throwInstantiationError},proxy:{get:n.throwInstantiationError},hasAlphaChannel:{get:n.throwInstantiationError}}),a.prototype.getTileCredits=n.throwInstantiationError,a.prototype.requestImage=n.throwInstantiationError,a.prototype.pickFeatures=n.throwInstantiationError,a.loadImage=function(t,n){return e(t.tileDiscardPolicy)?o(n,i):o(n,r)},a}),o("Scene/ArcGisMapServerImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicProjection","../Core/GeographicTilingScheme","../Core/loadJson","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../ThirdParty/when","./DiscardMissingTileImagePolicy","./ImageryLayerFeatureInfo","./ImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b){"use strict";function E(n){function a(i){var a=i.tileInfo;if(o(a)){if(p._tileWidth=a.rows,p._tileHeight=a.cols,102100===a.spatialReference.wkid||102113===a.spatialReference.wkid)p._tilingScheme=new v({ellipsoid:n.ellipsoid});else{if(4326!==i.tileInfo.spatialReference.wkid)return void(h=_.handleError(h,p,p._errorEvent,"Tile spatial reference WKID "+i.tileInfo.spatialReference.wkid+" is not supported.",void 0,void 0,void 0,u));p._tilingScheme=new c({ellipsoid:n.ellipsoid})}if(p._maximumLevel=i.tileInfo.lods.length-1,o(i.fullExtent)){if(o(i.fullExtent.spatialReference)&&o(i.fullExtent.spatialReference.wkid))if(102100===i.fullExtent.spatialReference.wkid||102113===i.fullExtent.spatialReference.wkid){var s=new g,l=i.fullExtent,d=s.unproject(new t(Math.max(l.xmin,-p._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(l.ymin,-p._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),m=s.unproject(new t(Math.min(l.xmax,p._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(l.ymax,p._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));p._rectangle=new f(d.longitude,d.latitude,m.longitude,m.latitude)}else{if(4326!==i.fullExtent.spatialReference.wkid)return void(h=_.handleError(h,p,p._errorEvent,"fullExtent.spatialReference WKID "+i.fullExtent.spatialReference.wkid+" is not supported.",void 0,void 0,void 0,u));p._rectangle=f.fromDegrees(i.fullExtent.xmin,i.fullExtent.ymin,i.fullExtent.xmax,i.fullExtent.ymax)}}else p._rectangle=p._tilingScheme.rectangle;o(p._tileDiscardPolicy)||(p._tileDiscardPolicy=new C({missingImageUrl:S(p,0,0,p._maximumLevel),pixelsToCheck:[new e(0,0),new e(200,20),new e(20,200),new e(80,110),new e(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),p._useTiles=!0}else p._useTiles=!1;o(i.copyrightText)&&i.copyrightText.length>0&&(p._credit=new r(i.copyrightText)),p._ready=!0,p._readyPromise.resolve(!0),_.handleSuccess(h)}function s(e){var t="An error occurred while accessing "+p._url+".";h=_.handleError(h,p,p._errorEvent,t,void 0,void 0,void 0,u),p._readyPromise.reject(new m(t))}function u(){var e={f:"json"};o(p._token)&&(e.token=p._token);var t=d(p._url,{parameters:e,proxy:p._proxy});y(t,a,s)}n=i(n,{}),this._url=n.url,this._token=n.token,this._tileDiscardPolicy=n.tileDiscardPolicy,this._proxy=n.proxy,this._tileWidth=i(n.tileWidth,256),this._tileHeight=i(n.tileHeight,256),this._maximumLevel=n.maximumLevel,this._tilingScheme=i(n.tilingScheme,new c({ellipsoid:n.ellipsoid})),this._credit=void 0,this._useTiles=i(n.usePreCachedTilesIfAvailable,!0),this._rectangle=i(n.rectangle,this._tilingScheme.rectangle),this._layers=n.layers,this.enablePickFeatures=i(n.enablePickFeatures,!0),this._errorEvent=new l,this._ready=!1,this._readyPromise=y.defer();var h,p=this;this._useTiles?u():(this._ready=!0,this._readyPromise.resolve(!0))}function S(e,t,n,r){var i;if(e._useTiles)i=e._url+"/tile/"+r+"/"+n+"/"+t;else{var a=e._tilingScheme.tileXYToNativeRectangle(t,n,r);i=e._url+"/export?",i+="bbox="+a.west+"%2C"+a.south+"%2C"+a.east+"%2C"+a.north,i+=e._tilingScheme instanceof c?"&bboxSR=4326&imageSR=4326":"&bboxSR=3857&imageSR=3857",i+="&size="+e._tileWidth+"%2C"+e._tileHeight,i+="&format=png&transparent=true&f=image",e.layers&&(i+="&layers=show:"+e.layers)}var s=e._token;o(s)&&(-1===i.indexOf("?")&&(i+="?"),"?"!==i[i.length-1]&&(i+="&"),i+="token="+s);var l=e._proxy;return o(l)&&(i=l.getURL(i)),i}return a(E.prototype,{url:{get:function(){return this._url}},token:{get:function(){return this._token}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),E.prototype.getTileCredits=function(e,t,n){},E.prototype.requestImage=function(e,t,n){var r=S(this,e,t,n);return b.loadImage(this,r)},E.prototype.pickFeatures=function(e,r,i,a,s){if(this.enablePickFeatures){var l,u,d,f=this._tilingScheme.tileXYToNativeRectangle(e,r,i);if(this._tilingScheme instanceof c)l=p.toDegrees(a),u=p.toDegrees(s),d="4326";else{var m=this._tilingScheme.projection.project(new n(a,s,0));l=m.x,u=m.y,d="3857"}var _=this._url+"/identify?f=json&tolerance=2&geometryType=esriGeometryPoint";return _+="&geometry="+l+","+u,_+="&mapExtent="+f.west+","+f.south+","+f.east+","+f.north,_+="&imageDisplay="+this._tileWidth+","+this._tileHeight+",96",_+="&sr="+d,_+="&layers=visible",o(this._layers)&&(_+=":"+this._layers),o(this._token)&&(_+="&token="+this._token),o(this._proxy)&&(_=this._proxy.getURL(_)),h(_).then(function(e){var r=[],i=e.results;if(!o(i))return r;for(var a=0;a<i.length;++a){var s=i[a],l=new w;if(l.data=s,l.name=s.value,l.properties=s.attributes,l.configureDescriptionFromProperties(s.attributes),"esriGeometryPoint"===s.geometryType&&s.geometry){var u=s.geometry.spatialReference&&s.geometry.spatialReference.wkid?s.geometry.spatialReference.wkid:4326;if(4326===u||4283===u)l.position=n.fromDegrees(s.geometry.x,s.geometry.y,s.geometry.z);else if(102100===u||900913===u||3857===u){var c=new g;l.position=c.unproject(new t(s.geometry.x,s.geometry.y,s.geometry.z))}}r.push(l)}return r})}},E}),o("Scene/BingMapsStyle",["../Core/freezeObject"],function(e){"use strict";return e({AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"})}),o("Scene/BingMapsImageryProvider",["../Core/BingMapsApi","../Core/Cartesian2","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/loadJsonp","../Core/Math","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./BingMapsStyle","./DiscardMissingTileImagePolicy","./ImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(o){function a(e){var r=e.resourceSets[0].resources[0];E._tileWidth=r.imageWidth,E._tileHeight=r.imageHeight,E._maximumLevel=r.zoomMax-1,E._imageUrlSubdomains=r.imageUrlSubdomains,E._imageUrlTemplate=r.imageUrl.replace("{culture}",E._culture);var o=E._tileProtocol;if(!i(o)){var a=document.location.protocol;o=/^http/.test(a)?a:"http:"}E._imageUrlTemplate=E._imageUrlTemplate.replace(/^http:/,o),i(E._tileDiscardPolicy)||(E._tileDiscardPolicy=new _({missingImageUrl:y(E,0,0,E._maximumLevel),pixelsToCheck:[new t(0,0),new t(120,140),new t(130,160),new t(200,50),new t(200,200)],disableCheckIfAllPixelsAreTransparent:!0}));var s=E._attributionList=r.imageryProviders;s||(s=E._attributionList=[]);for(var l=0,h=s.length;l<h;++l){var p=s[l];p.credit=new n(p.attribution);for(var f=p.coverageAreas,m=0,g=p.coverageAreas.length;m<g;++m){var v=f[m],C=v.bbox;v.bbox=new c(u.toRadians(C[1]),u.toRadians(C[0]),u.toRadians(C[3]),u.toRadians(C[2]))}}E._ready=!0,E._readyPromise.resolve(!0),d.handleSuccess(w)}function g(e){var t="An error occurred while accessing "+b+".";w=d.handleError(w,E,E._errorEvent,t,void 0,void 0,void 0,C),E._readyPromise.reject(new h(t))}function C(){var e=l(b,{callbackParameterName:"jsonp",proxy:E._proxy});f(e,a,g)}o=r(o,{}),this._key=e.getKey(o.key),this._keyErrorCredit=e.getErrorCredit(o.key),this._url=o.url,this._tileProtocol=o.tileProtocol,this._mapStyle=r(o.mapStyle,m.AERIAL),this._culture=r(o.culture,""),this._tileDiscardPolicy=o.tileDiscardPolicy,this._proxy=o.proxy,this._credit=new n("Bing Imagery",v._logoData,"http://www.bing.com"),this.defaultGamma=1,this._tilingScheme=new p({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:o.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new s,this._ready=!1,this._readyPromise=f.defer();var w,b=this._url+"/REST/v1/Imagery/Metadata/"+this._mapStyle+"?incl=ImageryProviders&key="+this._key,E=this;C()}function y(e,t,n,r){var o=e._imageUrlTemplate,a=v.tileXYToQuadKey(t,n,r);o=o.replace("{quadkey}",a);var s=e._imageUrlSubdomains;o=o.replace("{subdomain}",s[(t+n+r)%s.length]);var l=e._proxy;return i(l)&&(o=l.getURL(o)),o}o(v.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});var C=new c;v.prototype.getTileCredits=function(e,t,n){var r=this._tilingScheme.tileXYToRectangle(e,t,n,C),o=function(e,t,n){++t;for(var r=[],o=0,a=e.length;o<a;++o){for(var s=e[o],l=s.coverageAreas,u=!1,h=0,d=s.coverageAreas.length;!u&&h<d;++h){var p=l[h];if(t>=p.zoomMin&&t<=p.zoomMax){var f=c.intersection(n,p.bbox,w);i(f)&&(u=!0)}}u&&r.push(s.credit)}return r}(this._attributionList,n,r);return i(this._keyErrorCredit)&&o.push(this._keyErrorCredit),o},v.prototype.requestImage=function(e,t,n){var r=y(this,e,t,n);return g.loadImage(this,r)},v.prototype.pickFeatures=function(){},v._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD0AAAAaCAYAAAAEy1RnAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gIDEgcPTMnXOQAAClZJREFUWMPdWGtsFNcV/u689uH1+sXaONhlWQzBENtxiUFBpBSLd60IpXHSNig4URtSYQUkRJNSi0igViVVVBJBaBsiAgKRQJSG8AgEHCCWU4iBCprY2MSgXfOI16y9D3s9Mzsztz9yB12WNU2i9Ecy0tHOzN4793zn3POdcy7BnRfJ8I7iB3SRDPeEExswLz8Y0DZIAYDIRGAgLQAm+7Xle31J3L3Anp1MZPY+BUBjorN332vgYhpgV1FRUd6TTz45ubq6OtDV1SXpuu5g//Oept9wNwlMyAi8IXDjyF245TsDTdivDMATCATGNDU1/WbhwoWPTZs2bWx1dXWhx+Oxrl+/PqTrus5t9W8KWEzjinTAYhro/xuBStwiIgBnJBLxKIoy1u/3V/r9/krDMMz3339/Z3t7e38ikUgCMDLEt8W+Q0cAI3McYTDDmZxh7DESG5Ni43jg9Gsa+X+OsxWxPSJTSj3JZFK5ZRVJErOzs8e6XC4fgGwALhbzDgAKU1hK28KEA6PMmTMn56233qpevnz5PQDcbJ7EzVUAuMrLy3MBeABkcWOEDELSyFe4y7iMoHkriZZlKYZh8ASHZDKpJJPJHAC5APIA5APIAeBlCjo5TwlpXnbOmTPHP3fu3KZVq1atZKBcDJQ9x7V48WJfc3Pzhp6enj+tXLnyR8w4MjdG4gyVDk7KICMClzKlLUrpbQMNw5AkScppbGz8cWdn57WjR4/2caw+DEBlYjO8wX1foZQWuN3uKZIklQD4G+fhlG0Yl8uVm5WVVW6app6dne0D0G8vnxbjJntHubCUOK/badZICyWanrJuAaeUknTQpmlKkUhEWbx48U8LCwtHhUKha+fPn+85fPhwV0tLyzUACSZx9jvMFhIByNFoVDEMw/qKB5HPvJfkUqBr9+7deklJyZ/j8bi5ffv2OAslieMLsG+m2DybT2QuzEQOsF5SUqJfvXo1yc2l6Xn6rgSRSCSEc+fOhVeuXLmwoqJixvTp0wcWLFgQ7unpudHR0dF97ty5z/fu3XseQJh5adjeerquy5ZlCalUivh8Pt8HH3ywzOPxyD09PZ81NjZ+2NnZaQEQx40b54vFYqaqquEVK1b4a2tr/WvWrDn18ssv144fP36SqqoD69ev371nz57rDLwAwHHkyJGfjRs3rtowDOv06dOnu7q6rs6bN2/s7Nmz9zIjDKenWoFZKg/AlMLCwl82Nzf/m3LX22+/fXb06NF/ALC8u7u7m6ZdkUhksL29/UpLS0vzunXrVgAoBzAaQBGAiY2NjUui0ei1RCLRFwwG/9PX19cVi8WCqqoOdHd3HysrK6sDMCccDl8IBoOtiqIsOnbs2D+i0eiV3t7ez8Ph8GeRSKRT07TB/v7+i1OnTp0HYBqABzs7O/+paVo0Fot1RyKRi/F4/Gp/f39XIpHoZnoUMn6wU+ZtRDaymwmxZFk2AWjvvvvuJ/F4PMn/n5+fn1VeXu6fOXNmbU1NzUOM4Bz8QqIoyg6HwxuLxfq3bdu2a+vWrW/09/dfKy0tffDVV199BEC20+n0ud3uQgBup9Pp83g8JYqieE+ePPnxxo0bt33xxRen8/Ly7n3hhRcWASh47bXX5pWVldWFw+GuXbt27XjzzTd3BoPBDq/XG1AUZRRHmAKPVfqaoKkgCCkA+oYNG84Eg0FHTU1N5ezZs8eWlJQ4CSF8/LvZYhJPQoQQpFKpwcrKyo1su9HBwUF99erVv588eXINgOOmacIwDEopdaZSKUIpxYkTJz6sr68/BMBav379RcMwZk2aNOl+AP+qq6t7xDTNVEVFxR+j0WgSAJk4ceKlTz/9tNzpdHpZvIvpjVW6pykhhBJCbkvwgiAQQogEQL558ybdtGlTsLm5OWJZdxZmlmWll5OUEEJN0zSGhob6GcOrALSzZ8/2apqWcLlc2axGACNRkRAimqaph0Kh68xIwwB0y7IMSZKcABz5+fkl8Xj8y2g0apOb5na7rYGBgS/JV54Q0qpAAoBKaS0jBWClg1ZVFeFw2AlgVF1dXeDpp5+eWVFRUVpcXOzgvQwAbrcbDJhdudlGpKZpGtx6JCcnRxIEQbQsS2PjbjM+AMvlchnMSBaXkr7ymCCIhmEYfMoVRVESBEHI0CaTTNubssUsQRBuubCtra33pZdeCk6YMCGwZs2aipqaGn9paWmuJEl3JP0bN258eeTIkRMABrm0YomiaImiKGVlZeWxLecAgBkzZvgdDkfWjRs3ggA0bpfpoiiahBCqKEqKAy2yULMA6MlkMp6Xl3cP1x2SWCwmFhQU+CmlFhfHNFOevpX4LcvSJUkyAeDQoUOh119//fpTTz01Zf78+UWBQCBHUZQ7yE/TNGPfvn0n33vvvSP79+//BECMeZsCMGRZNgRBgNPpHHXx4sVVDQ0Nf1+wYMGYJ554YikAevDgwUMA4oIgQJZlSggZdDqdBiGEZGdn6ww0tQlJURTT4/EMHz9+/MCjjz7622AwuHbZsmVbiouLvWvXrm1wOp3ZqVRqaKQTIInf1gAMl8ulU0q1CxcuBGOxmL5u3bryQCDgycrKEjORXGtra8eOHTsOHz169OyVK1cuA+hlRYrGlNRkWR7UNO2mYRiaz+cb3dLS8gYhhOi6Hj116tSOVatWHQNALcsaME0zLghClBDSZ9+zQsZ2SoJS2udwOKLPPffcvsrKyrJAIPDQ/v37txiGofX19V3r7e29UlBQMHqEVpjwnrYA6PF4PK6q6s2qqqqpZWVlitvtljOB7enpiWzbtu3wgQMHTre1tV0E0MeKkkGuIhMAqHv37u30er3Px+NxlyiKygMPPOAnhFiXLl0Kbd68uYPNsXbu3Lk6mUwaqqr2btmyZUdtbe3hd955pwvAEFNcO3jw4K/b2tqiqqpGIpGI4/HHH/9rQ0PDCa/XOyoSidDLly8PNTU1PcZ4QuNK1ju6NYHFRAGASXPnzv1Fa2vrxzTDpapqateuXR/Nnz+/SVGUhwFMBzCBFSLZLF75DsrJGpXRAH4EIABgPIBxAEoBFAPwARjFif1sNzZ25+VlOhaxufcCqAFQC+BhAPVLliz5XSqVUkOhUAuAKWnFyR3dlsw+fg+A+8eMGfPzTZs2bY9GozEb8JkzZ9qXLl36l+Li4l8B+AmAyQDGsGrOzfXNPGPawG2l85jksmcPm+vihH+2W1iF3bvZPN+sWbPuGx4eDrW3t+85fvz41o6OjmZN04Y0TYvV19cvYIbN5QqUjG2mwj5YAqDK4XDMe+aZZ55vbW09+sorr2yuqqpqYFatAuBn3uB7XzJCY297XeaUd2RoGzOJmHb6IjFj5D777LP3DQwMfDw8PBxSVbUvkUj0hEKhj1588cXH2O7zMSPdplumoxveMx5Zlj3jx4/39vb26gMDA4MsvgYZo+p8Pr7LqQX5Ds/U7d0jFxUVZS1atKg4Nzc317Isp67rZldXV6y5ufkmI78hFtcmrx8ZweMit6XsUs4+6kmlgbW+peLf9gyMZNCR374G0y/FxEzX8b/8+bkXEBxKFwAAAABJRU5ErkJggg==",v.tileXYToQuadKey=function(e,t,n){for(var r="",i=n;i>=0;--i){var o=1<<i,a=0;0!=(e&o)&&(a|=1),0!=(t&o)&&(a|=2),r+=a}return r},v.quadKeyToTileXY=function(e){for(var t=0,n=0,r=e.length-1,i=r;i>=0;--i){var o=1<<i,a=+e[r-i];0!=(1&a)&&(t|=o),0!=(2&a)&&(n|=o)}return{x:t,y:n,level:r}};var w=new c;return v}),o("Scene/CullingVolume",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Intersect","../Core/Plane"],function(e,t,n,r,i,o,a){"use strict";function s(e){this.planes=n(e,[])}var l=[new e,new e,new e];e.clone(e.UNIT_X,l[0]),e.clone(e.UNIT_Y,l[1]),e.clone(e.UNIT_Z,l[2]);var u=new e,c=new e,h=new a(new e,0);return s.fromBoundingSphere=function(n,i){r(i)||(i=new s);var o=l.length,a=i.planes;a.length=2*o;for(var h=n.center,d=n.radius,p=0,f=0;f<o;++f){var m=l[f],_=a[p],g=a[p+1];r(_)||(_=a[p]=new t),r(g)||(g=a[p+1]=new t),e.multiplyByScalar(m,-d,u),e.add(h,u,u),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-e.dot(m,u),e.multiplyByScalar(m,d,u),e.add(h,u,u),g.x=-m.x,g.y=-m.y,g.z=-m.z,g.w=-e.dot(e.negate(m,c),u),p+=2}return i},s.prototype.computeVisibility=function(e){for(var t=this.planes,n=!1,r=0,i=t.length;r<i;++r){var s=e.intersectPlane(a.fromCartesian4(t[r],h));if(s===o.OUTSIDE)return o.OUTSIDE;s===o.INTERSECTING&&(n=!0)}return n?o.INTERSECTING:o.INSIDE},s.prototype.computeVisibilityWithPlaneMask=function(e,t){if(t===s.MASK_OUTSIDE||t===s.MASK_INSIDE)return t;for(var n=s.MASK_INSIDE,r=this.planes,i=0,l=r.length;i<l;++i){var u=i<31?1<<i:0;if(!(i<31&&0==(t&u))){var c=e.intersectPlane(a.fromCartesian4(r[i],h));if(c===o.OUTSIDE)return s.MASK_OUTSIDE;c===o.INTERSECTING&&(n|=u)}}return n},s.MASK_OUTSIDE=4294967295,s.MASK_INSIDE=0,s.MASK_INDETERMINATE=2147483647,s}),o("Scene/PerspectiveOffCenterFrustum",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix4","./CullingVolume"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(){this.left=void 0,this._left=void 0,this.right=void 0,this._right=void 0,this.top=void 0,this._top=void 0,this.bottom=void 0,this._bottom=void 0,this.near=1,this._near=this.near,this.far=5e8,this._far=this.far,this._cullingVolume=new l,this._perspectiveMatrix=new s,this._infinitePerspective=new s}function c(e){var t=e.top,n=e.bottom,r=e.right,i=e.left,o=e.near,a=e.far;t===e._top&&n===e._bottom&&i===e._left&&r===e._right&&o===e._near&&a===e._far||(e._left=i,e._right=r,e._top=t,e._bottom=n,e._near=o,e._far=a,e._perspectiveMatrix=s.computePerspectiveOffCenter(i,r,n,t,o,a,e._perspectiveMatrix),e._infinitePerspective=s.computeInfinitePerspectiveOffCenter(i,r,n,t,o,e._infinitePerspective))}o(u.prototype,{projectionMatrix:{get:function(){return c(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return c(this),this._infinitePerspective}}});var h=new t,d=new t,p=new t,f=new t;return u.prototype.computeCullingVolume=function(e,r,o){var a=this._cullingVolume.planes,s=this.top,l=this.bottom,u=this.right,c=this.left,m=this.near,_=this.far,g=t.cross(r,o,h),v=d;t.multiplyByScalar(r,m,v),t.add(e,v,v);var y=p;t.multiplyByScalar(r,_,y),t.add(e,y,y);var C=f;t.multiplyByScalar(g,c,C),t.add(v,C,C),t.subtract(C,e,C),t.normalize(C,C),t.cross(C,o,C);var w=a[0];return i(w)||(w=a[0]=new n),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-t.dot(C,e),t.multiplyByScalar(g,u,C),t.add(v,C,C),t.subtract(C,e,C),t.normalize(C,C),t.cross(o,C,C),i(w=a[1])||(w=a[1]=new n),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-t.dot(C,e),t.multiplyByScalar(o,l,C),t.add(v,C,C),t.subtract(C,e,C),t.normalize(C,C),t.cross(g,C,C),i(w=a[2])||(w=a[2]=new n),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-t.dot(C,e),t.multiplyByScalar(o,s,C),t.add(v,C,C),t.subtract(C,e,C),t.normalize(C,C),t.cross(C,g,C),i(w=a[3])||(w=a[3]=new n),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-t.dot(C,e),i(w=a[4])||(w=a[4]=new n),w.x=r.x,w.y=r.y,w.z=r.z,w.w=-t.dot(r,v),t.negate(r,C),i(w=a[5])||(w=a[5]=new n),w.x=C.x,w.y=C.y,w.z=C.z,w.w=-t.dot(C,y),this._cullingVolume},u.prototype.getPixelDimensions=function(e,t,n,r){c(this);var i=1/this.near,o=this.top*i,a=2*n*o/t;return r.x=2*n*(o=this.right*i)/e,r.y=a,r},u.prototype.clone=function(e){return i(e)||(e=new u),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},u.prototype.equals=function(e){return i(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},u}),o("Scene/PerspectiveFrustum",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","./PerspectiveOffCenterFrustum"],function(e,t,n,r){"use strict";function i(){this._offCenterFrustum=new r,this.fov=void 0,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=void 0,this._aspectRatio=void 0,this.near=1,this._near=this.near,this.far=5e8,this._far=this.far,this.xOffset=0,this._xOffset=this.xOffset,this.yOffset=0,this._yOffset=this.yOffset}function o(e){var t=e._offCenterFrustum;e.fov===e._fov&&e.aspectRatio===e._aspectRatio&&e.near===e._near&&e.far===e._far&&e.xOffset===e._xOffset&&e.yOffset===e._yOffset||(e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio<=1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset)}return t(i.prototype,{projectionMatrix:{get:function(){return o(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return o(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return o(this),this._fovy}},sseDenominator:{get:function(){return o(this),this._sseDenominator}}}),i.prototype.computeCullingVolume=function(e,t,n){return o(this),this._offCenterFrustum.computeCullingVolume(e,t,n)},i.prototype.getPixelDimensions=function(e,t,n,r){return o(this),this._offCenterFrustum.getPixelDimensions(e,t,n,r)},i.prototype.clone=function(t){return e(t)||(t=new i),t.aspectRatio=this.aspectRatio,t.fov=this.fov,t.near=this.near,t.far=this.far,t._aspectRatio=void 0,t._fov=void 0,t._near=void 0,t._far=void 0,this._offCenterFrustum.clone(t._offCenterFrustum),t},i.prototype.equals=function(t){return!!e(t)&&(o(this),o(t),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))},i}),o("Scene/CameraFlightPath",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/EasingFunction","../Core/Math","./PerspectiveFrustum","./PerspectiveOffCenterFrustum","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e,n,r,o,a){var c=a,h=Math.max(r,o);if(!i(c)){var d=e.up,p=e.right,f=e.frustum,m=t.subtract(e.position,n,y),_=t.magnitude(t.multiplyByScalar(d,t.dot(m,d),C)),g=t.magnitude(t.multiplyByScalar(p,t.dot(m,p),C));c=Math.min(.2*function(e,t,n){var r,i,o;if(e instanceof l){var a=Math.tan(.5*e.fovy);return r=e.near,o=e.aspectRatio*(i=e.near*a),Math.max(t*r/o,n*r/i)}return e instanceof u?(r=e.near,i=e.top,o=e.right,Math.max(t*r/o,n*r/i)):Math.max(t,n)}(f,_,g),1e9)}if(h<c){var v=-Math.pow(1e6*(c-r),1/8),w=Math.pow(1e6*(c-o),1/8);return function(e){return-Math.pow(e*(w-v)+v,8)/1e6+c}}return function(e){return s.lerp(r,o,e)}}function d(e,t){return s.equalsEpsilon(e,s.TWO_PI,s.EPSILON11)&&(e=0),t>e+Math.PI?e+=s.TWO_PI:t<e-Math.PI&&(e-=s.TWO_PI),e}function p(n,r,i,o,a,l,u){var c=n.camera,p=t.clone(c.position,w),f=c.pitch,m=d(c.heading,o),_=d(c.roll,l),g=h(c,i,p.z,i.z,u);return function(t){var n=t.time/r;c.setView({orientation:{heading:s.lerp(m,o,n),pitch:s.lerp(f,a,n),roll:s.lerp(_,l,n)}}),e.lerp(p,i,n,c.position),c.position.z=g(n)}}function f(e,r,i,o,a,l,u){var c=e.camera,p=e.mapProjection.ellipsoid,f=n.clone(c.positionCartographic,b),m=c.pitch,_=d(c.heading,o),g=d(c.roll,l),v=p.cartesianToCartographic(i,E);f.longitude=s.zeroToTwoPi(f.longitude),v.longitude=s.zeroToTwoPi(v.longitude);var y=f.longitude-v.longitude;y<-s.PI?f.longitude+=s.TWO_PI:y>s.PI&&(v.longitude+=s.TWO_PI);var C=h(c,i,f.height,v.height,u);return function(e){var n=e.time/r,i=t.fromRadians(s.lerp(f.longitude,v.longitude,n),s.lerp(f.latitude,v.latitude,n),C(n));c.setView({destination:i,orientation:{heading:s.lerp(_,o,n),pitch:s.lerp(m,a,n),roll:s.lerp(g,l,n)}})}}function m(n,r,i,o,a,l,u){var c=n.camera,p=t.clone(c.position,w),f=d(c.heading,o),m=h(c,i,c.frustum.right-c.frustum.left,i.z,u);return function(t){var n=t.time/r;c.setView({orientation:{heading:s.lerp(f,o,n)}}),e.lerp(p,i,n,c.position);var a=m(n),l=c.frustum,u=l.top/l.right,h=.5*(a-(l.right-l.left));l.right+=h,l.left-=h,l.top=u*l.right,l.bottom=-l.top}}function _(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function g(e,t){return function(){"function"==typeof t&&t(),e.enableInputs=!0}}var v={},y=new t,C=new t,w=new t,b=new n,E=new n,S=new n,x=new t;return v.createTween=function(n,o){var l=(o=r(o,r.EMPTY_OBJECT)).destination,u=n.mode;if(u===c.MORPHING)return _();var h=r(o.convert,!0),d=n.mapProjection,v=d.ellipsoid,y=o.maximumHeight,C=o.easingFunction;h&&u!==c.SCENE3D&&(v.cartesianToCartographic(l,S),l=d.project(S,x));var w=n.camera,b=o.endTransform;i(b)&&w._setTransform(b);var E=o.duration;i(E)||(E=Math.ceil(t.distance(w.position,l)/1e6)+2,E=Math.min(E,3));var T=r(o.heading,0),A=r(o.pitch,-s.PI_OVER_TWO),P=r(o.roll,0),D=n.screenSpaceCameraController;D.enableInputs=!1;var M=g(D,o.complete),I=g(D,o.cancel),O=w.frustum,R=n.mode===c.SCENE2D;if(R=(R=(R=(R=R&&e.equalsEpsilon(w.position,l,s.EPSILON6))&&s.equalsEpsilon(Math.max(O.right-O.left,O.top-O.bottom),l.z,s.EPSILON6))||n.mode!==c.SCENE2D&&t.equalsEpsilon(l,w.position,s.EPSILON10))&&s.equalsEpsilon(s.negativePiToPi(T),s.negativePiToPi(w.heading),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(A),s.negativePiToPi(w.pitch),s.EPSILON10)&&s.equalsEpsilon(s.negativePiToPi(P),s.negativePiToPi(w.roll),s.EPSILON10))return _(M,I);var N=new Array(4);if(N[c.SCENE2D]=m,N[c.SCENE3D]=f,N[c.COLUMBUS_VIEW]=p,E<=0)return _(function(){N[u](n,1,l,T,A,P,y)({time:1}),"function"==typeof M&&M()},I);var L=N[u](n,E,l,T,A,P,y);if(!i(C)){var F=w.positionCartographic.height;C=F>(u===c.SCENE3D?v.cartesianToCartographic(l).height:l.z)&&F>11500?a.CUBIC_OUT:a.QUINTIC_IN_OUT}return{duration:E,easingFunction:C,startObject:{time:0},stopObject:{time:E},update:L,complete:M,cancel:I}},v}),o("Scene/MapMode2D",["../Core/freezeObject"],function(e){"use strict";return e({ROTATE:0,INFINITE_SCROLL:1})}),o("Scene/Camera",["../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/Ellipsoid","../Core/EllipsoidGeodesic","../Core/Event","../Core/HeadingPitchRange","../Core/Intersect","../Core/IntersectionTests","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Quaternion","../Core/Ray","../Core/Rectangle","../Core/Transforms","./CameraFlightPath","./MapMode2D","./PerspectiveFrustum","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T){"use strict";function A(e){this._scene=e,this._transform=v.clone(v.IDENTITY),this._invTransform=v.clone(v.IDENTITY),this._actualTransform=v.clone(v.IDENTITY),this._actualInvTransform=v.clone(v.IDENTITY),this._transformChanged=!1,this.position=new n,this._position=new n,this._positionWC=new n,this._positionCartographic=new i,this.direction=new n,this._direction=new n,this._directionWC=new n,this.up=new n,this._up=new n,this._upWC=new n,this.right=new n,this._right=new n,this._rightWC=new n,this.frustum=new x,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=_.toRadians(60),this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new d,this._moveEnd=new d,this._changed=new d,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new v,this._invViewMatrix=new v,P(this),this._mode=T.SCENE3D,this._modeChanged=!0;var t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new i(Math.PI,_.PI_OVER_TWO)),this._max2Dfrustum=void 0,this._suspendTerrainAdjustment=!1,U(this,A.DEFAULT_VIEW_RECTANGLE,this.position,!0);var r=n.magnitude(this.position);r+=r*A.DEFAULT_VIEW_FACTOR,n.normalize(this.position,this.position),n.multiplyByScalar(this.position,r,this.position)}function P(e){v.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),v.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),v.inverseTransformation(e._viewMatrix,e._invViewMatrix)}function D(e){var t=e._mode,i=!1,o=0;t===T.SCENE2D&&(i=(o=e.frustum.right-e.frustum.left)!==e._positionCartographic.height);var a=e._position,s=!n.equals(a,e.position)||i;s&&(a=n.clone(e.position,e._position));var l=e._direction,u=!n.equals(l,e.direction);u&&(n.normalize(e.direction,e.direction),l=n.clone(e.direction,e._direction));var c=e._up,h=!n.equals(c,e.up);h&&(n.normalize(e.up,e.up),c=n.clone(e.up,e._up));var d=e._right,p=!n.equals(d,e.right);p&&(n.normalize(e.right,e.right),d=n.clone(e.right,e._right));var f,m=e._transformChanged||e._modeChanged;e._transformChanged=!1,m&&(v.inverseTransformation(e._transform,e._invTransform),e._mode===T.COLUMBUS_VIEW||e._mode===T.SCENE2D?v.equals(v.IDENTITY,e._transform)?v.clone(A.TRANSFORM_2D,e._actualTransform):e._mode===T.COLUMBUS_VIEW?b.basisTo2D((f=e)._projection,f._transform,f._actualTransform):function(e){var t=e._projection,i=t.ellipsoid,o=v.getColumn(e._transform,3,Z),a=i.cartesianToCartographic(o,q),s=t.project(a,Y),l=K;l.x=s.z,l.y=s.x,l.z=s.y,l.w=1;var u=r.clone(r.UNIT_X,$),c=r.add(v.getColumn(e._transform,0,X),o,X);i.cartesianToCartographic(c,a),t.project(a,s);var h=Q;h.x=s.z,h.y=s.x,h.z=s.y,h.w=0,n.subtract(h,l,h),h.x=0;var d=J;if(n.magnitudeSquared(h)>_.EPSILON10)n.cross(u,h,d);else{var p=r.add(v.getColumn(e._transform,1,X),o,X);i.cartesianToCartographic(p,a),t.project(a,s),d.x=s.z,d.y=s.x,d.z=s.y,d.w=0,n.subtract(d,l,d),d.x=0,n.magnitudeSquared(d)<_.EPSILON10&&(r.clone(r.UNIT_Y,h),r.clone(r.UNIT_Z,d))}n.cross(d,u,h),n.normalize(h,h),n.cross(u,h,d),n.normalize(d,d),v.setColumn(e._actualTransform,0,h,e._actualTransform),v.setColumn(e._actualTransform,1,d,e._actualTransform),v.setColumn(e._actualTransform,2,u,e._actualTransform),v.setColumn(e._actualTransform,3,l,e._actualTransform)}(e):v.clone(e._transform,e._actualTransform),v.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);var g=e._actualTransform;if(s||m)if(e._positionWC=v.multiplyByPoint(g,a,e._positionWC),t===T.SCENE3D||t===T.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{var y=ee;y.x=e._positionWC.y,y.y=e._positionWC.z,y.z=e._positionWC.x,t===T.SCENE2D&&(y.z=o),e._projection.unproject(y,e._positionCartographic)}if(u||h||p){var C=n.dot(l,n.cross(c,d,ee));if(Math.abs(1-C)>_.EPSILON2){var w=1/n.magnitudeSquared(c),E=n.dot(c,l)*w,S=n.multiplyByScalar(l,E,ee);c=n.normalize(n.subtract(c,S,e._up),e._up),n.clone(c,e.up),d=n.cross(l,c,e._right),n.clone(d,e.right)}}(u||m)&&(e._directionWC=v.multiplyByPointAsVector(g,l,e._directionWC)),(h||m)&&(e._upWC=v.multiplyByPointAsVector(g,c,e._upWC)),(p||m)&&(e._rightWC=v.multiplyByPointAsVector(g,d,e._rightWC)),(s||u||h||p||m)&&P(e)}function M(e,t){var n;return n=_.equalsEpsilon(Math.abs(e.z),1,_.EPSILON3)?Math.atan2(t.y,t.x)-_.PI_OVER_TWO:Math.atan2(e.y,e.x)-_.PI_OVER_TWO,_.TWO_PI-_.zeroToTwoPi(n)}function I(e){return _.PI_OVER_TWO-_.acosClamped(e.z)}function O(e,t,n){var r=0;return _.equalsEpsilon(Math.abs(e.z),1,_.EPSILON3)||(r=Math.atan2(-n.z,t.z),r=_.zeroToTwoPi(r+_.TWO_PI)),r}function R(e,t,r,i){var o=n.clone(r.direction,de),a=n.clone(r.up,pe);if(e._scene.mode===T.SCENE3D){var s=b.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,te),l=v.inverseTransformation(s,ne);v.multiplyByPointAsVector(l,o,o),v.multiplyByPointAsVector(l,a,a)}var u=n.cross(o,a,fe);return i.heading=M(o,a),i.pitch=I(o),i.roll=O(o,a,u),i}function N(e,t){var n,r,i=e._maxCoord.x,o=e._maxCoord.y;e._scene.mapMode2D===S.ROTATE?n=-(r=i):(r=t.x-2*i,n=t.x+2*i),t.x>i&&(t.x=r),t.x<-i&&(t.x=n),t.y>o&&(t.y=o),t.y<-o&&(t.y=-o)}function L(e,t){var r=n.normalize(e.position,be);if(a(e.constrainedAxis)){var i=n.equalsEpsilon(r,e.constrainedAxis,_.EPSILON2),o=n.equalsEpsilon(r,n.negate(e.constrainedAxis,xe),_.EPSILON2);if(i||o)(i&&t<0||o&&t>0)&&e.rotate(e.right,t);else{var s=n.normalize(e.constrainedAxis,Ee),l=n.dot(r,s),u=_.acosClamped(l);t>0&&t>u&&(t=u-_.EPSILON4),l=n.dot(r,n.negate(s,xe)),u=_.acosClamped(l),t<0&&-t>u&&(t=-u+_.EPSILON4);var c=n.cross(s,r,Se);e.rotate(c,t)}}else e.rotate(e.right,t)}function F(e,t){a(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function B(e,t){var n=e.frustum,r=n.right-(t*=.5),i=n.left+t,o=e._maxCoord.x;e._scene.mapMode2D===S.ROTATE&&(o*=e.maximumZoomFactor),r>o&&(r=o,i=-o),r<=i&&(r=1,i=-1);var a=n.top/n.right;n.right=r,n.left=i,n.top=n.right*a,n.bottom=-n.top}function k(e,t){e.move(e.direction,t)}function V(e,t,r){t=_.clamp(t,-_.PI_OVER_TWO,_.PI_OVER_TWO),e=_.zeroToTwoPi(e)-_.PI_OVER_TWO;var i=y.fromAxisAngle(n.UNIT_Y,-t,Pe),o=y.fromAxisAngle(n.UNIT_Z,-e,De),a=y.multiply(o,i,o),s=g.fromQuaternion(a,Me),l=n.clone(n.UNIT_X,Ae);return g.multiplyByVector(s,l,l),n.negate(l,l),n.multiplyByScalar(l,r,l),l}function z(e,t,r,i){return Math.abs(n.dot(t,r))/i-n.dot(e,r)}function U(e,t,r,i){var o=e._projection.ellipsoid,s=i?e:Ge,l=t.north,u=t.south,c=t.east,d=t.west;d>c&&(c+=_.TWO_PI);var p,f=.5*(d+c);if(u<-_.PI_OVER_TWO+_.RADIANS_PER_DEGREE&&l>_.PI_OVER_TWO-_.RADIANS_PER_DEGREE)p=0;else{var m=Oe;m.longitude=f,m.latitude=l,m.height=0;var g=Re;g.longitude=f,g.latitude=u,g.height=0;var v=Ie;a(v)&&v.ellipsoid===o||(Ie=v=new h(void 0,void 0,o)),v.setEndPoints(m,g),p=v.interpolateUsingFraction(.5,Oe).latitude}var y=Oe;y.longitude=f,y.latitude=p,y.height=0;var C=o.cartographicToCartesian(y,ze),w=Oe;w.longitude=c,w.latitude=l;var b=o.cartographicToCartesian(w,Ne);w.longitude=d;var E=o.cartographicToCartesian(w,Fe);w.longitude=f;var S=o.cartographicToCartesian(w,ke);w.latitude=u;var x=o.cartographicToCartesian(w,Ve);w.longitude=c;var T=o.cartographicToCartesian(w,Be);w.longitude=d;var A=o.cartographicToCartesian(w,Le);n.subtract(E,C,E),n.subtract(T,C,T),n.subtract(b,C,b),n.subtract(A,C,A),n.subtract(S,C,S),n.subtract(x,C,x);var P=o.geodeticSurfaceNormal(C,s.direction);n.negate(P,P);var D=n.cross(P,n.UNIT_Z,s.right);n.normalize(D,D);var M=n.cross(D,P,s.up),I=Math.tan(.5*e.frustum.fovy),O=e.frustum.aspectRatio*I,R=Math.max(z(P,M,E,I),z(P,M,T,I),z(P,M,b,I),z(P,M,A,I),z(P,M,S,I),z(P,M,x,I),z(P,D,E,O),z(P,D,T,O),z(P,D,b,O),z(P,D,A,O),z(P,D,S,O),z(P,D,x,O));if(u<0&&l>0){var N=Oe;N.longitude=d,N.latitude=0,N.height=0;var L=o.cartographicToCartesian(N,Ue);n.subtract(L,C,L),R=Math.max(R,z(P,M,L,I),z(P,D,L,O)),N.longitude=c,L=o.cartographicToCartesian(N,Ue),n.subtract(L,C,L),R=Math.max(R,z(P,M,L,I),z(P,D,L,O))}return n.add(C,n.multiplyByScalar(P,-R,Ue),r)}function G(e,t,n){a(n)||(n=p.clone(ht));var r,i,o,s,l,u,c,h,d,f=n.range;if(!a(f)||0===f){var m=t.radius;n.range=0===m?dt:e._mode===T.SCENE2D?((s=m)>(d=s*(h=(c=e.frustum).right/c.top))?u=(l=s)/h:(u=s,l=d),1.5*Math.max(l,u)):(r=m,i=e.frustum,o=Math.tan(.5*i.fovy),Math.max(r/(i.aspectRatio*o),r/o))}return n}function W(e,t,n,r,i,o){Tt.x=e,Tt.y=t;var s=r.pickEllipsoid(Tt,i,At);return a(s)?(Pt[n]=i.cartesianToCartographic(s,Pt[n]),1):(Pt[n]=i.cartesianToCartographic(o[n],Pt[n]),0)}A.TRANSFORM_2D=new v(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),A.TRANSFORM_2D_INVERSE=v.inverseTransformation(A.TRANSFORM_2D,new v),A.DEFAULT_VIEW_RECTANGLE=w.fromDegrees(-95,-20,-70,90),A.DEFAULT_VIEW_FACTOR=.5,A.prototype._updateCameraChanged=function(){if(0!==this._changed.numberOfListeners){var e=this.percentageChanged;if(this._mode===T.SCENE2D){if(!a(this._changedFrustum))return this._changedPosition=n.clone(this.position,this._changedPosition),void(this._changedFrustum=this.frustum.clone());var t,r=this.position,i=this._changedPosition,o=this.frustum,s=this._changedFrustum,l=r.x+o.left,u=r.x+o.right,c=i.x+s.left,h=i.x+s.right,d=r.y+o.bottom,p=r.y+o.top,f=i.y+s.bottom,m=i.y+s.top,g=Math.max(l,c),v=Math.min(u,h),y=Math.max(d,f),C=Math.min(p,m);if(g>=v||y>=p)t=1;else{var w=s;l<c&&u>h&&d<f&&p>m&&(w=o),t=1-(v-g)*(C-y)/((w.right-w.left)*(w.top-w.bottom))}return void(t>e&&(this._changed.raiseEvent(t),this._changedPosition=n.clone(this.position,this._changedPosition),this._changedFrustum=this.frustum.clone(this._changedFrustum)))}if(!a(this._changedDirection))return this._changedPosition=n.clone(this.positionWC,this._changedPosition),void(this._changedDirection=n.clone(this.directionWC,this._changedDirection));var b=_.acosClamped(n.dot(this.directionWC,this._changedDirection))/(.5*this.frustum.fovy),E=n.distance(this.positionWC,this._changedPosition)/this.positionCartographic.height;(b>e||E>e)&&(this._changed.raiseEvent(Math.max(b,E)),this._changedPosition=n.clone(this.positionWC,this._changedPosition),this._changedDirection=n.clone(this.directionWC,this._changedDirection))}};var H=new v,j=new i;A.prototype._adjustHeightForTerrain=function(){var e=this._scene,t=e.screenSpaceCameraController,r=t.minimumCollisionTerrainHeight,i=t.minimumZoomDistance;if(!this._suspendTerrainAdjustment&&t.enableCollisionDetection){var o=this._mode,s=e.globe;if(a(s)&&o!==T.SCENE2D&&o!==T.MORPHING){var l,u,c=s.ellipsoid,h=e.mapProjection;v.equals(this.transform,v.IDENTITY)||(l=v.clone(this.transform,H),u=n.magnitude(this.position),this._setTransform(v.IDENTITY));var d=j;o===T.SCENE3D?c.cartesianToCartographic(this.position,d):h.unproject(this.position,d);var p=!1;if(d.height<r){var f=s.getHeight(d);a(f)&&d.height<(f+=i)&&(d.height=f,o===T.SCENE3D?c.cartographicToCartesian(d,this.position):h.project(d,this.position),p=!0)}a(l)&&(this._setTransform(l),p&&(n.normalize(this.position,this.position),n.negate(this.position,this.direction),n.multiplyByScalar(this.position,Math.max(u,i),this.position),n.normalize(this.direction,this.direction),n.cross(this.direction,this.up,this.right),n.cross(this.right,this.direction,this.up)))}}};var q=new i,Y=new n,X=new n,Z=new r,K=new r,Q=new r,J=new r,$=new r,ee=new n,te=new v,ne=new v;s(A.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return D(this),this._invTransform}},viewMatrix:{get:function(){return D(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return D(this),this._invViewMatrix}},positionCartographic:{get:function(){return D(this),this._positionCartographic}},positionWC:{get:function(){return D(this),this._positionWC}},directionWC:{get:function(){return D(this),this._directionWC}},upWC:{get:function(){return D(this),this._upWC}},rightWC:{get:function(){return D(this),this._rightWC}},heading:{get:function(){if(this._mode!==T.MORPHING){var e=this._projection.ellipsoid,t=v.clone(this._transform,te),n=b.eastNorthUpToFixedFrame(this.positionWC,e,ne);this._setTransform(n);var r=M(this.direction,this.up);return this._setTransform(t),r}}},pitch:{get:function(){if(this._mode!==T.MORPHING){var e=this._projection.ellipsoid,t=v.clone(this._transform,te),n=b.eastNorthUpToFixedFrame(this.positionWC,e,ne);this._setTransform(n);var r=I(this.direction);return this._setTransform(t),r}}},roll:{get:function(){if(this._mode!==T.MORPHING){var e=this._projection.ellipsoid,t=v.clone(this._transform,te),n=b.eastNorthUpToFixedFrame(this.positionWC,e,ne);this._setTransform(n);var r=O(this.direction,this.up,this.right);return this._setTransform(t),r}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),A.prototype.update=function(e){var t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==T.MORPHING,t=this._mode===T.SCENE2D),t){var n=this._max2Dfrustum=this.frustum.clone(),r=n.top/n.right;n.right=2*this._maxCoord.x,n.left=-n.right,n.top=r*n.right,n.bottom=-n.top}this._mode===T.SCENE2D&&N(this,this.position);var i=this._scene.globe,o=!a(i)||i._surface.tileProvider.ready&&!a(i._surface._tileLoadQueue.head)&&0===i._surface._debug.tilesWaitingForChildren;this._suspendTerrainAdjustment&&(this._suspendTerrainAdjustment=!o),this._adjustHeightForTerrain()};var re=new n,ie=new n,oe=new n;A.prototype._setTransform=function(e){var t=n.clone(this.positionWC,re),r=n.clone(this.upWC,ie),i=n.clone(this.directionWC,oe);v.clone(e,this._transform),this._transformChanged=!0,D(this);var o=this._actualInvTransform;v.multiplyByPoint(o,t,this.position),v.multiplyByPointAsVector(o,i,this.direction),v.multiplyByPointAsVector(o,r,this.up),n.cross(this.direction,this.up,this.right),D(this)};var ae=new n,se=new v,le=new v,ue=new y,ce=new g,he=new i,de=new n,pe=new n,fe=new n,me={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0};A.prototype.setView=function(e){e=o(e,o.EMPTY_OBJECT);var r=o(e.orientation,o.EMPTY_OBJECT),i=this._mode;if(i!==T.MORPHING){a(e.endTransform)&&this._setTransform(e.endTransform);var s=o(e.convert,!0),l=o(e.destination,n.clone(this.positionWC,ae));a(l)&&a(l.west)&&(l=this.getRectangleCameraCoordinates(l,ae),s=!1),a(r.direction)&&(r=R(this,l,r,me.orientation));var u=o(r.heading,0),c=o(r.pitch,-_.PI_OVER_TWO),h=o(r.roll,0);this._suspendTerrainAdjustment=!0,i===T.SCENE3D?function(e,t,r,i,o){var a=v.clone(e.transform,se),s=b.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,le);e._setTransform(s),n.clone(n.ZERO,e.position);var l=y.fromHeadingPitchRoll(r-_.PI_OVER_TWO,i,o,ue),u=g.fromQuaternion(l,ce);g.getColumn(u,0,e.direction),g.getColumn(u,2,e.up),n.cross(e.direction,e.up,e.right),e._setTransform(a)}(this,l,u,c,h):i===T.SCENE2D?function(e,r,i,o){var a=-_.PI_OVER_TWO,s=v.clone(e.transform,se);if(e._setTransform(v.IDENTITY),!n.equals(r,e.positionWC)){if(o){var l=e._projection,u=l.ellipsoid.cartesianToCartographic(r,he);r=l.project(u,ae)}t.clone(r,e.position);var c=.5*-r.z,h=-c,d=e.frustum;if(h>c){var p=d.top/d.right;d.right=h,d.left=c,d.top=d.right*p,d.bottom=-d.top}}if(e._scene.mapMode2D===S.ROTATE){var f=y.fromHeadingPitchRoll(i-_.PI_OVER_TWO,a,0,ue),m=g.fromQuaternion(f,ce);g.getColumn(m,2,e.up),n.cross(e.direction,e.up,e.right)}e._setTransform(s)}(this,l,u,s):function(e,t,r,i,o,a){var s=v.clone(e.transform,se);if(e._setTransform(v.IDENTITY),!n.equals(t,e.positionWC)){if(a){var l=e._projection,u=l.ellipsoid.cartesianToCartographic(t,he);t=l.project(u,ae)}n.clone(t,e.position)}var c=y.fromHeadingPitchRoll(r-_.PI_OVER_TWO,i,o,ue),h=g.fromQuaternion(c,ce);g.getColumn(h,0,e.direction),g.getColumn(h,2,e.up),n.cross(e.direction,e.up,e.right),e._setTransform(s)}(this,l,u,c,h,s)}};var _e=new n;A.prototype.flyHome=function(e){var t=this._mode;if(t===T.MORPHING&&this._scene.completeMorph(),t===T.SCENE2D)this.flyTo({destination:w.MAX_VALUE,duration:e,endTransform:v.IDENTITY});else if(t===T.SCENE3D){var r=this.getRectangleCameraCoordinates(A.DEFAULT_VIEW_RECTANGLE),i=n.magnitude(r);i+=i*A.DEFAULT_VIEW_FACTOR,n.normalize(r,r),n.multiplyByScalar(r,i,r),this.flyTo({destination:r,duration:e,endTransform:v.IDENTITY})}else if(t===T.COLUMBUS_VIEW){var o=this._projection.ellipsoid.maximumRadius,a=new n(0,-1,1);a=n.multiplyByScalar(n.normalize(a,a),5*o,a),this.flyTo({destination:a,duration:e,orientation:{heading:0,pitch:-Math.acos(n.normalize(a,_e).z),roll:0},endTransform:v.IDENTITY,convert:!1})}},A.prototype.worldToCameraCoordinates=function(e,t){return a(t)||(t=new r),D(this),v.multiplyByVector(this._actualInvTransform,e,t)},A.prototype.worldToCameraCoordinatesPoint=function(e,t){return a(t)||(t=new n),D(this),v.multiplyByPoint(this._actualInvTransform,e,t)},A.prototype.worldToCameraCoordinatesVector=function(e,t){return a(t)||(t=new n),D(this),v.multiplyByPointAsVector(this._actualInvTransform,e,t)},A.prototype.cameraToWorldCoordinates=function(e,t){return a(t)||(t=new r),D(this),v.multiplyByVector(this._actualTransform,e,t)},A.prototype.cameraToWorldCoordinatesPoint=function(e,t){return a(t)||(t=new n),D(this),v.multiplyByPoint(this._actualTransform,e,t)},A.prototype.cameraToWorldCoordinatesVector=function(e,t){return a(t)||(t=new n),D(this),v.multiplyByPointAsVector(this._actualTransform,e,t)};var ge=new n;A.prototype.move=function(e,t){var r=this.position;n.multiplyByScalar(e,t,ge),n.add(r,ge,r),this._mode===T.SCENE2D&&N(this,r)},A.prototype.moveForward=function(e){e=o(e,this.defaultMoveAmount),this.move(this.direction,e)},A.prototype.moveBackward=function(e){e=o(e,this.defaultMoveAmount),this.move(this.direction,-e)},A.prototype.moveUp=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,e)},A.prototype.moveDown=function(e){e=o(e,this.defaultMoveAmount),this.move(this.up,-e)},A.prototype.moveRight=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,e)},A.prototype.moveLeft=function(e){e=o(e,this.defaultMoveAmount),this.move(this.right,-e)},A.prototype.lookLeft=function(e){e=o(e,this.defaultLookAmount),this.look(this.up,-e)},A.prototype.lookRight=function(e){e=o(e,this.defaultLookAmount),this.look(this.up,e)},A.prototype.lookUp=function(e){e=o(e,this.defaultLookAmount),this.look(this.right,-e)},A.prototype.lookDown=function(e){e=o(e,this.defaultLookAmount),this.look(this.right,e)};var ve=new y,ye=new g;A.prototype.look=function(e,t){var n=o(t,this.defaultLookAmount),r=y.fromAxisAngle(e,-n,ve),i=g.fromQuaternion(r,ye),a=this.direction,s=this.up,l=this.right;g.multiplyByVector(i,a,a),g.multiplyByVector(i,s,s),g.multiplyByVector(i,l,l)},A.prototype.twistLeft=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,e)},A.prototype.twistRight=function(e){e=o(e,this.defaultLookAmount),this.look(this.direction,-e)};var Ce=new y,we=new g;A.prototype.rotate=function(e,t){var r=o(t,this.defaultRotateAmount),i=y.fromAxisAngle(e,-r,Ce),a=g.fromQuaternion(i,we);g.multiplyByVector(a,this.position,this.position),g.multiplyByVector(a,this.direction,this.direction),g.multiplyByVector(a,this.up,this.up),n.cross(this.direction,this.up,this.right),n.cross(this.right,this.direction,this.up)},A.prototype.rotateDown=function(e){L(this,e=o(e,this.defaultRotateAmount))},A.prototype.rotateUp=function(e){L(this,-(e=o(e,this.defaultRotateAmount)))};var be=new n,Ee=new n,Se=new n,xe=new n;A.prototype.rotateRight=function(e){F(this,-(e=o(e,this.defaultRotateAmount)))},A.prototype.rotateLeft=function(e){F(this,e=o(e,this.defaultRotateAmount))},A.prototype.zoomIn=function(e){e=o(e,this.defaultZoomAmount),this._mode===T.SCENE2D?B(this,e):k(this,e)},A.prototype.zoomOut=function(e){e=o(e,this.defaultZoomAmount),this._mode===T.SCENE2D?B(this,-e):k(this,-e)},A.prototype.getMagnitude=function(){return this._mode===T.SCENE3D?n.magnitude(this.position):this._mode===T.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===T.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var Te=new v;A.prototype.lookAt=function(e,t){var n=b.eastNorthUpToFixedFrame(e,c.WGS84,Te);this.lookAtTransform(n,t)};var Ae=new n,Pe=new y,De=new y,Me=new g;A.prototype.lookAtTransform=function(e,r){if(this._setTransform(e),a(r)){var i;if(i=a(r.heading)?V(r.heading,r.pitch,r.range):r,this._mode===T.SCENE2D){t.clone(t.ZERO,this.position),n.negate(i,this.up),this.up.z=0,n.magnitudeSquared(this.up)<_.EPSILON10&&n.clone(n.UNIT_Y,this.up),n.normalize(this.up,this.up),this._setTransform(v.IDENTITY),n.negate(n.UNIT_Z,this.direction),n.cross(this.direction,this.up,this.right),n.normalize(this.right,this.right);var o=this.frustum,s=o.top/o.right;return o.right=.5*n.magnitude(i),o.left=-o.right,o.top=s*o.right,o.bottom=-o.top,void this._setTransform(e)}n.clone(i,this.position),n.negate(this.position,this.direction),n.normalize(this.direction,this.direction),n.cross(this.direction,n.UNIT_Z,this.right),n.magnitudeSquared(this.right)<_.EPSILON10&&n.clone(n.UNIT_X,this.right),n.normalize(this.right,this.right),n.cross(this.right,this.direction,this.up),n.normalize(this.up,this.up)}};var Ie,Oe=new i,Re=new i,Ne=new n,Le=new n,Fe=new n,Be=new n,ke=new n,Ve=new n,ze=new n,Ue=new n,Ge={direction:new n,right:new n,up:new n},We=new i,He=new n,je=new n,qe=new i,Ye=new n,Xe=new n;A.prototype.getRectangleCameraCoordinates=function(e,t){var r=this._mode;return a(t)||(t=new n),r===T.SCENE3D?U(this,e,t):r===T.COLUMBUS_VIEW?function(e,t,n){var r=e._projection;t.west>t.east&&(t=w.MAX_VALUE);var i=e._actualTransform,o=e._actualInvTransform,a=We;a.longitude=t.east,a.latitude=t.north;var s=r.project(a,He);v.multiplyByPoint(i,s,s),v.multiplyByPoint(o,s,s),a.longitude=t.west,a.latitude=t.south;var l=r.project(a,je);v.multiplyByPoint(i,l,l),v.multiplyByPoint(o,l,l);var u=Math.tan(.5*e.frustum.fovy),c=e.frustum.aspectRatio*u;return n.x=.5*(s.x-l.x)+l.x,n.y=.5*(s.y-l.y)+l.y,n.z=.5*Math.max((s.x-l.x)/c,(s.y-l.y)/u),n}(this,e,t):r===T.SCENE2D?function(e,t,n){var r=e._projection;t.west>t.east&&(t=w.MAX_VALUE);var i=qe;i.longitude=t.east,i.latitude=t.north;var o=r.project(i,Ye);i.longitude=t.west,i.latitude=t.south;var a,s,l=r.project(i,Xe),u=.5*Math.abs(o.x-l.x),c=.5*Math.abs(o.y-l.y),h=e.frustum.right/e.frustum.top,d=c*h;return u>d?s=(a=u)/h:(s=c,a=d),c=Math.max(2*a,2*s),n.x=.5*(o.x-l.x)+l.x,n.y=.5*(o.y-l.y)+l.y,(i=r.unproject(n,i)).height=c,r.project(i,n)}(this,e,t):void 0};var Ze=new C,Ke=new C,Qe=new C;A.prototype.pickEllipsoid=function(e,t,r){if(a(r)||(r=new n),t=o(t,c.WGS84),this._mode===T.SCENE3D)r=function(e,t,n,r){n=o(n,c.WGS84);var i=e.getPickRay(t,Ze),a=m.rayEllipsoid(i,n);if(a)return C.getPoint(i,a.start>0?a.start:a.stop,r)}(this,e,t,r);else if(this._mode===T.SCENE2D)r=function(t,n,r,i){var o=t.getPickRay(e,Ke).origin;o.z=0;var a=r.unproject(o);if(!(a.latitude<-_.PI_OVER_TWO||a.latitude>_.PI_OVER_TWO))return r.ellipsoid.cartographicToCartesian(a,i)}(this,0,this._projection,r);else{if(this._mode!==T.COLUMBUS_VIEW)return;r=function(t,r,i,o){var a=t.getPickRay(e,Qe);C.getPoint(a,-a.origin.x/a.direction.x,o);var s=i.unproject(new n(o.y,o.z,0));if(!(s.latitude<-_.PI_OVER_TWO||s.latitude>_.PI_OVER_TWO||s.longitude<-Math.PI||s.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(s,o)}(this,0,this._projection,r)}return r};var Je=new n,$e=new n,et=new n,tt=new n;A.prototype.getPickRay=function(e,t){a(t)||(t=new C);var r=this.frustum;return a(r.aspectRatio)&&a(r.fov)&&a(r.near)?function(e,t,r){var i=e._scene.canvas,o=i.clientWidth,a=i.clientHeight,s=Math.tan(.5*e.frustum.fovy),l=e.frustum.aspectRatio*s,u=e.frustum.near,c=2/o*t.x-1,h=2/a*(a-t.y)-1,d=e.positionWC;n.clone(d,r.origin);var p=n.multiplyByScalar(e.directionWC,u,Je);n.add(d,p,p);var f=n.multiplyByScalar(e.rightWC,c*u*l,$e),m=n.multiplyByScalar(e.upWC,h*u*s,et),_=n.add(p,f,r.direction);return n.add(_,m,_),n.subtract(_,d,_),n.normalize(_,_),r}(this,e,t):function(t,r,i){var o=t._scene.canvas,a=o.clientHeight,s=2/o.clientWidth*e.x-1;s*=.5*(t.frustum.right-t.frustum.left);var l=2/a*(a-e.y)-1;l*=.5*(t.frustum.top-t.frustum.bottom);var u=i.origin;return n.clone(t.position,u),n.multiplyByScalar(t.right,s,tt),n.add(tt,u,u),n.multiplyByScalar(t.up,l,tt),n.add(tt,u,u),n.clone(t.directionWC,i.direction),i}(this,0,t)};var nt=new n,rt=new n;A.prototype.distanceToBoundingSphere=function(e){var t=n.subtract(this.positionWC,e.center,nt),r=n.multiplyByScalar(this.directionWC,n.dot(t,this.directionWC),rt);return Math.max(0,n.magnitude(r)-e.radius)};var it=new t;A.prototype.getPixelSize=function(e,t,n){var r=this.distanceToBoundingSphere(e),i=this.frustum.getPixelDimensions(t,n,r,it);return Math.max(i.x,i.y)};var ot=new n,at=new n,st=new n,lt=new n;A.prototype.createCorrectPositionTween=function(e){if(this._mode===T.COLUMBUS_VIEW)return function(e,t){var r=e.position,i=e.direction,o=e.worldToCameraCoordinatesVector(n.UNIT_X,ot),a=-n.dot(o,r)/n.dot(o,i),s=n.add(r,n.multiplyByScalar(i,a,at),at);e.cameraToWorldCoordinatesPoint(s,s),r=e.cameraToWorldCoordinatesPoint(e.position,st);var l,c,h,d,p,f,m,_=Math.tan(.5*e.frustum.fovy),g=e.frustum.aspectRatio*_,v=n.magnitude(n.subtract(r,s,lt)),y=_*v,C=e._maxCoord.x,w=e._maxCoord.y,b=Math.max(g*v-C,C),E=Math.max(y-w,w);if((r.z<-b||r.z>b||r.y<-E||r.y>E)&&(s.y<-b||s.y>b||s.z<-E||s.z>E))return l=e,c=r,h=s,d=b,p=E,f=t,m=n.clone(c),h.y>d?m.y-=h.y-d:h.y<-d&&(m.y+=-d-h.y),h.z>p?m.z-=h.z-p:h.z<-p&&(m.z+=-p-h.z),{easingFunction:u.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:f,update:function(e){var t=n.lerp(c,m,e.time,new n);l.worldToCameraCoordinatesPoint(t,l.position)}}}(this,e)};var ut=new n,ct={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};A.prototype.cancelFlight=function(){a(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},A.prototype.flyTo=function(e){var t=(e=o(e,o.EMPTY_OBJECT)).destination;if(this._mode!==T.MORPHING){this.cancelFlight();var n=o(e.orientation,o.EMPTY_OBJECT);if(a(n.direction)&&(n=R(this,t,n,me.orientation)),a(e.duration)&&e.duration<=0){var r=me;return r.destination=e.destination,r.orientation.heading=n.heading,r.orientation.pitch=n.pitch,r.orientation.roll=n.roll,r.convert=e.convert,r.endTransform=e.endTransform,this.setView(r),void("function"==typeof e.complete&&e.complete())}var i=a(t.west);i&&(t=this.getRectangleCameraCoordinates(t,ut));var s,l=this;ct.destination=t,ct.heading=n.heading,ct.pitch=n.pitch,ct.roll=n.roll,ct.duration=e.duration,ct.complete=function(){s===l._currentFlight&&(l._currentFlight=void 0),a(e.complete)&&e.complete()},ct.cancel=e.cancel,ct.endTransform=e.endTransform,ct.convert=!i&&e.convert,ct.maximumHeight=e.maximumHeight,ct.easingFunction=e.easingFunction;var u=this._scene;s=u.tweens.add(E.createTween(u,ct)),this._currentFlight=s}};var ht=new p(0,-_.PI_OVER_FOUR,0),dt=100;A.prototype.viewBoundingSphere=function(e,t){t=G(this,e,t),this.lookAt(e.center,t)};var pt=new v,ft=new n,mt=new n,_t=new n,gt=new n,vt=new r,yt=new y,Ct=new g;A.prototype.flyToBoundingSphere=function(e,t){t=o(t,o.EMPTY_OBJECT);var r=this._mode===T.SCENE2D||this._mode===T.COLUMBUS_VIEW;this._setTransform(v.IDENTITY);var i,a=G(this,e,t.offset);i=r?n.multiplyByScalar(n.UNIT_Z,a.range,ft):V(a.heading,a.pitch,a.range);var s,l,u=b.eastNorthUpToFixedFrame(e.center,c.WGS84,pt);if(v.multiplyByPoint(u,i,i),!r){if(s=n.subtract(e.center,i,mt),n.normalize(s,s),l=v.multiplyByPointAsVector(u,n.UNIT_Z,_t),1-Math.abs(n.dot(s,l))<_.EPSILON6){var h=y.fromAxisAngle(s,a.heading,yt),d=g.fromQuaternion(h,Ct);n.fromCartesian4(v.getColumn(u,1,vt),l),g.multiplyByVector(d,l,l)}var p=n.cross(s,l,gt);n.cross(p,s,l),n.normalize(l,l)}this.flyTo({destination:i,orientation:{direction:s,up:l},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction})};var wt=new n,bt=new n,Et=new n,St=new n,xt=[new n,new n,new n,new n],Tt=new t,At=new n,Pt=[new i,new i,new i,new i];return A.prototype.computeViewRectangle=function(t,r){t=o(t,c.WGS84);var i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),a=new e(n.ZERO,t.maximumRadius);if(i.computeVisibility(a)!==f.OUTSIDE){var s=this._scene.canvas,l=s.clientWidth,u=s.clientHeight,h=0,d=function(e,r){var i,o,a=t.radii,s=n.multiplyComponents(t.oneOverRadii,e.positionWC,wt),l=n.magnitude(s),u=n.normalize(s,bt);n.equalsEpsilon(u,n.UNIT_Z,_.EPSILON10)?(i=new n(0,1,0),o=new n(0,0,1)):(i=n.normalize(n.cross(n.UNIT_Z,u,Et),Et),o=n.normalize(n.cross(u,i,St),St));var c=Math.sqrt(n.magnitudeSquared(s)-1),h=n.multiplyByScalar(u,1/l,wt),d=c/l,p=n.multiplyByScalar(i,d,bt),f=n.multiplyByScalar(o,d,Et),m=n.add(h,f,xt[0]);n.subtract(m,p,m),n.multiplyComponents(a,m,m);var g=n.subtract(h,f,xt[1]);n.subtract(g,p,g),n.multiplyComponents(a,g,g);var v=n.subtract(h,f,xt[2]);n.add(v,p,v),n.multiplyComponents(a,v,v);var y=n.add(h,f,xt[3]);return n.add(y,p,y),n.multiplyComponents(a,y,y),xt}(this);if(h+=W(0,0,0,this,t,d),h+=W(0,u,1,this,t,d),h+=W(l,u,2,this,t,d),(h+=W(l,0,3,this,t,d))<2)return w.MAX_VALUE;r=w.fromCartographicArray(Pt,r);for(var p=0,m=Pt[3].longitude,g=0;g<4;++g){var v=Pt[g].longitude,y=Math.abs(v-m);p+=y>_.PI?_.TWO_PI-y:y,m=v}return _.equalsEpsilon(Math.abs(p),_.TWO_PI,_.EPSILON9)&&(r.west=-_.PI,r.east=_.PI,Pt[0].latitude>=0?r.north=_.PI_OVER_TWO:r.south=-_.PI_OVER_TWO),r}},A.clone=function(e,t){return a(t)||(t=new A(e._scene)),n.clone(e.position,t.position),n.clone(e.direction,t.direction),n.clone(e.up,t.up),n.clone(e.right,t.right),v.clone(e._transform,t.transform),t._transformChanged=!0,t},A}),o("Scene/CameraEventType",["../Core/freezeObject"],function(e){"use strict";return e({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4})}),o("Scene/CameraEventAggregator",["../Core/Cartesian2","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/KeyboardEventModifier","../Core/Math","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","./CameraEventType"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e,n){var r=e;return t(n)&&(r+="+"+n),r}function h(n,r,i){var o=c(u.PINCH,r),a=n._update,s=n._isDown,h=n._eventStartPosition,d=n._pressTime,p=n._releaseTime;a[o]=!0,s[o]=!1,h[o]=new e;var f=n._movement[o];t(f)||(f=n._movement[o]={}),f.distance={startPosition:new e,endPosition:new e},f.angleAndHeight={startPosition:new e,endPosition:new e},f.prevAngle=0,n._eventHandler.setInputAction(function(t){n._buttonsDown++,s[o]=!0,d[o]=new Date,e.lerp(t.position1,t.position2,.5,h[o])},l.PINCH_START,r),n._eventHandler.setInputAction(function(){n._buttonsDown=Math.max(n._buttonsDown-1,0),s[o]=!1,p[o]=new Date},l.PINCH_END,r),n._eventHandler.setInputAction(function(t){if(s[o]){a[o]?(e.clone((u=t).distance.startPosition,(c=f).distance.startPosition),e.clone(u.distance.endPosition,c.distance.endPosition),e.clone(u.angleAndHeight.startPosition,c.angleAndHeight.startPosition),e.clone(u.angleAndHeight.endPosition,c.angleAndHeight.endPosition),a[o]=!1,f.prevAngle=f.angleAndHeight.startPosition.x):(e.clone(t.distance.endPosition,f.distance.endPosition),e.clone(t.angleAndHeight.endPosition,f.angleAndHeight.endPosition));for(var n=f.angleAndHeight.endPosition.x,r=f.prevAngle,l=2*Math.PI;n>=r+Math.PI;)n-=l;for(;n<r-Math.PI;)n+=l;f.angleAndHeight.endPosition.x=-n*i.clientWidth/12,f.angleAndHeight.startPosition.x=-r*i.clientWidth/12}var u,c},l.PINCH_MOVE,r)}function d(n,r){var i=c(u.WHEEL,r),o=n._update;o[i]=!0;var s=n._movement[i];t(s)||(s=n._movement[i]={}),s.startPosition=new e,s.endPosition=new e,n._eventHandler.setInputAction(function(t){var n=15*a.toRadians(t);o[i]?(e.clone(e.ZERO,s.startPosition),s.endPosition.x=0,s.endPosition.y=n,o[i]=!1):s.endPosition.y=s.endPosition.y+n},l.WHEEL,r)}function p(n,r,i){var o=c(i,r),a=n._isDown,s=n._eventStartPosition,h=n._pressTime,d=n._releaseTime;a[o]=!1,s[o]=new e;var p,f,m=n._lastMovement[o];t(m)||(m=n._lastMovement[o]={startPosition:new e,endPosition:new e,valid:!1}),i===u.LEFT_DRAG?(p=l.LEFT_DOWN,f=l.LEFT_UP):i===u.RIGHT_DRAG?(p=l.RIGHT_DOWN,f=l.RIGHT_UP):i===u.MIDDLE_DRAG&&(p=l.MIDDLE_DOWN,f=l.MIDDLE_UP),n._eventHandler.setInputAction(function(t){n._buttonsDown++,m.valid=!1,a[o]=!0,h[o]=new Date,e.clone(t.position,s[o])},p,r),n._eventHandler.setInputAction(function(){n._buttonsDown=Math.max(n._buttonsDown-1,0),a[o]=!1,d[o]=new Date},f,r)}function f(t,n){e.clone(t.startPosition,n.startPosition),e.clone(t.endPosition,n.endPosition)}function m(n,r){var i=n._update,o=n._movement,a=n._lastMovement,s=n._isDown;for(var h in u)if(u.hasOwnProperty(h)){var d=u[h];if(t(d)){var p=c(d,r);i[p]=!0,t(n._lastMovement[p])||(n._lastMovement[p]={startPosition:new e,endPosition:new e,valid:!1}),t(n._movement[p])||(n._movement[p]={startPosition:new e,endPosition:new e})}}n._eventHandler.setInputAction(function(l){for(var h in u)if(u.hasOwnProperty(h)){var d=u[h];if(t(d)){var p=c(d,r);s[p]&&(i[p]?(f(o[p],a[p]),a[p].valid=!0,f(l,o[p]),i[p]=!1):e.clone(l.endPosition,o[p].endPosition))}}e.clone(l.endPosition,n._currentMousePosition)},l.MOUSE_MOVE,r)}function _(n){this._eventHandler=new s(n,!0),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new e,d(this,void 0),h(this,void 0,n),p(this,void 0,u.LEFT_DRAG),p(this,void 0,u.RIGHT_DRAG),p(this,void 0,u.MIDDLE_DRAG),m(this,void 0);for(var r in o)if(o.hasOwnProperty(r)){var i=o[r];t(i)&&(d(this,i),h(this,i,n),p(this,i,u.LEFT_DRAG),p(this,i,u.RIGHT_DRAG),p(this,i,u.MIDDLE_DRAG),m(this,i))}}return n(_.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[c(u.WHEEL)]&&this._update[c(u.WHEEL,o.SHIFT)]&&this._update[c(u.WHEEL,o.CTRL)]&&this._update[c(u.WHEEL,o.ALT)]);return this._buttonsDown>0||e}}}),_.prototype.isMoving=function(e,t){var n=c(e,t);return!this._update[n]},_.prototype.getMovement=function(e,t){var n=c(e,t);return this._movement[n]},_.prototype.getLastMovement=function(e,t){var n=c(e,t),r=this._lastMovement[n];if(r.valid)return r},_.prototype.isButtonDown=function(e,t){var n=c(e,t);return this._isDown[n]},_.prototype.getStartMousePosition=function(e,t){if(e===u.WHEEL)return this._currentMousePosition;var n=c(e,t);return this._eventStartPosition[n]},_.prototype.getButtonPressTime=function(e,t){var n=c(e,t);return this._pressTime[n]},_.prototype.getButtonReleaseTime=function(e,t){var n=c(e,t);return this._releaseTime[n]},_.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},_.prototype.isDestroyed=function(){return!1},_.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),r(this)},_}),o("Scene/UrlTemplateImageryProvider",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartographic","../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/freezeObject","../Core/GeographicTilingScheme","../Core/isArray","../Core/loadJson","../Core/loadText","../Core/loadWithXhr","../Core/loadXML","../Core/Math","../Core/Rectangle","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b){"use strict";function E(e){this._errorEvent=new u,this._url=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesUrl=void 0,this._proxy=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this.enablePickFeatures=!0,this.reinitialize(e)}function S(e,t,n){for(var r="",i=0;i<t.length;++i){var o=t[i];r+="string"==typeof o?o:encodeURIComponent(n(o))}var s=e._proxy;return a(s)&&(r=s.getURL(r)),r}function x(e,t){if(a(e)){for(var n,r,i=[],o=0,s=Object.keys(t);o<e.length;){n=Number.MAX_VALUE,r=void 0;for(var l=0;l<s.length;++l){var u=e.indexOf(s[l],o);u>=0&&u<n&&(n=u,r=s[l])}a(r)?(o<n&&i.push(e.substring(o,n)),i.push(t[r]),o=n+r.length):(i.push(e.substring(o)),o=e.length)}return i}}function T(e,t,n){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var r=e.urlSchemeZeroPadding[t];if("string"==typeof r){var i=r.length;i>1&&(n=n.length>=i?n:new Array(i-n.toString().length+1).join("0")+n)}}return n}function A(e,t,n,r){I||(e.tilingScheme.tileXYToRectangle(t,n,r,O),O.west=g.toDegrees(O.west),O.south=g.toDegrees(O.south),O.east=g.toDegrees(O.east),O.north=g.toDegrees(O.north),I=!0)}function P(e,t,n,r){R||(e.tilingScheme.tileXYToNativeRectangle(t,n,r,N),R=!0)}function D(e,t,n,r,i,o,a){if(!L){M(e,0,0,0,i,o);var s=V,l=e.tilingScheme.tileXYToNativeRectangle(t,n,r,B);F.x=e.tileWidth*(s.x-l.west)/l.width|0,F.y=e.tileHeight*(l.north-s.y)/l.height|0,L=!0}}function M(e,t,n,r,i,o,a){if(!k){if(e.tilingScheme instanceof h)V.x=g.toDegrees(i),V.y=g.toDegrees(o);else{var s=z;s.longitude=i,s.latitude=o,e.tilingScheme.projection.project(s,V)}k=!0}}s(E.prototype,{url:{get:function(){return this._url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesUrl}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return a(this._urlParts)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return this._hasAlphaChannel}}}),E.prototype.reinitialize=function(e){var t=this;t._readyPromise=w(e).then(function(e){t.enablePickFeatures=o(e.enablePickFeatures,t.enablePickFeatures),t._url=e.url,t._urlSchemeZeroPadding=o(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding),t._pickFeaturesUrl=e.pickFeaturesUrl,t._proxy=e.proxy,t._tileDiscardPolicy=e.tileDiscardPolicy,t._getFeatureInfoFormats=e.getFeatureInfoFormats,t._subdomains=e.subdomains,t._subdomains=d(t._subdomains)?t._subdomains.slice():a(t._subdomains)&&t._subdomains.length>0?t._subdomains.split(""):["a","b","c"],t._tileWidth=o(e.tileWidth,256),t._tileHeight=o(e.tileHeight,256),t._minimumLevel=o(e.minimumLevel,0),t._maximumLevel=e.maximumLevel,t._tilingScheme=o(e.tilingScheme,new C({ellipsoid:e.ellipsoid})),t._rectangle=o(e.rectangle,t._tilingScheme.rectangle),t._rectangle=v.intersection(t._rectangle,t._tilingScheme.rectangle),t._hasAlphaChannel=o(e.hasAlphaChannel,!0);var n=e.credit;return"string"==typeof n&&(n=new i(n)),t._credit=n,t._urlParts=x(t._url,U),t._pickFeaturesUrlParts=x(t._pickFeaturesUrl,G),!0})},E.prototype.getTileCredits=function(e,t,n){},E.prototype.requestImage=function(e,t,n){var r,i,o,a,s=(i=e,o=t,a=n,I=!1,R=!1,S(r=this,r._urlParts,function(e){return e(r,i,o,a)}));return b.loadImage(this,s)},E.prototype.pickFeatures=function(e,t,n,r,i){if(this.enablePickFeatures&&a(this._pickFeaturesUrl)&&0!==this._getFeatureInfoFormats.length){var o=0,s=this;return function a(){if(o>=s._getFeatureInfoFormats.length)return w([]);var l,u,c,h,d,g,v,y=s._getFeatureInfoFormats[o],C=(u=e,c=t,h=n,d=r,g=i,v=y.format,I=!1,R=!1,L=!1,k=!1,S(l=s,l._pickFeaturesUrlParts,function(e){return e(l,u,c,h,d,g,v)}));return++o,"json"===y.type?p(C).then(y.callback).otherwise(a):"xml"===y.type?_(C).then(y.callback).otherwise(a):"text"===y.type||"html"===y.type?f(C).then(y.callback).otherwise(a):m({url:C,responseType:y.format}).then((function(e,t){return e.callback(t)}).bind(void 0,y)).otherwise(a)}()}};var I=!1,O=new v,R=!1,N=new v,L=!1,F=new e,B=new v,k=!1,V=new t,z=new n,U={"{x}":function(e,t,n,r){return T(e,"{x}",t)},"{y}":function(e,t,n,r){return T(e,"{y}",n)},"{z}":function(e,t,n,r){return T(e,"{z}",r)},"{s}":function(e,t,n,r){return e._subdomains[(t+n+r)%e._subdomains.length]},"{reverseX}":function(e,t,n,r){return T(e,"{reverseX}",e.tilingScheme.getNumberOfXTilesAtLevel(r)-t-1)},"{reverseY}":function(e,t,n,r){return T(e,"{reverseY}",e.tilingScheme.getNumberOfYTilesAtLevel(r)-n-1)},"{reverseZ}":function(e,t,n,r){var i=e.maximumLevel;return T(e,"{reverseZ}",a(i)&&r<i?i-r-1:r)},"{westDegrees}":function(e,t,n,r){return A(e,t,n,r),O.west},"{southDegrees}":function(e,t,n,r){return A(e,t,n,r),O.south},"{eastDegrees}":function(e,t,n,r){return A(e,t,n,r),O.east},"{northDegrees}":function(e,t,n,r){return A(e,t,n,r),O.north},"{westProjected}":function(e,t,n,r){return P(e,t,n,r),N.west},"{southProjected}":function(e,t,n,r){return P(e,t,n,r),N.south},"{eastProjected}":function(e,t,n,r){return P(e,t,n,r),N.east},"{northProjected}":function(e,t,n,r){return P(e,t,n,r),N.north},"{width}":function(e,t,n,r){return e.tileWidth},"{height}":function(e,t,n,r){return e.tileHeight}},G=r(U,{"{i}":function(e,t,n,r,i,o,a){return D(e,t,n,r,i,o),F.x},"{j}":function(e,t,n,r,i,o,a){return D(e,t,n,r,i,o),F.y},"{reverseI}":function(e,t,n,r,i,o,a){return D(e,t,n,r,i,o),e.tileWidth-F.x-1},"{reverseJ}":function(e,t,n,r,i,o,a){return D(e,t,n,r,i,o),e.tileHeight-F.y-1},"{longitudeDegrees}":function(e,t,n,r,i,o,a){return g.toDegrees(i)},"{latitudeDegrees}":function(e,t,n,r,i,o,a){return g.toDegrees(o)},"{longitudeProjected}":function(e,t,n,r,i,o,a){return M(e,0,0,0,i,o),V.x},"{latitudeProjected}":function(e,t,n,r,i,o,a){return M(e,0,0,0,i,o),V.y},"{format}":function(e,t,n,r,i,o,a){return a}});return E}),o("Scene/createOpenStreetMapImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/DeveloperError","../Core/Rectangle","../Core/WebMercatorTilingScheme","./UrlTemplateImageryProvider"],function(e,t,n,r,i,o){"use strict";var a=/\/$/,s=new e("MapQuest, Open Street Map and contributors, CC-BY-SA");return function(n){n=t(n,{});var l=t(n.url,"https://a.tile.openstreetmap.org/");a.test(l)||(l+="/");var u=t(n.fileExtension,"png"),c=new i({ellipsoid:n.ellipsoid}),h=t(n.minimumLevel,0),d=n.maximumLevel,p=t(n.rectangle,c.rectangle),f=c.positionToTileXY(r.southwest(p),h),m=c.positionToTileXY(r.northeast(p),h),_=(Math.abs(m.x-f.x),Math.abs(m.y-f.y),t(n.credit,s));return"string"==typeof _&&(_=new e(_)),new o({url:l+"{z}/{x}/{y}."+u,proxy:n.proxy,credit:_,tilingScheme:c,tileWidth:256,tileHeight:256,minimumLevel:h,maximumLevel:d,rectangle:p})}}),o("Scene/createTangentSpaceDebugPrimitive",["../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/Matrix4","./PerInstanceColorAppearance","./Primitive"],function(e,t,n,r,i,o,a,s,l){"use strict";return function(r){var u=[],c=(r=t(r,t.EMPTY_OBJECT)).geometry;n(c.attributes)&&n(c.primitiveType)||(c=c.constructor.createGeometry(c));var h=c.attributes,d=a.clone(t(r.modelMatrix,a.IDENTITY)),p=t(r.length,1e4);if(n(h.normal)&&u.push(new i({geometry:o.createLineSegmentsForVectors(c,"normal",p),attributes:{color:new e(1,0,0,1)},modelMatrix:d})),n(h.binormal)&&u.push(new i({geometry:o.createLineSegmentsForVectors(c,"binormal",p),attributes:{color:new e(0,1,0,1)},modelMatrix:d})),n(h.tangent)&&u.push(new i({geometry:o.createLineSegmentsForVectors(c,"tangent",p),attributes:{color:new e(0,0,1,1)},modelMatrix:d})),u.length>0)return new l({asynchronous:!1,geometryInstances:u,appearance:new s({flat:!0,translucent:!1})})}}),o("Scene/createTileMapServiceImageryProvider",["../Core/Cartesian2","../Core/Cartographic","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/joinUrls","../Core/loadXML","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./UrlTemplateImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_){"use strict";return function(n){function o(o){for(var a,c,m,_=/tileformat/i,w=/tileset/i,b=/tilesets/i,E=/boundingbox/i,S=/srs/i,x=[],T=o.childNodes[0].childNodes,A=0;A<T.length;A++)if(_.test(T.item(A).nodeName))a=T.item(A);else if(b.test(T.item(A).nodeName)){m=T.item(A);for(var P=T.item(A).childNodes,D=0;D<P.length;D++)w.test(P.item(D).nodeName)&&x.push(P.item(D))}else E.test(T.item(A).nodeName)?c=T.item(A):S.test(T.item(A).nodeName)&&T.item(A);var M=r(n.fileExtension,a.getAttribute("extension")),I=r(n.tileWidth,parseInt(a.getAttribute("width"),10)),O=r(n.tileHeight,parseInt(a.getAttribute("height"),10)),R=r(n.minimumLevel,parseInt(x[0].getAttribute("order"),10)),N=r(n.maximumLevel,parseInt(x[x.length-1].getAttribute("order"),10)),L=m.getAttribute("profile"),F=n.tilingScheme;if(!i(F))if("geodetic"===L||"global-geodetic"===L)F=new l({ellipsoid:n.ellipsoid});else{if("mercator"!==L&&"global-mercator"!==L){var B=u(v,"tilemapresource.xml")+"specifies an unsupported profile attribute, "+L+".";return void((g=p.handleError(g,C,C.errorEvent,B,void 0,void 0,void 0,s)).retry||y.reject(new d(B)))}F=new f({ellipsoid:n.ellipsoid})}var k=h.clone(n.rectangle);if(!i(k)){var V,z,U,G;if(r(n.flipXY,!1)?(U=new e(parseFloat(c.getAttribute("miny")),parseFloat(c.getAttribute("minx"))),G=new e(parseFloat(c.getAttribute("maxy")),parseFloat(c.getAttribute("maxx")))):(U=new e(parseFloat(c.getAttribute("minx")),parseFloat(c.getAttribute("miny"))),G=new e(parseFloat(c.getAttribute("maxx")),parseFloat(c.getAttribute("maxy")))),F instanceof l||"geodetic"===L||"mercator"===L)V=t.fromDegrees(U.x,U.y),z=t.fromDegrees(G.x,G.y);else{var W=F.projection;V=W.unproject(U),z=W.unproject(G)}k=new h(V.longitude,V.latitude,z.longitude,z.latitude)}k.west<F.rectangle.west&&(k.west=F.rectangle.west),k.east>F.rectangle.east&&(k.east=F.rectangle.east),k.south<F.rectangle.south&&(k.south=F.rectangle.south),k.north>F.rectangle.north&&(k.north=F.rectangle.north);var H=F.positionToTileXY(h.southwest(k),R),j=F.positionToTileXY(h.northeast(k),R);(Math.abs(j.x-H.x)+1)*(Math.abs(j.y-H.y)+1)>4&&(R=0);var q=u(v,"{z}/{x}/{reverseY}."+M);y.resolve({url:q,tilingScheme:F,rectangle:k,tileWidth:I,tileHeight:O,minimumLevel:R,maximumLevel:N,proxy:n.proxy,tileDiscardPolicy:n.tileDiscardPolicy,credit:n.credit})}function a(e){var t=r(n.fileExtension,"png"),o=r(n.tileWidth,256),a=r(n.tileHeight,256),s=r(n.minimumLevel,0),l=n.maximumLevel,c=i(n.tilingScheme)?n.tilingScheme:new f({ellipsoid:n.ellipsoid}),h=r(n.rectangle,c.rectangle),d=u(v,"{z}/{x}/{reverseY}."+t);y.resolve({url:d,tilingScheme:c,rectangle:h,tileWidth:o,tileHeight:a,minimumLevel:s,maximumLevel:l,proxy:n.proxy,tileDiscardPolicy:n.tileDiscardPolicy,credit:n.credit})}function s(){var e=u(v,"tilemapresource.xml"),t=n.proxy;i(t)&&(e=t.getURL(e)),c(e).then(o).otherwise(a)}var g,v=(n=r(n,{})).url,y=m.defer(),C=new _(y.promise);return s(),C}}),o("Scene/CreditDisplay",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError"],function(e,t,n,r,i){"use strict";function o(e,t,r){if(!n(e.element)){var i=e.text,o=e.link,a=document.createElement("span");if(e.hasLink()){var s=document.createElement("a");s.textContent=i,s.href=o,s.target="_blank",a.appendChild(s)}else a.textContent=i;a.className="cesium-credit-text",e.element=a}if(t.hasChildNodes()){var l=document.createElement("span");l.textContent=r,l.className="cesium-credit-delimiter",t.appendChild(l)}t.appendChild(e.element)}function a(e,t){if(!n(e.element)){var r=e.text,i=e.link,o=document.createElement("span"),a=document.createElement("img");if(a.src=e.imageUrl,a.style["vertical-align"]="bottom",n(r)&&(a.alt=r,a.title=r),e.hasLink()){var s=document.createElement("a");s.appendChild(a),s.href=i,s.target="_blank",o.appendChild(s)}else o.appendChild(a);o.className="cesium-credit-image",e.element=o}t.appendChild(e.element)}function s(t,n){for(var r=t.length,i=0;i<r;i++)if(e.equals(t[i],n))return!0;return!1}function l(e){var t=e.element;if(n(t)){var r=t.parentNode;if(!e.hasImage()){var i=t.previousSibling;null===i&&(i=t.nextSibling),null!==i&&r.removeChild(i)}r.removeChild(t)}}function u(e,n){var r=document.createElement("span");r.className="cesium-credit-imageContainer";var i=document.createElement("span");i.className="cesium-credit-textContainer",e.appendChild(r),e.appendChild(i),this._delimiter=t(n," \u2022 "),this._textContainer=i,this._imageContainer=r,this._defaultImageCredits=[],this._defaultTextCredits=[],this._displayedCredits={imageCredits:[],textCredits:[]},this._currentFrameCredits={imageCredits:[],textCredits:[]},this.container=e}return u.prototype.addCredit=function(e){if(e.hasImage()){var t=this._currentFrameCredits.imageCredits;s(this._defaultImageCredits,e)||(t[e.id]=e)}else{var n=this._currentFrameCredits.textCredits;s(this._defaultTextCredits,e)||(n[e.id]=e)}},u.prototype.addDefaultCredit=function(e){if(e.hasImage()){var t=this._defaultImageCredits;s(t,e)||t.push(e)}else{var n=this._defaultTextCredits;s(n,e)||n.push(e)}},u.prototype.removeDefaultCredit=function(e){var t;e.hasImage()?-1!==(t=this._defaultImageCredits.indexOf(e))&&this._defaultImageCredits.splice(t,1):-1!==(t=this._defaultTextCredits.indexOf(e))&&this._defaultTextCredits.splice(t,1)},u.prototype.beginFrame=function(){this._currentFrameCredits.imageCredits.length=0,this._currentFrameCredits.textCredits.length=0},u.prototype.endFrame=function(){var e=this._defaultTextCredits.concat(this._currentFrameCredits.textCredits),t=this._defaultImageCredits.concat(this._currentFrameCredits.imageCredits);(function(e,t){var r,i,a,s=e._displayedCredits.textCredits;for(r=0;r<t.length;r++)a=t[r],n(a)&&(i=s.indexOf(a),-1===i?o(a,e._textContainer,e._delimiter):s.splice(i,1));for(r=0;r<s.length;r++)a=s[r],n(a)&&l(a)})(this,e),function(e,t){var r,i,o,s=e._displayedCredits.imageCredits;for(r=0;r<t.length;r++)o=t[r],n(o)&&(i=s.indexOf(o),-1===i?a(o,e._imageContainer):s.splice(i,1));for(r=0;r<s.length;r++)o=s[r],n(o)&&l(o)}(this,t),this._displayedCredits.textCredits=e,this._displayedCredits.imageCredits=t},u.prototype.destroy=function(){return this.container.removeChild(this._textContainer),this.container.removeChild(this._imageContainer),r(this)},u.prototype.isDestroyed=function(){return!1},u}),o("Scene/DebugAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","./Appearance"],function(e,t,n,r,i){"use strict";function o(t){var n,r=(t=e(t,e.EMPTY_OBJECT)).attributeName,o=t.perInstanceAttribute,a=e(t.glslDatatype,"vec3"),s="v_"+r;if("normal"===r||"binormal"===r||"tangent"===r)n="vec4 getColor() { return vec4(("+s+" + vec3(1.0)) * 0.5, 1.0); }\n";else switch("st"===r&&(a="vec2"),a){case"float":n="vec4 getColor() { return vec4(vec3("+s+"), 1.0); }\n";break;case"vec2":n="vec4 getColor() { return vec4("+s+", 0.0, 1.0); }\n";break;case"vec3":n="vec4 getColor() { return vec4("+s+", 1.0); }\n";break;case"vec4":n="vec4 getColor() { return "+s+"; }\n"}var l="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute float batchId;\n"+(o?"":"attribute "+a+" "+r+";\n")+"varying "+a+" "+s+";\nvoid main()\n{\nvec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n"+(o?s+" = czm_batchTable_"+r+"(batchId);\n":s+" = "+r+";\n")+"gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}",u="varying "+a+" "+s+";\n"+n+"\nvoid main()\n{\ngl_FragColor = getColor();\n}";this.material=void 0,this.translucent=e(t.translucent,!1),this._vertexShaderSource=e(t.vertexShaderSource,l),this._fragmentShaderSource=e(t.fragmentShaderSource,u),this._renderState=i.getDefaultRenderState(!1,!1,t.renderState),this._closed=e(t.closed,!1),this._attributeName=r,this._glslDatatype=a}return n(o.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}}),o.prototype.getFragmentShaderSource=i.prototype.getFragmentShaderSource,o.prototype.isTranslucent=i.prototype.isTranslucent,o.prototype.getRenderState=i.prototype.getRenderState,o}),o("Scene/DebugCameraPrimitive",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Geometry","../Core/GeometryAttribute","../Core/GeometryAttributes","../Core/GeometryInstance","../Core/Matrix4","../Core/PrimitiveType","./PerInstanceColorAppearance","./Primitive"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e){e=a(e,a.EMPTY_OBJECT),this._camera=e.camera,this._color=a(e.color,r.CYAN),this._updateOnChange=a(e.updateOnChange,!0),this.show=a(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitive=void 0,this._planesPrimitive=void 0}var y=new Array(8);y[0]=new n(-1,-1,-1,1),y[1]=new n(1,-1,-1,1),y[2]=new n(1,1,-1,1),y[3]=new n(-1,1,-1,1),y[4]=new n(-1,-1,1,1),y[5]=new n(1,-1,1,1),y[6]=new n(1,1,1,1),y[7]=new n(-1,1,1,1);for(var C=new f,w=new Array(8),b=0;b<8;++b)w[b]=new n;var E=new r;return v.prototype.update=function(a){if(this.show){if(this._updateOnChange&&(this._outlinePrimitive=this._outlinePrimitive&&this._outlinePrimitive.destroy(),this._planesPrimitive=this._planesPrimitive&&this._planesPrimitive.destroy()),!s(this._outlinePrimitive)){for(var l=f.multiply(this._camera.frustum.projectionMatrix,this._camera.viewMatrix,C),u=f.inverse(l,C),c=new Float64Array(24),v=0;v<8;++v){var b=n.clone(y[v],w[v]);f.multiplyByVector(u,b,b),t.divideByScalar(b,b.w,b),c[3*v]=b.x,c[3*v+1]=b.y,c[3*v+2]=b.z}var S=new e.fromVertices(c),x=new d;x.position=new h({componentDatatype:o.DOUBLE,componentsPerAttribute:3,values:c});var T=new Uint16Array([0,1,1,2,2,3,3,0,0,4,4,7,7,3,7,6,6,2,2,1,1,5,5,4,5,6]);this._outlinePrimitive=new g({geometryInstances:new p({geometry:{attributes:x,indices:T,primitiveType:m.LINES,boundingSphere:S},attributes:{color:i.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!1,flat:!0}),asynchronous:!1});var A=new Uint16Array([4,5,6,4,6,7,5,1,2,5,2,6,7,6,2,7,2,3,0,1,5,0,5,4,0,4,7,0,7,3,1,0,3,1,3,2]);this._planesPrimitive=new g({geometryInstances:new p({geometry:{attributes:x,indices:A,primitiveType:m.TRIANGLES,boundingSphere:S},attributes:{color:i.fromColor(r.fromAlpha(this._color,.1,E))},id:this.id,pickPrimitive:this}),appearance:new _({translucent:!0,flat:!0}),asynchronous:!1})}this._outlinePrimitive.update(a),this._planesPrimitive.update(a)}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return this._outlinePrimitive=this._outlinePrimitive&&this._outlinePrimitive.destroy(),this._planesPrimitive=this._planesPrimitive&&this._planesPrimitive.destroy(),l(this)},v}),o("Scene/DebugModelMatrixPrimitive",["../Core/Cartesian3","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/GeometryInstance","../Core/Matrix4","../Core/PolylineGeometry","./PolylineColorAppearance","./Primitive"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e){e=n(e,n.EMPTY_OBJECT),this.length=n(e.length,1e7),this._length=void 0,this.width=n(e.width,2),this._width=void 0,this.show=n(e.show,!0),this.modelMatrix=a.clone(n(e.modelMatrix,a.IDENTITY)),this._modelMatrix=new a,this.id=e.id,this._id=void 0,this._primitive=void 0}return c.prototype.update=function(n){if(this.show){if(!r(this._primitive)||!a.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=a.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,r(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);var i=new o({geometry:new s({positions:[e.ZERO,e.UNIT_X],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.RED,t.RED],followSurface:!1}),modelMatrix:a.multiplyByUniformScale(this.modelMatrix,this.length,new a),id:this.id,pickPrimitive:this}),c=new o({geometry:new s({positions:[e.ZERO,e.UNIT_Y],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.GREEN,t.GREEN],followSurface:!1}),modelMatrix:a.multiplyByUniformScale(this.modelMatrix,this.length,new a),id:this.id,pickPrimitive:this}),h=new o({geometry:new s({positions:[e.ZERO,e.UNIT_Z],width:this.width,vertexFormat:l.VERTEX_FORMAT,colors:[t.BLUE,t.BLUE],followSurface:!1}),modelMatrix:a.multiplyByUniformScale(this.modelMatrix,this.length,new a),id:this.id,pickPrimitive:this});this._primitive=new u({geometryInstances:[i,c,h],appearance:new l,asynchronous:!1})}this._primitive.update(n)}},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),i(this)},c}),o("Shaders/DepthPlaneFS",[],function(){"use strict";return"varying vec4 positionEC;\nvoid main()\n{\nczm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\nvec3 direction = normalize(positionEC.xyz);\nczm_ray ray = czm_ray(vec3(0.0), direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (!czm_isEmpty(intersection))\n{\ngl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\nelse\n{\ndiscard;\n}\n}\n"}),o("Shaders/DepthPlaneVS",[],function(){"use strict";return"attribute vec4 position;\nvarying vec4 positionEC;\nvoid main()\n{\npositionEC = czm_modelView * position;\ngl_Position = czm_projection * positionEC;\n}\n"}),o("Scene/DepthPlane",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defined","../Core/FeatureDetection","../Core/Geometry","../Core/GeometryAttribute","../Core/PrimitiveType","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/DepthPlaneFS","../Shaders/DepthPlaneVS","./DepthFunction","./Pass","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0}var y=i.supportsTypedArrays()?new Float32Array(12):[],C=new t,w=new t,b=new t,E=new t;return v.prototype.update=function(i){if(this._mode=i.mode,i.mode===g.SCENE3D){var v=i.context,S=i.mapProjection.ellipsoid;r(this._command)||(this._rs=c.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:m.ALWAYS},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._sp=h.fromCache({context:v,vertexShaderSource:f,fragmentShaderSource:p,attributeLocations:{position:0}}),this._command=new u({renderState:this._rs,shaderProgram:this._sp,boundingVolume:new e(t.ZERO,S.maximumRadius),pass:_.OPAQUE,owner:this}));var x=function(e,n){var r=S.radii,o=t.multiplyComponents(S.oneOverRadii,i.camera.positionWC,C),a=t.magnitude(o),s=t.normalize(o,w),l=t.normalize(t.cross(t.UNIT_Z,o,b),b),u=t.normalize(t.cross(s,l,E),E),c=Math.sqrt(t.magnitudeSquared(o)-1),h=t.multiplyByScalar(s,1/a,C),d=c/a,p=t.multiplyByScalar(l,d,w),f=t.multiplyByScalar(u,d,b),m=t.add(h,f,E);t.subtract(m,p,m),t.multiplyComponents(r,m,m),t.pack(m,y,0);var _=t.subtract(h,f,E);t.subtract(_,p,_),t.multiplyComponents(r,_,_),t.pack(_,y,3);var g=t.add(h,f,E);t.add(g,p,g),t.multiplyComponents(r,g,g),t.pack(g,y,6);var v=t.subtract(h,f,E);return t.add(v,p,v),t.multiplyComponents(r,v,v),t.pack(v,y,9),y}();if(r(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(x);else{var T=new o({attributes:{position:new a({componentDatatype:n.FLOAT,componentsPerAttribute:3,values:x})},indices:[0,1,2,2,1,3],primitiveType:s.TRIANGLES});this._va=d.fromGeometry({context:v,geometry:T,attributeLocations:{position:0},bufferUsage:l.DYNAMIC_DRAW}),this._command.vertexArray=this._va}}},v.prototype.execute=function(e,t){this._mode===g.SCENE3D&&this._command.execute(e,t)},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()},v}),o("Scene/DeviceOrientationCameraController",["../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Math","../Core/Matrix3","../Core/Quaternion"],function(e,t,n,r,i,o,a){"use strict";function s(e){function n(e){var n=e.alpha;return t(n)?(r._alpha=i.toRadians(n),r._beta=i.toRadians(e.beta),void(r._gamma=i.toRadians(e.gamma))):(r._alpha=void 0,r._beta=void 0,void(r._gamma=void 0))}this._scene=e,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;var r=this;window.addEventListener("deviceorientation",n,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",n,!1)}}var l=new a,u=new a,c=new o;return s.prototype.update=function(){t(this._alpha)&&(t(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma),function(e,t,n,r){var i=e.direction,s=e.right,h=e.up,d=a.fromAxisAngle(i,n,u),p=a.fromAxisAngle(s,r,l),f=a.multiply(p,d,p),m=a.fromAxisAngle(h,t,u);a.multiply(m,f,f);var _=o.fromQuaternion(f,c);o.multiplyByVector(_,s,s),o.multiplyByVector(_,h,h),o.multiplyByVector(_,i,i)}(this._scene.camera,-(this._lastAlpha-this._alpha),this._lastBeta-this._beta,this._lastGamma-this._gamma),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma)},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._removeListener(),n(this)},s}),o("Shaders/EllipsoidFS",[],function(){"use strict";return"#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\nvarying vec3 v_positionEC;\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\nvec3 positionEC = czm_pointAlongRay(ray, intersection);\nvec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\nvec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\nvec3 sphericalNormal = normalize(positionMC / u_radii);\nvec3 normalMC = geodeticNormal * side;\nvec3 normalEC = normalize(czm_normal * normalMC);\nvec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\nvec3 positionToEyeEC = -positionEC;\nczm_materialInput materialInput;\nmaterialInput.s = st.s;\nmaterialInput.st = st;\nmaterialInput.str = (positionMC + u_radii) / u_radii;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef ONLY_SUN_LIGHTING\nreturn czm_private_phong(normalize(positionToEyeEC), material);\n#else\nreturn czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\nvoid main()\n{\nfloat maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\nvec3 direction = normalize(v_positionEC);\nvec3 ellipsoidCenter = czm_modelView[3].xyz;\nfloat t1 = -1.0;\nfloat t2 = -1.0;\nfloat b = -2.0 * dot(direction, ellipsoidCenter);\nfloat c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\nfloat discriminant = b * b - 4.0 * c;\nif (discriminant >= 0.0) {\nt1 = (-b - sqrt(discriminant)) * 0.5;\nt2 = (-b + sqrt(discriminant)) * 0.5;\n}\nif (t1 < 0.0 && t2 < 0.0) {\ndiscard;\n}\nfloat t = min(t1, t2);\nif (t < 0.0) {\nt = 0.0;\n}\nczm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\nczm_ray ray = czm_ray(t * direction, direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (czm_isEmpty(intersection))\n{\ndiscard;\n}\nvec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\nvec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\ngl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\ngl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\nt = (intersection.start != 0.0) ? intersection.start : intersection.stop;\nvec3 positionEC = czm_pointAlongRay(ray, t);\nvec4 positionCC = czm_projection * vec4(positionEC, 1.0);\nfloat z = positionCC.z / positionCC.w;\nfloat n = czm_depthRange.near;\nfloat f = czm_depthRange.far;\ngl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n}\n"}),o("Shaders/EllipsoidVS",[],function(){"use strict";return"attribute vec3 position;\nuniform vec3 u_radii;\nvarying vec3 v_positionEC;\nvoid main()\n{\nvec4 p = vec4(u_radii * position, 1.0);\nv_positionEC = (czm_modelView * p).xyz;\ngl_Position = czm_modelViewProjection * p;\ngl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\n}\n"}),o("Scene/EllipsoidPrimitive",["../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian3","../Core/combine","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/EllipsoidFS","../Shaders/EllipsoidVS","./BlendingState","./CullFace","./Material","./Pass","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b){"use strict";function E(t){t=i(t,i.EMPTY_OBJECT),this.center=n.clone(i(t.center,n.ZERO)),this._center=new n,this.radii=n.clone(t.radii),this._radii=new n,this._oneOverEllipsoidRadiiSquared=new n,this._boundingSphere=new e,this.modelMatrix=l.clone(i(t.modelMatrix,l.IDENTITY)),this._modelMatrix=new l,this._computedModelMatrix=new l,this.show=i(t.show,!0),this.material=i(t.material,C.fromType(C.ColorType)),this._material=void 0,this._translucent=void 0,this.id=t.id,this._id=void 0,this.debugShowBoundingVolume=i(t.debugShowBoundingVolume,!1),this.onlySunLighting=i(t.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=i(t.depthTestEnabled,!0),this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new h({owner:i(t._owner,this)}),this._pickCommand=new h({owner:i(t._owner,this)});var r=this;this._uniforms={u_radii:function(){return r.radii},u_oneOverEllipsoidRadiiSquared:function(){return r._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return r._pickId.color}}}var S={position:0};return E.prototype.update=function(i){if(this.show&&i.mode===b.SCENE3D&&o(this.center)&&o(this.radii)){var a=i.context,s=this.material.isTranslucent(),h=this._translucent!==s;o(this._rs)&&!h||(this._translucent=s,this._rs=d.fromCache({cull:{enabled:!0,face:y.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!s&&a.fragmentDepth,blending:s?v.ALPHA_BLEND:void 0})),o(this._va)||(this._va=function(e){var r=e.cache.ellipsoidPrimitive_vertexArray;if(o(r))return r;var i=t.createGeometry(t.fromDimensions({dimensions:new n(2,2,2),vertexFormat:u.POSITION_ONLY}));return r=m.fromGeometry({context:e,geometry:i,attributeLocations:S,bufferUsage:c.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=r,r}(a));var C=!1,E=this.radii;if(!n.equals(this._radii,E)){n.clone(E,this._radii);var x=this._oneOverEllipsoidRadiiSquared;x.x=1/(E.x*E.x),x.y=1/(E.y*E.y),x.z=1/(E.z*E.z),C=!0}l.equals(this.modelMatrix,this._modelMatrix)&&n.equals(this.center,this._center)||(l.clone(this.modelMatrix,this._modelMatrix),n.clone(this.center,this._center),l.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),C=!0),C&&(n.clone(n.ZERO,this._boundingSphere.center),this._boundingSphere.radius=n.maximumComponent(E),e.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));var T=this._material!==this.material;this._material=this.material,this._material.update(a);var A=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var P,D=this._colorCommand;(T||A||h)&&(P=new f({sources:[this.material.shaderSource,_]}),this.onlySunLighting&&P.defines.push("ONLY_SUN_LIGHTING"),!s&&a.fragmentDepth&&P.defines.push("WRITE_DEPTH"),this._sp=p.replaceCache({context:a,shaderProgram:this._sp,vertexShaderSource:g,fragmentShaderSource:P,attributeLocations:S}),D.vertexArray=this._va,D.renderState=this._rs,D.shaderProgram=this._sp,D.uniformMap=r(this._uniforms,this.material._uniforms),D.executeInClosestFrustum=s);var M=i.commandList,I=i.passes;if(I.render&&(D.boundingVolume=this._boundingSphere,D.debugShowBoundingVolume=this.debugShowBoundingVolume,D.modelMatrix=this._computedModelMatrix,D.pass=s?w.TRANSLUCENT:w.OPAQUE,M.push(D)),I.pick){var O=this._pickCommand;o(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=a.createPickId({primitive:this,id:this.id})),(T||A||!o(this._pickSP))&&(P=new f({sources:[this.material.shaderSource,_],pickColorQualifier:"uniform"}),this.onlySunLighting&&P.defines.push("ONLY_SUN_LIGHTING"),!s&&a.fragmentDepth&&P.defines.push("WRITE_DEPTH"),this._pickSP=p.replaceCache({context:a,shaderProgram:this._pickSP,vertexShaderSource:g,fragmentShaderSource:P,attributeLocations:S}),O.vertexArray=this._va,O.renderState=this._rs,O.shaderProgram=this._pickSP,O.uniformMap=r(r(this._uniforms,this._pickUniforms),this.material._uniforms),O.executeInClosestFrustum=s),O.boundingVolume=this._boundingSphere,O.modelMatrix=this._computedModelMatrix,O.pass=s?w.TRANSLUCENT:w.OPAQUE,M.push(O)}}},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),a(this)},E}),o("Shaders/Appearances/EllipsoidSurfaceAppearanceFS",[],function(){"use strict";return"varying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nvec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\nvec3 positionToEyeEC = -v_positionEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n"}),o("Shaders/Appearances/EllipsoidSurfaceAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionMC = position3DHigh + position3DLow;\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n"}),o("Scene/EllipsoidSurfaceAppearance",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/EllipsoidSurfaceAppearanceFS","../Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Appearance","./Material"],function(e,t,n,r,i,o,a,s){"use strict";function l(n){n=e(n,e.EMPTY_OBJECT);var r=e(n.translucent,!0),l=e(n.aboveGround,!1);this.material=t(n.material)?n.material:s.fromType(s.ColorType),this.translucent=e(n.translucent,!0),this._vertexShaderSource=e(n.vertexShaderSource,o),this._fragmentShaderSource=e(n.fragmentShaderSource,i),this._renderState=a.getDefaultRenderState(r,!l,n.renderState),this._closed=!1,this._flat=e(n.flat,!1),this._faceForward=e(n.faceForward,l),this._aboveGround=l}return n(l.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return l.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}}),l.VERTEX_FORMAT=r.POSITION_AND_ST,l.prototype.getFragmentShaderSource=a.prototype.getFragmentShaderSource,l.prototype.isTranslucent=a.prototype.isTranslucent,l.prototype.getRenderState=a.prototype.getRenderState,l}),o("Scene/Fog",["../Core/Cartesian3","../Core/defined","../Core/Math","./SceneMode"],function(e,t,n,r){"use strict";function i(){this.enabled=!0,this.density=2e-4,this.screenSpaceErrorFactor=2}for(var o=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],a=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7],s=0;s<a.length;++s)a[s]*=1e6;for(var l=a[1],u=a[a.length-1],c=0;c<a.length;++c)a[c]=(a[c]-u)/(l-u);var h=0,d=new e;return i.prototype.update=function(i){if(i.fog.enabled=this.enabled){var s=i.camera,c=s.positionCartographic;if(!t(c)||c.height>8e5||i.mode!==r.SCENE3D)return void(i.fog.enabled=!1);var p=c.height,f=function(e){var t,n=o,r=n.length;if(e<n[0])return h=0;if(e>n[r-1])return h=r-2;if(e>=n[h]){if(h+1<r&&e<n[h+1])return h;if(h+2<r&&e<n[h+2])return++h,h}else if(h-1>=0&&e>=n[h-1])return--h,h;for(t=0;t<r-2&&!(e>=n[t]&&e<n[t+1]);++t);return h=t}(p),m=n.clamp((p-o[f])/(o[f+1]-o[f]),0,1),_=n.lerp(a[f],a[f+1],m),g=1e6*this.density;_=_*(g-g/l*u)*1e-6;var v=e.normalize(s.positionWC,d),y=n.clamp(e.dot(s.directionWC,v),0,1);i.fog.density=_*=1-y,i.fog.sse=this.screenSpaceErrorFactor}},i}),o("Scene/FrameRateMonitor",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/TimeConstants"],function(e,t,n,r,i,o,a,s){"use strict";function l(n){function r(){var e;e=i,document[e._hiddenPropertyName]?e.pause():e.unpause()}this._scene=n.scene,this.samplingWindow=e(n.samplingWindow,l.defaultSettings.samplingWindow),this.quietPeriod=e(n.quietPeriod,l.defaultSettings.quietPeriod),this.warmupPeriod=e(n.warmupPeriod,l.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=e(n.minimumFrameRateDuringWarmup,l.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=e(n.minimumFrameRateAfterWarmup,l.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new o,this._nominalFrameRate=new o,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;var i=this;this._preRenderRemoveListener=this._scene.preRender.addEventListener(function(e,t){!function(e,t){if(!(e._pauseCount>0)){var n=a();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=n+e.quietPeriod/s.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/s.SECONDS_PER_MILLISECOND;else if(n>=e._quietPeriodEndTime){e._frameTimes.push(n);var r=n-e.samplingWindow/s.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=r){for(;e._frameTimes.length>=2&&e._frameTimes[1]<r;)e._frameTimes.shift();var i=(n-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/i,i>1e3/(n>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup)?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}}(i)}),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;var u=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;this._visibilityChangeRemoveListener=void 0,t(u)&&(document.addEventListener(u,r,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(u,r,!1)})}return l.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},l.fromScene=function(e){return t(e._frameRateMonitor)&&!e._frameRateMonitor.isDestroyed()||(e._frameRateMonitor=new l({scene:e})),e._frameRateMonitor},n(l.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),l.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},l.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._preRenderRemoveListener(),t(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),r(this)},l}),o("Scene/FrameState",["./SceneMode"],function(e){"use strict";return function(t,n){this.context=t,this.commandList=[],this.shadowMaps=[],this.mode=e.SCENE3D,this.morphTime=e.getMorphTime(e.SCENE3D),this.frameNumber=0,this.time=void 0,this.mapProjection=void 0,this.camera=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.passes={render:!1,pick:!1},this.creditDisplay=n,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0},this.terrainExaggeration=1,this.shadowHints={shadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0}}}),o("Scene/FrustumCommands",["../Core/defaultValue","./Pass"],function(e,t){"use strict";return function(n,r){this.near=e(n,0),this.far=e(r,0);for(var i=t.NUMBER_OF_PASSES,o=new Array(i),a=new Array(i),s=0;s<i;++s)o[s]=[],a[s]=0;this.commands=o,this.indices=a}}),o("Shaders/PostProcessFilters/FXAA",[],function(){"use strict";return"#ifndef FXAA_PRESET\n#define FXAA_PRESET 3\n#endif\n#if (FXAA_PRESET == 3)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        16\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#if (FXAA_PRESET == 4)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        24\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#if (FXAA_PRESET == 5)\n#define FXAA_EDGE_THRESHOLD      (1.0/8.0)\n#define FXAA_EDGE_THRESHOLD_MIN  (1.0/24.0)\n#define FXAA_SEARCH_STEPS        32\n#define FXAA_SEARCH_THRESHOLD    (1.0/4.0)\n#define FXAA_SUBPIX_CAP          (3.0/4.0)\n#define FXAA_SUBPIX_TRIM         (1.0/4.0)\n#endif\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x;\n}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) + ((a * vec3(amountOfA)) + b);\n}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, ivec2 off, vec2 rcpFrame) {\nfloat x = pos.x + float(off.x) * rcpFrame.x;\nfloat y = pos.y + float(off.y) * rcpFrame.y;\nreturn texture2D(tex, vec2(x, y));\n}\nvec3 FxaaPixelShader(vec2 pos, sampler2D tex, vec2 rcpFrame)\n{\nvec3 rgbN = FxaaTexOff(tex, pos.xy, ivec2( 0,-1), rcpFrame).xyz;\nvec3 rgbW = FxaaTexOff(tex, pos.xy, ivec2(-1, 0), rcpFrame).xyz;\nvec3 rgbM = FxaaTexOff(tex, pos.xy, ivec2( 0, 0), rcpFrame).xyz;\nvec3 rgbE = FxaaTexOff(tex, pos.xy, ivec2( 1, 0), rcpFrame).xyz;\nvec3 rgbS = FxaaTexOff(tex, pos.xy, ivec2( 0, 1), rcpFrame).xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaM = FxaaLuma(rgbM);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaS = FxaaLuma(rgbS);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD))\n{\nreturn rgbM;\n}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff(tex, pos.xy, ivec2(-1,-1), rcpFrame).xyz;\nvec3 rgbNE = FxaaTexOff(tex, pos.xy, ivec2( 1,-1), rcpFrame).xyz;\nvec3 rgbSW = FxaaTexOff(tex, pos.xy, ivec2(-1, 1), rcpFrame).xyz;\nvec3 rgbSE = FxaaTexOff(tex, pos.xy, ivec2( 1, 1), rcpFrame).xyz;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma(rgbNW);\nfloat lumaNE = FxaaLuma(rgbNE);\nfloat lumaSW = FxaaLuma(rgbSW);\nfloat lumaSE = FxaaLuma(rgbSE);\nfloat edgeVert =\nabs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz =\nabs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -rcpFrame.y : -rcpFrame.x;\nif(!horzSpan)\n{\nlumaN = lumaW;\nlumaS = lumaE;\n}\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nif (gradientN < gradientS)\n{\nlumaN = lumaS;\nlumaN = lumaS;\ngradientN = gradientS;\nlengthSign *= -1.0;\n}\nvec2 posN;\nposN.x = pos.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = pos.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(rcpFrame.x, 0.0) : vec2(0.0, rcpFrame.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN)\n{\nlumaEndN = FxaaLuma(texture2D(tex, posN.xy).xyz);\n}\nif(!doneP)\n{\nlumaEndP = FxaaLuma(texture2D(tex, posP.xy).xyz);\n}\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP)\n{\nbreak;\n}\nif(!doneN)\n{\nposN -= offNP;\n}\nif(!doneP)\n{\nposP += offNP;\n}\n}\nfloat dstN = horzSpan ? pos.x - posN.x : pos.y - posN.y;\nfloat dstP = horzSpan ? posP.x - pos.x : posP.y - pos.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\n{\nlengthSign = 0.0;\n}\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = texture2D(tex, vec2(\npos.x + (horzSpan ? 0.0 : subPixelOffset),\npos.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\nreturn FxaaLerp3(rgbL, rgbF, blendL);\n}\nuniform sampler2D u_texture;\nuniform vec2 u_step;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = vec4(FxaaPixelShader(v_textureCoordinates, u_texture, u_step), 1.0);\n}\n"}),o("Scene/FXAA",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/FXAA"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(t){this._texture=void 0,this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._fbo=void 0,this._command=void 0,this._viewport=new e,this._rs=void 0;var r=new a({color:new n(0,0,0,0),depth:1,owner:this});this._clearCommand=r}return f.prototype.update=function(n){var i=n.drawingBufferWidth,a=n.drawingBufferHeight,f=this._texture,m=!r(f)||f.width!==i||f.height!==a;if(m&&(this._texture=this._texture&&this._texture.destroy(),this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._texture=new d({context:n,width:i,height:a,pixelFormat:o.RGBA,pixelDatatype:l.UNSIGNED_BYTE}),n.depthTexture?this._depthTexture=new d({context:n,width:i,height:a,pixelFormat:o.DEPTH_COMPONENT,pixelDatatype:l.UNSIGNED_SHORT}):this._depthRenderbuffer=new u({context:n,width:i,height:a,format:c.DEPTH_COMPONENT16})),r(this._fbo)&&!m||(this._fbo=this._fbo&&this._fbo.destroy(),this._fbo=new s({context:n,colorTextures:[this._texture],depthTexture:this._depthTexture,depthRenderbuffer:this._depthRenderbuffer,destroyAttachments:!1})),r(this._command)||(this._command=n.createViewportQuadCommand(p,{owner:this})),this._viewport.width=i,this._viewport.height=a,r(this._rs)&&e.equals(this._rs.viewport,this._viewport)||(this._rs=h.fromCache({viewport:this._viewport})),this._command.renderState=this._rs,m){var _=this,g=new t(1/this._texture.width,1/this._texture.height);this._command.uniformMap={u_texture:function(){return _._texture},u_step:function(){return g}}}},f.prototype.execute=function(e,t){this._command.execute(e,t)},f.prototype.clear=function(e,t,r){var i=t.framebuffer;t.framebuffer=this._fbo,n.clone(r,this._clearCommand.color),this._clearCommand.execute(e,t),t.framebuffer=i},f.prototype.getColorFramebuffer=function(){return this._fbo},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._texture=this._texture&&this._texture.destroy(),this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._fbo=void 0,this._texture=void 0,this._depthTexture=void 0,this._depthRenderbuffer=void 0,r(this._command)&&(this._command.shaderProgram=this._command.shaderProgram&&this._command.shaderProgram.destroy(),this._command=void 0),i(this)},f}),o("Scene/GetFeatureInfoFormat",["../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/RuntimeError","./ImageryLayerFeatureInfo"],function(e,t,n,r,i,o){"use strict";function a(t){for(var r=[],i=t.features,a=0;a<i.length;++a){var s=i[a],l=new o;l.data=s,l.properties=s.properties,l.configureNameFromProperties(s.properties),l.configureDescriptionFromProperties(s.properties),n(s.geometry)&&"Point"===s.geometry.type&&(l.position=e.fromDegrees(s.geometry.coordinates[0],s.geometry.coordinates[1])),r.push(l)}return r}function s(e){var t=e.documentElement;if("MultiFeatureCollection"===t.localName&&t.namespaceURI===h)return function(t){for(var n=[],r=e.documentElement.getElementsByTagNameNS(h,"Feature"),i=0;i<r.length;++i){for(var a=r[i],s={},l=a.getElementsByTagNameNS(h,"Val"),u=0;u<l.length;++u){var c=l[u];if(c.hasAttribute("ref")){var d=c.getAttribute("ref"),p=c.textContent.trim();s[d]=p}}var f=new o;f.data=a,f.properties=s,f.configureNameFromProperties(s),f.configureDescriptionFromProperties(s),n.push(f)}return n}();if("FeatureInfoResponse"===t.localName&&t.namespaceURI===d)return function(t){var n,r=e.documentElement,i=[],o=r.getElementsByTagNameNS("*","FIELDS");if(o.length>0)for(var a=0;a<o.length;++a){var s=o[a];n={};for(var l=s.attributes,c=0;c<l.length;++c){var h=l[c];n[h.name]=h.value}i.push(u(s,n))}else for(var d=r.getElementsByTagNameNS("*","FeatureInfo"),p=0;p<d.length;++p){var f=d[p];n={};for(var m=f.childNodes,_=0;_<m.length;++_){var g=m[_];g.nodeType===Node.ELEMENT_NODE&&(n[g.localName]=g.textContent)}i.push(u(f,n))}return i}();if("FeatureCollection"===t.localName&&t.namespaceURI===p)return function(t){for(var n=[],r=e.documentElement.getElementsByTagNameNS(f,"featureMember"),i=0;i<r.length;++i){var o=r[i],a={};l(o,a),n.push(u(o,a))}return n}();if("ServiceExceptionReport"===t.localName)throw new i((new XMLSerializer).serializeToString(t));return"msGMLOutput"===t.localName?function(t){for(var n,r=[],i=e.documentElement.childNodes,o=0;o<i.length;o++)if(i[o].nodeType===Node.ELEMENT_NODE){n=i[o];break}for(var a=n.childNodes,s=0;s<a.length;++s){var c=a[s];if(c.nodeType===Node.ELEMENT_NODE){var h={};l(c,h),r.push(u(c,h))}}return r}():function(e){var t=(new XMLSerializer).serializeToString(e),n=document.createElement("div"),r=document.createElement("pre");r.textContent=t,n.appendChild(r);var i=new o;return i.data=e,i.description=n.innerHTML,[i]}(e)}function l(e,t){for(var n=!0,r=0;r<e.childNodes.length;++r){var i=e.childNodes[r];i.nodeType===Node.ELEMENT_NODE&&(n=!1),"Point"!==i.localName&&"LineString"!==i.localName&&"Polygon"!==i.localName&&"boundedBy"!==i.localName&&i.hasChildNodes()&&l(i,t)&&(t[i.localName]=i.textContent)}return n}function u(e,t){var n=new o;return n.data=e,n.properties=t,n.configureNameFromProperties(t),n.configureDescriptionFromProperties(t),n}function c(e){if(!m.test(e)&&!_.test(e)){var t,n=g.exec(e);n&&n.length>1&&(t=n[1]);var r=new o;return r.name=t,r.description=e,r.data=e,[r]}}var h="http://www.mapinfo.com/mxp",d="http://www.esri.com/wms",p="http://www.opengis.net/wfs",f="http://www.opengis.net/gml",m=/<body>\s*<\/body>/im,_=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,g=/<title>([\s\S]*)<\/title>/im;return function(e,t,r){this.type=e,n(t)||("json"===e?t="application/json":"xml"===e?t="text/xml":"html"===e?t="text/html":"text"===e&&(t="text/plain")),this.format=t,n(r)||("json"===e?r=a:"xml"===e?r=s:"html"===e?r=c:"text"===e&&(r=c)),this.callback=r}}),o("Shaders/GlobeFS",[],function(){"use strict";return"uniform vec4 u_initialColor;\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n#ifdef ENABLE_DAYNIGHT_SHADING\nuniform vec2 u_lightingFadeDistance;\n#endif\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\nvec4 sampleAndBlend(\nvec4 previousColor,\nsampler2D texture,\nvec2 tileTextureCoordinates,\nvec4 textureCoordinateRectangle,\nvec4 textureCoordinateTranslationAndScale,\nfloat textureAlpha,\nfloat textureBrightness,\nfloat textureContrast,\nfloat textureHue,\nfloat textureSaturation,\nfloat textureOneOverGamma)\n{\nvec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nalphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nvec2 translation = textureCoordinateTranslationAndScale.xy;\nvec2 scale = textureCoordinateTranslationAndScale.zw;\nvec2 textureCoordinates = tileTextureCoordinates * scale + translation;\nvec4 value = texture2D(texture, textureCoordinates);\nvec3 color = value.rgb;\nfloat alpha = value.a;\n#ifdef APPLY_BRIGHTNESS\ncolor = mix(vec3(0.0), color, textureBrightness);\n#endif\n#ifdef APPLY_CONTRAST\ncolor = mix(vec3(0.5), color, textureContrast);\n#endif\n#ifdef APPLY_HUE\ncolor = czm_hue(color, textureHue);\n#endif\n#ifdef APPLY_SATURATION\ncolor = czm_saturation(color, textureSaturation);\n#endif\n#ifdef APPLY_GAMMA\ncolor = pow(color, vec3(textureOneOverGamma));\n#endif\nfloat sourceAlpha = alpha * textureAlpha;\nfloat outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\nvec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\nreturn vec4(outColor, outAlpha);\n}\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue);\nvoid main()\n{\nvec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n#ifdef SHOW_TILE_BOUNDARIES\nif (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\nv_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n{\ncolor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n#endif\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING)\nvec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));\nvec3 normalEC = czm_normal3D * normalMC;\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nvec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\nvec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\nvec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\nfloat mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\nif (mask > 0.0)\n{\nmat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\nvec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\nvec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\nvec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\ncolor = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask);\n}\n#endif\n#ifdef ENABLE_VERTEX_LIGHTING\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\nfloat cameraDist = length(czm_view[3]);\nfloat fadeOutDist = u_lightingFadeDistance.x;\nfloat fadeInDist = u_lightingFadeDistance.y;\nfloat t = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\ndiffuseIntensity = mix(1.0, diffuseIntensity, t);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\nvec4 finalColor = color;\n#endif\n#ifdef FOG\nconst float fExposure = 2.0;\nvec3 fogColor = v_mieColor + finalColor.rgb * v_rayleighColor;\nfogColor = vec3(1.0) - exp(-fExposure * fogColor);\ngl_FragColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#else\ngl_FragColor = finalColor;\n#endif\n}\n#ifdef SHOW_REFLECTIVE_OCEAN\nfloat waveFade(float edge0, float edge1, float x)\n{\nfloat y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\nreturn pow(1.0 - y, 5.0);\n}\nfloat linearFade(float edge0, float edge1, float x)\n{\nreturn clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue)\n{\nvec3 positionToEyeEC = -positionEyeCoordinates;\nfloat positionToEyeECLength = length(positionToEyeEC);\nvec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\nfloat waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n#ifdef SHOW_OCEAN_WAVES\nfloat time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\nvec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\nvec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\ntime = czm_frameNumber * oceanAnimationSpeedLowAltitude;\nnoise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\nvec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\nfloat highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\nfloat lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\nvec3 normalTangentSpace =\n(highAltitudeFade * normalTangentSpaceHighAltitude) +\n(lowAltitudeFade * normalTangentSpaceLowAltitude);\nnormalTangentSpace = normalize(normalTangentSpace);\nnormalTangentSpace.xy *= waveIntensity;\nnormalTangentSpace = normalize(normalTangentSpace);\n#else\nvec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\nvec3 normalEC = enuToEye * normalTangentSpace;\nconst vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\nfloat diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\nvec3 diffuseHighlight = waveHighlightColor * diffuseIntensity;\n#ifdef SHOW_OCEAN_WAVES\nfloat tsPerturbationRatio = normalTangentSpace.z;\nvec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\nvec3 nonDiffuseHighlight = vec3(0.0);\n#endif\nfloat specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\nfloat surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\nfloat specular = specularIntensity * surfaceReflectance;\nreturn vec4(imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular, imageryColor.a);\n}\n#endif\n"}),o("Shaders/GlobeVS",[],function(){"use strict";return"#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef FOG\nvarying float v_distance;\nvarying vec3 v_mieColor;\nvarying vec3 v_rayleighColor;\n#endif\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn u_modifiedModelViewProjection * vec4(position, 1.0);\n}\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\nconst float maxTileWidth = 0.003068;\nfloat positionFraction = textureCoordinates.y;\nfloat southLatitude = u_southAndNorthLatitude.x;\nfloat northLatitude = u_southAndNorthLatitude.y;\nif (northLatitude - southLatitude > maxTileWidth)\n{\nfloat southMercatorY = u_southMercatorYAndOneOverHeight.x;\nfloat oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\nfloat currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\ncurrentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\npositionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n}\nreturn positionFraction;\n}\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\nreturn textureCoordinates.y;\n}\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nreturn u_modifiedModelViewProjection * rtcPosition2D;\n}\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, height, textureCoordinates);\n}\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\nvec3 position3DWC = position + u_center3D;\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nvec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\nreturn czm_modelViewProjection * morphPosition;\n}\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\nvec2 xy = czm_decompressTextureCoordinates(compressed0.x);\nvec2 zh = czm_decompressTextureCoordinates(compressed0.y);\nvec3 position = vec3(xy, zh.x);\nfloat height = zh.y;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\nheight = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\nposition = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = compressed0.w;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#else\nvec3 position = position3DAndHeight.xyz;\nfloat height = position3DAndHeight.w;\nvec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = 0.0;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#endif\nvec3 position3DWC = position + u_center3D;\ngl_Position = getPosition(position, height, textureCoordinates);\nv_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\nv_normalMC = czm_octDecode(encodedNormal);\nv_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\n#endif\n#ifdef FOG\nAtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(position3DWC);\nv_mieColor = atmosColor.mie;\nv_rayleighColor = atmosColor.rayleigh;\nv_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n}\n"}),o("Shaders/GroundAtmosphere",[],function(){"use strict";return"const float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\nstruct AtmosphereColor\n{\nvec3 mie;\nvec3 rayleigh;\n};\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nfloat scale(float fCos)\n{\nfloat x = 1.0 - fCos;\nreturn fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos)\n{\nvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\nvec3 v3Ray = v3Pos - czm_viewerPositionWC;\nfloat fFar = length(v3Ray);\nv3Ray /= fFar;\nfloat fCameraHeight = length(czm_viewerPositionWC);\nfloat fCameraHeight2 = fCameraHeight * fCameraHeight;\nfloat B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\nfloat C = fCameraHeight2 - fOuterRadius2;\nfloat fDet = max(0.0, B*B - 4.0 * C);\nfloat fNear = 0.5 * (-B - sqrt(fDet));\nvec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\nfFar -= fNear;\nfloat fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\nfloat fLightAngle = 1.0;\nfloat fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\nfloat fCameraScale = scale(fCameraAngle);\nfloat fLightScale = scale(fLightAngle);\nfloat fCameraOffset = fDepth*fCameraScale;\nfloat fTemp = (fLightScale + fCameraScale);\nfloat fSampleLength = fFar / fSamples;\nfloat fScaledLength = fSampleLength * fScale;\nvec3 v3SampleRay = v3Ray * fSampleLength;\nvec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\nvec3 v3FrontColor = vec3(0.0);\nvec3 v3Attenuate = vec3(0.0);\nfor(int i=0; i<nSamples; i++)\n{\nfloat fHeight = length(v3SamplePoint);\nfloat fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\nfloat fScatter = fDepth*fTemp - fCameraOffset;\nv3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\nv3FrontColor += v3Attenuate * (fDepth * fScaledLength);\nv3SamplePoint += v3SampleRay;\n}\nAtmosphereColor color;\ncolor.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\ncolor.rayleigh = v3Attenuate;\nreturn color;\n}\n"}),o("Scene/GlobeSurfaceShaderSet",["../Core/defined","../Core/destroyObject","../Core/TerrainQuantization","../Renderer/ShaderProgram","../Scene/SceneMode"],function(e,t,n,r,i){"use strict";function o(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this._pickShaderPrograms=[]}function a(e){var t;switch(e){case i.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case i.SCENE2D:case i.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case i.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}function s(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}return o.prototype.getShaderProgram=function(t,i,o,l,u,c,h,d,p,f,m,_,g,v,y){var C=0,w="",b=i.pickTerrain.mesh.encoding;b.quantization===n.BITS12&&(C=1,w="QUANTIZATION_BITS12");var E=t.mode,S=E|l<<2|u<<3|c<<4|h<<5|d<<6|p<<7|f<<8|m<<9|_<<10|g<<11|v<<12|y<<13|C<<14,x=i.surfaceShader;if(e(x)&&x.numberOfDayTextures===o&&x.flags===S)return x.shaderProgram;var T=this._shadersByTexturesFlags[o];if(e(T)||(T=this._shadersByTexturesFlags[o]=[]),!e(x=T[S])){var A=this.baseVertexShaderSource.clone(),P=this.baseFragmentShaderSource.clone();A.defines.push(w),P.defines.push("TEXTURE_UNITS "+o),l&&P.defines.push("APPLY_BRIGHTNESS"),u&&P.defines.push("APPLY_CONTRAST"),c&&P.defines.push("APPLY_HUE"),h&&P.defines.push("APPLY_SATURATION"),d&&P.defines.push("APPLY_GAMMA"),p&&P.defines.push("APPLY_ALPHA"),f&&(P.defines.push("SHOW_REFLECTIVE_OCEAN"),A.defines.push("SHOW_REFLECTIVE_OCEAN")),m&&P.defines.push("SHOW_OCEAN_WAVES"),_&&(g?(A.defines.push("ENABLE_VERTEX_LIGHTING"),P.defines.push("ENABLE_VERTEX_LIGHTING")):(A.defines.push("ENABLE_DAYNIGHT_SHADING"),P.defines.push("ENABLE_DAYNIGHT_SHADING"))),A.defines.push("INCLUDE_WEB_MERCATOR_Y"),P.defines.push("INCLUDE_WEB_MERCATOR_Y"),y&&(A.defines.push("FOG"),P.defines.push("FOG"));for(var D="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n",M=0;M<o;++M)D+="    color = sampleAndBlend(\n        color,\n        u_dayTextures["+M+"],\n        u_dayTextureUseWebMercatorT["+M+"] ? textureCoordinates.xz : textureCoordinates.xy,\n        u_dayTextureTexCoordsRectangle["+M+"],\n        u_dayTextureTranslationAndScale["+M+"],\n        "+(p?"u_dayTextureAlpha["+M+"]":"1.0")+",\n        "+(l?"u_dayTextureBrightness["+M+"]":"0.0")+",\n        "+(u?"u_dayTextureContrast["+M+"]":"0.0")+",\n        "+(c?"u_dayTextureHue["+M+"]":"0.0")+",\n        "+(h?"u_dayTextureSaturation["+M+"]":"0.0")+",\n        "+(d?"u_dayTextureOneOverGamma["+M+"]":"0.0")+"\n    );\n";P.sources.push(D+="        return color;\n    }"),A.sources.push(a(E)),A.sources.push(s(v));var I=r.fromCache({context:t.context,vertexShaderSource:A,fragmentShaderSource:P,attributeLocations:b.getAttributeLocations()});x=T[S]=new function(e,t,n){this.numberOfDayTextures=o,this.flags=t,this.shaderProgram=n}(0,S,I)}return i.surfaceShader=x,x.shaderProgram},o.prototype.getPickShaderProgram=function(t,i,o){var l=0,u="",c=i.pickTerrain.mesh.encoding;c.quantization===n.BITS12&&(l=1,u="QUANTIZATION_BITS12");var h=t.mode,d=h|o<<2|l<<3,p=this._pickShaderPrograms[d];if(!e(p)){var f=this.baseVertexShaderSource.clone();f.defines.push(u),f.sources.push(a(h)),f.sources.push(s(o)),p=this._pickShaderPrograms[d]=r.fromCache({context:t.context,vertexShaderSource:f,fragmentShaderSource:"void main()\n{\n    gl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\n",attributeLocations:c.getAttributeLocations()})}return p},o.prototype.destroy=function(){var n,r,i=this._shadersByTexturesFlags;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];if(!e(a))continue;for(n in a)a.hasOwnProperty(n)&&(r=a[n],e(r)&&r.shaderProgram.destroy())}var s=this._pickShaderPrograms;for(n in s)s.hasOwnProperty(n)&&(r=s[n],r.destroy());return t(this)},o}),o("Scene/ImageryState",["../Core/freezeObject"],function(e){"use strict";return e({UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7})}),o("Scene/QuadtreeTileLoadState",["../Core/freezeObject"],function(e){"use strict";return e({START:0,LOADING:1,DONE:2,FAILED:3})}),o("Scene/TerrainState",["../Core/freezeObject"],function(e){"use strict";return e({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6})}),o("Scene/TileBoundingBox",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/DeveloperError","../Core/Ellipsoid","../Core/Rectangle","./SceneMode"],function(e,t,n,r,i,o,a,s){"use strict";var l=function(t){t=n(t,n.EMPTY_OBJECT),this.rectangle=a.clone(t.rectangle),this.minimumHeight=n(t.minimumHeight,0),this.maximumHeight=n(t.maximumHeight,0),this.southwestCornerCartesian=new e,this.northeastCornerCartesian=new e,this.westNormal=new e,this.southNormal=new e,this.eastNormal=new e,this.northNormal=new e;var r=n(t.ellipsoid,o.WGS84);!function(t,n,r){r.cartographicToCartesian(a.southwest(n),t.southwestCornerCartesian),r.cartographicToCartesian(a.northeast(n),t.northeastCornerCartesian),p.longitude=n.west,p.latitude=.5*(n.south+n.north),p.height=0;var i=r.cartographicToCartesian(p,h),o=e.cross(i,e.UNIT_Z,u);e.normalize(o,t.westNormal),p.longitude=n.east;var s=r.cartographicToCartesian(p,d),l=e.cross(e.UNIT_Z,s,u);e.normalize(l,t.eastNormal);var f=r.geodeticSurfaceNormalCartographic(a.southeast(n),c),m=e.subtract(i,s,u),_=e.cross(f,m,c);e.normalize(_,t.southNormal);var g=r.geodeticSurfaceNormalCartographic(a.northwest(n),c),v=e.cross(m,g,c);e.normalize(v,t.northNormal)}(this,t.rectangle,r)},u=new e,c=new e,h=new e,d=new e,p=new t,f=new e,m=new e,_=new e(0,-1,0),g=new e(0,0,-1),v=new e;return l.prototype.distanceToCamera=function(t){var n=t.camera,r=n.positionWC,i=n.positionCartographic,o=0;if(!a.contains(this.rectangle,i)){var l=this.southwestCornerCartesian,u=this.northeastCornerCartesian,c=this.westNormal,h=this.southNormal,d=this.eastNormal,p=this.northNormal;t.mode!==s.SCENE3D&&((l=t.mapProjection.project(a.southwest(this.rectangle),f)).z=l.y,l.y=l.x,l.x=0,(u=t.mapProjection.project(a.northeast(this.rectangle),m)).z=u.y,u.y=u.x,u.x=0,c=_,d=e.UNIT_Y,h=g,p=e.UNIT_Z);var y=e.subtract(r,l,v),C=e.dot(y,c),w=e.dot(y,h),b=e.subtract(r,u,v),E=e.dot(b,d),S=e.dot(b,p);C>0?o+=C*C:E>0&&(o+=E*E),w>0?o+=w*w:S>0&&(o+=S*S)}var x=(t.mode===s.SCENE3D?i.height:r.x)-(t.mode===s.SCENE3D?this.maximumHeight:0);return x>0&&(o+=x*x),Math.sqrt(o)},l}),o("Scene/TileTerrain",["../Core/BoundingSphere","../Core/Cartesian3","../Core/ComponentDatatype","../Core/defined","../Core/DeveloperError","../Core/IndexDatatype","../Core/OrientedBoundingBox","../Core/TileProviderError","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/VertexArray","../ThirdParty/when","./TerrainState","./TileBoundingBox"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(e){this.state=d.UNLOADED,this.data=void 0,this.mesh=void 0,this.vertexArray=void 0,this.upsampleDetails=e}function m(e,t,n,i,o,a){var s=e.data.createMesh(n.tilingScheme,i,o,a,t.terrainExaggeration);r(s)&&(e.state=d.TRANSFORMING,h(s,function(t){e.mesh=t,e.state=d.TRANSFORMED},function(){e.state=d.FAILED}))}function _(e,t,n,i,a,s){var h=l.createVertexBuffer({context:t,typedArray:e.mesh.vertices,usage:u.STATIC_DRAW}),p=e.mesh.encoding.getAttributes(h),f=e.mesh.indices.indexBuffers||{},m=f[t.id];if(!r(m)||m.isDestroyed()){var _=e.mesh.indices;(m=l.createIndexBuffer({context:t,typedArray:_,usage:u.STATIC_DRAW,indexDatatype:2===_.BYTES_PER_ELEMENT?o.UNSIGNED_SHORT:o.UNSIGNED_INT})).vertexArrayDestroyable=!1,m.referenceCount=1,f[t.id]=m,e.mesh.indices.indexBuffers=f}else++m.referenceCount;e.vertexArray=new c({context:t,attributes:p,indexBuffer:m}),e.state=d.READY}return f.prototype.freeResources=function(){if(this.state=d.UNLOADED,this.data=void 0,this.mesh=void 0,r(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy(),this.vertexArray=void 0,!e.isDestroyed()&&r(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())}},f.prototype.publishToTile=function(n){var r=n.data,i=this.mesh;t.clone(i.center,r.center),r.minimumHeight=i.minimumHeight,r.maximumHeight=i.maximumHeight,r.boundingSphere3D=e.clone(i.boundingSphere3D,r.boundingSphere3D),r.orientedBoundingBox=a.clone(i.orientedBoundingBox,r.orientedBoundingBox),r.tileBoundingBox=new p({rectangle:n.rectangle,minimumHeight:i.minimumHeight,maximumHeight:i.maximumHeight,ellipsoid:n.tilingScheme.ellipsoid}),n.data.occludeePointInScaledSpace=t.clone(i.occludeePointInScaledSpace,r.occludeePointInScaledSpace)},f.prototype.processLoadStateMachine=function(e,t,n,i,o){this.state===d.UNLOADED&&function(e,t,n,i,o){function a(t){e.data=t,e.state=d.RECEIVED}function l(){e.state=d.FAILED,t._requestError=s.handleError(t._requestError,t,t.errorEvent,"Failed to obtain terrain tile X: "+n+" Y: "+i+" Level: "+o+".",n,i,o,u)}function u(){e.data=t.requestTileGeometry(n,i,o),r(e.data)?(e.state=d.RECEIVING,h(e.data,a,l)):e.state=d.UNLOADED}u()}(this,t,n,i,o),this.state===d.RECEIVED&&m(this,e,t,n,i,o),this.state===d.TRANSFORMED&&_(this,e.context)},f.prototype.processUpsampleStateMachine=function(e,t,n,i,o){if(this.state===d.UNLOADED){var a=this.upsampleDetails;if(this.data=a.data.upsample(t.tilingScheme,a.x,a.y,a.level,n,i,o),!r(this.data))return;this.state=d.RECEIVING;var s=this;h(this.data,function(e){s.data=e,s.state=d.RECEIVED},function(){s.state=d.FAILED})}this.state===d.RECEIVED&&m(this,e,t,n,i,o),this.state===d.TRANSFORMED&&_(this,e.context)},f}),o("Scene/GlobeSurfaceTile",["../Core/BoundingSphere","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/IntersectionTests","../Core/PixelFormat","../Core/Rectangle","../Renderer/PixelDatatype","../Renderer/Sampler","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","./ImageryState","./QuadtreeTileLoadState","./SceneMode","./TerrainState","./TileBoundingBox","./TileTerrain"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w){"use strict";function b(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new n(0,0,1,1),this.terrainData=void 0,this.center=new t,this.vertexArray=void 0,this.minimumHeight=0,this.maximumHeight=0,this.boundingSphere3D=new e,this.boundingSphere2D=new e,this.orientedBoundingBox=void 0,this.tileBoundingBox=void 0,this.occludeePointInScaledSpace=new t,this.loadedTerrain=void 0,this.upsampledTerrain=void 0,this.pickBoundingSphere=new e,this.pickTerrain=void 0,this.surfaceShader=void 0}function E(e,n,r,i,a,s){if(e.decodePosition(i,a,s),o(n)&&n!==v.SCENE3D){var l=r.ellipsoid.cartesianToCartographic(s);r.project(l,s),t.fromElements(s.z,s.x,s.y,s)}return s}a(b.prototype,{eligibleForUnloading:{get:function(){for(var e=this.loadedTerrain,t=o(e)&&(e.state===y.RECEIVING||e.state===y.TRANSFORMING),n=this.upsampledTerrain,r=o(n)&&(n.state===y.RECEIVING||n.state===y.TRANSFORMING),i=!t&&!r,a=this.imagery,s=0,l=a.length;i&&s<l;++s){var u=a[s];i=!o(u.loadingImagery)||u.loadingImagery.state!==_.TRANSITIONING}return i}}});var S=new t,x=new t,T=new t,A=new t;return b.prototype.pick=function(e,n,r,i,a){var l=this.pickTerrain;if(o(l)){var u=l.mesh;if(o(u))for(var c=u.vertices,h=u.indices,d=u.encoding,p=h.length,f=0;f<p;f+=3){var m=h[f+1],_=h[f+2],g=E(d,n,r,c,h[f],S),v=E(d,n,r,c,m,x),y=E(d,n,r,c,_,T),C=s.rayTriangle(e,g,v,y,i,A);if(o(C))return t.clone(C,a)}}},b.prototype.freeResources=function(){o(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,o(this.loadedTerrain)&&(this.loadedTerrain.freeResources(),this.loadedTerrain=void 0),o(this.upsampledTerrain)&&(this.upsampledTerrain.freeResources(),this.upsampledTerrain=void 0),o(this.pickTerrain)&&(this.pickTerrain.freeResources(),this.pickTerrain=void 0);var e,t,n=this.imagery;for(e=0,t=n.length;e<t;++e)n[e].freeResources();this.imagery.length=0,this.freeVertexArray()},b.prototype.freeVertexArray=function(){var e;o(this.vertexArray)&&(e=this.vertexArray.indexBuffer,this.vertexArray=this.vertexArray.destroy(),!e.isDestroyed()&&o(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())),o(this.wireframeVertexArray)&&(e=this.wireframeVertexArray.indexBuffer,this.wireframeVertexArray=this.wireframeVertexArray.destroy(),!e.isDestroyed()&&o(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy()))},b.processStateMachine=function(e,t,r,a,s){var u,v,C,E,S,x,T,A,P=e.data;o(P)||(P=e.data=new b),e.state===g.START&&(function(e,t,n){var r=e.data,i=function(t){for(var n=e.parent;o(n)&&o(n.data)&&!o(n.data.terrainData);)n=n.parent;if(o(n)&&o(n.data))return{data:n.data.terrainData,x:n.x,y:n.y,level:n.level}}();o(i)&&(r.upsampledTerrain=new w(i)),function(e,n){var r=t.getTileDataAvailable(e.x,e.y,e.level);if(o(r))return r;var i=e.parent;return!o(i)||!(!o(i.data)||!o(i.data.terrainData))&&i.data.terrainData.isChildAvailable(i.x,i.y,e.x,e.y)}(e)&&(r.loadedTerrain=new w);for(var a=0,s=n.length;a<s;++a){var l=n.get(a);l.show&&l._createTileImagerySkeletons(e,t)}}(e,r,a),e.state=g.LOADING),e.state===g.LOADING&&(v=t,C=r,E=s,T=(S=(u=e).data).upsampledTerrain,A=!1,o(x=S.loadedTerrain)&&(x.processLoadStateMachine(v,C,u.x,u.y,u.level),x.state>=y.RECEIVED&&(S.terrainData!==x.data&&(S.terrainData=x.data,function(e,t){var r=t.waterMaskTexture;o(r)&&(--r.referenceCount,0===r.referenceCount&&r.destroy(),t.waterMaskTexture=void 0);var i=t.terrainData.waterMask;if(o(i)){var a,s=function(e){var t=e.cache.tile_waterMaskData;if(!o(t)){var n=new d({context:e,pixelFormat:l.LUMINANCE,pixelDatatype:c.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});n.referenceCount=1;var r=new h({wrapS:m.CLAMP_TO_EDGE,wrapT:m.CLAMP_TO_EDGE,minificationFilter:f.LINEAR,magnificationFilter:p.LINEAR});e.cache.tile_waterMaskData=t={allWaterTexture:n,sampler:r,destroy:function(){this.allWaterTexture.destroy()}}}return t}(e),u=i.length;if(1===u){if(0===i[0])return;a=s.allWaterTexture}else{var _=Math.sqrt(u);(a=new d({context:e,pixelFormat:l.LUMINANCE,pixelDatatype:c.UNSIGNED_BYTE,source:{width:_,height:_,arrayBufferView:i},sampler:s.sampler})).referenceCount=0}++a.referenceCount,t.waterMaskTexture=a,n.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}}(v.context,S),function(e){var t=e.data;if(o(e.children))for(var n=0;n<4;++n){var r=e.children[n];if(r.state!==g.START){var i=r.data;if(o(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling())continue;o(i.upsampledTerrain)&&i.upsampledTerrain.freeResources(),i.upsampledTerrain=new w({data:t.terrainData,x:e.x,y:e.y,level:e.level}),t.terrainData.isChildAvailable(e.x,e.y,r.x,r.y)&&(o(i.loadedTerrain)||(i.loadedTerrain=new w)),r.state=g.LOADING}}}(u)),A=!0),x.state===y.READY?(x.publishToTile(u),o(u.data.vertexArray)&&E.push(u.data.vertexArray),u.data.vertexArray=x.vertexArray,x.vertexArray=void 0,S.pickTerrain=i(S.loadedTerrain,S.upsampledTerrain),S.loadedTerrain=void 0,S.upsampledTerrain=void 0):x.state===y.FAILED&&(S.loadedTerrain=void 0)),!A&&o(T)&&(T.processUpsampleStateMachine(v,C,u.x,u.y,u.level),T.state>=y.RECEIVED&&S.terrainData!==T.data&&(S.terrainData=T.data,C.hasWaterMask&&function(e){for(var t=e.data,n=e.parent;o(n)&&!o(n.data.terrainData)||n.data.terrainData.wasCreatedByUpsampling();)n=n.parent;if(o(n)&&o(n.data.waterMaskTexture)){t.waterMaskTexture=n.data.waterMaskTexture,++t.waterMaskTexture.referenceCount;var r=n.rectangle,i=e.rectangle,a=i.width,s=i.height,l=a/r.width,u=s/r.height;t.waterMaskTranslationAndScale.x=l*(i.west-r.west)/a,t.waterMaskTranslationAndScale.y=u*(i.south-r.south)/s,t.waterMaskTranslationAndScale.z=l,t.waterMaskTranslationAndScale.w=u}}(u),function(e){var t=e.data;if(o(e._children))for(var n=0;n<4;++n){var r=e._children[n];if(r.state!==g.START){var i=r.data;if(o(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling())continue;o(i.upsampledTerrain)&&i.upsampledTerrain.freeResources(),i.upsampledTerrain=new w({data:t.terrainData,x:e.x,y:e.y,level:e.level}),r.state=g.LOADING}}}(u)),T.state===y.READY?(T.publishToTile(u),o(u.data.vertexArray)&&E.push(u.data.vertexArray),u.data.vertexArray=T.vertexArray,T.vertexArray=void 0,S.pickTerrain=S.upsampledTerrain,S.upsampledTerrain=void 0):T.state===y.FAILED&&(S.upsampledTerrain=void 0)));for(var D=o(P.vertexArray),M=!o(P.loadedTerrain)&&!o(P.upsampledTerrain),I=o(P.terrainData)&&P.terrainData.wasCreatedByUpsampling(),O=P.imagery,R=0,N=O.length;R<N;++R){var L=O[R];if(o(L.loadingImagery)){if(L.loadingImagery.state===_.PLACEHOLDER){var F=L.loadingImagery.imageryLayer;if(F.imageryProvider.ready){L.freeResources(),O.splice(R,1),F._createTileImagerySkeletons(e,r,R),--R,N=O.length;continue}I=!1}var B=L.processStateMachine(e,t);M=M&&B,D=D&&(B||o(L.readyImagery)),I=I&&o(L.loadingImagery)&&(L.loadingImagery.state===_.FAILED||L.loadingImagery.state===_.INVALID)}else I=!1}e.upsampledFromParent=I,R===N&&(D&&(e.renderable=!0),M&&(e.state=g.DONE))},b}),o("Shaders/ReprojectWebMercatorFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),o("Shaders/ReprojectWebMercatorVS",[],function(){"use strict";return"attribute vec4 position;\nattribute float webMercatorT;\nuniform vec2 u_textureDimensions;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nv_textureCoordinates = vec2(position.x, webMercatorT);\ngl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n"}),o("Scene/Imagery",["../Core/defined","../Core/destroyObject","./ImageryState"],function(e,t,n){"use strict";function r(t,r,i,o,a){this.imageryLayer=t,this.x=r,this.y=i,this.level=o,0!==o&&(this.parent=t.getImageryFromCache(r/2|0,i/2|0,o-1)),this.state=n.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!e(a)&&t.imageryProvider.ready&&(a=t.imageryProvider.tilingScheme.tileXYToRectangle(r,i,o)),this.rectangle=a}return r.createPlaceholder=function(e){var t=new r(e,0,0,0);return t.addReference(),t.state=n.PLACEHOLDER,t},r.prototype.addReference=function(){++this.referenceCount},r.prototype.releaseReference=function(){return--this.referenceCount,0===this.referenceCount?(this.imageryLayer.removeImageryFromCache(this),e(this.parent)&&this.parent.releaseReference(),e(this.image)&&e(this.image.destroy)&&this.image.destroy(),e(this.texture)&&this.texture.destroy(),e(this.textureWebMercator)&&this.textureWebMercator.destroy(),t(this),0):this.referenceCount},r.prototype.processStateMachine=function(e,t){this.state===n.UNLOADED&&(this.state=n.TRANSITIONING,this.imageryLayer._requestImagery(this)),this.state===n.RECEIVED&&(this.state=n.TRANSITIONING,this.imageryLayer._createTexture(e.context,this)),(this.state===n.TEXTURE_LOADED||this.state===n.READY&&t&&!this.texture)&&(this.state=n.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))},r}),o("Scene/TileImagery",["../Core/defined","./ImageryState"],function(e,t){"use strict";function n(e,t,n){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=n}return n.prototype.freeResources=function(){e(this.readyImagery)&&this.readyImagery.releaseReference(),e(this.loadingImagery)&&this.loadingImagery.releaseReference()},n.prototype.processStateMachine=function(n,r){var i=this.loadingImagery,o=i.imageryLayer;if(i.processStateMachine(r,!this.useWebMercatorT),i.state===t.READY)return e(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=o._calculateTextureTranslationAndScale(n,this),!0;for(var a,s=i.parent;e(s)&&s.state!==t.READY;)s.state!==t.FAILED&&s.state!==t.INVALID&&(a=a||s),s=s.parent;return this.readyImagery!==s&&(e(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=s,e(s)&&(s.addReference(),this.textureTranslationAndScale=o._calculateTextureTranslationAndScale(n,this))),!(i.state!==t.FAILED&&i.state!==t.INVALID||e(a)&&(a.processStateMachine(r,!this.useWebMercatorT),1))},n}),o("Scene/ImageryLayer",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian4","../Core/Color","../Core/ComponentDatatype","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/FeatureDetection","../Core/GeographicTilingScheme","../Core/IndexDatatype","../Core/Math","../Core/PixelFormat","../Core/PrimitiveType","../Core/Rectangle","../Core/TerrainProvider","../Core/TileProviderError","../Core/WebMercatorProjection","../Core/WebMercatorTilingScheme","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ClearCommand","../Renderer/ComputeCommand","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/MipmapHint","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/VertexArray","../Shaders/ReprojectWebMercatorFS","../Shaders/ReprojectWebMercatorVS","../ThirdParty/when","./Imagery","./ImageryState","./TileImagery"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G){"use strict";function W(e,t){this._imageryProvider=e,t=o(t,{}),this.alpha=o(t.alpha,o(e.defaultAlpha,1)),this.brightness=o(t.brightness,o(e.defaultBrightness,W.DEFAULT_BRIGHTNESS)),this.contrast=o(t.contrast,o(e.defaultContrast,W.DEFAULT_CONTRAST)),this.hue=o(t.hue,o(e.defaultHue,W.DEFAULT_HUE)),this.saturation=o(t.saturation,o(e.defaultSaturation,W.DEFAULT_SATURATION)),this.gamma=o(t.gamma,o(e.defaultGamma,W.DEFAULT_GAMMA)),this.show=o(t.show,!0),this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=o(t.rectangle,m.MAX_VALUE),this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new G(z.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[]}function H(e,t,n,r){if(d.isPowerOfTwo(r.width)&&d.isPowerOfTwo(r.height)){var i=t.cache.imageryLayer_mipmapSampler;if(!a(i)){var s=S.maximumTextureFilterAnisotropy;i=t.cache.imageryLayer_mipmapSampler=new D({wrapS:L.CLAMP_TO_EDGE,wrapT:L.CLAMP_TO_EDGE,minificationFilter:N.LINEAR_MIPMAP_LINEAR,magnificationFilter:R.LINEAR,maximumAnisotropy:Math.min(s,o(e._maximumAnisotropy,s))})}r.generateMipmap(A.NICEST),r.sampler=i}else{var l=t.cache.imageryLayer_nonMipmapSampler;a(l)||(l=t.cache.imageryLayer_nonMipmapSampler=new D({wrapS:L.CLAMP_TO_EDGE,wrapT:L.CLAMP_TO_EDGE,minificationFilter:N.LINEAR,magnificationFilter:R.LINEAR})),r.sampler=l}n.state=U.READY}function j(e,t,n){return JSON.stringify([e,t,n])}s(W.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}}),W.DEFAULT_BRIGHTNESS=1,W.DEFAULT_CONTRAST=1,W.DEFAULT_HUE=0,W.DEFAULT_SATURATION=1,W.DEFAULT_GAMMA=1,W.prototype.isBaseLayer=function(){return this._isBaseLayer},W.prototype.isDestroyed=function(){return!1},W.prototype.destroy=function(){return l(this)};var q=new m,Y=new m,X=new m,Z=new m;W.prototype.getViewableRectangle=function(){var e=this._imageryProvider,t=this._rectangle;return e.readyPromise.then(function(){return m.intersection(e.rectangle,t)})},W.prototype._createTileImagerySkeletons=function(e,t,r){var i=e.data;if(a(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel)return!1;if(a(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;var o=this._imageryProvider;if(a(r)||(r=i.imagery.length),!o.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),i.imagery.splice(r,0,this._skeletonPlaceholder),!0;var s=o.tilingScheme instanceof y&&e.rectangle.north<v.MaximumLatitude&&e.rectangle.south>-v.MaximumLatitude,l=m.intersection(o.rectangle,this._rectangle,q),u=m.intersection(e.rectangle,l,Y);if(!a(u)){if(!this.isBaseLayer())return!1;var h=l,d=e.rectangle;u=Y,d.south>=h.north?u.north=u.south=h.north:d.north<=h.south?u.north=u.south=h.south:(u.south=Math.max(d.south,h.south),u.north=Math.min(d.north,h.north)),d.west>=h.east?u.west=u.east=h.east:d.east<=h.west?u.west=u.east=h.west:(u.west=Math.max(d.west,h.west),u.east=Math.min(d.east,h.east))}var p=0;u.south>0?p=u.south:u.north<0&&(p=u.north);var f,_,g,C,w,b,E,S=(f=1*t.getLevelMaximumGeometricError(e.level),C=(g=(_=this._imageryProvider).tilingScheme).ellipsoid,w=this._imageryProvider.tilingScheme instanceof c?1:Math.cos(p),b=C.maximumRadius*g.rectangle.width*w/(_.tileWidth*g.getNumberOfXTilesAtLevel(0)),E=Math.log(b/f)/Math.log(2),0|Math.round(E));S=Math.max(0,S);var x=o.maximumLevel;if(S>x&&(S=x),a(o.minimumLevel)){var T=o.minimumLevel;S<T&&(S=T)}var A=o.tilingScheme,P=A.positionToTileXY(m.northwest(u),S),D=A.positionToTileXY(m.southeast(u),S),M=e.rectangle.width/512,I=e.rectangle.height/512,O=A.tileXYToRectangle(P.x,P.y,S);Math.abs(O.south-e.rectangle.north)<I&&P.y<D.y&&++P.y,Math.abs(O.east-e.rectangle.west)<M&&P.x<D.x&&++P.x;var R=A.tileXYToRectangle(D.x,D.y,S);Math.abs(R.north-e.rectangle.south)<I&&D.y>P.y&&--D.y,Math.abs(R.west-e.rectangle.east)<M&&D.x>P.x&&--D.x;var N,L=m.clone(e.rectangle,Z),F=A.tileXYToRectangle(P.x,P.y,S),B=m.intersection(F,l,X);s?(A.rectangleToNativeRectangle(L,L),A.rectangleToNativeRectangle(F,F),A.rectangleToNativeRectangle(B,B),A.rectangleToNativeRectangle(l,l),N=A.tileXYToNativeRectangle.bind(A),M=L.width/512,I=L.height/512):N=A.tileXYToRectangle.bind(A);var k,V,z=0,U=1;!this.isBaseLayer()&&Math.abs(B.west-L.west)>=M&&(z=Math.min(1,(B.west-L.west)/L.width)),!this.isBaseLayer()&&Math.abs(B.north-L.north)>=I&&(U=Math.max(0,(B.north-L.south)/L.height));for(var W=U,H=P.x;H<=D.x;H++)if(k=z,F=N(H,P.y,S),B=m.simpleIntersection(F,l,X),a(B)){z=Math.min(1,(B.east-L.west)/L.width),H===D.x&&(this.isBaseLayer()||Math.abs(B.east-L.east)<M)&&(z=1),U=W;for(var j=P.y;j<=D.y;j++)if(V=U,F=N(H,j,S),B=m.simpleIntersection(F,l,X),a(B)){U=Math.max(0,(B.south-L.south)/L.height),j===D.y&&(this.isBaseLayer()||Math.abs(B.south-L.south)<I)&&(U=0);var K=new n(k,U,z,V),Q=this.getImageryFromCache(H,j,S);i.imagery.splice(r,0,new G(Q,K,s)),++r}}return!0},W.prototype._calculateTextureTranslationAndScale=function(e,t){var r=t.readyImagery.rectangle,i=e.rectangle;if(t.useWebMercatorT){var o=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;r=o.rectangleToNativeRectangle(r,q),i=o.rectangleToNativeRectangle(i,Z)}var a=i.width,s=i.height,l=a/r.width,u=s/r.height;return new n(l*(i.west-r.west)/a,u*(i.south-r.south)/s,l,u)},W.prototype._requestImagery=function(e){function t(t){return a(t)?(e.image=t,e.state=U.RECEIVED,void g.handleSuccess(o._requestImageError)):n()}function n(t){e.state=U.FAILED,o._requestImageError=g.handleError(o._requestImageError,i,i.errorEvent,"Failed to obtain image tile X: "+e.x+" Y: "+e.y+" Level: "+e.level+".",e.x,e.y,e.level,r,t)}function r(){e.state=U.TRANSITIONING;var r=i.requestImage(e.x,e.y,e.level);return a(r)?(a(i.getTileCredits)&&(e.credits=i.getTileCredits(e.x,e.y,e.level)),void V(r,t,n)):void(e.state=U.UNLOADED)}var i=this._imageryProvider,o=this;r()},W.prototype._createTexture=function(e,t){var n=this._imageryProvider;if(a(n.tileDiscardPolicy)){var r=n.tileDiscardPolicy;if(a(r)){if(!r.isReady())return void(t.state=U.RECEIVED);if(r.shouldDiscardImage(t.image))return void(t.state=U.INVALID)}}var i=new O({context:e,source:t.image,pixelFormat:n.hasAlphaChannel?p.RGBA:p.RGB});n.tilingScheme instanceof y?t.textureWebMercator=i:t.texture=i,t.image=void 0,t.state=U.TEXTURE_LOADED},W.prototype._reprojectTexture=function(e,t,n){var r=t.textureWebMercator||t.texture,i=t.rectangle,s=e.context;if((n=o(n,!0))&&!(this._imageryProvider.tilingScheme instanceof c)&&i.width/r.width>1e-5){var l=this;t.addReference();var u=new E({persists:!0,owner:this,preExecute:function(e){!function(e,t,n,r){var i=t.cache.imageryLayer_reproject;if(!a(i)){i=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){a(this.framebuffer)&&this.framebuffer.destroy(),a(this.vertexArray)&&this.vertexArray.destroy(),a(this.shaderProgram)&&this.shaderProgram.destroy()}};for(var o=new Float32Array(256),s=0,l=0;l<64;++l){var u=l/63;o[s++]=0,o[s++]=u,o[s++]=1,o[s++]=u}var c={position:0,webMercatorT:1},p=_.getRegularGridIndices(2,64),f=C.createIndexBuffer({context:t,typedArray:p,usage:w.STATIC_DRAW,indexDatatype:h.UNSIGNED_SHORT});i.vertexArray=new F({context:t,attributes:[{index:c.position,vertexBuffer:C.createVertexBuffer({context:t,typedArray:o,usage:w.STATIC_DRAW}),componentsPerAttribute:2},{index:c.webMercatorT,vertexBuffer:C.createVertexBuffer({context:t,sizeInBytes:512,usage:w.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:f});var m=new I({sources:[k]});i.shaderProgram=M.fromCache({context:t,vertexShaderSource:m,fragmentShaderSource:B,attributeLocations:c}),i.sampler=new D({wrapS:L.CLAMP_TO_EDGE,wrapT:L.CLAMP_TO_EDGE,minificationFilter:N.LINEAR,magnificationFilter:R.LINEAR})}n.sampler=i.sampler;var g=n.width,v=n.height;K.textureDimensions.x=g,K.textureDimensions.y=v,K.texture=n;var y=Math.sin(r.south),b=.5*Math.log((1+y)/(1-y));y=Math.sin(r.north);var E=1/(.5*Math.log((1+y)/(1-y))-b),S=new O({context:t,width:g,height:v,pixelFormat:n.pixelFormat,pixelDatatype:n.pixelDatatype,preMultiplyAlpha:n.preMultiplyAlpha});d.isPowerOfTwo(g)&&d.isPowerOfTwo(v)&&S.generateMipmap(A.NICEST);for(var x=r.south,T=r.north,P=Q,V=0,z=0;z<64;++z){var U=d.lerp(x,T,z/63);y=Math.sin(U);var G=(.5*Math.log((1+y)/(1-y))-b)*E;P[V++]=G,P[V++]=G}i.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(P),e.shaderProgram=i.shaderProgram,e.outputTexture=S,e.uniformMap=K,e.vertexArray=i.vertexArray}(e,s,r,t.rectangle)},postExecute:function(e){t.texture=e,H(l,s,t,e),t.releaseReference()}});this._reprojectComputeCommands.push(u)}else H(this,s,t,r)},W.prototype.queueReprojectionCommands=function(e){for(var t=this._reprojectComputeCommands,n=t.length,r=0;r<n;++r)e.commandList.push(t[r]);t.length=0},W.prototype.cancelReprojections=function(){this._reprojectComputeCommands.length=0},W.prototype.getImageryFromCache=function(e,t,n,r){var i=j(e,t,n),o=this._imageryCache[i];return a(o)||(o=new z(this,e,t,n,r),this._imageryCache[i]=o),o.addReference(),o},W.prototype.removeImageryFromCache=function(e){var t=j(e.x,e.y,e.level);delete this._imageryCache[t]};var K={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new t,texture:void 0},Q=u.supportsTypedArrays()?new Float32Array(128):void 0;return W}),o("Scene/GlobeSurfaceTileProvider",["../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/FeatureDetection","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/IndexDatatype","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/OrientedBoundingBox","../Core/PrimitiveType","../Core/Rectangle","../Core/SphereOutlineGeometry","../Core/TerrainQuantization","../Core/Visibility","../Core/WebMercatorProjection","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/VertexArray","../Scene/BlendingState","../Scene/DepthFunction","../Scene/Pass","../Scene/PerInstanceColorAppearance","../Scene/Primitive","../ThirdParty/when","./GlobeSurfaceTile","./ImageryLayer","./ImageryState","./QuadtreeTileLoadState","./SceneMode","./ShadowMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H){"use strict";function j(e){this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.shadows=H.RECEIVE_ONLY,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._pickRenderState=void 0,this._errorEvent=new d,this._imageryLayers.layerAdded.addEventListener(j.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(j.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(j.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(j.prototype._onLayerShownOrHidden,this),this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._pickCommands=[],this._usedDrawCommands=0,this._usedPickCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new o(0,0,.5,1)}function q(e,t){var n=e.loadingImagery;l(n)||(n=e.readyImagery);var r=t.loadingImagery;return l(r)||(r=t.readyImagery),n.imageryLayer._layerIndex-r.imageryLayer._layerIndex}function Y(e){return{u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,n=y.multiplyByPoint(t,this.properties.rtc,re);return y.setTranslation(t,n,$),$},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,n=e.context.uniformState.projection,r=y.multiplyByPoint(t,this.properties.rtc,re);return y.setTranslation(t,r,ee),y.multiply(n,ee,ee),ee},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},properties:{initialColor:new i(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new n(65e5,9e6),center3D:void 0,rtc:new r,modifiedModelView:new y,tileRectangle:new i,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayIntensity:0,southAndNorthLatitude:new n,southMercatorYAndOneOverHeight:new n,waterMask:void 0,waterMaskTranslationAndScale:new i,minMaxHeight:new n,scaleAndBias:new y}}}function X(t,n,a){var s=n.data,u=D.maximumTextureImageUnits,c=s.waterMaskTexture,h=t.hasWaterMask&&l(c),d=t.oceanNormalMap,p=h&&l(d),f=t.terrainProvider.ready&&t.terrainProvider.hasVertexNormals,g=a.fog.enabled,E=H.castShadows(t.shadows),x=H.receiveShadows(t.shadows);h&&--u,p&&--u;var I=s.center,R=s.pickTerrain.mesh.encoding,N=te,F=0,B=0,k=0,V=0,U=!1;if(a.mode!==W.SCENE3D){var G=a.mapProjection,j=G.project(b.southwest(n.rectangle),ie),q=G.project(b.northeast(n.rectangle),oe);if(N.x=j.x,N.y=j.y,N.z=q.x,N.w=q.y,a.mode!==W.MORPHING&&((I=ne).x=0,I.y=.5*(N.z+N.x),I.z=.5*(N.w+N.y),N.x-=I.y,N.y-=I.z,N.z-=I.y,N.w-=I.z),a.mode===W.SCENE2D&&R.quantization===S.BITS12){var X=1/(Math.pow(2,12)-1)*.5,Z=(N.z-N.x)*X,$=(N.w-N.y)*X;N.x-=Z,N.y-=$,N.z+=Z,N.w+=$}G instanceof T&&(B=n.rectangle.north,k=T.geodeticLatitudeToMercatorAngle(F=n.rectangle.south),V=1/(T.geodeticLatitudeToMercatorAngle(B)-k),U=!0)}var ee,re,se=s.imagery,le=0,ue=se.length,ce=t._blendRenderState,he=t._renderState,de=t._firstPassInitialColor,pe=a.context;l(t._debug.boundingSphereTile)||J();do{var fe,me,_e=0;t._drawCommands.length<=t._usedDrawCommands?((fe=new M).owner=n,fe.cull=!1,fe.boundingVolume=new e,fe.orientedBoundingBox=void 0,me=Y(a),t._drawCommands.push(fe),t._uniformMaps.push(me)):(fe=t._drawCommands[t._usedDrawCommands],me=t._uniformMaps[t._usedDrawCommands]),fe.owner=n,++t._usedDrawCommands,n===t._debug.boundingSphereTile&&(l(s.orientedBoundingBox)?K(s.orientedBoundingBox,o.RED).update(a):l(s.boundingSphere3D)&&Q(s.boundingSphere3D,o.RED).update(a));var ge=me.properties;i.clone(de,ge.initialColor),ge.oceanNormalMap=d,ge.lightingFadeDistance.x=t.lightingFadeOutDistance,ge.lightingFadeDistance.y=t.lightingFadeInDistance,ge.zoomedOutOceanSpecularIntensity=t.zoomedOutOceanSpecularIntensity,ge.center3D=s.center,r.clone(I,ge.rtc),i.clone(N,ge.tileRectangle),ge.southAndNorthLatitude.x=F,ge.southAndNorthLatitude.y=B,ge.southMercatorYAndOneOverHeight.x=k,ge.southMercatorYAndOneOverHeight.y=V;for(var ve=g&&v.fog(n._distance,a.fog.density)>v.EPSILON3,ye=!1,Ce=!1,we=!1,be=!1,Ee=!1,Se=!1;_e<u&&le<ue;){var xe=se[le],Te=xe.readyImagery;if(++le,l(Te)&&0!==Te.imageryLayer.alpha){var Ae=xe.useWebMercatorT?Te.textureWebMercator:Te.texture,Pe=Te.imageryLayer;if(l(xe.textureTranslationAndScale)||(xe.textureTranslationAndScale=Pe._calculateTextureTranslationAndScale(n,xe)),ge.dayTextures[_e]=Ae,ge.dayTextureTranslationAndScale[_e]=xe.textureTranslationAndScale,ge.dayTextureTexCoordsRectangle[_e]=xe.textureCoordinateRectangle,ge.dayTextureUseWebMercatorT[_e]=xe.useWebMercatorT,ge.dayTextureAlpha[_e]=Pe.alpha,Se=Se||1!==ge.dayTextureAlpha[_e],ge.dayTextureBrightness[_e]=Pe.brightness,ye=ye||ge.dayTextureBrightness[_e]!==z.DEFAULT_BRIGHTNESS,ge.dayTextureContrast[_e]=Pe.contrast,Ce=Ce||ge.dayTextureContrast[_e]!==z.DEFAULT_CONTRAST,ge.dayTextureHue[_e]=Pe.hue,we=we||ge.dayTextureHue[_e]!==z.DEFAULT_HUE,ge.dayTextureSaturation[_e]=Pe.saturation,be=be||ge.dayTextureSaturation[_e]!==z.DEFAULT_SATURATION,ge.dayTextureOneOverGamma[_e]=1/Pe.gamma,Ee=Ee||ge.dayTextureOneOverGamma[_e]!==1/z.DEFAULT_GAMMA,l(Te.credits))for(var De=a.creditDisplay,Me=Te.credits,Ie=0,Oe=Me.length;Ie<Oe;++Ie)De.addCredit(Me[Ie]);++_e}}ge.dayTextures.length=_e,ge.waterMask=c,i.clone(s.waterMaskTranslationAndScale,ge.waterMaskTranslationAndScale),ge.minMaxHeight.x=R.minimumHeight,ge.minMaxHeight.y=R.maximumHeight,y.clone(R.matrix,ge.scaleAndBias),fe.shaderProgram=t._surfaceShaderSet.getShaderProgram(a,s,_e,ye,Ce,we,be,Ee,Se,h,p,t.enableLighting,f,U,ve),fe.castShadows=E,fe.receiveShadows=x,fe.renderState=he,fe.primitiveType=w.TRIANGLES,fe.vertexArray=s.vertexArray,fe.uniformMap=me,fe.pass=L.GLOBE,t._debug.wireframe&&(ee=pe,re=void 0,l((re=n.data).wireframeVertexArray)||l(re.terrainData)&&l(re.terrainData._mesh)&&(re.wireframeVertexArray=function(e,t,n){var r={indices:re.terrainData._mesh.indices,primitiveType:w.TRIANGLES};m.toWireframe(r);var i=A.createIndexBuffer({context:e,typedArray:r.indices,usage:P.STATIC_DRAW,indexDatatype:_.UNSIGNED_SHORT});return new O({context:e,attributes:t._attributes,indexBuffer:i})}(ee,re.vertexArray)),l(s.wireframeVertexArray)&&(fe.vertexArray=s.wireframeVertexArray,fe.primitiveType=w.LINES));var Re=fe.boundingVolume,Ne=fe.orientedBoundingBox;a.mode!==W.SCENE3D?(e.fromRectangleWithHeights2D(n.rectangle,a.mapProjection,s.minimumHeight,s.maximumHeight,Re),r.fromElements(Re.center.z,Re.center.x,Re.center.y,Re.center),a.mode===W.MORPHING&&(Re=e.union(s.boundingSphere3D,Re,Re))):(fe.boundingVolume=e.clone(s.boundingSphere3D,Re),fe.orientedBoundingBox=C.clone(s.orientedBoundingBox,Ne)),a.commandList.push(fe),he=ce,de=ae}while(le<ue)}u(j.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){this._baseColor=e,this._firstPassInitialColor=i.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){this._terrainProvider!==e&&(this._terrainProvider=e,l(this._quadtree)&&this._quadtree.invalidateAllTiles())}}}),j.prototype.initialize=function(e){var t=this._imageryLayers;t._update(),t.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile(function(e){e.data.imagery.sort(q)}));var n,r,i=e.creditDisplay;this._terrainProvider.ready&&l(this._terrainProvider.credit)&&i.addCredit(this._terrainProvider.credit);for(var o=0,a=t.length;o<a;++o){var s=t.get(o).imageryProvider;s.ready&&l(s.credit)&&i.addCredit(s.credit)}for(var u=this._vertexArraysToDestroy,c=u.length,h=0;h<c;++h)n=u[h],r=void 0,r=n.indexBuffer,n.destroy(),!r.isDestroyed()&&l(r.referenceCount)&&(--r.referenceCount,0===r.referenceCount&&r.destroy());u.length=0},j.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,n=0,r=t.length;n<r;++n){var i=t[n];l(i)&&(i.length=0)}this._usedDrawCommands=0},j.prototype.endUpdate=function(e){l(this._renderState)||(this._renderState=I.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:N.LESS}}),this._blendRenderState=I.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:N.LESS_OR_EQUAL},blending:R.ALPHA_BLEND}));for(var t=this._tilesToRenderByTextureCount,n=0,r=t.length;n<r;++n){var i=t[n];if(l(i))for(var o=0,a=i.length;o<a;++o)X(this,i[o],e)}},j.prototype.updateForPick=function(e){l(this._pickRenderState)||(this._pickRenderState=I.fromCache({colorMask:{red:!1,green:!1,blue:!1,alpha:!1},depthTest:{enabled:!0}})),this._usedPickCommands=0;for(var t=this._drawCommands,n=0,r=this._usedDrawCommands;n<r;++n)i=t[n],o=e,a=void 0,this._pickCommands.length<=this._usedPickCommands?((a=new M).cull=!1,this._pickCommands.push(a)):a=this._pickCommands[this._usedPickCommands],++this._usedPickCommands,a.shaderProgram=this._surfaceShaderSet.getPickShaderProgram(o,i.owner.data,o.projection instanceof T),a.renderState=this._pickRenderState,a.owner=i.owner,a.primitiveType=i.primitiveType,a.vertexArray=i.vertexArray,a.uniformMap=i.uniformMap,a.boundingVolume=i.boundingVolume,a.orientedBoundingBox=i.orientedBoundingBox,a.pass=i.pass,o.commandList.push(a);var i,o,a},j.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},j.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},j.prototype.loadTile=function(e,t){V.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy)};var Z=new e;j.prototype.computeTileVisibility=function(t,n,i){var o=this.computeDistanceToTile(t,n);if(t._distance=o,n.fog.enabled&&v.fog(o,n.fog.density)>=1)return x.NONE;var a=t.data,u=n.cullingVolume,c=s(a.orientedBoundingBox,a.boundingSphere3D);n.mode!==W.SCENE3D&&(e.fromRectangleWithHeights2D(t.rectangle,n.mapProjection,a.minimumHeight,a.maximumHeight,c=Z),r.fromElements(c.center.z,c.center.x,c.center.y,c.center),n.mode===W.MORPHING&&(c=e.union(a.boundingSphere3D,c,c)));var h=u.computeVisibility(c);if(h===g.OUTSIDE)return x.NONE;if(n.mode===W.SCENE3D){var d=a.occludeePointInScaledSpace;return l(d)?i.ellipsoid.isScaledSpacePointVisible(d)?h:x.NONE:h}return h};var K,Q,J,$=new y,ee=new y,te=new i,ne=new r,re=new r,ie=new r,oe=new r;j.prototype.showTileThisFrame=function(e,t){for(var n=0,r=e.data.imagery,i=0,o=r.length;i<o;++i){var a=r[i];l(a.readyImagery)&&0!==a.readyImagery.imageryLayer.alpha&&++n}var s=this._tilesToRenderByTextureCount[n];l(s)||(this._tilesToRenderByTextureCount[n]=s=[]),s.push(e);var u=this._debug;++u.tilesRendered,u.texturesRendered+=n},j.prototype.computeDistanceToTile=function(e,t){return e.data.tileBoundingBox.distanceToCamera(t)},j.prototype.isDestroyed=function(){return!1},j.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),c(this)},j.prototype._onLayerAdded=function(e,t){if(e.show){var n=this._terrainProvider;this._quadtree.forEachLoadedTile(function(t){e._createTileImagerySkeletons(t,n)&&(t.state=G.LOADING)}),this._layerOrderChanged=!0}},j.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile(function(t){for(var n=t.data.imagery,r=-1,i=0,o=0,a=n.length;o<a;++o){var s=n[o],u=s.loadingImagery;if(l(u)||(u=s.readyImagery),u.imageryLayer===e)-1===r&&(r=o),s.freeResources(),++i;else if(-1!==r)break}-1!==r&&n.splice(r,i)})},j.prototype._onLayerMoved=function(e,t,n){this._layerOrderChanged=!0},j.prototype._onLayerShownOrHidden=function(e,t,n){n?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)},function(){function e(e){return new B({geometryInstances:e,appearance:new F({translucent:!1,flat:!0}),asynchronous:!1})}var n,i,o=new f({geometry:t.fromDimensions({dimensions:new r(2,2,2)})}),s=new f({geometry:new E({radius:1})}),u=new y;K=function(t,r){return t===n?i:(J(),n=t,u=y.fromRotationTranslation(t.halfAxes,t.center,u),o.modelMatrix=u,o.attributes.color=a.fromColor(r),i=e(o))},Q=function(t,r){return t===n?i:(J(),n=t,u=y.fromTranslation(t.center,u),u=y.multiplyByUniformScale(u,t.radius,u),s.modelMatrix=u,s.attributes.color=a.fromColor(r),i=e(s))},J=function(){l(i)&&(i.destroy(),i=void 0,n=void 0)}}();var ae=new i(0,0,0,0);return j}),o("Scene/ImageryLayerCollection",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Event","../Core/Math","../Core/Rectangle","../ThirdParty/when","./ImageryLayer"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(){this._layers=[],this.layerAdded=new o,this.layerRemoved=new o,this.layerMoved=new o,this.layerShownOrHidden=new o}function h(e,t){return e.indexOf(t)}function d(e,t,n){var r=e._layers;if((t=a.clamp(t,0,r.length-1))!==(n=a.clamp(n,0,r.length-1))){var i=r[t];r[t]=r[n],r[n]=i,e._update(),e.layerMoved.raiseEvent(i,n,t)}}n(c.prototype,{length:{get:function(){return this._layers.length}}}),c.prototype.add=function(e,n){t(n)?this._layers.splice(n,0,e):(n=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,n)},c.prototype.addImageryProvider=function(e,t){var n=new u(e);return this.add(n,t),n},c.prototype.remove=function(t,n){n=e(n,!0);var r=this._layers.indexOf(t);return-1!==r&&(this._layers.splice(r,1),this._update(),this.layerRemoved.raiseEvent(t,r),n&&t.destroy(),!0)},c.prototype.removeAll=function(t){t=e(t,!0);for(var n=this._layers,r=0,i=n.length;r<i;r++){var o=n[r];this.layerRemoved.raiseEvent(o,r),t&&o.destroy()}this._layers=[]},c.prototype.contains=function(e){return-1!==this.indexOf(e)},c.prototype.indexOf=function(e){return this._layers.indexOf(e)},c.prototype.get=function(e){return this._layers[e]},c.prototype.raise=function(e){var t=h(this._layers,e);d(this,t,t+1)},c.prototype.lower=function(e){var t=h(this._layers,e);d(this,t,t-1)},c.prototype.raiseToTop=function(e){var t=h(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},c.prototype.lowerToBottom=function(e){var t=h(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var p=new s;return c.prototype.pickImageryLayerFeatures=function(e,n){var r=n.globe.pick(e,n);if(t(r)){for(var i,o=n.globe.ellipsoid.cartesianToCartographic(r),u=n.globe._surface._tilesToRender,c=0;!t(i)&&c<u.length;++c){var h=u[c];s.contains(h.rectangle,o)&&(i=h)}if(t(i)){for(var d=i.data.imagery,f=[],m=[],_=d.length-1;_>=0;--_){var g=d[_],v=g.readyImagery;if(t(v)){var y=v.imageryLayer.imageryProvider;if(t(y.pickFeatures)&&s.contains(v.rectangle,o)){var C=p;if(C.west=a.lerp(i.rectangle.west,i.rectangle.east,g.textureCoordinateRectangle.x-1/1024),C.east=a.lerp(i.rectangle.west,i.rectangle.east,g.textureCoordinateRectangle.z+1/1024),C.south=a.lerp(i.rectangle.south,i.rectangle.north,g.textureCoordinateRectangle.y-1/1024),C.north=a.lerp(i.rectangle.south,i.rectangle.north,g.textureCoordinateRectangle.w+1/1024),s.contains(C,o)){var w=y.pickFeatures(v.x,v.y,v.level,o.longitude,o.latitude);t(w)&&(f.push(w),m.push(v.imageryLayer))}}}}if(0!==f.length)return l.all(f,function(e){for(var n=[],r=0;r<e.length;++r){var i=e[r],a=m[r];if(t(i)&&i.length>0)for(var s=0;s<i.length;++s){var l=i[s];l.imageryLayer=a,t(l.position)||(l.position=o),n.push(l)}}return n})}}},c.prototype.queueReprojectionCommands=function(e){for(var t=this._layers,n=0,r=t.length;n<r;++n)t[n].queueReprojectionCommands(e)},c.prototype.cancelReprojections=function(){for(var e=this._layers,t=0,n=e.length;t<n;++t)e[t].cancelReprojections()},c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return this.removeAll(!0),r(this)},c.prototype._update=function(){for(var e,n,r=!0,i=this._layers,o=0,a=i.length;o<a;++o)n=i[o],n._layerIndex=o,n.show?(n._isBaseLayer=r,r=!1):n._isBaseLayer=!1,n.show!==n._show&&(t(n._show)&&(t(e)||(e=[]),e.push(n)),n._show=n.show);if(t(e))for(o=0,a=e.length;o<a;++o)n=e[o],this.layerShownOrHidden.raiseEvent(n,n._layerIndex,n.show)},c}),o("Scene/QuadtreeOccluders",["../Core/Cartesian3","../Core/defineProperties","../Core/EllipsoidalOccluder"],function(e,t,n){"use strict";function r(t){this._ellipsoid=new n(t.ellipsoid,e.ZERO)}return t(r.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),r}),o("Scene/QuadtreeTile",["../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Rectangle","./QuadtreeTileLoadState"],function(e,t,n,r,i){"use strict";function o(e){this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._children=void 0,this._replacementPrevious=void 0,this._replacementNext=void 0,this._distance=0,this._customData=[],this._frameUpdated=void 0,this._frameRendered=void 0,this.state=i.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}return o.createLevelZeroTiles=function(e){for(var t=e.getNumberOfXTilesAtLevel(0),n=e.getNumberOfYTilesAtLevel(0),r=new Array(t*n),i=0,a=0;a<n;++a)for(var s=0;s<t;++s)r[i++]=new o({tilingScheme:e,x:s,y:a,level:0});return r},o.prototype._updateCustomData=function(t,n,i){var o,a,s,l=this.customData;if(e(n)&&e(i)){for(l=l.filter(function(e){return-1===i.indexOf(e)}),this._customData=l,s=this._rectangle,o=0;o<n.length;++o)a=n[o],r.contains(s,a.positionCartographic)&&l.push(a);this._frameUpdated=t}else{var u=this._parent;if(e(u)&&this._frameUpdated!==u._frameUpdated){l.length=0,s=this._rectangle;var c=u.customData;for(o=0;o<c.length;++o)a=c[o],r.contains(s,a.positionCartographic)&&l.push(a);this._frameUpdated=u._frameUpdated}}},t(o.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){if(!e(this._children)){var t=this.tilingScheme,n=this.level+1,r=2*this.x,i=2*this.y;this._children=[new o({tilingScheme:t,x:r,y:i,level:n,parent:this}),new o({tilingScheme:t,x:r+1,y:i,level:n,parent:this}),new o({tilingScheme:t,x:r,y:i+1,level:n,parent:this}),new o({tilingScheme:t,x:r+1,y:i+1,level:n,parent:this})]}return this._children}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<i.DONE}},eligibleForUnloading:{get:function(){var t=!0;return e(this.data)&&(e(t=this.data.eligibleForUnloading)||(t=!0)),t}}}),o.prototype.freeResources=function(){if(this.state=i.START,this.renderable=!1,this.upsampledFromParent=!1,e(this.data)&&e(this.data.freeResources)&&this.data.freeResources(),e(this._children)){for(var t=0,n=this._children.length;t<n;++t)this._children[t].freeResources();this._children=void 0}},o}),o("Scene/TileReplacementQueue",["../Core/defined"],function(e){"use strict";function t(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function n(e,t){var n=t.replacementPrevious,r=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=r),t===e.head?e.head=r:n.replacementNext=r,t===e.tail?e.tail=n:r.replacementPrevious=n,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}return t.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},t.prototype.trimTiles=function(t){for(var r=this.tail,i=!0;i&&e(this._lastBeforeStartOfFrame)&&this.count>t&&e(r);){i=r!==this._lastBeforeStartOfFrame;var o=r.replacementPrevious;r.eligibleForUnloading&&(r.freeResources(),n(this,r)),r=o}},t.prototype.markTileRendered=function(t){var r=this.head;return r===t?void(t===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=t.replacementNext)):(++this.count,e(r)?((e(t.replacementPrevious)||e(t.replacementNext))&&n(this,t),t.replacementPrevious=void 0,t.replacementNext=r,r.replacementPrevious=t,void(this.head=t)):(t.replacementPrevious=void 0,t.replacementNext=void 0,this.head=t,void(this.tail=t)))},t}),o("Scene/QuadtreePrimitive",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/getTimestamp","../Core/Math","../Core/Queue","../Core/Ray","../Core/Rectangle","../Core/Visibility","./QuadtreeOccluders","./QuadtreeTile","./QuadtreeTileLoadState","./SceneMode","./TileReplacementQueue"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e){this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};var t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileTraversalQueue=new u,this._tileLoadQueue=[],this._tileReplacementQueue=new g,this._levelZeroTiles=void 0,this._levelZeroTilesReady=!1,this._loadQueueTimeSlice=5,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this.maximumScreenSpaceError=n(e.maximumScreenSpaceError,2),this.tileCacheSize=n(e.tileCacheSize,100),this._occluders=new p({ellipsoid:t}),this._tileLoadProgressEvent=new a,this._lastTileLoadQueueLength=0}function y(e,t,n){if(t.mode===_.SCENE2D)return r=e,i=t,o=n,a=i.camera.frustum,s=i.context,u=s.drawingBufferWidth,c=s.drawingBufferHeight,h=r._tileProvider.getLevelMaximumGeometricError(o.level),d=Math.max(a.top-a.bottom,a.right-a.left)/Math.max(u,c),h/d;var r,i,o,a,s,u,c,h,d,p=e._tileProvider.getLevelMaximumGeometricError(n.level),f=n._distance,m=p*t.context.drawingBufferHeight/(f*t.camera.frustum.sseDenominator);return t.fog.enabled&&(m-=l.fog(f,t.fog.density)*t.fog.sse),m}function C(e,t){e._tilesToRender.push(t),++e._debug.tilesRendered}function w(e,t){for(var n=!0,r=!0,i=t.children,o=0,a=i.length;o<a;++o){var s=i[o];e._tileReplacementQueue.markTileRendered(s),r=r&&s.upsampledFromParent,n=n&&s.renderable,s.needsLoading&&b(e,s)}return n||++e._debug.tilesWaitingForChildren,n&&!r}function b(e,t){e._tileLoadQueue.push(t)}function E(e,t){return e._distance-t._distance}i(v.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}}),v.prototype.invalidateAllTiles=function(){var e=this._tileReplacementQueue;e.head=void 0,e.tail=void 0,e.count=0;var t=this._levelZeroTiles;if(r(t))for(var n=0;n<t.length;++n){for(var i=t[n].customData,o=i.length,a=0;a<o;++a){var s=i[a];s.level=0,this._addHeightCallbacks.push(s)}t[n].freeResources()}this._levelZeroTiles=void 0,this._tileProvider.cancelReprojections()},v.prototype.forEachLoadedTile=function(e){for(var t=this._tileReplacementQueue.head;r(t);)t.state!==m.START&&e(t),t=t.replacementNext},v.prototype.forEachRenderedTile=function(e){for(var t=this._tilesToRender,n=0,r=t.length;n<r;++n)e(t[n])},v.prototype.updateHeight=function(e,t){var n=this,r={position:void 0,positionCartographic:e,level:-1,callback:t};return r.removeFunc=function(){for(var e=n._addHeightCallbacks,t=e.length,i=0;i<t;++i)if(e[i]===r){e.splice(i,1);break}n._removeHeightCallbacks.push(r)},n._addHeightCallbacks.push(r),r.removeFunc},v.prototype.beginFrame=function(e){if(e.passes.render){this._tileProvider.initialize(e);var t=this._debug;t.suspendLodUpdate||(t.maxDepth=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,this._tileLoadQueue.length=0,this._tileReplacementQueue.markStartOfRenderFrame())}},v.prototype.update=function(e){var t=e.passes;t.render&&(this._tileProvider.beginUpdate(e),function(e,t){var n,i,o=e._debug;if(!o.suspendLodUpdate){var a,s;e._tilesToRender.length=0;var l=e._tileTraversalQueue;if(l.clear(),!r(e._levelZeroTiles)){if(!e._tileProvider.ready)return;e._levelZeroTiles=f.createLevelZeroTiles(e._tileProvider.tilingScheme)}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var u,c=e._tileProvider,h=e._occluders,p=e._levelZeroTiles,m=e._addHeightCallbacks,_=e._removeHeightCallbacks,g=t.frameNumber;if(m.length>0||_.length>0){for(a=0,s=p.length;a<s;++a)u=p[a],u._updateCustomData(g,m,_);m.length=0,_.length=0}for(a=0,s=p.length;a<s;++a)u=p[a],e._tileReplacementQueue.markTileRendered(u),u.needsLoading&&b(e,u),u.renderable&&c.computeTileVisibility(u,t,h)!==d.NONE?l.enqueue(u):(++o.tilesCulled,u.renderable||++o.tilesWaitingForChildren);for(;r(u=l.dequeue());)if(++o.tilesVisited,e._tileReplacementQueue.markTileRendered(u),u._updateCustomData(g),u.level>o.maxDepth&&(o.maxDepth=u.level),y(e,t,u)<e.maximumScreenSpaceError)C(e,u);else if(w(e,u)){var v=u.children;for(a=0,s=v.length;a<s;++a)c.computeTileVisibility(v[a],t,h)!==d.NONE?l.enqueue(v[a]):++o.tilesCulled}else C(e,u);(i=(n=e)._tileLoadQueue.length)!==n._lastTileLoadQueueLength&&(n._tileLoadProgressEvent.raiseEvent(i),n._lastTileLoadQueueLength=i)}}(this,e),function(e,t){var n=e._tileProvider,r=e._tilesToRender,i=e._tileToUpdateHeights;r.sort(E);for(var o=0,a=r.length;o<a;++o){var s=r[o];n.showTileThisFrame(s,t),s._frameRendered!==t.frameNumber-1&&i.push(s),s._frameRendered=t.frameNumber}}(this,e),this._tileProvider.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&this._tileProvider.updateForPick(e)},v.prototype.endFrame=function(n){if(n.passes.render&&n.mode!==_.MORPHING){(function(e,t){var n=e._tileLoadQueue,r=e._tileProvider;if(0!==n.length){e._tileReplacementQueue.trimTiles(e.tileCacheSize);for(var i=s()+e._loadQueueTimeSlice,o=n.length-1;o>=0;--o){var a=n[o];if(e._tileReplacementQueue.markTileRendered(a),r.loadTile(t,a),s()>=i)break}}})(this,n),function(n,i){for(var o=n._tileToUpdateHeights,a=n._tileProvider.terrainProvider,l=s()+n._updateHeightsTimeSlice,u=i.mode,c=i.mapProjection,d=c.ellipsoid;o.length>0;){for(var p=o[0],f=p.customData,m=f.length,g=!1,v=n._lastTileIndex;v<m;++v){var y=f[v];if(p.level>y.level){r(y.position)||(y.position=d.cartographicToCartesian(y.positionCartographic)),u===_.SCENE3D?(e.clone(e.ZERO,S.origin),e.normalize(y.position,S.direction)):(t.clone(y.positionCartographic,x),x.height=-11500,c.project(x,T),e.fromElements(T.z,T.x,T.y,T),e.clone(T,S.origin),e.clone(e.UNIT_X,S.direction));var C=p.data.pick(S,u,c,!1,T);r(C)&&y.callback(C),y.level=p.level}else if(p.level===y.level){for(var w,b=p.children,E=b.length,A=0;A<E&&!h.contains((w=b[A]).rectangle,y.positionCartographic);++A);var P=a.getTileDataAvailable(w.x,w.y,w.level),D=p.parent;(r(P)&&!P||r(D)&&r(D.data)&&r(D.data.terrainData)&&!D.data.terrainData.isChildAvailable(D.x,D.y,w.x,w.y))&&y.removeFunc()}if(s()>=l){g=!0;break}}if(g){n._lastTileIndex=v;break}n._lastTileIndex=0,o.shift()}}(this,n);var i=this._debug;i.suspendLodUpdate||i.enableDebugOutput&&(i.tilesVisited===i.lastTilesVisited&&i.tilesRendered===i.lastTilesRendered&&i.tilesCulled===i.lastTilesCulled&&i.maxDepth===i.lastMaxDepth&&i.tilesWaitingForChildren===i.lastTilesWaitingForChildren||(console.log("Visited "+i.tilesVisited+", Rendered: "+i.tilesRendered+", Culled: "+i.tilesCulled+", Max Depth: "+i.maxDepth+", Waiting for children: "+i.tilesWaitingForChildren),i.lastTilesVisited=i.tilesVisited,i.lastTilesRendered=i.tilesRendered,i.lastTilesCulled=i.tilesCulled,i.lastMaxDepth=i.maxDepth,i.lastTilesWaitingForChildren=i.tilesWaitingForChildren))}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var S=new c,x=new t,T=new e;return v}),o("Scene/Globe",["../Core/BoundingSphere","../Core/buildModuleUrl","../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/EllipsoidTerrainProvider","../Core/Event","../Core/GeographicProjection","../Core/IntersectionTests","../Core/loadImage","../Core/Ray","../Core/Rectangle","../Renderer/ShaderSource","../Renderer/Texture","../Shaders/GlobeFS","../Shaders/GlobeVS","../Shaders/GroundAtmosphere","../ThirdParty/when","./GlobeSurfaceShaderSet","./GlobeSurfaceTileProvider","./ImageryLayerCollection","./QuadtreePrimitive","./SceneMode","./ShadowMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P){"use strict";function D(e){e=i(e,u.WGS84);var n=new c({ellipsoid:e}),r=new x;this._ellipsoid=e,this._imageryLayerCollection=r,this._surfaceShaderSet=new E,this._surfaceShaderSet.baseVertexShaderSource=new g({sources:[w,C]}),this._surfaceShaderSet.baseFragmentShaderSource=new g({sources:[y]}),this._surface=new T({tileProvider:new S({terrainProvider:n,imageryLayers:r,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=n,this._terrainProviderChanged=new h,this.show=!0,this.oceanNormalMapUrl=t("Assets/Textures/waterNormalsSmall.jpg"),this._oceanNormalMapUrl=void 0,this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.enableLighting=!1,this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=P.RECEIVE_ONLY,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=.5}a(D.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}}});var M=[],I={start:0,stop:0};D.prototype.pick=function(t,r,i){var a=r.mode,s=r.mapProjection,l=M;l.length=0;var u,c,h,d,f=this._surface._tilesToRender,m=f.length;for(c=0;c<m;++c){var _=(u=f[c]).data;if(o(_)){var g=_.pickBoundingSphere;a!==A.SCENE3D?(e.fromRectangleWithHeights2D(u.rectangle,s,_.minimumHeight,_.maximumHeight,g),n.fromElements(g.center.z,g.center.x,g.center.y,g.center)):e.clone(_.boundingSphere3D,g);var v=p.raySphere(t,g,I);o(v)&&l.push(_)}}for(l.sort((h=t.origin,function(t,n){return e.distanceSquaredTo(t.pickBoundingSphere,h)-e.distanceSquaredTo(n.pickBoundingSphere,h)})),m=l.length,c=0;c<m&&(d=l[c].pick(t,r.mode,r.mapProjection,!0,i),!o(d));++c);return d};var O=new n,R=new n,N=new r,L=new m;return D.prototype.getHeight=function(e){var t=this._surface._levelZeroTiles;if(o(t)){var r,i,a=t.length;for(i=0;i<a&&!_.contains((r=t[i]).rectangle,e);++i);if(o(r)&&_.contains(r.rectangle,e)){for(;r.renderable;){var s=r.children;for(a=s.length,i=0;i<a&&!_.contains((r=s[i]).rectangle,e);++i);}for(;o(r)&&(!o(r.data)||!o(r.data.pickTerrain));)r=r.parent;if(o(r)){var l=this._surface._tileProvider.tilingScheme.ellipsoid,u=l.cartographicToCartesian(e,O),c=L;n.normalize(u,c.direction);var h=r.data.pick(c,void 0,void 0,!1,R);if(o(h))return l.cartesianToCartographic(h,N).height}}}},D.prototype.beginFrame=function(e){if(this.show){var t=this._surface,n=t.tileProvider,r=this.terrainProvider,i=this.showWaterEffect&&r.ready&&r.hasWaterMask;if(i&&this.oceanNormalMapUrl!==this._oceanNormalMapUrl){var a=this.oceanNormalMapUrl;if(this._oceanNormalMapUrl=a,o(a)){var s=this;b(f(a),function(t){a===s.oceanNormalMapUrl&&(s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy(),s._oceanNormalMap=new v({context:e.context,source:t}))})}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}e.passes.render&&(this._zoomedOutOceanSpecularIntensity=e.mode===A.SCENE3D?.5:0,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,n.terrainProvider=this.terrainProvider,n.lightingFadeOutDistance=this.lightingFadeOutDistance,n.lightingFadeInDistance=this.lightingFadeInDistance,n.zoomedOutOceanSpecularIntensity=this._zoomedOutOceanSpecularIntensity,n.hasWaterMask=i,n.oceanNormalMap=this._oceanNormalMap,n.enableLighting=this.enableLighting,n.shadows=this.shadows,t.beginFrame(e))}},D.prototype.update=function(e){if(this.show){var t=this._surface,n=e.passes;n.render&&t.update(e),n.pick&&t.update(e)}},D.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},D.prototype.isDestroyed=function(){return!1},D.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),s(this)},D}),o("Shaders/PostProcessFilters/PassThrough",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),o("Scene/GlobeDepth",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/PassThrough"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this.framebuffer=void 0,this._copyDepthFramebuffer=void 0,this._clearColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._viewport=new e,this._rs=void 0,this._debugGlobeDepthViewportCommand=void 0}function p(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy()}function f(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}return d.prototype.executeDebugGlobeDepth=function(e,t){var r,i,o;i=e,o=t,n((r=this)._debugGlobeDepthViewportCommand)||(r._debugGlobeDepthViewportCommand=i.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",{uniformMap:{u_texture:function(){return r._globeDepthTexture}},owner:r})),r._debugGlobeDepthViewportCommand.execute(i,o)},d.prototype.update=function(r){var i,d,m,_,g,v,y,C,w,b,E,S,x,T,A=r.drawingBufferWidth,P=r.drawingBufferHeight;_=r,g=A,v=P,T=!n(x=this._colorTexture)||x.width!==g||x.height!==v,n(this.framebuffer)&&!T||(p(this),f(this),(w=this)._colorTexture=new c({context:b=_,width:E=g,height:S=v,pixelFormat:o.RGBA,pixelDatatype:l.UNSIGNED_BYTE}),w._depthStencilTexture=new c({context:b,width:E,height:S,pixelFormat:o.DEPTH_STENCIL,pixelDatatype:l.UNSIGNED_INT_24_8}),w._globeDepthTexture=new c({context:b,width:E,height:S,pixelFormat:o.RGBA,pixelDatatype:l.UNSIGNED_BYTE}),(y=this).framebuffer=new s({context:C=_,colorTextures:[y._colorTexture],depthStencilTexture:y._depthStencilTexture,destroyAttachments:!1}),y._copyDepthFramebuffer=new s({context:C,colorTextures:[y._globeDepthTexture],destroyAttachments:!1})),d=r,m=P,(i=this)._viewport.width=A,i._viewport.height=m,n(i._rs)&&e.equals(i._viewport,i._rs.viewport)||(i._rs=u.fromCache({viewport:i._viewport})),n(i._copyDepthCommand)||(i._copyDepthCommand=d.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{uniformMap:{u_texture:function(){return i._depthStencilTexture}},owner:i})),i._copyDepthCommand.framebuffer=i._copyDepthFramebuffer,n(i._copyColorCommand)||(i._copyColorCommand=d.createViewportQuadCommand(h,{uniformMap:{u_texture:function(){return i._colorTexture}},owner:i})),i._copyDepthCommand.renderState=i._rs,i._copyColorCommand.renderState=i._rs,n(i._clearColorCommand)||(i._clearColorCommand=new a({color:new t(0,0,0,0),stencil:0,owner:i})),i._clearColorCommand.framebuffer=i.framebuffer,r.uniformState.globeDepthTexture=void 0},d.prototype.executeCopyDepth=function(e,t){n(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},d.prototype.executeCopyColor=function(e,t){n(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},d.prototype.clear=function(e,r,i){var o=this._clearColorCommand;n(o)&&(t.clone(i,o.color),o.execute(e,r))},d.prototype.isDestroyed=function(){return!1},d.prototype.destroy=function(){p(this),f(this),n(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),n(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy());var e=this._debugGlobeDepthViewportCommand;return n(e)&&(e.shaderProgram=e.shaderProgram.destroy()),i(this)},d}),o("Scene/GoogleEarthImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadText","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../Core/WebMercatorTilingScheme","../ThirdParty/when","./ImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(r){function i(e){var t,i;try{t=JSON.parse(e)}catch(n){t=JSON.parse(e.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(var o,s=0;s<t.layers.length;s++)if(t.layers[s].id===v._channel){o=t.layers[s];break}if(!n(o))throw i="Could not find layer with channel (id) of "+v._channel+".",_=c.handleError(_,v,v._errorEvent,i,void 0,void 0,void 0,m),new u(i);if(!n(o.version))throw i="Could not find a version in channel (id) "+v._channel+".",_=c.handleError(_,v,v._errorEvent,i,void 0,void 0,void 0,m),new u(i);if(v._version=o.version,n(t.projection)&&"flat"===t.projection)v._tilingScheme=new a({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new l(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:r.ellipsoid});else{if(n(t.projection)&&"mercator"!==t.projection)throw i="Unsupported projection "+t.projection+".",_=c.handleError(_,v,v._errorEvent,i,void 0,void 0,void 0,m),new u(i);v._tilingScheme=new h({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:r.ellipsoid})}v._imageUrlTemplate=v._imageUrlTemplate.replace("{request}",v._requestType).replace("{channel}",v._channel).replace("{version}",v._version),v._ready=!0,v._readyPromise.resolve(!0),c.handleSuccess(_)}function p(e){var t="An error occurred while accessing "+g+".";_=c.handleError(_,v,v._errorEvent,t,void 0,void 0,void 0,m),v._readyPromise.reject(new u(t))}function m(){var e=n(v._proxy)?v._proxy.getURL(g):g,t=s(e);d(t,i,p)}r=t(r,{}),this._url=r.url,this._path=t(r.path,"/default_map"),this._tileDiscardPolicy=r.tileDiscardPolicy,this._proxy=r.proxy,this._channel=r.channel,this._requestType="ImageryMaps",this._credit=new e("Google Imagery",f._logoData,"http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"),this.defaultGamma=1.9,this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=r.maximumLevel,this._imageUrlTemplate=this._url+this._path+"/query?request={request}&channel={channel}&version={version}&x={x}&y={y}&z={zoom}",this._errorEvent=new o,this._ready=!1,this._readyPromise=d.defer();var _,g=this._url+this._path+"/query?request=Json&vars=geeServerDefs&is2d=t",v=this;m()}return r(f.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},version:{get:function(){return this._version}},requestType:{get:function(){return this._requestType}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),f.prototype.getTileCredits=function(e,t,n){},f.prototype.requestImage=function(e,t,r){var i=function(t,r,i,o){var a=t._imageUrlTemplate;a=(a=(a=a.replace("{x}",e)).replace("{y}",i)).replace("{zoom}",o+1);var s=t._proxy;return n(s)&&(a=s.getURL(a)),a}(this,0,t,r);return p.loadImage(this,i)},f.prototype.pickFeatures=function(){},f._logoData="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAAnCAYAAACmP2LfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAHdElNRQfcDB4TJDr1mp5kAAAAGnRFWHRTb2Z0d2FyZQBQYWludC5ORVQgdjMuNS4xMDD0cqEAAB1zSURBVHhe7ZwHeFTFFsf/u+l9N70npOxuSAKEFFIhCSH0qhEQUHkgKCgWUFGBB6IoCAoo0ntooaRvEkIIBBBpoYSa3nvvfd+5u4sQUigPfMX8v2/Y3Tkzs3fv/d0z58zcgF69Ql1SY+MM1wQJem44ZeiJk8beEOqPwG6uC7ZqyElb9eo/JZEIkH2nRQkBIlNMauuPCS3uGN/kjkmNDghoskBAgzrZ2NLmf1+JwIKQpYsoxdmIV9+N07onCegzBPM9bOdmYKnazF6g/1N6UySPqSJzvCaaiLHtP8G/Phq+FRfgU5ogKWUXMLT6Mvzqr2BE40mMadqO8c3zMabBC6PqDDC8SlY60t9HByCLVTKu+ERmHr5TWI9wjVxEaOZivWo1pil8D1tZeWnLXv1l8iZ3PF2kjymiWRgvCoJv5U243IyAXcQq8A9Mg9W+4bDe6wv+kVGwCZkL+4Sf4ZR+BZ5VGQR3EkbWn8Hopm3wq54Lz2JD6ah/P21XGopQ9Qoc16jGSqVyTJWbQbUsibFXf42mihTwZpsvAtp3k0dOhFOSEH1+ngaDefrgjFCgFkxY8fCisCBvKgODzxRh9qslBFGfYmDGLbiV5mBwRRo8KtPhVBgPu8teMP7u73chD6kMRYRGBY5xqrFKqQwz5SdTbS/Qf5mmUYw8rf01CjHC4VP7AHZxO6E3qy9ZZCQNnio2rE/4o9/tkxiQUYp+KRXgx8XC5FsXcLz/hkCrDUU4pxLHuDVYpdwL9F+qqSJZKlPwenskfOoI5tN7YPCJGVme7wKYr5EBXzgYfW+mwTI0Gjrznaj2WW+I/y8dVPdDGLcKRzXrsEqlHO8oTKHaXqAZWe9hQXCi63NhHWYI3ilfWIW/YLjqL2JRiOFBJRz+LffhcPs09D+0J8vzn3zXdBnYnp8Mi6NboTWzH9X8fVc+DhDQodxqAroe36lU9AJNWr4cEAjNwI8OAC9cT1rbUfzwGeCfKiL7dGnNc+q1NiO80b4BY1oT4V6WDcsdc6j2xbyq4wMWrA9rQmeWFn36ey/jBaoPQ4hmLYI0G/AtAf22fC/QDols8ITrIYi/Bl6knbS2o3gRbxHQxQQ0k0S/gCa2v4OJovPwacqAQ1ICjL40klr+UrWoQbFBETo18jCpZsOoFODkvuCNJYoHW3QKXFEM7ETRcKfiQe8d6NVIFImXvg4skhY40mxnQYVRIIeA1qrHEc1GrFSpxFtP99AiFbDbNKDZpAzzGkVYVcvBuBJQEo/9/6C+dyjPitwLwak74D8V6Bfw0P5VShjXFoTR7TfhUZkL29M/wfATJan1lauWC3aDOgyaVDCuTgbf1bFkfmtkye1ogsK2asivLYfCglIoD8qCknI2NHuG4QSVGMgQyMbt0fioRYh9VYcRU7QX55uDcaHtFOJEsThMtmWtQgxsDodsWaC0c3ea3MzGBJEqxrfbYmzr6xjfPAeTmt5HQPO7eK1xDibUz8eY+k8xtHYJPCtXwvHOu7AXMrMTsF/TH8HajTis1YwVqpWY0TXQDKy1OpBr5EJA52Fukxx+bmKxtjWx2DuaWawNlZD5qhzyo9KhpHAbKpJO/6t65UCPbPHA2PYrGNacgkElabCJJDev/MpDhUKKnuq44LRoYEK1IiswkS1zYCfk5y+F0qjvoTwqBOof34dGeAnUL1ZCLboEnJ9zoe0QD/Nuj00UBVXRabzVLETM3S0ICfwA8yc7Y6C3ANYbZsA7aQ1W1xzEfZEQ6dT2BkG9pP4ouo7jGE1u42JS20QMrzkCr4xwuN4+AM+cYII3EaNar2J86zmMrP8DHulCON4NhU3YWuhOYy6SZENpH9cfx7WacFC7BSvUqjBDsRPQIiugURvazeqYVaqAw6dYrJ9WQy7gayj4nYDy3HtQOVQGpYRqKEWXQf2HdGha/AFdae9Xr4czz0ubISRA75ECbSut7agegO75OLxpahze8j5GtifBpzEDLiV30Dd2mNT6StWiCbVmLt5rUkBQCEt2zWzIMSA8HgrIBkLD+Sp0jhHISYXQ/KMYukfvQ3fQxq68XCTBHId/tMTg7LV1CFs4BszJ6hBarBgHlcRv8H7tbuSKQpFPYGe0BmND+nZ0npECaPKf0r4UIxsuoF/IMpitsAVnrA4s15uh3x8fwLXkLobUZGJIXTqcUzbDaJE5FAVq0t4S7dEcjqMEc6B2K5arVWN6Z6AbdOmm5mJelQKOHWSxF44Cy4CqxW0s6RwchCovFRohdGNfLgX3WiZ0N4aD++y7jfwYJUrAPCle/ZjKV+BFTSegrGAZIm3QjXhBytTWB3zhByzryMUU986jz16wD+96ijCNUIAgmkc3tS6G7GERjCbgR82B4OTbEESqIiCIcqsIYzoGGyrBEMSmgh8xBoIIAR2fAHZhj8Z9DOhl9FHeKkSDvn809fuc+iyCddRYaiOZBTvIt1YJfs0b4N+WDO+GHPLQN2Ab7S61vjJV60C9SRPvNSqzTpxlyQfS1dGUmjppK7gW16B/LhN6abnQu5cDwzO3YNhhqqK4WJY887sEdGzWFpxfOxmDpKZOOvgWFB8sx9L6nShvP4FyUQjKGg5gScpGKEqbUE7RxiGYv6QQ4zIG/r4D2m88sjEy/EIW/a6+TQ4gHe5VhXCvy4JL7gLYnesI2i6t4Tii04r92u1YKt767gB0ozrkGzmY26zEOh7Hkt+kAKhLTX9qOVVdg9aoNOjcToR+wUVKLYKgN0Zq7l7884wn9CKgr4AfWw/B6SwqKQRKOdXVghe9CpbherASSjtIpGpxRIHFjwygNreoXy0lb+lU7lHJBP9kPcGXQnBNghUB/Lh44fbUp5JA+5Hs71LbPPLCVRDEJZDNGIJgeQI6mG6KegKzldq1U7tGKjQmHR8vwl86kgRoAQN0xBw6ztn0nQ/ocxEdQ7L4d/BjG6g+m8aZTL/xsXPuW82Fb8t+DG1Ox5D6XAwqvQ67OA+p9ZWoUQPsei78mjSwNU9GLmEzVGZJTd3qFPTn3YZhXgYMMjNhlHsDxms/hNWfoUdrNPgEc2h7BG5d/Bo7Blt0BuNxXf4MVmXrkdRyEHWiY6hr2oc7mevRX2wc18gioEeI1+N9a+/CNnImVAZ0mhEoNOPAJT8MHjUF8KTiWhqHgbfMpVaJdhLQh3XasU9bJAZ6ekeg6zQwgEKuLSWysmd3QGmatLqD8qDNug3dCX/AIPk4jGr2wDB/JXTmkan70IvmZTY/rB9BdZlKLkG0lG0d5klAObKsw1+jzyFiWPnRawiaDrMYwTyMwMwh220WP2IWFVfqN4CKO8E3n0C6R/ZUej9Y2kUiMdDRFTRePH3nA3q/m7xpAEtAXl0QrkTwscnmS/3eptdzNEYevZLnZ5booqk8tuYs9tAny+n1LL1mghezlcULH0VtHamOZhvhIvoNOXQsd2EZIbluYnlWaMO75TCFG9kYXJ8H14o76H/10Z3yClSrCm6jGtbWK7LC7kIlYRfUmY2XHnUa+mbXYRSfCuNCptyE6b1jMBD/EPKwchQPLxGdxOWWI8iKXYBPqLozgI8pfA5YBWvxbfMeNLUfRmPTLjRnr8YKsdGvRQ5j2zZTSSRQ78H+7GhxfScFAINypsG9ukDspZ0LKKE+O0pqlGi71ggcIqD3dga6RhFKjSqYT+VEFkvu/E9Q+HNWKaE2VVDgVkPFqwAaay5CN3En9M59BM2vfKDs7AvljjPGE5LlharQdL+LoCmhOHU0rIUyD+NgVTOa+q2iVQiIcAKpHtbhXuJOjPqeVCRYThNE6VTvKNs3hM3cHGIxntxKyCbP7Erj1lHZJbVIJAG6iiCroZCAPGukvOyASJbvCgoaAoKoAQ1kHcGC7nmZDkmhBR2PfSQLtkcl4zCSAE2eO6qExYuYxrE4KqdvelBiM4+ncYQy1IY8d0wbhUSLJAZGbsUceNYdwJCGPAyuy4NbZToG3JoO1Qk9AvHvqF4ejo0KCKlisyl04Jw+AE1ma71HRUJP+QqM1t2HcVEyTEoSYVYQCuN3HenCt4XDhGA+KorAnYZ9KIj5ELOl3XpU/k/wrt+OmraDaG7cjpacbxFvYAAZDG5Vw/DWCxjRdp+ATsWAS6+D69H1+XDNsoVb1T06b0VwzCmBIOYdqUWibTojcFBH1CXQctBtUcA6Oh/RmVC4sBmKA5j6erC1qqE4sRpqG25A43QIOHuXgvOmP5R4ZH6m5UY2L9SSLjZ5sKjjsI/o8olH8ngjCZoSgmw9DMIl3t42Up0g+pq89/sEjLK47knZhSkSuDepJP4JOyNJyEFAR8VQKMOR1nbWM69yxNJYwh+VLE90ffPyxLE3EwL9Jq0huWQqwL1iA7zq8+FVl0+epgBO6T+gb2TH+OglqgastxtZrNNlkLt8E5oJx6HZdab7mFZBk3UZRjMewCT7HkzLfodZxREYr5sBjiIBPYiAPt8ehvSGPSg5vwjzpd16VNkmmDTswp22QDTXbkJrxhJkzHGDFoUQmvBpvo2hrZl0TnLhlLIYfUO7nt7dSg3hURcP1/JiDEgphuXBqVKLRFsfA3oJAf3mI6Cr2OjTwGYdqWGzzmZD6WoYVCfehdqsZKjuuwS1oB1Q+5piHac3oaxBzZ9vLZ4nHEeesoXg6niDPSYWP9yUgD5PHu48eKE64krHcErchHIEuRysTpAXjObQWIYEHiV4EQYEojp5aEoyY+IIpOQugKYYOnIdJXrdJ63PtWwXMQM6m6SVT4gfZkbHV0XHsVtaQ3K8yoJr0YfwoHDDq5ZiQSqDik/B4Q9taYtn18gyNia1qGJsmTrGlUjK2FJ1jCjRwOASDnkxDvN95ZD/og5yl0qgfCMJ2leDoeksHaFHXYOJVyrMkm/DrPwMzGr2wmjnLGipthyHL0W7t9pDkduwF2U3lmGFtvbTdyirt0OreT+iWwPRUrUBbSkLkT/fCUZwKVYikBMwpDlPXNzLwuAQ2rWX8KzUh2dDDJyLSmB7/S5Mf3WRWiR6CPSezkCXQs6qBnLCKsheyoXqnTCoL9oOFd9/Qtl9KJT6UJMX3/zhCz8iuCjhiviSYtMx3ZTJBN8lCE7eIRgF0p6krRRaRBDskTTGySBKws5SuUjJHYUiMQdpzCUE0Q3y5MnSDhJJQg5JUvjSgO5hHZofaioGmvc40IycMgbRtJktjgOZ5Ma9irzSg46xYHcaVEZevkgBHqUWGFK+FENKQ+BdGAq/wiMYWbwHI6h4FwTDOes0BMKFMHxPNg9qn1dANakYanfuQSs5FJoTpaP1qBswsSGgb9+EeUU0Af0LDH4dBhXlmv3wajuOpPYQFDcEojxtNQ6sn9ZzUsiofjfUWg/iYOt+tJatRtvN95DqZgxNuKTKwLV4Jdyqc8Wz1uCGTLjmDIVDQqewQ8anwpJi6GsYkF4Ey2O/QvsfXKlJIgboAwT07s5AZ0G1TylUIsuhdKMI6vcuQ3PVAqg+9UZ8JvGEywiuNoIwD4IzaV2X+HSa1otgE3+NwJImVkycG0kx8snfyUZJW+QFApeSu+hN9BpIn6n+ZBp9bqDv+C8Fum+8IpzzJNOmR3UhTaGFcC07iAHXmamuZw28C/S/aIt+CcthF7+ToN0EQdhqOFzcBu/Sm/ApvAGX3DzYXIiF9jtWTJf74L6ZC83UfGg8SId2xnloSZKxp+gWjC0J6KSrMK8KhmnlSugtInpkCzaBV78Hl5oPoaLpECrLt+Bi4jfgS7t1q+YDUGsPwj5KDFsLlqD97JuIpmpZmP+TftM1ezjlxsOllM4H3eReDWHwKrOBW84jqMeK5OBTv4Bu6HxxgqU1s/N3MkAHSoH+ioCe+gjoJHB0s8ENLID6/UJo3E+GVlwoNEwY278tXhR50RhmeexzgmM8JXjdF36MHwEoiXn70Csv6gxBm8PiRc6gJFD1HDzFpq1cP0omo5QJZAfqQzH0f6uHZjQgeR4cC/IJZCnUtSkYVPAWBiX2/CdU/S7Ql+9TgtFCTaiP0qAEXA2yRsqwuzECziWZcM4tgv2DSljF7ID+l+JNh9+hY38HuvcYmLOhk5EEnVPfQOmpW+33YGaXhj53E2BWuxvGebOh5cPUX/sWSgXrsa9mB2qaDqCK4C7I2IA3jn8u7tat2g6D034MIbWb0fZgHlr2DscXUhNNuYdkYRPrg/7JiXDMLYBrZS6GNEZgVJM/JjWY4I16G4xr/BCDq2nKjjoAvY+Zpwo7eXBskQK9Swr0lEdAn4a2wk3o/DMNWmn54KYUQIuZsebGQuXFQ42H4kfNk4QckSOkNZ1lGkGAUoInOKkAm2jJsVtH+om9Nj9ytZxNcNdhljXByo+JJXj/i4G2u2xM02YInPJLxFB7VudTPH0ZHkWu0hbPpwHpfnAszoFDVgVsb1fDMmoL9L8S7wTFQE/1AvR33oB+QSp0czKgl34B2iO9uwJCKib5SGaZjbqLPlkhMG1YDr1gQyioSs24vQTDitagsnIL6loCUVu9C2EJK9FjYtsWBNP2Q7hb9A155zdwY5mTeGexo0w32hEcy2F7JQaOqZfgk38KY6rDMKFBiGHNt+iGPgCNYd0/s/sbAb2fgN5JQC9Wq8bkR0AzioOOx3Xo30mGbnY+tNMKoJOQCm03qfnFxRf6E1yUFAqZJcyuZRWuQmB+TWHJcgJfkjPxImcSSIUsXviMx/O9DvqfALrPDjb6nhuBAWkZ5JFKKTYuIqhz4FUdAo9CGwzO7Ra2LjUg0w9OxdlwyKxAXzHQm8lDi4HeAT1WMPSHnYXR7aswKE6Gfl4K9PdfgZ6+uG8XSmMbKyXD/LsEmFduglH2NHA7rA3Hvg+Ve1/gYO4KNFRvQUPLQVRU7MG4yn1dJ4eiULAo3JhW9xsa77+Hml8GY8FQ425uAM5wRRivNoPlTjs4XhoH35oLGFZ/S/wglyDkbWmrrsUAvY+A3kHlSwJ6ihKzCvLnuQyElmIs9LdfhmHxA+jn5kI3jcrRFOjxU6DTbTx9DybsOBh0f034EeYEVyaFD0IYhnQ9y1pTIsiPvU5AnKYkUBL78yKmQhDLgDRPSWtPp/HFkFtHqFCfRBr73wX67qsD+qFsEubCnqKBAZllcCkkT12RjSHVMfApH0bJXfcH+aQGZg6FU1EWeeoK2NwgoMM3Q++zP/fq/Smf2g392ZEwzk2Acfl9GBHURmuSYPyn132oHBizH8B8wjX0SadQI2cWtOZZQbHTdEgRn8XN93EiczFayn5GU3Mg7lJMPab5SEeoCWZZ0TF4Ne/A/ZSPUbXdDz9Qdddrrk/KtcwR7jX34VXDzGCFGFT0GzyLu922x069kdiv145tOu34jlOHBWoz4arUAZQt0LYOhmFcHJ2H6zAsYnZDc2FwKhv60+m9UQrLUJ4hSYQAVhpM1O6jj30EDD33Q6frZyoY8cMVaWZZR560kuB5V9H6iVUas+Py5L1/IHsT2ZldR4nEkMdkUd8Y8tYd43mLIMhYhenDWvgjQSQiGFOkiEv0rEAzK2u8yG10M2WwBWFdb6q9NKDNd6rCOuYD9L2VI/57QMfcEniU5cCnJgG+lR9haAnz4MzT5ZjmA4e8HBqnGtYXamF+nK7bpx0uwHxoqGyE3sKD5HHjYVJ1C6Z5qTD5Ph2G1hnQEV/0LBhxU2E+4yYsbgTCJGsuNBfYQrnjA0CPxDo2CRYJ0xGesgD1ZWvQ3LQbKeSJ54uC0UcUDVVRGExFR/FB2y7cSf4C+Zv9sXSUeQ9P2z2pQdnmBHQsPKqKqFCyWJsM75o1GMw8O/iEhFZs/KK9CD9wRfhCTYTP1dqwnBOHrQYz8IuuH5ZxxI/MLQZH5kfoeu6D4cVQGNecgXHFbRgXZsD4Xg5MjqfDeE0KTBbRDLXsLiwOR8HkxCJoOs+Eavdr08ZBBGdYP7rYzAZILsH3LYUYtgSsAXlYRwLqW0r8Ksl2id4/Onaz47IE+kayUfwddYhsgwkqXRrLgOpHEuyhVF9B7ytoTAL//qNjeFagGfGEi5nvYPEifqOx/ek4p1J/8aKBWC8N6Icy2+oL6zOhECTmw46SuoHZpXBn/pK7/DK8K1bCp3Q0vAv7wqfIBD55OuS9teFVYASPfAFccseThw+E4Ho5LOMqYB6ZCeOdK6H1bleJH2sOOPZradqlC3otDqY5F2GafQmmCZdgFnMBZteEML2yCnprh0CZWVp66gbDuD5Q2uSLUacm43jSB0gq+h55JeuRX7wRqUUbkJL8DS4GTcPqCdZgduZ6XiZjgvcp9fIY3aAH/yY+3KvcMDBjLSXQBXDML4VbaQG8a9PgUxcOzyIneKY/Or6FHDO8q7INY+RiMFJaJijE4i2VeEylej/FDs99TAPH8Dvofv8bDK/vhVHxMRhX0W+vOgXTijiY5UXANGkNnYeRUGN2VrsPNx6XVaQNgRNM03sBgUjeOKJJ/Cr+LNzFsg61YB5/elyKtic0qM031CaZAG0gqJnVEuYBIoI49gy9D6DXrQR3GoU2j3YE+WE2FI9TGBG1FLywnhNbPt1Y/OhY+o5iGqsGNmdLaVxfqZUB+g0Iztwi2AOkNZ3FCzOm30bHeHK9tKYHKfPZMFhlAtM9c2EpjALv93zY3qlE/8xyOOUVUTiSBrfy83CvDIdbRZC4uJSGwzHzd0qgkmEVfRnGW/dC79vPobtkFLRmm0HDpVt43MnrzoOm/dfQeeOf0P3wB+guJogXrIDuhHfAsdOFbKdQ5GkaYQbNNYNht2c8/AOnYNKB6Ri//Q14zRwIuohdPC76pCbWKGFCkx9GNC7B0NZD8CiJh8Odi7A59zud7EuwvU4hVUYZBhUXwqsqA56V0RiUM1Dam36UoiyFuprQhc6fRZuKKhV5+rcLKD2hrPQ+NPsvgNb0j6C9eCG0v/kU2l9/BK0ZM8EdRJQ833noG8Qib6lDkA0lYD6i8GIJlffZ/IhhbJtQjW4TP164EiWWztTnH9T+a4L/MxpjAn02hWWYDAQnefSZzm7Io7zDOpiSzGh3grwPwd3zDccPZdH4phBEkXcWBrD4wlE07qObw5pmBUGsK43T/YPfgmAFWEe5U2EeCXhGcV5nQ3u2KrTf6w+jdTNhtud7mB/ZC4vg43QAwbAMDYLF0e3os+8HGP80D7oLx0F9dD+oj9AGZ4Y85K0Yj/Vs3kQiFgeybFPIySiDzdwAz9O3JzHjPNtYk8gjv948FOOatlGodR0Dk07Bau9n0F8wFBp+luBO1CXeuDD51Q3830PRP7UIzgUlcC0vhHPRSdic6eI53ecT3W0sKyjI2EFRxhzyz3sOO8voBkEUTclYhAyshCwr642PR79diwlbBOEs8vLMFjgbbuelhpeoz5rEDxsNNl/+9ON5RWJOLsXCysQdh5IhWWbzhUmoel6v/l/RxGpZTKgbh3EtEZQMp5AX2ASd2f3AVu7695ky/7nOuc2U/BZSCFIGp+I82F/rfprsVa/+Mk0sZ2F0tTvGNZ+gRO8B7C/HQ92beWine+/IDWDBbJUmbBN/hUNOGRyyStH34vfQeP3ZV4R61atXIu9Kefg1rIB/XRJciwso9nymLXmxbP+wxcCsVAxIKwfv1AZoDH96jN6rXr1SuVeowKsuFINrs+BSXATbc59JLU/XwCwdDMw7B/vUEpgHfQYZ7v9HCNar/2E55ynDpSwYrhXF4uKUeQiY0/Oy3kM555nCITcJgmvp0F30Yo8L9KpXL1X9E2XhkPoVBuYWwbmolKDOhmv+WHiXyGNkgbTRE1pOublXkRycCz+AfUoRzPdsgKJN1w/19KpXf7n6xlnCPikE/SkWdswrozDkNoZUfIWhFTYYWaPy4a6NkgSR2XAZXSOLIWUWcCv7FP1T7sH8wFZwp7ycxz971auXIm4AG+b77MFLEKLv7ULJMy0FefCsPAOv0t0YUrIMg0s+gVfxYrgVbIJLUSzsrl2F2ZZl4L7J/Pdp/956ca969UrEna0O41/HwSJ4F3in42Fz5Trsbt5Bv3u30e9uImyvnoV15GGY/LIA6kOZP1966pZ8r3r1n5eqhwZ0F/aB4ToHGK9zh/FPHjD60RE6H1tDaaA2cdy7mvFfI+BffksPNrEksu0AAAAASUVORK5CYII=",f}),o("Scene/GridImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,n,r,i,o,a){"use strict";function s(e){e=t(e,t.EMPTY_OBJECT),this._tilingScheme=n(e.tilingScheme)?e.tilingScheme:new o({ellipsoid:e.ellipsoid}),this._cells=t(e.cells,8),this._color=t(e.color,l),this._glowColor=t(e.glowColor,u),this._glowWidth=t(e.glowWidth,6),this._backgroundColor=t(e.backgroundColor,c),this._errorEvent=new i,this._tileWidth=t(e.tileWidth,256),this._tileHeight=t(e.tileHeight,256),this._canvasSize=t(e.canvasSize,256),this._canvas=this._createGridCanvas(),this._readyPromise=a.resolve(!0)}var l=new e(1,1,1,.4),u=new e(0,1,0,.05),c=new e(0,.5,0,.2);return r(s.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),s.prototype._drawGrid=function(e){for(var t=this._canvasSize,n=0;n<=this._cells;++n){var r=1+n/this._cells*(t-1);e.moveTo(r,0),e.lineTo(r,t),e.moveTo(0,r),e.lineTo(t,r)}e.stroke()},s.prototype._createGridCanvas=function(){var e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;var t=this._canvasSize,n=e.getContext("2d"),r=this._backgroundColor.toCssColorString();n.fillStyle=r,n.fillRect(0,0,t,t);var i=this._glowColor.toCssColorString();n.strokeStyle=i,n.lineWidth=this._glowWidth,n.strokeRect(0,0,t,t),this._drawGrid(n),n.lineWidth=.5*this._glowWidth,n.strokeRect(0,0,t,t),this._drawGrid(n);var o=this._color.toCssColorString();return n.strokeStyle=o,n.lineWidth=2,n.strokeRect(0,0,t,t),n.lineWidth=1,this._drawGrid(n),e},s.prototype.getTileCredits=function(e,t,n){},s.prototype.requestImage=function(e,t,n){return this._canvas},s.prototype.pickFeatures=function(){},s}),o("Scene/MapboxImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/MapboxApi","./UrlTemplateImageryProvider"],function(e,t,n,r,i,o,a){"use strict";function s(r){var i=(r=t(r,t.EMPTY_OBJECT)).mapId,s=t(r.url,"https://api.mapbox.com/v4/");this._url=s,this._mapId=i,this._accessToken=o.getAccessToken(r.accessToken);var h=t(r.format,"png");/\./.test(h)||(h="."+h),this._format=h;var d=s;if(l.test(s)||(d+="/"),d+=i+"/{z}/{x}/{y}"+this._format,n(this._accessToken)&&(d+="?access_token="+this._accessToken),n(r.credit)){var p=r.credit;"string"==typeof p&&(p=new e(p)),u=p,c.length=0}this._imageryProvider=new a({url:d,proxy:r.proxy,credit:u,ellipsoid:r.ellipsoid,minimumLevel:r.minimumLevel,maximumLevel:r.maximumLevel,rectangle:r.rectangle})}var l=/\/$/,u=new e("\xa9 Mapbox \xa9 OpenStreetMap",void 0,"https://www.mapbox.com/about/maps/"),c=[new e("Improve this map",void 0,"https://www.mapbox.com/map-feedback/")];return r(s.prototype,{url:{get:function(){return this._url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),s.prototype.getTileCredits=function(e,t,n){return c},s.prototype.requestImage=function(e,t,n){return this._imageryProvider.requestImage(e,t,n)},s.prototype.pickFeatures=function(e,t,n,r,i){return this._imageryProvider.pickFeatures(e,t,n,r,i)},s}),o("Scene/Moon",["../Core/buildModuleUrl","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/IauOrientationAxes","../Core/Matrix3","../Core/Matrix4","../Core/Simon1994PlanetaryPositions","../Core/Transforms","./EllipsoidPrimitive","./Material"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(t){var i=(t=n(t,n.EMPTY_OBJECT)).textureUrl;r(i)||(i=e("Assets/Textures/moonSmall.jpg")),this.show=n(t.show,!0),this.textureUrl=i,this._ellipsoid=n(t.ellipsoid,a.MOON),this.onlySunLighting=n(t.onlySunLighting,!0),this._ellipsoidPrimitive=new d({radii:this.ellipsoid.radii,material:p.fromType(p.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new s}i(f.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var m=new l,_=new l,g=new t,v=[];return f.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var n=e.time;r(h.computeIcrfToFixedMatrix(n,m))||h.computeTemeToPseudoFixedMatrix(n,m);var i=this._axes.evaluate(n,_);l.transpose(i,i),l.multiply(m,i,i);var o=c.computeMoonPositionInEarthInertialFrame(n,g);l.multiplyByVector(m,o,o),u.fromRotationTranslation(i,o,t.modelMatrix);var a=e.commandList;return e.commandList=v,v.length=0,t.update(e),e.commandList=a,1===v.length?v[0]:void 0}},f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),o(this)},f}),o("Scene/NeverTileDiscardPolicy",[],function(){"use strict";function e(e){}return e.prototype.isReady=function(){return!0},e.prototype.shouldDiscardImage=function(e){return!1},e}),o("Shaders/AdjustTranslucentFS",[],function(){"use strict";return"#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nif (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n{\n#ifdef MRT\ngl_FragData[0] = u_bgColor;\ngl_FragData[1] = vec4(u_bgColor.a);\n#else\ngl_FragColor = u_bgColor;\n#endif\nreturn;\n}\ndiscard;\n}\n"}),o("Shaders/CompositeOITFS",[],function(){"use strict";return"uniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 opaque = texture2D(u_opaque, v_textureCoordinates);\nvec4 accum = texture2D(u_accumulation, v_textureCoordinates);\nfloat r = texture2D(u_revealage, v_textureCoordinates).r;\n#ifdef MRT\nvec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\nvec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\ngl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\n}\n"}),o("Scene/OIT",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/PixelFormat","../Renderer/ClearCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/WebGLConstants","../Shaders/AdjustTranslucentFS","../Shaders/CompositeOITFS","./BlendEquation","./BlendFunction"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(n){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var r=n.floatingPointTexture&&n.depthTexture;this._translucentMRTSupport=n.drawBuffers&&r,this._translucentMultipassSupport=!this._translucentMRTSupport&&r,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new o({color:new t(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new o({color:new t(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new o({color:new t(0,0,0,0),owner:this}),this._alphaClearCommand=new o({color:new t(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._translucentShaderCache={},this._alphaShaderCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new e,this._rs=void 0}function y(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy()}function C(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy()}function w(e){y(e),C(e)}function b(e,t,r,i){var o=r[i.id];if(!n(o)){var a=u.getState(i);a.depthMask=!1,a.blending=t,o=u.fromCache(a),r[i.id]=o}return o}function E(e,t,r,i){var o=t.id,a=r[o];if(!n(a)){var s=t._attributeLocations,l=t.fragmentShaderSource.clone();l.sources=l.sources.map(function(e){return(e=(e=(e=h.replaceMain(e,"czm_translucent_main")).replace(/gl_FragColor/g,"czm_gl_FragColor")).replace(/\bdiscard\b/g,"czm_discard = true")).replace(/czm_phong/g,"czm_translucentPhong")}),l.sources.splice(0,0,(-1!==i.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),l.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+i+"}\n"),a=c.fromCache({context:e,vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:l,attributeLocations:s}),r[o]=a}return a}v.prototype.update=function(t,r){if(this.isSupported()){this._opaqueFBO=r,this._opaqueTexture=r.getColorTexture(0),this._depthStencilTexture=r.depthStencilTexture;var o=this._opaqueTexture.width,a=this._opaqueTexture.height,c=this._accumulationTexture,_=!n(c)||c.width!==o||c.height!==a;if(_&&(b=t,E=o,S=a,y(this),this._accumulationTexture=new d({context:b,width:E,height:S,pixelFormat:i.RGBA,pixelDatatype:l.FLOAT}),this._revealageTexture=new d({context:b,width:E,height:S,pixelFormat:i.RGBA,pixelDatatype:l.FLOAT})),n(this._translucentFBO)&&!_||function(e,t){C(e);var n=p.FRAMEBUFFER_COMPLETE,r=!0;return e._translucentMRTSupport&&(e._translucentFBO=new s({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new s({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===n&&e._adjustTranslucentFBO.status===n||(C(e),e._translucentMRTSupport=!1)),e._translucentMRTSupport||(e._translucentFBO=new s({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new s({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new s({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new s({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1}),e._translucentFBO.status===n&&e._alphaFBO.status===n&&e._adjustTranslucentFBO.status===n&&e._adjustAlphaFBO.status===n||(w(e),e._translucentMultipassSupport=!1,r=!1)),r}(this,t)){var g,v=this;n(this._compositeCommand)||(g=new h({sources:[m]}),this._translucentMRTSupport&&g.defines.push("MRT"),this._compositeCommand=t.createViewportQuadCommand(g,{uniformMap:{u_opaque:function(){return v._opaqueTexture},u_accumulation:function(){return v._accumulationTexture},u_revealage:function(){return v._revealageTexture}},owner:this})),n(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(g=new h({defines:["MRT"],sources:[f]}),this._adjustTranslucentCommand=t.createViewportQuadCommand(g,{uniformMap:{u_bgColor:function(){return v._translucentMRTClearCommand.color},u_depthTexture:function(){return v._depthStencilTexture}},owner:this})):this._translucentMultipassSupport&&(g=new h({sources:[f]}),this._adjustTranslucentCommand=t.createViewportQuadCommand(g,{uniformMap:{u_bgColor:function(){return v._translucentMultipassClearCommand.color},u_depthTexture:function(){return v._depthStencilTexture}},owner:this}),this._adjustAlphaCommand=t.createViewportQuadCommand(g,{uniformMap:{u_bgColor:function(){return v._alphaClearCommand.color},u_depthTexture:function(){return v._depthStencilTexture}},owner:this}))),this._viewport.width=o,this._viewport.height=a,n(this._rs)&&e.equals(this._viewport,this._rs.viewport)||(this._rs=u.fromCache({viewport:this._viewport})),n(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),n(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}var b,E,S};var S={enabled:!0,color:new t(0,0,0,0),equationRgb:_.ADD,equationAlpha:_.ADD,functionSourceRgb:g.ONE,functionDestinationRgb:g.ONE,functionSourceAlpha:g.ZERO,functionDestinationAlpha:g.ONE_MINUS_SOURCE_ALPHA},x={enabled:!0,color:new t(0,0,0,0),equationRgb:_.ADD,equationAlpha:_.ADD,functionSourceRgb:g.ONE,functionDestinationRgb:g.ONE,functionSourceAlpha:g.ONE,functionDestinationAlpha:g.ONE},T={enabled:!0,color:new t(0,0,0,0),equationRgb:_.ADD,equationAlpha:_.ADD,functionSourceRgb:g.ZERO,functionDestinationRgb:g.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:g.ZERO,functionDestinationAlpha:g.ONE_MINUS_SOURCE_ALPHA};return v.prototype.createDerivedCommands=function(e,t,r){var i,o,s,l,u,c;return n(r)||(r={}),this._translucentMRTSupport?(n(r.translucentCommand)&&(i=r.translucentCommand.shaderProgram,o=r.translucentCommand.renderState),r.translucentCommand=a.shallowClone(e,r.translucentCommand),n(i)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=i,r.translucentCommand.renderState=o):(r.translucentCommand.shaderProgram=E(t,e.shaderProgram,this._translucentShaderCache,"    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n"),r.translucentCommand.renderState=b(0,S,this._translucentRenderStateCache,e.renderState),r.shaderProgramId=e.shaderProgram.id)):(n(r.translucentCommand)&&(s=r.translucentCommand.shaderProgram,l=r.translucentCommand.renderState,u=r.alphaCommand.shaderProgram,c=r.alphaCommand.renderState),r.translucentCommand=a.shallowClone(e,r.translucentCommand),r.alphaCommand=a.shallowClone(e,r.alphaCommand),n(s)&&r.shaderProgramId===e.shaderProgram.id?(r.translucentCommand.shaderProgram=s,r.translucentCommand.renderState=l,r.alphaCommand.shaderProgram=u,r.alphaCommand.renderState=c):(r.translucentCommand.shaderProgram=E(t,e.shaderProgram,this._translucentShaderCache,"    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n"),r.translucentCommand.renderState=b(0,x,this._translucentRenderStateCache,e.renderState),r.alphaCommand.shaderProgram=E(t,e.shaderProgram,this._alphaShaderCache,"    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n"),r.alphaCommand.renderState=b(0,T,this._alphaRenderStateCache,e.renderState),r.shaderProgramId=e.shaderProgram.id)),r},v.prototype.executeCommands=function(e,t,n,r){return this._translucentMRTSupport?void function(e,t,n,r,i){var o=t.context,a=r.framebuffer,s=i.length,l=t.frameState.shadowHints.shadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(o,r);var u=e._opaqueFBO;r.framebuffer=e._translucentFBO;for(var c=0;c<s;++c){var h=i[c];n(l&&h.receiveShadows?h.derivedCommands.oit.shadows.translucentCommand:h.derivedCommands.oit.translucentCommand,t,o,r,u)}r.framebuffer=a}(this,e,t,n,r):void function(e,t,n,r,i){var o,a,s,l=t.context,u=r.framebuffer,c=i.length,h=t.frameState.shadowHints.shadowsEnabled;r.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(l,r),r.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(l,r);var d=e._opaqueFBO;for(r.framebuffer=e._translucentFBO,s=0;s<c;++s)o=i[s],a=h&&o.receiveShadows?o.derivedCommands.oit.shadows.translucentCommand:o.derivedCommands.oit.translucentCommand,n(a,t,l,r,d);for(r.framebuffer=e._alphaFBO,s=0;s<c;++s)o=i[s],a=h&&o.receiveShadows?o.derivedCommands.oit.shadows.alphaCommand:o.derivedCommands.oit.alphaCommand,n(a,t,l,r,d);r.framebuffer=u}(this,e,t,n,r)},v.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},v.prototype.clear=function(e,n,r){var i=n.framebuffer;n.framebuffer=this._opaqueFBO,t.clone(r,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,n),n.framebuffer=this._translucentFBO,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,n),this._translucentMultipassSupport&&(n.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,n)),n.framebuffer=i},v.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){w(this),n(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),n(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),n(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy());var e,t=this._translucentShaderCache;for(e in t)t.hasOwnProperty(e)&&n(t[e])&&t[e].destroy();this._translucentShaderCache={},t=this._alphaShaderCache;for(e in t)t.hasOwnProperty(e)&&n(t[e])&&t[e].destroy();return this._alphaShaderCache={},r(this)},v}),o("Scene/OrthographicFrustum",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Matrix4","./CullingVolume"],function(e,t,n,r,i,o,a,s){"use strict";function l(){this.left=void 0,this._left=void 0,this.right=void 0,this._right=void 0,this.top=void 0,this._top=void 0,this.bottom=void 0,this._bottom=void 0,this.near=1,this._near=this.near,this.far=5e8,this._far=this.far,this._cullingVolume=new s,this._orthographicMatrix=new a}function u(e){e.top===e._top&&e.bottom===e._bottom&&e.left===e._left&&e.right===e._right&&e.near===e._near&&e.far===e._far||(e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=a.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix))}i(l.prototype,{projectionMatrix:{get:function(){return u(this),this._orthographicMatrix}}});var c=new t,h=new t,d=new t,p=new t;return l.prototype.computeCullingVolume=function(e,i,o){var a=this._cullingVolume.planes,s=this.top,l=this.bottom,u=this.right,f=this.left,m=this.near,_=this.far,g=t.cross(i,o,c),v=h;t.multiplyByScalar(i,m,v),t.add(e,v,v);var y=d;t.multiplyByScalar(g,f,y),t.add(v,y,y);var C=a[0];return r(C)||(C=a[0]=new n),C.x=g.x,C.y=g.y,C.z=g.z,C.w=-t.dot(g,y),t.multiplyByScalar(g,u,y),t.add(v,y,y),r(C=a[1])||(C=a[1]=new n),C.x=-g.x,C.y=-g.y,C.z=-g.z,C.w=-t.dot(t.negate(g,p),y),t.multiplyByScalar(o,l,y),t.add(v,y,y),r(C=a[2])||(C=a[2]=new n),C.x=o.x,C.y=o.y,C.z=o.z,C.w=-t.dot(o,y),t.multiplyByScalar(o,s,y),t.add(v,y,y),r(C=a[3])||(C=a[3]=new n),C.x=-o.x,C.y=-o.y,C.z=-o.z,C.w=-t.dot(t.negate(o,p),y),r(C=a[4])||(C=a[4]=new n),C.x=i.x,C.y=i.y,C.z=i.z,C.w=-t.dot(i,v),t.multiplyByScalar(i,_,y),t.add(e,y,y),r(C=a[5])||(C=a[5]=new n),C.x=-i.x,C.y=-i.y,C.z=-i.z,C.w=-t.dot(t.negate(i,p),y),this._cullingVolume},l.prototype.getPixelDimensions=function(e,t,n,r){u(this);var i=(this.top-this.bottom)/t;return r.x=(this.right-this.left)/e,r.y=i,r},l.prototype.clone=function(e){return r(e)||(e=new l),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},l.prototype.equals=function(e){return r(e)&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},l}),o("Widgets/getElement",["../Core/DeveloperError"],function(e){"use strict";return function(e){return"string"==typeof e&&(e=document.getElementById(e)),e}}),o("Scene/PerformanceDisplay",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/getTimestamp","../Widgets/getElement"],function(e,t,n,r,i,o,a){"use strict";function s(e){e=t(e,t.EMPTY_OBJECT);var n=a(e.container);this._container=n;var r=document.createElement("div");r.className="cesium-performanceDisplay";var i=document.createElement("div");i.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),i.appendChild(this._fpsText);var o=document.createElement("div");o.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),o.appendChild(this._msText),r.appendChild(o),r.appendChild(i),this._container.appendChild(r),this._lastFpsSampleTime=void 0,this._frameCount=0,this._time=void 0,this._fps=0,this._frameTime=0}return s.prototype.update=function(){if(!n(this._time))return this._lastFpsSampleTime=o(),void(this._time=o());var e=this._time,t=o();this._time=t;var r=t-e;this._frameCount++;var i=this._fps,a=t-this._lastFpsSampleTime;a>1e3&&(i=1e3*this._frameCount/a|0,this._lastFpsSampleTime=t,this._frameCount=0),i!==this._fps&&(this._fpsText.nodeValue=i+" FPS",this._fps=i),r!==this._frameTime&&(this._msText.nodeValue=r.toFixed(2)+" MS",this._frameTime=r)},s.prototype.destroy=function(){return r(this)},s}),o("Scene/PickDepth",["../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/PixelFormat","../Renderer/Framebuffer","../Renderer/PixelDatatype","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/PassThrough"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(){this.framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._debugPickDepthViewportCommand=void 0}function c(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function h(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy()}return u.prototype.executeDebugPickDepth=function(t,n){var r,i,o;i=t,o=n,e((r=this)._debugPickDepthViewportCommand)||(r._debugPickDepthViewportCommand=i.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",{uniformMap:{u_texture:function(){return r._depthTexture}},owner:r})),r._debugPickDepthViewportCommand.execute(i,o)},u.prototype.update=function(t,n){var l,u,d,p,f,m,_,g,v,y,C,w,b;l=t,d=(u=n).width,p=u.height,m=!e(f=this._depthTexture)||f.width!==d||f.height!==p,e(this.framebuffer)&&!m||(C=l,w=d,b=p,c(y=this),h(y),y._depthTexture=new s({context:C,width:w,height:b,pixelFormat:r.RGBA,pixelDatatype:o.UNSIGNED_BYTE}),y.framebuffer=new i({context:C,colorTextures:[y._depthTexture],destroyAttachments:!1})),g=t,v=n,e((_=this)._copyDepthCommand)||(_._copyDepthCommand=g.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{renderState:a.fromCache(),uniformMap:{u_texture:function(){return _._textureToCopy}},owner:_})),_._textureToCopy=v,_._copyDepthCommand.framebuffer=_.framebuffer},u.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){return c(this),h(this),this._copyDepthCommand.shaderProgram=e(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy(),n(this)},u}),o("Shaders/Appearances/PointAppearanceFS",[],function(){"use strict";return"uniform vec4 highlightColor;\nvarying vec3 v_color;\nvoid main()\n{\ngl_FragColor = vec4(v_color * highlightColor.rgb, highlightColor.a);\n}\n"}),o("Shaders/Appearances/PointAppearanceVS",[],function(){"use strict";return"attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 color;\nattribute float batchId;\nuniform float pointSize;\nvarying vec3 v_positionEC;\nvarying vec3 v_color;\nvoid main()\n{\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * czm_computePosition();\ngl_PointSize = pointSize;\n}\n"}),o("Scene/PointAppearance",["../Core/clone","../Core/Color","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/VertexFormat","../Shaders/Appearances/PointAppearanceFS","../Shaders/Appearances/PointAppearanceVS","./Appearance"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(e){e=r(e,r.EMPTY_OBJECT),this._vertexShaderSource=r(e.vertexShaderSource,l),this._fragmentShaderSource=r(e.fragmentShaderSource,s),this._renderState=u.getDefaultRenderState(!1,!1,e.renderState),this._pointSize=r(e.pointSize,2),this._highlightColor=i(e.highlightColor)?e.highlightColor:new t,this.material=void 0,this.translucent=r(e.translucent,!1),this.uniforms={highlightColor:this._highlightColor,pointSize:this._pointSize},this.uniforms=n(this.uniforms,e.uniforms,!0)}return o(c.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return!1}},vertexFormat:{get:function(){return c.VERTEX_FORMAT}},pixelSize:{get:function(){return this._pointSize}}}),c.VERTEX_FORMAT=a.POSITION_AND_COLOR,c.prototype.getFragmentShaderSource=u.prototype.getFragmentShaderSource,c.prototype.isTranslucent=u.prototype.isTranslucent,c.prototype.getRenderState=u.prototype.getRenderState,c}),o("Scene/PrimitiveCollection",["../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError"],function(e,t,n,r,i,o){"use strict";function a(n){n=t(n,t.EMPTY_OBJECT),this._primitives=[],this._guid=e(),this.show=t(n.show,!0),this.destroyPrimitives=t(n.destroyPrimitives,!0)}function s(e,t){return e._primitives.indexOf(t)}return r(a.prototype,{length:{get:function(){return this._primitives.length}}}),a.prototype.add=function(e){var t=e._external=e._external||{};return(t._composites=t._composites||{})[this._guid]={collection:this},this._primitives.push(e),e},a.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},a.prototype.removeAndDestroy=function(e){var t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},a.prototype.removeAll=function(){if(this.destroyPrimitives)for(var e=this._primitives,t=e.length,n=0;n<t;++n)e[n].destroy();this._primitives=[]},a.prototype.contains=function(e){return!!(n(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},a.prototype.raise=function(e){if(n(e)){var t=s(this,e),r=this._primitives;if(t!==r.length-1){var i=r[t];r[t]=r[t+1],r[t+1]=i}}},a.prototype.raiseToTop=function(e){if(n(e)){var t=s(this,e),r=this._primitives;t!==r.length-1&&(r.splice(t,1),r.push(e))}},a.prototype.lower=function(e){if(n(e)){var t=s(this,e),r=this._primitives;if(0!==t){var i=r[t];r[t]=r[t-1],r[t-1]=i}}},a.prototype.lowerToBottom=function(e){if(n(e)){var t=s(this,e),r=this._primitives;0!==t&&(r.splice(t,1),r.unshift(e))}},a.prototype.get=function(e){return this._primitives[e]},a.prototype.update=function(e){if(this.show)for(var t=this._primitives,n=0;n<t.length;++n)t[n].update(e)},a.prototype.isDestroyed=function(){return!1},a.prototype.destroy=function(){return this.removeAll(),i(this)},a}),o("Scene/QuadtreeTileProvider",["../Core/defineProperties","../Core/DeveloperError"],function(e,t){"use strict";function n(){t.throwInstantiationError()}return n.computeDefaultLevelZeroMaximumGeometricError=function(e){return 2*e.ellipsoid.maximumRadius*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))},e(n.prototype,{quadtree:{get:t.throwInstantiationError,set:t.throwInstantiationError},ready:{get:t.throwInstantiationError},tilingScheme:{get:t.throwInstantiationError},errorEvent:{get:t.throwInstantiationError}}),n.prototype.beginUpdate=t.throwInstantiationError,n.prototype.endUpdate=t.throwInstantiationError,n.prototype.getLevelMaximumGeometricError=t.throwInstantiationError,n.prototype.loadTile=t.throwInstantiationError,n.prototype.computeTileVisibility=t.throwInstantiationError,n.prototype.showTileThisFrame=t.throwInstantiationError,n.prototype.computeDistanceToTile=t.throwInstantiationError,n.prototype.isDestroyed=t.throwInstantiationError,n.prototype.destroy=t.throwInstantiationError,n}),o("Scene/SceneTransitioner",["../Core/Cartesian3","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/EasingFunction","../Core/Ellipsoid","../Core/Math","../Core/Matrix4","../Core/Ray","../Core/ScreenSpaceEventHandler","../Core/ScreenSpaceEventType","../Core/Transforms","./Camera","./OrthographicFrustum","./PerspectiveFrustum","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g){"use strict";function v(e){this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0}function y(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new h(e._scene.canvas,!1);var n=function(){e._morphCancelled=!0,t(e)};e._completeMorph=n,e._morphHandler.setInputAction(n,d.LEFT_DOWN),e._morphHandler.setInputAction(n,d.MIDDLE_DOWN),e._morphHandler.setInputAction(n,d.RIGHT_DOWN),e._morphHandler.setInputAction(n,d.WHEEL)}}function C(e){for(var t=e._currentTweens,n=0;n<t.length;++n)t[n].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}function w(e,t){var n=e._scene,r=n.camera,i=H,o=i.position,a=i.direction,s=i.up,l=n.mapProjection.unproject(r.position,U);t.cartographicToCartesian(l,o);var c=t.scaleToGeodeticSurface(o,G),h=p.eastNorthUpToFixedFrame(c,t,W);return u.multiplyByPointAsVector(h,r.direction,a),u.multiplyByPointAsVector(h,r.up,s),i}function b(t,n,r,i){n*=.5;var o=t._scene,s=o.camera,l=e.clone(s.position,j),c=e.clone(s.direction,q),h=e.clone(s.up,Y),d=u.multiplyByPoint(f.TRANSFORM_2D_INVERSE,r.position,X),p=u.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,r.direction,Z),m=u.multiplyByPointAsVector(f.TRANSFORM_2D_INVERSE,r.up,K),_=o.tweens.add({duration:n,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){E(l,d,t.time,s.position),E(c,p,t.time,s.direction),E(h,m,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right)},complete:function(){A(t,o,0,1,n,i)}});t._currentTweens.push(_)}function E(t,n,r,i){return e.lerp(t,n,r,i)}function S(e,t,n,r,i){var o=e._scene,s=o.camera,u=s.frustum.fov,c=.5*l.RADIANS_PER_DEGREE,h=n.position.z*Math.tan(.5*u);s.frustum.far=h/Math.tan(.5*c)+1e7;var d=o.tweens.add({duration:t,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){s.frustum.fov=l.lerp(u,c,e.time);var t=h/Math.tan(.5*s.frustum.fov);r(s,t)},complete:function(){s.frustum=n.frustum.clone(),i(e)}});e._currentTweens.push(d)}function x(e,t,n,r){var i=e._scene,o=i.camera,s=o.frustum.right-o.frustum.left;o.frustum=n.frustum.clone();var u=o.frustum.fov,c=.5*l.RADIANS_PER_DEGREE,h=s*Math.tan(.5*u);o.frustum.far=h/Math.tan(.5*c)+1e7,o.frustum.fov=c;var d=i.tweens.add({duration:t,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){o.frustum.fov=l.lerp(c,u,e.time),o.position.z=h/Math.tan(.5*o.frustum.fov)},complete:function(){r(e)}});e._currentTweens.push(d)}function T(t,n,r,i){var o=t._scene,s=o.camera,l=e.clone(s.position,me),u=e.clone(s.direction,_e),c=e.clone(s.up,ge),h=e.clone(r.position2D,ve),d=e.clone(r.direction2D,ye),p=e.clone(r.up2D,Ce),f=o.tweens.add({duration:n,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){E(l,h,t.time,s.position),E(u,d,t.time,s.direction),E(c,p,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right)},complete:function(){A(t,o,1,0,n,i)}});t._currentTweens.push(f)}function A(e,t,n,i,o,s){var l={object:t,property:"morphTime",startValue:n,stopValue:i,duration:o,easingFunction:a.QUARTIC_OUT};r(s)&&(l.complete=function(){s(e)});var u=t.tweens.addProperty(l);e._currentTweens.push(u)}function P(t){return function(n){var i=n._scene;if(i._mode=g.SCENE3D,i.morphTime=g.getMorphTime(g.SCENE3D),C(n),n._previousMode!==g.MORPHING||n._morphCancelled){n._morphCancelled=!1;var o=i.camera;e.clone(t.position,o.position),e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),r(t.frustum)&&(o.frustum=t.frustum.clone())}var a=r(n._completeMorph);n._completeMorph=void 0,i.camera.update(i.mode),n._scene.morphComplete.raiseEvent(n,n._previousMode,g.SCENE3D,a)}}function D(t){return function(n){var i=n._scene;i._mode=g.SCENE2D,i.morphTime=g.getMorphTime(g.SCENE2D),C(n);var o=i.camera;e.clone(t.position,o.position),o.position.z=2*i.mapProjection.ellipsoid.maximumRadius,e.clone(t.direction,o.direction),e.clone(t.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right),o.frustum=t.frustum.clone();var a=r(n._completeMorph);n._completeMorph=void 0,i.camera.update(i.mode),n._scene.morphComplete.raiseEvent(n,n._previousMode,g.SCENE2D,a)}}v.prototype.completeMorph=function(){r(this._completeMorph)&&this._completeMorph()},v.prototype.morphTo2D=function(t,n){r(this._completeMorph)&&this._completeMorph();var i=this._scene;this._previousMode=i.mode,this._previousMode!==g.SCENE2D&&this._previousMode!==g.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,g.SCENE2D,!0),i._mode=g.MORPHING,i.camera._setTransform(u.IDENTITY),this._previousMode===g.COLUMBUS_VIEW?function(t,n){function i(e,t){e.position.z=t}n*=.5;var o=t._scene,s=o.camera,l=e.clone(s.position,J),c=e.clone(s.direction,$),h=e.clone(s.up,ee),d=e.negate(e.UNIT_Z,ne),p=e.clone(e.UNIT_Y,re),m=te;if(n>0)e.clone(e.ZERO,te),m.z=5*o.mapProjection.ellipsoid.maximumRadius;else{e.clone(l,te);var _=oe;u.multiplyByPoint(f.TRANSFORM_2D,l,_.origin),u.multiplyByPointAsVector(f.TRANSFORM_2D,c,_.direction);var g=o.globe;if(r(g)){var v=g.pick(_,o,ae);r(v)&&(u.multiplyByPoint(f.TRANSFORM_2D_INVERSE,v,m),m.z+=e.distance(l,m))}}var C=ie;C.right=.5*m.z,C.left=-C.right,C.top=C.right*(o.drawingBufferHeight/o.drawingBufferWidth),C.bottom=-C.top;var w=se;w.position=m,w.direction=d,w.up=p,w.frustum=C;var b=D(w);y(t,b);var x=o.tweens.add({duration:n,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){E(l,m,t.time,s.position),E(c,d,t.time,s.direction),E(h,p,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right)},complete:function(){S(t,n,w,i,b)}});t._currentTweens.push(x)}(this,t):function(t,n,i){function o(e,t){e.position.x=t}var a=t._scene,s=a.camera,l=ue;if((n*=.5)>0)e.clone(e.ZERO,l.position),l.position.z=5*i.maximumRadius,e.negate(e.UNIT_Z,l.direction),e.clone(e.UNIT_Y,l.up);else{i.cartesianToCartographic(s.positionWC,le),a.mapProjection.project(le,l.position),e.negate(e.UNIT_Z,l.direction),e.clone(e.UNIT_Y,l.up);var c=de;e.clone(l.position2D,c.origin);var h=e.clone(s.directionWC,c.direction),d=i.scaleToGeodeticSurface(s.positionWC,fe),m=p.eastNorthUpToFixedFrame(d,i,pe);u.inverseTransformation(m,m),u.multiplyByPointAsVector(m,h,h),u.multiplyByPointAsVector(f.TRANSFORM_2D,h,h);var _=a.globe;if(r(_)){var g=_.pick(c,a,he);if(r(g)){var v=e.distance(l.position2D,g);g.x+=v,e.clone(g,l.position2D)}}}u.multiplyByPoint(f.TRANSFORM_2D,l.position,l.position2D),u.multiplyByPointAsVector(f.TRANSFORM_2D,l.direction,l.direction2D),u.multiplyByPointAsVector(f.TRANSFORM_2D,l.up,l.up2D);var C=l.frustum;C.right=.5*l.position.z,C.left=-C.right,C.top=C.right*(a.drawingBufferHeight/a.drawingBufferWidth),C.bottom=-C.top;var w=ce;u.multiplyByPoint(f.TRANSFORM_2D_INVERSE,l.position2D,w.position),e.clone(l.direction,w.direction),e.clone(l.up,w.up),w.frustum=C;var b=D(w);y(t,b),T(t,n,l,function(){S(t,n,l,o,b)})}(this,t,n),0===t&&r(this._completeMorph)&&this._completeMorph())};var M=new e,I=new e,O=new e,R=new e,N=new e,L=new e,F=new e,B=new t,k=new u,V=new _,z={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};v.prototype.morphToColumbusView=function(t,n){r(this._completeMorph)&&this._completeMorph();var i,o=this._scene;if(this._previousMode=o.mode,this._previousMode!==g.COLUMBUS_VIEW&&this._previousMode!==g.MORPHING){this._scene.morphStart.raiseEvent(this,this._previousMode,g.COLUMBUS_VIEW,!0),o.camera._setTransform(u.IDENTITY);var s=M,c=I,h=O;if(t>0)s.x=0,s.y=0,s.z=5*n.maximumRadius,e.negate(e.UNIT_Z,c),e.clone(e.UNIT_Y,h);else{var d=o.camera;if(this._previousMode===g.SCENE2D)e.clone(d.position,s),s.z=d.frustum.right-d.frustum.left,e.negate(e.UNIT_Z,c),e.clone(e.UNIT_Y,h);else{e.clone(d.positionWC,s),e.clone(d.directionWC,c),e.clone(d.upWC,h);var m=n.scaleToGeodeticSurface(s,F),_=p.eastNorthUpToFixedFrame(m,n,k);u.inverseTransformation(_,_),o.mapProjection.project(n.cartesianToCartographic(s,B),s),u.multiplyByPointAsVector(_,c,c),u.multiplyByPointAsVector(_,h,h)}}var v=V;v.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,v.fov=l.toRadians(60);var w=z;w.position=s,w.direction=c,w.up=h,w.frustum=v;var b=(i=w,function(t){var n=t._scene;if(n._mode=g.COLUMBUS_VIEW,n.morphTime=g.getMorphTime(g.COLUMBUS_VIEW),C(t),n.camera.frustum=i.frustum.clone(),t._previousModeMode!==g.MORPHING||t._morphCancelled){t._morphCancelled=!1;var o=n.camera;e.clone(i.position,o.position),e.clone(i.direction,o.direction),e.clone(i.up,o.up),e.cross(o.direction,o.up,o.right),e.normalize(o.right,o.right)}var a=r(t._completeMorph);t._completeMorph=void 0,n.camera.update(n.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,g.COLUMBUS_VIEW,a)});y(this,b),this._previousMode===g.SCENE2D?function(t,n,r,i){n*=.5;var o=t._scene,s=o.camera,u=e.clone(s.position,me),c=e.clone(s.direction,_e),h=e.clone(s.up,ge),d=e.clone(r.position,ve),p=e.clone(r.direction,ye),f=e.clone(r.up,Ce),m=s.frustum.right,_=.5*d.z,v=o.tweens.add({duration:n,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){E(u,d,t.time,s.position),E(c,p,t.time,s.direction),E(h,f,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right);var n=s.frustum;n.right=l.lerp(m,_,t.time),n.left=-n.right,n.top=n.right*(o.drawingBufferHeight/o.drawingBufferWidth),n.bottom=-n.top,s.position.z=2*o.mapProjection.ellipsoid.maximumRadius},complete:function(){o._mode=g.MORPHING,x(t,n,r,i)}});t._currentTweens.push(v)}(this,t,w,b):(w.position2D=u.multiplyByPoint(f.TRANSFORM_2D,s,R),w.direction2D=u.multiplyByPointAsVector(f.TRANSFORM_2D,c,N),w.up2D=u.multiplyByPointAsVector(f.TRANSFORM_2D,h,L),o._mode=g.MORPHING,T(this,t,w,b)),0===t&&r(this._completeMorph)&&this._completeMorph()}},v.prototype.morphTo3D=function(t,n){r(this._completeMorph)&&this._completeMorph();var i=this._scene;if(this._previousMode=i.mode,this._previousMode!==g.SCENE3D&&this._previousMode!==g.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,g.SCENE3D,!0),i._mode=g.MORPHING,i.camera._setTransform(u.IDENTITY),this._previousMode===g.SCENE2D)!function(t,n,r){n/=3;var i,o=t._scene,s=o.camera,u=Q;u.aspectRatio=o.drawingBufferWidth/o.drawingBufferHeight,u.fov=l.toRadians(60),n>0?(e.fromDegrees(0,0,5*r.maximumRadius,r,(i=H).position),e.negate(i.position,i.direction),e.normalize(i.direction,i.direction),e.clone(e.UNIT_Z,i.up)):(s.position.z=s.frustum.right-s.frustum.left,i=w(t,r)),i.frustum=u;var c=P(i);y(t,c);var h=e.clone(s.position,me),d=e.clone(s.direction,_e),p=e.clone(s.up,ge),f=e.fromElements(0,0,5*r.maximumRadius,ve),m=e.negate(e.UNIT_Z,ye),_=e.clone(e.UNIT_Y,Ce),v=s.frustum.right,C=.5*f.z;if(n>0){var S=o.tweens.add({duration:n,easingFunction:a.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(t){E(h,f,t.time,s.position),E(d,m,t.time,s.direction),E(p,_,t.time,s.up),e.cross(s.direction,s.up,s.right),e.normalize(s.right,s.right);var n=s.frustum;n.right=l.lerp(v,C,t.time),n.left=-n.right,n.top=n.right*(o.drawingBufferHeight/o.drawingBufferWidth),n.bottom=-n.top,s.position.z=2*o.mapProjection.ellipsoid.maximumRadius},complete:function(){o._mode=g.MORPHING,x(t,n,i,function(){b(t,n,i,c)})}});t._currentTweens.push(S)}else x(t,n,i,function(){b(t,n,i,c)})}(this,t,n);else{var o;t>0?(e.fromDegrees(0,0,5*n.maximumRadius,n,(o=H).position),e.negate(o.position,o.direction),e.normalize(o.direction,o.direction),e.clone(e.UNIT_Z,o.up)):o=w(this,n);var s=P(o);y(this,s),b(this,t,o,s)}0===t&&r(this._completeMorph)&&this._completeMorph()}},v.prototype.isDestroyed=function(){return!1},v.prototype.destroy=function(){return C(this),i(this)};var U=new t,G=new e,W=new u,H={position:new e,direction:new e,up:new e,frustum:void 0},j=new e,q=new e,Y=new e,X=new e,Z=new e,K=new e,Q=new _,J=new e,$=new e,ee=new e,te=new e,ne=new e,re=new e,ie=new m,oe=new c,ae=new e,se={position:void 0,direction:void 0,up:void 0,frustum:void 0},le=new t,ue={position:new e,direction:new e,up:new e,position2D:new e,direction2D:new e,up2D:new e,frustum:new m},ce={position:new e,direction:new e,up:new e,frustum:void 0},he=new e,de=new c,pe=new u,fe=new e,me=new e,_e=new e,ge=new e,ve=new e,ye=new e,Ce=new e;return v}),o("Scene/TweenCollection",["../Core/clone","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/EasingFunction","../Core/getTimestamp","../Core/TimeConstants","../ThirdParty/Tween"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t,n,r,i,o,a,s,l,u,c){this._tweens=t,this._tweenjs=n,this._startObject=e(r),this._stopObject=e(i),this._duration=o,this._delay=a,this._easingFunction=s,this._update=l,this._complete=u,this.cancel=c,this.needsStart=!0}function c(){this._tweens=[]}return r(u.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),u.prototype.cancelTween=function(){this._tweens.remove(this)},r(c.prototype,{length:{get:function(){return this._tweens.length}}}),c.prototype.add=function(r){if(0===(r=t(r,t.EMPTY_OBJECT)).duration)return n(r.complete)&&r.complete(),new u(this);var i=r.duration/s.SECONDS_PER_MILLISECOND,a=t(r.delay,0),c=a/s.SECONDS_PER_MILLISECOND,h=t(r.easingFunction,o.LINEAR_NONE),d=r.startObject,p=new l.Tween(d);p.to(e(r.stopObject),i),p.delay(c),p.easing(h),n(r.update)&&p.onUpdate(function(){r.update(d)}),p.onComplete(t(r.complete,null)),p.repeat(t(r._repeat,0));var f=new u(this,p,r.startObject,r.stopObject,r.duration,a,h,r.update,r.complete,r.cancel);return this._tweens.push(f),f},c.prototype.addProperty=function(e){var n=(e=t(e,t.EMPTY_OBJECT)).object,r=e.property;return this.add({startObject:{value:e.startValue},stopObject:{value:e.stopValue},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){n[r]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},c.prototype.addAlpha=function(e){var r=(e=t(e,t.EMPTY_OBJECT)).material,i=[];for(var o in r.uniforms)r.uniforms.hasOwnProperty(o)&&n(r.uniforms[o])&&n(r.uniforms[o].alpha)&&i.push(o);return this.add({startObject:{alpha:t(e.startValue,0)},stopObject:{alpha:t(e.stopValue,1)},duration:t(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){for(var t=i.length,n=0;n<t;++n)r.uniforms[i[n]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},c.prototype.addOffsetIncrement=function(e){var n=(e=t(e,t.EMPTY_OBJECT)).material.uniforms;return this.addProperty({object:n,property:"offset",startValue:n.offset,stopValue:n.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},c.prototype.remove=function(e){if(!n(e))return!1;var t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),n(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},c.prototype.removeAll=function(){for(var e=this._tweens,t=0;t<e.length;++t){var r=e[t];r.tweenjs.stop(),n(r.cancel)&&r.cancel()}e.length=0},c.prototype.contains=function(e){return n(e)&&-1!==this._tweens.indexOf(e)},c.prototype.get=function(e){return this._tweens[e]},c.prototype.update=function(e){var t=this._tweens,r=0;for(e=n(e)?e/s.SECONDS_PER_MILLISECOND:a();r<t.length;){var i=t[r],o=i.tweenjs;i.needsStart?(i.needsStart=!1,o.start(e)):o.update(e)?r++:(o.stop(),t.splice(r,1))}},c}),o("Scene/ScreenSpaceCameraController",["../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/Ellipsoid","../Core/IntersectionTests","../Core/isArray","../Core/KeyboardEventModifier","../Core/Math","../Core/Matrix3","../Core/Matrix4","../Core/Plane","../Core/Quaternion","../Core/Ray","../Core/Transforms","./CameraEventAggregator","./CameraEventType","./MapMode2D","./SceneMode","./SceneTransforms","./TweenCollection"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S){"use strict";function x(n){this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=C.LEFT_DRAG,this.zoomEventTypes=[C.RIGHT_DRAG,C.WHEEL,C.PINCH],this.rotateEventTypes=C.LEFT_DRAG,this.tiltEventTypes=[C.MIDDLE_DRAG,C.PINCH,{eventType:C.LEFT_DRAG,modifier:h.CTRL},{eventType:C.RIGHT_DRAG,modifier:h.CTRL}],this.lookEventTypes={eventType:C.LEFT_DRAG,modifier:h.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=n,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new y(n.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._tweens=new S,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new e(-1,-1),this._tiltCenter=new t,this._rotateMousePosition=new e(-1,-1),this._rotateStartPosition=new t,this._strafeStartPosition=new t,this._zoomMouseStart=new e(-1,-1),this._zoomWorldPosition=new t,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._rotatingZoom=!1,this._maxCoord=n.mapProjection.project(new r(Math.PI,d.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3}function T(t,n,r,i,a,s,l){var u=s[l];o(u)||(u=s[l]={startPosition:new e,endPosition:new e,motion:new e,active:!1});var c,h,p=t.getButtonPressTime(n,r),f=t.getButtonReleaseTime(n,r),m=p&&f&&(f.getTime()-p.getTime())/1e3,_=new Date,g=f&&(_.getTime()-f.getTime())/1e3;if(p&&f&&m<W){var v=(h=g)<0?0:Math.exp(-25*(1-i)*h);if(u.active)u.startPosition=e.clone(u.endPosition,u.startPosition),u.endPosition=e.multiplyByScalar(u.motion,v,u.endPosition),u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition),u.motion=e.clone(e.ZERO,u.motion);else{var y=t.getLastMovement(n,r);if(!o(y)||e.equalsEpsilon((c=y).startPosition,c.endPosition,d.EPSILON14))return;u.motion.x=.5*(y.endPosition.x-y.startPosition.x),u.motion.y=.5*(y.endPosition.y-y.startPosition.y),u.startPosition=e.clone(y.startPosition,u.startPosition),u.endPosition=e.multiplyByScalar(u.motion,v,u.endPosition),u.endPosition=e.add(u.startPosition,u.endPosition,u.endPosition),u.active=!0}if(isNaN(u.endPosition.x)||isNaN(u.endPosition.y)||e.distance(u.startPosition,u.endPosition)<.5)return void(u.active=!1);t.isButtonDown(n,r)||a(s,t.getStartMousePosition(n,r),u)}else u.active=!1}function A(e,t,n,r,i,a){if(o(n)){var s=e._aggregator;c(n)||(H[0]=n,n=H);for(var l=n.length,u=0;u<l;++u){var h=n[u],d=o(h.eventType)?h.eventType:h,p=h.modifier,f=s.isMoving(d,p)&&s.getMovement(d,p),m=s.getStartMousePosition(d,p);e.enableInputs&&t&&(f?r(e,m,f):i<1&&T(s,d,p,i,r,e,a))}}}function P(n,r,i,a,s,l){var u=1;o(l)&&(u=d.clamp(Math.abs(l),.25,1));var c=n.minimumZoomDistance*u,h=n.maximumZoomDistance,p=a*(s-c);p=d.clamp(p,n._minimumZoomRate,n._maximumZoomRate);var f=(i.endPosition.y-i.startPosition.y)/n._scene.canvas.clientHeight,m=p*(f=Math.min(f,n.maximumMovementRatio));if(!(m>0&&Math.abs(s-c)<1||m<0&&Math.abs(s-h)<1)){s-m<c?m=s-c-1:s-m>h&&(m=s-h);var _,g=n._scene,v=g.camera,y=g.mode,C=e.equals(r,n._zoomMouseStart),w=n._zoomingOnVector,S=n._rotatingZoom;if(C||(n._zoomMouseStart=e.clone(r,n._zoomMouseStart),o(n._globe)&&(_=y!==b.SCENE2D?O(n,r,q):v.getPickRay(r,j).origin),o(_)?(n._useZoomWorldPosition=!0,n._zoomWorldPosition=t.clone(_,n._zoomWorldPosition)):n._useZoomWorldPosition=!1,w=n._zoomingOnVector=!1,S=n._rotatingZoom=!1),!n._useZoomWorldPosition)return void v.zoomIn(m);var x=y===b.COLUMBUS_VIEW;if(v.positionCartographic.height<2e6&&(S=!0),!C||S){if(y===b.SCENE2D){var T=n._zoomWorldPosition,A=v.position;if(!t.equals(T,A)&&v.positionCartographic.height<2*n._maxCoord.x){var P=v.position.x,D=t.subtract(T,A,X);t.normalize(D,D);var M=t.distance(T,A)*m/(.5*v.getMagnitude());v.move(D,.5*M),(v.position.x<0&&P>0||v.position.x>0&&P<0)&&(_=v.getPickRay(r,j).origin,n._zoomWorldPosition=t.clone(_,n._zoomWorldPosition))}}else if(y===b.SCENE3D){var I=t.normalize(v.position,ee);if(v.positionCartographic.height<3e3&&Math.abs(t.dot(v.direction,I))<.6)x=!0;else{var R=g.canvas,N=Z;N.x=R.clientWidth/2,N.y=R.clientHeight/2;var L=O(n,N,K);if(o(L)&&v.positionCartographic.height<1e6){var F=ne;t.clone(v.position,F);var B=n._zoomWorldPosition,k=te;if(k=t.normalize(B,k),t.dot(k,I)<0)return;var V=ce,z=oe;t.clone(v.direction,z),t.add(F,t.multiplyByScalar(z,1e3,he),V);var U=ae,G=se;t.subtract(B,F,U),t.normalize(U,G);var W=Math.acos(-t.dot(I,G)),H=t.magnitude(F),fe=t.magnitude(B),me=H-m,_e=t.magnitude(U),ge=Math.asin(d.clamp(_e/fe*Math.sin(W),-1,1))-Math.asin(d.clamp(me/fe*Math.sin(W),-1,1))+W,ve=re;t.normalize(F,ve);var ye=ie;ye=t.cross(G,ve,ye),ye=t.normalize(ye,ye),t.normalize(t.cross(ve,ye,he),z),t.multiplyByScalar(t.normalize(V,he),t.magnitude(V)-m,V),t.normalize(F,F),t.multiplyByScalar(F,me,F);var Ce=le;t.multiplyByScalar(t.add(t.multiplyByScalar(ve,Math.cos(ge)-1,de),t.multiplyByScalar(z,Math.sin(ge),pe),he),me,Ce),t.add(F,Ce,F),t.normalize(V,ve),t.normalize(t.cross(ve,ye,he),z);var we=ue;return t.multiplyByScalar(t.add(t.multiplyByScalar(ve,Math.cos(ge)-1,de),t.multiplyByScalar(z,Math.sin(ge),pe),he),t.magnitude(V),we),t.add(V,we,V),t.clone(F,v.position),t.normalize(t.subtract(V,F,he),v.direction),t.clone(v.direction,v.direction),t.cross(v.direction,v.up,v.right),void t.cross(v.right,v.direction,v.up)}if(o(L)){var be=t.normalize(L,Q),Ee=t.normalize(n._zoomWorldPosition,J),Se=t.dot(Ee,be);if(Se>0&&Se<1){var xe=d.acosClamped(Se),Te=t.cross(Ee,be,$),Ae=Math.abs(xe)>d.toRadians(20)?.75*v.positionCartographic.height:v.positionCartographic.height-m;v.rotate(Te,xe*(m/Ae))}}else x=!0}}n._rotatingZoom=!x}if(!C&&x||w){var Pe=E.wgs84ToWindowCoordinates(g,n._zoomWorldPosition,Y),De=(y!==b.COLUMBUS_VIEW&&e.equals(r,n._zoomMouseStart)&&o(Pe)?v.getPickRay(Pe,j):v.getPickRay(r,j)).direction;y===b.COLUMBUS_VIEW&&t.fromElements(De.y,De.z,De.x,De),v.move(De,m),n._zoomingOnVector=!0}else v.zoomIn(m)}}function D(e,n,r){var i=e._scene.camera,o=i.getPickRay(r.startPosition,fe).origin,a=i.getPickRay(r.endPosition,me).origin,s=t.subtract(o,a,_e),l=t.magnitude(s);l>0&&(t.normalize(s,s),i.move(s,l))}function M(e,t,n){o(n.distance)&&(n=n.distance),P(e,t,n,e._zoomFactor,e._scene.camera.getMagnitude())}function I(t,n,r){if(o(r.angleAndHeight))!function(e,n,r){var i=t._rotateFactor*t._rotateRateRangeAdjustment;i>t._maximumRotateRate&&(i=t._maximumRotateRate),i<t._minimumRotateRate&&(i=t._minimumRotateRate);var o=t._scene,a=o.camera,s=(r.endPosition.x-r.startPosition.x)/o.canvas.clientWidth,l=i*(s=Math.min(s,t.maximumMovementRatio))*Math.PI*4;a.twistRight(l)}(0,0,r.angleAndHeight);else{var i=t._scene,a=i.camera,s=i.canvas,l=s.clientWidth,u=s.clientHeight,c=ge;c.x=2/l*r.startPosition.x-1,c.y=2/u*(u-r.startPosition.y)-1,c=e.normalize(c,c);var h=ve;h.x=2/l*r.endPosition.x-1,h.y=2/u*(u-r.endPosition.y)-1,h=e.normalize(h,h);var p=d.acosClamped(c.x);c.y<0&&(p=d.TWO_PI-p);var f=d.acosClamped(h.x);h.y<0&&(f=d.TWO_PI-f),a.twistRight(f-p)}}function O(e,n,r){var i=e._scene,a=e._globe,s=i.camera;if(o(a)){var l;i.pickPositionSupported&&(l=i.pickPosition(n,Ce));var u=s.getPickRay(n,ye),c=a.pick(u,i,we),h=o(l)?t.distance(l,s.positionWC):Number.POSITIVE_INFINITY,d=o(c)?t.distance(c,s.positionWC):Number.POSITIVE_INFINITY;return t.clone(h<d?l:c,r)}}function R(n,r,i){if(t.equals(r,n._translateMousePosition)||(n._looking=!1),t.equals(r,n._strafeMousePosition)||(n._strafing=!1),n._looking)G(n,0,i);else if(n._strafing)F(n,0,i);else{var a,s=n._scene.camera,l=e.clone(i.startPosition,De),c=e.clone(i.endPosition,Me),h=s.getPickRay(l,be),p=t.clone(t.ZERO,Ae),f=t.UNIT_X;if(s.position.z<n._minimumPickingTerrainHeight&&(a=O(n,l,Se),o(a)&&(p.x=a.x)),p.x>s.position.z&&o(a))return t.clone(a,n._strafeStartPosition),n._strafing=!0,F(n,0,i),void(n._strafeMousePosition=e.clone(r,n._strafeMousePosition));var _=m.fromPointNormal(p,f,Pe);h=s.getPickRay(l,be);var g=u.rayPlane(h,_,Se),v=s.getPickRay(c,Ee),y=u.rayPlane(v,_,xe);if(!o(g)||!o(y))return n._looking=!0,G(n,0,i),void e.clone(r,n._translateMousePosition);var C=t.subtract(g,y,Te),w=C.x;C.x=C.y,C.y=C.z,C.z=w;var b=t.magnitude(C);b>d.EPSILON6&&(t.normalize(C,C),s.move(C,b))}}function N(n,r,i){if(o(i.angleAndHeight)&&(i=i.angleAndHeight),e.equals(r,n._tiltCenterMousePosition)||(n._tiltCVOffMap=!1,n._looking=!1),n._looking)G(n,0,i);else{var a=n._scene.camera,s=n._maxCoord,c=Math.abs(a.position.x)-s.x<0&&Math.abs(a.position.y)-s.y<0;n._tiltCVOffMap||!c||a.position.z>n._minimumPickingTerrainHeight?(n._tiltCVOffMap=!0,function(n,r,i){var a=n._scene,s=a.camera,u=a.canvas,c=Ie;c.x=u.clientWidth/2,c.y=u.clientHeight/2;var h,p=s.getPickRay(c,Oe),m=t.UNIT_X,_=p.origin,g=p.direction,y=t.dot(m,g);if(Math.abs(y)>d.EPSILON6&&(h=-t.dot(m,_)/y),!o(h)||h<=0)return n._looking=!0,G(n,0,i),void e.clone(r,n._tiltCenterMousePosition);var C=t.multiplyByScalar(g,h,Re);t.add(_,C,C);var w=a.mapProjection,b=w.ellipsoid;t.fromElements(C.y,C.z,C.x,C);var E=w.unproject(C,ze);b.cartographicToCartesian(E,C);var S=v.eastNorthUpToFixedFrame(C,b,Le),x=n._globe,T=n._ellipsoid;n._globe=void 0,n._ellipsoid=l.UNIT_SPHERE,n._rotateFactor=1,n._rotateRateRangeAdjustment=1;var A=f.clone(s.transform,Ue);s._setTransform(S),k(n,0,i,t.UNIT_Z),s._setTransform(A),n._globe=x,n._ellipsoid=T;var P=T.maximumRadius;n._rotateFactor=1/P,n._rotateRateRangeAdjustment=P}(n,r,i)):function(n,r,i){var a,s,c=n._scene,h=c.camera,g=t.UNIT_X;if(e.equals(r,n._tiltCenterMousePosition))a=t.clone(n._tiltCenter,Re);else{if(h.position.z<n._minimumPickingTerrainHeight&&(a=O(n,r,Re)),!o(a)){var y,C=(s=h.getPickRay(r,Oe)).origin,w=s.direction,b=t.dot(g,w);if(Math.abs(b)>d.EPSILON6&&(y=-t.dot(g,C)/b),!o(y)||y<=0)return n._looking=!0,G(n,0,i),void e.clone(r,n._tiltCenterMousePosition);a=t.multiplyByScalar(w,y,Re),t.add(C,a,a)}e.clone(r,n._tiltCenterMousePosition),t.clone(a,n._tiltCenter)}var E=Ie;E.x=c.canvas.clientWidth/2,E.y=n._tiltCenterMousePosition.y,s=h.getPickRay(E,Oe);var S=t.clone(t.ZERO,Be);S.x=a.x;var x=m.fromPointNormal(S,g,ke),T=u.rayPlane(s,x,Ne),A=h._projection,P=A.ellipsoid;t.fromElements(a.y,a.z,a.x,a);var D=A.unproject(a,ze);P.cartographicToCartesian(D,a);var M,I=v.eastNorthUpToFixedFrame(a,P,Le);o(T)?(t.fromElements(T.y,T.z,T.x,T),D=A.unproject(T,ze),P.cartographicToCartesian(D,T),M=v.eastNorthUpToFixedFrame(T,P,Fe)):M=I;var R=n._globe,N=n._ellipsoid;n._globe=void 0,n._ellipsoid=l.UNIT_SPHERE,n._rotateFactor=1,n._rotateRateRangeAdjustment=1;var L=t.UNIT_Z,F=f.clone(h.transform,Ue);h._setTransform(I);var B=t.cross(t.UNIT_Z,t.normalize(h.position,Ve),Ve),V=t.dot(h.right,B);if(k(n,0,i,L,!1,!0),h._setTransform(M),V<0){i.startPosition.y>i.endPosition.y&&(L=void 0);var z=h.constrainedAxis;h.constrainedAxis=void 0,k(n,0,i,L,!0,!1),h.constrainedAxis=z}else k(n,0,i,L,!0,!1);if(o(h.constrainedAxis)){var U=t.cross(h.direction,h.constrainedAxis,yt);t.equalsEpsilon(U,t.ZERO,d.EPSILON6)||(t.dot(U,h.right)<0&&t.negate(U,U),t.cross(U,h.direction,h.up),t.cross(h.direction,h.up,h.right),t.normalize(h.up,h.up),t.normalize(h.right,h.right))}h._setTransform(F),n._globe=R,n._ellipsoid=N;var W=N.maximumRadius;n._rotateFactor=1/W,n._rotateRateRangeAdjustment=W;var H=t.clone(h.positionWC,Ve);if(h._adjustHeightForTerrain(),!t.equals(h.positionWC,H)){h._setTransform(M),h.worldToCameraCoordinatesPoint(H,H);var j=t.magnitudeSquared(H);t.magnitudeSquared(h.position)>j&&(t.normalize(h.position,h.position),t.multiplyByScalar(h.position,Math.sqrt(j),h.position));var q=t.angleBetween(H,h.position),Y=t.cross(H,h.position,H);t.normalize(Y,Y);var X=_.fromAxisAngle(Y,q,Ge),Z=p.fromQuaternion(X,We);p.multiplyByVector(Z,h.direction,h.direction),p.multiplyByVector(Z,h.up,h.up),t.cross(h.direction,h.up,h.right),t.cross(h.right,h.direction,h.up),h._setTransform(F)}}(n,r,i)}}function L(e,n,r){o(r.distance)&&(r=r.distance);var i=e._scene,a=i.camera,s=i.canvas,l=He;l.x=s.clientWidth/2,l.y=s.clientHeight/2;var u,c,h=a.getPickRay(l,je);if(a.position.z<e._minimumPickingTerrainHeight&&(u=O(e,l,qe)),o(u))c=t.distance(h.origin,u);else{var d=t.UNIT_X,p=h.direction;c=-t.dot(d,h.origin)/t.dot(d,p)}P(e,n,r,e._zoomFactor,c)}function F(e,n,r){var i=e._scene,a=i.camera,s=O(e,r.startPosition,$e);if(o(s)){var l=a.getPickRay(r.endPosition,Ye),c=t.clone(a.direction,Ke);i.mode===b.COLUMBUS_VIEW&&t.fromElements(c.z,c.x,c.y,c);var h=m.fromPointNormal(s,c,Xe),d=u.rayPlane(l,h,Ze);o(d)&&(c=t.subtract(s,d,c),i.mode===b.COLUMBUS_VIEW&&t.fromElements(c.y,c.z,c.x,c),t.add(a.position,c,a.position))}}function B(n,r,i){var a=n._scene.camera;if(f.equals(a.transform,f.IDENTITY)){var s,u,c,h,d=n._ellipsoid.geodeticSurfaceNormal(a.position,nt),p=n._ellipsoid.cartesianToCartographic(a.positionWC,Je).height,m=n._globe;if(o(m)&&p<n._minimumPickingTerrainHeight&&(h=O(n,i.startPosition,$e),o(h))){var _=a.getPickRay(i.startPosition,ye),g=n._ellipsoid.geodeticSurfaceNormal(h);Math.abs(t.dot(_.direction,g))<.05&&!n._looking&&(n._rotating=!1,n._strafing=!0)}return e.equals(r,n._rotateMousePosition)?void(n._looking?G(n,0,i,d):n._rotating?k(n,0,i):n._strafing?(t.clone(h,n._strafeStartPosition),F(n,0,i)):(s=t.magnitude(n._rotateStartPosition),u=et,u.x=u.y=u.z=s,c=l.fromCartesian3(u,tt),V(n,0,i,c))):(n._looking=!1,n._rotating=!1,n._strafing=!1,o(m)&&p<n._minimumPickingTerrainHeight?o(h)?t.magnitude(a.position)<t.magnitude(h)?(t.clone(h,n._strafeStartPosition),n._strafing=!0,F(n,0,i)):(s=t.magnitude(h),(u=et).x=u.y=u.z=s,V(n,0,i,c=l.fromCartesian3(u,tt)),t.clone(h,n._rotateStartPosition)):(n._looking=!0,G(n,0,i,d)):o(a.pickEllipsoid(i.startPosition,n._ellipsoid,Qe))?(V(n,0,i,n._ellipsoid),t.clone(Qe,n._rotateStartPosition)):p>n._minimumTrackBallHeight?(n._rotating=!0,k(n,0,i)):(n._looking=!0,G(n,0,i,d)),void e.clone(r,n._rotateMousePosition))}k(n,0,i)}function k(e,n,r,a,s,l){s=i(s,!1),l=i(l,!1);var u=e._scene,c=u.camera,h=u.canvas,d=c.constrainedAxis;o(a)&&(c.constrainedAxis=a);var p=t.magnitude(c.position),f=e._rotateFactor*(p-e._rotateRateRangeAdjustment);f>e._maximumRotateRate&&(f=e._maximumRotateRate),f<e._minimumRotateRate&&(f=e._minimumRotateRate);var m=(r.startPosition.x-r.endPosition.x)/h.clientWidth,_=(r.startPosition.y-r.endPosition.y)/h.clientHeight;m=Math.min(m,e.maximumMovementRatio),_=Math.min(_,e.maximumMovementRatio);var g=f*m*Math.PI*2,v=f*_*Math.PI;s||c.rotateRight(g),l||c.rotateUp(v),c.constrainedAxis=d}function V(n,r,i,a){var s=n._scene.camera,l=e.clone(i.startPosition,ut),u=e.clone(i.endPosition,ct),c=s.pickEllipsoid(l,a,rt),h=s.pickEllipsoid(u,a,it);if(!o(c)||!o(h))return n._rotating=!0,void k(n,0,i);if(c=s.worldToCameraCoordinates(c,c),h=s.worldToCameraCoordinates(h,h),o(s.constrainedAxis)){var p=s.constrainedAxis,f=t.mostOrthogonalAxis(p,ot);t.cross(f,p,f),t.normalize(f,f);var m=t.cross(p,f,at),_=t.magnitude(c),g=t.dot(p,c),v=Math.acos(g/_),y=t.multiplyByScalar(p,g,st);t.subtract(c,y,y),t.normalize(y,y);var C=t.magnitude(h),w=t.dot(p,h),b=Math.acos(w/C),E=t.multiplyByScalar(p,w,lt);t.subtract(h,E,E),t.normalize(E,E);var S=Math.acos(t.dot(y,f));t.dot(y,m)<0&&(S=d.TWO_PI-S);var x=Math.acos(t.dot(E,f));t.dot(E,m)<0&&(x=d.TWO_PI-x);var T,A=S-x;T=t.equalsEpsilon(p,s.position,d.EPSILON2)?s.right:t.cross(p,s.position,ot);var P,D=t.cross(p,T,ot),M=t.dot(D,t.subtract(c,p,at)),I=t.dot(D,t.subtract(h,p,at));P=M>0&&I>0?b-v:M>0&&I<=0?t.dot(s.position,p)>0?-v-b:v+b:v-b,s.rotateRight(A),s.rotateUp(P)}else{t.normalize(c,c),t.normalize(h,h);var O=t.dot(c,h),R=t.cross(c,h,ot);if(O<1&&!t.equalsEpsilon(R,t.ZERO,d.EPSILON14)){var N=Math.acos(O);s.rotate(R,N)}}}function z(e,n,r){o(r.distance)&&(r=r.distance);var i=e._ellipsoid,a=e._scene,s=a.camera,l=a.canvas,u=He;u.x=l.clientWidth/2,u.y=l.clientHeight/2;var c,h,d=s.getPickRay(u,je),p=i.cartesianToCartographic(s.position,dt).height;p<e._minimumPickingTerrainHeight&&(c=O(e,u,qe)),h=o(c)?t.distance(d.origin,c):p;var f=t.normalize(s.position,ht);P(e,n,r,e._zoomFactor,h,t.dot(f,s.direction))}function U(n,r,i){var a=n._scene.camera;if(f.equals(a.transform,f.IDENTITY)){if(o(i.angleAndHeight)&&(i=i.angleAndHeight),e.equals(r,n._tiltCenterMousePosition)||(n._tiltOnEllipsoid=!1,n._looking=!1),n._looking)return void G(n,0,i,n._ellipsoid.geodeticSurfaceNormal(a.position,St));var s=n._ellipsoid.cartesianToCartographic(a.position,Et);n._tiltOnEllipsoid||s.height>n._minimumCollisionTerrainHeight?(n._tiltOnEllipsoid=!0,function(n,r,i){var a=n._ellipsoid,s=n._scene,c=s.camera,h=.25*n.minimumZoomDistance,p=a.cartesianToCartographic(c.positionWC,xt).height;if(!(p-h-1<d.EPSILON3&&i.endPosition.y-i.startPosition.y<0)){var m=s.canvas,_=pt;_.x=m.clientWidth/2,_.y=m.clientHeight/2;var y,C=c.getPickRay(_,ft),w=u.rayEllipsoid(C,a);if(o(w))y=g.getPoint(C,w.start,mt);else{if(!(p>n._minimumTrackBallHeight))return n._looking=!0,G(n,0,i,n._ellipsoid.geodeticSurfaceNormal(c.position,St)),void e.clone(r,n._tiltCenterMousePosition);var b=u.grazingAltitudeLocation(C,a);if(!o(b))return;var E=a.cartesianToCartographic(b,Et);E.height=0,y=a.cartographicToCartesian(E,mt)}var S=v.eastNorthUpToFixedFrame(y,a,gt),x=n._globe,T=n._ellipsoid;n._globe=void 0,n._ellipsoid=l.UNIT_SPHERE,n._rotateFactor=1,n._rotateRateRangeAdjustment=1;var A=f.clone(c.transform,Ct);c._setTransform(S),k(n,0,i,t.UNIT_Z),c._setTransform(A),n._globe=x,n._ellipsoid=T;var P=T.maximumRadius;n._rotateFactor=1/P,n._rotateRateRangeAdjustment=P}}(n,r,i)):function(n,r,i){var a,s,c,h=n._ellipsoid,m=n._scene,y=m.camera;if(e.equals(r,n._tiltCenterMousePosition))a=t.clone(n._tiltCenter,mt);else{if(a=O(n,r,mt),!o(a)){if(s=y.getPickRay(r,ft),c=u.rayEllipsoid(s,h),!o(c))return void(h.cartesianToCartographic(y.position,Et).height<=n._minimumTrackBallHeight&&(n._looking=!0,G(n,0,i,n._ellipsoid.geodeticSurfaceNormal(y.position,St)),e.clone(r,n._tiltCenterMousePosition)));a=g.getPoint(s,c.start,mt)}e.clone(r,n._tiltCenterMousePosition),t.clone(a,n._tiltCenter)}var C=pt;C.x=m.canvas.clientWidth/2,C.y=n._tiltCenterMousePosition.y,s=y.getPickRay(C,ft);var w=t.magnitude(a),b=t.fromElements(w,w,w,et),E=l.fromCartesian3(b,tt);if(c=u.rayEllipsoid(s,E),o(c)){var S=t.magnitude(s.origin)>w?c.start:c.stop,x=g.getPoint(s,S,_t),T=v.eastNorthUpToFixedFrame(a,h,gt),A=v.eastNorthUpToFixedFrame(x,E,vt),P=n._globe,D=n._ellipsoid;n._globe=void 0,n._ellipsoid=l.UNIT_SPHERE,n._rotateFactor=1,n._rotateRateRangeAdjustment=1;var M=t.UNIT_Z,I=f.clone(y.transform,Ct);y._setTransform(T);var R=t.cross(x,y.positionWC,yt),N=t.dot(y.rightWC,R);if(k(n,0,i,M,!1,!0),y._setTransform(A),N<0){i.startPosition.y>i.endPosition.y&&(M=void 0);var L=y.constrainedAxis;y.constrainedAxis=void 0,k(n,0,i,M,!0,!1),y.constrainedAxis=L}else k(n,0,i,M,!0,!1);if(o(y.constrainedAxis)){var F=t.cross(y.direction,y.constrainedAxis,yt);t.equalsEpsilon(F,t.ZERO,d.EPSILON6)||(t.dot(F,y.right)<0&&t.negate(F,F),t.cross(F,y.direction,y.up),t.cross(y.direction,y.up,y.right),t.normalize(y.up,y.up),t.normalize(y.right,y.right))}y._setTransform(I),n._globe=P,n._ellipsoid=D;var B=D.maximumRadius;n._rotateFactor=1/B,n._rotateRateRangeAdjustment=B;var V=t.clone(y.positionWC,yt);if(y._adjustHeightForTerrain(),!t.equals(y.positionWC,V)){y._setTransform(A),y.worldToCameraCoordinatesPoint(V,V);var z=t.magnitudeSquared(V);t.magnitudeSquared(y.position)>z&&(t.normalize(y.position,y.position),t.multiplyByScalar(y.position,Math.sqrt(z),y.position));var U=t.angleBetween(V,y.position),W=t.cross(V,y.position,V);t.normalize(W,W);var H=_.fromAxisAngle(W,U,wt),j=p.fromQuaternion(H,bt);p.multiplyByVector(j,y.direction,y.direction),p.multiplyByVector(j,y.up,y.up),t.cross(y.direction,y.up,y.right),t.cross(y.right,y.direction,y.up),y._setTransform(I)}}}(n,r,i)}}function G(e,n,r,a){var s=e._scene.camera,l=Tt;l.x=r.startPosition.x,l.y=0;var u=At;u.x=r.endPosition.x,u.y=0;var c=s.getPickRay(l,Pt).direction,h=s.getPickRay(u,Dt).direction,p=0,f=t.dot(c,h);f<1&&(p=Math.acos(f)),p=r.startPosition.x>r.endPosition.x?-p:p;var m=e._horizontalRotationAxis;if(o(a)?s.look(a,-p):o(m)?s.look(m,-p):s.lookLeft(p),l.x=0,l.y=r.startPosition.y,u.x=0,u.y=r.endPosition.y,c=s.getPickRay(l,Pt).direction,h=s.getPickRay(u,Dt).direction,p=0,(f=t.dot(c,h))<1&&(p=Math.acos(f)),p=r.startPosition.y>r.endPosition.y?-p:p,a=i(a,m),o(a)){var _=s.direction,g=t.negate(a,Mt),v=t.equalsEpsilon(_,a,d.EPSILON2),y=t.equalsEpsilon(_,g,d.EPSILON2);if(v||y)(v&&p<0||y&&p>0)&&s.look(s.right,-p);else{f=t.dot(_,a);var C=d.acosClamped(f);p>0&&p>C&&(p=C-d.EPSILON4),f=t.dot(_,g),C=d.acosClamped(f),p<0&&-p>C&&(p=-C+d.EPSILON4);var w=t.cross(a,_,It);s.look(w,p)}}else s.lookUp(p)}var W=.4,H=[],j=new g,q=new t,Y=new e,X=new t,Z=new e,K=new t,Q=new t,J=new t,$=new t,ee=new t,te=new t,ne=new t,re=new t,ie=new t,oe=new t,ae=new t,se=new t,le=new t,ue=new t,ce=new t,he=new t,de=new t,pe=new t,fe=new g,me=new g,_e=new t,ge=new e,ve=new e,ye=new g,Ce=new t,we=new t,be=new g,Ee=new g,Se=new t,xe=new t,Te=new t,Ae=new t,Pe=new m(t.ZERO,0),De=new e,Me=new e,Ie=new e,Oe=new g,Re=new t,Ne=new t,Le=new f,Fe=new f,Be=new t,ke=new m(t.ZERO,0),Ve=new t,ze=new r,Ue=new f,Ge=new _,We=new p,He=new e,je=new g,qe=new t,Ye=new g,Xe=new m(t.ZERO,0),Ze=new t,Ke=new t,Qe=new t,Je=new r,$e=new t,et=new t,tt=new l,nt=new t,rt=n.clone(n.UNIT_W),it=n.clone(n.UNIT_W),ot=new t,at=new t,st=new t,lt=new t,ut=new e,ct=new e,ht=new t,dt=new r,pt=new e,ft=new g,mt=new t,_t=new t,gt=new f,vt=new f,yt=new t,Ct=new f,wt=new _,bt=new p,Et=new r,St=new t,xt=new r,Tt=new e,At=new e,Pt=new g,Dt=new g,Mt=new t,It=new t;return x.prototype.update=function(){f.equals(this._scene.camera.transform,f.IDENTITY)?(this._globe=this._scene.globe,this._ellipsoid=o(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=l.UNIT_SPHERE),this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration,this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e,this._rotateRateRangeAdjustment=e;var n,r,i,a=this._scene.mode;a===b.SCENE2D?(i=(r=this)._scene.mapMode2D===w.ROTATE,f.equals(f.IDENTITY,r._scene.camera.transform)?(A(r,r.enableTranslate,r.translateEventTypes,D,r.inertiaTranslate,"_lastInertiaTranslateMovement"),A(r,r.enableZoom,r.zoomEventTypes,M,r.inertiaZoom,"_lastInertiaZoomMovement"),i&&A(r,r.enableRotate,r.tiltEventTypes,I,r.inertiaSpin,"_lastInertiaTiltMovement")):(A(r,r.enableZoom,r.zoomEventTypes,M,r.inertiaZoom,"_lastInertiaZoomMovement"),i&&A(r,r.enableRotate,r.translateEventTypes,I,r.inertiaSpin,"_lastInertiaSpinMovement"))):a===b.COLUMBUS_VIEW?(this._horizontalRotationAxis=t.UNIT_Z,function(e){var t=e._scene.camera;if(f.equals(f.IDENTITY,t.transform)){var n=e._tweens;if(e._aggregator.anyButtonDown&&n.removeAll(),A(e,e.enableTilt,e.tiltEventTypes,N,e.inertiaSpin,"_lastInertiaTiltMovement"),A(e,e.enableTranslate,e.translateEventTypes,R,e.inertiaTranslate,"_lastInertiaTranslateMovement"),A(e,e.enableZoom,e.zoomEventTypes,L,e.inertiaZoom,"_lastInertiaZoomMovement"),A(e,e.enableLook,e.lookEventTypes,G),!(e._aggregator.anyButtonDown||o(e._lastInertiaZoomMovement)&&e._lastInertiaZoomMovement.active||o(e._lastInertiaTranslateMovement)&&e._lastInertiaTranslateMovement.active||n.contains(e._tween))){var r=t.createCorrectPositionTween(e.bounceAnimationTime);o(r)&&(e._tween=n.add(r))}n.update()}else A(e,e.enableRotate,e.rotateEventTypes,k,e.inertiaSpin,"_lastInertiaSpinMovement"),A(e,e.enableZoom,e.zoomEventTypes,z,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):a===b.SCENE3D&&(this._horizontalRotationAxis=void 0,A(n=this,n.enableRotate,n.rotateEventTypes,B,n.inertiaSpin,"_lastInertiaSpinMovement"),A(n,n.enableZoom,n.zoomEventTypes,z,n.inertiaZoom,"_lastInertiaZoomMovement"),A(n,n.enableTilt,n.tiltEventTypes,U,n.inertiaSpin,"_lastInertiaTiltMovement"),A(n,n.enableLook,n.lookEventTypes,G)),this._aggregator.reset()},x.prototype.isDestroyed=function(){return!1},x.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),a(this)},x}),o("Scene/ShadowMapShader",["../Core/defaultValue","../Core/defined","../Renderer/ShaderSource"],function(e,t,n){"use strict";function r(){}return r.createShadowCastVertexShader=function(e,r,i){var o=e.defines.slice(0),a=e.sources.slice(0);i&&o.push("GENERATE_POSITION");var s=n.findPositionVarying(e),l=t(s);if(r&&!l){for(var u=a.length,c=0;c<u;++c)a[c]=n.replaceMain(a[c],"czm_shadow_cast_main");a.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new n({defines:o,sources:a})},r.createShadowCastFragmentShader=function(e,r,i,o){var a=e.defines.slice(0),s=e.sources.slice(0),l=n.findPositionVarying(e),u=t(l);u||(l="v_positionEC");for(var c=s.length,h=0;h<c;++h)s[h]=n.replaceMain(s[h],"czm_shadow_cast_main");var d="";return r&&(u||(d+="varying vec3 v_positionEC; \n"),d+="uniform vec4 shadowMap_lightPositionEC; \n"),d+=o?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",d+=r?"float distance = length("+l+"); \ndistance /= shadowMap_lightPositionEC.w; // radius \ngl_FragColor = czm_packDepth(distance); \n":i?"gl_FragColor = vec4(1.0); \n":"gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",s.push(d+="} \n"),new n({defines:a,sources:s})},r.createShadowReceiveVertexShader=function(e,t,r){var i=e.defines.slice(0),o=e.sources.slice(0);return t&&i.push(r?"GENERATE_POSITION_AND_NORMAL":"GENERATE_POSITION"),new n({defines:i,sources:o})},r.createShadowReceiveFragmentShader=function(e,r,i,o,a){for(var s=n.findNormalVarying(e),l=!o&&t(s)||o&&a,u=n.findPositionVarying(e),c=t(u),h=r._usesDepthTexture,d=r._polygonOffsetSupported,p=r._isPointLight,f=r._isSpotLight,m=r._numberOfCascades>1,_=r.debugCascadeColors,g=r.softShadows,v=p?r._pointBias:o?r._terrainBias:r._primitiveBias,y=e.defines.slice(0),C=e.sources.slice(0),w=C.length,b=0;b<w;++b)C[b]=n.replaceMain(C[b],"czm_shadow_receive_main");p?y.push("USE_CUBE_MAP_SHADOW"):h&&y.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!p&&y.push("USE_SOFT_SHADOWS"),m&&i&&o&&y.push(l?"ENABLE_VERTEX_LIGHTING":"ENABLE_DAYNIGHT_SHADING"),i&&v.normalShading&&l&&(y.push("USE_NORMAL_SHADING"),v.normalShadingSmooth>0&&y.push("USE_NORMAL_SHADING_SMOOTH"));var E="";return E+=p?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",E+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \nvec4 getPositionEC() \n{ \n"+(c?"    return vec4("+u+", 1.0); \n":"    return czm_windowToEyeCoordinates(gl_FragCoord); \n")+"} \nvec3 getNormalEC() \n{ \n"+(l?"    return normalize("+s+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(v.normalOffset&&l?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",E+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",E+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",o?E+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":d||(E+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),E+=p?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":f?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":m?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(_?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",C.push(E+="    gl_FragColor.rgb *= visibility; \n} \n"),new n({defines:y,sources:C})},r}),o("Scene/ShadowMap",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxOutlineGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/clone","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/FeatureDetection","../Core/GeometryInstance","../Core/Intersect","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Core/Quaternion","../Core/SphereOutlineGeometry","../Renderer/ClearCommand","../Renderer/ContextLimits","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Sampler","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/Texture","../Renderer/TextureMagnificationFilter","../Renderer/TextureMinificationFilter","../Renderer/TextureWrap","../Renderer/WebGLConstants","./Camera","./CullFace","./CullingVolume","./DebugCameraPrimitive","./OrthographicFrustum","./Pass","./PerInstanceColorAppearance","./PerspectiveFrustum","./Primitive","./ShadowMapShader"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J){"use strict";function $(e){var n=(e=h(e,h.EMPTY_OBJECT)).context;this._enabled=h(e.enabled,!0),this._softShadows=h(e.softShadows,!1),this.dirty=!0,this.fromLightSource=h(e.fromLightSource,!0),this.darkness=h(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=h(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var a,s=!0;(_.isInternetExplorer()||_.isChrome()&&_.isWindows())&&(s=!1),this._polygonOffsetSupported=s,this._terrainBias={polygonOffset:s,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:!0,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:s,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:!0,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:!1,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new C,this._shadowMapTexture=void 0,this._lightDirectionEC=new i,this._lightPositionEC=new o,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new se,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new t,this._isPointLight=h(e.isPointLight,!1),this._pointLightRadius=h(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&h(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?h(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new r,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new Y:d(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new o,new o],this._cascadeMatrices=[new C,new C,new C,new C],this._cascadeDistances=new o,a=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(a);for(var u=0;u<a;++u)this._passes[u]=new ee(n);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=n.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,ne(this),this._clearCommand=new x({depth:1,color:new l}),this._clearPassState=new M(n),this._size=h(e.size,2048),this.size=this._size}function ee(e){this.camera=new se,this.passState=new M(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function te(e,t){return N.fromCache({cull:{enabled:!0,face:H.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function ne(e){var t=!e._usesDepthTexture;e._primitiveRenderState=te(t,e._primitiveBias),e._terrainRenderState=te(t,e._terrainBias),e._pointRenderState=te(t,e._pointBias)}function re(e){for(var t=e._passes.length,n=0;n<t;++n){var r=e._passes[n],i=r.framebuffer;d(i)&&!i.isDestroyed()&&i.destroy(),r.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function ie(){return new L({wrapS:U.CLAMP_TO_EDGE,wrapT:U.CLAMP_TO_EDGE,minificationFilter:z.NEAREST,magnificationFilter:V.NEAREST})}function oe(e,t){e._isPointLight?function(e,t){for(var n=new O({context:t,width:e._textureSize.x,height:e._textureSize.y,format:R.DEPTH_COMPONENT16}),r=new A({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:w.RGBA,pixelDatatype:I.UNSIGNED_BYTE,sampler:ie()}),i=[r.negativeX,r.negativeY,r.negativeZ,r.positiveX,r.positiveY,r.positiveZ],o=0;o<6;++o){var a=new D({context:t,depthRenderbuffer:n,colorTextures:[i[o]],destroyAttachments:!1}),s=e._passes[o];s.framebuffer=a,s.passState.framebuffer=a}e._shadowMapTexture=r,e._depthAttachment=n,e._colorAttachment=r}(e,t):e._usesDepthTexture?function(e,t){for(var n=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:w.DEPTH_STENCIL,pixelDatatype:I.UNSIGNED_INT_24_8,sampler:ie()}),r=new D({context:t,depthStencilTexture:n,destroyAttachments:!1}),i=e._passes.length,o=0;o<i;++o){var a=e._passes[o];a.framebuffer=r,a.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=n}(e,t):function(e,t){for(var n=new O({context:t,width:e._textureSize.x,height:e._textureSize.y,format:R.DEPTH_COMPONENT16}),r=new k({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:w.RGBA,pixelDatatype:I.UNSIGNED_BYTE,sampler:ie()}),i=new D({context:t,depthRenderbuffer:n,colorTextures:[r],destroyAttachments:!1}),o=e._passes.length,a=0;a<o;++a){var s=e._passes[a];s.framebuffer=i,s.passState.framebuffer=i}e._shadowMapTexture=r,e._depthAttachment=n,e._colorAttachment=r}(e,t)}function ae(e,t,n){n=h(n,0),(e._isPointLight||0===n)&&(e._clearCommand.framebuffer=e._passes[n].framebuffer,e._clearCommand.execute(t,e._clearPassState))}function se(){this.viewMatrix=new C,this.inverseViewMatrix=new C,this.frustum=void 0,this.positionCartographic=new a,this.positionWC=new i,this.directionWC=i.clone(i.UNIT_Z),this.upWC=i.clone(i.UNIT_Y),this.rightWC=i.clone(i.UNIT_X),this.viewProjectionMatrix=new C}function le(e,t,n){var r=e._isPointLight?e._pointBias:n?e._terrainBias:e._primitiveBias,i={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=Ne;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,o.fromElements(t.x,t.y,r.depthBias,r.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return o.fromElements(r.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new o,combinedUniforms2:new o};return c(t,i,!1)}function ue(e,t,n,r,i,o){var a,l,u;if(d(o)&&(a=o.shaderProgram,l=o.renderState,u=o.uniformMap),(o=P.shallowClone(n,o)).castShadows=!0,o.receiveShadows=!1,!d(a)||i!==n.shaderProgram.id||t){d(a)&&a.destroy();var c=n.shaderProgram,h=c.fragmentShaderSource,p=n.pass===X.GLOBE,f=n.pass!==X.TRANSLUCENT,m=e._isPointLight,_=e._usesDepthTexture,g=J.createShadowCastVertexShader(c.vertexShaderSource,m,p),v=J.createShadowCastFragmentShader(h,m,_,f);a=F.fromCache({context:r,vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:c._attributeLocations}),l=e._primitiveRenderState,m?l=e._pointRenderState:p&&(l=e._terrainRenderState),n.renderState.cull.enabled||((l=s(l,!1)).cull.enabled=!1,l=N.fromCache(l)),u=le(e,n.uniformMap,p)}return o.shaderProgram=a,o.renderState=l,o.uniformMap=u,o}$.MAXIMUM_DISTANCE=2e4,$.prototype.debugCreateRenderStates=function(){ne(this)},p($.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(t){!function(t,n){t._size=n;var r=t._passes,i=r.length,o=t._textureSize;if(t._isPointLight){o.x=n=T.maximumCubeMapSize>=n?n:T.maximumCubeMapSize,o.y=n;var a=new e(0,0,n,n);r[0].passState.viewport=a,r[1].passState.viewport=a,r[2].passState.viewport=a,r[3].passState.viewport=a,r[4].passState.viewport=a,r[5].passState.viewport=a}else 1===i?(n=T.maximumTextureSize>=n?n:T.maximumTextureSize,o.x=n,o.y=n,r[0].passState.viewport=new e(0,0,n,n)):4===i&&(n=T.maximumTextureSize>=2*n?n:T.maximumTextureSize/2,o.x=2*n,o.y=2*n,r[0].passState.viewport=new e(0,0,n,n),r[1].passState.viewport=new e(n,0,n,n),r[2].passState.viewport=new e(0,n,n,n),r[3].passState.viewport=new e(n,n,n,n));t._clearPassState.viewport=new e(0,0,o.x,o.y);for(var s=0;s<i;++s){var l=r[s],u=l.passState.viewport;l.textureOffsets=new C(u.width/o.x,0,0,u.x/o.x,0,u.height/o.y,0,u.y/o.y,0,0,1,0,0,0,0,1)}}(this,t)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var ce=new e,he=new Array(8);he[0]=new o(-1,-1,-1,1),he[1]=new o(1,-1,-1,1),he[2]=new o(1,1,-1,1),he[3]=new o(-1,1,-1,1),he[4]=new o(-1,-1,1,1),he[5]=new o(1,-1,1,1),he[6]=new o(1,1,1,1),he[7]=new o(-1,1,1,1);for(var de=new C,pe=new Array(8),fe=0;fe<8;++fe)pe[fe]=new o;var me=[l.RED,l.GREEN,l.BLUE,l.MAGENTA],_e=new i;se.prototype.clone=function(e){C.clone(e.viewMatrix,this.viewMatrix),C.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),a.clone(e.positionCartographic,this.positionCartographic),i.clone(e.positionWC,this.positionWC),i.clone(e.directionWC,this.directionWC),i.clone(e.upWC,this.upWC),i.clone(e.rightWC,this.rightWC)};var ge=new C(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);se.prototype.getViewProjection=function(){return C.multiply(this.frustum.projectionMatrix,this.viewMatrix,this.viewProjectionMatrix),C.multiply(ge,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var ve=new Array(5),ye=new K,Ce=new Array(4),we=new C,be=new i,Ee=new i,Se=new i,xe=new i,Te=new i,Ae=[new i(-1,0,0),new i(0,-1,0),new i(0,0,-1),new i(1,0,0),new i(0,1,0),new i(0,0,1)],Pe=[new i(0,-1,0),new i(0,0,-1),new i(0,-1,0),new i(0,-1,0),new i(0,0,1),new i(0,-1,0)],De=[new i(0,0,1),new i(1,0,0),new i(-1,0,0),new i(0,0,-1),new i(1,0,0),new i(1,0,0)],Me=new i,Ie=new i,Oe=new t,Re=Oe.center;$.prototype.update=function(r){if(function(e,n){var r=n.camera,o=e._lightCamera,a=e._sceneCamera,s=e._shadowMapCamera;e._cascadesEnabled?i.clone(o.directionWC,s.directionWC):e._isPointLight?i.clone(o.positionWC,s.positionWC):s.clone(o);var l,u,c=e._lightDirectionEC;C.multiplyByPointAsVector(r.viewMatrix,s.directionWC,c),i.normalize(c,c),i.negate(c,c),C.multiplyByPoint(r.viewMatrix,s.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(l=Math.min(n.shadowHints.nearPlane,e.maximumDistance),u=Math.min(n.shadowHints.farPlane,e.maximumDistance+1)):(l=r.frustum.near,u=e.maximumDistance),e._sceneCamera=W.clone(r,a),r.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=l,e._sceneCamera.frustum.far=u,e._distance=u-l,function(e,n){var r=e._sceneCamera,o=e._shadowMapCamera,a=Oe;if(e._cascadesEnabled){if(r.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var s=n.mapProjection.ellipsoid.geodeticSurfaceNormal(r.positionWC,Me),l=i.negate(o.directionWC,Ie),u=i.dot(s,l),c=y.clamp(u/.1,0,1);if(e._darkness=y.lerp(1,e.darkness,c),u<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)a.center=o.positionWC,a.radius=e._pointLightRadius,e._outOfView=n.cullingVolume.computeVisibility(a)===v.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere);else{var h=o.frustum.far/2,d=i.add(o.positionWC,i.multiplyByScalar(o.directionWC,h,Re),Re);a.center=d,a.radius=h,e._outOfView=n.cullingVolume.computeVisibility(a)===v.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(a),t.clone(a,e._boundingSphere)}}(e,n),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}(this,r),this._needsUpdate)if(this,s=r.context,d(this._passes[0].framebuffer)&&this._shadowMapTexture.width===this._textureSize.x||(re(this),oe(this,s),h=s,(c=this)._usesDepthTexture&&c._passes[0].framebuffer.status!==G.FRAMEBUFFER_COMPLETE&&(c._usesDepthTexture=!1,ne(c),re(c),oe(c,h)),ae(this,s)),this._isPointLight&&function(e,t){var n=new K;n.fov=y.PI_OVER_TWO,n.near=1,n.far=e._pointLightRadius,n.aspectRatio=1;for(var r=0;r<6;++r){var i=e._passes[r].camera;i.positionWC=e._shadowMapCamera.positionWC,i.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),i.directionWC=Ae[r],i.upWC=Pe[r],i.rightWC=De[r],C.computeView(i.positionWC,i.directionWC,i.upWC,i.rightWC,i.viewMatrix),C.inverse(i.viewMatrix,i.inverseViewMatrix),i.frustum=n}}(this,r),this._cascadesEnabled&&(function(e,t){var n=e._shadowMapCamera,r=e._sceneCamera,a=C.multiply(r.frustum.projectionMatrix,r.viewMatrix,de),s=C.inverse(a,de),l=n.directionWC,u=r.directionWC,c=i.cross(l,u,be);u=i.cross(c,l,Ee),i.normalize(u,u),i.normalize(c,c);for(var h=i.fromElements(0,0,0,Te),d=C.computeView(h,l,u,c,we),p=C.multiply(d,s,de),f=i.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Se),m=i.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,xe),_=0;_<8;++_){var g=o.clone(he[_],pe[_]);C.multiplyByVector(p,g,g),i.divideByScalar(g,g.w,g),i.minimumByComponent(g,f,f),i.maximumByComponent(g,m,m)}m.z+=1e3,f.z-=10;var v=Te;v.x=-.5*(f.x+m.x),v.y=-.5*(f.y+m.y),v.z=-m.z;var y=C.fromTranslation(v,de);d=C.multiply(y,d,d);var w=.5*(m.x-f.x),b=.5*(m.y-f.y),E=m.z-f.z,S=n.frustum;S.left=-w,S.right=w,S.bottom=-b,S.top=b,S.near=.01,S.far=E,C.clone(d,n.viewMatrix),C.inverse(d,n.inverseViewMatrix),C.getTranslation(n.inverseViewMatrix,n.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(n.positionWC,n.positionCartographic),i.clone(l,n.directionWC),i.clone(u,n.upWC),i.clone(c,n.rightWC)}(this,r),this._numberOfCascades>1&&function(e,t){var n,a=e._shadowMapCamera,s=e._sceneCamera,l=s.frustum.near,u=s.frustum.far,c=e._numberOfCascades,h=u-l,d=u/l,p=.9,f=!1;r.shadowHints.closestObjectSize<200&&(f=!0,p=.9);var m=Ce,_=ve;for(_[0]=l,_[c]=u,n=0;n<c;++n){var g=(n+1)/c,v=l*Math.pow(d,g),w=y.lerp(l+h*g,v,p);_[n+1]=w,m[n]=w-_[n]}if(f){for(n=0;n<c;++n)m[n]=Math.min(m[n],e._maximumCascadeDistances[n]);var b=_[0];for(n=0;n<c-1;++n)b+=m[n],_[n+1]=b}o.unpack(_,0,e._cascadeSplits[0]),o.unpack(_,1,e._cascadeSplits[1]),o.unpack(m,0,e._cascadeDistances);var E=a.frustum,S=E.left,x=E.right,T=E.bottom,A=E.top,P=E.near,D=E.far,M=a.positionWC,I=a.directionWC,O=a.upWC,R=s.frustum.clone(ye),N=a.getViewProjection();for(n=0;n<c;++n){R.near=_[n],R.far=_[n+1];for(var L=C.multiply(R.projectionMatrix,s.viewMatrix,de),F=C.inverse(L,de),B=C.multiply(N,F,de),k=i.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Se),V=i.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,xe),z=0;z<8;++z){var U=o.clone(he[z],pe[z]);C.multiplyByVector(B,U,U),i.divideByScalar(U,U.w,U),i.minimumByComponent(U,k,k),i.maximumByComponent(U,V,V)}k.x=Math.max(k.x,0),k.y=Math.max(k.y,0),k.z=0,V.x=Math.min(V.x,1),V.y=Math.min(V.y,1),V.z=Math.min(V.z,1);var G=e._passes[n],W=G.camera;W.clone(a);var H=W.frustum;H.left=S+k.x*(x-S),H.right=S+V.x*(x-S),H.bottom=T+k.y*(A-T),H.top=T+V.y*(A-T),H.near=P+k.z*(D-P),H.far=P+V.z*(D-P),G.cullingVolume=W.frustum.computeCullingVolume(M,I,O);var j=e._cascadeMatrices[n];C.multiply(W.getViewProjection(),s.inverseViewMatrix,j),C.multiply(G.textureOffsets,j,j)}}(this)),this._isPointLight)this._shadowMapCullingVolume=j.fromBoundingSphere(this._boundingSphere);else{var a=this._shadowMapCamera;this._shadowMapCullingVolume=a.frustum.computeCullingVolume(a.positionWC,a.directionWC,a.upWC),1===this._passes.length&&this._passes[0].camera.clone(a)}var s,c,h;if(1===this._passes.length){var p=this._sceneCamera.inverseViewMatrix;C.multiply(this._shadowMapCamera.getViewProjection(),p,this._shadowMapMatrix)}this.debugShow&&function(t,r){!function(t,n){var r=n.context,i=n.context.drawingBufferWidth,o=.3*Math.min(i,n.context.drawingBufferHeight),a=ce;a.x=i-o,a.y=0,a.width=o,a.height=o;var s,l,u=t._debugShadowViewCommand;d(u)||((l=r.createViewportQuadCommand((s=t)._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(s._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n",{uniformMap:{shadowMap_texture:function(){return s._shadowMapTexture},shadowMap_textureCube:function(){return s._shadowMapTexture}}})).pass=X.OVERLAY,t._debugShadowViewCommand=u=l),d(u.renderState)&&e.equals(u.renderState.viewport,a)||(u.renderState=N.fromCache({viewport:e.clone(a)})),n.commandList.push(t._debugShadowViewCommand)}(t,r);var o,a,s,c,h=t.debugFreezeFrame&&!t._debugFreezeFrame;if(t._debugFreezeFrame=t.debugFreezeFrame,t.debugFreezeFrame&&(h&&(t._debugCameraFrustum=t._debugCameraFrustum&&t._debugCameraFrustum.destroy(),t._debugCameraFrustum=new q({camera:t._sceneCamera,color:l.CYAN,updateOnChange:!1})),t._debugCameraFrustum.update(r)),t._cascadesEnabled){if(t.debugFreezeFrame){h&&(t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=new q({camera:t._shadowMapCamera,color:l.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(r);for(var p=0;p<t._numberOfCascades;++p)h&&(t._debugCascadeFrustums[p]=t._debugCascadeFrustums[p]&&t._debugCascadeFrustums[p].destroy(),t._debugCascadeFrustums[p]=new q({camera:t._passes[p].camera,color:me[p],updateOnChange:!1})),t._debugCascadeFrustums[p].update(r)}}else if(t._isPointLight){if(!d(t._debugLightFrustum)||t._needsUpdate){var f=t._shadowMapCamera.positionWC,m=E.IDENTITY,_=2*t._pointLightRadius,v=i.fromElements(_,_,_,_e),y=C.fromTranslationQuaternionRotationScale(f,m,v,de);t._debugLightFrustum=t._debugLightFrustum&&t._debugLightFrustum.destroy(),t._debugLightFrustum=(o=y,a=l.YELLOW,s=new g({geometry:new n({minimum:new i(-.5,-.5,-.5),maximum:new i(.5,.5,.5)}),attributes:{color:u.fromColor(a)}}),c=new g({geometry:new S({radius:.5}),attributes:{color:u.fromColor(a)}}),new Q({geometryInstances:[s,c],appearance:new Z({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:o}))}t._debugLightFrustum.update(r)}else d(t._debugLightFrustum)&&!t._needsUpdate||(t._debugLightFrustum=new q({camera:t._shadowMapCamera,color:l.YELLOW,updateOnChange:!1})),t._debugLightFrustum.update(r)}(this,r)},$.prototype.updatePass=function(e,t){ae(this,e,t)};var Ne=new r;return $.createDerivedCommands=function(e,t,n,r,i,o){d(o)||(o={});var a=t.length>0,s=n.shaderProgram,l=s.vertexShaderSource,u=s.fragmentShaderSource,c=n.pass===X.GLOBE,h=!1;if(c&&(h=n.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),n.castShadows){var p=o.castCommands;d(p)||(p=o.castCommands=[]);var f=o.castShaderProgramId,m=e.length;p.length=m;for(var _=0;_<m;++_)p[_]=ue(e[_],r,n,i,f,p[_]);o.castShaderProgramId=n.shaderProgram.id}if(n.receiveShadows&&a){var g,v;d(o.receiveCommand)&&(g=o.receiveCommand.shaderProgram,v=o.receiveCommand.uniformMap),o.receiveCommand=P.shallowClone(n,o.receiveCommand),o.castShadows=!1,o.receiveShadows=!0;var y=o.receiveShaderCastShadows!==n.castShadows,C=o.receiveShaderProgramId!==n.shaderProgram.id;if(!d(g)||C||r||y){d(g)&&g.destroy();var w=J.createShadowReceiveVertexShader(l,c,h),b=J.createShadowReceiveFragmentShader(u,t[0],n.castShadows,c,h);g=F.fromCache({context:i,vertexShaderSource:w,fragmentShaderSource:b,attributeLocations:s._attributeLocations}),v=le(t[0],n.uniformMap,c)}o.receiveCommand.shaderProgram=g,o.receiveCommand.uniformMap=v,o.receiveShaderProgramId=n.shaderProgram.id,o.receiveShaderCastShadows=n.castShadows}return o},$.prototype.isDestroyed=function(){return!1},$.prototype.destroy=function(){re(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return f(this)},$}),o("Shaders/PostProcessFilters/AdditiveBlend",[],function(){"use strict";return"uniform sampler2D u_texture0;\nuniform sampler2D u_texture1;\nuniform vec2 u_center;\nuniform float u_radius;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 color0 = texture2D(u_texture0, v_textureCoordinates);\nvec4 color1 = texture2D(u_texture1, v_textureCoordinates);\nfloat x = length(gl_FragCoord.xy - u_center) / u_radius;\nfloat t = smoothstep(0.5, 0.8, x);\ngl_FragColor = mix(color0 + color1, color0, t);\n}\n"}),o("Shaders/PostProcessFilters/BrightPass",[],function(){"use strict";return"uniform sampler2D u_texture;\nuniform float u_avgLuminance;\nuniform float u_threshold;\nuniform float u_offset;\nvarying vec2 v_textureCoordinates;\nfloat key(float avg)\n{\nfloat guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\nreturn max(0.0, guess) + 0.1;\n}\nvoid main()\n{\nvec4 color = texture2D(u_texture, v_textureCoordinates);\nvec3 xyz = czm_RGBToXYZ(color.rgb);\nfloat luminance = xyz.r;\nfloat scaledLum = key(u_avgLuminance) * luminance / u_avgLuminance;\nfloat brightLum = max(scaledLum - u_threshold, 0.0);\nfloat brightness = brightLum / (u_offset + brightLum);\nxyz.r = brightness;\ngl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n"}),o("Shaders/PostProcessFilters/GaussianBlur1D",[],function(){"use strict";return"#define SAMPLES 8\nuniform float delta;\nuniform float sigma;\nuniform float direction;\nuniform sampler2D u_texture;\nuniform vec2 u_step;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec2 st = v_textureCoordinates;\nvec2 dir = vec2(1.0 - direction, direction);\nvec3 g;\ng.x = 1.0 / (sqrt(czm_twoPi) * sigma);\ng.y = exp((-0.5 * delta * delta) / (sigma * sigma));\ng.z = g.y * g.y;\nvec4 result = texture2D(u_texture, st) * g.x;\nfor (int i = 1; i < SAMPLES; ++i)\n{\ng.xy *= g.yz;\nvec2 offset = float(i) * dir * u_step;\nresult += texture2D(u_texture, st - offset) * g.x;\nresult += texture2D(u_texture, st + offset) * g.x;\n}\ngl_FragColor = result;\n}\n"}),o("Scene/SunPostProcess",["../Core/BoundingRectangle","../Core/Cartesian2","../Core/Cartesian4","../Core/Color","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/Transforms","../Renderer/ClearCommand","../Renderer/Framebuffer","../Renderer/PassState","../Renderer/PixelDatatype","../Renderer/Renderbuffer","../Renderer/RenderbufferFormat","../Renderer/RenderState","../Renderer/Texture","../Shaders/PostProcessFilters/AdditiveBlend","../Shaders/PostProcessFilters/BrightPass","../Shaders/PostProcessFilters/GaussianBlur1D","../Shaders/PostProcessFilters/PassThrough"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b){"use strict";function E(){this._fbo=void 0,this._downSampleFBO1=void 0,this._downSampleFBO2=void 0,this._clearFBO1Command=void 0,this._clearFBO2Command=void 0,this._downSampleCommand=void 0,this._brightPassCommand=void 0,this._blurXCommand=void 0,this._blurYCommand=void 0,this._blendCommand=void 0,this._fullScreenCommand=void 0,this._downSamplePassState=new p,this._downSamplePassState.scissorTest={enable:!0,rectangle:new e},this._upSamplePassState=new p,this._upSamplePassState.scissorTest={enabled:!0,rectangle:new e},this._uCenter=new t,this._uRadius=void 0,this._blurStep=new t}E.prototype.clear=function(e,t){var n=this._clearFBO1Command;r.clone(i(t,r.BLACK),n.color),n.execute(e),n=this._clearFBO2Command,r.clone(i(t,r.BLACK),n.color),n.execute(e)},E.prototype.execute=function(e,t){this._downSampleCommand.execute(e,this._downSamplePassState),this._brightPassCommand.execute(e,this._downSamplePassState),this._blurXCommand.execute(e,this._downSamplePassState),this._blurYCommand.execute(e,this._downSamplePassState),this._fullScreenCommand.framebuffer=t,this._blendCommand.framebuffer=t,this._fullScreenCommand.execute(e),this._blendCommand.execute(e,this._upSamplePassState)};var S=new e,x=new e,T=new n,A=new t,P=new t,D=new l;return E.prototype.update=function(e){var n=e.context,i=e.viewport,a=n.drawingBufferWidth,p=n.drawingBufferHeight,E=this;if(!o(this._downSampleCommand)){this._clearFBO1Command=new h({color:new r}),this._clearFBO2Command=new h({color:new r});var M={};this._downSampleCommand=n.createViewportQuadCommand(b,{uniformMap:M,owner:this}),this._brightPassCommand=n.createViewportQuadCommand(C,{uniformMap:M={u_avgLuminance:function(){return.5},u_threshold:function(){return.25},u_offset:function(){return.1}},owner:this}),this._blurXCommand=n.createViewportQuadCommand(w,{uniformMap:M={delta:function(){return 1},sigma:function(){return 2},direction:function(){return 0}},owner:this}),this._blurYCommand=n.createViewportQuadCommand(w,{uniformMap:M={delta:function(){return 1},sigma:function(){return 2},direction:function(){return 1}},owner:this}),this._blendCommand=n.createViewportQuadCommand(y,{uniformMap:M={u_center:function(){return E._uCenter},u_radius:function(){return E._uRadius}},owner:this}),this._fullScreenCommand=n.createViewportQuadCommand(b,{uniformMap:M={},owner:this})}var I=Math.pow(2,Math.ceil(Math.log(a)/Math.log(2))-2),O=Math.pow(2,Math.ceil(Math.log(p)/Math.log(2))-2),R=Math.max(1,I,O),N=x;N.width=R,N.height=R;var L=this._fbo,F=o(L)&&L.getColorTexture(0)||void 0;if(!o(F)||F.width!==a||F.height!==p){L=L&&L.destroy(),this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy(),this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy(),this._blurStep.x=this._blurStep.y=1/R;var B=[new v({context:n,width:a,height:p})];L=this._fbo=new d(n.depthTexture?{context:n,colorTextures:B,depthTexture:new v({context:n,width:a,height:p,pixelFormat:u.DEPTH_COMPONENT,pixelDatatype:f.UNSIGNED_SHORT})}:{context:n,colorTextures:B,depthRenderbuffer:new m({context:n,format:_.DEPTH_COMPONENT16})}),this._downSampleFBO1=new d({context:n,colorTextures:[new v({context:n,width:R,height:R})]}),this._downSampleFBO2=new d({context:n,colorTextures:[new v({context:n,width:R,height:R})]}),this._clearFBO1Command.framebuffer=this._downSampleFBO1,this._clearFBO2Command.framebuffer=this._downSampleFBO2,this._downSampleCommand.framebuffer=this._downSampleFBO1,this._brightPassCommand.framebuffer=this._downSampleFBO2,this._blurXCommand.framebuffer=this._downSampleFBO1,this._blurYCommand.framebuffer=this._downSampleFBO2;var k=g.fromCache({viewport:N});this._downSampleCommand.uniformMap.u_texture=function(){return L.getColorTexture(0)},this._downSampleCommand.renderState=k,this._brightPassCommand.uniformMap.u_texture=function(){return E._downSampleFBO1.getColorTexture(0)},this._brightPassCommand.renderState=k,this._blurXCommand.uniformMap.u_texture=function(){return E._downSampleFBO2.getColorTexture(0)},this._blurXCommand.uniformMap.u_step=function(){return E._blurStep},this._blurXCommand.renderState=k,this._blurYCommand.uniformMap.u_texture=function(){return E._downSampleFBO1.getColorTexture(0)},this._blurYCommand.uniformMap.u_step=function(){return E._blurStep},this._blurYCommand.renderState=k;var V=S;V.width=a,V.height=p;var z=g.fromCache({viewport:V});this._blendCommand.uniformMap.u_texture0=function(){return L.getColorTexture(0)},this._blendCommand.uniformMap.u_texture1=function(){return E._downSampleFBO2.getColorTexture(0)},this._blendCommand.renderState=z,this._fullScreenCommand.uniformMap.u_texture=function(){return L.getColorTexture(0)},this._fullScreenCommand.renderState=z}var U=n.uniformState,G=U.sunPositionWC,W=U.view,H=U.viewProjection,j=U.projection,q=l.computeViewportTransformation(i,0,1,D),Y=l.multiplyByPoint(W,G,T),X=c.pointToGLWindowCoordinates(H,q,G,A);Y.x+=s.SOLAR_RADIUS;var Z=c.pointToGLWindowCoordinates(j,q,Y,Y),K=30*t.magnitude(t.subtract(Z,X,Z))*2,Q=P;Q.x=K,Q.y=K;var J=this._upSamplePassState.scissorTest.rectangle;return J.x=Math.max(X.x-.5*Q.x,0),J.y=Math.max(X.y-.5*Q.y,0),J.width=Math.min(Q.x,a),J.height=Math.min(Q.y,p),this._uCenter=t.clone(X,this._uCenter),this._uRadius=.5*Math.max(Q.x,Q.y),q=l.computeViewportTransformation(N,0,1,D),X=c.pointToGLWindowCoordinates(H,q,G,A),Q.x*=I/a,Q.y*=O/p,(J=this._downSamplePassState.scissorTest.rectangle).x=Math.max(X.x-.5*Q.x,0),J.y=Math.max(X.y-.5*Q.y,0),J.width=Math.min(Q.x,a),J.height=Math.min(Q.y,p),this._downSamplePassState.context=n,this._upSamplePassState.context=n,this._fbo},E.prototype.isDestroyed=function(){return!1},E.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._downSampleFBO1=this._downSampleFBO1&&this._downSampleFBO1.destroy(),this._downSampleFBO2=this._downSampleFBO2&&this._downSampleFBO2.destroy(),this._downSampleCommand=this._downSampleCommand&&this._downSampleCommand.shaderProgram&&this._downSampleCommand.shaderProgram.destroy(),this._brightPassCommand=this._brightPassCommand&&this._brightPassCommand.shaderProgram&&this._brightPassCommand.shaderProgram.destroy(),this._blurXCommand=this._blurXCommand&&this._blurXCommand.shaderProgram&&this._blurXCommand.shaderProgram.destroy(),this._blurYCommand=this._blurYCommand&&this._blurYCommand.shaderProgram&&this._blurYCommand.shaderProgram.destroy(),this._blendCommand=this._blendCommand&&this._blendCommand.shaderProgram&&this._blendCommand.shaderProgram.destroy(),this._fullScreenCommand=this._fullScreenCommand&&this._fullScreenCommand.shaderProgram&&this._fullScreenCommand.shaderProgram.destroy(),a(this)},E}),o("Scene/Scene",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/BoxGeometry","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Cartographic","../Core/Color","../Core/ColorGeometryInstanceAttribute","../Core/createGuid","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/DeveloperError","../Core/EllipsoidGeometry","../Core/Event","../Core/GeographicProjection","../Core/GeometryInstance","../Core/GeometryPipeline","../Core/getTimestamp","../Core/Intersect","../Core/Interval","../Core/JulianDate","../Core/Math","../Core/Matrix4","../Core/mergeSort","../Core/Occluder","../Core/ShowGeometryInstanceAttribute","../Core/Transforms","../Renderer/ClearCommand","../Renderer/ComputeEngine","../Renderer/Context","../Renderer/ContextLimits","../Renderer/DrawCommand","../Renderer/PassState","../Renderer/ShaderProgram","../Renderer/ShaderSource","./Camera","./CreditDisplay","./CullingVolume","./DepthPlane","./DeviceOrientationCameraController","./Fog","./FrameState","./FrustumCommands","./FXAA","./GlobeDepth","./MapMode2D","./OIT","./OrthographicFrustum","./Pass","./PerformanceDisplay","./PerInstanceColorAppearance","./PerspectiveFrustum","./PerspectiveOffCenterFrustum","./PickDepth","./Primitive","./PrimitiveCollection","./SceneMode","./SceneTransforms","./SceneTransitioner","./ScreenSpaceCameraController","./ShadowMap","./SunPostProcess","./TweenCollection"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie,oe,ae,se,le,ue,ce,he){"use strict";function de(t){var n=(t=c(t,c.EMPTY_OBJECT)).canvas,r=t.creditContainer,i=new O(n,t.contextOptions);h(r)||((r=document.createElement("div")).style.position="absolute",r.style.bottom="0",r.style["text-shadow"]="0 0 2px #000000",r.style.color="#ffffff",r.style["font-size"]="10px",r.style["padding-right"]="5px",n.parentNode.appendChild(r)),this._id=u(),this._frameState=new H(i,new V(r)),this._frameState.scene3DOnly=c(t.scene3DOnly,!1);var o,a,l=new L(i);l.viewport=new e,l.viewport.x=0,l.viewport.y=0,l.viewport.width=i.drawingBufferWidth,l.viewport.height=i.drawingBufferHeight,this._passState=l,this._canvas=n,this._context=i,this._computeEngine=new I(i),this._globe=void 0,this._primitives=new ie,this._groundPrimitives=new ie,this._tweens=new he,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._frustumCommandsList=[],this._overlayCommandList=[],this._pickFramebuffer=void 0,this._useOIT=c(t.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,i.depthTexture&&(o=new Y),this._useOIT&&h(o)&&(a=new Z(i)),this._globeDepth=o,this._depthPlane=new U,this._oit=a,this._fxaa=new q,this._clearColorCommand=new M({color:new s,stencil:0,owner:this}),this._depthClearCommand=new M({depth:1,owner:this}),this._pickDepths=[],this._debugGlobeDepths=[],this._transitioner=new se(this),this._renderError=new _,this._preRender=new _,this._postRender=new _,this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new _,this.morphComplete=new _,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=s.clone(s.BLACK),this._mode=oe.SCENE3D,this._mapProjection=h(t.mapProjection)?t.mapProjection:new g,this.morphTime=1,this.farToNearRatio=1e3,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this._debugFrustumStatistics=void 0,this.debugShowFramesPerSecond=!1,this.debugShowGlobeDepth=!1,this.debugShowDepthFrustum=1,this.fxaa=!0,this.useDepthPicking=!0,this.cameraEventWaitTime=500,this.copyGlobeDepth=!1,this.fog=new W,this._sunCamera=new k(this),this.shadowMap=new ue({context:i,lightCamera:this._sunCamera,enabled:c(t.shadows,!1)}),this._terrainExaggeration=c(t.terrainExaggeration,1),this._performanceDisplay=void 0,this._debugVolume=void 0;var d=new k(this);this._camera=d,this._cameraClone=k.clone(d),this._screenSpaceCameraController=new le(this),this._mapMode2D=c(t.mapMode2D,X.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useFXAA:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0;var p=d.frustum.near,f=d.frustum.far,m=Math.ceil(Math.log(f/p)/Math.log(this.farToNearRatio));me(p,f,this.farToNearRatio,m,this._frustumCommandsList,!1,void 0),fe(this,0,E.now()),this.initializeFrame()}function pe(e,t){var n=e.frameState,r=e._context,i=n.shadowHints.shadowsEnabled,o=n.shadowHints.shadowMaps,a=n.shadowHints.lightShadowMaps,s=i&&a.length>0,l=!1,u=n.shadowHints.lastDirtyTime;if(t.lastDirtyTime!==u&&(t.lastDirtyTime=u,t.dirty=!0,l=!0),t.dirty){t.dirty=!1;var c=t.derivedCommands;i&&(t.receiveShadows||t.castShadows)&&(c.shadows=ue.createDerivedCommands(o,a,t,l,r,c.shadows));var d=e._oit;t.pass===Q.TRANSLUCENT&&h(d)&&d.isSupported()&&(s&&t.receiveShadows?(c.oit=h(c.oit)?c.oit:{},c.oit.shadows=d.createDerivedCommands(t.derivedCommands.shadows.receiveCommand,r,c.oit.shadows)):c.oit=d.createDerivedCommands(t,r,c.oit))}}function fe(e,t,n){var r,i=e._camera,o=e._frameState;o.commandList.length=0,o.shadowMaps.length=0,o.mode=e._mode,o.morphTime=e.morphTime,o.mapProjection=e.mapProjection,o.frameNumber=t,o.time=E.clone(n,o.time),o.camera=i,o.cullingVolume=i.frustum.computeCullingVolume(i.positionWC,i.directionWC,i.upWC),o.occluder=function(e){var t=e.globe;if(e._mode===oe.SCENE3D&&h(t))return ke.radius=t.ellipsoid.minimumRadius,Le=A.fromBoundingSphere(ke,e._camera.positionWC,Le)}(e),o.terrainExaggeration=e._terrainExaggeration,(r=o.passes).render=!1,r.pick=!1}function me(e,t,n,r,i,o,a){i.length=r;for(var s=0;s<r;++s){var l,u;o?(l=Math.min(t-a,e+s*a),u=Math.min(t,l+a)):(l=Math.max(e,Math.pow(n,s)*e),u=Math.min(t,n*l));var c=i[s];h(c)?(c.near=l,c.far=u):c=i[s]=new j(l,u)}}function _e(e,t,n){e.debugShowFrustums&&(t.debugOverlappingFrustums=0),e.frameState.passes.pick||pe(e,t);for(var r=e._frustumCommandsList,i=r.length,o=0;o<i;++o){var a=r[o];if(!(n.start>a.far)){if(n.stop<a.near)break;var s=t instanceof M?Q.OPAQUE:t.pass,l=a.indices[s]++;if(a.commands[s][l]=t,e.debugShowFrustums&&(t.debugOverlappingFrustums|=1<<o),t.executeInClosestFrustum)break}}if(e.debugShowFrustums){var u=e._debugFrustumStatistics.commandsInFrustums;u[t.debugOverlappingFrustums]=h(u[t.debugOverlappingFrustums])?u[t.debugOverlappingFrustums]+1:1,++e._debugFrustumStatistics.totalCommands}}function ge(e,t,n){return h(e)&&(!h(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==w.OUTSIDE&&(!h(n)||!e.boundingVolume.isOccluded(n)))}function ve(e){var t=e._frameState,n=t.camera,r=n.directionWC,i=n.positionWC,o=e._computeCommandList,a=e._overlayCommandList,s=t.commandList;e.debugShowFrustums&&(e._debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});for(var l=e._frustumCommandsList,u=l.length,c=Q.NUMBER_OF_PASSES,d=0;d<u;++d)for(var p=0;p<c;++p)l[d].indices[p]=0;o.length=0,a.length=0;for(var f=Number.MAX_VALUE,m=-Number.MAX_VALUE,_=!1,g=t.shadowHints.shadowsEnabled,v=Number.MAX_VALUE,y=-Number.MAX_VALUE,C=Number.MAX_VALUE,w=t.mode===oe.SCENE3D?t.occluder:void 0,b=t.cullingVolume,E=Ve.planes,S=0;S<5;++S)E[S]=b.planes[S];b=Ve;var x=e._environmentState;x.isSkyAtmosphereVisible=h(x.skyAtmosphereCommand)&&x.isReadyForAtmosphere,x.isSunVisible=ge(x.sunDrawCommand,b,w),x.isMoonVisible=ge(x.moonCommand,b,w);for(var T=s.length,A=0;A<T;++A){var P=s[A],D=P.pass;if(D===Q.COMPUTE)o.push(P);else if(D===Q.OVERLAY)a.push(P);else{var I=P.boundingVolume;if(h(I)){if(!ge(P,b,w))continue;ze=I.computePlaneDistances(i,r,ze),f=Math.min(f,ze.start),m=Math.max(m,ze.stop),g&&P.receiveShadows&&ze.start<ue.MAXIMUM_DISTANCE&&!(D===Q.GLOBE&&ze.start<-100&&ze.stop>100)&&(D!==Q.GLOBE&&ze.start<100&&(C=Math.min(C,ze.stop-ze.start)),v=Math.min(v,ze.start),y=Math.max(y,ze.stop))}else ze.start=n.frustum.near,ze.stop=n.frustum.far,_=!(P instanceof M);_e(e,P,ze)}}_?(f=n.frustum.near,m=n.frustum.far):(f=Math.min(Math.max(f,n.frustum.near),n.frustum.far),m=Math.max(Math.min(m,n.frustum.far),f),g&&(v=Math.min(Math.max(v,n.frustum.near),n.frustum.far),y=Math.max(Math.min(y,n.frustum.far),v))),g&&(t.shadowHints.nearPlane=v,t.shadowHints.farPlane=y,t.shadowHints.closestObjectSize=C);var O,R=e.mode===oe.SCENE2D,N=e.farToNearRatio;R?(m=Math.min(m,n.position.z+e.nearToFarDistance2D),f=Math.min(f,m),O=Math.ceil(Math.max(1,m-f)/e.nearToFarDistance2D)):O=Math.ceil(Math.log(m/f)/Math.log(N)),f!==Number.MAX_VALUE&&(O!==u||0!==l.length&&(f<l[0].near||m>l[u-1].far))&&(me(f,m,N,O,l,R,e.nearToFarDistance2D),ve(e))}function ye(e,t,r,o,a){if(!h(t.debugCommandFilter)||t.debugCommandFilter(e)){var u=t.frameState.shadowHints.shadowsEnabled&&t.frameState.shadowHints.lightShadowMaps.length>0;if(t.debugShowCommands||t.debugShowFrustums?(P=t,D=o,(M=N.shallowClone(A=e)).shaderProgram=function(e,t,n){var r=t.context,i=c(void 0,e.shaderProgram),o=i.fragmentShaderSource.clone();o.sources=o.sources.map(function(e){return B.replaceMain(e,"czm_Debug_main")});var a="void main() \n{ \n    czm_Debug_main(); \n";if(t.debugShowCommands){h(e._debugColor)||(e._debugColor=s.fromRandom());var l=e._debugColor;a+="    gl_FragColor.rgb *= vec3("+l.red+", "+l.green+", "+l.blue+"); \n"}t.debugShowFrustums&&(a+="    gl_FragColor.rgb *= vec3("+(1&e.debugOverlappingFrustums?"1.0":"0.0")+", "+(2&e.debugOverlappingFrustums?"1.0":"0.0")+", "+(4&e.debugOverlappingFrustums?"1.0":"0.0")+"); \n"),o.sources.push(a+="}");var u=function(e){var t={},n=i.vertexAttributes;for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r].index);return t}();return F.fromCache({context:r,vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:o,attributeLocations:u})}(A,P),M.execute(P.context,D),M.shaderProgram.destroy()):u&&e.receiveShadows&&h(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(r,o):e.execute(r,o),e.debugShowBoundingVolume&&h(e.boundingVolume)){var d=t._frameState,p=e.boundingVolume;h(t._debugVolume)&&t._debugVolume.destroy();var f,_=i.clone(p.center);if(d.mode!==oe.SCENE3D){_=x.multiplyByPoint(Ue,_,_);var g=d.mapProjection,C=g.unproject(_);_=g.ellipsoid.cartographicToCartesian(C)}if(h(p.radius)){var w=p.radius;f=y.toWireframe(m.createGeometry(new m({radii:new i(w,w,w),vertexFormat:$.FLAT_VERTEX_FORMAT}))),t._debugVolume=new re({geometryInstances:new v({geometry:f,modelMatrix:x.multiplyByTranslation(x.IDENTITY,_,new x),attributes:{color:new l(1,0,0,1)}}),appearance:new $({flat:!0,translucent:!1}),asynchronous:!1})}else{var b=p.halfAxes;f=y.toWireframe(n.createGeometry(n.fromDimensions({dimensions:new i(2,2,2),vertexFormat:$.FLAT_VERTEX_FORMAT}))),t._debugVolume=new re({geometryInstances:new v({geometry:f,modelMatrix:x.fromRotationTranslation(b,_,new x),attributes:{color:new l(1,0,0,1)}}),appearance:new $({flat:!0,translucent:!1}),asynchronous:!1})}var E,S=d.commandList,T=d.commandList=[];t._debugVolume.update(d),h(a)&&(E=o.framebuffer,o.framebuffer=a),T[0].execute(r,o),h(E)&&(o.framebuffer=E),d.commandList=S}}var A,P,D,M}function Ce(e,t,n){return t.boundingVolume.distanceSquaredTo(n)-e.boundingVolume.distanceSquaredTo(n)}function we(e,t,n,r){var i=e.context;T(r,Ce,e._camera.positionWC);for(var o=r.length,a=0;a<o;++a)t(r[a],e,i,n)}function be(e,t){var n=e._debugGlobeDepths[t];return!h(n)&&e.context.depthTexture&&(n=new Y,e._debugGlobeDepths[t]=n),n}function Ee(e,t){var n=e._pickDepths[t];return h(n)||(n=new ne,e._pickDepths[t]=n),n}function Se(e,t){var n,r=e._camera,i=e.context,o=i.uniformState;o.updateCamera(r),(n=h(r.frustum.fov)?r.frustum.clone(Ge):h(r.frustum.infiniteProjectionMatrix)?r.frustum.clone(We):r.frustum.clone(He)).near=r.frustum.near,n.far=r.frustum.far,o.updateFrustum(n),o.updatePass(Q.ENVIRONMENT);var a=e._environmentState,s=a.skyBoxCommand;h(s)&&ye(s,e,i,t),a.isSkyAtmosphereVisible&&ye(a.skyAtmosphereCommand,e,i,t);var l,u,c=e._useWebVR&&e.mode!==oe.SCENE2D;a.isSunVisible&&(a.sunDrawCommand.execute(i,t),e.sunBloom&&!c)&&(l=a.useGlobeDepthFramebuffer?e._globeDepth.framebuffer:a.useFXAA?e._fxaa.getColorFramebuffer():a.originalFramebuffer,e._sunPostProcess.execute(i,l),t.framebuffer=l),a.isMoonVisible&&a.moonCommand.execute(i,t),a.useOIT?(h(e._executeOITFunction)||(e._executeOITFunction=function(e,t,n,r){e._oit.executeCommands(e,t,n,r)}),u=e._executeOITFunction):u=we;for(var d,p=a.clearGlobeDepth,f=a.useDepthPlane,m=e._depthClearCommand,_=e._depthPlane,g=r.position.z,v=e._frustumCommandsList,y=v.length,C=0;C<y;++C){var w=y-C-1,b=v[w];e.mode===oe.SCENE2D?(r.position.z=g-b.near+1,n.far=Math.max(1,b.far-b.near),n.near=1,o.update(e.frameState),o.updateFrustum(n)):(n.near=0!==w?b.near*Ne:b.near,n.far=b.far,o.updateFrustum(n));var E,S=e.debugShowGlobeDepth?be(e,w):e._globeDepth;e.debugShowGlobeDepth&&h(S)&&a.useGlobeDepthFramebuffer&&(E=t.framebuffer,t.framebuffer=S.framebuffer),m.execute(i,t),o.updatePass(Q.GLOBE);var x=b.commands[Q.GLOBE],T=b.indices[Q.GLOBE];for(d=0;d<T;++d)ye(x[d],e,i,t);for(h(S)&&a.useGlobeDepthFramebuffer&&(e.copyGlobeDepth||e.debugShowGlobeDepth)&&(S.update(i),S.executeCopyDepth(i,t)),e.debugShowGlobeDepth&&h(S)&&a.useGlobeDepthFramebuffer&&(t.framebuffer=E),o.updatePass(Q.GROUND),x=b.commands[Q.GROUND],T=b.indices[Q.GROUND],d=0;d<T;++d)ye(x[d],e,i,t);p&&(m.execute(i,t),f&&_.execute(i,t));for(var A=Q.TRANSLUCENT,P=Q.GROUND+1;P<A;++P)for(o.updatePass(P),x=b.commands[P],T=b.indices[P],d=0;d<T;++d)ye(x[d],e,i,t);if(0!==w&&e.mode!==oe.SCENE2D&&(n.near=b.near,o.updateFrustum(n)),o.updatePass(Q.TRANSLUCENT),(x=b.commands[Q.TRANSLUCENT]).length=b.indices[Q.TRANSLUCENT],u(e,ye,t,x),h(S)&&a.useGlobeDepthFramebuffer&&e.useDepthPicking){var D=Ee(e,w);D.update(i,S.framebuffer.depthStencilTexture),D.executeCopyDepth(i,t)}}}function xe(e){e.context.uniformState.updatePass(Q.COMPUTE);var t=e._environmentState.sunComputeCommand;h(t)&&t.execute(e._computeEngine);for(var n=e._computeCommandList,r=n.length,i=0;i<r;++i)n[i].execute(e._computeEngine)}function Te(e,t,n){for(var r=n.shadowMapCullingVolume,i=n.isPointLight,o=n.passes,a=o.length,s=t.length,l=0;l<s;++l){var u=t[l];if(pe(e,u),u.castShadows&&(u.pass===Q.GLOBE||u.pass===Q.OPAQUE||u.pass===Q.TRANSLUCENT)&&ge(u,r))if(i)for(var c=0;c<a;++c)o[c].commandList.push(u);else if(1===a)o[0].commandList.push(u);else for(var h=!1,d=a-1;d>=0;--d)if(ge(u,o[d].cullingVolume))o[d].commandList.push(u),h=!0;else if(h)break}}function Ae(e){var t=e.frameState,n=t.shadowHints.shadowMaps,r=n.length;if(t.shadowHints.shadowsEnabled)for(var i=e.context,o=i.uniformState,a=0;a<r;++a){var s=n[a];if(!s.outOfView){var l,u=s.passes,c=u.length;for(l=0;l<c;++l)u[l].commandList.length=0;for(Te(e,e.frameState.commandList,s),l=0;l<c;++l){var h=s.passes[l];o.updateCamera(h.camera),s.updatePass(i,l);for(var d=h.commandList.length,p=0;p<d;++p){var f=h.commandList[p];o.updatePass(f.pass),ye(f.derivedCommands.shadows.castCommands[a],e,i,h.passState)}}}}}function Pe(e,t,n,r){var o=e._context,a=t.viewport,s=e._frameState,l=s.camera,u=s.mode;if(e._useWebVR&&u!==oe.SCENE2D){Me(e),ve(e),Ie(e,t,n,r),xe(e),Ae(e),a.x=0,a.y=0,a.width=.5*o.drawingBufferWidth,a.height=o.drawingBufferHeight;var c=k.clone(l,e._cameraVR),h=l.frustum.near,d=5*h,p=d/30,f=i.multiplyByScalar(c.right,.5*p,Je);l.frustum.aspectRatio=a.width/a.height;var m=.5*p*h/d;i.add(c.position,f,l.position),l.frustum.xOffset=m,Se(e,t),a.x=t.viewport.width,i.subtract(c.position,f,l.position),l.frustum.xOffset=-m,Se(e,t),k.clone(c,l)}else a.x=0,a.y=0,a.width=o.drawingBufferWidth,a.height=o.drawingBufferHeight,u!==oe.SCENE2D||e._mapMode2D===X.ROTATE?De(!0,e,t,n,r):function(e,t,n,r){var o=e.context,a=e.frameState,s=e.camera,l=t.viewport,u=qe;e.mapProjection.project(je,u);var c=i.clone(s.position,Ye),h=x.clone(s.transform,Ze),d=s.frustum.clone();s._setTransform(x.IDENTITY);var p=x.computeViewportTransformation(l,0,1,Xe),f=s.frustum.projectionMatrix,m=s.positionWC.y,_=i.fromElements(S.sign(m)*u.x-m,0,-s.positionWC.x,Ke),g=D.pointToGLWindowCoordinates(f,p,_,Qe);g.x=Math.floor(g.x);var v=l.x,y=l.width;if(0===m||g.x<=0||g.x>=o.drawingBufferWidth)De(!0,e,t,n,r);else if(Math.abs(.5*o.drawingBufferWidth-g.x)<1)l.width=g.x,s.position.x*=S.sign(s.position.x),s.frustum.right=0,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!0,e,t,n,r),l.x=l.width,s.position.x=-s.position.x,s.frustum.right=-s.frustum.left,s.frustum.left=0,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!1,e,t,n,r);else if(g.x>.5*o.drawingBufferWidth){l.width=g.x;var C=s.frustum.right;s.frustum.right=u.x-m,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!0,e,t,n,r),l.x+=g.x,l.width=o.drawingBufferWidth-g.x,s.position.x=-s.position.x,s.frustum.left=-s.frustum.right,s.frustum.right=C-2*s.frustum.right,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!1,e,t,n,r)}else{l.x=g.x,l.width=o.drawingBufferWidth-g.x;var w=s.frustum.left;s.frustum.left=-u.x-m,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!0,e,t,n,r),l.x=0,l.width=g.x,s.position.x=-s.position.x,s.frustum.right=-s.frustum.left,s.frustum.left=w-2*s.frustum.left,a.cullingVolume=s.frustum.computeCullingVolume(s.positionWC,s.directionWC,s.upWC),o.uniformState.update(a),De(!1,e,t,n,r)}s._setTransform(h),i.clone(c,s.position),s.frustum=d.clone(),l.x=v,l.width=y}(e,t,n,r)}function De(e,t,n,r,i){e||(t.frameState.commandList.length=0),Me(t),ve(t),e&&(Ie(t,n,r,i),xe(t),Ae(t)),Se(t,n)}function Me(e){var t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),function(t){var n=e._frameState,r=n.shadowMaps,i=r.length,o=i>0&&!n.passes.pick&&e.mode===oe.SCENE3D;if(o!==n.shadowHints.shadowsEnabled&&(++n.shadowHints.lastDirtyTime,n.shadowHints.shadowsEnabled=o),o){for(var a=0;a<i;++a)if(r[a]!==n.shadowHints.shadowMaps[a]){++n.shadowHints.lastDirtyTime;break}n.shadowHints.shadowMaps.length=0,n.shadowHints.lightShadowMaps.length=0;for(var s=0;s<i;++s){var l=r[s];l.update(n),n.shadowHints.shadowMaps.push(l),l.fromLightSource&&n.shadowHints.lightShadowMaps.push(l),l.dirty&&(++n.shadowHints.lastDirtyTime,l.dirty=!1)}}}(),e._globe&&e._globe.update(t)}function Ie(e,t,n,r){var i=e._context,o=e._environmentState,a=e._useWebVR&&e.mode!==oe.SCENE2D;o.originalFramebuffer=t.framebuffer,h(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!a?e._sunPostProcess=new ce:h(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!h(e.sun)&&h(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);var l=e._clearColorCommand;s.clone(n,l.color),l.execute(i,t);var u=o.useGlobeDepthFramebuffer=!r&&h(e._globeDepth);u&&(e._globeDepth.update(i),e._globeDepth.clear(i,t,n));for(var c=!1,d=e._frustumCommandsList,p=d.length,f=0;f<p;++f)if(d[f].indices[Q.TRANSLUCENT]>0){c=!0;break}(o.useOIT=!r&&c&&h(e._oit)&&e._oit.isSupported())&&(e._oit.update(i,e._globeDepth.framebuffer),e._oit.clear(i,t,n),o.useOIT=e._oit.isSupported());var m=o.useFXAA=!r&&e.fxaa;m&&(e._fxaa.update(i),e._fxaa.clear(i,t,n)),o.isSunVisible&&e.sunBloom&&!a?t.framebuffer=e._sunPostProcess.update(t):u?t.framebuffer=e._globeDepth.framebuffer:m&&(t.framebuffer=e._fxaa.getColorFramebuffer()),h(t.framebuffer)&&l.execute(i,t)}function Oe(e,t){var n=e._context,r=e._environmentState,i=r.useGlobeDepthFramebuffer;e.debugShowGlobeDepth&&i&&be(e,e.debugShowDepthFrustum-1).executeDebugGlobeDepth(n,t),e.debugShowPickDepth&&i&&Ee(e,e.debugShowDepthFrustum-1).executeDebugPickDepth(n,t);var o=r.useOIT,a=r.useFXAA;o&&(t.framebuffer=a?e._fxaa.getColorFramebuffer():void 0,e._oit.execute(n,t)),a&&(!o&&i&&(t.framebuffer=e._fxaa.getColorFramebuffer(),e._globeDepth.executeCopyColor(n,t)),t.framebuffer=r.originalFramebuffer,e._fxaa.execute(n,t)),o||a||!i||(t.framebuffer=r.originalFramebuffer,e._globeDepth.executeCopyColor(n,t))}function Re(e){for(var t=e.afterRender,n=0,r=t.length;n<r;++n)t[n]();t.length=0}var Ne=.99;d(de.prototype,{canvas:{get:function(){return this._canvas}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return R.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return R.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._camera}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){return this.globe.imageryLayers}},terrainProvider:{get:function(){return this.globe.terrainProvider},set:function(e){this.globe.terrainProvider=e}},terrainProviderChanged:{get:function(){return this.globe.terrainProviderChanged}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return h(this._oit)}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){e===oe.SCENE2D?this.morphTo2D(0):e===oe.SCENE3D?this.morphTo3D(0):e===oe.COLUMBUS_VIEW&&this.morphToColumbusView(0),this._mode=e}},numberOfFrustums:{get:function(){return this._frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new k(this),h(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new G(this)),this._aspectRatioVR=this._camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._camera.frustum.aspectRatio=this._aspectRatioVR,this._camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}}});var Le,Fe=new i,Be=new i,ke=new t,Ve=new z,ze=new b,Ue=new x(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);Ue=x.inverseTransformation(Ue,Ue);var Ge=new ee,We=new te,He=new K,je=new a(Math.PI,S.PI_OVER_TWO),qe=new i,Ye=new i,Xe=new x,Ze=new x,Ke=new i,Qe=new i;de.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms()),this._tweens.update(),this._screenSpaceCameraController.update(),h(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this._camera.update(this._mode),this._camera._updateCameraChanged()};var Je=new i;de.prototype.render=function(e){try{!function(e,t){h(t)||(t=E.now());var n,r,o,a,l,u,d,p,f,m=e._camera;n=m,r=e._cameraClone,o=S.EPSILON6,f=1/Math.max(1,(a=n.position,l=r.position,u=Math.max(Math.abs(a.x),Math.abs(l.x)),d=Math.max(Math.abs(a.y),Math.abs(l.y)),p=Math.max(Math.abs(a.z),Math.abs(l.z)),Math.max(Math.max(u,d),p))),i.multiplyByScalar(n.position,f,Fe),i.multiplyByScalar(r.position,f,Be),i.equalsEpsilon(Fe,Be,o)&&i.equalsEpsilon(n.direction,r.direction,o)&&i.equalsEpsilon(n.up,r.up,o)&&i.equalsEpsilon(n.right,r.right,o)&&x.equalsEpsilon(n.transform,r.transform,o)?e._cameraStartFired&&C()-e._cameraMovedTime>e.cameraEventWaitTime&&(m.moveEnd.raiseEvent(),e._cameraStartFired=!1):(e._cameraStartFired||(m.moveStart.raiseEvent(),e._cameraStartFired=!0),e._cameraMovedTime=C(),k.clone(m,e._cameraClone)),e._preRender.raiseEvent(e,t);var _=e.context,g=_.uniformState,v=e._frameState;fe(e,S.incrementWrap(v.frameNumber,15e6,1),t),v.passes.render=!0,v.creditDisplay.beginFrame(),e.fog.update(v),g.update(v);var y=e.shadowMap;h(y)&&y.enabled&&(i.negate(g.sunDirectionWC,e._sunCamera.direction),v.shadowMaps.push(y)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var w=e._passState;if(w.framebuffer=void 0,w.blendingEnabled=void 0,w.scissorTest=void 0,h(e.globe)&&e.globe.beginFrame(v),function(e){var t=e._frameState,n=e._environmentState,r=t.passes.render;n.skyBoxCommand=r&&h(e.skyBox)?e.skyBox.update(t):void 0;var i=e.skyAtmosphere,o=e.globe;h(i)&&h(o)&&(i.setDynamicAtmosphereColor(o.enableLighting),n.isReadyForAtmosphere=n.isReadyForAtmosphere||o._surface._tilesToRender.length>0),n.skyAtmosphereCommand=r&&h(i)?i.update(t):void 0;var a=r&&h(e.sun)?e.sun.update(e):void 0;n.sunDrawCommand=h(a)?a.drawCommand:void 0,n.sunComputeCommand=h(a)?a.computeCommand:void 0,n.moonCommand=r&&h(e.moon)?e.moon.update(t):void 0;var s=n.clearGlobeDepth=h(o)&&(!o.depthTestAgainstTerrain||e.mode===oe.SCENE2D);(n.useDepthPlane=s&&e.mode===oe.SCENE3D)&&e._depthPlane.update(t)}(e),Pe(e,w,c(e.backgroundColor,s.BLACK)),Oe(e,w),function(e,t){e.context.uniformState.updatePass(Q.OVERLAY);for(var n=e.context,r=e._overlayCommandList,i=r.length,o=0;o<i;++o)r[o].execute(n,t)}(e,w),h(e.globe)&&e.globe.endFrame(v),v.creditDisplay.endFrame(),e.debugShowFramesPerSecond){if(!h(e._performanceDisplay)){var b=document.createElement("div");b.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(b);var T=new J({container:b});e._performanceDisplay=T,e._performanceContainer=b}e._performanceDisplay.update()}else h(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer));_.endFrame(),Re(v),e._postRender.raiseEvent(e,t)}(this,e)}catch(e){if(this._renderError.raiseEvent(this,e),this.rethrowRenderErrors)throw e}},de.prototype.clampLineWidth=function(e){return Math.max(R.minimumAliasedLineWidth,Math.min(e,R.maximumAliasedLineWidth))};var $e=new K,et=new i,tt=new i,nt=new r,rt=new x,it=new te,ot=new e(0,0,3,3),at=new s(0,0,0,0),st=new r;de.prototype.pick=function(e){var t,n,r,o,a,s,l,u,c,d,p,f,m,_,g,v,y,C=this._context,w=C.uniformState,b=this._frameState,E=ae.transformWindowToDrawingBuffer(this,e,st);h(this._pickFramebuffer)||(this._pickFramebuffer=C.createPickFramebuffer()),fe(this,b.frameNumber,b.time),b.cullingVolume=(n=E,3,3,(t=this)._mode===oe.SCENE2D?function(e,r,o,a){var s=t._camera,l=s.frustum,u=t._passState.viewport,c=2*(n.x-u.x)/u.width-1;c*=.5*(l.right-l.left);var h=2*(u.height-n.y-u.y)/u.height-1;h*=.5*(l.top-l.bottom);var d=x.clone(s.transform,rt);s._setTransform(x.IDENTITY);var p=i.clone(s.position,et);i.multiplyByScalar(s.right,c,tt),i.add(tt,p,p),i.multiplyByScalar(s.up,h,tt),i.add(tt,p,p),s._setTransform(d),i.fromElements(p.z,p.x,p.y,p);var f=l.getPixelDimensions(u.width,u.height,1,nt),m=$e;return m.right=.5*f.x,m.left=-m.right,m.top=.5*f.y,m.bottom=-m.top,m.near=l.near,m.far=l.far,m.computeCullingVolume(p,s.directionWC,s.upWC)}():(o=n,a=3,s=3,c=(u=(l=(r=t)._camera).frustum).near,d=Math.tan(.5*u.fovy),f=(2*(o.x-(p=r._passState.viewport).x)/p.width-1)*c*(u.aspectRatio*d),m=(2*(p.height-o.y-p.y)/p.height-1)*c*d,g=(_=u.getPixelDimensions(p.width,p.height,1,nt)).x*a*.5,(y=it).top=m+(v=_.y*s*.5),y.bottom=m-v,y.right=f+g,y.left=f-g,y.near=c,y.far=u.far,y.computeCullingVolume(l.positionWC,l.directionWC,l.upWC))),b.passes.pick=!0,w.update(b),ot.x=E.x-1,ot.y=this.drawingBufferHeight-E.y-1;var S=this._pickFramebuffer.begin(ot);Pe(this,S,at,!0),Oe(this,S);var T=this._pickFramebuffer.end(ot);return C.endFrame(),Re(b),T};var lt=new o,ut=new o(1,1/255,1/65025,1/160581375);return de.prototype.pickPosition=function(e,t){if(this.useDepthPicking){var n=this._context,r=n.uniformState,i=ae.transformWindowToDrawingBuffer(this,e,st);i.y=this.drawingBufferHeight-i.y;var a,s=this._camera;h(s.frustum.fov)?a=s.frustum.clone(Ge):h(s.frustum.infiniteProjectionMatrix)&&(a=s.frustum.clone(We));for(var l=this.numberOfFrustums,u=0;u<l;++u){var c=Ee(this,u),d=n.readPixels({x:i.x,y:i.y,width:1,height:1,framebuffer:c.framebuffer}),p=o.unpack(d,0,lt);o.divideByScalar(p,255,p);var f=o.dot(p,ut);if(f>0&&f<1){var m=this._frustumCommandsList[u];return a.near=m.near*(0!==u?Ne:1),a.far=m.far,r.updateFrustum(a),ae.drawingBufferToWgs84Coordinates(this,i,f,t)}}}},de.prototype.drillPick=function(e,t){var n,r,i=[],o=[],a=[];h(t)||(t=Number.MAX_VALUE);for(var s=this.pick(e);h(s)&&h(s.primitive)&&(i.push(s),!(0>=--t));){var l=s.primitive,u=!1;"function"==typeof l.getGeometryInstanceAttributes&&h(s.id)&&(r=l.getGeometryInstanceAttributes(s.id),h(r)&&h(r.show)&&(u=!0,r.show=P.toValue(!1,r.show),a.push(r))),u||(l.show=!1,o.push(l)),s=this.pick(e)}for(n=0;n<o.length;++n)o[n].show=!0;for(n=0;n<a.length;++n)r=a[n],r.show=P.toValue(!0,r.show);return i},de.prototype.completeMorph=function(){this._transitioner.completeMorph()},de.prototype.morphTo2D=function(e){var t,n=this.globe;t=h(n)?n.ellipsoid:this.mapProjection.ellipsoid,e=c(e,2),this._transitioner.morphTo2D(e,t)},de.prototype.morphToColumbusView=function(e){var t,n=this.globe;t=h(n)?n.ellipsoid:this.mapProjection.ellipsoid,e=c(e,2),this._transitioner.morphToColumbusView(e,t)},de.prototype.morphTo3D=function(e){var t,n=this.globe;t=h(n)?n.ellipsoid:this.mapProjection.ellipsoid,e=c(e,2),this._transitioner.morphTo3D(e,t)},de.prototype.isDestroyed=function(){return!1},de.prototype.destroy=function(){return this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._pickFramebuffer=this._pickFramebuffer&&this._pickFramebuffer.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner.destroy(),h(this._globeDepth)&&this._globeDepth.destroy(),h(this._oit)&&this._oit.destroy(),this._fxaa.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay.destroy(),h(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),p(this)},de}),o("Scene/SingleTileImageryProvider",["../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/GeographicTilingScheme","../Core/loadImage","../Core/Rectangle","../Core/RuntimeError","../Core/TileProviderError","../ThirdParty/when"],function(e,t,n,r,i,o,a,s,l,u,c,h){"use strict";function d(r){function i(e){w._image=e,w._tileWidth=e.width,w._tileHeight=e.height,w._ready=!0,w._readyPromise.resolve(!0),c.handleSuccess(w._errorEvent)}function d(e){var t="Failed to load image "+v+".";C=c.handleError(C,w,w._errorEvent,t,0,0,0,p,e),w._readyPromise.reject(new u(t))}function p(){h(s(v),i,d)}var f=(r=t(r,{})).url;this._url=f;var m=r.proxy;this._proxy=m;var _=t(r.rectangle,l.MAX_VALUE),g=new a({rectangle:_,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:r.ellipsoid});this._tilingScheme=g,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new o,this._ready=!1,this._readyPromise=h.defer();var v=f;n(m)&&(v=m.getURL(v));var y=r.credit;"string"==typeof y&&(y=new e(y)),this._credit=y;var C,w=this;p()}return r(d.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 0}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),d.prototype.getTileCredits=function(e,t,n){},d.prototype.requestImage=function(e,t,n){return this._image},d.prototype.pickFeatures=function(){},d}),o("Shaders/SkyAtmosphereFS",[],function(){"use strict";return"#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift;\n#endif\nconst float g = -0.95;\nconst float g2 = g * g;\nconst vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nconst vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\n#ifdef COLOR_CORRECT\nvec3 rgb2hsb(vec3 rgbColor)\n{\nvec4 p = mix(vec4(rgbColor.bg, K_RGB2HSB.wz), vec4(rgbColor.gb, K_RGB2HSB.xy), step(rgbColor.b, rgbColor.g));\nvec4 q = mix(vec4(p.xyw, rgbColor.r), vec4(rgbColor.r, p.yzx), step(p.x, rgbColor.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\nvec3 hsb2rgb(vec3 hsbColor)\n{\nvec3 p = abs(fract(hsbColor.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsbColor.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsbColor.y);\n}\n#endif\nvoid main (void)\n{\nfloat cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\nfloat rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\nfloat miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\nconst float exposure = 2.0;\nvec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\nrgb = vec3(1.0) - exp(-exposure * rgb);\nfloat l = czm_luminance(rgb);\n#ifdef COLOR_CORRECT\nvec3 hsb = rgb2hsb(rgb);\nhsb.x += u_hsbShift.x;\nhsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);\nhsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;\nrgb = hsb2rgb(hsb);\nl = min(l, czm_luminance(rgb));\n#endif\ngl_FragColor = vec4(rgb, min(smoothstep(0.0, 0.1, l), 1.0) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n"}),o("Shaders/SkyAtmosphereVS",[],function(){"use strict";return"attribute vec4 position;\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n5.60204474633241,\n9.473284437923038,\n19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nfloat scale(float cosAngle)\n{\nfloat x = 1.0 - cosAngle;\nreturn rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid main(void)\n{\nfloat cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\nfloat outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\nfloat innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\nvec3 positionV3 = position.xyz;\nvec3 ray = positionV3 - czm_viewerPositionWC;\nfloat far = length(ray);\nray /= far;\nfloat atmosphereScale = 1.0 / (outerRadius - innerRadius);\n#ifdef SKY_FROM_SPACE\nfloat B = 2.0 * dot(czm_viewerPositionWC, ray);\nfloat C = cameraHeight * cameraHeight - outerRadius * outerRadius;\nfloat det = max(0.0, B*B - 4.0 * C);\nfloat near = 0.5 * (-B - sqrt(det));\nvec3 start = czm_viewerPositionWC + ray * near;\nfar -= near;\nfloat startAngle = dot(ray, start) / outerRadius;\nfloat startDepth = exp(-1.0 / rayleighScaleDepth );\nfloat startOffset = startDepth*scale(startAngle);\n#else\nvec3 start = czm_viewerPositionWC;\nfloat height = length(start);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\nfloat startAngle = dot(ray, start) / height;\nfloat startOffset = depth*scale(startAngle);\n#endif\nfloat sampleLength = far / fSamples;\nfloat scaledLength = sampleLength * atmosphereScale;\nvec3 sampleRay = ray * sampleLength;\nvec3 samplePoint = start + sampleRay * 0.5;\nvec3 frontColor = vec3(0.0, 0.0, 0.0);\nvec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\nlightDir = normalize(lightDir);\nfor(int i=0; i<nSamples; i++)\n{\nfloat height = length(samplePoint);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\nfloat fLightAngle = dot(lightDir, samplePoint) / height;\nfloat fCameraAngle = dot(ray, samplePoint) / height;\nfloat fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\nvec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\nfrontColor += attenuate * (depth * scaledLength);\nsamplePoint += sampleRay;\n}\nv_mieColor = frontColor * KmESun;\nv_rayleighColor = frontColor * (InvWavelength * KrESun);\nv_toCamera = czm_viewerPositionWC - positionV3;\ngl_Position = czm_modelViewProjection * position;\n}\n"}),o("Scene/SkyAtmosphere",["../Core/Cartesian3","../Core/Cartesian4","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/Ellipsoid","../Core/EllipsoidGeometry","../Core/GeometryPipeline","../Core/Math","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/DrawCommand","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/ShaderSource","../Renderer/VertexArray","../Shaders/SkyAtmosphereFS","../Shaders/SkyAtmosphereVS","./BlendingState","./CullFace","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w){"use strict";function b(r){r=n(r,a.WGS84),this.show=!0,this._ellipsoid=r,this._command=new d({owner:this}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._spSkyFromSpaceColorCorrect=void 0,this._spSkyFromAtmosphereColorCorrect=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new e;var i=new t;i.w=0,i.y=e.maximumComponent(e.multiplyByScalar(r.radii,1.025,new e)),i.z=r.maximumRadius,this._cameraAndRadiiAndDynamicAtmosphereColor=i;var o=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return o._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){return o._hueSaturationBrightness.x=o.hueShift,o._hueSaturationBrightness.y=o.saturationShift,o._hueSaturationBrightness.z=o.brightnessShift,o._hueSaturationBrightness}}}return i(b.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),b.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0},b.prototype.update=function(t){if(this.show&&(t.mode===w.SCENE3D||t.mode===w.MORPHING)&&t.passes.render){var n=this._command;if(!r(n.vertexArray)){var i=t.context,o=s.createGeometry(new s({radii:e.multiplyByScalar(this._ellipsoid.radii,1.025,new e),slicePartitions:256,stackPartitions:256,vertexFormat:c.POSITION_ONLY}));n.vertexArray=_.fromGeometry({context:i,geometry:o,attributeLocations:l.createAttributeLocations(o),bufferUsage:h.STATIC_DRAW}),n.renderState=p.fromCache({cull:{enabled:!0,face:C.FRONT},blending:y.ALPHA_BLEND});var a=new m({defines:["SKY_FROM_SPACE"],sources:[v]});this._spSkyFromSpace=f.fromCache({context:i,vertexShaderSource:a,fragmentShaderSource:g}),a=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphere=f.fromCache({context:i,vertexShaderSource:a,fragmentShaderSource:g})}var d=!(u.equalsEpsilon(this.hueShift,0,u.EPSILON7)&&u.equalsEpsilon(this.saturationShift,0,u.EPSILON7)&&u.equalsEpsilon(this.brightnessShift,0,u.EPSILON7));if(d&&(!r(this._spSkyFromSpaceColorCorrect)||!r(this._spSkyFromAtmosphereColorCorrect))){var b=t.context,E=new m({defines:["SKY_FROM_SPACE"],sources:[v]}),S=new m({defines:["COLOR_CORRECT"],sources:[g]});this._spSkyFromSpaceColorCorrect=f.fromCache({context:b,vertexShaderSource:E,fragmentShaderSource:S}),E=new m({defines:["SKY_FROM_ATMOSPHERE"],sources:[v]}),this._spSkyFromAtmosphereColorCorrect=f.fromCache({context:b,vertexShaderSource:E,fragmentShaderSource:S})}var x=e.magnitude(t.camera.positionWC);return this._cameraAndRadiiAndDynamicAtmosphereColor.x=x,n.shaderProgram=x>this._cameraAndRadiiAndDynamicAtmosphereColor.y?d?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace:d?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere,n}},b.prototype.isDestroyed=function(){return!1},b.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy(),o(this)},b}),o("Shaders/SkyBoxFS",[],function(){"use strict";return"uniform samplerCube u_cubeMap;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 rgb = textureCube(u_cubeMap, normalize(v_texCoord)).rgb;\ngl_FragColor = vec4(rgb, czm_morphTime);\n}\n"}),o("Shaders/SkyBoxVS",[],function(){"use strict";return"attribute vec3 position;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\ngl_Position = czm_projection * vec4(p, 1.0);\nv_texCoord = position.xyz;\n}\n"}),o("Scene/SkyBox",["../Core/BoxGeometry","../Core/Cartesian3","../Core/defaultValue","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Core/GeometryPipeline","../Core/Matrix4","../Core/VertexFormat","../Renderer/BufferUsage","../Renderer/CubeMap","../Renderer/DrawCommand","../Renderer/loadCubeMap","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/VertexArray","../Shaders/SkyBoxFS","../Shaders/SkyBoxVS","./BlendingState","./SceneMode"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y){"use strict";function C(e){this.sources=e.sources,this._sources=void 0,this.show=n(e.show,!0),this._command=new h({modelMatrix:s.clone(s.IDENTITY),owner:this}),this._cubeMap=void 0}return C.prototype.update=function(n){if(this.show&&(n.mode===y.SCENE3D||n.mode===y.MORPHING)&&n.passes.render){var i=n.context;if(this._sources!==this.sources){this._sources=this.sources;var o=this.sources;"string"==typeof o.positiveX?d(i,this._sources).then(function(e){h._cubeMap=h._cubeMap&&h._cubeMap.destroy(),h._cubeMap=e}):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new c({context:i,source:o}))}var s=this._command;if(!r(s.vertexArray)){var h=this;s.uniformMap={u_cubeMap:function(){return h._cubeMap}};var C=e.createGeometry(e.fromDimensions({dimensions:new t(2,2,2),vertexFormat:l.POSITION_ONLY})),w=a.createAttributeLocations(C);s.vertexArray=m.fromGeometry({context:i,geometry:C,attributeLocations:w,bufferUsage:u.STATIC_DRAW}),s.shaderProgram=f.fromCache({context:i,vertexShaderSource:g,fragmentShaderSource:_,attributeLocations:w}),s.renderState=p.fromCache({blending:v.ALPHA_BLEND})}if(r(this._cubeMap))return s}},C.prototype.isDestroyed=function(){return!1},C.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),i(this)},C}),o("Shaders/SunFS",[],function(){"use strict";return"uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n"}),o("Shaders/SunTextureFS",[],function(){"use strict";return"uniform float u_glowLengthTS;\nuniform float u_radiusTS;\nvarying vec2 v_textureCoordinates;\nvec2 rotate(vec2 p, vec2 direction)\n{\nreturn vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\nvec4 addBurst(vec2 position, vec2 direction)\n{\nvec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\nfloat radius = length(rotatedPosition);\nfloat burst = 1.0 - smoothstep(0.0, 0.55, radius);\nreturn vec4(burst);\n}\nvoid main()\n{\nvec2 position = v_textureCoordinates - vec2(0.5);\nfloat radius = length(position);\nfloat surface = step(radius, u_radiusTS);\nvec4 color = vec4(1.0, 1.0, surface + 0.2, surface);\nfloat glow = 1.0 - smoothstep(0.0, 0.55, radius);\ncolor.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\nvec4 burst = vec4(0.0);\nburst += 0.4 * addBurst(position, vec2(0.38942,  0.92106));\nburst += 0.4 * addBurst(position, vec2(0.99235,  0.12348));\nburst += 0.4 * addBurst(position, vec2(0.60327, -0.79754));\nburst += 0.3 * addBurst(position, vec2(0.31457,  0.94924));\nburst += 0.3 * addBurst(position, vec2(0.97931,  0.20239));\nburst += 0.3 * addBurst(position, vec2(0.66507, -0.74678));\ncolor += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\ngl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n"}),o("Shaders/SunVS",[],function(){"use strict";return"attribute vec2 direction;\nuniform float u_size;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 position;\nif (czm_morphTime == 1.0)\n{\nposition = vec4(czm_sunPositionWC, 1.0);\n}\nelse\n{\nposition = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n}\nvec4 positionEC = czm_view * position;\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nvec2 halfSize = vec2(u_size * 0.5);\nhalfSize *= ((direction * 2.0) - 1.0);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\nv_textureCoordinates = direction;\n}\n"}),o("Scene/Sun",["../Core/BoundingRectangle","../Core/BoundingSphere","../Core/Cartesian2","../Core/Cartesian3","../Core/Cartesian4","../Core/Color","../Core/ComponentDatatype","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/IndexDatatype","../Core/Math","../Core/Matrix4","../Core/PixelFormat","../Core/PrimitiveType","../Renderer/Buffer","../Renderer/BufferUsage","../Renderer/ClearCommand","../Renderer/ComputeCommand","../Renderer/DrawCommand","../Renderer/Framebuffer","../Renderer/RenderState","../Renderer/ShaderProgram","../Renderer/Texture","../Renderer/VertexArray","../Shaders/SunFS","../Shaders/SunTextureFS","../Shaders/SunVS","./BlendingState","./SceneMode","./SceneTransforms"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M){"use strict";function I(){this.show=!0,this._drawCommand=new y({primitiveType:f.TRIANGLES,boundingVolume:new t,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new t,this._boundingVolume2D=new t,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1;var e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}l(I.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var O=new n,R=new n,N=new i,L=new i;return I.prototype.update=function(e){var i=e._passState,o=e.frameState,l=e.context;if(this.show){var u=o.mode;if(u!==D.SCENE2D&&u!==D.MORPHING&&o.passes.render){var f=i.viewport.width,g=i.viewport.height;if(!s(this._texture)||f!==this._drawingBufferWidth||g!==this._drawingBufferHeight||this._glowFactorDirty){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=f,this._drawingBufferHeight=g,this._glowFactorDirty=!1;var y=Math.max(f,g);y=Math.pow(2,Math.ceil(Math.log(y)/Math.log(2))-2),y=Math.max(1,y),this._texture=new E({context:l,width:y,height:y,pixelFormat:p.RGBA}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var C=this;this._commands.computeCommand=new v({fragmentShaderSource:T,outputTexture:this._texture,uniformMap:{u_glowLengthTS:function(){return C._glowLengthTS},u_radiusTS:function(){return C._radiusTS}},persists:!1,owner:this,postExecute:function(){C._commands.computeCommand=void 0}})}var I=this._drawCommand;if(!s(I.vertexArray)){var F={direction:0},B=new Uint8Array(8);B[0]=0,B[1]=0,B[2]=255,B[3]=0,B[4]=255,B[5]=255,B[6]=0,B[7]=255;var k=m.createVertexBuffer({context:l,typedArray:B,usage:_.STATIC_DRAW}),V=[{index:F.direction,vertexBuffer:k,componentsPerAttribute:2,normalize:!0,componentDatatype:a.UNSIGNED_BYTE}],z=m.createIndexBuffer({context:l,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:_.STATIC_DRAW,indexDatatype:c.UNSIGNED_SHORT});I.vertexArray=new S({context:l,attributes:V,indexBuffer:z}),I.shaderProgram=b.fromCache({context:l,vertexShaderSource:A,fragmentShaderSource:x,attributeLocations:F}),I.renderState=w.fromCache({blending:P.ALPHA_BLEND}),I.uniformMap=this._uniformMap}var U=l.uniformState.sunPositionWC,G=l.uniformState.sunPositionColumbusView,W=this._boundingVolume,H=this._boundingVolume2D;r.clone(U,W.center),H.center.x=G.z,H.center.y=G.x,H.center.z=G.y,W.radius=h.SOLAR_RADIUS+h.SOLAR_RADIUS*this._glowLengthTS,H.radius=W.radius,u===D.SCENE3D?t.clone(W,I.boundingVolume):u===D.COLUMBUS_VIEW&&t.clone(H,I.boundingVolume);var j=M.computeActualWgs84Position(o,U,L),q=r.magnitude(r.subtract(j,e.camera.position,L)),Y=l.uniformState.projection,X=N;X.x=0,X.y=0,X.z=-q,X.w=1;var Z=d.multiplyByVector(Y,X,L),K=M.clipToDrawingBufferCoordinates(i.viewport,Z,O);X.x=h.SOLAR_RADIUS;var Q=d.multiplyByVector(Y,X,L),J=M.clipToDrawingBufferCoordinates(i.viewport,Q,R);return this._size=Math.ceil(n.magnitude(n.subtract(J,K,L))),this._size=2*this._size*(1+2*this._glowLengthTS),this._commands}}},I.prototype.isDestroyed=function(){return!1},I.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),u(this)},I}),o("Scene/TileCoordinatesImageryProvider",["../Core/Color","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/Event","../Core/GeographicTilingScheme","../ThirdParty/when"],function(e,t,n,r,i,o,a){"use strict";function s(r){r=t(r,t.EMPTY_OBJECT),this._tilingScheme=n(r.tilingScheme)?r.tilingScheme:new o({ellipsoid:r.ellipsoid}),this._color=t(r.color,e.YELLOW),this._errorEvent=new i,this._tileWidth=t(r.tileWidth,256),this._tileHeight=t(r.tileHeight,256),this._readyPromise=a.resolve(!0)}return r(s.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),s.prototype.getTileCredits=function(e,t,n){},s.prototype.requestImage=function(e,t,n){var r=document.createElement("canvas");r.width=256,r.height=256;var i=r.getContext("2d"),o=this._color.toCssColorString();i.strokeStyle=o,i.lineWidth=2,i.strokeRect(1,1,255,255);var a="L"+n+"X"+e+"Y"+t;return i.font="bold 25px Arial",i.textAlign="center",i.fillStyle="black",i.fillText(a,127,127),i.fillStyle=o,i.fillText(a,124,124),r},s.prototype.pickFeatures=function(){},s}),o("Scene/TileDiscardPolicy",["../Core/DeveloperError"],function(e){"use strict";function t(t){e.throwInstantiationError()}return t.prototype.isReady=e.throwInstantiationError,t.prototype.shouldDiscardImage=e.throwInstantiationError,t}),o("Scene/TileState",["../Core/freezeObject"],function(e){"use strict";return e({START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3})}),o("Shaders/ViewportQuadFS",[],function(){"use strict";return"varying vec2 v_textureCoordinates;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_textureCoordinates.s;\nmaterialInput.st = v_textureCoordinates;\nmaterialInput.str = vec3(v_textureCoordinates, 0.0);\nmaterialInput.normalEC = vec3(0.0, 0.0, -1.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n"}),o("Scene/ViewportQuad",["../Core/BoundingRectangle","../Core/Color","../Core/defined","../Core/destroyObject","../Core/DeveloperError","../Renderer/RenderState","../Renderer/ShaderSource","../Shaders/ViewportQuadFS","./BlendingState","./Material","./Pass"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(r,i){this.show=!0,n(r)||(r=new e),this.rectangle=e.clone(r),n(i)||(i=u.fromType(u.ColorType,{color:new t(1,1,1,1)})),this.material=i,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}return h.prototype.update=function(t){if(this.show){var r=this._rs;if(n(r)&&e.equals(r.viewport,this.rectangle)||(this._rs=o.fromCache({blending:l.ALPHA_BLEND,viewport:this.rectangle})),t.passes.render){var i=t.context;if(this._material!==this.material||!n(this._overlayCommand)){this._material=this.material,n(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();var u=new a({sources:[this._material.shaderSource,s]});this._overlayCommand=i.createViewportQuadCommand(u,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=c.OVERLAY}this._material.update(i),this._overlayCommand.uniformMap=this._material._uniforms,t.commandList.push(this._overlayCommand)}}},h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){return n(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),r(this)},h}),o("Scene/WebMapServiceImageryProvider",["../Core/combine","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/freezeObject","../Core/GeographicTilingScheme","../Core/objectToQuery","../Core/queryToObject","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","./GetFeatureInfoFormat","./UrlTemplateImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(r){function i(e,t){n(g[e])||(g[e]=t),n(h)&&!n(h[e])&&(h[e]=t)}r=t(r,t.EMPTY_OBJECT),this._url=r.url,this._layers=r.layers;var o,h,m=t(r.getFeatureInfoFormats,p.DefaultGetFeatureInfoFormats),_=new c(r.url),g=l(t(_.query,"")),v=e(f(t(r.parameters,t.EMPTY_OBJECT)),p.DefaultParameters);g=e(v,g),o=new c(r.url),h=l(t(o.query,""));var y=e(f(t(r.getFeatureInfoParameters,t.EMPTY_OBJECT)),p.GetFeatureInfoDefaultParameters);h=e(y,h),i("layers",r.layers),i("srs",r.tilingScheme instanceof u?"EPSG:3857":"EPSG:4326"),i("bbox","{westProjected},{southProjected},{eastProjected},{northProjected}"),i("width","{width}"),i("height","{height}"),_.query=s(g);var C,w=_.toString().replace(/%7B/g,"{").replace(/%7D/g,"}");n(h)&&(n(h.query_layers)||(h.query_layers=r.layers),n(h.x)||(h.x="{i}"),n(h.y)||(h.y="{j}"),n(h.info_format)||(h.info_format="{format}"),o.query=s(h),C=o.toString().replace(/%7B/g,"{").replace(/%7D/g,"}")),this._tileProvider=new d({url:w,pickFeaturesUrl:C,tilingScheme:t(r.tilingScheme,new a({ellipsoid:r.ellipsoid})),rectangle:r.rectangle,tileWidth:r.tileWidth,tileHeight:r.tileHeight,minimumLevel:r.minimumLevel,maximumLevel:r.maximumLevel,proxy:r.proxy,subdomains:r.subdomains,tileDiscardPolicy:r.tileDiscardPolicy,credit:r.credit,getFeatureInfoFormats:m,enablePickFeatures:r.enablePickFeatures})}function f(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n.toLowerCase()]=e[n]);return t}return r(p.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._tileProvider.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}}}),p.prototype.getTileCredits=function(e,t,n){return this._tileProvider.getTileCredits(e,t,n)},p.prototype.requestImage=function(e,t,n){return this._tileProvider.requestImage(e,t,n)},p.prototype.pickFeatures=function(e,t,n,r,i){return this._tileProvider.pickFeatures(e,t,n,r,i)},p.DefaultParameters=o({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"}),p.GetFeatureInfoDefaultParameters=o({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"}),p.DefaultGetFeatureInfoFormats=o([o(new h("json","application/json")),o(new h("xml","text/xml")),o(new h("text","text/html"))]),p}),o("Scene/WebMapTileServiceImageryProvider",["../Core/combine","../Core/Credit","../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../Core/freezeObject","../Core/isArray","../Core/objectToQuery","../Core/queryToObject","../Core/Rectangle","../Core/WebMercatorTilingScheme","../ThirdParty/Uri","../ThirdParty/when","./ImageryProvider"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m){"use strict";function _(e){e=n(e,n.EMPTY_OBJECT),this._url=e.url,this._layer=e.layer,this._style=e.style,this._tileMatrixSetID=e.tileMatrixSetID,this._tileMatrixLabels=e.tileMatrixLabels,this._format=n(e.format,"image/jpeg"),this._proxy=e.proxy,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=r(e.tilingScheme)?e.tilingScheme:new d({ellipsoid:e.ellipsoid}),this._tileWidth=n(e.tileWidth,256),this._tileHeight=n(e.tileHeight,256),this._minimumLevel=n(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._rectangle=n(e.rectangle,this._tilingScheme.rectangle),this._readyPromise=f.resolve(!0);var i=this._tilingScheme.positionToTileXY(h.southwest(this._rectangle),this._minimumLevel),o=this._tilingScheme.positionToTileXY(h.northeast(this._rectangle),this._minimumLevel);Math.abs(o.x-i.x),Math.abs(o.y-i.y),this._errorEvent=new a;var s=e.credit;this._credit="string"==typeof s?new t(s):s,this._subdomains=e.subdomains,this._subdomains=l(this._subdomains)?this._subdomains.slice():r(this._subdomains)&&this._subdomains.length>0?this._subdomains.split(""):["a","b","c"]}var g=s({service:"WMTS",version:"1.0.0",request:"GetTile"});return i(_.prototype,{url:{get:function(){return this._url}},proxy:{get:function(){return this._proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:!0},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),_.prototype.getTileCredits=function(e,t,n){},_.prototype.requestImage=function(t,i,o){var a=function(t,i,o,a){var s,l=t._tileMatrixLabels,h=r(l)?l[a]:a.toString(),d=t._subdomains;if(t._url.indexOf("{")>=0)s=t._url.replace("{style}",t._style).replace("{Style}",t._style).replace("{TileMatrixSet}",t._tileMatrixSetID).replace("{TileMatrix}",h).replace("{TileRow}",o.toString()).replace("{TileCol}",i.toString()).replace("{s}",d[(i+o+a)%d.length]);else{var f=new p(t._url),m=c(n(f.query,""));(m=e(g,m)).tilematrix=h,m.layer=t._layer,m.style=t._style,m.tilerow=o,m.tilecol=i,m.tilematrixset=t._tileMatrixSetID,m.format=t._format,f.query=u(m),s=f.toString()}var _=t._proxy;return r(_)&&(s=_.getURL(s)),s}(this,t,i,o);return m.loadImage(this,a)},_.prototype.pickFeatures=function(){},_}),function(n){var r,i=this||(0,eval)("this"),a=i.document,s=i.navigator,l=i.jQuery,u=i.JSON;r=function(e,t){function r(e,t){return(null===e||typeof e in E)&&e===t}function o(e,t){var r;return function(){r||(r=b.a.setTimeout(function(){r=n,e()},t))}}function c(e,t){var n;return function(){clearTimeout(n),n=b.a.setTimeout(e,t)}}function h(e,t){t&&t!==S?"beforeChange"===t?this.Kb(e):this.Ha(e,t):this.Lb(e)}function d(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Hc,r=n[D];r.R||(this.lb&&this.Ma[t]?(n.Pb(t,e,this.Ma[t]),this.Ma[t]=null,--this.lb):r.r[t]||n.Pb(t,e,r.s?{ia:e}:n.uc(e)))}function f(e,t,n,r){b.d[e]={init:function(e,i,o,a,s){var l,u;return b.m(function(){var o=b.a.c(i()),a=!n!=!o,c=!u;(c||t||a!==l)&&(c&&b.va.Aa()&&(u=b.a.ua(b.f.childNodes(e),!0)),a?(c||b.f.da(e,b.a.ua(u)),b.eb(r?r(s,o):s,e)):b.f.xa(e),l=a)},null,{i:e}),{controlsDescendantBindings:!0}}},b.h.ta[e]=!1,b.f.Z[e]=!0}var m,_,g,v,y,C,w,b="undefined"!=typeof e?e:{};b.b=function(e,t){for(var n=e.split("."),r=b,i=0;i<n.length-1;i++)r=r[n[i]];r[n[n.length-1]]=t},b.G=function(e,t,n){e[t]=n},b.version="3.4.0",b.b("version",b.version),b.options={deferUpdates:!1,useOnlyNativeEvents:!1},b.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function r(e,t){return e.__proto__=t,e}function o(e,t,n,r){var i=e[t].match(_)||[];b.a.q(n.match(_),function(e){b.a.pa(i,e,r)}),e[t]=i.join(" ")}var c={__proto__:[]}instanceof Array,h="function"==typeof Symbol,d={},p={};d[s&&/Firefox\/2/i.test(s.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],d.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(d,function(e,t){if(t.length)for(var n=0,r=t.length;n<r;n++)p[t[n]]=e});var f={propertychange:!0},m=a&&function(){for(var e=3,t=a.createElement("div"),r=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",r[0];);return 4<e?e:n}(),_=/\S+/g;return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,r=e.length;n<r;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},Sb:function(e,t,n){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r))return e[r];return null},La:function(e,t){var n=b.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Tb:function(e){for(var t=[],n=0,r=(e=e||[]).length;n<r;n++)0>b.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)n.push(t(e[r],r));return n},Ka:function(e,t){for(var n=[],r=0,i=(e=e||[]).length;r<i;r++)t(e[r],r)&&n.push(e[r]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,r=t.length;n<r;n++)e.push(t[n]);return e},pa:function(e,t,n){var r=b.a.o(b.a.zb(e),t);0>r?n&&e.push(t):n||e.splice(r,1)},ka:c,extend:t,Xa:r,Ya:c?r:t,D:e,Ca:function(e,t){if(!e)return e;var n,r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n],n,e));return r},ob:function(e){for(;e.firstChild;)b.removeNode(e.firstChild)},jc:function(e){for(var t=((e=b.a.V(e))[0]&&e[0].ownerDocument||a).createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(b.$(e[n]));return t},ua:function(e,t){for(var n=0,r=e.length,i=[];n<r;n++){var o=e[n].cloneNode(!0);i.push(t?b.$(o):o)}return i},da:function(e,t){if(b.a.ob(e),t)for(var n=0,r=t.length;n<r;n++)e.appendChild(t[n])},qc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var r=n[0],i=r.parentNode,o=0,a=t.length;o<a;o++)i.insertBefore(t[o],r);for(o=0,a=n.length;o<a;o++)b.removeNode(n[o])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],r=e[e.length-1];for(e.length=0;n!==r;)e.push(n),n=n.nextSibling;e.push(r)}}return e},sc:function(e,t){7>m?e.setAttribute("selected",t):e.selected=t},$a:function(e){return null===e||e===n?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(e,t){return!(t.length>(e=e||"").length)&&e.substring(0,t.length)===t},Mc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return b.a.Mc(e,e.ownerDocument.documentElement)},Qb:function(e){return!!b.a.Sb(e,b.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Wb:function(e){return b.onError?function(){try{return e.apply(this,arguments)}catch(e){throw b.onError&&b.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(b.a.Wb(e),t)},$b:function(e){setTimeout(function(){throw b.onError&&b.onError(e),e},0)},p:function(e,t,n){var r=b.a.Wb(n);if(n=m&&f[t],b.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if("undefined"==typeof e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){r.call(e,t)},o="on"+t;e.attachEvent(o,i),b.a.F.oa(e,function(){e.detachEvent(o,i)})}else e.addEventListener(t,r,!1);else l(e).bind(t,r)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==b.a.A(e)||!e.type||"click"!=t.toLowerCase()||"checkbox"!=(n=e.type)&&"radio"!=n),b.options.useOnlyNativeEvents||!l||n)if("function"==typeof a.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=a.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,i,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if("undefined"==typeof e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return b.H(e)?e():e},zb:function(e){return b.H(e)?e.t():e},bb:function(e,t,n){var r;t&&("object"==typeof e.classList?(r=e.classList[n?"add":"remove"],b.a.q(t.match(_),function(t){r.call(e.classList,t)})):"string"==typeof e.className.baseVal?o(e.className,"baseVal",t,n):o(e,"className",t,n))},Za:function(e,t){var r=b.a.c(t);null!==r&&r!==n||(r="");var i=b.f.firstChild(e);!i||3!=i.nodeType||b.f.nextSibling(i)?b.f.da(e,[e.ownerDocument.createTextNode(r)]):i.data=r,b.a.Rc(e)},rc:function(e,t){if(e.name=t,7>=m)try{e.mergeAttributes(a.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Rc:function(e){9<=m&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Nc:function(e){if(m){var t=e.style.width;e.style.width=0,e.style.width=t}},hd:function(e,t){e=b.a.c(e),t=b.a.c(t);for(var n=[],r=e;r<=t;r++)n.push(r);return n},V:function(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n]);return t},Yb:function(e){return h?Symbol(e):e},rd:6===m,sd:7===m,C:m,ec:function(e,t){for(var n=b.a.V(e.getElementsByTagName("input")).concat(b.a.V(e.getElementsByTagName("textarea"))),r="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],o=n.length-1;0<=o;o--)r(n[o])&&i.push(n[o]);return i},ed:function(e){return"string"==typeof e&&(e=b.a.$a(e))?u&&u.parse?u.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(b.a.c(e),t,n)},fd:function(t,n,r){var i=(r=r||{}).params||{},o=r.includeFields||this.cc,s=t;if("object"==typeof t&&"form"===b.a.A(t)){s=t.action;for(var l=o.length-1;0<=l;l--)for(var u=b.a.ec(t,o[l]),c=u.length-1;0<=c;c--)i[u[c].name]=u[c].value}n=b.a.c(n);var h=a.createElement("form");h.style.display="none",h.action=s,h.method="post";for(var d in n)t=a.createElement("input"),t.type="hidden",t.name=d,t.value=b.a.Eb(b.a.c(n[d])),h.appendChild(t);e(i,function(e,t){var n=a.createElement("input");n.type="hidden",n.name=e,n.value=t,h.appendChild(n)}),a.body.appendChild(h),r.submitter?r.submitter(h):h.submit(),setTimeout(function(){h.parentNode.removeChild(h)},0)}}}(),b.b("utils",b.a),b.b("utils.arrayForEach",b.a.q),b.b("utils.arrayFirst",b.a.Sb),b.b("utils.arrayFilter",b.a.Ka),b.b("utils.arrayGetDistinctValues",b.a.Tb),b.b("utils.arrayIndexOf",b.a.o),b.b("utils.arrayMap",b.a.fb),b.b("utils.arrayPushAll",b.a.ra),b.b("utils.arrayRemoveItem",b.a.La),b.b("utils.extend",b.a.extend),b.b("utils.fieldsIncludedWithJsonPost",b.a.cc),b.b("utils.getFormFields",b.a.ec),b.b("utils.peekObservable",b.a.zb),b.b("utils.postJson",b.a.fd),b.b("utils.parseJson",b.a.ed),b.b("utils.registerEventHandler",b.a.p),b.b("utils.stringifyJson",b.a.Eb),b.b("utils.range",b.a.hd),b.b("utils.toggleDomNodeCssClass",b.a.bb),b.b("utils.triggerEvent",b.a.Da),b.b("utils.unwrapObservable",b.a.c),b.b("utils.objectForEach",b.a.D),b.b("utils.addOrRemoveItem",b.a.pa),b.b("utils.setTextContent",b.a.Za),b.b("unwrap",b.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice(0);return r.push.apply(r,arguments),t.apply(e,r)}}),b.a.e=new function(){function e(e,o){var a=e[r];if(!a||"null"===a||!i[a]){if(!o)return n;a=e[r]="ko"+t++,i[a]={}}return i[a]}var t=0,r="__ko__"+(new Date).getTime(),i={};return{get:function(t,r){var i=e(t,!1);return i===n?n:i[r]},set:function(t,r,i){i===n&&e(t,!1)===n||(e(t,!0)[r]=i)},clear:function(e){var t=e[r];return!!t&&(delete i[t],e[r]=null,!0)},I:function(){return t+++r}}},b.b("utils.domData",b.a.e),b.b("utils.domData.clear",b.a.e.clear),b.a.F=new function(){function e(e,t){var i=b.a.e.get(e,r);return i===n&&t&&b.a.e.set(e,r,i=[]),i}function t(n){if(r=e(n,!1))for(var r=r.slice(0),i=0;i<r.length;i++)r[i](n);if(b.a.e.clear(n),b.a.F.cleanExternalData(n),o[n.nodeType])for(r=n.firstChild;n=r;)r=n.nextSibling,8===n.nodeType&&t(n)}var r=b.a.e.I(),i={1:!0,8:!0,9:!0},o={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},pc:function(t,i){var o=e(t,!1);o&&(b.a.La(o,i),0==o.length&&b.a.e.set(t,r,n))},$:function(e){if(i[e.nodeType]&&(t(e),o[e.nodeType])){var n=[];b.a.ra(n,e.getElementsByTagName("*"));for(var r=0,a=n.length;r<a;r++)t(n[r])}return e},removeNode:function(e){b.$(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}},b.$=b.a.F.$,b.removeNode=b.a.F.removeNode,b.b("cleanNode",b.$),b.b("removeNode",b.removeNode),b.b("utils.domNodeDisposal",b.a.F),b.b("utils.domNodeDisposal.addDisposeCallback",b.a.F.oa),b.b("utils.domNodeDisposal.removeDisposeCallback",b.a.F.pc),m=[0,"",""],y={thead:_=[1,"<table>","</table>"],tbody:_,tfoot:_,tr:[2,"<table><tbody>","</tbody></table>"],td:g=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:g,option:v=[1,"<select multiple='multiple'>","</select>"],optgroup:v},C=8>=b.a.C,b.a.ma=function(e,t){var n;if(l){if(l.parseHTML)n=l.parseHTML(e,t)||[];else if((n=l.clean([e],t))&&n[0]){for(var r=n[0];r.parentNode&&11!==r.parentNode.nodeType;)r=r.parentNode;r.parentNode&&r.parentNode.removeChild(r)}}else{(n=t)||(n=a),r=n.parentWindow||n.defaultView||i;var o,s=b.a.$a(e).toLowerCase(),u=n.createElement("div");for(o=(s=s.match(/^<([a-z]+)[ >]/))&&y[s[1]]||m,s=o[0],o="ignored<div>"+o[1]+e+o[2]+"</div>","function"==typeof r.innerShiv?u.appendChild(r.innerShiv(o)):(C&&n.appendChild(u),u.innerHTML=o,C&&u.parentNode.removeChild(u));s--;)u=u.lastChild;n=b.a.V(u.lastChild.childNodes)}return n},b.a.Cb=function(e,t){if(b.a.ob(e),null!==(t=b.a.c(t))&&t!==n)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var r=b.a.ma(t,e.ownerDocument),i=0;i<r.length;i++)e.appendChild(r[i])},b.b("utils.parseHtmlFragment",b.a.ma),b.b("utils.setHtml",b.a.Cb),b.M=(w={},{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return w[t]=e,"\x3c!--[ko_memo:"+t+"]--\x3e"},xc:function(e,t){var r=w[e];if(r===n)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return r.apply(null,t||[]),!0}finally{delete w[e]}},yc:function(e,t){var n=[];!function e(t,n){if(t)if(8==t.nodeType)null!=(r=b.M.lc(t.nodeValue))&&n.push({Lc:t,cd:r});else if(1==t.nodeType)for(var r=0,i=t.childNodes,o=i.length;r<o;r++)e(i[r],n)}(e,n);for(var r=0,i=n.length;r<i;r++){var o=n[r].Lc,a=[o];t&&b.a.ra(a,t),b.M.xc(n[r].cd,a),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},lc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}),b.b("memoization",b.M),b.b("memoization.memoize",b.M.wb),b.b("memoization.unmemoize",b.M.xc),b.b("memoization.parseMemoText",b.M.lc),b.b("memoization.unmemoizeDomNodeAndDescendants",b.M.yc),b.Y=function(){function e(){if(s)for(var e,t=s,n=0;u<s;)if(e=o[u++]){if(u>t){if(5e3<=++n){u=s,b.a.$b(Error("'Too much recursion' after processing "+n+" task groups."));break}t=s}try{e()}catch(e){b.a.$b(e)}}}function t(){e(),u=s=o.length=0}var n,r,o=[],s=0,l=1,u=0;return{scheduler:i.MutationObserver?(n=t,r=a.createElement("div"),new MutationObserver(n).observe(r,{attributes:!0}),function(){r.classList.toggle("foo")}):a&&"onreadystatechange"in a.createElement("script")?function(e){var t=a.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,a.documentElement.removeChild(t),t=null,e()},a.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Wa:function(e){return s||b.Y.scheduler(t),o[s++]=e,l++},cancel:function(e){(e-=l-s)>=u&&e<s&&(o[e]=null)},resetForTesting:function(){var e=s-u;return u=s=o.length=0,e},md:e}}(),b.b("tasks",b.Y),b.b("tasks.schedule",b.Y.Wa),b.b("tasks.runEarly",b.Y.md),b.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return b.B({read:e,write:function(r){clearTimeout(n),n=b.a.setTimeout(function(){e(r)},t)}})},rateLimit:function(e,t){var n,r,i;"number"==typeof t?n=t:(n=t.timeout,r=t.method),e.cb=!1,i="notifyWhenChangesStop"==r?c:o,e.Ta(function(e){return i(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.cb||(e.cb=!0,e.Ta(function(t){var r;return function(){b.Y.cancel(r),r=b.Y.Wa(t),e.notifySubscribers(n,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:r}};var E={undefined:1,boolean:1,number:1,string:1};b.b("extenders",b.ya),b.vc=function(e,t,n){this.ia=e,this.gb=t,this.Kc=n,this.R=!1,b.G(this,"dispose",this.k)},b.vc.prototype.k=function(){this.R=!0,this.Kc()},b.J=function(){b.a.Ya(this,x),x.rb(this)};var S="change",x={rb:function(e){e.K={},e.Nb=1},X:function(e,t,n){var r=this;n=n||S;var i=new b.vc(r,t?e.bind(t):e,function(){b.a.La(r.K[n],i),r.Ia&&r.Ia(n)});return r.sa&&r.sa(n),r.K[n]||(r.K[n]=[]),r.K[n].push(i),i},notifySubscribers:function(e,t){if((t=t||S)===S&&this.zc(),this.Pa(t))try{b.l.Ub();for(var n,r=this.K[t].slice(0),i=0;n=r[i];++i)n.R||n.gb(e)}finally{b.l.end()}},Na:function(){return this.Nb},Uc:function(e){return this.Na()!==e},zc:function(){++this.Nb},Ta:function(e){var t,n,r,i=this,o=b.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=h);var a=e(function(){i.Mb=!1,o&&r===i&&(r=i()),t=!1,i.tb(n,r)&&i.Ha(n=r)});i.Lb=function(e){i.Mb=t=!0,r=e,a()},i.Kb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Pa:function(e){return this.K[e]&&this.K[e].length},Sc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;return b.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)}),t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&b.a.D(e,function(e,n){var r=b.ya[e];"function"==typeof r&&(t=r(t,n)||t)}),t}};b.G(x,"subscribe",x.X),b.G(x,"extend",x.extend),b.G(x,"getSubscriptionsCount",x.Sc),b.a.ka&&b.a.Xa(x,Function.prototype),b.J.fn=x,b.hc=function(e){return null!=e&&"function"==typeof e.X&&"function"==typeof e.notifySubscribers},b.b("subscribable",b.J),b.b("isSubscribable",b.hc),b.va=b.l=function(){function e(e){r.push(n),n=e}function t(){n=r.pop()}var n,r=[],i=0;return{Ub:e,end:t,oc:function(e){if(n){if(!b.hc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Gc,e,e.Cc||(e.Cc=++i))}},w:function(n,r,i){try{return e(),n.apply(r,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Sa:function(){if(n)return n.Sa}}}(),b.b("computedContext",b.va),b.b("computedContext.getDependenciesCount",b.va.Aa),b.b("computedContext.isInitial",b.va.Sa),b.b("ignoreDependencies",b.qd=b.l.w);var T=b.a.Yb("_latestValue");b.N=function(e){function t(){return 0<arguments.length?(t.tb(t[T],arguments[0])&&(t.ga(),t[T]=arguments[0],t.fa()),this):(b.l.oc(t),t[T])}return t[T]=e,b.a.ka||b.a.extend(t,b.J.fn),b.J.fn.rb(t),b.a.Ya(t,A),b.options.deferUpdates&&b.ya.deferred(t,!0),t};var A={equalityComparer:r,t:function(){return this[T]},fa:function(){this.notifySubscribers(this[T])},ga:function(){this.notifySubscribers(this[T],"beforeChange")}};b.a.ka&&b.a.Xa(A,b.J.fn);var P=b.N.gd="__ko_proto__";A[P]=b.N,b.Oa=function(e,t){return null!==e&&e!==n&&e[P]!==n&&(e[P]===t||b.Oa(e[P],t))},b.H=function(e){return b.Oa(e,b.N)},b.Ba=function(e){return!!("function"==typeof e&&e[P]===b.N||"function"==typeof e&&e[P]===b.B&&e.Vc)},b.b("observable",b.N),b.b("isObservable",b.H),b.b("isWriteableObservable",b.Ba),b.b("isWritableObservable",b.Ba),b.b("observable.fn",A),b.G(A,"peek",A.t),b.G(A,"valueHasMutated",A.fa),b.G(A,"valueWillMutate",A.ga),b.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=b.N(e),b.a.Ya(e,b.la.fn),e.extend({trackArrayChanges:!0})},b.la.fn={remove:function(e){for(var t=this.t(),n=[],r="function"!=typeof e||b.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var o=t[i];r(o)&&(0===n.length&&this.ga(),n.push(o),t.splice(i,1),i--)}return n.length&&this.fa(),n},removeAll:function(e){if(e===n){var t=this.t(),r=t.slice(0);return this.ga(),t.splice(0,t.length),this.fa(),r}return e?this.remove(function(t){return 0<=b.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||b.H(e)?function(t){return t===e}:e;this.ga();for(var r=t.length-1;0<=r;r--)n(t[r])&&(t[r]._destroy=!0);this.fa()},destroyAll:function(e){return e===n?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=b.a.o(e,t)}):[]},indexOf:function(e){var t=this();return b.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}},b.a.ka&&b.a.Xa(b.la.fn,b.N.fn),b.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){b.la.fn[e]=function(){var t=this.t();this.ga(),this.Vb(t,e,arguments);var n=t[e].apply(t,arguments);return this.fa(),n===t?this:n}}),b.a.q(["slice"],function(e){b.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),b.b("observableArray",b.la),b.ya.trackArrayChanges=function(e,t){if(e.hb={},t&&"object"==typeof t&&b.a.extend(e.hb,t),e.hb.sparse=!0,!e.Vb){var n,r=!1,i=null,o=0,a=e.sa,s=e.Ia;e.sa=function(t){a&&a.call(e,t),"arrayChange"===t&&function(){if(!r){r=!0;var t=e.notifySubscribers;e.notifySubscribers=function(e,n){return n&&n!==S||++o,t.apply(this,arguments)};var a=[].concat(e.t()||[]);i=null,n=e.X(function(t){var n;t=[].concat(t||[]),e.Pa("arrayChange")&&((!i||1<o)&&(i=b.a.ib(a,t,e.hb)),n=i),a=t,i=null,o=0,n&&n.length&&e.notifySubscribers(n,"arrayChange")})}}()},e.Ia=function(t){s&&s.call(e,t),"arrayChange"!==t||e.Pa("arrayChange")||(n.k(),r=!1)},e.Vb=function(e,t,n){function a(e,t,n){return s[s.length]={status:e,value:t,index:n}}if(r&&!o){var s=[],l=e.length,u=n.length,c=0;switch(t){case"push":c=l;case"unshift":for(t=0;t<u;t++)a("added",n[t],c+t);break;case"pop":c=l-1;case"shift":l&&a("deleted",e[c],c);break;case"splice":t=Math.min(Math.max(0,0>n[0]?l+n[0]:n[0]),l),l=1===u?l:Math.min(t+(n[1]||0),l),u=t+u-2,c=Math.max(l,u);for(var h=[],d=[],p=2;t<c;++t,++p)t<l&&d.push(a("deleted",e[t],t)),t<u&&h.push(a("added",n[p],t));b.a.dc(d,h);break;default:return}i=s}}}};var D=b.a.Yb("_state");b.m=b.B=function(e,t,r){function i(){if(0<arguments.length){if("function"!=typeof o)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return o.apply(a.pb,arguments),this}return b.l.oc(i),(a.S||a.s&&i.Qa())&&i.aa(),a.T}if("object"==typeof e?r=e:(r=r||{},e&&(r.read=e)),"function"!=typeof r.read)throw Error("Pass a function that returns the value of the ko.computed");var o=r.write,a={T:n,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:r.read,pb:t||r.owner,i:r.disposeWhenNodeIsRemoved||r.i||null,wa:r.disposeWhen||r.wa,mb:null,r:{},L:0,bc:null};return i[D]=a,i.Vc="function"==typeof o,b.a.ka||b.a.extend(i,b.J.fn),b.J.fn.rb(i),b.a.Ya(i,M),r.pure?(a.Va=!0,a.s=!0,b.a.extend(i,I)):r.deferEvaluation&&b.a.extend(i,O),b.options.deferUpdates&&b.ya.deferred(i,!0),a.i&&(a.Fb=!0,a.i.nodeType||(a.i=null)),a.s||r.deferEvaluation||i.aa(),a.i&&i.ba()&&b.a.F.oa(a.i,a.mb=function(){i.k()}),i};var M={equalityComparer:r,Aa:function(){return this[D].L},Pb:function(e,t,n){if(this[D].Va&&t===this)throw Error("A 'pure' computed must not be called recursively");this[D].r[e]=n,n.Ga=this[D].L++,n.na=t.Na()},Qa:function(){var e,t,n=this[D].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e],t.ia.Uc(t.na)))return!0},bd:function(){this.Fa&&!this[D].Ra&&this.Fa()},ba:function(){return this[D].S||0<this[D].L},ld:function(){this.Mb||this.ac()},uc:function(e){if(e.cb&&!this[D].i){var t=e.X(this.bd,this,"dirty"),n=e.X(this.ld,this);return{ia:e,k:function(){t.k(),n.k()}}}return e.X(this.ac,this)},ac:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[D].bc),this[D].bc=b.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[D],n=t.wa;if(!t.Ra&&!t.R){if(t.i&&!b.a.nb(t.i)||n&&n()){if(!t.Fb)return void this.k()}else t.Fb=!1;t.Ra=!0;try{this.Qc(e)}finally{t.Ra=!1}t.L||this.k()}},Qc:function(e){var t=this[D],r=t.Va?n:!t.L,i={Hc:this,Ma:t.r,lb:t.L};b.l.Ub({Gc:i,gb:p,m:this,Sa:r}),t.r={},t.L=0,i=this.Pc(t,i),this.tb(t.T,i)&&(t.s||this.notifySubscribers(t.T,"beforeChange"),t.T=i,t.s?this.zc():e&&this.notifySubscribers(t.T)),r&&this.notifySubscribers(t.T,"awake")},Pc:function(e,t){try{var n=e.jd;return e.pb?n.call(e.pb):n()}finally{b.l.end(),t.lb&&!e.s&&b.a.D(t.Ma,d),e.S=!1}},t:function(){var e=this[D];return(e.S&&!e.L||e.s&&this.Qa())&&this.aa(),e.T},Ta:function(e){b.J.fn.Ta.call(this,e),this.Fa=function(){this.Kb(this[D].T),this[D].S=!0,this.Lb(this)}},k:function(){var e=this[D];!e.s&&e.r&&b.a.D(e.r,function(e,t){t.k&&t.k()}),e.i&&e.mb&&b.a.F.pc(e.i,e.mb),e.r=null,e.L=0,e.R=!0,e.S=!1,e.s=!1,e.i=null}},I={sa:function(e){var t=this,n=t[D];if(!n.R&&n.s&&"change"==e){if(n.s=!1,n.S||t.Qa())n.r=null,n.L=0,n.S=!0,t.aa();else{var r=[];b.a.D(n.r,function(e,t){r[t.Ga]=e}),b.a.q(r,function(e,r){var i=n.r[e],o=t.uc(i.ia);o.Ga=r,o.na=i.na,n.r[e]=o})}n.R||t.notifySubscribers(n.T,"awake")}},Ia:function(e){var t=this[D];t.R||"change"!=e||this.Pa("change")||(b.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(n,"asleep"))},Na:function(){var e=this[D];return e.s&&(e.S||this.Qa())&&this.aa(),b.J.fn.Na.call(this)}},O={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};b.a.ka&&b.a.Xa(M,b.J.fn);var R,N=b.N.gd;b.m[N]=b.N,M[N]=b.m,b.Xc=function(e){return b.Oa(e,b.m)},b.Yc=function(e){return b.Oa(e,b.m)&&e[D]&&e[D].Va},b.b("computed",b.m),b.b("dependentObservable",b.m),b.b("isComputed",b.Xc),b.b("isPureComputed",b.Yc),b.b("computed.fn",M),b.G(M,"peek",M.t),b.G(M,"dispose",M.k),b.G(M,"isActive",M.ba),b.G(M,"getDependenciesCount",M.Aa),b.nc=function(e,t){return"function"==typeof e?b.m(e,t,{pure:!0}):((e=b.a.extend({},e)).pure=!0,b.m(e,t))},b.b("pureComputed",b.nc),function(){function e(){this.keys=[],this.Ib=[]}b.wc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return function t(r,i,o){if(o=o||new e,"object"!=typeof(r=i(r))||null===r||r===n||r instanceof RegExp||r instanceof Date||r instanceof String||r instanceof Number||r instanceof Boolean)return r;var a=r instanceof Array?[]:{};return o.save(r,a),function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(r,function(e){var s=i(r[e]);switch(typeof s){case"boolean":case"number":case"string":case"function":a[e]=s;break;case"object":case"undefined":var l=o.get(s);a[e]=l!==n?l:t(s,i,o)}}),a}(t,function(e){for(var t=0;b.H(e)&&10>t;t++)e=e();return e})},b.toJSON=function(e,t,n){return e=b.wc(e),b.a.Eb(e,t,n)},e.prototype={save:function(e,t){var n=b.a.o(this.keys,e);0<=n?this.Ib[n]=t:(this.keys.push(e),this.Ib.push(t))},get:function(e){return 0<=(e=b.a.o(this.keys,e))?this.Ib[e]:n}}}(),b.b("toJS",b.wc),b.b("toJSON",b.toJSON),b.j={u:function(e){switch(b.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?b.a.e.get(e,b.d.options.xb):7>=b.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?b.j.u(e.options[e.selectedIndex]):n;default:return e.value}},ha:function(e,t,r){switch(b.a.A(e)){case"option":switch(typeof t){case"string":b.a.e.set(e,b.d.options.xb,n),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:b.a.e.set(e,b.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=n);for(var i,o=-1,a=0,s=e.options.length;a<s;++a)if(i=b.j.u(e.options[a]),i==t||""==i&&t===n){o=a;break}(r||0<=o||t===n&&1<e.size)&&(e.selectedIndex=o);break;default:null!==t&&t!==n||(t=""),e.value=t}}},b.b("selectExtensions",b.j),b.b("selectExtensions.readValue",b.j.u),b.b("selectExtensions.writeValue",b.j.ha),b.h=function(){function e(e){123===(e=b.a.$a(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],a=e.match(r),s=[],l=0;if(a){a.push(",");for(var u,c=0;u=a[c];++c){var h=u.charCodeAt(0);if(44===h){if(0>=l){n.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=l=0,s=[];continue}}else if(58===h){if(!l&&!t&&1===s.length){t=s.pop();continue}}else 47===h&&c&&1<u.length?(h=a[c-1].match(i))&&!o[h[0]]&&(e=e.substr(e.indexOf(u)+1),a=e.match(r),a.push(","),c=-1,u="/"):40===h||123===h||91===h?++l:41===h||125===h||93===h?--l:t||s.length||34!==h&&39!==h||(u=u.slice(1,-1));s.push(u)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,r=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,o={in:1,return:1,typeof:1},a={};return{ta:[],ea:a,yb:e,Ua:function(r,i){function o(e,r){var i;if(!c){var h=b.getBindingHandler(e);if(h&&h.preprocess&&!(r=h.preprocess(r,e,o)))return;(h=a[e])&&(i=!(0<=b.a.o(t,i=r))&&null!==(h=i.match(n))&&(h[1]?"Object("+h[1]+")"+h[2]:i),h=i),h&&l.push("'"+e+"':function(_z){"+i+"=_z}")}u&&(r="function(){return "+r+" }"),s.push("'"+e+"':"+r)}var s=[],l=[],u=(i=i||{}).valueAccessors,c=i.bindingParams,h="string"==typeof r?e(r):r;return b.a.q(h,function(e){o(e.key||e.unknown,e.value)}),l.length&&o("_ko_property_writers","{"+l.join(",")+" }"),s.join(",")},ad:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,r,i){e&&b.H(e)?!b.Ba(e)||i&&e.t()===r||e(r):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](r)}}}(),b.b("expressionRewriting",b.h),b.b("expressionRewriting.bindingRewriteValidators",b.h.ta),b.b("expressionRewriting.parseObjectLiteral",b.h.yb),b.b("expressionRewriting.preProcessBindings",b.h.Ua),b.b("expressionRewriting._twoWayBindings",b.h.ea),b.b("jsonExpressionRewriting",b.h),b.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",b.h.Ua),function(){function e(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(i?e.text:e.nodeValue)}function n(n,r){for(var i=n,o=1,a=[];i=i.nextSibling;){if(t(i)&&0==--o)return a;a.push(i),e(i)&&o++}if(!r)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function r(e,t){var r=n(e,t);return r?0<r.length?r[r.length-1].nextSibling:e.nextSibling:null}var i=a&&"\x3c!--test--\x3e"===a.createComment("test").text,o=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,l={ul:!0,ol:!0};b.f={Z:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,r=(t=b.f.childNodes(t)).length;n<r;n++)b.removeNode(t[n]);else b.a.ob(t)},da:function(t,n){if(e(t)){b.f.xa(t);for(var r=t.nextSibling,i=0,o=n.length;i<o;i++)r.parentNode.insertBefore(n[i],r)}else b.a.da(t,n)},mc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},gc:function(t,n,r){r?e(t)?t.parentNode.insertBefore(n,r.nextSibling):r.nextSibling?t.insertBefore(n,r.nextSibling):t.appendChild(n):b.f.mc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Tc:e,pd:function(e){return(e=(i?e.text:e.nodeValue).match(o))?e[1]:null},kc:function(n){if(l[b.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var o,a=null;if(o=i.firstChild)do{if(a)a.push(o);else if(e(o)){var s=r(o,!0);s?o=s:a=[o]}else t(o)&&(a=[o])}while(o=o.nextSibling);if(o=a)for(a=i.nextSibling,s=0;s<o.length;s++)a?n.insertBefore(o[s],a):n.appendChild(o[s])}}while(i=i.nextSibling)}}}}(),b.b("virtualElements",b.f),b.b("virtualElements.allowedBindings",b.f.Z),b.b("virtualElements.emptyNode",b.f.xa),b.b("virtualElements.insertAfter",b.f.gc),b.b("virtualElements.prepend",b.f.mc),b.b("virtualElements.setDomNodeChildren",b.f.da),b.Q=function(){this.Fc={}},b.a.extend(b.Q.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||b.g.getComponentNameForNode(e);case 8:return b.f.Tc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return b.g.Ob(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return b.g.Ob(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return b.f.pd(e);default:return null}},parseBindingsString:function(e,t,n,r){try{var i,o=this.Fc,a=e+(r&&r.valueAccessors||"");if(!(i=o[a])){var s,l="with($context){with($data||{}){return{"+b.h.Ua(e,r)+"}}}";s=new Function("$context","$element",l),i=o[a]=s}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),b.Q.instance=new b.Q,b.b("bindingProvider",b.Q),function(){function e(e){return function(){return e}}function t(e){return e()}function r(e){return b.a.Ca(b.l.w(e),function(t,n){return function(){return e()[n]}})}function o(e,t){return r(this.getBindings.bind(this,e,t))}function a(e,t,n){var r,i=b.f.firstChild(t),o=b.Q.instance,a=o.preprocessNode;if(a){for(;r=i;)i=b.f.nextSibling(r),a.call(o,r);i=b.f.firstChild(t)}for(;r=i;)i=b.f.nextSibling(r),s(e,r,n)}function s(e,t,n){var r=!0,i=1===t.nodeType;i&&b.f.kc(t),(i&&n||b.Q.instance.nodeHasBindings(t))&&(r=u(t,null,e,n).shouldBindDescendants),r&&!h[b.a.A(t)]&&a(e,t,!i)}function u(e,r,i,a){var s,l,u,c,h,p,f=b.a.e.get(e,d);if(!r){if(f)throw Error("You cannot apply bindings multiple times to the same element.");b.a.e.set(e,d,!0)}if(!f&&a&&b.tc(e,i),r&&"function"!=typeof r)s=r;else{var m=b.Q.instance,_=m.getBindingAccessors||o,g=b.B(function(){return(s=r?r(i,e):_.call(m,e,i))&&i.P&&i.P(),s},null,{i:e});s&&g.ba()||(g=null)}if(s){var v=g?function(e){return function(){return t(g()[e])}}:function(e){return s[e]},y=function(){return b.a.Ca(g?g():s,t)};y.get=function(e){return s[e]&&t(v(e))},y.has=function(e){return e in s},c=[],h={},p=[],b.a.D(u=s,function e(t){if(!h[t]){var n=b.getBindingHandler(t);n&&(n.after&&(p.push(t),b.a.q(n.after,function(t){if(u[t]){if(-1!==b.a.o(p,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+p.join(", "));e(t)}}),p.length--),c.push({key:t,fc:n})),h[t]=!0}}),b.a.q(a=c,function(t){var r=t.fc.init,o=t.fc.update,a=t.key;if(8===e.nodeType&&!b.f.Z[a])throw Error("The binding '"+a+"' cannot be used with virtual elements");try{"function"==typeof r&&b.l.w(function(){var t=r(e,v(a),y,i.$data,i);if(t&&t.controlsDescendantBindings){if(l!==n)throw Error("Multiple bindings ("+l+" and "+a+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");l=a}}),"function"==typeof o&&b.B(function(){o(e,v(a),y,i.$data,i)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+a+": "+s[a]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:l===n}}function c(e){return e&&e instanceof b.U?e:new b.U(e)}b.d={};var h={script:!0,textarea:!0,template:!0};b.getBindingHandler=function(e){return b.d[e]},b.U=function(e,t,r,i){var o,a=this,s="function"==typeof e&&!b.H(e),l=b.B(function(){var n=s?e():e,o=b.a.c(n);return t?(t.P&&t.P(),b.a.extend(a,t),l&&(a.P=l)):(a.$parents=[],a.$root=o,a.ko=b),a.$rawData=n,a.$data=o,r&&(a[r]=o),i&&i(a,t,o),a.$data},null,{wa:function(){return o&&!b.a.Qb(o)},i:!0});l.ba()&&(a.P=l,l.equalityComparer=null,o=[],l.Ac=function(e){o.push(e),b.a.F.oa(e,function(e){b.a.La(o,e),o.length||(l.k(),a.P=l=n)})})},b.U.prototype.createChildContext=function(e,t,n){return new b.U(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)})},b.U.prototype.extend=function(e){return new b.U(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,b.a.extend(t,"function"==typeof e?e():e)})};var d=b.a.e.I(),p=b.a.e.I();b.tc=function(e,t){return 2!=arguments.length?b.a.e.get(e,p):(b.a.e.set(e,p,t),void(t.P&&t.P.Ac(e)))},b.Ja=function(e,t,n){return 1===e.nodeType&&b.f.kc(e),u(e,t,c(n),!0)},b.Dc=function(t,n,i){return i=c(i),b.Ja(t,"function"==typeof(o=n)?r(o.bind(null,i,t)):b.a.Ca(o,e),i);var o},b.eb=function(e,t){1!==t.nodeType&&8!==t.nodeType||a(c(e),t,!0)},b.Rb=function(e,t){if(!l&&i.jQuery&&(l=i.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||i.document.body,s(c(e),t,!0)},b.kb=function(e){switch(e.nodeType){case 1:case 8:var t=b.tc(e);if(t)return t;if(e.parentNode)return b.kb(e.parentNode)}return n},b.Jc=function(e){return(e=b.kb(e))?e.$data:n},b.b("bindingHandlers",b.d),b.b("applyBindings",b.Rb),b.b("applyBindingsToDescendants",b.eb),b.b("applyBindingAccessorsToNode",b.Ja),b.b("applyBindingsToNode",b.Dc),b.b("contextFor",b.kb),b.b("dataFor",b.Jc)}(),function(e){function t(n,r,i,o){o||(o=b.g.loaders.slice(0));var a=o.shift();if(a){var s=a[n];if(s){var l=!1;if(s.apply(a,r.concat(function(e){l?i(null):null!==e?i(e):t(n,r,i,o)}))!==e&&(l=!0,!a.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else t(n,r,i,o)}else i(null)}var n={},r={};b.g={get:function(i,o){var a,s,l,u,c,h,d=r.hasOwnProperty(i)?r[i]:e;d?d.Zc?b.l.w(function(){o(d.definition)}):b.Y.Wa(function(){o(d.definition)}):(s=o,(h=n.hasOwnProperty(a=i)?n[a]:e)?h.X(s):((h=n[a]=new b.J).X(s),c=function(e,t){var i=!(!t||!t.synchronous);r[a]={definition:e,Zc:i},delete n[a],l||i?h.notifySubscribers(e):b.Y.Wa(function(){h.notifySubscribers(e)})},t("getConfig",[u=a],function(e){e?t("loadComponent",[u,e],function(t){c(t,e)}):c(null,null)}),l=!0))},Xb:function(e){delete r[e]},Jb:t},b.g.loaders=[],b.b("components",b.g),b.b("components.get",b.g.get),b.b("components.clearCachedDefinition",b.g.Xb)}(),function(){function e(e){switch(b.a.A(e)){case"script":return b.a.ma(e.text);case"textarea":return b.a.ma(e.value);case"template":if(n(e.content))return b.a.ua(e.content.childNodes)}return b.a.ua(e.childNodes)}function n(e){return i.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function r(e,n,r){"string"==typeof n.require?t||i.require?(t||i.require)([n.require],r):e("Uses require, but no AMD loader is present"):r(n)}function o(e){return function(t){throw Error("Component '"+e+"': "+t)}}var s={};b.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(b.g.ub(e))throw Error("Component "+e+" is already registered");s[e]=t},b.g.ub=function(e){return s.hasOwnProperty(e)},b.g.od=function(e){delete s[e],b.g.Xb(e)},b.g.Zb={getConfig:function(e,t){t(s.hasOwnProperty(e)?s[e]:null)},loadComponent:function(e,t,n){var i=o(e);r(i,t,function(t){!function(e,t,n,i){function o(){0==--s&&i(a)}var a={},s=2,u=n.template;n=n.viewModel,u?r(t,u,function(t){b.g.Jb("loadTemplate",[e,t],function(e){a.template=e,o()})}):o(),n?r(t,n,function(t){b.g.Jb("loadViewModel",[e,t],function(e){a[l]=e,o()})}):o()}(e,i,t,n)})},loadTemplate:function(t,r,s){if(t=o(t),"string"==typeof r)s(b.a.ma(r));else if(r instanceof Array)s(r);else if(n(r))s(b.a.V(r.childNodes));else if(r.element)if(r=r.element,i.HTMLElement?r instanceof HTMLElement:r&&r.tagName&&1===r.nodeType)s(e(r));else if("string"==typeof r){var l=a.getElementById(r);l?s(e(l)):t("Cannot find element with ID "+r)}else t("Unknown element type: "+r);else t("Unknown template value: "+r)},loadViewModel:function(e,t,n){!function e(t,n,r){if("function"==typeof n)r(function(e){return new n(e)});else if("function"==typeof n[l])r(n[l]);else if("instance"in n){var i=n.instance;r(function(){return i})}else"viewModel"in n?e(t,n.viewModel,r):t("Unknown viewModel value: "+n)}(o(e),t,n)}};var l="createViewModel";b.b("components.register",b.g.register),b.b("components.isRegistered",b.g.ub),b.b("components.unregister",b.g.od),b.b("components.defaultLoader",b.g.Zb),b.g.loaders.push(b.g.Zb),b.g.Bc=s}(),function(){b.g.getComponentNameForNode=function(e){var t=b.a.A(e);if(b.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=b.a.C&&e.tagName===t))return t},b.g.Ob=function(e,t,r,i){if(1===t.nodeType){var o=b.g.getComponentNameForNode(t);if(o){if((e=e||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var a={name:o,params:function(e,t){if(r=e.getAttribute("params")){var r=n.parseBindingsString(r,t,e,{valueAccessors:!0,bindingParams:!0}),i=(r=b.a.Ca(r,function(t){return b.m(t,null,{i:e})}),b.a.Ca(r,function(t){var n=t.t();return t.ba()?b.m({read:function(){return b.a.c(t())},write:b.Ba(n)&&function(e){t()(e)},i:e}):n}));return i.hasOwnProperty("$raw")||(i.$raw=r),i}return{$raw:{}}}(t,r)};e.component=i?function(){return a}:a}}return e};var e,t,n=new b.Q;9>b.a.C&&(b.g.register=(t=b.g.register,function(e){return a.createElement(e),t.apply(this,arguments)}),a.createDocumentFragment=(e=a.createDocumentFragment,function(){var t,n=e(),r=b.g.Bc;for(t in r)r.hasOwnProperty(t)&&n.createElement(t);return n}))}(),R=0,b.d.component={init:function(e,t,n,r,i){function o(){var e=a&&a.dispose;"function"==typeof e&&e.call(a),s=a=null}var a,s,l=b.a.V(b.f.childNodes(e));return b.a.F.oa(e,o),b.m(function(){var n,r,u=b.a.c(t());if("string"==typeof u?n=u:(n=b.a.c(u.name),r=b.a.c(u.params)),!n)throw Error("No component name specified");var c=s=++R;b.g.get(n,function(t){if(s===c){if(o(),!t)throw Error("Unknown component '"+n+"'");!function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=b.a.ua(t),b.f.da(n,e)}(n,t,e);var u=(d=r,(p=(h=t).createViewModel)?p.call(h,d,{element:e,templateNodes:l}):d);t=i.createChildContext(u,void 0,function(e){e.$component=u,e.$componentTemplateNodes=l}),a=u,b.eb(t,e)}var h,d,p})},null,{i:e}),{controlsDescendantBindings:!0}}},b.f.Z.component=!0;var L={class:"className",for:"htmlFor"};b.d.attr={update:function(e,t){var r=b.a.c(t())||{};b.a.D(r,function(t,r){var i=!1===(r=b.a.c(r))||null===r||r===n;i&&e.removeAttribute(t),8>=b.a.C&&t in L?(t=L[t],i?e.removeAttribute(t):e[t]=r):i||e.setAttribute(t,r.toString()),"name"===t&&b.a.rc(e,i?"":r.toString())})}},b.d.checked={after:["value","attr"],init:function(e,t,r){function i(){var n=e.checked,i=d?o():n;if(!b.va.Sa()&&(!s||n)){var a=b.l.w(t);if(u){var l=c?a.t():a;h!==i?(n&&(b.a.pa(l,i,!0),b.a.pa(l,h,!1)),h=i):b.a.pa(l,i,n),c&&b.Ba(a)&&a(l)}else b.h.Ea(a,r,"checked",i,!0)}}var o=b.nc(function(){return r.has("checkedValue")?b.a.c(r.get("checkedValue")):r.has("value")?b.a.c(r.get("value")):e.value}),a="checkbox"==e.type,s="radio"==e.type;if(a||s){var l=t(),u=a&&b.a.c(l)instanceof Array,c=!(u&&l.push&&l.splice),h=u?o():n,d=s||u;s&&!e.name&&b.d.uniqueName.init(e,function(){return!0}),b.m(i,null,{i:e}),b.a.p(e,"click",i),b.m(function(){var n=b.a.c(t());e.checked=u?0<=b.a.o(n,o()):a?n:o()===n},null,{i:e}),l=n}}},b.h.ea.checked=!0,b.d.checkedValue={update:function(e,t){e.value=b.a.c(t())}},b.d.css={update:function(e,t){var n=b.a.c(t());null!==n&&"object"==typeof n?b.a.D(n,function(t,n){n=b.a.c(n),b.a.bb(e,t,n)}):(n=b.a.$a(String(n||"")),b.a.bb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,b.a.bb(e,n,!0))}},b.d.enable={update:function(e,t){var n=b.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},b.d.disable={update:function(e,t){b.d.enable.update(e,function(){return!b.a.c(t())})}},b.d.event={init:function(e,t,n,r,i){var o=t()||{};b.a.D(o,function(o){"string"==typeof o&&b.a.p(e,o,function(e){var a,s=t()[o];if(s){try{var l=b.a.V(arguments);l.unshift(r=i.$data),a=s.apply(r,l)}finally{!0!==a&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(o+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},b.d.foreach={ic:function(e){return function(){var t=e(),n=b.a.zb(t);return n&&"number"!=typeof n.length?(b.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:b.W.sb}):{foreach:t,templateEngine:b.W.sb}}},init:function(e,t){return b.d.template.init(e,b.d.foreach.ic(t))},update:function(e,t,n,r,i){return b.d.template.update(e,b.d.foreach.ic(t),n,r,i)}},b.h.ta.foreach=!1,b.f.Z.foreach=!0,b.d.hasfocus={init:function(e,t,n){function r(r){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var o;try{o=i.activeElement}catch(e){o=i.body}r=o===e}i=t(),b.h.Ea(i,n,"hasfocus",r,!0),e.__ko_hasfocusLastValue=r,e.__ko_hasfocusUpdating=!1}var i=r.bind(null,!0),o=r.bind(null,!1);b.a.p(e,"focus",i),b.a.p(e,"focusin",i),b.a.p(e,"blur",o),b.a.p(e,"focusout",o)},update:function(e,t){var n=!!b.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),b.l.w(b.a.Da,null,[e,n?"focusin":"focusout"]))}},b.h.ea.hasfocus=!0,b.d.hasFocus=b.d.hasfocus,b.h.ea.hasFocus=!0,b.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){b.a.Cb(e,t())}},f("if"),f("ifnot",!1,!0),f("with",!0,!1,function(e,t){return e.createChildContext(t)});var F={};b.d.options={init:function(e){if("select"!==b.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,r){function i(){return b.a.Ka(e.options,function(e){return e.selected})}function o(e,t,n){var r=typeof t;return"function"==r?t(e):"string"==r?e[t]:n}function a(t,n){if(f&&c)b.j.ha(e,b.a.c(r.get("value")),!0);else if(p.length){var i=0<=b.a.o(p,b.j.u(n[0]));b.a.sc(n[0],i),f&&!i&&b.l.w(b.a.Da,null,[e,"change"])}}var s=e.multiple,l=0!=e.length&&s?e.scrollTop:null,u=b.a.c(t()),c=r.get("valueAllowUnset")&&r.has("value"),h=r.get("optionsIncludeDestroyed");t={};var d,p=[];c||(s?p=b.a.fb(i(),b.j.u):0<=e.selectedIndex&&p.push(b.j.u(e.options[e.selectedIndex]))),u&&("undefined"==typeof u.length&&(u=[u]),d=b.a.Ka(u,function(e){return h||e===n||null===e||!b.a.c(e._destroy)}),r.has("optionsCaption")&&null!==(u=b.a.c(r.get("optionsCaption")))&&u!==n&&d.unshift(F));var f=!1;t.beforeRemove=function(t){e.removeChild(t)},u=a,r.has("optionsAfterRender")&&"function"==typeof r.get("optionsAfterRender")&&(u=function(e,t){a(0,t),b.l.w(r.get("optionsAfterRender"),null,[t[0],e!==F?e:n])}),b.a.Bb(e,d,function(t,i,a){return a.length&&(p=!c&&a[0].selected?[b.j.u(a[0])]:[],f=!0),i=e.ownerDocument.createElement("option"),t===F?(b.a.Za(i,r.get("optionsCaption")),b.j.ha(i,n)):(a=o(t,r.get("optionsValue"),t),b.j.ha(i,b.a.c(a)),t=o(t,r.get("optionsText"),a),b.a.Za(i,t)),[i]},t,u),b.l.w(function(){c?b.j.ha(e,b.a.c(r.get("value")),!0):(s?p.length&&i().length<p.length:p.length&&0<=e.selectedIndex?b.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&b.a.Da(e,"change")}),b.a.Nc(e),l&&20<Math.abs(l-e.scrollTop)&&(e.scrollTop=l)}},b.d.options.xb=b.a.e.I(),b.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){b.a.p(e,"change",function(){var r=t(),i=[];b.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(b.j.u(e))}),b.h.Ea(r,n,"selectedOptions",i)})},update:function(e,t){if("select"!=b.a.A(e))throw Error("values binding applies only to SELECT elements");var n=b.a.c(t()),r=e.scrollTop;n&&"number"==typeof n.length&&b.a.q(e.getElementsByTagName("option"),function(e){var t=0<=b.a.o(n,b.j.u(e));e.selected!=t&&b.a.sc(e,t)}),e.scrollTop=r}},b.h.ea.selectedOptions=!0,b.d.style={update:function(e,t){var r=b.a.c(t()||{});b.a.D(r,function(t,r){null!==(r=b.a.c(r))&&r!==n&&!1!==r||(r=""),e.style[t]=r})}},b.d.submit={init:function(e,t,n,r,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");b.a.p(e,"submit",function(n){var r,o=t();try{r=o.call(i.$data,e)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},b.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){b.a.Za(e,t())}},b.f.Z.text=!0,function(){if(i&&i.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=i.opera&&i.opera.version&&parseInt(i.opera.version()),r=i.navigator.userAgent,o=e(r.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),a=e(r.match(/Firefox\/([^ ]*)/));if(10>b.a.C)var s=b.a.e.I(),l=b.a.e.I(),u=function(e){var t=this.activeElement;(t=t&&b.a.e.get(t,l))&&t(e)},c=function(e,t){var n=e.ownerDocument;b.a.e.get(n,s)||(b.a.e.set(n,s,!0),b.a.p(n,"selectionchange",u)),b.a.e.set(e,l,t)};b.d.textInput={init:function(e,r,i){function s(t,n){b.a.p(e,t,n)}function l(){h||(d=e.value,h=b.a.setTimeout(u,4))}function u(){clearTimeout(h),d=h=n;var t=e.value;p!==t&&(p=t,b.h.Ea(r(),i,"textInput",t))}var h,d,p=e.value,f=9==b.a.C?l:u;10>b.a.C?(s("propertychange",function(e){"value"===e.propertyName&&f(e)}),8==b.a.C&&(s("keyup",u),s("keydown",u)),8<=b.a.C&&(c(e,f),s("dragend",l))):(s("input",u),5>o&&"textarea"===b.a.A(e)?(s("keydown",l),s("paste",l),s("cut",l)):11>t?s("keydown",l):4>a&&(s("DOMAutoComplete",u),s("dragdrop",u),s("drop",u))),s("change",u),b.m(function t(){var i=b.a.c(r());null!==i&&i!==n||(i=""),d!==n&&i===d?b.a.setTimeout(t,4):e.value!==i&&(p=i,e.value=i)},null,{i:e})}},b.h.ea.textInput=!0,b.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),b.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++b.d.uniqueName.Ic;b.a.rc(e,n)}}},b.d.uniqueName.Ic=0,b.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var r=["change"],i=n.get("valueUpdate"),o=!1,a=null;i&&("string"==typeof i&&(i=[i]),b.a.ra(r,i),r=b.a.Tb(r));var s=function(){a=null,o=!1;var r=t(),i=b.j.u(e);b.h.Ea(r,n,"value",i)};!b.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=b.a.o(r,"propertychange")||(b.a.p(e,"propertychange",function(){o=!0}),b.a.p(e,"focus",function(){o=!1}),b.a.p(e,"blur",function(){o&&s()})),b.a.q(r,function(t){var n=s;b.a.nd(t,"after")&&(n=function(){a=b.j.u(e),b.a.setTimeout(s,0)},t=t.substring(5)),b.a.p(e,t,n)});var l=function(){var r=b.a.c(t()),i=b.j.u(e);if(null!==a&&r===a)b.a.setTimeout(l,0);else if(r!==i)if("select"===b.a.A(e)){var o=n.get("valueAllowUnset");(i=function(){b.j.ha(e,r,o)})(),o||r===b.j.u(e)?b.a.setTimeout(i,0):b.l.w(b.a.Da,null,[e,"change"])}else b.j.ha(e,r)};b.m(l,null,{i:e})}else b.Ja(e,{checkedValue:t})},update:function(){}},b.h.ea.value=!0,b.d.visible={update:function(e,t){var n=b.a.c(t()),r="none"!=e.style.display;n&&!r?e.style.display="":!n&&r&&(e.style.display="none")}},b.d.click={init:function(e,t,n,r,i){return b.d.event.init.call(this,e,function(){var e={};return e.click=t(),e},n,r,i)}},b.O=function(){},b.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},b.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},b.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||a).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new b.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new b.v.qa(e);throw Error("Unknown template type: "+e)},b.O.prototype.renderTemplate=function(e,t,n,r){return e=this.makeTemplateSource(e,r),this.renderTemplateSource(e,t,n,r)},b.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},b.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},b.b("templateEngine",b.O),b.Gb=function(){function e(e,t,n,r){e=b.h.yb(e);for(var i=b.h.ta,o=0;o<e.length;o++){var a=e[o].key;if(i.hasOwnProperty(a)){var s=i[a];if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+b.h.Ua(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",r.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Oc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return b.Gb.dd(e,t)},n)},dd:function(r,i){return r.replace(t,function(t,n,r,o,a){return e(a,n,r,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Ec:function(e,t){return b.M.wb(function(n,r){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&b.Ja(i,e,r)})}}}(),b.b("__tr_ambtns",b.Gb.Ec),function(){b.v={},b.v.n=function(e){if(this.n=e){var t=b.a.A(e);this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},b.v.n.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?b.a.Cb(this.n,t):this.n[e]=t};var e=b.a.e.I()+"_";b.v.n.prototype.data=function(t){return 1===arguments.length?b.a.e.get(this.n,e+t):void b.a.e.set(this.n,e+t,arguments[1])};var t=b.a.e.I();b.v.n.prototype.nodes=function(){var e=this.n;return 0==arguments.length?(b.a.e.get(e,t)||{}).jb||(3===this.ab?e.content:4===this.ab?e:n):void b.a.e.set(e,t,{jb:arguments[0]})},b.v.qa=function(e){this.n=e},b.v.qa.prototype=new b.v.n,b.v.qa.prototype.text=function(){if(0==arguments.length){var e=b.a.e.get(this.n,t)||{};return e.Hb===n&&e.jb&&(e.Hb=e.jb.innerHTML),e.Hb}b.a.e.set(this.n,t,{Hb:arguments[0]})},b.b("templateSources",b.v),b.b("templateSources.domElement",b.v.n),b.b("templateSources.anonymousTemplate",b.v.qa)}(),function(){function e(e,t,n){var r;for(t=b.f.nextSibling(t);e&&(r=e)!==t;)e=b.f.nextSibling(r),n(r,e)}function t(t,n){if(t.length){var r=t[0],i=t[t.length-1],o=r.parentNode,a=b.Q.instance,s=a.preprocessNode;if(s){if(e(r,i,function(e,t){var n=e.previousSibling,o=s.call(a,e);o&&(e===r&&(r=o[0]||t),e===i&&(i=o[o.length-1]||n))}),t.length=0,!r)return;r===i?t.push(r):(t.push(r,i),b.a.za(t,o))}e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||b.Rb(n,e)}),e(r,i,function(e){1!==e.nodeType&&8!==e.nodeType||b.M.yc(e,[n])}),b.a.za(t,o)}}function r(e){return e.nodeType?e:0<e.length?e[0]:null}function i(e,n,i,o,s){s=s||{};var l=(e&&r(e)||i||{}).ownerDocument,u=s.templateEngine||a;if(b.Gb.Oc(i,u,l),"number"!=typeof(i=u.renderTemplate(i,o,s,l)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(l=!1,n){case"replaceChildren":b.f.da(e,i),l=!0;break;case"replaceNode":b.a.qc(e,i),l=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+n)}return l&&(t(i,o),s.afterRender&&b.l.w(s.afterRender,null,[i,o.$data])),i}function o(e,t,n){return b.H(e)?e():"function"==typeof e?e(t,n):e}var a;b.Db=function(e){if(e!=n&&!(e instanceof b.O))throw Error("templateEngine must inherit from ko.templateEngine");a=e},b.Ab=function(e,t,s,l,u){if(((s=s||{}).templateEngine||a)==n)throw Error("Set a template engine before calling renderTemplate");if(u=u||"replaceChildren",l){var c=r(l);return b.B(function(){var n=t&&t instanceof b.U?t:new b.U(b.a.c(t)),a=o(e,n.$data,n);n=i(l,u,a,n,s),"replaceNode"==u&&(c=r(l=n))},null,{wa:function(){return!c||!b.a.nb(c)},i:c&&"replaceNode"==u?c.parentNode:c})}return b.M.wb(function(n){b.Ab(e,t,s,n,"replaceNode")})},b.kd=function(e,r,a,s,l){function u(e,n){t(n,h),a.afterRender&&a.afterRender(n,e),h=null}function c(t,n){return h=l.createChildContext(t,a.as,function(e){e.$index=n}),i(null,"ignoreTargetNode",o(e,t,h),h,a)}var h;return b.B(function(){var e=b.a.c(r)||[];"undefined"==typeof e.length&&(e=[e]),e=b.a.Ka(e,function(e){return a.includeDestroyed||e===n||null===e||!b.a.c(e._destroy)}),b.l.w(b.a.Bb,null,[s,e,c,a,u])},null,{i:s})};var s=b.a.e.I();b.d.template={init:function(e,t){var n=b.a.c(t());if("string"==typeof n||n.name)b.f.xa(e);else{if("nodes"in n){if(b.H(n=n.nodes||[]))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=b.f.childNodes(e);n=b.a.jc(n),new b.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,r,i,o){var a,l=t();r=!0,i=null,"string"==typeof(t=b.a.c(l))?t={}:(l=t.name,"if"in t&&(r=b.a.c(t.if)),r&&"ifnot"in t&&(r=!b.a.c(t.ifnot)),a=b.a.c(t.data)),"foreach"in t?i=b.kd(l||e,r&&t.foreach||[],t,e,o):r?(o="data"in t?o.createChildContext(a,t.as):o,i=b.Ab(l||e,o,t,e)):b.f.xa(e),o=i,(a=b.a.e.get(e,s))&&"function"==typeof a.k&&a.k(),b.a.e.set(e,s,o&&o.ba()?o:n)}},b.h.ta.template=function(e){return 1==(e=b.h.yb(e)).length&&e[0].unknown||b.h.ad(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},b.f.Z.template=!0}(),b.b("setTemplateEngine",b.Db),b.b("renderTemplate",b.Ab),b.a.dc=function(e,t,n){var r,i,o,a,s;if(e.length&&t.length)for(r=i=0;(!n||r<n)&&(a=e[i]);++i){for(o=0;s=t[o];++o)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(o,1),r=o=0;break}r+=o}},b.a.ib=function(){function e(e,t,n,r,i){var o,a,s,l,u,c=Math.min,h=Math.max,d=[],p=e.length,f=t.length,m=f-p||1,_=p+f+1;for(o=0;o<=p;o++)for(l=s,d.push(s=[]),u=c(f,o+m),a=h(0,o-1);a<=u;a++)s[a]=a?o?e[o-1]===t[a-1]?l[a-1]:c(l[a]||_,s[a-1]||_)+1:a+1:o+1;for(c=[],h=[],m=[],o=p,a=f;o||a;)f=d[o][a]-1,a&&f===d[o][a-1]?h.push(c[c.length]={status:n,value:t[--a],index:a}):o&&f===d[o-1][a]?m.push(c[c.length]={status:r,value:e[--o],index:o}):(--a,--o,i.sparse||c.push({status:"retained",value:t[a]}));return b.a.dc(m,h,!i.dontLimitMoves&&10*p),c.reverse()}return function(t,n,r){return r="boolean"==typeof r?{dontLimitMoves:r}:r||{},(t=t||[]).length<(n=n||[]).length?e(t,n,"added","deleted",r):e(n,t,"deleted","added",r)}}(),b.b("utils.compareArrays",b.a.ib),function(){function e(e,t,r,i,o){var a=[],s=b.B(function(){var n=t(r,o,b.a.za(a,e))||[];0<a.length&&(b.a.qc(a,n),i&&b.l.w(i,null,[r,n,o])),a.length=0,b.a.ra(a,n)},null,{i:e,wa:function(){return!b.a.Qb(a)}});return{ca:a,B:s.ba()?s:n}}var t=b.a.e.I(),r=b.a.e.I();b.a.Bb=function(i,o,a,s,l){function u(e,t){w=p[t],v!==t&&(x[e]=w),w.qb(v++),b.a.za(w.ca,i),_.push(w),C.push(w)}function c(e,t){if(e)for(var n=0,r=t.length;n<r;n++)t[n]&&b.a.q(t[n].ca,function(r){e(r,n,t[n].ja)})}o=o||[],s=s||{};var h,d=b.a.e.get(i,t)===n,p=b.a.e.get(i,t)||[],f=b.a.fb(p,function(e){return e.ja}),m=b.a.ib(f,o,s.dontLimitMoves),_=[],g=0,v=0,y=[],C=[];o=[];for(var w,E,S,x=[],T=(f=[],0);E=m[T];T++)switch(S=E.moved,E.status){case"deleted":S===n&&((w=p[g]).B&&(w.B.k(),w.B=n),b.a.za(w.ca,i).length&&(s.beforeRemove&&(_.push(w),C.push(w),w.ja===r?w=null:o[T]=w),w&&y.push.apply(y,w.ca))),g++;break;case"retained":u(T,g++);break;case"added":S!==n?u(T,S):(w={ja:E.value,qb:b.N(v++)},_.push(w),C.push(w),d||(f[T]=w))}for(b.a.e.set(i,t,_),c(s.beforeMove,x),b.a.q(y,s.beforeRemove?b.$:b.removeNode),T=0,d=b.f.firstChild(i);w=C[T];T++){for(w.ca||b.a.extend(w,e(i,a,w.ja,l,w.qb)),g=0;m=w.ca[g];d=m.nextSibling,h=m,g++)m!==d&&b.f.gc(i,m,h);!w.Wc&&l&&(l(w.ja,w.ca,w.qb),w.Wc=!0)}for(c(s.beforeRemove,o),T=0;T<o.length;++T)o[T]&&(o[T].ja=r);c(s.afterMove,x),c(s.afterAdd,f)}}(),b.b("utils.setDomNodeChildrenFromArrayMapping",b.a.Bb),b.W=function(){this.allowTemplateRewriting=!1},b.W.prototype=new b.O,b.W.prototype.renderTemplateSource=function(e,t,n,r){return(t=9>b.a.C||!e.nodes?null:e.nodes())?b.a.V(t.cloneNode(!0).childNodes):(e=e.text(),b.a.ma(e,r))},b.W.sb=new b.W,b.Db(b.W.sb),b.b("nativeTemplateEngine",b.W),function(){b.vb=function(){var e=this.$c=function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,r,i){if(i=i||a,r=r||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var o=t.data("precompiled");return o||(o=t.text()||"",o=l.template(null,"{{ko_with $item.koBindingContext}}"+o+"{{/ko_with}}"),t.data("precompiled",o)),t=[n.$data],n=l.extend({koBindingContext:n},r.templateOptions),(n=l.tmpl(o,t,n)).appendTo(i.createElement("div")),l.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){a.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},b.vb.prototype=new b.O;var e=new b.vb;0<e.$c&&b.Db(e),b.b("jqueryTmplTemplateEngine",b.vb)}()},"function"==typeof o&&o.amd?o("ThirdParty/knockout-3.4.0",["exports","require"],r):r(e.exports||t)}(),o("ThirdParty/knockout-es5",[],function(){"use strict";function e(e,n){if(!e)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var r=this,i=t(e,!0);return(n=n||Object.getOwnPropertyNames(e)).forEach(function(t){if(t!==o&&t!==a&&!(t in i)){var n=e[t],s=n instanceof Array,l=r.isObservable(n)?n:s?r.observableArray(n):r.observable(n);Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:l,set:r.isWriteableObservable(l)?l:void 0}),i[t]=l,s&&(c=l,h=null,(u=r).computed(function(){h&&(h.dispose(),h=null);var e,t=c();t instanceof Array&&(e=c,h=function(e,t){var n,r,i,o,s,l,u,c=t[a];if(!c){c=new e.subscribable,Object.defineProperty(t,a,{value:c});var h={};s=t,l=c,u=h,["pop","push","reverse","shift","sort","splice","unshift"].forEach(function(e){var t=s[e];s[e]=function(){var e=t.apply(this,arguments);return!0!==u.pause&&l.notifySubscribers(this),e}}),n=e,r=t,i=c,o=h,["remove","removeAll","destroy","destroyAll","replace"].forEach(function(e){Object.defineProperty(r,e,{enumerable:!1,value:function(){var t;o.pause=!0;try{t=n.observableArray.fn[e].apply(n.observableArray(r),arguments)}finally{o.pause=!1}return i.notifySubscribers(r),t}})})}return c}(u,t).subscribe(e))}))}var u,c,h}),e}function t(e,t){var n=e[o];return!n&&t&&(n={},Object.defineProperty(e,o,{value:n})),n}function n(t,n,r){var i={owner:t,deferEvaluation:!0};if("function"==typeof r)i.read=r;else{if("value"in r)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if("function"!=typeof r.get)throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');i.read=r.get,i.write=r.set}return t[n]=this.computed(i),e.call(this,t,[n]),t}function r(e,n){if(!e)return null;var r=t(e,!1);return r&&r[n]||null}function i(e,t){var n=r(e,t);n&&n.valueHasMutated()}var o="__knockoutObservables",a="__knockoutSubscribable";return{attachToKo:function(t){t.track=e,t.getObservable=r,t.valueHasMutated=i,t.defineProperty=n}}}),o("Widgets/SvgPathBindingHandler",[],function(){"use strict";var e="http://www.w3.org/2000/svg";return{register:function(t){t.bindingHandlers.cesiumSvgPath={init:function(n,r){var i=document.createElementNS(e,"svg:svg");i.setAttribute("class","cesium-svgPath-svg");var o=document.createElementNS(e,"path");return i.appendChild(o),t.virtualElements.setDomNodeChildren(n,[i]),t.computed({read:function(){var e=t.unwrap(r());o.setAttribute("d",t.unwrap(e.path));var n=t.unwrap(e.width),a=t.unwrap(e.height);i.setAttribute("width",n),i.setAttribute("height",a),i.setAttribute("viewBox","0 0 "+n+" "+a),e.css&&i.setAttribute("class","cesium-svgPath-svg "+t.unwrap(e.css))},disposeWhenNodeIsRemoved:n}),{controlsDescendantBindings:!0}}},t.virtualElements.allowedBindings.cesiumSvgPath=!0}}}),o("ThirdParty/knockout",["./knockout-3.4.0","./knockout-es5","../Widgets/SvgPathBindingHandler"],function(e,t,n){"use strict";return t.attachToKo(e),n.register(e),e}),o("ThirdParty/NoSleep",[],function(){"use strict";function e(e,t,n){var r=document.createElement("source");r.src=n,r.type="video/"+t,e.appendChild(r)}var t="undefined"!=typeof navigator&&/Android/gi.test(navigator.userAgent),n="undefined"!=typeof navigator&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),r=function(){return n?this.noSleepTimer=null:t&&(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("loop",""),e(this.noSleepVideo,"webm","data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA="),e(this.noSleepVideo,"mp4","data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw==")),this};return r.prototype.enable=function(e){n?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location=window.location,window.setTimeout(window.stop,0)},e||15e3)):t&&this.noSleepVideo.play()},r.prototype.disable=function(){n?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):t&&this.noSleepVideo.pause()},r}),o("Widgets/subscribeAndEvaluate",["../ThirdParty/knockout"],function(e){"use strict";return function(t,n,r,i,o){return r.call(i,t[n]),e.getObservable(t,n).subscribe(r,i,o)}}),o("Widgets/Animation/Animation",["../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../getElement","../subscribeAndEvaluate"],function(e,t,n,r,i,o,a){"use strict";function s(t){return e.fromCssColorString(window.getComputedStyle(t).getPropertyValue("color"))}function l(e){var t=document.createElementNS(m,e.tagName);for(var n in e)if(e.hasOwnProperty(n)&&"tagName"!==n)if("children"===n){var r,i=e.children.length;for(r=0;r<i;++r)t.appendChild(l(e.children[r]))}else 0===n.indexOf("xlink:")?t.setAttributeNS(_,n.substring(6),e[n]):"textContent"===n?t.textContent=e[n]:t.setAttribute(n,e[n]);return t}function u(e,t,n){var r=document.createElementNS(m,"text");r.setAttribute("x",e),r.setAttribute("y",t),r.setAttribute("class","cesium-animation-svgText");var i=document.createElementNS(m,"tspan");return i.textContent=n,r.appendChild(i),r}function c(e,t){var n=t.alpha,r=1-n;return x.red=e.red*r+t.red*n,x.green=e.green*r+t.green*n,x.blue=e.blue*r+t.blue*n,x.toCssColorString()}function h(e,t,n){return l({tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":n},{tagName:"title",textContent:""}]})}function d(e,t){this._viewModel=t,this.svgElement=e,this._enabled=void 0,this._toggled=void 0;var n=this;this._clickFunction=function(){var e=n._viewModel.command;e.canExecute&&e()},e.addEventListener("click",this._clickFunction,!0),this._subscriptions=[a(t,"toggled",this.setToggled,this),a(t,"tooltip",this.setTooltip,this),a(t.command,"canExecute",this.setEnabled,this)]}function p(e,t){function n(e){!function(e,t){var n=e._viewModel,r=n.shuttleRingDragging;if(!r||f===e)if("mousedown"===t.type||r&&"mousemove"===t.type||"touchstart"===t.type&&1===t.touches.length||r&&"touchmove"===t.type&&1===t.touches.length){var i,o,a=e._centerX,s=e._centerY,l=e._svgNode.getBoundingClientRect();if("touchstart"===t.type||"touchmove"===t.type?(i=t.touches[0].clientX,o=t.touches[0].clientY):(i=t.clientX,o=t.clientY),!r&&(i>l.right||i<l.left||o<l.top||o>l.bottom))return;var u=e._shuttleRingPointer.getBoundingClientRect(),c=180*Math.atan2(o-s-l.top,i-a-l.left)/Math.PI+90;c>180&&(c-=360);var h=n.shuttleRingAngle;r||i<u.right&&i>u.left&&o>u.top&&o<u.bottom?(f=e,n.shuttleRingDragging=!0,n.shuttleRingAngle=c):c<h?n.slower():c>h&&n.faster(),t.preventDefault()}else e===f&&(f=void 0),n.shuttleRingDragging=!1}(E,e)}e=o(e),this._viewModel=t,this._container=e,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;var r=document.createElement("style");r.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",document.head.insertBefore(r,document.head.childNodes[0]);var i=document.createElement("div");i.className="cesium-animation-theme",i.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=i,this._themeNormal=i.childNodes[0],this._themeHover=i.childNodes[1],this._themeSelect=i.childNodes[2],this._themeDisabled=i.childNodes[3],this._themeKnob=i.childNodes[4],this._themePointer=i.childNodes[5],this._themeSwoosh=i.childNodes[6],this._themeSwooshHover=i.childNodes[7];var s=document.createElementNS(m,"svg:svg");this._svgNode=s,s.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",_);var c=document.createElementNS(m,"g");this._topG=c,this._realtimeSVG=new d(l({tagName:"g",class:"cesium-animation-rectButton",transform:"translate(3,4)",children:[{tagName:"use",class:"cesium-animation-buttonGlow","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonMain","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":"#animation_pathClock"},{tagName:"title",textContent:""}]}),t.playRealtimeViewModel),this._playReverseSVG=new d(h(44,99,"#animation_pathPlayReverse"),t.playReverseViewModel),this._playForwardSVG=new d(h(124,99,"#animation_pathPlay"),t.playForwardViewModel),this._pauseSVG=new d(h(84,99,"#animation_pathPause"),t.pauseViewModel);var p=document.createElementNS(m,"g");p.appendChild(this._realtimeSVG.svgElement),p.appendChild(this._playReverseSVG.svgElement),p.appendChild(this._playForwardSVG.svgElement),p.appendChild(this._pauseSVG.svgElement);var g=l({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=g;var v=l({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:"use",transform:"translate(100,97) scale(-1,1)","xlink:href":"#animation_pathSwooshFX"},{tagName:"use",transform:"translate(100,97)","xlink:href":"#animation_pathSwooshFX"},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=v,this._shuttleRingPointer=l({tagName:"use",class:"cesium-animation-shuttleRingPointer","xlink:href":"#animation_pathPointer"});var y=l({tagName:"g",transform:"translate(100,100)"});this._knobOuter=l({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});var C=l({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:61});this._knobDate=u(0,-24,""),this._knobTime=u(0,-7,""),this._knobStatus=u(0,-41,"");var w=l({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:61}),b=document.createElementNS(m,"g");b.setAttribute("class","cesium-animation-shuttleRingG"),e.appendChild(i),c.appendChild(b),c.appendChild(y),c.appendChild(p),b.appendChild(g),b.appendChild(v),b.appendChild(this._shuttleRingPointer),y.appendChild(this._knobOuter),y.appendChild(C),y.appendChild(this._knobDate),y.appendChild(this._knobTime),y.appendChild(this._knobStatus),y.appendChild(w),s.appendChild(c),e.appendChild(s);var E=this;this._mouseCallback=n,g.addEventListener("mousedown",n,!0),g.addEventListener("touchstart",n,!0),v.addEventListener("mousedown",n,!0),v.addEventListener("touchstart",n,!0),document.addEventListener("mousemove",n,!0),document.addEventListener("touchmove",n,!0),document.addEventListener("mouseup",n,!0),document.addEventListener("touchend",n,!0),document.addEventListener("touchcancel",n,!0),this._shuttleRingPointer.addEventListener("mousedown",n,!0),this._shuttleRingPointer.addEventListener("touchstart",n,!0),this._knobOuter.addEventListener("mousedown",n,!0),this._knobOuter.addEventListener("touchstart",n,!0);var S,x=this._knobTime.childNodes[0],T=this._knobDate.childNodes[0],A=this._knobStatus.childNodes[0];this._subscriptions=[a(t.pauseViewModel,"toggled",function(e){S!==e&&E._shuttleRingPointer.setAttribute("class",(S=e)?"cesium-animation-shuttleRingPausePointer":"cesium-animation-shuttleRingPointer")}),a(t,"shuttleRingAngle",function(e){var t,n;t=E._knobOuter,E._shuttleRingPointer.setAttribute("transform","translate(100,100) rotate("+(n=e)+")"),t.setAttribute("transform","rotate("+n+")")}),a(t,"dateLabel",function(e){T.textContent!==e&&(T.textContent=e)}),a(t,"timeLabel",function(e){x.textContent!==e&&(x.textContent=e)}),a(t,"multiplierLabel",function(e){A.textContent!==e&&(A.textContent=e)})],this.applyThemeChanges(),this.resize()}var f,m="http://www.w3.org/2000/svg",_="http://www.w3.org/1999/xlink",g=e.fromCssColorString("rgba(247,250,255,0.384)"),v=e.fromCssColorString("rgba(143,191,255,0.216)"),y=e.fromCssColorString("rgba(153,197,255,0.098)"),C=e.fromCssColorString("rgba(255,255,255,0.086)"),w=e.fromCssColorString("rgba(255,255,255,0.267)"),b=e.fromCssColorString("rgba(255,255,255,0)"),E=e.fromCssColorString("rgba(66,67,68,0.3)"),S=e.fromCssColorString("rgba(0,0,0,0.5)"),x=new e;return d.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);for(var e=this._subscriptions,t=0,n=e.length;t<n;t++)e[t].dispose();r(this)},d.prototype.isDestroyed=function(){return!1},d.prototype.setEnabled=function(e){if(this._enabled!==e){if(this._enabled=e,!e)return void this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");if(this._toggled)return void this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");this.svgElement.setAttribute("class","cesium-animation-rectButton")}},d.prototype.setToggled=function(e){this._toggled!==e&&(this._toggled=e,this._enabled&&this.svgElement.setAttribute("class",e?"cesium-animation-rectButton cesium-animation-buttonToggled":"cesium-animation-rectButton"))},d.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e},n(p.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),p.prototype.isDestroyed=function(){return!1},p.prototype.destroy=function(){var e=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",e,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",e,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",e,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",e,!0),document.removeEventListener("mousemove",e,!0),document.removeEventListener("touchmove",e,!0),document.removeEventListener("mouseup",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("touchcancel",e,!0),this._shuttleRingPointer.removeEventListener("mousedown",e,!0),this._shuttleRingPointer.removeEventListener("touchstart",e,!0),this._knobOuter.removeEventListener("mousedown",e,!0),this._knobOuter.removeEventListener("touchstart",e,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();for(var t=this._subscriptions,n=0,i=t.length;n<i;n++)t[n].dispose();return r(this)},p.prototype.resize=function(){var e=this._container.clientWidth,t=this._container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){var n=this._svgNode,r=e,i=t;0===e&&0===t?(r=200,i=132):0===e?(i=t,r=t/132*200):0===t&&(r=e,i=e/200*132);var o=r/200,a=i/132;n.style.cssText="width: "+r+"px; height: "+i+"px; position: absolute; bottom: 0; left: 0; overflow: hidden;",n.setAttribute("width",r),n.setAttribute("height",i),n.setAttribute("viewBox","0 0 "+r+" "+i),this._topG.setAttribute("transform","scale("+o+","+a+")"),this._centerX=Math.max(1,100*o),this._centerY=Math.max(1,100*a),this._lastHeight=e,this._lastWidth=t}},p.prototype.applyThemeChanges=function(){var e=s(this._themeNormal),n=s(this._themeHover),r=s(this._themeSelect),i=s(this._themeDisabled),o=s(this._themeKnob),a=s(this._themePointer),u=s(this._themeSwoosh),h=s(this._themeSwooshHover),d=l({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":c(e,g)},{tagName:"stop",offset:"12%","stop-color":c(e,v)},{tagName:"stop",offset:"46%","stop-color":c(e,y)},{tagName:"stop",offset:"81%","stop-color":c(e,C)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":c(n,g)},{tagName:"stop",offset:"12%","stop-color":c(n,v)},{tagName:"stop",offset:"46%","stop-color":c(n,y)},{tagName:"stop",offset:"81%","stop-color":c(n,C)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":c(r,g)},{tagName:"stop",offset:"12%","stop-color":c(r,v)},{tagName:"stop",offset:"46%","stop-color":c(r,y)},{tagName:"stop",offset:"81%","stop-color":c(r,C)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":c(i,w)},{tagName:"stop",offset:"75%","stop-color":c(i,b)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":u.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":u.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":h.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":h.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":h.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":a.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":c(a,S)},{tagName:"stop",offset:"100%","stop-color":c(a,S)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":c(o,g)},{tagName:"stop",offset:"60%","stop-color":c(o,E)},{tagName:"stop",offset:"85%","stop-color":c(o,v)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":c(o,E)},{tagName:"stop",offset:"60%","stop-color":c(o,g)},{tagName:"stop",offset:"85%","stop-color":c(o,C)}]},{id:"animation_pathReset",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},{id:"animation_pathPause",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},{id:"animation_pathPlay",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathPlayReverse",tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathLoop",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},{id:"animation_pathClock",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},{id:"animation_pathWingButton",tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},{id:"animation_pathPointer",tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},{id:"animation_pathSwooshFX",tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}]});t(this._defsElement)?this._svgNode.replaceChild(d,this._defsElement):this._svgNode.appendChild(d),this._defsElement=d},p}),o("Widgets/createCommand",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../Core/Event","../ThirdParty/knockout"],function(e,t,n,r,i,o){"use strict";return function(t,r){function a(){var e,n={args:arguments,cancel:!1};return s.raiseEvent(n),n.cancel||(e=t.apply(null,arguments),l.raiseEvent(e)),e}r=e(r,!0);var s=new i,l=new i;return a.canExecute=r,o.track(a,["canExecute"]),n(a,{beforeExecute:{value:s},afterExecute:{value:l}}),a}}),o("Widgets/ToggleButtonViewModel",["../Core/defaultValue","../Core/defined","../Core/defineProperties","../Core/DeveloperError","../ThirdParty/knockout"],function(e,t,n,r,i){"use strict";function o(t,n){this._command=t,n=e(n,e.EMPTY_OBJECT),this.toggled=e(n.toggled,!1),this.tooltip=e(n.tooltip,""),i.track(this,["toggled","tooltip"])}return n(o.prototype,{command:{get:function(){return this._command}}}),o}),o("Widgets/Animation/AnimationViewModel",["../../Core/binarySearch","../../Core/ClockRange","../../Core/ClockStep","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/JulianDate","../../ThirdParty/knockout","../../ThirdParty/sprintf","../createCommand","../ToggleButtonViewModel"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e,t){return e-t}function d(t,n){var r=e(n,t,h);return r<0?~r:r}function p(e){var r=this;this._clockViewModel=e,this._allShuttleRingTicks=[],this._dateFormatter=p.defaultDateFormatter,this._timeFormatter=p.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,s.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(p.defaultTicks),this.timeLabel=void 0,s.defineProperty(this,"timeLabel",function(){return r._timeFormatter(r._clockViewModel.currentTime,r)}),this.dateLabel=void 0,s.defineProperty(this,"dateLabel",function(){return r._dateFormatter(r._clockViewModel.currentTime,r)}),this.multiplierLabel=void 0,s.defineProperty(this,"multiplierLabel",function(){var e=r._clockViewModel;if(e.clockStep===n.SYSTEM_CLOCK)return"Today";var t=e.multiplier;return t%1==0?t.toFixed(0)+"x":t.toFixed(3).replace(/0{0,3}$/,"")+"x"}),this.shuttleRingAngle=void 0,s.defineProperty(this,"shuttleRingAngle",{get:function(){return function(t,r,i){if(e.clockStep===n.SYSTEM_CLOCK)return m;if(Math.abs(t)<=1)return t*m;var o=r[r.length-1];t>o?t=o:t<-o&&(t=-o);var a,s=m,l=_;return t>0?(a=(Math.log(o)-0)/(l-s),(Math.log(t)-0)/a+s):(a=(Math.log(-r[0])-0)/(l-s),-((Math.log(Math.abs(t))-0)/a+s))}(e.multiplier,r._allShuttleRingTicks)},set:function(e){e=Math.max(Math.min(e,_),-_);var t=r._allShuttleRingTicks,i=r._clockViewModel;if(i.clockStep=n.SYSTEM_CLOCK_MULTIPLIER,Math.abs(e)!==_){var o=function(e,t){if(Math.abs(e)<=m)return e/m;var n,r=m,i=_;return e>0?(n=(Math.log(t[t.length-1])-0)/(i-r),Math.exp(0+n*(e-r))):(n=(Math.log(-t[0])-0)/(i-r),-Math.exp(0+n*(Math.abs(e)-r)))}(e,t);if(r.snapToTicks)o=t[d(o,t)];else if(0!==o){var a=Math.abs(o);if(a>100){var s=a.toFixed(0).length-2,l=Math.pow(10,s);o=Math.round(o/l)*l|0}else a>m?o=Math.round(o):a>1?o=+o.toFixed(1):a>0&&(o=+o.toFixed(2))}i.multiplier=o}else i.multiplier=e>0?t[t.length-1]:t[0]}}),this._canAnimate=void 0,s.defineProperty(this,"_canAnimate",function(){var e=r._clockViewModel,n=e.clockRange;if(r.shuttleRingDragging||n===t.UNBOUNDED)return!0;var i=e.multiplier,o=e.currentTime,s=e.startTime,l=!1;if(n===t.LOOP_STOP)l=a.greaterThan(o,s)||o.equals(s)&&i>0;else{var u=e.stopTime;l=a.greaterThan(o,s)&&a.lessThan(o,u)||o.equals(s)&&i>0||o.equals(u)&&i<0}return l||(e.shouldAnimate=!1),l}),this._isSystemTimeAvailable=void 0,s.defineProperty(this,"_isSystemTimeAvailable",function(){var e=r._clockViewModel;if(e.clockRange===t.UNBOUNDED)return!0;var n=e.systemTime;return a.greaterThanOrEquals(n,e.startTime)&&a.lessThanOrEquals(n,e.stopTime)}),this._isAnimating=void 0,s.defineProperty(this,"_isAnimating",function(){return r._clockViewModel.shouldAnimate&&(r._canAnimate||r.shuttleRingDragging)});var i=u(function(){var e=r._clockViewModel;e.shouldAnimate?e.shouldAnimate=!1:r._canAnimate&&(e.shouldAnimate=!0)});this._pauseViewModel=new c(i,{toggled:s.computed(function(){return!r._isAnimating}),tooltip:"Pause"});var o=u(function(){var e=r._clockViewModel,t=e.multiplier;t>0&&(e.multiplier=-t),e.shouldAnimate=!0});this._playReverseViewModel=new c(o,{toggled:s.computed(function(){return r._isAnimating&&e.multiplier<0}),tooltip:"Play Reverse"});var l=u(function(){var e=r._clockViewModel,t=e.multiplier;t<0&&(e.multiplier=-t),e.shouldAnimate=!0});this._playForwardViewModel=new c(l,{toggled:s.computed(function(){return r._isAnimating&&e.multiplier>0&&e.clockStep!==n.SYSTEM_CLOCK}),tooltip:"Play Forward"});var h=u(function(){r._clockViewModel.clockStep=n.SYSTEM_CLOCK},s.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new c(h,{toggled:s.computed(function(){return e.clockStep===n.SYSTEM_CLOCK}),tooltip:s.computed(function(){return r._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"})}),this._slower=u(function(){var e=r._clockViewModel,t=r._allShuttleRingTicks,n=d(e.multiplier,t)-1;n>=0&&(e.multiplier=t[n])}),this._faster=u(function(){var e=r._clockViewModel,t=r._allShuttleRingTicks,n=d(e.multiplier,t)+1;n<t.length&&(e.multiplier=t[n])})}var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],m=15,_=105;return p.defaultDateFormatter=function(e,t){var n=a.toGregorianDate(e);return f[n.month-1]+" "+n.day+" "+n.year},p.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800],p.defaultTimeFormatter=function(e,t){var n=a.toGregorianDate(e),r=Math.round(n.millisecond);return Math.abs(t._clockViewModel.multiplier)<1?l("%02d:%02d:%02d.%03d",n.hour,n.minute,n.second,r):l("%02d:%02d:%02d UTC",n.hour,n.minute,n.second)},p.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)},p.prototype.setShuttleRingTicks=function(e){var t,n,r,i={},o=this._sortedFilteredPositiveTicks;for(o.length=0,t=0,n=e.length;t<n;++t)r=e[t],i.hasOwnProperty(r)||(i[r]=!0,o.push(r));o.sort(h);var a=[];for(t=(n=o.length)-1;t>=0;--t)r=o[t],0!==r&&a.push(-r);Array.prototype.push.apply(a,o),this._allShuttleRingTicks=a},i(p.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){this._timeFormatter=e}}}),p._maxShuttleRingAngle=_,p._realtimeShuttleRingAngle=m,p}),o("Widgets/BaseLayerPicker/BaseLayerPickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EllipsoidTerrainProvider","../../Core/isArray","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i,o,a,s){"use strict";function l(n){var r=(n=e(n,e.EMPTY_OBJECT)).globe,l=e(n.imageryProviderViewModels,[]),u=e(n.terrainProviderViewModels,[]);this._globe=r,this.imageryProviderViewModels=l.slice(0),this.terrainProviderViewModels=u.slice(0),this.dropDownVisible=!1,a.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]),this.buttonTooltip=void 0,a.defineProperty(this,"buttonTooltip",function(){var e=this.selectedImagery,n=this.selectedTerrain,r=t(e)?e.name:void 0,i=t(n)?n.name:void 0;return t(r)&&t(i)?r+"\n"+i:t(r)?r:i}),this.buttonImageUrl=void 0,a.defineProperty(this,"buttonImageUrl",function(){var e=this.selectedImagery;return t(e)?e.iconUrl:void 0}),this.selectedImagery=void 0;var c=a.observable();this._currentImageryProviders=[],a.defineProperty(this,"selectedImagery",{get:function(){return c()},set:function(e){if(c()!==e){var n,r=this._currentImageryProviders,i=r.length,a=this._globe.imageryLayers;for(n=0;n<i;n++)for(var s=a.length,l=0;l<s;l++){var u=a.get(l);if(u.imageryProvider===r[n]){a.remove(u);break}}if(t(e)){var h=e.creationCommand();if(o(h)){for(n=h.length-1;n>=0;n--)a.addImageryProvider(h[n],0);this._currentImageryProviders=h.slice(0)}else this._currentImageryProviders=[h],a.addImageryProvider(h,0)}c(e),this.dropDownVisible=!1}else this.dropDownVisible=!1}}),this.selectedTerrain=void 0;var h=a.observable();a.defineProperty(this,"selectedTerrain",{get:function(){return h()},set:function(e){var n;h()!==e?(t(e)&&(n=e.creationCommand()),this._globe.depthTestAgainstTerrain=!(n instanceof i),this._globe.terrainProvider=n,h(e),this.dropDownVisible=!1):this.dropDownVisible=!1}});var d=this;this._toggleDropDown=s(function(){d.dropDownVisible=!d.dropDownVisible}),this.selectedImagery=e(n.selectedImageryProviderViewModel,l[0]),this.selectedTerrain=e(n.selectedTerrainProviderViewModel,u[0])}return n(l.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}}),l}),o("Widgets/BaseLayerPicker/BaseLayerPicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./BaseLayerPickerViewModel"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t){e=a(e);var n=new s(t),r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button",r.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),e.appendChild(r);var l=document.createElement("img");l.setAttribute("draggable","false"),l.className="cesium-baseLayerPicker-selected",l.setAttribute("data-bind","attr: { src: buttonImageUrl }"),r.appendChild(l);var u=document.createElement("div");u.className="cesium-baseLayerPicker-dropDown",u.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),e.appendChild(u);var c=document.createElement("div");c.className="cesium-baseLayerPicker-sectionTitle",c.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),c.innerHTML="Imagery",u.appendChild(c);var h=document.createElement("div");h.className="cesium-baseLayerPicker-choices",h.setAttribute("data-bind","foreach: imageryProviderViewModels"),u.appendChild(h);var d=document.createElement("div");d.className="cesium-baseLayerPicker-item",d.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedImagery = $data; }'),h.appendChild(d);var p=document.createElement("img");p.className="cesium-baseLayerPicker-itemIcon",p.setAttribute("data-bind","attr: { src: iconUrl }"),p.setAttribute("draggable","false"),d.appendChild(p);var f=document.createElement("div");f.className="cesium-baseLayerPicker-itemLabel",f.setAttribute("data-bind","text: name"),d.appendChild(f);var m=document.createElement("div");m.className="cesium-baseLayerPicker-sectionTitle",m.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),m.innerHTML="Terrain",u.appendChild(m);var _=document.createElement("div");_.className="cesium-baseLayerPicker-choices",_.setAttribute("data-bind","foreach: terrainProviderViewModels"),u.appendChild(_);var g=document.createElement("div");g.className="cesium-baseLayerPicker-item",g.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parent.selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parent.selectedTerrain = $data; }'),_.appendChild(g);var v=document.createElement("img");v.className="cesium-baseLayerPicker-itemIcon",v.setAttribute("data-bind","attr: { src: iconUrl }"),v.setAttribute("draggable","false"),g.appendChild(v);var y=document.createElement("div");y.className="cesium-baseLayerPicker-itemLabel",y.setAttribute("data-bind","text: name"),g.appendChild(y),o.applyBindings(n,r),o.applyBindings(n,u),this._viewModel=n,this._container=e,this._element=r,this._dropPanel=u,this._closeDropDown=function(e){r.contains(e.target)||u.contains(e.target)||(n.dropDownVisible=!1)},i.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}return t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return i.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),o.cleanNode(this._element),o.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),n(this)},l}),o("Widgets/BaseLayerPicker/ProviderViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i){"use strict";function o(t){var n=t.creationFunction;e(n.canExecute)||(n=i(n)),this._creationCommand=n,this.name=t.name,this.tooltip=t.tooltip,this.iconUrl=t.iconUrl,r.track(this,["name","tooltip","iconUrl"])}return t(o.prototype,{creationCommand:{get:function(){return this._creationCommand}}}),o}),o("Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels",["../../Core/buildModuleUrl","../../Scene/ArcGisMapServerImageryProvider","../../Scene/BingMapsImageryProvider","../../Scene/BingMapsStyle","../../Scene/createOpenStreetMapImageryProvider","../../Scene/createTileMapServiceImageryProvider","../../Scene/MapboxImageryProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,n,r,i,o,a,s){"use strict";return function(){var l=[];return l.push(new s({name:"Bing Maps Aerial",iconUrl:e("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery \nhttp://www.bing.com/maps",creationFunction:function(){return new n({url:"https://dev.virtualearth.net",mapStyle:r.AERIAL})}})),l.push(new s({name:"Bing Maps Aerial with Labels",iconUrl:e("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with label overlays \nhttp://www.bing.com/maps",creationFunction:function(){return new n({url:"https://dev.virtualearth.net",mapStyle:r.AERIAL_WITH_LABELS})}})),l.push(new s({name:"Bing Maps Roads",iconUrl:e("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps\nhttp://www.bing.com/maps",creationFunction:function(){return new n({url:"https://dev.virtualearth.net",mapStyle:r.ROAD})}})),l.push(new s({name:"Mapbox Satellite",tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxSatellite.png"),creationFunction:function(){return new a({mapId:"mapbox.satellite"})}})),l.push(new s({name:"Mapbox Streets",tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxTerrain.png"),creationFunction:function(){return new a({mapId:"mapbox.streets"})}})),l.push(new s({name:"Mapbox Streets Classic",tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",iconUrl:e("Widgets/Images/ImageryProviders/mapboxStreets.png"),creationFunction:function(){return new a({mapId:"mapbox.streets-basic"})}})),l.push(new s({name:"ESRI World Imagery",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:!1})}})),l.push(new s({name:"ESRI World Street Map",iconUrl:e("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:!1})}})),l.push(new s({name:"ESRI National Geographic",iconUrl:e("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.\nhttp://www.esri.com",creationFunction:function(){return new t({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:!1})}})),l.push(new s({name:"Open\xadStreet\xadMap",iconUrl:e("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",creationFunction:function(){return i({url:"https://a.tile.openstreetmap.org/"})}})),l.push(new s({name:"Stamen Watercolor",iconUrl:e("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttp://maps.stamen.com",creationFunction:function(){return i({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),l.push(new s({name:"Stamen Toner",iconUrl:e("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map.\nhttp://maps.stamen.com",creationFunction:function(){return i({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),l.push(new s({name:"The Black Marble",iconUrl:e("Widgets/Images/ImageryProviders/blackMarble.png"),tooltip:"The lights of cities and villages trace the outlines of civilization in this global view of the Earth at night as seen by NASA/NOAA's Suomi NPP satellite.",creationFunction:function(){return o({url:"https://cesiumjs.org/blackmarble",flipXY:!0,credit:"Black Marble imagery courtesy NASA Earth Observatory"})}})),l.push(new s({name:"Natural Earth\xa0II",iconUrl:e("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",creationFunction:function(){return o({url:e("Assets/Textures/NaturalEarthII")})}})),l}}),o("Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels",["../../Core/buildModuleUrl","../../Core/CesiumTerrainProvider","../../Core/EllipsoidTerrainProvider","../BaseLayerPicker/ProviderViewModel"],function(e,t,n,r){"use strict";return function(){var i=[];return i.push(new r({name:"WGS84 Ellipsoid",iconUrl:e("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",creationFunction:function(){return new n}})),i.push(new r({name:"STK World Terrain meshes",iconUrl:e("Widgets/Images/TerrainProviders/STK.png"),tooltip:"High-resolution, mesh-based terrain for the entire globe. Free for use on the Internet. Closed-network options are available.\nhttp://www.agi.com",creationFunction:function(){return new t({url:"https://assets.agi.com/stk-terrain/world",requestWaterMask:!0,requestVertexNormals:!0})}})),i}}),o("Widgets/CesiumInspector/CesiumInspectorViewModel",["../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Rectangle","../../Core/ScreenSpaceEventHandler","../../Core/ScreenSpaceEventType","../../Scene/DebugModelMatrixPrimitive","../../Scene/PerformanceDisplay","../../Scene/TileCoordinatesImageryProvider","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i,o,a,s,l,u,c,h,d){"use strict";function p(e,t,n){var r=Math.min(n,t);return Math.max(r,e)}function f(e,n){function r(e){_.removeInputAction(s.LEFT_CLICK),f.pickPrimitiveActive=!1;var n=f._scene.pick({x:e.position.x,y:e.position.y});t(n)&&(f.primitive=t(n.collection)?n.collection:n.primitive)}function i(e){var n,r=v.ellipsoid,i=f._scene.camera.pickEllipsoid({x:e.position.x,y:e.position.y},r);if(t(i))for(var a=r.cartesianToCartographic(i),l=v._surface.tileProvider._tilesToRenderByTextureCount,u=0;!n&&u<l.length;++u){var c=l[u];if(t(c))for(var h=0;!n&&h<c.length;++h){var d=c[h];o.contains(d.rectangle,a)&&(n=d)}}f.tile=n,_.removeInputAction(s.LEFT_CLICK),f.pickTileActive=!1}var f=this,m=e.canvas,_=new a(m);this._eventHandler=_,this._scene=e,this._canvas=m,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=n;var g,v=this._scene.globe;v.depthTestAgainstTerrain=!0,this.frustums=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.globeDepth=!1,this.pickDepth=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.depthFrustumText="1 of 1",this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText="",this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.generalSwitchText="-",this.primitivesSwitchText="+",this.terrainSwitchText="+",h.track(this,["filterTile","suspendUpdates","dropDownVisible","shaderCacheText","frustums","frustumStatisticText","pickTileActive","pickPrimitiveActive","hasPickedPrimitive","hasPickedTile","tileText","generalVisible","generalSwitchText","primitivesVisible","primitivesSwitchText","terrainVisible","terrainSwitchText","depthFrustumText"]),this._toggleDropDown=d(function(){f.dropDownVisible=!f.dropDownVisible}),this._toggleGeneral=d(function(){f.generalVisible=!f.generalVisible,f.generalSwitchText=f.generalVisible?"-":"+"}),this._togglePrimitives=d(function(){f.primitivesVisible=!f.primitivesVisible,f.primitivesSwitchText=f.primitivesVisible?"-":"+"}),this._toggleTerrain=d(function(){f.terrainVisible=!f.terrainVisible,f.terrainSwitchText=f.terrainVisible?"-":"+"}),this._showFrustums=d(function(){return f._scene.debugShowFrustums=!!f.frustums,!0}),this._showPerformance=d(function(){return f.performance?f._performanceDisplay=new u({container:f._performanceContainer}):f._performanceContainer.innerHTML="",!0}),this._showPrimitiveBoundingSphere=d(function(){return f._primitive.debugShowBoundingVolume=f.primitiveBoundingSphere,!0}),this._showPrimitiveReferenceFrame=d(function(){return f.primitiveReferenceFrame?(f._modelMatrixPrimitive=new l({modelMatrix:f._primitive.modelMatrix}),f._scene.primitives.add(f._modelMatrixPrimitive)):t(f._modelMatrixPrimitive)&&(f._scene.primitives.remove(f._modelMatrixPrimitive),f._modelMatrixPrimitive=void 0),!0}),this._doFilterPrimitive=d(function(){return f._scene.debugCommandFilter=f.filterPrimitive?function(e){return!(!t(f._modelMatrixPrimitive)||e.owner!==f._modelMatrixPrimitive._primitive)||!!t(f._primitive)&&(e.owner===f._primitive||e.owner===f._primitive._billboardCollection||e.owner.primitive===f._primitive)}:void 0,!0}),this._showWireframe=d(function(){return v._surface.tileProvider._debug.wireframe=f.wireframe,!0}),this._showGlobeDepth=d(function(){return f._scene.debugShowGlobeDepth=f.globeDepth,!0}),this._showPickDepth=d(function(){return f._scene.debugShowPickDepth=f.pickDepth,!0}),this._incrementDepthFrustum=d(function(){return f.depthFrustum=p(1,f._numberOfFrustums,f.depthFrustum+1),f.scene.debugShowDepthFrustum=f.depthFrustum,!0}),this._decrementDepthFrustum=d(function(){return f.depthFrustum=p(1,f._numberOfFrustums,f.depthFrustum-1),f.scene.debugShowDepthFrustum=f.depthFrustum,!0}),this._doSuspendUpdates=d(function(){return v._surface._debug.suspendLodUpdate=f.suspendUpdates,f.suspendUpdates||(f.filterTile=!1),!0}),this._showTileCoordinates=d(function(){return f.tileCoordinates&&!t(g)?g=e.imageryLayers.addImageryProvider(new c({tilingScheme:e.terrainProvider.tilingScheme})):!f.tileCoordinates&&t(g)&&(e.imageryLayers.remove(g),g=void 0),!0}),this._showTileBoundingSphere=d(function(){return v._surface.tileProvider._debug.boundingSphereTile=f.tileBoundingSphere?f._tile:void 0,!0}),this._doFilterTile=d(function(){return f.filterTile?(f.suspendUpdates=!0,f.doSuspendUpdates(),v._surface._tilesToRender=[],t(f._tile)&&v._surface._tilesToRender.push(f._tile)):(f.suspendUpdates=!1,f.doSuspendUpdates()),!0}),this._pickPrimitive=d(function(){f.pickPrimitiveActive=!f.pickPrimitiveActive,f.pickPrimitiveActive?_.setInputAction(r,s.LEFT_CLICK):_.removeInputAction(s.LEFT_CLICK)}),this._pickTile=d(function(){f.pickTileActive=!f.pickTileActive,f.pickTileActive?_.setInputAction(i,s.LEFT_CLICK):_.removeInputAction(s.LEFT_CLICK)})}return n(f.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showFrustums:{get:function(){return this._showFrustums}},showPerformance:{get:function(){return this._showPerformance}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},showWireframe:{get:function(){return this._showWireframe}},showGlobeDepth:{get:function(){return this._showGlobeDepth}},showPickDepth:{get:function(){return this._showPickDepth}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},doSuspendUpdates:{get:function(){return this._doSuspendUpdates}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){var e=this;return d(function(){e.tile=e.tile.parent})}},selectNW:{get:function(){var e=this;return d(function(){e.tile=e.tile.children[0]})}},selectNE:{get:function(){var e=this;return d(function(){e.tile=e.tile.children[1]})}},selectSW:{get:function(){var e=this;return d(function(){e.tile=e.tile.children[2]})}},selectSE:{get:function(){var e=this;return d(function(){e.tile=e.tile.children[3]})}},primitive:{set:function(e){var n=this._primitive;e!==n&&(this.hasPickedPrimitive=!0,t(n)&&(n.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,t(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=e,e.show=!1,setTimeout(function(){e.show=!0},50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())},get:function(){return this._primitive}},tile:{set:function(e){t(e)?(this.hasPickedTile=!0,e!==this._tile&&(this.tileText="L: "+e.level+" X: "+e.x+" Y: "+e.y,this.tileText+="<br>SW corner: "+e.rectangle.west+", "+e.rectangle.south,this.tileText+="<br>NE corner: "+e.rectangle.east+", "+e.rectangle.north,this.tileText+="<br>Min: "+e.data.minimumHeight+" Max: "+e.data.maximumHeight),this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()):(this.hasPickedTile=!1,this._tile=void 0)},get:function(){return this._tile}},update:{get:function(){var e=this;return function(){e.frustums&&(e.frustumStatisticText=function(e){var n;if(t(e)){n="Command Statistics";var r=e.commandsInFrustums;for(var i in r)if(r.hasOwnProperty(i)){var o,a=parseInt(i,10);if(7===a)o="1, 2 and 3";else{for(var s=[],l=2;l>=0;l--){var u=Math.pow(2,l);a>=u&&(s.push(l+1),a-=u)}o=s.reverse().join(" and ")}n+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+r[i]+" in frustum "+o}n+="<br>Total: "+e.totalCommands}return n}(e._scene.debugFrustumStatistics));var n=e._scene.numberOfFrustums;e._numberOfFrustums=n;var r=p(1,n,e.depthFrustum);e.depthFrustum=r,e.scene.debugShowDepthFrustum=r,e.depthFrustumText=r+" of "+n,e.performance&&e._performanceDisplay.update(),e.primitiveReferenceFrame&&(e._modelMatrixPrimitive.modelMatrix=e._primitive.modelMatrix),e.shaderCacheText="Cached shaders: "+e._scene.context.shaderCache.numberOfShaders}}}}),f.prototype.isDestroyed=function(){return!1},f.prototype.destroy=function(){return this._eventHandler.destroy(),r(this)},f}),o("Widgets/CesiumInspector/CesiumInspector",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./CesiumInspectorViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e,t){e=o(e);var n=document.createElement("div"),r=new a(t,n);this._viewModel=r,this._container=e;var s=document.createElement("div");this._element=s;var l=document.createElement("div");l.textContent="Cesium Inspector",l.className="cesium-cesiumInspector-button",l.setAttribute("data-bind","click: toggleDropDown"),s.appendChild(l),s.className="cesium-cesiumInspector",s.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);var u=document.createElement("div");this._panel=u,u.className="cesium-cesiumInspector-dropDown",s.appendChild(u);var c=document.createElement("div");c.className="cesium-cesiumInspector-sectionHeader";var h=document.createElement("span");h.className="cesium-cesiumInspector-toggleSwitch",h.setAttribute("data-bind","click: toggleGeneral, text: generalSwitchText"),c.appendChild(h),c.appendChild(document.createTextNode("General")),u.appendChild(c);var d=document.createElement("div");d.className="cesium-cesiumInspector-section",d.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : generalVisible, "cesium-cesiumInspector-hide" : !generalVisible}'),u.appendChild(d);var p=document.createElement("div");d.appendChild(p);var f=document.createElement("div");f.className="cesium-cesiumInspector-frustumStats",f.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : frustums, "cesium-cesiumInspector-hide" : !frustums}, html: frustumStatisticText');var m=document.createElement("input");m.type="checkbox",m.setAttribute("data-bind","checked: frustums, click: showFrustums"),p.appendChild(m),p.appendChild(document.createTextNode("Show Frustums")),p.appendChild(f);var _=document.createElement("div");d.appendChild(_);var g=document.createElement("input");g.type="checkbox",g.setAttribute("data-bind","checked: performance, click: showPerformance"),_.appendChild(g),_.appendChild(document.createTextNode("Performance Display")),n.className="cesium-cesiumInspector-performanceDisplay",d.appendChild(n);var v=document.createElement("div");v.className="cesium-cesiumInspector-shaderCache",v.setAttribute("data-bind","html: shaderCacheText"),d.appendChild(v);var y=document.createElement("div");d.appendChild(y);var C=document.createElement("input");C.type="checkbox",C.setAttribute("data-bind","checked: globeDepth, click: showGlobeDepth"),y.appendChild(C),y.appendChild(document.createTextNode("Show globe depth"));var w=document.createElement("div");y.appendChild(w);var b=document.createElement("div");d.appendChild(b);var E=document.createElement("input");E.type="checkbox",E.setAttribute("data-bind","checked: pickDepth, click: showPickDepth"),b.appendChild(E),b.appendChild(document.createTextNode("Show pick depth"));var S=document.createElement("div");d.appendChild(S);var x=document.createElement("span");x.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),S.appendChild(x);var T=document.createElement("span");T.setAttribute("data-bind","text: depthFrustumText"),S.appendChild(T);var A=document.createElement("input");A.type="button",A.value="-",A.className="cesium-cesiumInspector-pickButton",A.setAttribute("data-bind","click: decrementDepthFrustum"),S.appendChild(A);var P=document.createElement("input");P.type="button",P.value="+",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind","click: incrementDepthFrustum"),S.appendChild(P);var D=document.createElement("div");D.className="cesium-cesiumInspector-sectionHeader",(h=document.createElement("span")).className="cesium-cesiumInspector-toggleSwitch",h.setAttribute("data-bind","click: togglePrimitives, text: primitivesSwitchText"),D.appendChild(h),D.appendChild(document.createTextNode("Primitives")),u.appendChild(D);var M=document.createElement("div");M.className="cesium-cesiumInspector-section",M.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : primitivesVisible, "cesium-cesiumInspector-hide" : !primitivesVisible}'),u.appendChild(M);var I=document.createElement("div");I.className="cesium-cesiumInspector-pickSection",M.appendChild(I);var O=document.createElement("input");O.type="button",O.value="Pick a primitive",O.className="cesium-cesiumInspector-pickButton",O.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');var R=document.createElement("div");R.className="cesium-cesiumInspector-center",R.appendChild(O),I.appendChild(R);var N=document.createElement("div");I.appendChild(N);var L=document.createElement("input");L.type="checkbox",L.setAttribute("data-bind","checked: primitiveBoundingSphere, click: showPrimitiveBoundingSphere, enable: hasPickedPrimitive"),N.appendChild(L),N.appendChild(document.createTextNode("Show bounding sphere"));var F=document.createElement("div");I.appendChild(F);var B=document.createElement("input");B.type="checkbox",B.setAttribute("data-bind","checked: primitiveReferenceFrame, click: showPrimitiveReferenceFrame, enable: hasPickedPrimitive"),F.appendChild(B),F.appendChild(document.createTextNode("Show reference frame"));var k=document.createElement("div");this._primitiveOnly=k,I.appendChild(k);var V=document.createElement("input");V.type="checkbox",V.setAttribute("data-bind","checked: filterPrimitive, click: doFilterPrimitive, enable: hasPickedPrimitive"),k.appendChild(V),k.appendChild(document.createTextNode("Show only selected"));var z=document.createElement("div");z.className="cesium-cesiumInspector-sectionHeader",(h=document.createElement("span")).className="cesium-cesiumInspector-toggleSwitch",h.setAttribute("data-bind","click: toggleTerrain, text: terrainSwitchText"),z.appendChild(h),z.appendChild(document.createTextNode("Terrain")),u.appendChild(z);var U=document.createElement("div");U.className="cesium-cesiumInspector-section",U.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : terrainVisible, "cesium-cesiumInspector-hide" : !terrainVisible}'),u.appendChild(U);var G=document.createElement("div");G.className="cesium-cesiumInspector-pickSection",U.appendChild(G);var W=document.createElement("input");W.type="button",W.value="Pick a tile",W.className="cesium-cesiumInspector-pickButton",W.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),(R=document.createElement("div")).appendChild(W),R.className="cesium-cesiumInspector-center",G.appendChild(R);var H=document.createElement("div");G.appendChild(H);var j=document.createElement("input");j.type="button",j.value="Parent",j.className="cesium-cesiumInspector-pickButton",j.setAttribute("data-bind","click: selectParent");var q=document.createElement("input");q.type="button",q.value="NW",q.className="cesium-cesiumInspector-pickButton",q.setAttribute("data-bind","click: selectNW");var Y=document.createElement("input");Y.type="button",Y.value="NE",Y.className="cesium-cesiumInspector-pickButton",Y.setAttribute("data-bind","click: selectNE");var X=document.createElement("input");X.type="button",X.value="SW",X.className="cesium-cesiumInspector-pickButton",X.setAttribute("data-bind","click: selectSW");var Z=document.createElement("input");Z.type="button",Z.value="SE",Z.className="cesium-cesiumInspector-pickButton",Z.setAttribute("data-bind","click: selectSE");var K=document.createElement("div");K.className="cesium-cesiumInspector-tileText",H.className="cesium-cesiumInspector-frustumStats",H.appendChild(K),H.setAttribute("data-bind",'css: {"cesium-cesiumInspector-show" : hasPickedTile, "cesium-cesiumInspector-hide" : !hasPickedTile}'),K.setAttribute("data-bind","html: tileText");var Q=document.createElement("div");Q.className="cesium-cesiumInspector-relativeText",Q.textContent="Select relative:",H.appendChild(Q);var J=document.createElement("table"),$=document.createElement("tr"),ee=document.createElement("tr"),te=document.createElement("td");te.appendChild(j);var ne=document.createElement("td");ne.appendChild(q);var re=document.createElement("td");re.appendChild(Y),$.appendChild(te),$.appendChild(ne),$.appendChild(re);var ie=document.createElement("td"),oe=document.createElement("td");oe.appendChild(X);var ae=document.createElement("td");ae.appendChild(Z),ee.appendChild(ie),ee.appendChild(oe),ee.appendChild(ae),J.appendChild($),J.appendChild(ee),H.appendChild(J);var se=document.createElement("div");G.appendChild(se);var le=document.createElement("input");le.type="checkbox",le.setAttribute("data-bind","checked: tileBoundingSphere, enable: hasPickedTile, click: showTileBoundingSphere"),se.appendChild(le),se.appendChild(document.createTextNode("Show bounding volume"));var ue=document.createElement("div");G.appendChild(ue);var ce=document.createElement("input");ce.type="checkbox",ce.setAttribute("data-bind","checked: filterTile, enable: hasPickedTile, click: doFilterTile"),ue.appendChild(ce),ue.appendChild(document.createTextNode("Show only selected"));var he=document.createElement("div");U.appendChild(he);var de=document.createElement("input");de.type="checkbox",de.setAttribute("data-bind","checked: wireframe, click: showWireframe"),he.appendChild(de),he.appendChild(document.createTextNode("Wireframe"));var pe=document.createElement("div");U.appendChild(pe);var fe=document.createElement("input");fe.type="checkbox",fe.setAttribute("data-bind","checked: suspendUpdates, click: doSuspendUpdates"),pe.appendChild(fe),pe.appendChild(document.createTextNode("Suspend LOD update"));var me=document.createElement("div");U.appendChild(me);var _e=document.createElement("input");_e.type="checkbox",_e.setAttribute("data-bind","checked: tileCoordinates, click: showTileCoordinates"),me.appendChild(_e),me.appendChild(document.createTextNode("Show tile coordinates")),i.applyBindings(r,this._element)}return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return i.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),n(this)},s}),o("Widgets/CesiumWidget/CesiumWidget",["../../Core/buildModuleUrl","../../Core/Cartesian3","../../Core/Clock","../../Core/Credit","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Ellipsoid","../../Core/FeatureDetection","../../Core/formatError","../../Core/requestAnimationFrame","../../Core/ScreenSpaceEventHandler","../../Scene/BingMapsImageryProvider","../../Scene/Globe","../../Scene/Moon","../../Scene/Scene","../../Scene/SceneMode","../../Scene/ShadowMode","../../Scene/SkyAtmosphere","../../Scene/SkyBox","../../Scene/Sun","../getElement"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E){"use strict";function S(t){return e("Assets/Textures/SkyBox/tycho2t3_80_"+t+".jpg")}function x(e){var t=e._canvas,n=t.clientWidth,r=t.clientHeight,o=e._resolutionScale;e._supportsImageRenderingPixelated||(o*=i(window.devicePixelRatio,1)),e._canvasWidth=n,e._canvasHeight=r,r*=o,t.width=n*=o,t.height=r,e._canRender=0!==n&&0!==r}function T(e){var t=e._canvas,n=t.width,r=t.height;if(0!==n&&0!==r){var i=e._scene.camera.frustum;o(i.aspectRatio)?i.aspectRatio=n/r:(i.top=i.right*(r/n),i.bottom=-i.top)}}function A(e,a){e=E(e),a=i(a,{});var s=document.createElement("div");s.className="cesium-widget",e.appendChild(s);var l=document.createElement("canvas"),h=c.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=h,h&&(l.style.imageRendering=c.imageRenderingValue()),l.oncontextmenu=function(){return!1},l.onselectstart=function(){return!1},s.appendChild(l);var d=document.createElement("div");d.className="cesium-widget-credits",(o(a.creditContainer)?E(a.creditContainer):s).appendChild(d);var A=i(a.showRenderLoopErrors,!0);this._element=s,this._container=e,this._canvas=l,this._canvasWidth=0,this._canvasHeight=0,this._creditContainer=d,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=A,this._resolutionScale=1,this._forceResize=!1,this._clock=o(a.clock)?a.clock:new n,x(this);try{var D=new g({canvas:l,contextOptions:a.contextOptions,creditContainer:d,mapProjection:a.mapProjection,orderIndependentTranslucency:a.orderIndependentTranslucency,scene3DOnly:i(a.scene3DOnly,!1),terrainExaggeration:a.terrainExaggeration,shadows:a.shadows,mapMode2D:a.mapMode2D});this._scene=D,D.camera.constrainedAxis=t.UNIT_Z,T(this);var M=i(D.mapProjection.ellipsoid,u.WGS84),I=D.frameState.creditDisplay,O=new r("Cesium",P,"http://cesiumjs.org/");I.addDefaultCredit(O);var R=a.globe;o(R)||(R=new m(M)),!1!==R&&(D.globe=R,D.globe.shadows=i(a.terrainShadows,y.RECEIVE_ONLY));var N=a.skyBox;o(N)||(N=new w({sources:{positiveX:S("px"),negativeX:S("mx"),positiveY:S("py"),negativeY:S("my"),positiveZ:S("pz"),negativeZ:S("mz")}})),!1!==N&&(D.skyBox=N,D.sun=new b,D.moon=new _);var L=a.skyAtmosphere;o(L)||(L=new C(M)),!1!==L&&(D.skyAtmosphere=L);var F=!1!==a.globe&&a.imageryProvider;o(F)||(F=new f({url:"https://dev.virtualearth.net"})),!1!==F&&D.imageryLayers.addImageryProvider(F),o(a.terrainProvider)&&!1!==a.globe&&(D.terrainProvider=a.terrainProvider),this._screenSpaceEventHandler=new p(l,!1),o(a.sceneMode)&&(a.sceneMode===v.SCENE2D&&this._scene.morphTo2D(0),a.sceneMode===v.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=i(a.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=a.targetFrameRate;var B=this;D.renderError.addEventListener(function(e,t){B._useDefaultRenderLoop=!1,B._renderLoopRunning=!1,B._showRenderLoopErrors&&B.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)})}catch(e){throw A&&this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',e),e}}var P="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHYAAAAaCAYAAABikagwAAAAAXNSR0IArs4c6QAAAAlwSFlzAAAN1wAADdcBQiibeAAAAAd0SU1FB9wGGRQyF371QVsAABOHSURBVGje7Vp5cFTHmf91v2Nm3owGnYMuEEJCOBiEjDlsDMYQjGMOOwmXcWxiLywpJ9iuTXZd612corJssFOxi8LerXizxEGUvWsivNxxHHCQ8WYBYSFzmUMCCXQjaUajOd/V+4f6Kc14kI/KZv/xq+p6M/PmO15/9/c1wa0vwpcMQAHgBuAFoPG7mz8jAGwASQBxADFhJQGYACwAjK+vrr/AJQ8jVMqfuwH4AGQByAaQnTNqXGHWqHGFbq8/g1BJsgw9GQ12Bds/qWsxEvEeAEEAfQDCAKKCgPGVcP//BOsIVQHgAZAJIACgsHTqvDvK7150T2bR2DFaZm6W4slwUypR20yaiUg4OtDbcaP36rlPPt6/7f2B3q5mAB0AeriAE18J9y93kVu4X4W73BwAhQBK5v/gZ98ZVXXvDG92IJMx569MQDEoK0tPmOHu1s4L7799sH7vtvcAXAPQCaCfu2qLu+7h+Eh3sS8Bcyt48iVgPos2+4J7jS+BIx2etDBSynfH/Xq46y0CUL70n3/zXMmUuXepWoZHFCQhFIQARCBFJYV6/Nn+QHnVBH9Ovq/51JFWADpfJhcqEzyDcx9ukTTr/xr2VnDpng0nuHR0h1u3wvWF6EspgBIAFYAfQAGAsuU/rfm7kePvvJ0QiTj6QSgBISS9ujEGSikkxaXklIwfK8uK2Xru2HVurWKspZyezGmmWwp/LqVsupPQub4grPQ5YIejKQvPJAGflLLJSBGmxPEqKXhU4XdJEBq7BR5Z+L+DKx3MTTHWEaybx9WCud/btCJQMeX2Qevk+NPoks0YPArF/RUj0NyXxOmO2CAy1a1OmL9yUVfTmatXTx52EildYFQVNlgRmBR1xQJgCBbPBAVUhcw8lTObLz0FVk4RIEmJJyJNZzFBiCTFBRL+f50rriFUATRFiZSU/XYEAw6X5LlIUghZqXvl5p8pfycRZsgjymlKGw1Adm7JbRUVs785nwGghP5pp9mfFMOxWstmuC3gwdcrRqA/buJUWwyKRMAYgydrZNZt9337623njn+ixyN9nAmdM5nBvYOPfxc3mnEmTQ4T5VZv8hfz8aUKnocJd5tvVhxAhOMADzNefleFjRUFa/D/xzi8LQhIEpTG4VXnNBzlZYISufk7juCfqaAoLkHYcZ6HBAEM8O+ObJz3HcFDpJfDJwWYfiHMMTklviocKHv6I3+zRFLdKhEEatmALBFIBIibNhQ6KFyJEjT2JHDoUj/a+nVIVIBhBGOnzptWXzhmTFfT2TZBOH4AgSeeeGJqRUVFqdfr9btcLnVQXwapmqZpJZPJRCgUCh47duzie++9dwWAXl5enrlp06bF0WhUM01TYYwRrmg2vzNKqS3Lsunz+Yy6urpTP//5z09blkVLSkryVq9ePT03NzegqqqbUnqTGyOEMNM0k319fX2///3vz9bW1l4DYD700EPFy5Ytm65pmvbBBx9c2rp166Wnnnqq7MEHH5zAGIu8/vrr+w8ePPgJVwrRO2gAcg8cOLA2mUx62tvbB9avX39s+fLlo++///5JXNiwbXugpqam9tChQ2cEj6NzuQwlsi+//PKSzMzMQtu2qcfjMZqbm09v2LDht4J3sQEQOU2Jo8mKKzt7VEU5lSgFBi3PZkBZrgv3lGbCo1Jc7I7iSGN40JcQgoGkhXdO94ESQJEoGI+1k/M9mDKqQHEv++akl186e45rNAAE3njjjccWLFhwfyAQyJEkiabGbcc7JJNJva2trX3Lli3vvPbaa+eKi4uLV6xY8d10cf5TcZ8x5OXl5b366qs9lFLtrbfeWldVVXW7pmkuxhjS0SSEIJlMGitXrrz2/PPPv1lTU3NtypQp0x955JG/kmVZdrlcR7du3WrOnTt33pIlS+YDwNGjR68ePHiwjVtukm+wI9ichQsXPgUAHR0d3evXr78xc+bMu9asWbOQUjpENz8/v/jQoUP/IiiH40UzAeQvW7Zs1rp16/7a5/NpDr/19fWlGzZsOM4tNsphkc5iPaXTvl6uuDUvY4MZLwNQ4Ffw+LR8+KQQTCuJSQUFcMsEe88FoSkSKCFwyWSISQbg9pEefHdGAJHIdUydVjFecL3K448/Pm3hwoUPBAKBHFGIlmU5pRCRpMGEze12q2PHjh2zatWqeTt37gwODAxkOQIJhUJ6Y2Njn6IojFJqE0KYsGyPx0POnTvXnUgkfGvXrr1j5syZU7iFsKampv5YLBZ34GzbJgAwatSo7MzMTE95eXnZT37yk0dramr+PRQKZSQSCdPn88nBYNADID8UCmkAYBiGGQ6Hna6cksbdZliWZUuSRKPRKAAUBINBfywWM30+n+yEtenTp9+5YsWKGTt37oxwz+a44RwARc8+++xSr9eriQrY398v8311CUncTTHN0Q7Vl1OQJymq4iBwyxQPT8qDVwri1d1/i8ttp/AP39mOBeMn41pQx9mOGFSZ3qT52ZqMR6aMRGvXKfzbgX9Ea3PnSLEdOWXKlK/5/X4/AFy8ePHG6tWr90QikS5VVaOEEIsxRhljngcffLBi8+bNjxBCUFJSMrKkpMRvGIbboXP27Nn+2bNn/3cgEIgSQmKEEAOARQixKKVxRVEioVAoYtu2dMcdd4x24Hbv3t3+ox/96ONoNBqklMa4ppNkMinNnz8///nnn6/y+Xw0mUxaANy6rrsdl28YhguAX9d1F98jwn9TUjJkJ5N1DWV0ti0ByDAMw+PsbzQatX0+Hy0oKMhcvnz5nP3791+IxWJRIUaPfO655+ZVVlaOA4BoNGprmkZ5uJJThZouKyYAqOrWVEKoE7cwszQDlQUK3jr8S5y++iEIIXh55/fwylOH8e3KHHSEdfQnLFBuRbJEsLQyF27Sh3eO/iuudV+EaSuqkJF6MjMzs9xutwIAv/rVr06eOHHiEwCtPBHQOaPaxYsXLxcXF8cKCwtzOzo6+ltbW4OFhYU+h2nDMAgAqbu7W8xkLSEBcsos1bbtocZIIBBQs7Ky5Pb2dkvXdV1wfaipqemsqak5yF1bFABljNEU4Sj87nia1LKHCJWGLLh6AkDhiksAoLq6um/VqlWZWVlZ8gMPPHDHwoULK2tqasJcYJ7y8vKyb33rW/f4/X43YwybNm26vnnz5pIUb0tvVe44maSVjEfizDJtmwFlOS4srczGiQvv4ncnd4ASAkIo+mN92LLrB/j7Vb/GQxOz8Z/1PTDsQXc6p3QEqopU7Dr6S5y8fAiKpCKhs6SQSUqyLKsO4d7e3j4AvbxD1csFQQF4EolEaP369TVCFjuiqKiogG8w5s6dm8sY++ZwcfbZZ5/dvHXr1isnT55scVz+rFmz8urr6xc4Ls22bZZIJExd181oNGr09PREDx06dPmFF144Ho/HTVGIjiE4guECoyl1LYTPcppGEAghDAAikUjixRdfbHnppZfKfD6fa82aNfMOHz7cHgwGbwBwr1ix4u677rqrgsfU4I4dO66lCPZTXSkqpOaMa60e7mjuosw0RmYoWHf3SLT3NOKt91+CbsZBeOlDCcX5luP4rw9fw4wSH+4p9cMlU3xtpAfLJmej/vIR7PnjLyDRwXeKhoxubokWAOYkDXxTLE5brB11oTZMCrWoNQgymJwZhsHC4bAZjUaNaDRqxGIx3VnxeDzJky8TQGLHjh3n9u3bd6ytrS3U2dkZ6e3tjfX398cHBgYS8XjcIIQQr9frKioq8ldWVhb88Ic/vHfbtm3zAXhs25aHUx7uEt1COeXEXM3JfAWLvWnSxRhLbNu2rampqSlMCME3vvGNyXPmzKkCUFZeXn776tWr72WMwbZtvPDCCx+5XK6wo6BcOdhwQ4Chuu/KR39onDGS9T80u9ivkgiqD/0UbT2NcKvelMaEhXfrqlGaPwEPT5qH0lwvqopcaOtpxPb3/gmGmYBEFRBC0HUlfp67tQQALxMKYsaYU+tlcSadNN8NIOO+++4bnZ2d7Q+Hw+zIkSNJxtiQ9TQ1NUW3bNnSmJWVlZBlWaeUWs5SVTUxYsSIRF1dXScAwzTN2MMPP7w3Pz//ZFVVVUFubq7L6/VKmqZRl8ulKIriVlVVmz59ev6cOXMCLpeLLliwYDyAOpGm08SglA659mQy6eHTrwiPtRYXbi6vP2/yjI61AoDL5Ur09vZ2bt++/ezGjRvvppSSjRs3Lti9e/fvnnzyyfHjx48fyRjDwYMHL9TW1jYWFhZ6xfIs3UhUTlPQRwGE9Gv/c/ba9YGi2rPv0FONf/iUUB3Lj8SDqD60GYtmdGBcYSVOnL+K39b9Gp19zVDkwZzBSpLY9Qv9Z3lKHgOgmaYZd9zg1KlTS994441L3G3lcD6oo/1btmxZFwgEctrb27vWrFlzwLIs2cmKW1pa4q+//vp1AbchdIKiPGZHAJDFixcHpk+ffnsoFNLefvvt3ra2Nl0YSDhdt4zy8vLwsWPHsl0ul6ooigSACuEZXKBJwzAMxhhUVZW8Xm8uH5hQ3mCwOf95VVVVYx03yQVhUEpNQbBxADfefPPN6NKlS8dUVlYWVlZW5r344osz1q1bV8IYQzAYjFVXV5+IxWIdkiTlpfDCUgcC6Sw2CqBvw4ZN+7/9d+Wzo1avT5HU9N1tMpj4dfU14z/efxletx9xPYpIPAhVccO2bVBKcf189I/h3mSLkBi5b9y40RWLxZJer9f12GOPTa6oqMjq6enpJYQYlFLGyx21tLQ0MGnSpDGEECQSCZMQIjuNCF6aqI8++mheVlZWJrdYkzcoLEVREj6fL1FfX39x165dzfPnzy/7/ve/v1LXdWvlypVde/bsuRKLxQyn1LEsS2aMeebNm1fs8/lkxhgsy7IAJBRF0Yc2TZZ1AANNTU0djoJt2rRpzqxZs/K6urq6JUnSCSHMMAxZ07SsxYsXV1JKCWMMAwMDMQBhVVWTjtU6gr1y5Yq1d+/ej8aNG5eraZr6zDPPjPV4PBJjDLW1ted27dr1MYCYqqpDcpMkyRIaEyydxToxNgagr7e3t+XEe0rNxPkjnvhTznNr4Sb0KBL6YO9BovJQnRXptTqaPgr9wTLsDgAhTkOurq4+unz58vs1TRvl9/vVuXPnljHGxgqxw2GcEjLYJLlw4cKV06dPd06bNo04+MePH+/ftm3bNNG1iW5KVVVl//79ew4cONC8d+/ey88884ysKIp85513jpo8eXJh2pHX4EUIITh58uRFAN1utzvHcb0ejycGoKuurk5vbW29u7i4ODB69OisJ5988i4xxDhsKIoiEUJgmqZ94MCBOgBdmqaVODxrmhbhiaP+4x//+N2lS5dOmjBhwhiPxyMBQFdXV191dfX7tm23AdBdLtdQzFYUxWmb3iRcmqbh7vQfOz9+v/PdjvP6kcHuE288MJZWuM4Smw1mgkQvHw/v6Wga+BjADY53AEDfmTNnLq9du/Znp06datB13RA3ROwGmaZphcPhgX379v326aefftO27Tafz9fJGGOmadqMMSbLMpEkiaZbjDFommYQQsK1tbWNr7zyymvhcLifEIJbwRBCmGVZ1vHjxz9atGjRLwA0Z2dndzpdHb/fHwTQcuLEiYann3761fPnz3+i67pBCCGUUkoIofwjpZQS27ZZd3f3ja1bt1Zv3LhxL4CrmZmZPYQQkxCCjIyMEIB2AG0Amrdv3/6beDweNwzD1nXdPHXq1Indu3cf48+7MjIyupw98ng8EW4wCWH4kHbQLgsnJ4oAlN332Ji1hbeps6lEaLohQLrhQCJi9zcei77TcLh9H4CrALp4rLN5LBvBE4scAP6JEyfmBQIBL6VUopSCMcYGBgYSly5dCvX19YW5QkQAmD6fz3PvvfeWxmIxr2EYHqFXPBRrKKWWJEmG1+uNtbW1dTU0NNzgz7wA/OXl5bkFBQV+XsYQwVpZMpk0jh8/3snpRQCYo0aN8k6YMCHX5XLRa9euBRsaGnr4Jnp458c7ceLEbK/X6xL5MQzDbGhoCNq2HeO4YgBYWVmZv6KiIkdVVbS0tHQ3NDR0CsORrDlz5oyllHoYY3p9ff31cDjczeGhaVrGkiVLSg3DkLu7u/s+/PDDFn4UKeJYLhnmAJvGs9QCAKOnLMhfNHqSNl/LlHOpTORbWa4et2ORXqv1wgf9NVfO9B7nTYcuPvlICq02t9CJ8ggjOJomodOF0ZQtHNvxCC08pBnbmcIhO53jdA7mpXaKUkOSWGoxYaaKlIa7IozT0uET+XDGehDGhhBGb6bTmBHezeb8OyNPCPQk/ptzeHConCSfcZDNI1hWQXaBVl5254hZmSPVce4MKUdxEQ+VJMnUbcNIWJFoyOzoa02eOX2k+yg/79TFNWkgZchOUobe4vA63WzUEmpYsa+dCoM0Izgz5aQkTUOPpGvUpKFJBaUR8Q03cLdT8NkppyEgPGOCYcnCiNASsn2SwrstDA2Gxnbkc5xSdHGrcmaBWYoqZ+YUe4pcXuqXJCobupWIhaze3vZohzAfdOaKN2mSwPxwR0ZSZ6uptZoIN9yxFCYIiqV5v3THStgwNNPhvtXxFgzDP9K8q52Cj6ZRNnaLffoUDfI5zhVLgrvxCN0Ux5URYXYYF84Wf2qqf4uDV591ZuiLHir7c8F+mZOU5M+Iazg8n3mYjnxORkV3I6dxg6KrMQW3Yaexlq+uv8D1v2IL+t4z3B/NAAAAAElFTkSuQmCC";return a(A.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&function(e){e._renderLoopRunning=!0;var t=0;d(function n(r){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{var i=e._targetFrameRate;if(o(i)){var a=1e3/i,s=r-t;s>a&&(e.resize(),e.render(),t=r-s%a),d(n)}else e.resize(),e.render(),d(n)}catch(t){e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors&&e.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}else e._renderLoopRunning=!1})}(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){this._resolutionScale=e,this._forceResize=!0}}}),A.prototype.showErrorPanel=function(e,t,n){function r(){u.style.maxHeight=Math.max(Math.round(.9*i.clientHeight-100),30)+"px"}var i=this._element,a=document.createElement("div");a.className="cesium-widget-errorPanel";var s=document.createElement("div");s.className="cesium-widget-errorPanel-content",a.appendChild(s);var l=document.createElement("div");l.className="cesium-widget-errorPanel-header",l.appendChild(document.createTextNode(e)),s.appendChild(l);var u=document.createElement("div");if(u.className="cesium-widget-errorPanel-scroll",s.appendChild(u),r(),o(window.addEventListener)&&window.addEventListener("resize",r,!1),o(t)){var c=document.createElement("div");c.className="cesium-widget-errorPanel-message",c.innerHTML="<p>"+t+"</p>",u.appendChild(c)}var d="(no error details available)";o(n)&&(d=h(n));var p=document.createElement("div");p.className="cesium-widget-errorPanel-message",p.appendChild(document.createTextNode(d)),u.appendChild(p);var f=document.createElement("div");f.className="cesium-widget-errorPanel-buttonPanel",s.appendChild(f);var m=document.createElement("button");m.setAttribute("type","button"),m.className="cesium-button",m.appendChild(document.createTextNode("OK")),m.onclick=function(){o(r)&&o(window.removeEventListener)&&window.removeEventListener("resize",r,!1),i.removeChild(a)},f.appendChild(m),i.appendChild(a),"undefined"!=typeof console&&console.error(e+"\n"+t+"\n"+d)},A.prototype.isDestroyed=function(){return!1},A.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy(),this._container.removeChild(this._element),s(this)},A.prototype.resize=function(){var e=this._canvas;(this._forceResize||this._canvasWidth!==e.clientWidth||this._canvasHeight!==e.clientHeight)&&(this._forceResize=!1,x(this),T(this))},A.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else this._clock.tick()},A}),o("Widgets/ClockViewModel",["../Core/Clock","../Core/defined","../Core/defineProperties","../Core/destroyObject","../Core/EventHelper","../Core/JulianDate","../ThirdParty/knockout"],function(e,t,n,r,i,o,a){"use strict";function s(n){t(n)||(n=new e),this._clock=n,this._eventHelper=new i,this._eventHelper.add(n.onTick,this.synchronize,this),this.systemTime=a.observable(o.now()),this.systemTime.equalityComparer=o.equals,this.startTime=a.observable(n.startTime),this.startTime.equalityComparer=o.equals,this.startTime.subscribe(function(e){n.startTime=e,this.synchronize()},this),this.stopTime=a.observable(n.stopTime),this.stopTime.equalityComparer=o.equals,this.stopTime.subscribe(function(e){n.stopTime=e,this.synchronize()},this),this.currentTime=a.observable(n.currentTime),this.currentTime.equalityComparer=o.equals,this.currentTime.subscribe(function(e){n.currentTime=e,this.synchronize()},this),this.multiplier=a.observable(n.multiplier),this.multiplier.subscribe(function(e){n.multiplier=e,this.synchronize()},this),this.clockStep=a.observable(n.clockStep),this.clockStep.subscribe(function(e){n.clockStep=e,this.synchronize()},this),this.clockRange=a.observable(n.clockRange),this.clockRange.subscribe(function(e){n.clockRange=e,this.synchronize()},this),this.canAnimate=a.observable(n.canAnimate),this.canAnimate.subscribe(function(e){n.canAnimate=e,this.synchronize()},this),this.shouldAnimate=a.observable(n.shouldAnimate),this.shouldAnimate.subscribe(function(e){n.shouldAnimate=e,this.synchronize()},this),a.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}return n(s.prototype,{clock:{get:function(){return this._clock}}}),s.prototype.synchronize=function(){var e=this._clock;this.systemTime=o.now(),this.startTime=e.startTime,this.stopTime=e.stopTime,this.currentTime=e.currentTime,this.multiplier=e.multiplier,this.clockStep=e.clockStep,this.clockRange=e.clockRange,this.canAnimate=e.canAnimate,this.shouldAnimate=e.shouldAnimate},s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){this._eventHelper.removeAll(),r(this)},s}),o("Widgets/Command",["../Core/DeveloperError"],function(e){"use strict";return function(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,e.throwInstantiationError()}}),o("Widgets/FullscreenButton/FullscreenButtonViewModel",["../../Core/defaultValue","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Fullscreen","../../ThirdParty/knockout","../createCommand","../getElement"],function(e,t,n,r,i,o,a,s){"use strict";function l(t){var n=this,r=o.observable(i.fullscreen),l=o.observable(i.enabled);this.isFullscreen=void 0,o.defineProperty(this,"isFullscreen",{get:function(){return r()}}),this.isFullscreenEnabled=void 0,o.defineProperty(this,"isFullscreenEnabled",{get:function(){return l()},set:function(e){l(e&&i.enabled)}}),this.tooltip=void 0,o.defineProperty(this,"tooltip",function(){return this.isFullscreenEnabled?r()?"Exit full screen":"Full screen":"Full screen unavailable"}),this._command=a(function(){i.fullscreen?i.exitFullscreen():i.requestFullscreen(n._fullscreenElement)},o.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=e(s(t),document.body),this._callback=function(){r(i.fullscreen)},document.addEventListener(i.changeEventName,this._callback)}return t(l.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){this._fullscreenElement=e}},command:{get:function(){return this._command}}}),l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){document.removeEventListener(i.changeEventName,this._callback),n(this)},l}),o("Widgets/FullscreenButton/FullscreenButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./FullscreenButtonViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e,t){e=o(e);var n=new a(t);n._exitFullScreenPath=u,n._enterFullScreenPath=l;var r=document.createElement("button");r.type="button",r.className="cesium-button cesium-fullscreenButton",r.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),e.appendChild(r),i.applyBindings(n,r),this._container=e,this._viewModel=n,this._element=r}var l="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z",u="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._viewModel.destroy(),i.cleanNode(this._element),this._container.removeChild(this._element),n(this)},s}),o("Widgets/Geocoder/GeocoderViewModel",["../../Core/BingMapsApi","../../Core/Cartesian3","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/loadJsonp","../../Core/Matrix4","../../Core/Rectangle","../../Scene/SceneMode","../../ThirdParty/knockout","../../ThirdParty/when","../createCommand"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p){"use strict";function f(i){this._url=n(i.url,"https://dev.virtualearth.net/"),this._url.length>0&&"/"!==this._url[this._url.length-1]&&(this._url+="/"),this._key=e.getKey(i.key);var o=e.getErrorCredit(i.key);r(o)&&i.scene._frameState.creditDisplay.addDefaultCredit(o),this._scene=i.scene,this._flightDuration=i.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._geocodeInProgress=void 0,this._complete=new a;var l=this;this._searchCommand=p(function(){var e;l.isSearchInProgress?((e=l)._isSearchInProgress=!1,r(e._geocodeInProgress)&&(e._geocodeInProgress.cancel=!0,e._geocodeInProgress=void 0)):function(e){var n=e.searchText;if(!/^\s*$/.test(n)){var r=n.match(/[^\s,\n]+/g);if(2===r.length||3===r.length){var i=+r[0],o=+r[1],a=3===r.length?+r[2]:300;if(!isNaN(i)&&!isNaN(o)&&!isNaN(a))return void m(e,t.fromDegrees(i,o,a))}e._isSearchInProgress=!0;var l=s(e._url+"REST/v1/Locations",{parameters:{query:n,key:e._key},callbackParameterName:"jsonp"}),c=e._geocodeInProgress=d(l,function(t){if(!c.cancel){if(e._isSearchInProgress=!1,0===t.resourceSets.length)return void(e.searchText=e._searchText+" (not found)");var n=t.resourceSets[0];if(0===n.resources.length)return void(e.searchText=e._searchText+" (not found)");var r=n.resources[0];e._searchText=r.name;var i=r.bbox;m(e,u.fromDegrees(i[1],i[0],i[3],i[2]))}},function(){c.cancel||(e._isSearchInProgress=!1,e.searchText=e._searchText+" (error)")})}}(l)}),this.keepExpanded=!1,h.track(this,["_searchText","_isSearchInProgress","keepExpanded"]),this.isSearchInProgress=void 0,h.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,h.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(e){this._searchText=e}}),this.flightDuration=void 0,h.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){this._flightDuration=e}})}function m(e,t){e._scene.camera.flyTo({destination:t,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:l.IDENTITY})}return i(f.prototype,{url:{get:function(){return this._url}},key:{get:function(){return this._key}},complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}}}),f}),o("Widgets/Geocoder/Geocoder",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./GeocoderViewModel"],function(e,t,n,r,i,o,a,s){"use strict";function l(e){var t=a(e.container),n=new s(e);n._startSearchPath=u,n._stopSearchPath=c;var r=document.createElement("form");r.setAttribute("data-bind","submit: search");var l=document.createElement("input");l.type="search",l.className="cesium-geocoder-input",l.setAttribute("placeholder","Enter an address or landmark..."),l.setAttribute("data-bind",'value: searchText,valueUpdate: "afterkeydown",disable: isSearchInProgress,css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 }'),this._onTextBoxFocus=function(){setTimeout(function(){l.select()},0)},l.addEventListener("focus",this._onTextBoxFocus,!1),r.appendChild(l),this._textBox=l;var h=document.createElement("span");h.className="cesium-geocoder-searchButton",h.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),r.appendChild(h),t.appendChild(r),o.applyBindings(n,r),this._container=t,this._viewModel=n,this._form=r,this._onInputBegin=function(e){t.contains(e.target)||l.blur()},this._onInputEnd=function(e){t.contains(e.target)&&l.focus()},i.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),document.addEventListener("pointerup",this._onInputEnd,!0),document.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),document.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),document.addEventListener("touchend",this._onInputEnd,!0),document.addEventListener("touchcancel",this._onInputEnd,!0))}var u="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",c="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";return t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return i.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),document.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),document.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),document.removeEventListener("touchend",this._onInputEnd,!0)),o.cleanNode(this._form),this._container.removeChild(this._form),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),n(this)},l}),o("Widgets/HomeButton/HomeButtonViewModel",["../../Core/Cartesian3","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Matrix4","../../Core/Rectangle","../../Scene/Camera","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e,t){this._scene=e,this._duration=t;var n=this;this._command=c(function(){n._scene.camera.flyHome(n._duration)}),this.tooltip="View Home",u.track(this,["tooltip"])}return r(h.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}}}),h}),o("Widgets/HomeButton/HomeButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./HomeButtonViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e,t,n){e=o(e);var r=new a(t,n);r._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";var s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-home-button",s.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),e.appendChild(s),i.applyBindings(r,s),this._container=e,this._viewModel=r,this._element=s}return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return i.cleanNode(this._element),this._container.removeChild(this._element),n(this)},s}),o("Widgets/InfoBox/InfoBoxViewModel",["../../Core/defined","../../Core/defineProperties","../../Core/Event","../../ThirdParty/knockout"],function(e,t,n,r){"use strict";function i(){this._cameraClicked=new n,this._closeClicked=new n,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",r.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,r.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?a:o}}),r.defineProperty(this,"_bodyless",{get:function(){return!e(this.description)||0===this.description.length}})}var o="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z",a="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";return i.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"},t(i.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}}),i}),o("Widgets/InfoBox/InfoBox",["../../Core/buildModuleUrl","../../Core/Color","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","../subscribeAndEvaluate","./InfoBoxViewModel"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(r){r=s(r);var i=document.createElement("div");i.className="cesium-infoBox",i.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),r.appendChild(i);var o=document.createElement("div");o.className="cesium-infoBox-title",o.setAttribute("data-bind","text: titleText"),i.appendChild(o);var c=document.createElement("button");c.type="button",c.className="cesium-button cesium-infoBox-camera",c.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),i.appendChild(c);var h=document.createElement("button");h.type="button",h.className="cesium-infoBox-close",h.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),h.innerHTML="&times;",i.appendChild(h);var d=document.createElement("iframe");d.className="cesium-infoBox-iframe",d.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),d.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),d.setAttribute("allowfullscreen",!0),i.appendChild(d);var p=new u;a.applyBindings(p,i),this._container=r,this._element=i,this._frame=d,this._viewModel=p,this._descriptionSubscription=void 0;var f=this;d.addEventListener("load",function(){var r=d.contentDocument,o=r.createElement("link");o.href=e("Widgets/InfoBox/InfoBoxDescription.css"),o.rel="stylesheet",o.type="text/css";var a=r.createElement("div");a.className="cesium-infoBox-description",r.head.appendChild(o),r.body.appendChild(a),f._descriptionSubscription=l(p,"description",function(e){d.style.height="5px",a.innerHTML=e;var r=null,o=a.firstElementChild;if(null!==o&&1===a.childNodes.length){var s=window.getComputedStyle(o);if(null!==s){var l=t.fromCssColorString(s["background-color"]);n(l)&&0!==l.alpha&&(r=s["background-color"])}}i.style["background-color"]=r;var u=a.getBoundingClientRect().height;d.style.height=u+"px"})}),d.setAttribute("src","about:blank")}return r(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}}),c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){var e=this._container;return a.cleanNode(this._element),e.removeChild(this._element),n(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),i(this)},c}),o("Widgets/NavigationHelpButton/NavigationHelpButtonViewModel",["../../Core/defineProperties","../../ThirdParty/knockout","../createCommand"],function(e,t,n){"use strict";function r(){this.showInstructions=!1;var e=this;this._command=n(function(){e.showInstructions=!e.showInstructions}),this._showClick=n(function(){e._touch=!1}),this._showTouch=n(function(){e._touch=!0}),this._touch=!1,this.tooltip="Navigation Instructions",t.track(this,["tooltip","showInstructions","_touch"])}return e(r.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}}),r}),o("Widgets/NavigationHelpButton/NavigationHelpButton",["../../Core/buildModuleUrl","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./NavigationHelpButtonViewModel"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(n){var r=l(n.container),i=new u,o=t(n.instructionsInitiallyVisible,!1);i.showInstructions=o,i._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";var c=document.createElement("span");c.className="cesium-navigationHelpButton-wrapper",r.appendChild(c);var h=document.createElement("button");h.type="button",h.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",h.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),c.appendChild(h);var d=document.createElement("div");d.className="cesium-navigation-help",d.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),c.appendChild(d);var p=document.createElement("button");p.type="button",p.className="cesium-navigation-button cesium-navigation-button-left",p.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');var f=document.createElement("img");f.src=e("Widgets/Images/NavigationHelp/Mouse.svg"),f.className="cesium-navigation-button-icon",f.style.width="25px",f.style.height="25px",p.appendChild(f),p.appendChild(document.createTextNode("Mouse"));var m=document.createElement("button");m.type="button",m.className="cesium-navigation-button cesium-navigation-button-right",m.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');var _=document.createElement("img");_.src=e("Widgets/Images/NavigationHelp/Touch.svg"),_.className="cesium-navigation-button-icon",_.style.width="25px",_.style.height="25px",m.appendChild(_),m.appendChild(document.createTextNode("Touch")),d.appendChild(p),d.appendChild(m);var g=document.createElement("div");g.className="cesium-click-navigation-help cesium-navigation-help-instructions",g.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),g.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseLeft.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseRight.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/MouseMiddle.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>',d.appendChild(g);var v=document.createElement("div");v.className="cesium-touch-navigation-help cesium-navigation-help-instructions",v.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),v.innerHTML='            <table>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchDrag.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchZoom.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchTilt.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="'+e("Widgets/Images/NavigationHelp/TouchRotate.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>',d.appendChild(v),s.applyBindings(i,c),this._container=r,this._viewModel=i,this._wrapper=c,this._closeInstructions=function(e){c.contains(e.target)||(i.showInstructions=!1)},a.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}return r(c.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),c.prototype.isDestroyed=function(){return!1},c.prototype.destroy=function(){return a.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),s.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),i(this)},c}),o("Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Scene/FrameRateMonitor","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i,o,a,s){"use strict";function l(t){this._scene=t.scene,this.lowFrameRateMessage=e(t.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,a.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);var n=this;this._dismissMessage=s(function(){n.showingLowFrameRateMessage=!1,n.lowFrameRateMessageDismissed=!0});var r=o.fromScene(t.scene);this._unsubscribeLowFrameRate=r.lowFrameRate.addEventListener(function(){n.lowFrameRateMessageDismissed||(n.showingLowFrameRateMessage=!0)}),this._unsubscribeNominalFrameRate=r.nominalFrameRate.addEventListener(function(){n.showingLowFrameRateMessage=!1})}return n(l.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}}),l.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),r(this)},l}),o("Widgets/PerformanceWatchdog/PerformanceWatchdog",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./PerformanceWatchdogViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e){var t=o(e.container),n=new a(e),r=document.createElement("div");r.className="cesium-performance-watchdog-message-area",r.setAttribute("data-bind","visible: showingLowFrameRateMessage");var s=document.createElement("button");s.setAttribute("type","button"),s.className="cesium-performance-watchdog-message-dismiss",s.innerHTML="&times;",s.setAttribute("data-bind","click: dismissMessage"),r.appendChild(s);var l=document.createElement("div");l.className="cesium-performance-watchdog-message",l.setAttribute("data-bind","html: lowFrameRateMessage"),r.appendChild(l),t.appendChild(r),i.applyBindings(n,r),this._container=t,this._viewModel=n,this._element=r}return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._viewModel.destroy(),i.cleanNode(this._element),this._container.removeChild(this._element),n(this)},s}),o("Widgets/SceneModePicker/SceneModePickerViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Scene/SceneMode","../../ThirdParty/knockout","../createCommand"],function(e,t,n,r,i,o,a,s,l){"use strict";function u(t,n){this._scene=t;var r=this;this._eventHelper=new o,this._eventHelper.add(t.morphStart,function(e,t,n,i){r.sceneMode=n,r.dropDownVisible=!1}),this._duration=e(n,2),this.sceneMode=t.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",s.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,s.defineProperty(this,"selectedTooltip",function(){var e=r.sceneMode;return e===a.SCENE2D?r.tooltip2D:e===a.SCENE3D?r.tooltip3D:r.tooltipColumbusView}),this._toggleDropDown=l(function(){r.dropDownVisible=!r.dropDownVisible}),this._morphTo2D=l(function(){t.morphTo2D(r._duration)}),this._morphTo3D=l(function(){t.morphTo3D(r._duration)}),this._morphToColumbusView=l(function(){t.morphToColumbusView(r._duration)}),this._sceneMode=a}return n(u.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}}),u.prototype.isDestroyed=function(){return!1},u.prototype.destroy=function(){this._eventHelper.removeAll(),r(this)},u}),o("Widgets/SceneModePicker/SceneModePicker",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/FeatureDetection","../../ThirdParty/knockout","../getElement","./SceneModePickerViewModel"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,t,n){e=a(e);var r=new s(t,n);r._globePath=u,r._flatMapPath=c,r._columbusViewPath=h;var l=document.createElement("span");l.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",e.appendChild(l);var d=document.createElement("button");d.type="button",d.className="cesium-button cesium-toolbar-button",d.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),d.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --\x3e\x3c!-- /ko --\x3e',l.appendChild(d);var p=document.createElement("button");p.type="button",p.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",p.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),l.appendChild(p);var f=document.createElement("button");f.type="button",f.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",f.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),l.appendChild(f);var m=document.createElement("button");m.type="button",m.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",m.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),l.appendChild(m),o.applyBindings(r,l),this._viewModel=r,this._container=e,this._wrapper=l,this._closeDropDown=function(e){l.contains(e.target)||(r.dropDownVisible=!1)},i.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}var u="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",c="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",h="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";return t(l.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){return this._viewModel.destroy(),i.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),o.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),n(this)},l}),o("Widgets/SelectionIndicator/SelectionIndicatorViewModel",["../../Core/Cartesian2","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/EasingFunction","../../Scene/SceneTransforms","../../ThirdParty/knockout"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,r,i){this._scene=e,this._screenPositionX=c,this._screenPositionY=c,this._tweens=e.tweens,this._container=t(i,document.body),this._selectionIndicatorElement=r,this._scale=1,this.position=void 0,this.showSelection=!1,s.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,s.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&n(this.position)}}),s.defineProperty(this,"_transform",{get:function(){return"scale("+this._scale+")"}}),this.computeScreenSpacePosition=function(t,n){return a.wgs84ToWindowCoordinates(e,t,n)}}var u=new e,c="-1000px";return l.prototype.update=function(){if(this.showSelection&&n(this.position)){var e=this.computeScreenSpacePosition(this.position,u);if(n(e)){var t=this._container,r=t.parentNode.clientWidth,i=t.parentNode.clientHeight,o=this._selectionIndicatorElement.clientWidth,a=.5*o;e.x=Math.min(Math.max(e.x,-o),r+o)-a,e.y=Math.min(Math.max(e.y,-o),i+o)-a,this._screenPositionX=Math.floor(e.x+.25)+"px",this._screenPositionY=Math.floor(e.y+.25)+"px"}else this._screenPositionX=c,this._screenPositionY=c}},l.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:o.EXPONENTIAL_OUT})},l.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:o.EXPONENTIAL_OUT})},r(l.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}}),l}),o("Widgets/SelectionIndicator/SelectionIndicator",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./SelectionIndicatorViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e,t){e=o(e),this._container=e;var n=document.createElement("div");n.className="cesium-selection-wrapper",n.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),e.appendChild(n),this._element=n;var r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg:svg");s.setAttribute("width",160),s.setAttribute("height",160),s.setAttribute("viewBox","0 0 160 160");var l=document.createElementNS(r,"g");l.setAttribute("transform","translate(80,80)"),s.appendChild(l);var u=document.createElementNS(r,"path");u.setAttribute("data-bind","attr: { transform: _transform }"),u.setAttribute("d","M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z"),l.appendChild(u),n.appendChild(s);var c=new a(t,this._element,this._container);this._viewModel=c,i.applyBindings(this._viewModel,this._element)}return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){var e=this._container;return i.cleanNode(this._element),e.removeChild(this._element),n(this)},s}),o("Widgets/Timeline/TimelineHighlightRange",["../../Core/defaultValue","../../Core/JulianDate"],function(e,t){"use strict";function n(t,n,r){this._color=t,this._height=n,this._base=e(r,0)}return n.prototype.getHeight=function(){return this._height},n.prototype.getBase=function(){return this._base},n.prototype.getStartTime=function(){return this._start},n.prototype.getStopTime=function(){return this._stop},n.prototype.setRange=function(e,t){this._start=e,this._stop=t},n.prototype.render=function(e){var n="";if(this._start&&this._stop&&this._color){var r=t.secondsDifference(this._start,e.epochJulian),i=Math.round(e.timeBarWidth*e.getAlpha(r)),o=t.secondsDifference(this._stop,e.epochJulian),a=Math.round(e.timeBarWidth*e.getAlpha(o))-i;i<0&&(a+=i,i=0),i+a>e.timeBarWidth&&(a=e.timeBarWidth-i),a>0&&(n='<span class="cesium-timeline-highlight" style="left: '+i.toString()+"px; width: "+a.toString()+"px; bottom: "+this._base.toString()+"px; height: "+this._height+"px; background-color: "+this._color+';"></span>')}return n},n}),o("Widgets/Timeline/TimelineTrack",["../../Core/Color","../../Core/defined","../../Core/JulianDate"],function(e,t,n){"use strict";function r(t,n,r,i){this.interval=t,this.height=n,this.color=r||new e(.5,.5,.5,1),this.backgroundColor=i||new e(0,0,0,0)}return r.prototype.render=function(e,r){var i=this.interval.start,o=this.interval.stop,a=r.startJulian,s=n.addSeconds(r.startJulian,r.duration,new n);if(n.lessThan(i,a)&&n.greaterThan(o,s))e.fillStyle=this.color.toCssColorString(),e.fillRect(0,r.y,r.timeBarWidth,this.height);else if(n.lessThanOrEquals(i,s)&&n.greaterThanOrEquals(o,a)){var l,u,c;for(l=0;l<r.timeBarWidth;++l){var h=n.addSeconds(r.startJulian,l/r.timeBarWidth*r.duration,new n);!t(u)&&n.greaterThanOrEquals(h,i)?u=l:!t(c)&&n.greaterThanOrEquals(h,o)&&(c=l)}e.fillStyle=this.backgroundColor.toCssColorString(),e.fillRect(0,r.y,r.timeBarWidth,this.height),t(u)&&(t(c)||(c=r.timeBarWidth),e.fillStyle=this.color.toCssColorString(),e.fillRect(u,r.y,Math.max(c-u,1),this.height))}},r}),o("Widgets/Timeline/Timeline",["../../Core/ClockRange","../../Core/defined","../../Core/destroyObject","../../Core/DeveloperError","../../Core/JulianDate","../getElement","./TimelineHighlightRange","./TimelineTrack"],function(e,t,n,r,i,o,a,s){"use strict";function l(e,n){e=o(e),this.container=e;var r,a,s,l,u,p,f,m=document.createElement("div");m.className="cesium-timeline-main",e.appendChild(m),this._topDiv=m,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=n,this._scrubJulian=n.currentTime,this._mainTicSpan=-1,this._mouseMode=h.none,this._touchMode=d.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(n.startTime,n.stopTime),this._onMouseDown=(f=this,function(e){f._mouseMode!==h.touchOnly&&(0===e.button?(f._mouseMode=h.scrub,f._scrubElement&&(f._scrubElement.style.backgroundPosition="-16px 0"),f._onMouseMove(e)):(f._mouseX=e.clientX,f._mouseMode=2===e.button?h.zoom:h.slide)),e.preventDefault()}),this._onMouseUp=(p=this,function(e){p._mouseMode=h.none,p._scrubElement&&(p._scrubElement.style.backgroundPosition="0 0"),p._timelineDrag=0,p._timelineDragLocation=void 0}),this._onMouseMove=(u=this,function(e){var t;if(u._mouseMode===h.scrub){e.preventDefault();var n=e.clientX-u._topDiv.getBoundingClientRect().left;n<0?(u._timelineDragLocation=0,u._timelineDrag=-.01*u._timeBarSecondsSpan):n>u._topDiv.clientWidth?(u._timelineDragLocation=u._topDiv.clientWidth,u._timelineDrag=.01*u._timeBarSecondsSpan):(u._timelineDragLocation=void 0,u._setTimeBarTime(n,n*u._timeBarSecondsSpan/u._topDiv.clientWidth))}else if(u._mouseMode===h.slide){if(t=u._mouseX-e.clientX,u._mouseX=e.clientX,0!==t){var r=t*u._timeBarSecondsSpan/u._topDiv.clientWidth;u.zoomTo(i.addSeconds(u._startJulian,r,new i),i.addSeconds(u._endJulian,r,new i))}}else u._mouseMode===h.zoom&&(t=u._mouseX-e.clientX,u._mouseX=e.clientX,0!==t&&u.zoomFrom(Math.pow(1.01,t)))}),this._onMouseWheel=(l=this,function(e){var t=e.wheelDeltaY||e.wheelDelta||-e.detail;t/=c=Math.max(Math.min(Math.abs(t),c),1),l.zoomFrom(Math.pow(1.05,-t))}),this._onTouchStart=(s=this,function(e){var t,n,r=e.touches.length,o=s._topDiv.getBoundingClientRect().left;e.preventDefault(),s._mouseMode=h.touchOnly,1===r?(t=i.secondsDifference(s._scrubJulian,s._startJulian),n=Math.round(t*s._topDiv.clientWidth/s._timeBarSecondsSpan+o),Math.abs(e.touches[0].clientX-n)<50?(s._touchMode=d.scrub,s._scrubElement&&(s._scrubElement.style.backgroundPosition=1===r?"-16px 0":"0 0")):(s._touchMode=d.singleTap,s._touchState.centerX=e.touches[0].clientX-o)):2===r?(s._touchMode=d.slideZoom,s._touchState.centerX=.5*(e.touches[0].clientX+e.touches[1].clientX)-o,s._touchState.spanX=Math.abs(e.touches[0].clientX-e.touches[1].clientX)):s._touchMode=d.ignore}),this._onTouchMove=(a=this,function(e){var n,r,o,s,l,u=1,c=a._topDiv.getBoundingClientRect().left;a._touchMode===d.singleTap&&(a._touchMode=d.slideZoom),a._mouseMode=h.touchOnly,a._touchMode===d.scrub?(e.preventDefault(),1===e.changedTouches.length&&(n=e.changedTouches[0].clientX-c)>=0&&n<=a._topDiv.clientWidth&&a._setTimeBarTime(n,n*a._timeBarSecondsSpan/a._topDiv.clientWidth)):a._touchMode===d.slideZoom&&(2===(r=e.touches.length)?(o=.5*(e.touches[0].clientX+e.touches[1].clientX)-c,s=Math.abs(e.touches[0].clientX-e.touches[1].clientX)):1===r&&(o=e.touches[0].clientX-c,s=0),t(o)&&(l=i.addSeconds(a._startJulian,s>0&&a._touchState.spanX>0?(a._touchState.centerX*a._timeBarSecondsSpan-o*a._timeBarSecondsSpan*(u=a._touchState.spanX/s))/a._topDiv.clientWidth:(a._touchState.centerX-o)*a._timeBarSecondsSpan/a._topDiv.clientWidth,new i),a.zoomTo(l,i.addSeconds(l,a._timeBarSecondsSpan*u,new i)),a._touchState.centerX=o,a._touchState.spanX=s))}),this._onTouchEnd=(r=this,function(e){var t=e.touches.length,n=r._topDiv.getBoundingClientRect().left;r._touchMode===d.singleTap?(r._touchMode=d.scrub,r._onTouchMove(e)):r._touchMode===d.scrub&&r._onTouchMove(e),r._mouseMode=h.touchOnly,1!==t?r._touchMode=t>0?d.ignore:d.none:r._touchMode===d.slideZoom&&(r._touchState.centerX=e.touches[0].clientX-n),r._scrubElement&&(r._scrubElement.style.backgroundPosition="0 0")});var _=this._timeBarEle;document.addEventListener("mouseup",this._onMouseUp,!1),document.addEventListener("mousemove",this._onMouseMove,!1),_.addEventListener("mousedown",this._onMouseDown,!1),_.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),_.addEventListener("mousewheel",this._onMouseWheel,!1),_.addEventListener("touchstart",this._onTouchStart,!1),_.addEventListener("touchmove",this._onTouchMove,!1),_.addEventListener("touchend",this._onTouchEnd,!1),_.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},n.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}function u(e){return e<10?"0"+e.toString():e.toString()}var c=1e12,h={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},d={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},p=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return l.prototype.addEventListener=function(e,t,n){this._topDiv.addEventListener(e,t,n)},l.prototype.removeEventListener=function(e,t,n){this._topDiv.removeEventListener(e,t,n)},l.prototype.isDestroyed=function(){return!1},l.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this),document.removeEventListener("mouseup",this._onMouseUp,!1),document.removeEventListener("mousemove",this._onMouseMove,!1);var e=this._timeBarEle;e.removeEventListener("mousedown",this._onMouseDown,!1),e.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),e.removeEventListener("mousewheel",this._onMouseWheel,!1),e.removeEventListener("touchstart",this._onTouchStart,!1),e.removeEventListener("touchmove",this._onTouchMove,!1),e.removeEventListener("touchend",this._onTouchEnd,!1),e.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),n(this)},l.prototype.addHighlightRange=function(e,t,n){var r=new a(e,t,n);return this._highlightRanges.push(r),this.resize(),r},l.prototype.addTrack=function(e,t,n,r){var i=new s(e,t,n,r);return this._trackList.push(i),this._lastHeight=void 0,this.resize(),i},l.prototype.zoomTo=function(t,n){if(this._startJulian=t,this._endJulian=n,this._timeBarSecondsSpan=i.secondsDifference(n,t),this._clock&&this._clock.clockRange!==e.UNBOUNDED){var r=this._clock.startTime,o=this._clock.stopTime,a=i.secondsDifference(o,r),s=i.secondsDifference(r,this._startJulian),l=i.secondsDifference(o,this._endJulian);this._timeBarSecondsSpan>=a?(this._timeBarSecondsSpan=a,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):s>0?(this._endJulian=i.addSeconds(this._endJulian,s,new i),this._startJulian=r,this._timeBarSecondsSpan=i.secondsDifference(this._endJulian,this._startJulian)):l<0&&(this._startJulian=i.addSeconds(this._startJulian,l,new i),this._endJulian=o,this._timeBarSecondsSpan=i.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();var u=document.createEvent("Event");u.initEvent("setzoom",!0,!0),u.startJulian=this._startJulian,u.endJulian=this._endJulian,u.epochJulian=this._epochJulian,u.totalSpan=this._timeBarSecondsSpan,u.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(u)},l.prototype.zoomFrom=function(e){var t=i.secondsDifference(this._scrubJulian,this._startJulian);e>1||t<0||t>this._timeBarSecondsSpan?t=.5*this._timeBarSecondsSpan:t+=t-.5*this._timeBarSecondsSpan;var n=this._timeBarSecondsSpan-t;this.zoomTo(i.addSeconds(this._startJulian,t-t*e,new i),i.addSeconds(this._endJulian,n*e-n,new i))},l.prototype.makeLabel=function(e){var t=i.toGregorianDate(e),n=t.millisecond,r=" UTC";if(n>0&&this._timeBarSecondsSpan<3600){for(r=Math.floor(n).toString();r.length<3;)r="0"+r;r="."+r}return f[t.month-1]+" "+t.day+" "+t.year+" "+u(t.hour)+":"+u(t.minute)+":"+u(t.second)+r},l.prototype.smallestTicInPixels=7,l.prototype._makeTics=function(){function e(e){return Math.floor(y/e)*e}function t(e,t){return Math.ceil(e/t+.5)*t}function n(e){return(e-y)/f}function r(e,t){return e-t*Math.round(e/t)}var o,a=this._timeBarEle,s=i.secondsDifference(this._scrubJulian,this._startJulian),l=Math.round(s*this._topDiv.clientWidth/this._timeBarSecondsSpan),u=l-8,c=this;this._needleEle.style.left=l.toString()+"px";var h="",d=0,f=this._timeBarSecondsSpan;f<.01?(f=.01,this._timeBarSecondsSpan=.01,this._endJulian=i.addSeconds(this._startJulian,.01,new i)):f>31536e6&&(f=31536e6,this._timeBarSecondsSpan=31536e6,this._endJulian=i.addSeconds(this._startJulian,31536e6,new i));var m=this._timeBarEle.clientWidth;m<10&&(m=10);var _,g=this._startJulian,v=Math.min(f/m*1e-5,.4);_=i.fromIso8601(f>31536e4?i.toDate(g).toISOString().substring(0,2)+"00-01-01T00:00:00Z":f>31536e3?i.toDate(g).toISOString().substring(0,3)+"0-01-01T00:00:00Z":f>86400?i.toDate(g).toISOString().substring(0,4)+"-01-01T00:00:00Z":i.toDate(g).toISOString().substring(0,10)+"T00:00:00Z");var y=i.secondsDifference(this._startJulian,i.addSeconds(_,v,new i)),C=y+f;this._epochJulian=_,this._rulerEle.innerHTML=this.makeLabel(i.addSeconds(this._endJulian,-.01,new i));var w=this._rulerEle.offsetWidth+20;w<30&&(w=180);var b=d;d-=1e-10;var E={startTime:y,startJulian:g,epochJulian:_,duration:f,timeBarWidth:m,getAlpha:n};this._highlightRanges.forEach(function(e){h+=e.render(E)});var S=0,x=0,T=0,A=w/m;A>1&&(A=1),A*=this._timeBarSecondsSpan;var P,D=-1,M=-1,I=p.length;for(P=0;P<I;++P){var O=p[P];if(++D,S=O,O>A&&O>d)break;M<0&&m*(O/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(M=D)}if(D>0){for(;D>0;)if(--D,Math.abs(r(S,p[D]))<1e-5){p[D]>=d&&(x=p[D]);break}if(M>=0)for(;M<D;){if(Math.abs(r(x,p[M]))<1e-5&&p[M]>=d){T=p[M];break}++M}}(d=b)>1e-10&&T<1e-5&&Math.abs(d-S)>1e-10&&(T=d,d<=S+1e-10&&(x=0));var R,N=-999999;if(m*(T/this._timeBarSecondsSpan)>=3)for(o=e(T);o<=C;o=t(o,T))h+='<span class="cesium-timeline-ticTiny" style="left: '+Math.round(m*n(o)).toString()+'px;"></span>';if(m*(x/this._timeBarSecondsSpan)>=3)for(o=e(x);o<=C;o=t(o,x))h+='<span class="cesium-timeline-ticSub" style="left: '+Math.round(m*n(o)).toString()+'px;"></span>';if(m*(S/this._timeBarSecondsSpan)>=2){this._mainTicSpan=S,C+=S,o=e(S);for(var L=i.computeTaiMinusUtc(_);o<=C;){var F=i.addSeconds(g,o-y,new i);if(S>2.1){var B=i.computeTaiMinusUtc(F);Math.abs(B-L)>.1&&(F=i.addSeconds(g,(o+=B-L)-y,new i))}var k=Math.round(m*n(o)),V=this.makeLabel(F);this._rulerEle.innerHTML=V,(R=this._rulerEle.offsetWidth)<10&&(R=w);var z=k-(R/2-1);z>N?(N=z+R+5,h+='<span class="cesium-timeline-ticMain" style="left: '+k.toString()+'px;"></span><span class="cesium-timeline-ticLabel" style="left: '+z.toString()+'px;">'+V+"</span>"):h+='<span class="cesium-timeline-ticSub" style="left: '+k.toString()+'px;"></span>',o=t(o,S)}}else this._mainTicSpan=-1;a.innerHTML=h+='<span class="cesium-timeline-icon16" style="left:'+u+'px;bottom:0;background-position: 0 0;"></span>',this._scrubElement=a.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),E.y=0,this._trackList.forEach(function(e){e.render(c._context,E),E.y+=e.height})},l.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;var e=this._scrubElement;if(t(this._scrubElement)){var n=i.secondsDifference(this._scrubJulian,this._startJulian),r=Math.round(n*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==r&&(this._lastXPos=r,e.style.left=r-8+"px",this._needleEle.style.left=r+"px")}t(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo(i.addSeconds(this._startJulian,this._timelineDrag,new i),i.addSeconds(this._endJulian,this._timelineDrag,new i)))},l.prototype._setTimeBarTime=function(e,t){e=Math.round(e),this._scrubJulian=i.addSeconds(this._startJulian,t,new i),this._scrubElement&&(this._scrubElement.style.left=(e-8).toString()+"px",this._needleEle.style.left=e.toString()+"px");var n=document.createEvent("Event");n.initEvent("settime",!0,!0),n.clientX=e,n.timeSeconds=t,n.timeJulian=this._scrubJulian,n.clock=this._clock,this._topDiv.dispatchEvent(n)},l.prototype.resize=function(){var e=this.container.clientWidth,t=this.container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){this._trackContainer.style.height=t+"px";var n=1;this._trackList.forEach(function(e){n+=e.height}),this._trackListEle.style.height=n.toString()+"px",this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=n,this._makeTics(),this._lastXPos=void 0,this._lastWidth=e,this._lastHeight=t}},l}),o("Widgets/VRButton/VRButtonViewModel",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/Fullscreen","../../ThirdParty/knockout","../../ThirdParty/NoSleep","../createCommand","../getElement"],function(e,t,n,r,i,o,a,s,l,u){"use strict";function c(){var e=window.screen;t(e)&&(t(e.unlockOrientation)?e.unlockOrientation():t(e.mozUnlockOrientation)?e.mozUnlockOrientation():t(e.msUnlockOrientation)?e.msUnlockOrientation():t(e.orientation&&e.orientation.unlock)&&e.orientation.unlock())}function h(n,r){var i=this,h=a.observable(o.enabled),d=a.observable(!1);this.isVRMode=void 0,a.defineProperty(this,"isVRMode",{get:function(){return d()}}),this.isVREnabled=void 0,a.defineProperty(this,"isVREnabled",{get:function(){return h()},set:function(e){h(e&&o.enabled)}}),this.tooltip=void 0,a.defineProperty(this,"tooltip",function(){return h()?d()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"}),this._locked=!1,this._noSleep=new s,this._command=l(function(){var e,r,a,s,l,u;e=i,r=n,(a=d)()?(r.useWebVR=!1,e._locked&&(c(),e._locked=!1),e._noSleep.disable(),o.exitFullscreen(),a(!1)):(o.fullscreen||o.requestFullscreen(e._vrElement),e._noSleep.enable(),e._locked||(e._locked=(s="landscape",l=!1,u=window.screen,t(u)&&(t(u.lockOrientation)?l=u.lockOrientation(s):t(u.mozLockOrientation)?l=u.mozLockOrientation(s):t(u.msLockOrientation)?l=u.msLockOrientation(s):t(u.orientation&&u.orientation.lock)&&(l=u.orientation.lock(s))),l)),r.useWebVR=!0,a(!0))},a.getObservable(this,"isVREnabled")),this._vrElement=e(u(r),document.body),this._callback=function(){!o.fullscreen&&d()&&(n.useWebVR=!1,i._locked&&(c(),i._locked=!1),i._noSleep.disable(),d(!1))},document.addEventListener(o.changeEventName,this._callback)}return n(h.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){this._vrElement=e}},command:{get:function(){return this._command}}}),h.prototype.isDestroyed=function(){return!1},h.prototype.destroy=function(){r(this)},h}),o("Widgets/VRButton/VRButton",["../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../ThirdParty/knockout","../getElement","./VRButtonViewModel"],function(e,t,n,r,i,o,a){"use strict";function s(e,t,n){e=o(e);var r=new a(t,n);r._exitVRPath=u,r._enterVRPath=l;var s=document.createElement("button");s.type="button",s.className="cesium-button cesium-vrButton",s.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }"),e.appendChild(s),i.applyBindings(r,s),this._container=e,this._viewModel=r,this._element=s}var l="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z",u="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";return t(s.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),s.prototype.isDestroyed=function(){return!1},s.prototype.destroy=function(){return this._viewModel.destroy(),i.cleanNode(this._element),this._container.removeChild(this._element),n(this)},s}),o("Widgets/Viewer/Viewer",["../../Core/BoundingSphere","../../Core/Cartesian3","../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/destroyObject","../../Core/DeveloperError","../../Core/EventHelper","../../Core/Fullscreen","../../Core/isArray","../../Core/Matrix4","../../Core/Rectangle","../../Core/ScreenSpaceEventType","../../DataSources/BoundingSphereState","../../DataSources/ConstantPositionProperty","../../DataSources/DataSourceCollection","../../DataSources/DataSourceDisplay","../../DataSources/Entity","../../DataSources/EntityView","../../DataSources/Property","../../Scene/ImageryLayer","../../Scene/SceneMode","../../Scene/ShadowMode","../../ThirdParty/knockout","../../ThirdParty/when","../Animation/Animation","../Animation/AnimationViewModel","../BaseLayerPicker/BaseLayerPicker","../BaseLayerPicker/createDefaultImageryProviderViewModels","../BaseLayerPicker/createDefaultTerrainProviderViewModels","../CesiumWidget/CesiumWidget","../ClockViewModel","../FullscreenButton/FullscreenButton","../Geocoder/Geocoder","../getElement","../HomeButton/HomeButton","../InfoBox/InfoBox","../NavigationHelpButton/NavigationHelpButton","../SceneModePicker/SceneModePicker","../SelectionIndicator/SelectionIndicator","../subscribeAndEvaluate","../Timeline/Timeline","../VRButton/VRButton"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G){"use strict";function W(e){var t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1}function H(e,t){var i=e.scene.pick(t.position);if(r(i)){var o=n(i.id,i.primitive.id);if(o instanceof g)return o}if(r(e.scene.globe))return function(e,n){var i=e.scene,o=i.camera.getPickRay(t.position),a=i.imageryLayers.pickImageryLayerFeatures(o,i);if(r(a)){var s=new g({id:"Loading...",description:"Loading feature information..."});return S(a,function(t){if(e.selectedEntity===s){if(!r(t)||0===t.length)return void(e.selectedEntity=q());var n=t[0],i=new g({id:n.name,description:n.description});if(r(n.position)){var o=e.scene.globe.ellipsoid.cartographicToCartesian(n.position,J);i.position=new f(o)}e.selectedEntity=i}},function(){e.selectedEntity===s&&(e.selectedEntity=q())}),s}}(e)}function j(e,t,n){if(r(n)){var i=n.clock;r(i)&&(i.getValue(t),r(e)&&(e.updateFromClock(),e.zoomTo(i.startTime,i.stopTime)))}}function q(){return new g({id:"None",description:"No features found."})}function Y(e,t){e=N(e),t=n(t,n.EMPTY_OBJECT);var i=!(r(t.globe)&&!1===t.globe||r(t.baseLayerPicker)&&!1===t.baseLayerPicker),o=this,a=document.createElement("div");a.className="cesium-viewer",e.appendChild(a);var l=document.createElement("div");l.className="cesium-viewer-cesiumWidgetContainer",a.appendChild(l);var u=document.createElement("div");u.className="cesium-viewer-bottom",a.appendChild(u);var c=n(t.scene3DOnly,!1),h=new M(l,{terrainProvider:t.terrainProvider,imageryProvider:!i&&t.imageryProvider,clock:t.clock,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,creditContainer:r(t.creditContainer)?t.creditContainer:u,scene3DOnly:c,terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D}),p=t.dataSources,f=!1;r(p)||(p=new m,f=!0);var g,v,C=new _({scene:h.scene,dataSourceCollection:p}),w=h.clock,b=new I(w),S=new s;if(S.add(w.onTick,Y.prototype._onTick,this),S.add(h.scene.morphStart,Y.prototype._clearTrackedObject,this),!r(t.selectionIndicator)||!1!==t.selectionIndicator){var j=document.createElement("div");j.className="cesium-viewer-selectionIndicatorContainer",a.appendChild(j),g=new V(j,h.scene)}if(!r(t.infoBox)||!1!==t.infoBox){var q=document.createElement("div");q.className="cesium-viewer-infoBoxContainer",a.appendChild(q);var X=(v=new F(q)).viewModel;S.add(X.cameraClicked,Y.prototype._onInfoBoxCameraClicked,this),S.add(X.closeClicked,Y.prototype._onInfoBoxClockClicked,this)}var Z,K,Q,J,$,ee,te,ne,re,ie,oe,ae,se,le=document.createElement("div");if(le.className="cesium-viewer-toolbar",a.appendChild(le),!r(t.geocoder)||!1!==t.geocoder){var ue=document.createElement("div");ue.className="cesium-viewer-geocoderContainer",le.appendChild(ue),Z=new R({container:ue,scene:h.scene}),S.add(Z.viewModel.search.beforeExecute,Y.prototype._clearObjects,this)}if(r(t.homeButton)&&!1===t.homeButton||(K=new L(le,h.scene),r(Z)&&S.add(K.viewModel.command.afterExecute,function(){var e=Z.viewModel;e.searchText="",e.isSearchInProgress&&e.search()}),S.add(K.viewModel.command.beforeExecute,Y.prototype._clearTrackedObject,this)),c||r(t.sceneModePicker)&&!1===t.sceneModePicker||(Q=new k(le,h.scene)),i){var ce=n(t.imageryProviderViewModels,P()),he=n(t.terrainProviderViewModels,D());J=new A(le,{globe:h.scene.globe,imageryProviderViewModels:ce,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:he,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel}),$=le.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}if(!r(t.navigationHelpButton)||!1!==t.navigationHelpButton){var de=!0;try{if(r(window.localStorage)){var pe=window.localStorage.getItem("cesium-hasSeenNavHelp");r(pe)&&Boolean(pe)?de=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch(e){}ee=new B({container:le,instructionsInitiallyVisible:n(t.navigationInstructionsInitiallyVisible,de)})}if(!r(t.animation)||!1!==t.animation){var fe=document.createElement("div");fe.className="cesium-viewer-animationContainer",a.appendChild(fe),te=new x(fe,new T(b))}if(!r(t.timeline)||!1!==t.timeline){var me=document.createElement("div");me.className="cesium-viewer-timelineContainer",a.appendChild(me),(ne=new U(me,w)).addEventListener("settime",W,!1),ne.zoomTo(w.startTime,w.stopTime)}if(!r(t.fullscreenButton)||!1!==t.fullscreenButton){var _e=document.createElement("div");_e.className="cesium-viewer-fullscreenContainer",a.appendChild(_e),re=new O(_e,t.fullscreenElement),ie=z(re.viewModel,"isFullscreenEnabled",function(e){_e.style.display=e?"block":"none",r(ne)&&(ne.container.style.right=_e.clientWidth+"px",ne.resize())})}if(t.vrButton){var ge=document.createElement("div");ge.className="cesium-viewer-vrContainer",a.appendChild(ge),oe=new G(ge,h.scene,t.fullScreenElement),ae=z(oe.viewModel,"isVREnabled",function(e){ge.style.display=e?"block":"none",r(re)&&(ge.style.right=_e.clientWidth+"px"),r(ne)&&(ne.container.style.right=ge.clientWidth+"px",ne.resize())}),se=z(oe.viewModel,"isVRMode",function(e){!function(e,t){var n=e._geocoder,i=e._homeButton,o=e._sceneModePicker,a=e._baseLayerPicker,s=e._animation,l=e._timeline,u=e._fullscreenButton,c=e._infoBox,h=e._selectionIndicator,d=t?"hidden":"visible";if(r(n)&&(n.container.style.visibility=d),r(i)&&(i.container.style.visibility=d),r(o)&&(o.container.style.visibility=d),r(a)&&(a.container.style.visibility=d),r(s)&&(s.container.style.visibility=d),r(l)&&(l.container.style.visibility=d),r(u)&&u.viewModel.isFullscreenEnabled&&(u.container.style.visibility=d),r(c)&&(c.container.style.visibility=d),r(h)&&(h.container.style.visibility=d),e._container){var p=t||!r(u)?0:u.container.clientWidth;e._vrButton.container.style.right=p+"px",e.forceResize()}}(o,e)})}this._baseLayerPickerDropDown=$,this._fullscreenSubscription=ie,this._vrSubscription=ae,this._vrModeSubscription=se,this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=n(t.automaticallyTrackDataSourceClocks,!0),this._container=e,this._bottomContainer=u,this._element=a,this._cesiumWidget=h,this._selectionIndicator=g,this._infoBox=v,this._dataSourceCollection=p,this._destroyDataSourceCollection=f,this._dataSourceDisplay=C,this._clockViewModel=b,this._toolbar=le,this._homeButton=K,this._sceneModePicker=Q,this._baseLayerPicker=J,this._navigationHelpButton=ee,this._animation=te,this._timeline=ne,this._fullscreenButton=re,this._vrButton=oe,this._geocoder=Z,this._eventHelper=S,this._lastWidth=0,this._lastHeight=0,this._allowDataSourcesToSuspendAnimation=!0,this._entityView=void 0,this._enableInfoOrSelection=r(v)||r(g),this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._selectedEntity=void 0,this._clockTrackedDataSource=void 0,this._forceResize=!1,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,E.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]),S.add(p.dataSourceAdded,Y.prototype._onDataSourceAdded,this),S.add(p.dataSourceRemoved,Y.prototype._onDataSourceRemoved,this),S.add(h.scene.preRender,Y.prototype.resize,this),S.add(h.scene.postRender,Y.prototype._postRender,this);for(var ve=p.length,ye=0;ye<ve;ye++)this._dataSourceAdded(p,p.get(ye));this._dataSourceAdded(void 0,C.defaultDataSource),S.add(p.dataSourceAdded,Y.prototype._dataSourceAdded,this),S.add(p.dataSourceRemoved,Y.prototype._dataSourceRemoved,this),h.screenSpaceEventHandler.setInputAction(function(e){o.selectedEntity=H(o,e)},d.LEFT_CLICK),h.screenSpaceEventHandler.setInputAction(function(e){var t=H(o,e);r(t)&&(y.getValueOrUndefined(t.position,o.clock.currentTime)?o.trackedEntity=t:o.zoomTo(t))},d.LEFT_DOUBLE_CLICK)}function X(e,t,i,o){K(e);var a=S.defer();return e._zoomPromise=a,e._zoomIsFlight=o,e._zoomOptions=i,S(t,function(t){if(e._zoomPromise===a){if(t instanceof C)return void t.getViewableRectangle().then(function(t){e._zoomPromise===a&&(e._zoomTarget=t)});if(t.isLoading&&r(t.loadingEvent))var i=t.loadingEvent.addEventListener(function(){i(),e._zoomPromise===a&&(e._zoomTarget=t.entities.values.slice(0))});else{if(u(t))return void(e._zoomTarget=t.slice(0));t=n(t.values,t),r(t.entities)&&(t=t.entities.values),e._zoomTarget=u(t)?t.slice(0):[t]}}}),a.promise}function Z(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function K(e){var t=e._zoomPromise;r(t)&&(Z(e),t.resolve(!1))}var Q=new e,J=new t;return i(Y.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},cesiumLogo:{get:function(){return this._cesiumWidget.cesiumLogo}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},clock:{get:function(){return this._cesiumWidget.clock}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e,this._forceResize=!0}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,K(this);var t=this.scene,n=t.mode;if(!r(e)||!r(e.position))return this._needTrackedEntityUpdate=!1,n!==w.COLUMBUS_VIEW&&n!==w.SCENE2D||(t.screenSpaceCameraController.enableTranslate=!0),n!==w.COLUMBUS_VIEW&&n!==w.SCENE3D||(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,void this.camera.lookAtTransform(c.IDENTITY);this._needTrackedEntityUpdate=!0}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;var t=r(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;r(e)?r(t)&&t.animateAppear():r(t)&&t.animateDepart()}}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,j(this._timeline,this.clock,e))}}}),Y.prototype.extend=function(e,t){e(this,t)},Y.prototype.resize=function(){var e=this._cesiumWidget,t=this._container,n=t.clientWidth,i=t.clientHeight,o=r(this._animation),a=r(this._timeline);if(this._forceResize||n!==this._lastWidth||i!==this._lastHeight){e.resize(),this._forceResize=!1;var s=i-125,l=this._baseLayerPickerDropDown;r(l)&&(l.style.maxHeight=s+"px"),r(this._infoBox)&&(this._infoBox.viewModel.maxHeight=s);var u,c=this._timeline,h=0,d=0,p=0;if(o&&"hidden"!==window.getComputedStyle(this._animation.container).visibility){var f=this._lastWidth;u=this._animation.container,n>900?(h=169,f<=900&&(u.style.width="169px",u.style.height="112px",this._animation.resize())):n>=600?(h=136,(f<600||f>900)&&(u.style.width="136px",u.style.height="90px",this._animation.resize())):(h=106,(f>600||0===f)&&(u.style.width="106px",u.style.height="70px",this._animation.resize())),d=h+5}if(a&&"hidden"!==window.getComputedStyle(this._timeline.container).visibility){var m=this._fullscreenButton,_=this._vrButton,g=c.container,v=g.style;p=g.clientHeight+3,v.left=h+"px";var y=0;r(m)&&(y+=m.container.clientWidth),r(_)&&(y+=_.container.clientWidth),v.right=y+"px",c.resize()}this._bottomContainer.style.left=d+"px",this._bottomContainer.style.bottom=p+"px",this._lastWidth=n,this._lastHeight=i}},Y.prototype.forceResize=function(){this._lastWidth=0,this.resize()},Y.prototype.render=function(){this._cesiumWidget.render()},Y.prototype.isDestroyed=function(){return!1},Y.prototype.destroy=function(){var e;this.screenSpaceEventHandler.removeInputAction(d.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(d.LEFT_DOUBLE_CLICK);var t=this.dataSources,n=t.length;for(e=0;e<n;e++)this._dataSourceRemoved(t,t.get(e));return this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),r(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),r(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),r(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),r(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),r(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),r(this._timeline)&&(this._timeline.removeEventListener("settime",W,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),r(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),r(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),r(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),r(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._clockViewModel=this._clockViewModel.destroy(),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),this._cesiumWidget=this._cesiumWidget.destroy(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),o(this)},Y.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(Y.prototype._onEntityCollectionChanged,this)},Y.prototype._dataSourceRemoved=function(e,t){var n=t.entities;n.collectionChanged.removeEventListener(Y.prototype._onEntityCollectionChanged,this),r(this.trackedEntity)&&n.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0),r(this.selectedEntity)&&n.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)},Y.prototype._onTick=function(e){var i=e.currentTime,o=this._dataSourceDisplay.update(i);this._allowDataSourcesToSuspendAnimation&&(this._clockViewModel.canAnimate=o);var a=this._entityView;r(a)&&this._dataSourceDisplay.getBoundingSphere(this._trackedEntity,!1,Q)===p.DONE&&a.update(i,Q);var s,l=!1,u=this.selectedEntity,c=r(u)&&this._enableInfoOrSelection;c&&u.isShowing&&u.isAvailable(i)&&(this._dataSourceDisplay.getBoundingSphere(u,!0,Q)!==p.FAILED?s=Q.center:r(u.position)&&(s=u.position.getValue(i,s)),l=r(s));var h=r(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;r(h)&&(h.position=t.clone(s,h.position),h.showSelection=c&&l,h.update());var d=r(this._infoBox)?this._infoBox.viewModel:void 0;r(d)&&(d.showInfo=c,d.enableCamera=l,d.isCameraTracking=this.trackedEntity===this.selectedEntity,c?(d.titleText=n(u.name,u.id),d.description=y.getValueOrDefault(u.description,i,"")):(d.titleText="",d.description=""))},Y.prototype._onEntityCollectionChanged=function(e,t,n){for(var r=n.length,i=0;i<r;i++){var o=n[i];this.trackedEntity===o&&(this.trackedEntity=void 0),this.selectedEntity===o&&(this.selectedEntity=void 0)}},Y.prototype._onInfoBoxCameraClicked=function(e){e.isCameraTracking&&this.trackedEntity===this.selectedEntity?this.trackedEntity=void 0:r(this.selectedEntity.position)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)},Y.prototype._clearTrackedObject=function(){this.trackedEntity=void 0},Y.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=void 0},Y.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0},Y.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&j(this.timeline,this.clock,e)},Y.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);var n=t.entities.id,r=this._eventHelper.add(t.changedEvent,Y.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[n]=r},Y.prototype._onDataSourceRemoved=function(e,t){var n=this.clockTrackedDataSource===t,r=t.entities.id;if(this._dataSourceChangedListeners[r](),this._dataSourceChangedListeners[r]=void 0,n){var i=e.length;this.clockTrackedDataSource=this._automaticallyTrackDataSourceClocks&&i>0?e.get(i-1):void 0}},Y.prototype.zoomTo=function(e,t){return X(this,e,t,!1)},Y.prototype.flyTo=function(e,t){return X(this,e,t,!0)},Y.prototype._postRender=function(){(function(t){var i=t._zoomTarget;if(r(i)&&t.scene.mode!==w.MORPHING){var o=t.scene,a=o.camera,s=t._zoomPromise,l=n(t._zoomOptions,{});if(i instanceof h){var u={destination:i,duration:l.duration,maximumHeight:l.maximumHeight,complete:function(){s.resolve(!0)},cancel:function(){s.resolve(!1)}};return t._zoomIsFlight?a.flyTo(u):(a.setView(u),s.resolve(!0)),void Z(t)}for(var d=[],f=0,m=i.length;f<m;f++){var _=t._dataSourceDisplay.getBoundingSphere(i[f],!1,Q);if(_===p.PENDING)return;_!==p.FAILED&&d.push(e.clone(Q))}if(0===d.length)return void K(t);t.trackedEntity=void 0;var g=e.fromBoundingSpheres(d),v=o.screenSpaceCameraController;v.minimumZoomDistance=Math.min(v.minimumZoomDistance,.5*g.radius),t._zoomIsFlight?(Z(t),a.flyToBoundingSphere(g,{duration:l.duration,maximumHeight:l.maximumHeight,complete:function(){s.resolve(!0)},cancel:function(){s.resolve(!1)},offset:l.offset})):(a.viewBoundingSphere(g,t._zoomOptions),a.lookAtTransform(c.IDENTITY),Z(t),s.resolve(!0))}})(this),function(e){if(e._needTrackedEntityUpdate){var t=e._trackedEntity,n=e.clock.currentTime,i=y.getValueOrUndefined(t.position,n);if(r(i)){var o=e.scene,a=e._dataSourceDisplay.getBoundingSphere(t,!1,Q);if(a!==p.PENDING){var s=o.mode;s!==w.COLUMBUS_VIEW&&s!==w.SCENE2D||(o.screenSpaceCameraController.enableTranslate=!1),s!==w.COLUMBUS_VIEW&&s!==w.SCENE3D||(o.screenSpaceCameraController.enableTilt=!1);var l=a!==p.FAILED?Q:void 0;e._entityView=new v(t,o,o.mapProjection.ellipsoid),e._entityView.update(n,l),e._needTrackedEntityUpdate=!1}}}}(this)},Y}),o("Widgets/Viewer/viewerCesiumInspectorMixin",["../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../CesiumInspector/CesiumInspector"],function(e,t,n,r){"use strict";return function(e){var n=document.createElement("div");n.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(n);var i=new r(n,e.scene);t(e,{cesiumInspector:{get:function(){return i}}}),e.scene.postRender.addEventListener(function(){e.cesiumInspector.viewModel.update()})}}),o("Widgets/Viewer/viewerDragDropMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../../Core/Event","../../Core/wrapFunction","../../DataSources/CzmlDataSource","../../DataSources/GeoJsonDataSource","../../DataSources/KmlDataSource","../../Scene/GroundPrimitive","../getElement"],function(e,t,n,r,i,o,a,s,l,u,c){"use strict";function h(e){e.stopPropagation(),e.preventDefault()}function d(e,n){var r=e;t(r)&&(r.removeEventListener("drop",n,!1),r.removeEventListener("dragenter",h,!1),r.removeEventListener("dragover",h,!1),r.removeEventListener("dragexit",h,!1))}function p(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",h,!1),e.addEventListener("dragover",h,!1),e.addEventListener("dragexit",h,!1)}function f(e,n,r,i){var o=e.scene;return function(u){var c=n.name;try{var h;if(/\.czml$/i.test(c))h=a.load(JSON.parse(u.target.result),{sourceUri:c});else if(/\.geojson$/i.test(c)||/\.json$/i.test(c)||/\.topojson$/i.test(c))h=s.load(JSON.parse(u.target.result),{sourceUri:c,clampToGround:i});else{if(!/\.(kml|kmz)$/i.test(c))return void e.dropError.raiseEvent(e,c,"Unrecognized file: "+c);h=l.load(n,{sourceUri:c,proxy:r,camera:o.camera,canvas:o.canvas})}t(h)&&e.dataSources.add(h).then(function(t){e.flyToOnDrop&&e.flyTo(t)}).otherwise(function(t){e.dropError.raiseEvent(e,c,t)})}catch(t){e.dropError.raiseEvent(e,c,t)}}}function m(e,t){return function(n){e.dropError.raiseEvent(e,t.name,n.target.error)}}return function(t,r){function a(e){h(e),_&&(t.entities.removeAll(),t.dataSources.removeAll());for(var n=e.dataTransfer.files,r=n.length,i=0;i<r;i++){var o=n[i],a=new FileReader;a.onload=f(t,o,y,v),a.onerror=m(t,o),a.readAsText(o)}}r=e(r,e.EMPTY_OBJECT);var s=!0,l=e(r.flyToOnDrop,!0),u=new i,_=e(r.clearOnDrop,!0),g=e(r.dropTarget,t.container),v=e(r.clampToGround,!0),y=r.proxy;g=c(g),n(t,{dropTarget:{get:function(){return g},set:function(e){d(g,a),p(g=e,a)}},dropEnabled:{get:function(){return s},set:function(e){e!==s&&(e?p(g,a):d(g,a),s=e)}},dropError:{get:function(){return u}},clearOnDrop:{get:function(){return _},set:function(e){_=e}},flyToOnDrop:{get:function(){return l},set:function(e){l=e}},proxy:{get:function(){return y},set:function(e){y=e}},clampToGround:{get:function(){return v},set:function(e){v=e}}}),p(g,a),t.destroy=o(t,t.destroy,function(){t.dropEnabled=!1}),t._handleDrop=a}}),o("Widgets/Viewer/viewerPerformanceWatchdogMixin",["../../Core/defaultValue","../../Core/defined","../../Core/defineProperties","../../Core/DeveloperError","../PerformanceWatchdog/PerformanceWatchdog"],function(e,t,n,r,i){"use strict";return function(t,r){r=e(r,e.EMPTY_OBJECT);var o=new i({scene:t.scene,container:t.bottomContainer,lowFrameRateMessage:r.lowFrameRateMessage});n(t,{performanceWatchdog:{get:function(){return o}}})}}),o("Workers/createTaskProcessorWorker",["../Core/defaultValue","../Core/defined","../Core/formatError"],function(e,t,n){"use strict";return function(r){var i,o=[],a={id:void 0,result:void 0,error:void 0};return function(s){var l=s.data;o.length=0,a.id=l.id,a.error=void 0,a.result=void 0;try{a.result=r(l.parameters,o)}catch(e){a.error=e instanceof Error?{name:e.name,message:e.message,stack:e.stack}:e}t(i)||(i=e(self.webkitPostMessage,self.postMessage)),l.canTransferArrayBuffer||(o.length=0);try{i(a,o)}catch(e){a.result=void 0,a.error="postMessage failed with error: "+n(e)+"\n  with responseMessage: "+JSON.stringify(a),i(a)}}}}),o("Cesium",["./Core/appendForwardSlash","./Core/ArcGisImageServerTerrainProvider","./Core/arrayRemoveDuplicates","./Core/AssociativeArray","./Core/AttributeCompression","./Core/AxisAlignedBoundingBox","./Core/barycentricCoordinates","./Core/binarySearch","./Core/BingMapsApi","./Core/BoundingRectangle","./Core/BoundingSphere","./Core/BoxGeometry","./Core/BoxOutlineGeometry","./Core/buildModuleUrl","./Core/cancelAnimationFrame","./Core/Cartesian2","./Core/Cartesian3","./Core/Cartesian4","./Core/Cartographic","./Core/CatmullRomSpline","./Core/CesiumTerrainProvider","./Core/CircleGeometry","./Core/CircleOutlineGeometry","./Core/Clock","./Core/ClockRange","./Core/ClockStep","./Core/clone","./Core/Color","./Core/ColorGeometryInstanceAttribute","./Core/combine","./Core/ComponentDatatype","./Core/CornerType","./Core/CorridorGeometry","./Core/CorridorGeometryLibrary","./Core/CorridorOutlineGeometry","./Core/createGuid","./Core/Credit","./Core/CubicRealPolynomial","./Core/CylinderGeometry","./Core/CylinderGeometryLibrary","./Core/CylinderOutlineGeometry","./Core/DefaultProxy","./Core/defaultValue","./Core/defined","./Core/defineProperties","./Core/deprecationWarning","./Core/destroyObject","./Core/DeveloperError","./Core/DistanceDisplayCondition","./Core/DistanceDisplayConditionGeometryInstanceAttribute","./Core/EarthOrientationParameters","./Core/EarthOrientationParametersSample","./Core/EasingFunction","./Core/EllipseGeometry","./Core/EllipseGeometryLibrary","./Core/EllipseOutlineGeometry","./Core/Ellipsoid","./Core/EllipsoidalOccluder","./Core/EllipsoidGeodesic","./Core/EllipsoidGeometry","./Core/EllipsoidOutlineGeometry","./Core/EllipsoidTangentPlane","./Core/EllipsoidTerrainProvider","./Core/EncodedCartesian3","./Core/Event","./Core/EventHelper","./Core/ExtrapolationType","./Core/FeatureDetection","./Core/formatError","./Core/freezeObject","./Core/Fullscreen","./Core/GeographicProjection","./Core/GeographicTilingScheme","./Core/Geometry","./Core/GeometryAttribute","./Core/GeometryAttributes","./Core/GeometryInstance","./Core/GeometryInstanceAttribute","./Core/GeometryPipeline","./Core/GeometryType","./Core/getAbsoluteUri","./Core/getBaseUri","./Core/getExtensionFromUri","./Core/getFilenameFromUri","./Core/getImagePixels","./Core/getMagic","./Core/getStringFromTypedArray","./Core/getTimestamp","./Core/GregorianDate","./Core/HeadingPitchRange","./Core/HeadingPitchRoll","./Core/HeightmapTerrainData","./Core/HeightmapTessellator","./Core/HermitePolynomialApproximation","./Core/HermiteSpline","./Core/Iau2000Orientation","./Core/Iau2006XysData","./Core/Iau2006XysSample","./Core/IauOrientationAxes","./Core/IauOrientationParameters","./Core/IndexDatatype","./Core/InterpolationAlgorithm","./Core/Intersect","./Core/Intersections2D","./Core/IntersectionTests","./Core/Interval","./Core/isArray","./Core/isCrossOriginUrl","./Core/isLeapYear","./Core/Iso8601","./Core/joinUrls","./Core/JulianDate","./Core/KeyboardEventModifier","./Core/LagrangePolynomialApproximation","./Core/LeapSecond","./Core/LinearApproximation","./Core/LinearSpline","./Core/loadArrayBuffer","./Core/loadBlob","./Core/loadImage","./Core/loadImageFromTypedArray","./Core/loadImageViaBlob","./Core/loadJson","./Core/loadJsonp","./Core/loadText","./Core/loadWithXhr","./Core/loadXML","./Core/MapboxApi","./Core/MapProjection","./Core/Math","./Core/Matrix2","./Core/Matrix3","./Core/Matrix4","./Core/mergeSort","./Core/NearFarScalar","./Core/objectToQuery","./Core/Occluder","./Core/oneTimeWarning","./Core/OrientedBoundingBox","./Core/Packable","./Core/PackableForInterpolation","./Core/parseResponseHeaders","./Core/PinBuilder","./Core/PixelFormat","./Core/Plane","./Core/PointGeometry","./Core/pointInsideTriangle","./Core/PolygonGeometry","./Core/PolygonGeometryLibrary","./Core/PolygonHierarchy","./Core/PolygonOutlineGeometry","./Core/PolygonPipeline","./Core/PolylineGeometry","./Core/PolylinePipeline","./Core/PolylineVolumeGeometry","./Core/PolylineVolumeGeometryLibrary","./Core/PolylineVolumeOutlineGeometry","./Core/PrimitiveType","./Core/QuadraticRealPolynomial","./Core/QuantizedMeshTerrainData","./Core/QuarticRealPolynomial","./Core/Quaternion","./Core/QuaternionSpline","./Core/queryToObject","./Core/Queue","./Core/Ray","./Core/Rectangle","./Core/RectangleGeometry","./Core/RectangleGeometryLibrary","./Core/RectangleOutlineGeometry","./Core/ReferenceFrame","./Core/requestAnimationFrame","./Core/RequestErrorEvent","./Core/RuntimeError","./Core/sampleTerrain","./Core/scaleToGeodeticSurface","./Core/ScreenSpaceEventHandler","./Core/ScreenSpaceEventType","./Core/ShowGeometryInstanceAttribute","./Core/Simon1994PlanetaryPositions","./Core/SimplePolylineGeometry","./Core/SphereGeometry","./Core/SphereOutlineGeometry","./Core/Spherical","./Core/Spline","./Core/subdivideArray","./Core/TaskProcessor","./Core/TerrainData","./Core/TerrainEncoding","./Core/TerrainMesh","./Core/TerrainProvider","./Core/TerrainQuantization","./Core/throttleRequestByServer","./Core/TileProviderError","./Core/TilingScheme","./Core/TimeConstants","./Core/TimeInterval","./Core/TimeIntervalCollection","./Core/TimeStandard","./Core/Tipsify","./Core/Transforms","./Core/TranslationRotationScale","./Core/TridiagonalSystemSolver","./Core/TrustedServers","./Core/VertexFormat","./Core/VideoSynchronizer","./Core/Visibility","./Core/VRTheWorldTerrainProvider","./Core/WallGeometry","./Core/WallGeometryLibrary","./Core/WallOutlineGeometry","./Core/WebMercatorProjection","./Core/WebMercatorTilingScheme","./Core/WindingOrder","./Core/wrapFunction","./Core/writeTextToCanvas","./DataSources/BillboardGraphics","./DataSources/BillboardVisualizer","./DataSources/BoundingSphereState","./DataSources/BoxGeometryUpdater","./DataSources/BoxGraphics","./DataSources/CallbackProperty","./DataSources/CheckerboardMaterialProperty","./DataSources/ColorMaterialProperty","./DataSources/CompositeEntityCollection","./DataSources/CompositeMaterialProperty","./DataSources/CompositePositionProperty","./DataSources/CompositeProperty","./DataSources/ConstantPositionProperty","./DataSources/ConstantProperty","./DataSources/CorridorGeometryUpdater","./DataSources/CorridorGraphics","./DataSources/createMaterialPropertyDescriptor","./DataSources/createPropertyDescriptor","./DataSources/createRawPropertyDescriptor","./DataSources/CustomDataSource","./DataSources/CylinderGeometryUpdater","./DataSources/CylinderGraphics","./DataSources/CzmlDataSource","./DataSources/DataSource","./DataSources/DataSourceClock","./DataSources/DataSourceCollection","./DataSources/DataSourceDisplay","./DataSources/dynamicGeometryGetBoundingSphere","./DataSources/DynamicGeometryUpdater","./DataSources/EllipseGeometryUpdater","./DataSources/EllipseGraphics","./DataSources/EllipsoidGeometryUpdater","./DataSources/EllipsoidGraphics","./DataSources/Entity","./DataSources/EntityCluster","./DataSources/EntityCollection","./DataSources/EntityView","./DataSources/GeoJsonDataSource","./DataSources/GeometryUpdater","./DataSources/GeometryVisualizer","./DataSources/GridMaterialProperty","./DataSources/ImageMaterialProperty","./DataSources/KmlDataSource","./DataSources/LabelGraphics","./DataSources/LabelVisualizer","./DataSources/MaterialProperty","./DataSources/ModelGraphics","./DataSources/ModelVisualizer","./DataSources/NodeTransformationProperty","./DataSources/PathGraphics","./DataSources/PathVisualizer","./DataSources/PointGraphics","./DataSources/PointVisualizer","./DataSources/PolygonGeometryUpdater","./DataSources/PolygonGraphics","./DataSources/PolylineArrowMaterialProperty","./DataSources/PolylineGeometryUpdater","./DataSources/PolylineGlowMaterialProperty","./DataSources/PolylineGraphics","./DataSources/PolylineOutlineMaterialProperty","./DataSources/PolylineVolumeGeometryUpdater","./DataSources/PolylineVolumeGraphics","./DataSources/PositionProperty","./DataSources/PositionPropertyArray","./DataSources/Property","./DataSources/PropertyArray","./DataSources/PropertyBag","./DataSources/RectangleGeometryUpdater","./DataSources/RectangleGraphics","./DataSources/ReferenceProperty","./DataSources/Rotation","./DataSources/SampledPositionProperty","./DataSources/SampledProperty","./DataSources/ScaledPositionProperty","./DataSources/StaticGeometryColorBatch","./DataSources/StaticGeometryPerMaterialBatch","./DataSources/StaticGroundGeometryColorBatch","./DataSources/StaticOutlineGeometryBatch","./DataSources/StripeMaterialProperty","./DataSources/StripeOrientation","./DataSources/TimeIntervalCollectionPositionProperty","./DataSources/TimeIntervalCollectionProperty","./DataSources/VelocityOrientationProperty","./DataSources/VelocityVectorProperty","./DataSources/Visualizer","./DataSources/WallGeometryUpdater","./DataSources/WallGraphics","./Renderer/AutomaticUniforms","./Renderer/Buffer","./Renderer/BufferUsage","./Renderer/ClearCommand","./Renderer/ComputeCommand","./Renderer/ComputeEngine","./Renderer/Context","./Renderer/ContextLimits","./Renderer/createUniform","./Renderer/createUniformArray","./Renderer/CubeMap","./Renderer/CubeMapFace","./Renderer/DrawCommand","./Renderer/Framebuffer","./Renderer/loadCubeMap","./Renderer/MipmapHint","./Renderer/PassState","./Renderer/PickFramebuffer","./Renderer/PixelDatatype","./Renderer/Renderbuffer","./Renderer/RenderbufferFormat","./Renderer/RenderState","./Renderer/Sampler","./Renderer/ShaderCache","./Renderer/ShaderProgram","./Renderer/ShaderSource","./Renderer/Texture","./Renderer/TextureMagnificationFilter","./Renderer/TextureMinificationFilter","./Renderer/TextureWrap","./Renderer/UniformState","./Renderer/VertexArray","./Renderer/VertexArrayFacade","./Renderer/WebGLConstants","./Scene/Appearance","./Scene/ArcGisMapServerImageryProvider","./Scene/BatchTable","./Scene/Billboard","./Scene/BillboardCollection","./Scene/BingMapsImageryProvider","./Scene/BingMapsStyle","./Scene/BlendEquation","./Scene/BlendFunction","./Scene/BlendingState","./Scene/Camera","./Scene/CameraEventAggregator","./Scene/CameraEventType","./Scene/CameraFlightPath","./Scene/createOpenStreetMapImageryProvider","./Scene/createTangentSpaceDebugPrimitive","./Scene/createTileMapServiceImageryProvider","./Scene/CreditDisplay","./Scene/CullFace","./Scene/CullingVolume","./Scene/DebugAppearance","./Scene/DebugCameraPrimitive","./Scene/DebugModelMatrixPrimitive","./Scene/DepthFunction","./Scene/DepthPlane","./Scene/DeviceOrientationCameraController","./Scene/DiscardMissingTileImagePolicy","./Scene/EllipsoidPrimitive","./Scene/EllipsoidSurfaceAppearance","./Scene/Fog","./Scene/FrameRateMonitor","./Scene/FrameState","./Scene/FrustumCommands","./Scene/FXAA","./Scene/getBinaryAccessor","./Scene/GetFeatureInfoFormat","./Scene/Globe","./Scene/GlobeDepth","./Scene/GlobeSurfaceShaderSet","./Scene/GlobeSurfaceTile","./Scene/GlobeSurfaceTileProvider","./Scene/GoogleEarthImageryProvider","./Scene/GridImageryProvider","./Scene/GroundPrimitive","./Scene/HeightReference","./Scene/HorizontalOrigin","./Scene/Imagery","./Scene/ImageryLayer","./Scene/ImageryLayerCollection","./Scene/ImageryLayerFeatureInfo","./Scene/ImageryProvider","./Scene/ImageryState","./Scene/Label","./Scene/LabelCollection","./Scene/LabelStyle","./Scene/MapboxImageryProvider","./Scene/MapMode2D","./Scene/Material","./Scene/MaterialAppearance","./Scene/Model","./Scene/ModelAnimation","./Scene/ModelAnimationCache","./Scene/ModelAnimationCollection","./Scene/ModelAnimationLoop","./Scene/ModelAnimationState","./Scene/ModelMaterial","./Scene/modelMaterialsCommon","./Scene/ModelMesh","./Scene/ModelNode","./Scene/Moon","./Scene/NeverTileDiscardPolicy","./Scene/OIT","./Scene/OrthographicFrustum","./Scene/Pass","./Scene/PerformanceDisplay","./Scene/PerInstanceColorAppearance","./Scene/PerspectiveFrustum","./Scene/PerspectiveOffCenterFrustum","./Scene/PickDepth","./Scene/PointAppearance","./Scene/PointPrimitive","./Scene/PointPrimitiveCollection","./Scene/Polyline","./Scene/PolylineCollection","./Scene/PolylineColorAppearance","./Scene/PolylineMaterialAppearance","./Scene/Primitive","./Scene/PrimitiveCollection","./Scene/PrimitivePipeline","./Scene/PrimitiveState","./Scene/QuadtreeOccluders","./Scene/QuadtreePrimitive","./Scene/QuadtreeTile","./Scene/QuadtreeTileLoadState","./Scene/QuadtreeTileProvider","./Scene/Scene","./Scene/SceneMode","./Scene/SceneTransforms","./Scene/SceneTransitioner","./Scene/ScreenSpaceCameraController","./Scene/ShadowMap","./Scene/ShadowMapShader","./Scene/ShadowMode","./Scene/SingleTileImageryProvider","./Scene/SkyAtmosphere","./Scene/SkyBox","./Scene/StencilFunction","./Scene/StencilOperation","./Scene/Sun","./Scene/SunPostProcess","./Scene/TerrainState","./Scene/TextureAtlas","./Scene/TileBoundingBox","./Scene/TileCoordinatesImageryProvider","./Scene/TileDiscardPolicy","./Scene/TileImagery","./Scene/TileReplacementQueue","./Scene/TileState","./Scene/TileTerrain","./Scene/TweenCollection","./Scene/UrlTemplateImageryProvider","./Scene/VerticalOrigin","./Scene/ViewportQuad","./Scene/WebMapServiceImageryProvider","./Scene/WebMapTileServiceImageryProvider","./Shaders/AdjustTranslucentFS","./Shaders/Appearances/AllMaterialAppearanceFS","./Shaders/Appearances/AllMaterialAppearanceVS","./Shaders/Appearances/BasicMaterialAppearanceFS","./Shaders/Appearances/BasicMaterialAppearanceVS","./Shaders/Appearances/EllipsoidSurfaceAppearanceFS","./Shaders/Appearances/EllipsoidSurfaceAppearanceVS","./Shaders/Appearances/PerInstanceColorAppearanceFS","./Shaders/Appearances/PerInstanceColorAppearanceVS","./Shaders/Appearances/PerInstanceFlatColorAppearanceFS","./Shaders/Appearances/PerInstanceFlatColorAppearanceVS","./Shaders/Appearances/PointAppearanceFS","./Shaders/Appearances/PointAppearanceVS","./Shaders/Appearances/PolylineColorAppearanceVS","./Shaders/Appearances/PolylineMaterialAppearanceVS","./Shaders/Appearances/TexturedMaterialAppearanceFS","./Shaders/Appearances/TexturedMaterialAppearanceVS","./Shaders/BillboardCollectionFS","./Shaders/BillboardCollectionVS","./Shaders/Builtin/Constants/degreesPerRadian","./Shaders/Builtin/Constants/depthRange","./Shaders/Builtin/Constants/epsilon1","./Shaders/Builtin/Constants/epsilon2","./Shaders/Builtin/Constants/epsilon3","./Shaders/Builtin/Constants/epsilon4","./Shaders/Builtin/Constants/epsilon5","./Shaders/Builtin/Constants/epsilon6","./Shaders/Builtin/Constants/epsilon7","./Shaders/Builtin/Constants/infinity","./Shaders/Builtin/Constants/oneOverPi","./Shaders/Builtin/Constants/oneOverTwoPi","./Shaders/Builtin/Constants/passCompute","./Shaders/Builtin/Constants/passEnvironment","./Shaders/Builtin/Constants/passGlobe","./Shaders/Builtin/Constants/passGround","./Shaders/Builtin/Constants/passOpaque","./Shaders/Builtin/Constants/passOverlay","./Shaders/Builtin/Constants/passTranslucent","./Shaders/Builtin/Constants/pi","./Shaders/Builtin/Constants/piOverFour","./Shaders/Builtin/Constants/piOverSix","./Shaders/Builtin/Constants/piOverThree","./Shaders/Builtin/Constants/piOverTwo","./Shaders/Builtin/Constants/radiansPerDegree","./Shaders/Builtin/Constants/sceneMode2D","./Shaders/Builtin/Constants/sceneMode3D","./Shaders/Builtin/Constants/sceneModeColumbusView","./Shaders/Builtin/Constants/sceneModeMorphing","./Shaders/Builtin/Constants/solarRadius","./Shaders/Builtin/Constants/threePiOver2","./Shaders/Builtin/Constants/twoPi","./Shaders/Builtin/Constants/webMercatorMaxLatitude","./Shaders/Builtin/CzmBuiltins","./Shaders/Builtin/Functions/alphaWeight","./Shaders/Builtin/Functions/antialias","./Shaders/Builtin/Functions/cascadeColor","./Shaders/Builtin/Functions/cascadeDistance","./Shaders/Builtin/Functions/cascadeMatrix","./Shaders/Builtin/Functions/cascadeWeights","./Shaders/Builtin/Functions/columbusViewMorph","./Shaders/Builtin/Functions/computePosition","./Shaders/Builtin/Functions/cosineAndSine","./Shaders/Builtin/Functions/decompressTextureCoordinates","./Shaders/Builtin/Functions/eastNorthUpToEyeCoordinates","./Shaders/Builtin/Functions/ellipsoidContainsPoint","./Shaders/Builtin/Functions/ellipsoidNew","./Shaders/Builtin/Functions/ellipsoidWgs84TextureCoordinates","./Shaders/Builtin/Functions/equalsEpsilon","./Shaders/Builtin/Functions/eyeOffset","./Shaders/Builtin/Functions/eyeToWindowCoordinates","./Shaders/Builtin/Functions/fog","./Shaders/Builtin/Functions/geodeticSurfaceNormal","./Shaders/Builtin/Functions/getDefaultMaterial","./Shaders/Builtin/Functions/getLambertDiffuse","./Shaders/Builtin/Functions/getSpecular","./Shaders/Builtin/Functions/getWaterNoise","./Shaders/Builtin/Functions/getWgs84EllipsoidEC","./Shaders/Builtin/Functions/hue","./Shaders/Builtin/Functions/isEmpty","./Shaders/Builtin/Functions/isFull","./Shaders/Builtin/Functions/latitudeToWebMercatorFraction","./Shaders/Builtin/Functions/luminance","./Shaders/Builtin/Functions/metersPerPixel","./Shaders/Builtin/Functions/modelToWindowCoordinates","./Shaders/Builtin/Functions/multiplyWithColorBalance","./Shaders/Builtin/Functions/nearFarScalar","./Shaders/Builtin/Functions/octDecode","./Shaders/Builtin/Functions/packDepth","./Shaders/Builtin/Functions/phong","./Shaders/Builtin/Functions/pointAlongRay","./Shaders/Builtin/Functions/rayEllipsoidIntersectionInterval","./Shaders/Builtin/Functions/RGBToXYZ","./Shaders/Builtin/Functions/saturation","./Shaders/Builtin/Functions/shadowDepthCompare","./Shaders/Builtin/Functions/shadowVisibility","./Shaders/Builtin/Functions/signNotZero","./Shaders/Builtin/Functions/tangentToEyeSpaceMatrix","./Shaders/Builtin/Functions/translateRelativeToEye","./Shaders/Builtin/Functions/translucentPhong","./Shaders/Builtin/Functions/transpose","./Shaders/Builtin/Functions/unpackDepth","./Shaders/Builtin/Functions/windowToEyeCoordinates","./Shaders/Builtin/Functions/XYZToRGB","./Shaders/Builtin/Structs/depthRangeStruct","./Shaders/Builtin/Structs/ellipsoid","./Shaders/Builtin/Structs/material","./Shaders/Builtin/Structs/materialInput","./Shaders/Builtin/Structs/ray","./Shaders/Builtin/Structs/raySegment","./Shaders/Builtin/Structs/shadowParameters","./Shaders/CompositeOITFS","./Shaders/DepthPlaneFS","./Shaders/DepthPlaneVS","./Shaders/EllipsoidFS","./Shaders/EllipsoidVS","./Shaders/GlobeFS","./Shaders/GlobeVS","./Shaders/GroundAtmosphere","./Shaders/Materials/BumpMapMaterial","./Shaders/Materials/CheckerboardMaterial","./Shaders/Materials/DotMaterial","./Shaders/Materials/FadeMaterial","./Shaders/Materials/GridMaterial","./Shaders/Materials/NormalMapMaterial","./Shaders/Materials/PolylineArrowMaterial","./Shaders/Materials/PolylineGlowMaterial","./Shaders/Materials/PolylineOutlineMaterial","./Shaders/Materials/RimLightingMaterial","./Shaders/Materials/StripeMaterial","./Shaders/Materials/Water","./Shaders/PointPrimitiveCollectionFS","./Shaders/PointPrimitiveCollectionVS","./Shaders/PolylineCommon","./Shaders/PolylineFS","./Shaders/PolylineVS","./Shaders/PostProcessFilters/AdditiveBlend","./Shaders/PostProcessFilters/BrightPass","./Shaders/PostProcessFilters/FXAA","./Shaders/PostProcessFilters/GaussianBlur1D","./Shaders/PostProcessFilters/PassThrough","./Shaders/ReprojectWebMercatorFS","./Shaders/ReprojectWebMercatorVS","./Shaders/ShadowVolumeFS","./Shaders/ShadowVolumeVS","./Shaders/SkyAtmosphereFS","./Shaders/SkyAtmosphereVS","./Shaders/SkyBoxFS","./Shaders/SkyBoxVS","./Shaders/SunFS","./Shaders/SunTextureFS","./Shaders/SunVS","./Shaders/ViewportQuadFS","./Shaders/ViewportQuadVS","./ThirdParty/Autolinker","./ThirdParty/earcut-2.1.1","./ThirdParty/gltfDefaults","./ThirdParty/kdbush","./ThirdParty/knockout-3.4.0","./ThirdParty/knockout-es5","./ThirdParty/knockout","./ThirdParty/measureText","./ThirdParty/mersenne-twister","./ThirdParty/NoSleep","./ThirdParty/sprintf","./ThirdParty/topojson","./ThirdParty/Tween","./ThirdParty/Uri","./ThirdParty/when","./ThirdParty/zip","./Widgets/Animation/Animation","./Widgets/Animation/AnimationViewModel","./Widgets/BaseLayerPicker/BaseLayerPicker","./Widgets/BaseLayerPicker/BaseLayerPickerViewModel","./Widgets/BaseLayerPicker/createDefaultImageryProviderViewModels","./Widgets/BaseLayerPicker/createDefaultTerrainProviderViewModels","./Widgets/BaseLayerPicker/ProviderViewModel","./Widgets/CesiumInspector/CesiumInspector","./Widgets/CesiumInspector/CesiumInspectorViewModel","./Widgets/CesiumWidget/CesiumWidget","./Widgets/ClockViewModel","./Widgets/Command","./Widgets/createCommand","./Widgets/FullscreenButton/FullscreenButton","./Widgets/FullscreenButton/FullscreenButtonViewModel","./Widgets/Geocoder/Geocoder","./Widgets/Geocoder/GeocoderViewModel","./Widgets/getElement","./Widgets/HomeButton/HomeButton","./Widgets/HomeButton/HomeButtonViewModel","./Widgets/InfoBox/InfoBox","./Widgets/InfoBox/InfoBoxViewModel","./Widgets/NavigationHelpButton/NavigationHelpButton","./Widgets/NavigationHelpButton/NavigationHelpButtonViewModel","./Widgets/PerformanceWatchdog/PerformanceWatchdog","./Widgets/PerformanceWatchdog/PerformanceWatchdogViewModel","./Widgets/SceneModePicker/SceneModePicker","./Widgets/SceneModePicker/SceneModePickerViewModel","./Widgets/SelectionIndicator/SelectionIndicator","./Widgets/SelectionIndicator/SelectionIndicatorViewModel","./Widgets/subscribeAndEvaluate","./Widgets/SvgPathBindingHandler","./Widgets/Timeline/Timeline","./Widgets/Timeline/TimelineHighlightRange","./Widgets/Timeline/TimelineTrack","./Widgets/ToggleButtonViewModel","./Widgets/Viewer/Viewer","./Widgets/Viewer/viewerCesiumInspectorMixin","./Widgets/Viewer/viewerDragDropMixin","./Widgets/Viewer/viewerPerformanceWatchdogMixin","./Widgets/VRButton/VRButton","./Widgets/VRButton/VRButtonViewModel","./Workers/createTaskProcessorWorker"],function(e,t,n,r,i,o,a,s,l,u,c,h,d,p,f,m,_,g,v,y,C,w,b,E,S,x,T,A,P,D,M,I,O,R,N,L,F,B,k,V,z,U,G,W,H,j,q,Y,X,Z,K,Q,J,$,ee,te,ne,re,ie,oe,ae,se,le,ue,ce,he,de,pe,fe,me,_e,ge,ve,ye,Ce,we,be,Ee,Se,xe,Te,Ae,Pe,De,Me,Ie,Oe,Re,Ne,Le,Fe,Be,ke,Ve,ze,Ue,Ge,We,He,je,qe,Ye,Xe,Ze,Ke,Qe,Je,$e,et,tt,nt,rt,it,ot,at,st,lt,ut,ct,ht,dt,pt,ft,mt,_t,gt,vt,yt,Ct,wt,bt,Et,St,xt,Tt,At,Pt,Dt,Mt,It,Ot,Rt,Nt,Lt,Ft,Bt,kt,Vt,zt,Ut,Gt,Wt,Ht,jt,qt,Yt,Xt,Zt,Kt,Qt,Jt,$t,en,tn,nn,rn,on,an,sn,ln,un,cn,hn,dn,pn,fn,mn,_n,gn,vn,yn,Cn,wn,bn,En,Sn,xn,Tn,An,Pn,Dn,Mn,In,On,Rn,Nn,Ln,Fn,Bn,kn,Vn,zn,Un,Gn,Wn,Hn,jn,qn,Yn,Xn,Zn,Kn,Qn,Jn,$n,er,tr,nr,rr,ir,or,ar,sr,lr,ur,cr,hr,dr,pr,fr,mr,_r,gr,vr,yr,Cr,wr,br,Er,Sr,xr,Tr,Ar,Pr,Dr,Mr,Ir,Or,Rr,Nr,Lr,Fr,Br,kr,Vr,zr,Ur,Gr,Wr,Hr,jr,qr,Yr,Xr,Zr,Kr,Qr,Jr,$r,ei,ti,ni,ri,ii,oi,ai,si,li,ui,ci,hi,di,pi,fi,mi,_i,gi,vi,yi,Ci,wi,bi,Ei,Si,xi,Ti,Ai,Pi,Di,Mi,Ii,Oi,Ri,Ni,Li,Fi,Bi,ki,Vi,zi,Ui,Gi,Wi,Hi,ji,qi,Yi,Xi,Zi,Ki,Qi,Ji,$i,eo,to,no,ro,io,oo,ao,so,lo,uo,co,ho,po,fo,mo,_o,go,vo,yo,Co,wo,bo,Eo,So,xo,To,Ao,Po,Do,Mo,Io,Oo,Ro,No,Lo,Fo,Bo,ko,Vo,zo,Uo,Go,Wo,Ho,jo,qo,Yo,Xo,Zo,Ko,Qo,Jo,$o,ea,ta,na,ra,ia,oa,aa,sa,la,ua,ca,ha,da,pa,fa,ma,_a,ga,va,ya,Ca,wa,ba,Ea,Sa,xa,Ta,Aa,Pa,Da,Ma,Ia,Oa,Ra,Na,La,Fa,Ba,ka,Va,za,Ua,Ga,Wa,Ha,ja,qa,Ya,Xa,Za,Ka,Qa,Ja,$a,es,ts,ns,rs,is,os,as,ss,ls,us,cs,hs,ds,ps,fs,ms,_s,gs,vs,ys,Cs,ws,bs,Es,Ss,xs,Ts,As,Ps,Ds,Ms,Is,Os,Rs,Ns,Ls,Fs,Bs,ks,Vs,zs,Us,Gs,Ws,Hs,js,qs,Ys,Xs,Zs,Ks,Qs,Js,$s,el,tl,nl,rl,il,ol,al,sl,ll,ul,cl,hl,dl,pl,fl,ml,_l,gl,vl,yl,Cl,wl,bl,El,Sl,xl,Tl,Al,Pl,Dl,Ml,Il,Ol,Rl,Nl,Ll,Fl,Bl,kl,Vl,zl,Ul,Gl,Wl,Hl,jl,ql,Yl,Xl,Zl,Kl,Ql,Jl,$l,eu,tu,nu,ru,iu,ou,au,su,lu,uu,cu,hu,du,pu,fu,mu,_u,gu,vu,yu,Cu,wu,bu,Eu,Su,xu,Tu,Au,Pu,Du,Mu,Iu,Ou,Ru,Nu,Lu,Fu,Bu,ku,Vu,zu,Uu,Gu,Wu,Hu,ju,qu,Yu,Xu,Zu,Ku,Qu,Ju,$u,ec,tc,nc,rc,ic,oc,ac,sc,lc,uc,cc,hc,dc,pc,fc,mc,_c,gc,vc,yc,Cc,wc,bc,Ec,Sc,xc,Tc,Ac,Pc,Dc,Mc,Ic,Oc,Rc,Nc,Lc,Fc,Bc,kc,Vc,zc,Uc,Gc,Wc,Hc,jc,qc,Yc,Xc,Zc,Kc,Qc,Jc,$c,eh,th,nh,rh,ih,oh,ah,sh,lh,uh,ch,hh,dh,ph,fh,mh,_h,gh,vh,yh,Ch,wh,bh,Eh,Sh,xh,Th,Ah){"use strict";var Ph={VERSION:"1.27",_shaders:{}};return Ph.appendForwardSlash=e,Ph.ArcGisImageServerTerrainProvider=t,Ph.arrayRemoveDuplicates=n,Ph.AssociativeArray=r,Ph.AttributeCompression=i,Ph.AxisAlignedBoundingBox=o,Ph.barycentricCoordinates=a,Ph.binarySearch=s,Ph.BingMapsApi=l,Ph.BoundingRectangle=u,Ph.BoundingSphere=c,Ph.BoxGeometry=h,Ph.BoxOutlineGeometry=d,Ph.buildModuleUrl=p,Ph.cancelAnimationFrame=f,Ph.Cartesian2=m,Ph.Cartesian3=_,Ph.Cartesian4=g,Ph.Cartographic=v,Ph.CatmullRomSpline=y,Ph.CesiumTerrainProvider=C,Ph.CircleGeometry=w,Ph.CircleOutlineGeometry=b,Ph.Clock=E,Ph.ClockRange=S,Ph.ClockStep=x,Ph.clone=T,Ph.Color=A,Ph.ColorGeometryInstanceAttribute=P,Ph.combine=D,Ph.ComponentDatatype=M,Ph.CornerType=I,Ph.CorridorGeometry=O,Ph.CorridorGeometryLibrary=R,Ph.CorridorOutlineGeometry=N,Ph.createGuid=L,Ph.Credit=F,Ph.CubicRealPolynomial=B,Ph.CylinderGeometry=k,Ph.CylinderGeometryLibrary=V,Ph.CylinderOutlineGeometry=z,Ph.DefaultProxy=U,Ph.defaultValue=G,Ph.defined=W,Ph.defineProperties=H,Ph.deprecationWarning=j,Ph.destroyObject=q,Ph.DeveloperError=Y,Ph.DistanceDisplayCondition=X,Ph.DistanceDisplayConditionGeometryInstanceAttribute=Z,Ph.EarthOrientationParameters=K,Ph.EarthOrientationParametersSample=Q,Ph.EasingFunction=J,Ph.EllipseGeometry=$,Ph.EllipseGeometryLibrary=ee,Ph.EllipseOutlineGeometry=te,Ph.Ellipsoid=ne,Ph.EllipsoidalOccluder=re,Ph.EllipsoidGeodesic=ie,Ph.EllipsoidGeometry=oe,Ph.EllipsoidOutlineGeometry=ae,Ph.EllipsoidTangentPlane=se,Ph.EllipsoidTerrainProvider=le,Ph.EncodedCartesian3=ue,Ph.Event=ce,Ph.EventHelper=he,Ph.ExtrapolationType=de,Ph.FeatureDetection=pe,Ph.formatError=fe,Ph.freezeObject=me,Ph.Fullscreen=_e,Ph.GeographicProjection=ge,Ph.GeographicTilingScheme=ve,Ph.Geometry=ye,Ph.GeometryAttribute=Ce,Ph.GeometryAttributes=we,Ph.GeometryInstance=be,Ph.GeometryInstanceAttribute=Ee,Ph.GeometryPipeline=Se,Ph.GeometryType=xe,Ph.getAbsoluteUri=Te,Ph.getBaseUri=Ae,Ph.getExtensionFromUri=Pe,Ph.getFilenameFromUri=De,Ph.getImagePixels=Me,Ph.getMagic=Ie,Ph.getStringFromTypedArray=Oe,Ph.getTimestamp=Re,Ph.GregorianDate=Ne,Ph.HeadingPitchRange=Le,Ph.HeadingPitchRoll=Fe,Ph.HeightmapTerrainData=Be,Ph.HeightmapTessellator=ke,Ph.HermitePolynomialApproximation=Ve,Ph.HermiteSpline=ze,Ph.Iau2000Orientation=Ue,Ph.Iau2006XysData=Ge,Ph.Iau2006XysSample=We,Ph.IauOrientationAxes=He,Ph.IauOrientationParameters=je,Ph.IndexDatatype=qe,Ph.InterpolationAlgorithm=Ye,Ph.Intersect=Xe,Ph.Intersections2D=Ze,Ph.IntersectionTests=Ke,Ph.Interval=Qe,Ph.isArray=Je,Ph.isCrossOriginUrl=$e,Ph.isLeapYear=et,Ph.Iso8601=tt,Ph.joinUrls=nt,Ph.JulianDate=rt,Ph.KeyboardEventModifier=it,Ph.LagrangePolynomialApproximation=ot,Ph.LeapSecond=at,Ph.LinearApproximation=st,Ph.LinearSpline=lt,Ph.loadArrayBuffer=ut,Ph.loadBlob=ct,Ph.loadImage=ht,Ph.loadImageFromTypedArray=dt,Ph.loadImageViaBlob=pt,Ph.loadJson=ft,Ph.loadJsonp=mt,Ph.loadText=_t,Ph.loadWithXhr=gt,Ph.loadXML=vt,Ph.MapboxApi=yt,Ph.MapProjection=Ct,Ph.Math=wt,Ph.Matrix2=bt,Ph.Matrix3=Et,Ph.Matrix4=St,Ph.mergeSort=xt,Ph.NearFarScalar=Tt,Ph.objectToQuery=At,Ph.Occluder=Pt,Ph.oneTimeWarning=Dt,Ph.OrientedBoundingBox=Mt,Ph.Packable=It,Ph.PackableForInterpolation=Ot,Ph.parseResponseHeaders=Rt,Ph.PinBuilder=Nt,Ph.PixelFormat=Lt,Ph.Plane=Ft,Ph.PointGeometry=Bt,Ph.pointInsideTriangle=kt,Ph.PolygonGeometry=Vt,Ph.PolygonGeometryLibrary=zt,Ph.PolygonHierarchy=Ut,Ph.PolygonOutlineGeometry=Gt,Ph.PolygonPipeline=Wt,Ph.PolylineGeometry=Ht,Ph.PolylinePipeline=jt,Ph.PolylineVolumeGeometry=qt,Ph.PolylineVolumeGeometryLibrary=Yt,Ph.PolylineVolumeOutlineGeometry=Xt,Ph.PrimitiveType=Zt,Ph.QuadraticRealPolynomial=Kt,Ph.QuantizedMeshTerrainData=Qt,Ph.QuarticRealPolynomial=Jt,Ph.Quaternion=$t,Ph.QuaternionSpline=en,Ph.queryToObject=tn,Ph.Queue=nn,Ph.Ray=rn,Ph.Rectangle=on,Ph.RectangleGeometry=an,Ph.RectangleGeometryLibrary=sn,Ph.RectangleOutlineGeometry=ln,Ph.ReferenceFrame=un,Ph.requestAnimationFrame=cn,Ph.RequestErrorEvent=hn,Ph.RuntimeError=dn,Ph.sampleTerrain=pn,Ph.scaleToGeodeticSurface=fn,Ph.ScreenSpaceEventHandler=mn,Ph.ScreenSpaceEventType=_n,Ph.ShowGeometryInstanceAttribute=gn,Ph.Simon1994PlanetaryPositions=vn,Ph.SimplePolylineGeometry=yn,Ph.SphereGeometry=Cn,Ph.SphereOutlineGeometry=wn,Ph.Spherical=bn,Ph.Spline=En,Ph.subdivideArray=Sn,Ph.TaskProcessor=xn,Ph.TerrainData=Tn,Ph.TerrainEncoding=An,Ph.TerrainMesh=Pn,Ph.TerrainProvider=Dn,Ph.TerrainQuantization=Mn,Ph.throttleRequestByServer=In,Ph.TileProviderError=On,Ph.TilingScheme=Rn,Ph.TimeConstants=Nn,Ph.TimeInterval=Ln,Ph.TimeIntervalCollection=Fn,Ph.TimeStandard=Bn,Ph.Tipsify=kn,Ph.Transforms=Vn,Ph.TranslationRotationScale=zn,Ph.TridiagonalSystemSolver=Un,Ph.TrustedServers=Gn,Ph.VertexFormat=Wn,Ph.VideoSynchronizer=Hn,Ph.Visibility=jn,Ph.VRTheWorldTerrainProvider=qn,Ph.WallGeometry=Yn,Ph.WallGeometryLibrary=Xn,Ph.WallOutlineGeometry=Zn,Ph.WebMercatorProjection=Kn,Ph.WebMercatorTilingScheme=Qn,Ph.WindingOrder=Jn,Ph.wrapFunction=$n,Ph.writeTextToCanvas=er,Ph.BillboardGraphics=tr,Ph.BillboardVisualizer=nr,Ph.BoundingSphereState=rr,Ph.BoxGeometryUpdater=ir,Ph.BoxGraphics=or,Ph.CallbackProperty=ar,Ph.CheckerboardMaterialProperty=sr,Ph.ColorMaterialProperty=lr,Ph.CompositeEntityCollection=ur,Ph.CompositeMaterialProperty=cr,Ph.CompositePositionProperty=hr,Ph.CompositeProperty=dr,Ph.ConstantPositionProperty=pr,Ph.ConstantProperty=fr,Ph.CorridorGeometryUpdater=mr,Ph.CorridorGraphics=_r,Ph.createMaterialPropertyDescriptor=gr,Ph.createPropertyDescriptor=vr,Ph.createRawPropertyDescriptor=yr,Ph.CustomDataSource=Cr,Ph.CylinderGeometryUpdater=wr,Ph.CylinderGraphics=br,Ph.CzmlDataSource=Er,Ph.DataSource=Sr,Ph.DataSourceClock=xr,Ph.DataSourceCollection=Tr,Ph.DataSourceDisplay=Ar,Ph.dynamicGeometryGetBoundingSphere=Pr,Ph.DynamicGeometryUpdater=Dr,Ph.EllipseGeometryUpdater=Mr,Ph.EllipseGraphics=Ir,Ph.EllipsoidGeometryUpdater=Or,Ph.EllipsoidGraphics=Rr,Ph.Entity=Nr,Ph.EntityCluster=Lr,Ph.EntityCollection=Fr,Ph.EntityView=Br,Ph.GeoJsonDataSource=kr,Ph.GeometryUpdater=Vr,Ph.GeometryVisualizer=zr,Ph.GridMaterialProperty=Ur,Ph.ImageMaterialProperty=Gr,Ph.KmlDataSource=Wr,Ph.LabelGraphics=Hr,Ph.LabelVisualizer=jr,Ph.MaterialProperty=qr,Ph.ModelGraphics=Yr,Ph.ModelVisualizer=Xr,Ph.NodeTransformationProperty=Zr,Ph.PathGraphics=Kr,Ph.PathVisualizer=Qr,Ph.PointGraphics=Jr,Ph.PointVisualizer=$r,Ph.PolygonGeometryUpdater=ei,Ph.PolygonGraphics=ti,Ph.PolylineArrowMaterialProperty=ni,Ph.PolylineGeometryUpdater=ri,Ph.PolylineGlowMaterialProperty=ii,Ph.PolylineGraphics=oi,Ph.PolylineOutlineMaterialProperty=ai,Ph.PolylineVolumeGeometryUpdater=si,Ph.PolylineVolumeGraphics=li,Ph.PositionProperty=ui,Ph.PositionPropertyArray=ci,Ph.Property=hi,Ph.PropertyArray=di,Ph.PropertyBag=pi,Ph.RectangleGeometryUpdater=fi,Ph.RectangleGraphics=mi,Ph.ReferenceProperty=_i,Ph.Rotation=gi,Ph.SampledPositionProperty=vi,Ph.SampledProperty=yi,Ph.ScaledPositionProperty=Ci,Ph.StaticGeometryColorBatch=wi,Ph.StaticGeometryPerMaterialBatch=bi,Ph.StaticGroundGeometryColorBatch=Ei,Ph.StaticOutlineGeometryBatch=Si,Ph.StripeMaterialProperty=xi,Ph.StripeOrientation=Ti,Ph.TimeIntervalCollectionPositionProperty=Ai,Ph.TimeIntervalCollectionProperty=Pi,Ph.VelocityOrientationProperty=Di,Ph.VelocityVectorProperty=Mi,Ph.Visualizer=Ii,Ph.WallGeometryUpdater=Oi,Ph.WallGraphics=Ri,Ph.AutomaticUniforms=Ni,Ph.Buffer=Li,Ph.BufferUsage=Fi,Ph.ClearCommand=Bi,Ph.ComputeCommand=ki,Ph.ComputeEngine=Vi,Ph.Context=zi,Ph.ContextLimits=Ui,Ph.createUniform=Gi,Ph.createUniformArray=Wi,Ph.CubeMap=Hi,Ph.CubeMapFace=ji,Ph.DrawCommand=qi,Ph.Framebuffer=Yi,Ph.loadCubeMap=Xi,Ph.MipmapHint=Zi,Ph.PassState=Ki,Ph.PickFramebuffer=Qi,Ph.PixelDatatype=Ji,Ph.Renderbuffer=$i,Ph.RenderbufferFormat=eo,Ph.RenderState=to,Ph.Sampler=no,Ph.ShaderCache=ro,Ph.ShaderProgram=io,Ph.ShaderSource=oo,Ph.Texture=ao,Ph.TextureMagnificationFilter=so,Ph.TextureMinificationFilter=lo,Ph.TextureWrap=uo,Ph.UniformState=co,Ph.VertexArray=ho,Ph.VertexArrayFacade=po,Ph.WebGLConstants=fo,Ph.Appearance=mo,Ph.ArcGisMapServerImageryProvider=_o,Ph.BatchTable=go,Ph.Billboard=vo,Ph.BillboardCollection=yo,Ph.BingMapsImageryProvider=Co,Ph.BingMapsStyle=wo,Ph.BlendEquation=bo,Ph.BlendFunction=Eo,Ph.BlendingState=So,Ph.Camera=xo,Ph.CameraEventAggregator=To,Ph.CameraEventType=Ao,Ph.CameraFlightPath=Po,Ph.createOpenStreetMapImageryProvider=Do,Ph.createTangentSpaceDebugPrimitive=Mo,Ph.createTileMapServiceImageryProvider=Io,Ph.CreditDisplay=Oo,Ph.CullFace=Ro,Ph.CullingVolume=No,Ph.DebugAppearance=Lo,Ph.DebugCameraPrimitive=Fo,Ph.DebugModelMatrixPrimitive=Bo,Ph.DepthFunction=ko,Ph.DepthPlane=Vo,Ph.DeviceOrientationCameraController=zo,Ph.DiscardMissingTileImagePolicy=Uo,Ph.EllipsoidPrimitive=Go,Ph.EllipsoidSurfaceAppearance=Wo,Ph.Fog=Ho,Ph.FrameRateMonitor=jo,Ph.FrameState=qo,Ph.FrustumCommands=Yo,Ph.FXAA=Xo,Ph.getBinaryAccessor=Zo,Ph.GetFeatureInfoFormat=Ko,Ph.Globe=Qo,Ph.GlobeDepth=Jo,Ph.GlobeSurfaceShaderSet=$o,Ph.GlobeSurfaceTile=ea,Ph.GlobeSurfaceTileProvider=ta,Ph.GoogleEarthImageryProvider=na,Ph.GridImageryProvider=ra,Ph.GroundPrimitive=ia,Ph.HeightReference=oa,Ph.HorizontalOrigin=aa,Ph.Imagery=sa,Ph.ImageryLayer=la,Ph.ImageryLayerCollection=ua,Ph.ImageryLayerFeatureInfo=ca,Ph.ImageryProvider=ha,Ph.ImageryState=da,Ph.Label=pa,Ph.LabelCollection=fa,Ph.LabelStyle=ma,Ph.MapboxImageryProvider=_a,Ph.MapMode2D=ga,Ph.Material=va,Ph.MaterialAppearance=ya,Ph.Model=Ca,Ph.ModelAnimation=wa,Ph.ModelAnimationCache=ba,Ph.ModelAnimationCollection=Ea,Ph.ModelAnimationLoop=Sa,Ph.ModelAnimationState=xa,Ph.ModelMaterial=Ta,Ph.modelMaterialsCommon=Aa,Ph.ModelMesh=Pa,Ph.ModelNode=Da,Ph.Moon=Ma,Ph.NeverTileDiscardPolicy=Ia,Ph.OIT=Oa,Ph.OrthographicFrustum=Ra,Ph.Pass=Na,Ph.PerformanceDisplay=La,Ph.PerInstanceColorAppearance=Fa,Ph.PerspectiveFrustum=Ba,Ph.PerspectiveOffCenterFrustum=ka,Ph.PickDepth=Va,Ph.PointAppearance=za,Ph.PointPrimitive=Ua,Ph.PointPrimitiveCollection=Ga,Ph.Polyline=Wa,Ph.PolylineCollection=Ha,Ph.PolylineColorAppearance=ja,Ph.PolylineMaterialAppearance=qa,Ph.Primitive=Ya,Ph.PrimitiveCollection=Xa,Ph.PrimitivePipeline=Za,Ph.PrimitiveState=Ka,Ph.QuadtreeOccluders=Qa,Ph.QuadtreePrimitive=Ja,Ph.QuadtreeTile=$a,Ph.QuadtreeTileLoadState=es,Ph.QuadtreeTileProvider=ts,Ph.Scene=ns,Ph.SceneMode=rs,Ph.SceneTransforms=is,Ph.SceneTransitioner=os,Ph.ScreenSpaceCameraController=as,Ph.ShadowMap=ss,Ph.ShadowMapShader=ls,Ph.ShadowMode=us,Ph.SingleTileImageryProvider=cs,Ph.SkyAtmosphere=hs,Ph.SkyBox=ds,Ph.StencilFunction=ps,Ph.StencilOperation=fs,Ph.Sun=ms,Ph.SunPostProcess=_s,Ph.TerrainState=gs,Ph.TextureAtlas=vs,Ph.TileBoundingBox=ys,Ph.TileCoordinatesImageryProvider=Cs,Ph.TileDiscardPolicy=ws,Ph.TileImagery=bs,Ph.TileReplacementQueue=Es,Ph.TileState=Ss,Ph.TileTerrain=xs,Ph.TweenCollection=Ts,Ph.UrlTemplateImageryProvider=As,Ph.VerticalOrigin=Ps,Ph.ViewportQuad=Ds,Ph.WebMapServiceImageryProvider=Ms,Ph.WebMapTileServiceImageryProvider=Is,Ph._shaders.AdjustTranslucentFS=Os,Ph._shaders.AllMaterialAppearanceFS=Rs,Ph._shaders.AllMaterialAppearanceVS=Ns,Ph._shaders.BasicMaterialAppearanceFS=Ls,Ph._shaders.BasicMaterialAppearanceVS=Fs,Ph._shaders.EllipsoidSurfaceAppearanceFS=Bs,Ph._shaders.EllipsoidSurfaceAppearanceVS=ks,Ph._shaders.PerInstanceColorAppearanceFS=Vs,Ph._shaders.PerInstanceColorAppearanceVS=zs,Ph._shaders.PerInstanceFlatColorAppearanceFS=Us,Ph._shaders.PerInstanceFlatColorAppearanceVS=Gs,Ph._shaders.PointAppearanceFS=Ws,Ph._shaders.PointAppearanceVS=Hs,Ph._shaders.PolylineColorAppearanceVS=js,Ph._shaders.PolylineMaterialAppearanceVS=qs,Ph._shaders.TexturedMaterialAppearanceFS=Ys,Ph._shaders.TexturedMaterialAppearanceVS=Xs,Ph._shaders.BillboardCollectionFS=Zs,Ph._shaders.BillboardCollectionVS=Ks,Ph._shaders.degreesPerRadian=Qs,Ph._shaders.depthRange=Js,Ph._shaders.epsilon1=$s,Ph._shaders.epsilon2=el,Ph._shaders.epsilon3=tl,Ph._shaders.epsilon4=nl,Ph._shaders.epsilon5=rl,Ph._shaders.epsilon6=il,Ph._shaders.epsilon7=ol,Ph._shaders.infinity=al,Ph._shaders.oneOverPi=sl,Ph._shaders.oneOverTwoPi=ll,Ph._shaders.passCompute=ul,Ph._shaders.passEnvironment=cl,Ph._shaders.passGlobe=hl,Ph._shaders.passGround=dl,Ph._shaders.passOpaque=pl,Ph._shaders.passOverlay=fl,Ph._shaders.passTranslucent=ml,Ph._shaders.pi=_l,Ph._shaders.piOverFour=gl,Ph._shaders.piOverSix=vl,Ph._shaders.piOverThree=yl,Ph._shaders.piOverTwo=Cl,Ph._shaders.radiansPerDegree=wl,Ph._shaders.sceneMode2D=bl,Ph._shaders.sceneMode3D=El,Ph._shaders.sceneModeColumbusView=Sl,Ph._shaders.sceneModeMorphing=xl,Ph._shaders.solarRadius=Tl,Ph._shaders.threePiOver2=Al,Ph._shaders.twoPi=Pl,Ph._shaders.webMercatorMaxLatitude=Dl,Ph._shaders.CzmBuiltins=Ml,Ph._shaders.alphaWeight=Il,Ph._shaders.antialias=Ol,Ph._shaders.cascadeColor=Rl,Ph._shaders.cascadeDistance=Nl,Ph._shaders.cascadeMatrix=Ll,Ph._shaders.cascadeWeights=Fl,Ph._shaders.columbusViewMorph=Bl,Ph._shaders.computePosition=kl,Ph._shaders.cosineAndSine=Vl,Ph._shaders.decompressTextureCoordinates=zl,Ph._shaders.eastNorthUpToEyeCoordinates=Ul,Ph._shaders.ellipsoidContainsPoint=Gl,Ph._shaders.ellipsoidNew=Wl,Ph._shaders.ellipsoidWgs84TextureCoordinates=Hl,Ph._shaders.equalsEpsilon=jl,Ph._shaders.eyeOffset=ql,Ph._shaders.eyeToWindowCoordinates=Yl,Ph._shaders.fog=Xl,Ph._shaders.geodeticSurfaceNormal=Zl,Ph._shaders.getDefaultMaterial=Kl,Ph._shaders.getLambertDiffuse=Ql,Ph._shaders.getSpecular=Jl,Ph._shaders.getWaterNoise=$l,Ph._shaders.getWgs84EllipsoidEC=eu,Ph._shaders.hue=tu,Ph._shaders.isEmpty=nu,Ph._shaders.isFull=ru,Ph._shaders.latitudeToWebMercatorFraction=iu,Ph._shaders.luminance=ou,Ph._shaders.metersPerPixel=au,Ph._shaders.modelToWindowCoordinates=su,Ph._shaders.multiplyWithColorBalance=lu,Ph._shaders.nearFarScalar=uu,Ph._shaders.octDecode=cu,Ph._shaders.packDepth=hu,Ph._shaders.phong=du,Ph._shaders.pointAlongRay=pu,Ph._shaders.rayEllipsoidIntersectionInterval=fu,Ph._shaders.RGBToXYZ=mu,Ph._shaders.saturation=_u,Ph._shaders.shadowDepthCompare=gu,Ph._shaders.shadowVisibility=vu,Ph._shaders.signNotZero=yu,Ph._shaders.tangentToEyeSpaceMatrix=Cu,Ph._shaders.translateRelativeToEye=wu,Ph._shaders.translucentPhong=bu,Ph._shaders.transpose=Eu,Ph._shaders.unpackDepth=Su,Ph._shaders.windowToEyeCoordinates=xu,Ph._shaders.XYZToRGB=Tu,Ph._shaders.depthRangeStruct=Au,Ph._shaders.ellipsoid=Pu,Ph._shaders.material=Du,Ph._shaders.materialInput=Mu,Ph._shaders.ray=Iu,Ph._shaders.raySegment=Ou,Ph._shaders.shadowParameters=Ru,Ph._shaders.CompositeOITFS=Nu,Ph._shaders.DepthPlaneFS=Lu,Ph._shaders.DepthPlaneVS=Fu,Ph._shaders.EllipsoidFS=Bu,Ph._shaders.EllipsoidVS=ku,Ph._shaders.GlobeFS=Vu,Ph._shaders.GlobeVS=zu,Ph._shaders.GroundAtmosphere=Uu,Ph._shaders.BumpMapMaterial=Gu,Ph._shaders.CheckerboardMaterial=Wu,Ph._shaders.DotMaterial=Hu,Ph._shaders.FadeMaterial=ju,Ph._shaders.GridMaterial=qu,Ph._shaders.NormalMapMaterial=Yu,Ph._shaders.PolylineArrowMaterial=Xu,Ph._shaders.PolylineGlowMaterial=Zu,Ph._shaders.PolylineOutlineMaterial=Ku,Ph._shaders.RimLightingMaterial=Qu,Ph._shaders.StripeMaterial=Ju,Ph._shaders.Water=$u,Ph._shaders.PointPrimitiveCollectionFS=ec,Ph._shaders.PointPrimitiveCollectionVS=tc,Ph._shaders.PolylineCommon=nc,Ph._shaders.PolylineFS=rc,Ph._shaders.PolylineVS=ic,Ph._shaders.AdditiveBlend=oc,Ph._shaders.BrightPass=ac,Ph._shaders.FXAA=sc,Ph._shaders.GaussianBlur1D=lc,Ph._shaders.PassThrough=uc,Ph._shaders.ReprojectWebMercatorFS=cc,Ph._shaders.ReprojectWebMercatorVS=hc,Ph._shaders.ShadowVolumeFS=dc,Ph._shaders.ShadowVolumeVS=pc,Ph._shaders.SkyAtmosphereFS=fc,Ph._shaders.SkyAtmosphereVS=mc,Ph._shaders.SkyBoxFS=_c,Ph._shaders.SkyBoxVS=gc,Ph._shaders.SunFS=vc,Ph._shaders.SunTextureFS=yc,Ph._shaders.SunVS=Cc,Ph._shaders.ViewportQuadFS=wc,Ph._shaders.ViewportQuadVS=bc,Ph.Autolinker=Ec,Ph["earcut-2.1.1"]=Sc,Ph.gltfDefaults=xc,Ph.kdbush=Tc,Ph["knockout-3.4.0"]=Ac,Ph["knockout-es5"]=Pc,Ph.knockout=Dc,Ph.measureText=Mc,Ph["mersenne-twister"]=Ic,Ph.NoSleep=Oc,Ph.sprintf=Rc,Ph.topojson=Nc,Ph.Tween=Lc,Ph.Uri=Fc,Ph.when=Bc,Ph.zip=kc,Ph.Animation=Vc,Ph.AnimationViewModel=zc,Ph.BaseLayerPicker=Uc,Ph.BaseLayerPickerViewModel=Gc,Ph.createDefaultImageryProviderViewModels=Wc,Ph.createDefaultTerrainProviderViewModels=Hc,Ph.ProviderViewModel=jc,Ph.CesiumInspector=qc,Ph.CesiumInspectorViewModel=Yc,Ph.CesiumWidget=Xc,Ph.ClockViewModel=Zc,Ph.Command=Kc,Ph.createCommand=Qc,Ph.FullscreenButton=Jc,Ph.FullscreenButtonViewModel=$c,Ph.Geocoder=eh,Ph.GeocoderViewModel=th,Ph.getElement=nh,Ph.HomeButton=rh,Ph.HomeButtonViewModel=ih,Ph.InfoBox=oh,Ph.InfoBoxViewModel=ah,Ph.NavigationHelpButton=sh,Ph.NavigationHelpButtonViewModel=lh,Ph.PerformanceWatchdog=uh,Ph.PerformanceWatchdogViewModel=ch,Ph.SceneModePicker=hh,Ph.SceneModePickerViewModel=dh,Ph.SelectionIndicator=ph,Ph.SelectionIndicatorViewModel=fh,Ph.subscribeAndEvaluate=mh,Ph.SvgPathBindingHandler=_h,Ph.Timeline=gh,Ph.TimelineHighlightRange=vh,Ph.TimelineTrack=yh,Ph.ToggleButtonViewModel=Ch,Ph.Viewer=wh,Ph.viewerCesiumInspectorMixin=bh,Ph.viewerDragDropMixin=Eh,Ph.viewerPerformanceWatchdogMixin=Sh,Ph.VRButton=xh,Ph.VRButtonViewModel=Th,Ph.createTaskProcessorWorker=Ah,Ph}),i(["Cesium"],function(e){"use strict";("undefined"!=typeof window?window:"undefined"!=typeof self?self:{}).Cesium=e},void 0,!0)}()},ltvI:function(e,t,n){"use strict";t.a=function(e){return e}},mHG6:function(e,t,n){"use strict";t.a=function(e){return e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}},mz3w:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e){var t,r=n("xIGM").a.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}()},nAqi:function(e,t,n){"use strict";t.a=function(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new o(e,t,n))}};var r=n("6Xbx"),i=n("E9/g"),o=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.accumulator,this.seed,this.hasSeed))},e}(),a=function(e){function t(t,n,r,i){e.call(this,t),this.accumulator=n,this._seed=r,this.hasSeed=i,this.index=0}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(i.a)},ozyc:function(e,t,n){"use strict";t.a=function(e,t){return void 0===t&&(t=0),Object(r.b)(e,t)(this)};var r=n("YRqN")},qLnt:function(e,t,n){"use strict";var r=n("1j/l"),i=n("NGRF"),o=n("B1iP"),a=n("8ofh"),s=n("NePw"),l=n("6Xbx"),u=function(e){function t(t){e.call(this),this.errors=t;var n=Error.call(this,t?t.length+" errors occurred during unsubscription:\n  "+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"");this.name=n.name="UnsubscriptionError",this.stack=n.stack,this.message=n.message}return Object(l.c)(t,e),t}(Error);n.d(t,"a",function(){return c});var c=function(){function e(e){this.closed=!1,this._parent=null,this._parents=null,this._subscriptions=null,e&&(this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var e,t=!1;if(!this.closed){var n=this._parent,l=this._parents,c=this._unsubscribe,d=this._subscriptions;this.closed=!0,this._parent=null,this._parents=null,this._subscriptions=null;for(var p=-1,f=l?l.length:0;n;)n.remove(this),n=++p<f&&l[p]||null;if(Object(o.a)(c)&&Object(a.a)(c).call(this)===s.a&&(t=!0,e=e||(s.a.e instanceof u?h(s.a.e.errors):[s.a.e])),Object(r.a)(d))for(p=-1,f=d.length;++p<f;){var m=d[p];if(Object(i.a)(m)&&Object(a.a)(m.unsubscribe).call(m)===s.a){t=!0,e=e||[];var _=s.a.e;_ instanceof u?e=e.concat(h(_.errors)):e.push(_)}}if(t)throw new u(e)}},e.prototype.add=function(t){if(!t||t===e.EMPTY)return e.EMPTY;if(t===this)return this;var n=t;switch(typeof t){case"function":n=new e(t);case"object":if(n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if("function"!=typeof n._addParent){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}return(this._subscriptions||(this._subscriptions=[])).push(n),n._addParent(this),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.prototype._addParent=function(e){var t=this._parent,n=this._parents;t&&t!==e?n?-1===n.indexOf(e)&&n.push(e):this._parents=[e]:this._parent=e},e.EMPTY=((t=new e).closed=!0,t),e}();function h(e){return e.reduce(function(e,t){return e.concat(t instanceof u?t.errors:t)},[])}},qgI0:function(e,t,n){"use strict";var r=n("xIGM"),i=n("kQVV"),o=n("mHG6"),a=n("NGRF"),s=n("AP4T"),l=n("X3fp"),u=n("6Xbx"),c=function(e){function t(t,n,r){e.call(this),this.parent=t,this.outerValue=n,this.outerIndex=r,this.index=0}return Object(u.c)(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(n("E9/g").a),h=n("mz3w");t.a=function(e,t,n,u){var d=new c(e,n,u);if(d.closed)return null;if(t instanceof s.a)return t._isScalar?(d.next(t.value),d.complete(),null):(d.syncErrorThrowable=!0,t.subscribe(d));if(Object(i.a)(t)){for(var p=0,f=t.length;p<f&&!d.closed;p++)d.next(t[p]);d.closed||d.complete()}else{if(Object(o.a)(t))return t.then(function(e){d.closed||(d.next(e),d.complete())},function(e){return d.error(e)}).then(null,function(e){r.a.setTimeout(function(){throw e})}),d;if(t&&"function"==typeof t[l.a])for(var m=t[l.a]();;){var _=m.next();if(_.done){d.complete();break}if(d.next(_.value),d.closed)break}else if(t&&"function"==typeof t[h.a]){var g=t[h.a]();if("function"==typeof g.subscribe)return g.subscribe(new c(e,n,u));d.error(new TypeError("Provided object does not correctly implement Symbol.observable"))}else{var v=Object(a.a)(t)?"an invalid object":"'"+t+"'";d.error(new TypeError("You provided "+v+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable."))}}return null}},qqDE:function(e,t,n){"use strict";t.a=function(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(e,t))}};var r=n("6Xbx"),i=n("E9/g"),o=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new a(e,this.project,this.thisArg))},e}(),a=function(e){function t(t,n,r){e.call(this,t),this.project=n,this.count=0,this.thisArg=r||this}return Object(r.c)(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(i.a)},uIf7:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return StoreDevtoolsModule}),__webpack_require__.d(__webpack_exports__,"a",function(){return StoreDevtools}),__webpack_require__.d(__webpack_exports__,"j",function(){return INITIAL_OPTIONS}),__webpack_require__.d(__webpack_exports__,"i",function(){return STORE_DEVTOOLS_CONFIG}),__webpack_require__.d(__webpack_exports__,"h",function(){return DevtoolsDispatcher}),__webpack_require__.d(__webpack_exports__,"l",function(){return DevtoolsExtension}),__webpack_require__.d(__webpack_exports__,"k",function(){return REDUX_DEVTOOLS_EXTENSION}),__webpack_require__.d(__webpack_exports__,"c",function(){return IS_EXTENSION_OR_MONITOR_PRESENT}),__webpack_require__.d(__webpack_exports__,"g",function(){return createConfig}),__webpack_require__.d(__webpack_exports__,"d",function(){return createIsExtensionOrMonitorPresent}),__webpack_require__.d(__webpack_exports__,"e",function(){return createReduxDevtoolsExtension}),__webpack_require__.d(__webpack_exports__,"f",function(){return createStateObservable});var __WEBPACK_IMPORTED_MODULE_0__angular_core__=__webpack_require__("LMZF"),__WEBPACK_IMPORTED_MODULE_1__ngrx_store__=__webpack_require__("ADVA"),__WEBPACK_IMPORTED_MODULE_2_rxjs_ReplaySubject__=__webpack_require__("5q5V"),__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__=__webpack_require__("dmC+"),__WEBPACK_IMPORTED_MODULE_4_rxjs_operator_merge__=__webpack_require__("BThc"),__WEBPACK_IMPORTED_MODULE_5_rxjs_operator_observeOn__=__webpack_require__("ozyc"),__WEBPACK_IMPORTED_MODULE_6_rxjs_operator_scan__=__webpack_require__("3k/+"),__WEBPACK_IMPORTED_MODULE_7_rxjs_operator_skip__=__webpack_require__("0l2a"),__WEBPACK_IMPORTED_MODULE_8_rxjs_operator_withLatestFrom__=__webpack_require__("ThPn"),__WEBPACK_IMPORTED_MODULE_9_rxjs_scheduler_queue__=__webpack_require__("Gcw1"),__WEBPACK_IMPORTED_MODULE_10_rxjs_Observable__=__webpack_require__("AP4T"),__WEBPACK_IMPORTED_MODULE_11_rxjs_observable_empty__=__webpack_require__("3m71"),__WEBPACK_IMPORTED_MODULE_12_rxjs_operator_filter__=__webpack_require__("6S6c"),__WEBPACK_IMPORTED_MODULE_13_rxjs_operator_share__=__webpack_require__("URbD"),__WEBPACK_IMPORTED_MODULE_14_rxjs_operator_switchMap__=__webpack_require__("GpNi"),__WEBPACK_IMPORTED_MODULE_15_rxjs_operator_takeUntil__=__webpack_require__("gy58"),__extends=this&&this.__extends||(a68272=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a68272(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a68272,PERFORM_ACTION="PERFORM_ACTION",RESET="RESET",ROLLBACK="ROLLBACK",COMMIT="COMMIT",SWEEP="SWEEP",TOGGLE_ACTION="TOGGLE_ACTION",SET_ACTIONS_ACTIVE="SET_ACTIONS_ACTIVE",JUMP_TO_STATE="JUMP_TO_STATE",IMPORT_STATE="IMPORT_STATE",PerformAction=function(){return function(e,t){if(this.action=e,this.timestamp=t,this.type=PERFORM_ACTION,"undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?')}}(),Reset=function(){return function(e){this.timestamp=e,this.type=RESET}}(),Rollback=function(){return function(e){this.timestamp=e,this.type=ROLLBACK}}(),Commit=function(){return function(e){this.timestamp=e,this.type=COMMIT}}(),Sweep=function(){return function(){this.type=SWEEP}}(),ToggleAction=function(){return function(e){this.id=e,this.type=TOGGLE_ACTION}}(),JumpToState=function(){return function(e){this.index=e,this.type=JUMP_TO_STATE}}(),ImportState=function(){return function(e){this.nextLiftedState=e,this.type=IMPORT_STATE}}();function difference(e,t){return e.filter(function(e){return t.indexOf(e)<0})}function unliftState(e){return e.computedStates[e.currentStateIndex].state}function liftAction(e){return new PerformAction(e)}function applyOperators(e,t){return t.reduce(function(e,t){var n=t[0],r=t.slice(1);return n.apply(e,r)},e)}var ExtensionActionTypes={START:"START",DISPATCH:"DISPATCH",STOP:"STOP",ACTION:"ACTION"},REDUX_DEVTOOLS_EXTENSION=new __WEBPACK_IMPORTED_MODULE_0__angular_core__.o("Redux Devtools Extension"),DevtoolsExtension=function(){function DevtoolsExtension(e){this.instanceId="ngrx-store-"+Date.now(),this.devtoolsExtension=e,this.createActionStreams()}return DevtoolsExtension.prototype.notify=function(e,t){this.devtoolsExtension&&this.devtoolsExtension.send(null,t,{serialize:!1},this.instanceId)},DevtoolsExtension.prototype.createChangesObservable=function(){var e=this;return this.devtoolsExtension?new __WEBPACK_IMPORTED_MODULE_10_rxjs_Observable__.a(function(t){var n=e.devtoolsExtension.connect({instanceId:e.instanceId});return n.subscribe(function(e){return t.next(e)}),n.unsubscribe}):Object(__WEBPACK_IMPORTED_MODULE_11_rxjs_observable_empty__.a)()},DevtoolsExtension.prototype.createActionStreams=function(){var e=this,t=__WEBPACK_IMPORTED_MODULE_13_rxjs_operator_share__.a.call(this.createChangesObservable()),n=__WEBPACK_IMPORTED_MODULE_12_rxjs_operator_filter__.a.call(t,function(e){return e.type===ExtensionActionTypes.START}),r=__WEBPACK_IMPORTED_MODULE_12_rxjs_operator_filter__.a.call(t,function(e){return e.type===ExtensionActionTypes.STOP}),i=applyOperators(t,[[__WEBPACK_IMPORTED_MODULE_12_rxjs_operator_filter__.a,function(e){return e.type===ExtensionActionTypes.DISPATCH}],[__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__.a,function(t){return e.unwrapAction(t.payload)}]]),o=applyOperators(t,[[__WEBPACK_IMPORTED_MODULE_12_rxjs_operator_filter__.a,function(e){return e.type===ExtensionActionTypes.ACTION}],[__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__.a,function(t){return e.unwrapAction(t.payload)}]]),a=__WEBPACK_IMPORTED_MODULE_15_rxjs_operator_takeUntil__.a.call(o,r),s=__WEBPACK_IMPORTED_MODULE_15_rxjs_operator_takeUntil__.a.call(i,r);this.actions$=__WEBPACK_IMPORTED_MODULE_14_rxjs_operator_switchMap__.a.call(n,function(){return a}),this.liftedActions$=__WEBPACK_IMPORTED_MODULE_14_rxjs_operator_switchMap__.a.call(n,function(){return s})},DevtoolsExtension.prototype.unwrapAction=function(action){return"string"==typeof action?eval("("+action+")"):action},DevtoolsExtension}(),INIT_ACTION={type:__WEBPACK_IMPORTED_MODULE_1__ngrx_store__.b};function computeNextEntry(e,t,n,r){if(r)return{state:n,error:"Interrupted by an error up the chain"};var i,o=n;try{o=e(n,t)}catch(e){i=e.toString(),console.error(e.stack||e)}return{state:o,error:i}}function recomputeStates(e,t,n,r,i,o,a){if(t>=e.length&&e.length===o.length)return e;for(var s=e.slice(0,t),l=t;l<o.length;l++){var u=o[l],c=i[u].action,h=s[l-1],d=h?h.state:r,p=h?h.error:void 0,f=a.indexOf(u)>-1?h:computeNextEntry(n,c,d,p);s.push(f)}return s}function liftInitialState(e,t){return{monitorState:t(void 0,{}),nextActionId:1,actionsById:{0:liftAction(INIT_ACTION)},stagedActionIds:[0],skippedActionIds:[],committedState:e,currentStateIndex:0,computedStates:[]}}function liftReducerWith(e,t,n,r){return void 0===r&&(r={}),function(i){return function(o,a){var s=o||t,l=s.monitorState,u=s.actionsById,c=s.nextActionId,h=s.stagedActionIds,d=s.skippedActionIds,p=s.committedState,f=s.currentStateIndex,m=s.computedStates;function _(e){for(var t=e,n=h.slice(1,t+1),r=0;r<n.length;r++){if(m[r+1].error){n=h.slice(1,(t=r)+1);break}delete u[n[r]]}d=d.filter(function(e){return-1===n.indexOf(e)}),h=[0].concat(h.slice(t+1)),p=m[t].state,m=m.slice(t),f=f>t?f-t:0}o||(u=Object.create(u));var g,v=0;switch(a.type){case RESET:u={0:liftAction(INIT_ACTION)},c=1,h=[0],d=[],p=e,f=0,m=[];break;case COMMIT:u={0:liftAction(INIT_ACTION)},c=1,h=[0],d=[],p=m[f].state,f=0,m=[];break;case ROLLBACK:u={0:liftAction(INIT_ACTION)},c=1,h=[0],d=[],f=0,m=[];break;case TOGGLE_ACTION:var y=a.id,C=d.indexOf(y);d=-1===C?[y].concat(d):d.filter(function(e){return e!==y}),v=h.indexOf(y);break;case SET_ACTIONS_ACTIVE:for(var w=a.start,b=a.end,E=a.active,S=[],x=w;x<b;x++)S.push(x);d=E?difference(d,S):d.concat(S),v=h.indexOf(w);break;case JUMP_TO_STATE:f=a.index,v=1/0;break;case SWEEP:h=difference(h,d),d=[],f=Math.min(f,h.length-1);break;case PERFORM_ACTION:r.maxAge&&h.length===r.maxAge&&_(1),f===h.length-1&&f++;var T=c++;u[T]=a,v=(h=h.concat([T])).length-1;break;case IMPORT_STATE:l=(g=a.nextLiftedState).monitorState,u=g.actionsById,c=g.nextActionId,h=g.stagedActionIds,d=g.skippedActionIds,p=g.committedState,f=g.currentStateIndex,m=g.computedStates;break;case __WEBPACK_IMPORTED_MODULE_1__ngrx_store__.p:case __WEBPACK_IMPORTED_MODULE_1__ngrx_store__.b:v=0,r.maxAge&&h.length>r.maxAge&&(m=recomputeStates(m,v,i,p,u,h,d),_(h.length-r.maxAge),v=1/0);break;default:v=1/0}return m=recomputeStates(m,v,i,p,u,h,d),{monitorState:l=n(l,a),actionsById:u,nextActionId:c,stagedActionIds:h,skippedActionIds:d,committedState:p,currentStateIndex:f,computedStates:m}}}}var StoreDevtoolsConfig=function(){},STORE_DEVTOOLS_CONFIG=new __WEBPACK_IMPORTED_MODULE_0__angular_core__.o("@ngrx/devtools Options"),INITIAL_OPTIONS=new __WEBPACK_IMPORTED_MODULE_0__angular_core__.o("@ngrx/devtools Initial Config"),DevtoolsDispatcher=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(__WEBPACK_IMPORTED_MODULE_1__ngrx_store__.a),StoreDevtools=function(){function e(e,t,n,r,i,o,a){var s=liftInitialState(o,a.monitor),l=liftReducerWith(o,s,a.monitor,a.maxAge?{maxAge:a.maxAge}:{}),u=applyOperators(t.asObservable(),[[__WEBPACK_IMPORTED_MODULE_7_rxjs_operator_skip__.a,1],[__WEBPACK_IMPORTED_MODULE_4_rxjs_operator_merge__.a,r.actions$],[__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__.a,liftAction],[__WEBPACK_IMPORTED_MODULE_4_rxjs_operator_merge__.a,e,r.liftedActions$],[__WEBPACK_IMPORTED_MODULE_5_rxjs_operator_observeOn__.a,__WEBPACK_IMPORTED_MODULE_9_rxjs_scheduler_queue__.a]]),c=__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__.a.call(n,l),h=new __WEBPACK_IMPORTED_MODULE_2_rxjs_ReplaySubject__.a(1),d=applyOperators(u,[[__WEBPACK_IMPORTED_MODULE_8_rxjs_operator_withLatestFrom__.a,c],[__WEBPACK_IMPORTED_MODULE_6_rxjs_operator_scan__.a,function(e,t){var n=t[0],i=(0,t[1])(e.state,n);return r.notify(n,i),{state:i,action:n}},{state:s,action:null}]]).subscribe(function(e){var t=e.action;h.next(e.state),t.type===PERFORM_ACTION&&i.next(t.action)}),p=h.asObservable(),f=__WEBPACK_IMPORTED_MODULE_3_rxjs_operator_map__.a.call(p,unliftState);this.stateSubscription=d,this.dispatcher=e,this.liftedState=p,this.state=f}return e.prototype.dispatch=function(e){this.dispatcher.next(e)},e.prototype.next=function(e){this.dispatcher.next(e)},e.prototype.error=function(e){},e.prototype.complete=function(){},e.prototype.performAction=function(e){this.dispatch(new PerformAction(e))},e.prototype.reset=function(){this.dispatch(new Reset)},e.prototype.rollback=function(){this.dispatch(new Rollback)},e.prototype.commit=function(){this.dispatch(new Commit)},e.prototype.sweep=function(){this.dispatch(new Sweep)},e.prototype.toggleAction=function(e){this.dispatch(new ToggleAction(e))},e.prototype.jumpToState=function(e){this.dispatch(new JumpToState(e))},e.prototype.importState=function(e){this.dispatch(new ImportState(e))},e}(),IS_EXTENSION_OR_MONITOR_PRESENT=new __WEBPACK_IMPORTED_MODULE_0__angular_core__.o("Is Devtools Extension or Monitor Present");function createIsExtensionOrMonitorPresent(e,t){return Boolean(e)||t.monitor!==noMonitor}function createReduxDevtoolsExtension(){var e="__REDUX_DEVTOOLS_EXTENSION__";return"object"==typeof window&&"undefined"!=typeof window[e]?window[e]:null}function createStateObservable(e){return e.state}function noMonitor(){return null}function createConfig(e){var t={maxAge:!1,monitor:noMonitor},n="function"==typeof e?e():e,r=Object.assign({},t,n);if(r.maxAge&&r.maxAge<2)throw new Error("Devtools 'maxAge' cannot be less than 2, got "+r.maxAge);return r}var StoreDevtoolsModule=function(){function e(){}return e.instrument=function(t){return void 0===t&&(t={}),{ngModule:e,providers:[DevtoolsExtension,DevtoolsDispatcher,StoreDevtools,{provide:INITIAL_OPTIONS,useValue:t},{provide:IS_EXTENSION_OR_MONITOR_PRESENT,deps:[REDUX_DEVTOOLS_EXTENSION,STORE_DEVTOOLS_CONFIG],useFactory:createIsExtensionOrMonitorPresent},{provide:REDUX_DEVTOOLS_EXTENSION,useFactory:createReduxDevtoolsExtension},{provide:STORE_DEVTOOLS_CONFIG,deps:[INITIAL_OPTIONS],useFactory:createConfig},{provide:__WEBPACK_IMPORTED_MODULE_1__ngrx_store__.l,deps:[StoreDevtools],useFactory:createStateObservable},{provide:__WEBPACK_IMPORTED_MODULE_1__ngrx_store__.h,useExisting:DevtoolsDispatcher}]}},e}()},wP3s:function(e,t,n){"use strict";t.a=function(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(r){return"number"==typeof t&&(n=t,t=null),r.lift(new a(e,t,n))}};var r=n("6Xbx"),i=n("qgI0"),o=n("lI6h"),a=function(){function e(e,t,n){void 0===n&&(n=Number.POSITIVE_INFINITY),this.project=e,this.resultSelector=t,this.concurrent=n}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.resultSelector,this.concurrent))},e}(),s=function(e){function t(t,n,r,i){void 0===i&&(i=Number.POSITIVE_INFINITY),e.call(this,t),this.project=n,this.resultSelector=r,this.concurrent=i,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}return Object(r.c)(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t,e,n)},t.prototype._innerSub=function(e,t,n){this.add(Object(i.a)(this,e,t,n))},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n,r,i){this.resultSelector?this._notifyResultSelector(e,t,n,r):this.destination.next(t)},t.prototype._notifyResultSelector=function(e,t,n,r){var i;try{i=this.resultSelector(e,t,n,r)}catch(e){return void this.destination.error(e)}this.destination.next(i)},t.prototype.notifyComplete=function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(o.a)},wclm:function(e,t,n){"use strict";var r=n("6Xbx"),i=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=Date.now?Date.now:function(){return+new Date},e}();n.d(t,"a",function(){return o});var o=function(e){function t(){e.apply(this,arguments),this.actions=[],this.active=!1,this.scheduled=void 0}return Object(r.c)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(i)},xIGM:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return o});var r="undefined"!=typeof window&&window,i="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,o=r||"undefined"!=typeof e&&e||i}).call(t,n("fRUx"))}},[0]);